<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Golang Â¶Ç‰ΩïÂÆûÁé∞Ëá™ÂÆö‰πâ CDC Â∑•ÂÖ∑Ôºü]]></title>
    <url>%2F2024%2F05%2F04%2FGolang-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89-CDC-%E5%B7%A5%E5%85%B7%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[CDCÂèòÊõ¥Êï∞ÊçÆÊçïËé∑ÔºàCDCÔºâÊòØ‰∏ÄÁßçË∑üË∏™Êï∞ÊçÆÂ∫ìÊõ¥ÊîπÁöÑÊäÄÊúØÔºåÂÖÅËÆ∏ÂºÄÂèë‰∫∫ÂëòÊçïËé∑Â∫îÁî®‰∫éË°åÁöÑÊèíÂÖ•„ÄÅÊõ¥Êñ∞ÂíåÂà†Èô§„ÄÇÂÆÉÊòØÊï∞ÊçÆÈõÜÊàêÂíåÂÆûÊó∂Â§ÑÁêÜ‰ªªÂä°ÁöÑÈáçË¶ÅÁªÑÊàêÈÉ®ÂàÜ„ÄÇÂú®Êú¨Êñá‰∏≠ÔºåÊàë‰ª¨Â∞ÜËÆ®ËÆ∫Â¶Ç‰ΩïÂú® Golang ‰∏≠‰∏∫ PostgreSQL„ÄÅOracle„ÄÅMySQL„ÄÅMongoDB Âíå SQL Server Á≠âÂ§ö‰∏™Êï∞ÊçÆÂ∫ìÂºÄÂèëËá™ÂÆö‰πâ CDC Â∑•ÂÖ∑„ÄÇ ÈÄöÂ∏∏Âú® CDC È¢ÜÂüüÊàñËÄÖËØ¥Â§ßÊï∞ÊçÆÈ¢ÜÂüüÈÉΩÊòØ java ÁöÑÁîüÊÄÅÊØîËæÉÁπÅËç£ÔºåÊØîÂ¶Ç Flink, Spark, ÊúÄËøëÂ§ßÁÅ´ÁöÑ paimon ÈÉΩÊòØ java ÂÜôÁöÑ„ÄÇJava Âú®Êï∞ÊçÆÁîüÊÄÅÁöÑÁπÅËç£‰∏∫ÂØπÂ∫îÊï∞ÊçÆÂ∑•ÂÖ∑ÁöÑÂºÄÂèëÊèê‰æõ‰∫ÜÂúüÂ£§„ÄÇÈÇ£‰πàÊàë‰ª¨ Gopher Â¶ÇÊûú‰πüÊÉ≥ÂºÄÂèë CDC Â∑•ÂÖ∑ÊÄé‰πàÂäûÔºü‰ªäÂ§©‰ªãÁªçÁöÑÊòØ‰∏Ä‰∫õ golang ÁöÑ LibÔºåÂü∫‰∫éËøô‰∫õ lib Êàë‰ª¨‰πüÂèØ‰ª•ÂÆûÁé∞Ëá™ÂÆö‰πâÁöÑ CDC Â∑•ÂÖ∑„ÄÇ PostgreSQLÂØπ‰∫é PostgreSQLÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® pglogrepl Â∫ìÔºàgithub.com/jackc/pglogreplÔºâ„ÄÇËØ•Â∫ìÊèê‰æõ‰∫Ü PostgreSQL ‰∏≠ÁöÑÈÄªËæëËß£Á†ÅÂíåÊµÅÂ§çÂà∂ÂçèËÆÆÁöÑ‰ΩéÁ∫ß API„ÄÇÂÆÉÂÖÅËÆ∏ÊÇ®ËØªÂèñ PostgreSQL ÁöÑÈ¢ÑÂÜôÂºèÊó•ÂøóÔºàWALÔºâÔºåËøô‰∫õÊó•ÂøóÊòØÂ≠òÂÇ®ÊâÄÊúâÂØπÊï∞ÊçÆÂ∫ìÁöÑÊõ¥ÊîπÁöÑÂú∞Êñπ„ÄÇÈÄöËøáËØªÂèñÂíåËß£Á†ÅËøô‰∫õÊó•ÂøóÔºåÊàë‰ª¨ÂèØ‰ª•Ë∑üË∏™Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊõ¥Êîπ„ÄÇËß£Á†ÅÂèØ‰ª•Âú®Êèí‰ª∂Á∫ßÂà´ÊàñÊ∂àË¥πËÄÖÁ∫ßÂà´ËøõË°åÔºåËøôÂèñÂÜ≥‰∫é PostgreSQL ‰∏≠‰ΩøÁî®ÁöÑËß£Á†ÅÊèí‰ª∂„ÄÇ Oracle‰∏∫ Oracle ÂàõÂª∫ CDC Â∑•ÂÖ∑Ë¶ÅÂ§çÊùÇ‰∏Ä‰∫õ„ÄÇOracle Êúâ‰∏Ä‰∏™Âêç‰∏∫ ‚ÄúLogMiner‚Äù ÁöÑÂÜÖÁΩÆÂ∑•ÂÖ∑ÔºåÂÆÉÂÖÅËÆ∏ÊÇ®ÈÄöËøá SQL Êé•Âè£Êü•ËØ¢Âú®Á∫øÂíåÂΩíÊ°£ÁöÑÈáçÂÅöÊó•ÂøóÊñá‰ª∂„ÄÇÊï∞ÊçÆÁöÑ‰∏ªË¶ÅÊù•Ê∫êÂ∞ÜÊòØ V$LOGMNR_CONTENTS ËßÜÂõæÔºåËøôÊòØ LogMiner Âú®ÂØπÂÖ∂ËøõË°åÊåñÊéòÂêéÁöÑÈáçÂÅöÊó•ÂøóÊï∞ÊçÆÁöÑËßÜÂõæ„ÄÇ Êàë‰ª¨ÁöÑ CDC Â∑•ÂÖ∑ÈúÄË¶ÅÂÆöÊúüÊü•ËØ¢Ê≠§ËßÜÂõæÔºåÂπ∂Ëß£Êûê SQL_REDO Âíå SQL_UNDO Â≠óÊÆµÔºå‰ª•‰∫ÜËß£ÂØπÊï∞ÊçÆÂ∫ìÊâÄÂÅöÁöÑÊõ¥Êîπ„ÄÇËøôÈúÄË¶ÅÁêÜËß£ Oracle ÁöÑ SQL ËØ≠Ê≥ïÔºåÂπ∂ÂèØËÉΩÂ§ÑÁêÜ‰∏çÂêåÁâàÊú¨ÁöÑ OracleÔºåÂõ†‰∏∫ËØ≠Ê≥ïÂèØËÉΩ‰ºöÂèëÁîüÂèòÂåñ„ÄÇ MySQLÂèØ‰ª•‰ΩøÁî® go-mysql Â∫ìÔºàgithub.com/go-mysql-org/go-mysql/canalÔºâÂ§ÑÁêÜ MySQL„ÄÇËØ•ËΩØ‰ª∂ÂåÖÊèê‰æõ‰∫Ü‰∏Ä‰∏™Ê°ÜÊû∂ÔºåÁî®‰∫éÂ∞Ü MySQL ÁöÑ binlog ÂêåÊ≠•Âà∞ÂÖ∂‰ªñÁ≥ªÁªü„ÄÇÂÆÉÊîØÊåÅÂ∞Ü MySQL ÁöÑ binlog ÂêåÊ≠•Âà∞Áî®Êà∑ÂÆö‰πâÁöÑÂ§ÑÁêÜÁ®ãÂ∫èÔºå‰æãÂ¶Ç stdout Âíå Kafka Ê∂àÊÅØÈòüÂàó„ÄÇÈÄöËøá‰ΩøÁî®ËØ•Â∫ìÔºåÊàë‰ª¨ÂèØ‰ª•Áõ∏ÂØπÁÆÄÂçïÂú∞Ë∑üË∏™Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊõ¥Êîπ„ÄÇ MongoDBÂØπ‰∫é MongoDBÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® mongo-driver/mongo ÂåÖÔºàgo.mongodb.org/mongo-driver/mongoÔºâ„ÄÇËØ•ËΩØ‰ª∂ÂåÖ‰∏∫ Go Êèê‰æõ‰∫Ü MongoDB È©±Âä®Á®ãÂ∫è API„ÄÇMongoDB È©±Âä®Á®ãÂ∫èÊîØÊåÅ ‚ÄúChange Streams‚ÄùÔºåÂÆÉÂÖÅËÆ∏Â∫îÁî®Á®ãÂ∫èËÆøÈóÆÂÆûÊó∂Êï∞ÊçÆÊõ¥ÊîπÔºåËÄåÊó†ÈúÄÂ∞æÈöè oplog ÁöÑÂ§çÊùÇÊÄßÂíåÈ£éÈô©„ÄÇÂ∫îÁî®Á®ãÂ∫èÂèØ‰ª•‰ΩøÁî®Êõ¥ÊîπÊµÅËÆ¢ÈòÖÂçï‰∏™ÈõÜÂêà„ÄÅÊï∞ÊçÆÂ∫ìÊàñÊï¥‰∏™ÈÉ®ÁΩ≤‰∏äÁöÑÊâÄÊúâÊï∞ÊçÆÊõ¥ÊîπÔºåÂπ∂Á´ãÂç≥ÂØπÂÖ∂ËøõË°åÂìçÂ∫î„ÄÇ SQL ServerÂØπ‰∫é SQL ServerÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî® go-mssqldb ÂåÖÔºàgithub.com/denisenkom/go-mssqldbÔºâ„ÄÇSQL Server ÊîØÊåÅÂèòÊõ¥Ë∑üË∏™ÔºåÂÆÉË∑üË∏™Ë°®‰∏äÁöÑ DML Êõ¥ÊîπÔºàÊèíÂÖ•„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§Ôºâ„ÄÇÈÄöËøáÊü•ËØ¢Ëøô‰∫õÂèòÊõ¥Ë°®ÔºåÊàë‰ª¨ÂèØ‰ª•Ëé∑ÂèñÊúâÂÖ≥Êõ¥ÊîπÁöÑ‰ø°ÊÅØ„ÄÇËØ∑Ê≥®ÊÑèÔºåËøôÂè™‰ºöÂëäËØâÊàë‰ª¨Êõ¥ÊîπË°åÁöÑÈîÆÔºåËÄå‰∏çÊòØÊï∞ÊçÆÊú¨Ë∫´„ÄÇË¶ÅËé∑ÂèñÊõ¥ÊîπÁöÑÊï∞ÊçÆÔºåÊàë‰ª¨ÈúÄË¶ÅÂØπÂÆûÈôÖÊï∞ÊçÆË°®ËøõË°åÂè¶‰∏Ä‰∏™Êü•ËØ¢„ÄÇ ÁªìËÆ∫Âú® Golang ‰∏≠ÂàõÂª∫Ëá™ÂÆö‰πâ CDC Â∑•ÂÖ∑Ê∂âÂèäÁêÜËß£ÊØè‰∏™Êï∞ÊçÆÂ∫ìÁî®‰∫éËÆ∞ÂΩïÊõ¥ÊîπÁöÑÂü∫Á°ÄÊú∫Âà∂„ÄÇÈÄöËøáÂà©Áî®Áé∞ÊúâËΩØ‰ª∂ÂåÖÁöÑÂäüËÉΩÔºåÊàë‰ª¨ÂèØ‰ª•ÊûÑÂª∫‰∏Ä‰∏™Âº∫Â§ßÁöÑÂ∑•ÂÖ∑ÔºåÂèØ‰ª•Ë∑üË∏™Â§öÁßçÁ±ªÂûãÊï∞ÊçÆÂ∫ìÁöÑÊõ¥Êîπ„ÄÇÁÑ∂ËÄåÔºåË¶ÅÂÆûÁé∞È´òÊïàÂíåÊúâÊïàÁöÑ CDC Â∑•ÂÖ∑ÔºåÈúÄË¶ÅÂØπÊØè‰∏™Êï∞ÊçÆÂ∫ìÁöÑÊó•ÂøóÊú∫Âà∂ÊúâÈÄèÂΩªÁöÑ‰∫ÜËß£Ôºå‰ª•ÂèäÂØπ Golang ÊúâÊâéÂÆûÁöÑÊéåÊè°„ÄÇ]]></content>
      <categories>
        <category>CDC</category>
      </categories>
      <tags>
        <tag>CDC</tag>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âü∫‰∫é langchaingo ÂØπÊé•Â§ßÊ®°Âûã ollama ÂÆûÁé∞Êú¨Âú∞Áü•ËØÜÂ∫ìÈóÆÁ≠îÁ≥ªÁªü]]></title>
    <url>%2F2024%2F05%2F03%2F%E5%9F%BA%E4%BA%8E-langchaingo-%E5%AF%B9%E6%8E%A5%E5%A4%A7%E6%A8%A1%E5%9E%8B-ollama-%E5%AE%9E%E7%8E%B0%E6%9C%AC%E5%9C%B0%E7%9F%A5%E8%AF%86%E5%BA%93%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F%2F</url>
    <content type="text"><![CDATA[Ollama ÊòØ‰∏Ä‰∏™Âü∫‰∫é Go ËØ≠Ë®ÄÂºÄÂèëÁöÑÁÆÄÂçïÊòìÁî®ÁöÑÊú¨Âú∞Â§ßËØ≠Ë®ÄÊ®°ÂûãËøêË°åÊ°ÜÊû∂„ÄÇÂú®ÁÆ°ÁêÜÊ®°ÂûãÁöÑÂêåÊó∂ÔºåÂÆÉËøòÂü∫‰∫é Go ËØ≠Ë®Ä‰∏≠ÁöÑ Web Ê°ÜÊû∂ ginÊèê‰æõ‰∫Ü‰∏Ä‰∫õ Api Êé•Âè£ÔºåËÆ©‰Ω†ËÉΩÂ§üÂÉèË∑ü OpenAI Êèê‰æõÁöÑÊé•Âè£ÈÇ£Ê†∑ËøõË°å‰∫§‰∫í„ÄÇ Ollama ÂÆòÊñπËøòÊèê‰æõ‰∫ÜË∑ü docker hub ‰∏ÄÊ†∑ÁöÑÊ®°Âûã hubÔºåÁî®‰∫éÂ≠òÊîæÂêÑÁßçÂ§ßËØ≠Ë®ÄÊ®°ÂûãÔºåÂºÄÂèëËÄÖ‰πüÂèØ‰ª•‰∏ä‰º†Ëá™Â∑±ËÆ≠ÁªÉÂ•ΩÁöÑÊ®°Âûã‰æõÂÖ∂‰ªñ‰∫∫‰ΩøÁî®„ÄÇ ÂÆâË£Ö ollamaÂèØ‰ª•Âú® ollama ÁöÑ github release È°µÈù¢Áõ¥Êé•‰∏ãËΩΩÂØπÂ∫îÂπ≥Âè∞ÁöÑ‰∫åËøõÂà∂ÂåÖËøõË°åÂÆâË£ÖÔºå‰πüÂèØ‰ª• docker ‰∏ÄÈîÆÈÉ®ÁΩ≤„ÄÇËøôÈáåÊºîÁ§∫ÁöÑÊú∫Âô®ÊòØ macOS M1 PRO ÁâàÊú¨ÔºåÁõ¥Êé•‰∏ãËΩΩÂÆâË£ÖÂåÖÔºåÂÆâË£ÖÂç≥ÂèØÔºåÂÆâË£Ö‰πãÂêéÔºåËøêË°åËΩØ‰ª∂„ÄÇ ËøêË°å‰πãÂêéÔºåÈ°πÁõÆÈªòËÆ§ÁõëÂê¨ 11434 Á´ØÂè£ÔºåÂú®ÁªàÁ´ØÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÂèØÈ™åËØÅÊòØÂê¶Ê≠£Â∏∏ËøêË°åÔºö 12$ curl localhost:11434Ollama is running Â§ßÊ®°ÂûãÁÆ°ÁêÜollama ÂÆâË£ÖÂêéÔºåÂ∞±ÂèØ‰ª•ÂØπÂ§ßÊ®°ÂûãËøõÈ°πÂÆâË£Ö‰ΩøÁî®‰∫Ü„ÄÇOllama Ëøò‰ºöÊê∫Â∏¶‰∏Ä‰∏™ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºåÈÄöËøáÂÆÉÂèØ‰ª•‰∏éÊ®°ÂûãËøõË°å‰∫§‰∫í„ÄÇ ollama listÔºöÊòæÁ§∫Ê®°ÂûãÂàóË°®„ÄÇ ollama showÔºöÊòæÁ§∫Ê®°ÂûãÁöÑ‰ø°ÊÅØ ollama pullÔºöÊãâÂèñÊ®°Âûã ollama pushÔºöÊé®ÈÄÅÊ®°Âûã ollama cpÔºöÊã∑Ë¥ù‰∏Ä‰∏™Ê®°Âûã ollama rmÔºöÂà†Èô§‰∏Ä‰∏™Ê®°Âûã ollama runÔºöËøêË°å‰∏Ä‰∏™Ê®°Âûã Âú®ÂÆòÊñπÊèê‰æõÁöÑÊ®°Âûã‰ªìÂ∫ì‰∏≠ÂèØ‰ª•ÊâæÂà∞‰Ω†ÊÉ≥Ë¶ÅÁöÑÊ®°ÂûãÔºöhttps://ollama.com/library Ê≥®ÊÑèÔºöÂ∫îËØ•Ëá≥Â∞ëÊúâ 8 GB ÂèØÁî® RAM Êù•ËøêË°å 7 B ÂûãÂè∑Ôºå16 GB Êù•ËøêË°å 13 B ÂûãÂè∑Ôºå32 GB Êù•ËøêË°å 33 B ÂûãÂè∑„ÄÇ ÊØîÂ¶ÇÊàë‰ª¨ÂèØ‰ª•ÈÄâÊã© Qwen ÂÅö‰∏™ÊºîÁ§∫ÔºåËøôÈáåÁî® 1.8B ÁöÑÊ®°Âûã(Êú¨Âú∞ÁîµËÑëÊØîËæÉÂèØÊÄúÔºåÂè™Êúâ 16Güò≠)Ôºö 1$ ollama run qwen:1.8b ÊòØ‰∏çÊòØËßâÂæóËøô‰∏™ÂëΩ‰ª§‰ººÊõæÁõ∏ËØÜÔºåÊòØÁöÑÔºåË∑ü docker run image ‰∏ÄÊ†∑ÔºåÂ¶ÇÊûúÊú¨Âú∞Ê≤°ÊúâËØ•Ê®°ÂûãÔºåÂàô‰ºöÂÖà‰∏ãËΩΩÊ®°ÂûãÂÜçËøêË°å„ÄÇ Êó¢ÁÑ∂Ë∑ü docker Â¶ÇÊ≠§‰∏ÄËá¥ÔºåÈÇ£‰πàÊòØ‰∏çÊòØ‰πü‰ºöÊúâË∑ü Dockerfile ‰∏ÄÊ†∑ÁöÑ‰∏úË•øÔºåÊòØÁöÑÔºåÂè´ÂÅö Modelfile : 123456789FROM qwen:14b# set the temperature to 1 [higher is more creative, lower is more coherent]PARAMETER temperature 1# set the system messageSYSTEM """You are Mario from super mario bros, acting as an assistant.""" ‰øùÂ≠ò‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏∫ ModelfileÔºåËøêË°å llama create choose-a-model-name -f Modelfile Â∞±ÂèØ‰ª•ÂÆöÂà∂‰Ω†ÁöÑÊ®°ÂûãÔºåollama run choose-a-model-name Â∞±ÂèØ‰ª•‰ΩøÁî®ÂàöÂàöÂÆöÂà∂ÁöÑÊ®°Âûã„ÄÇ ÂØπÊé• ollama ÂÆûÁé∞Êú¨Âú∞Áü•ËØÜÂ∫ìÈóÆÁ≠îÁ≥ªÁªüÂâçÁΩÆÂáÜÂ§áÊ®°ÂûãÈÉΩÂú®Êú¨Âú∞ÂÆâË£ÖÂ•Ω‰∫ÜÔºåÊàë‰ª¨ÂèØ‰ª•ÂØπÊé•Ëøô‰∏™Ê®°ÂûãÔºåÂºÄÂèë‰∏Ä‰∫õÂ•ΩÁé©ÁöÑ‰∏äÂ±Ç AI Â∫îÁî®„ÄÇ‰∏ãÈù¢Êàë‰ª¨Âü∫‰∫é langchaningo ÂºÄÂèë‰∏Ä‰∏™ÈóÆÁ≠îÁ≥ªÁªü„ÄÇ ‰∏ãÈù¢ÁöÑÁ≥ªÁªü‰ºöÁî®Âà∞ÁöÑÊ®°ÂûãÊúâ ollama qwen1.8BÔºånomic-embed-textÔºåÂÖàÊù•ÂÆâË£ÖËøô‰∏§‰∏™Ê®°ÂûãÔºö 12ollama run qwen:1.8bollama run nomic-embed-text:latest Êàë‰ª¨ËøòÈúÄË¶Å‰∏Ä‰∏™ÂêëÈáèÊï∞ÊçÆÂ∫ìÊù•Â≠òÂÇ®ÊãÜÂàÜÂêéÁöÑÁü•ËØÜÂ∫ìÂÜÖÂÆπÔºåËøôÈáåÊàë‰ª¨‰ΩøÁî® qdrant : 12docker pull qdrant/qdrant$ docker run -itd --name qdrant -p 6333:6333 qdrant/qdrant ÂêØÂä® qdrant ÂêéÊàë‰ª¨ÂÖàÂàõÂª∫‰∏Ä‰∏™ Collection Áî®‰∫éÂ≠òÂÇ®ÊñáÊ°£ÊãÜÂàÜÂùó: 12345678curl -X PUT http://localhost:6333/collections/langchaingo-ollama-rag \ -H 'Content-Type: application/json' \ --data-raw '&#123; "vectors": &#123; "size": 768, "distance": "Dot" &#125; &#125;' Áü•ËØÜÂ∫ìÂÜÖÂÆπÂàáÂàÜËøôÈáåÊèê‰æõ‰∏ÄÁØáÊñáÁ´†‰æõÂ§ßÊ®°ÂûãÂ≠¶‰π†Ôºå‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂ∞ÜÊñáÁ´†ÊãÜÂàÜÊàêÂ∞èÁöÑÊñáÊ°£ÂùóÔºö 1234567891011121314151617181920func TextToChunks(dirFile string, chunkSize, chunkOverlap int) ([]schema.Document, error) &#123; file, err := os.Open(dirFile) if err != nil &#123; return nil, err &#125; // create a doc loader docLoaded := documentloaders.NewText(file) // create a doc spliter split := textsplitter.NewRecursiveCharacter() // set doc chunk size split.ChunkSize = chunkSize // set chunk overlap size split.ChunkOverlap = chunkOverlap // load and split doc docs, err := docLoaded.LoadAndSplit(context.Background(), split) if err != nil &#123; return nil, err &#125; return docs, nil&#125; ÊñáÊ°£Â≠òÂÇ®Âà∞ÂêëÈáèÊï∞ÊçÆÂ∫ì123456789func storeDocs(docs []schema.Document, store *qdrant.Store) error &#123; if len(docs) &gt; 0 &#123; _, err := store.AddDocuments(context.Background(), docs) if err != nil &#123; return err &#125; &#125; return nil&#125; ËØªÂèñÁî®Êà∑ËæìÂÖ•Âπ∂Êü•ËØ¢Êï∞ÊçÆÂ∫ì123456789101112131415161718func useRetriaver(store *qdrant.Store, prompt string, topk int) ([]schema.Document, error) &#123; // ËÆæÁΩÆÈÄâÈ°πÂêëÈáè optionsVector := []vectorstores.Option&#123; vectorstores.WithScoreThreshold(0.80), // ËÆæÁΩÆÂàÜÊï∞ÈòàÂÄº &#125; // ÂàõÂª∫Ê£ÄÁ¥¢Âô® retriever := vectorstores.ToRetriever(store, topk, optionsVector...) // ÊêúÁ¥¢ docRetrieved, err := retriever.GetRelevantDocuments(context.Background(), prompt) if err != nil &#123; return nil, fmt.Errorf("Ê£ÄÁ¥¢ÊñáÊ°£Â§±Ë¥•: %v", err) &#125; // ËøîÂõûÊ£ÄÁ¥¢Âà∞ÁöÑÊñáÊ°£ return docRetrieved, nil&#125; ÂàõÂª∫Âπ∂Âä†ËΩΩÂ§ßÊ®°Âûã12345678910func getOllamaQwen() *ollama.LLM &#123; // ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑollamaÊ®°ÂûãÔºåÊ®°ÂûãÂêç‰∏∫"qwena:1.8b" llm, err := ollama.New( ollama.WithModel("qwen:1.8b"), ollama.WithServerURL(ollamaServer)) if err != nil &#123; logger.Fatal("ÂàõÂª∫ollamaÊ®°ÂûãÂ§±Ë¥•: %v", err) &#125; return llm&#125; Â§ßÊ®°ÂûãÂ§ÑÁêÜÂ∞ÜÊ£ÄÁ¥¢Âà∞ÁöÑÂÜÖÂÆπÔºå‰∫§ÁªôÂ§ßËØ≠Ë®ÄÊ®°ÂûãÂ§ÑÁêÜ 123456789101112131415161718192021222324252627// GetAnswer Ëé∑ÂèñÁ≠îÊ°àfunc GetAnswer(ctx context.Context, llm llms.Model, docRetrieved []schema.Document, prompt string) (string, error) &#123; // ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑËÅäÂ§©Ê∂àÊÅØÂéÜÂè≤ËÆ∞ÂΩï history := memory.NewChatMessageHistory() // Â∞ÜÊ£ÄÁ¥¢Âà∞ÁöÑÊñáÊ°£Ê∑ªÂä†Âà∞ÂéÜÂè≤ËÆ∞ÂΩï‰∏≠ for _, doc := range docRetrieved &#123; history.AddAIMessage(ctx, doc.PageContent) &#125; // ‰ΩøÁî®ÂéÜÂè≤ËÆ∞ÂΩïÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂØπËØùÁºìÂÜ≤Âå∫ conversation := memory.NewConversationBuffer(memory.WithChatHistory(history)) executor := agents.NewExecutor( agents.NewConversationalAgent(llm, nil), nil, agents.WithMemory(conversation), ) // ËÆæÁΩÆÈìæË∞ÉÁî®ÈÄâÈ°π options := []chains.ChainCallOption&#123; chains.WithTemperature(0.8), &#125; res, err := chains.Run(ctx, executor, prompt, options...) if err != nil &#123; return "", err &#125; return res, nil&#125; ËøêË°åÂ∫îÁî®1go run main.go getanswer ËæìÂÖ•‰Ω†ÊÉ≥Ë¶ÅÂí®ËØ¢ÁöÑÈóÆÈ¢ò Á≥ªÁªüËæìÂá∫ÁªìÊûúÔºö ËæìÂá∫ÁöÑÁªìÊûúÂèØËÉΩ‰ºöÂõ†‰∏∫Â≠¶‰π†ËµÑÊñôÁöÑ‰∏çË∂≥ÊàñËÄÖÊ®°ÂûãÁöÑÂ§ßÂ∞èÂ≠òÂú®Âå∫Âà´ÔºåÊúâÂæàÂ§öÁªìÊûúÈÉΩ‰∏çÊòØÂæàÂáÜÁ°ÆÔºåËøôÂ∞±ÈúÄË¶ÅÊèê‰æõÊõ¥Â§öÁöÑËØ≠ÊñôËøõË°åËÆ≠ÁªÉ„ÄÇËÄå‰∏îËøòË¶ÅÂØπ‰ª£Á†ÅÈáåÁöÑÂêÑ‰∏™ÂèÇÊï∞ËøõË°åË∞É‰ºòÔºåÂπ∂ÁªìÂêàÊñáÊ°£ÁöÑÂÜÖÂÆπÔºåÂ§ßÂ∞èÔºåÊ†ºÂºèÁ≠âËøõË°åÂèÇÊï∞ÁöÑËÆæÂÆö„ÄÇ È°πÁõÆÁöÑÊ∫êÁ†ÅÂèØ‰ª•ÂèÇËÄÉÔºöhttps://github.com/hantmac/langchaingo-ollama-rag.git]]></content>
      <categories>
        <category>ollama</category>
      </categories>
      <tags>
        <tag>langchaingo</tag>
        <tag>ollama</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êï∞ÊçÆÂêåÊ≠•Â∑•ÂÖ∑ËÄÉÂè§]]></title>
    <url>%2F2024%2F02%2F07%2F%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E5%B7%A5%E5%85%B7%E8%80%83%E5%8F%A4%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂú®ËøáÂéªÁöÑ‰∏ÄÂπ¥ÈáåÔºåÊàëÈô§‰∫ÜÊó•Â∏∏ÁöÑ Databend Cloud ÂºÄÂèëÂ∑•‰Ωú‰πãÂ§ñÔºåËøòÂõ¥ÁªïÁùÄ Databend ÂÅö‰∫ÜÂ§ßÈáèÁöÑÊï∞ÊçÆÁîüÊÄÅÂ∑•‰Ωú„ÄÇËøôÂåÖÊã¨Âú® Databend Native ÂçèËÆÆÁöÑÂü∫Á°Ä‰∏äÊèê‰æõ‰∫ÜÂ§öËØ≠Ë®ÄÁöÑ SDKÔºåÂπ∂Âú® SDK Âü∫Á°Ä‰∏äÂ¢ûÂä†‰∫ÜÂØπËØ∏Â¶Ç Tableau„ÄÅMetabase„ÄÅSuperSet„ÄÅRedashÁ≠âBIÂ∑•ÂÖ∑ÁöÑÊîØÊåÅ„ÄÇÊ≠§Â§ñÔºåÊàëËøòÂÆåÂñÑ‰∫ÜÂÖ≥‰∫éÊï∞ÊçÆ‰º†ËæìÂíåÂÆûÊó∂ÂêåÊ≠•È¢ÜÂüüÁöÑÁîüÊÄÅÔºåÊ∂âÂèäÂà∞ Debezium Engine„ÄÅFlink CDC„ÄÅKafka Connect„ÄÅAirbyte„ÄÅDatax Plugin„ÄÅTapData Á≠âÂ∑•ÂÖ∑„ÄÇ Âú®Ëøô‰∏ÄÁ≥ªÂàóÁöÑÂ∑•‰Ωú‰∏≠ÔºåÊï∞ÊçÆÂêåÊ≠•ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÂÖ≥ÈîÆÁöÑÁéØËäÇÔºåÂÆÉÊûÑÂª∫‰∫ÜÁî®Êà∑‰ªéÂ§ñÈÉ®Êï∞ÊçÆ„ÄÅÊï∞ÊçÆÂ∫ìÂà∞ Databend ÁöÑÊ°•Ê¢Å„ÄÇËµ∑ÂàùÊàëÂØπ‰∫é‰∏Ä‰∫õÊµÅË°åÁöÑÊï∞ÊçÆÂêåÊ≠•Â∑•ÂÖ∑Âè™ÊòØÁï•ÊúâËÄ≥ÈóªÔºåÊúâ‰∫õÁîöËá≥‰ªéÊú™Âê¨ËØ¥ËøáÔºåÊõ¥‰∏ç‰∫ÜËß£ÂÆÉ‰ª¨ÁöÑÂÜÖÈÉ®ÂéüÁêÜ„ÄÇÈÄöËøá‰∏ÄÊÆµÊó∂Èó¥ÁöÑÊë∏Á¥¢ÂíåÂºÄÂèëÔºåÊàêÂäüÂÆûÁé∞‰∫ÜÂá†‰∏™Â∑•ÂÖ∑ÁöÑÊï¥Âêà‰πãÂêéÔºåÊàëÂØπËøô‰∫õÂ∑•ÂÖ∑ÂíåÂπ≥Âè∞Êúâ‰∫ÜÊõ¥Ê∑±ÂÖ•ÁöÑ‰∫ÜËß£„ÄÇ ÊâÄ‰ª•Âú®Êú¨Êñá‰∏≠ÔºåÊàëÂ∞ÜÂØπÂá†‰∏™ÁõÆÂâçÂπøÊ≥õ‰ΩøÁî®„ÄÅÊØîËæÉÊµÅË°åÁöÑÊï∞ÊçÆÂêåÊ≠•Â∑•ÂÖ∑ËøõË°åËÄÉÂè§„ÄÇËøôÂåÖÊã¨ÂÆÉ‰ª¨ÁöÑÂèëÂ±ïÂéÜÂè≤„ÄÅÊäÄÊúØÁâπÁÇπ‰ª•ÂèäÂú®ÂÆûÈôÖÂ∫îÁî®‰∏≠ÁöÑ‰ΩøÁî®ÊÉÖÂÜµ„ÄÇÈÄöËøáÂØπËøô‰∫õÂ∑•ÂÖ∑ÁöÑÂàÜÊûê‰ªãÁªçÔºåÂú®ÁªôËá™Â∑±ÂÅöÁ¨îËÆ∞ÁöÑÂêåÊó∂Â∏åÊúõËÉΩÂ§ü‰∏∫ÂÖ∂‰ªñËØªËÄÖÊèê‰æõÂØπÊï∞ÊçÆÂêåÊ≠•È¢ÜÂüüÁöÑÂÖ®Èù¢ËÆ§ËØÜ„ÄÇ Êï∞ÊçÆÂêåÊ≠•Â∑•ÂÖ∑Debezium1Debezium is an open source distributed platform for change data capture. Start it up, point it at your databases, and your apps can start responding to all of the inserts, updates, and deletes that other apps commit to your databases. Debezium is durable and fast, so your apps can respond quickly and never miss an event, even when things go wrong. Debezium ÊòØ‰∏ÄÁßç CDCÔºàChange Data CaptureÔºâÂ∑•ÂÖ∑ÔºåÂ∑•‰ΩúÂéüÁêÜÁ±ª‰ººÂ§ßÂÆ∂ÊâÄÁÜüÁü•ÁöÑ Canal, DataBus, Maxwell Á≠âÔºåÊòØÈÄöËøáÊäΩÂèñÊï∞ÊçÆÂ∫ìÊó•ÂøóÊù•Ëé∑ÂèñÂèòÊõ¥‰∫ã‰ª∂„ÄÇDebezium ÊúÄÂàùËÆæËÆ°Êàê‰∏Ä‰∏™ Kafka Connect ÁöÑ Source PluginÔºåÁõÆÂâçÂºÄÂèëËÄÖËôΩËá¥Âäõ‰∫éÂ∞ÜÂÖ∂‰∏é Kafka Connect Ëß£ËÄ¶„ÄÇ‰∏ãÂõæÂºïËá™ Debeizum ÂÆòÊñπÊñáÊ°£ÔºåÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™ Debezium Âú®‰∏Ä‰∏™ÂÆåÊï¥ CDC Á≥ªÁªü‰∏≠ÁöÑ‰ΩçÁΩÆ„ÄÇ Kafka Connect ‰∏∫ Source Plugin Êèê‰æõ‰∫Ü‰∏ÄÁ≥ªÂàóÁöÑÁºñÁ®ãÊé•Âè£ÔºåÊúÄ‰∏ªË¶ÅÁöÑÂ∞±ÊòØË¶ÅÂÆûÁé∞ SourceTask ÁöÑ poll ÊñπÊ≥ïÔºåÂÖ∂ËøîÂõû List Â∞Ü‰ºöË¢´‰ª•ÊúÄÂ∞ë‰∏ÄÊ¨°ËØ≠‰πâ(At Least Once)ÁöÑÊñπÂºèÊäïÈÄíËá≥ Kafka„ÄÇ Debezium ÊäΩÂèñÂéüÁêÜ‰∏ãÂõæÊòØ Debezium ‰ªé PG ‰∏≠ÊäΩÂèñÊï∞ÊçÆÂà∞ kafka topic ÁöÑÊµÅÁ®ãÔºåÂØπ‰∫é PG ËøûÊé•Âô®Êù•ËØ¥ÊòØ‰ªéÈÄªËæëÂ§çÂà∂ÊµÅËØªÂèñÂà∞ÂèòÊõ¥Êó•ÂøóÔºåÁªèÁî± kafka ÂèëÈÄÅÂà∞‰∏ãÊ∏∏ÁöÑÊï∞ÊçÆÂ§ÑÁêÜÊúçÂä°‰ª•ÂèäÁõ∏Â∫îÁöÑ writer plugin„ÄÇ ÂÜçÊù•Áúã‰∏ã Debezium MySQL Reader ÁöÑ‰ª£Á†ÅÔºåReader‰ΩìÁ≥ªÊûÑÊàê‰∫Ü MySQL Ê®°Âùó‰∏≠‰ª£Á†ÅÁöÑ‰∏ªÁ∫ø„ÄÇ Reader ÁöÑÁªßÊâøÂÖ≥Á≥ªÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö SnapshotReader Âíå BinlogReader ÂàÜÂà´ÂÆûÁé∞‰∫ÜÂØπ MySQL Êï∞ÊçÆÁöÑÂÖ®ÈáèËØªÂèñÂíåÂ¢ûÈáèËØªÂèñÔºå‰ªñ‰ª¨ÁªßÊâø‰∫é AbstractReaderÔºåÈáåÈù¢Â∞ÅË£Ö‰∫Ü‰∏Ä‰∫õÂÖ±Áî®ÁöÑÈÄªËæë‰ª£Á†Å„ÄÇAbstractReader ÁöÑÊµÅÁ®ãÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ‰ªéÂõæ‰∏≠ÂèØ‰ª•ÁúãÂà∞ AbstractReader Âú®ÂÆûÁé∞Êó∂ÔºåÂπ∂Ê≤°ÊúâÁõ¥Êé•Â∞Ü enqueue ËøõÊù•ÁöÑ event record Áõ¥Êé•ÂÜôÂà∞ KafkaÔºåËÄåÊòØÈÄöËøá‰∏Ä‰∏™ÂÜÖÂ≠òÈòªÂ°ûÈòüÂàóBlockingQueueËøõË°å‰∫ÜËß£ËÄ¶ÔºåËøôÊ†∑ÂÜôÁöÑÂ•ΩÂ§ÑÊòØÔºö ËÅåË¥£Ëß£ËÄ¶ Event Record Âú®ËøõÂÖ• BlockingQueue‰πãÂâçÔºåË¶ÅÊ†πÊçÆÊù°‰ª∂Âà§Êñ≠ÊòØÂê¶Êé•ÂèóËØ• recordÔºõÂú®Âêë Kafka ÊäïÈÄí record ‰πãÂâçÔºåÂà§Êñ≠ task ÁöÑ running Áä∂ÊÄÅ„ÄÇ Á∫øÁ®ãÈöîÁ¶ª BlockingQueue ÊòØ‰∏Ä‰∏™Á∫øÁ®ãÂÆâÂÖ®ÁöÑÈòªÂ°ûÈòüÂàóÔºåÈÄöËøá BlockingQueue ÂÆûÁé∞ÁöÑÁîü‰∫ßËÄÖÊ∂àË¥πËÄÖÊ®°ÂûãÔºåÊòØÂèØ‰ª•Ë∑ëÂú®‰∏çÂêåÁöÑÁ∫øÁ®ãÈáåÁöÑÔºåËøôÊ†∑ÈÅøÂÖçÂ±ÄÈÉ®ÁöÑÈòªÂ°ûÂ∏¶Êù•ÁöÑÊï¥‰ΩìÁöÑÂπ≤Êâ∞„ÄÇÂ¶Ç‰∏äÂõæÊâÄÁ§∫ÔºåÁ≥ªÁªü‰ºöÂÆöÊúüÂà§Êñ≠ running Ê†áÂøó‰ΩçÔºåËã• running Ë¢´stop‰ø°Âè∑ÁΩÆ‰∏∫‰∫ÜfalseÔºåÂèØ‰ª•Á´ãÂàªÂÅúÊ≠¢Êï¥‰∏™task,ËÄå‰∏ç‰ºöÂõ† MySQL IO ÈòªÂ°ûÂª∂ËøüÂìçÂ∫î„ÄÇ ÂçïÊù°‰∏éBatchÁöÑ‰∫íÁõ∏ËΩ¨Âåñ Enqueue record ÊòØÂçïÊù°ÁöÑÊäïÈÄí recordÔºådrain_to ÊòØÊâπÈáèÁöÑÊ∂àË¥π records„ÄÇËøô‰∏™Áî®Ê≥ï‰πüÂèØ‰ª•ÂèçËøáÊù•ÔºåÂÆûÁé∞ batch Âà∞ single ÁöÑËΩ¨Âåñ„ÄÇ ËÄå MySQL Connector ÊØèÊó•Ê¨°Ëé∑Âèñ snapshot ÁöÑÊó∂ÂÄôÂü∫Êú¨‰∏äÊòØÊ≤øÁî®‰∫Ü MySQL ÂÆòÊñπ‰ªéÂ∫ìÊê≠Âª∫ÁöÑÊñπÊ°àÔºåËØ¶ÁªÜÊ≠•È™§ÊòØÔºö Ëé∑Âèñ‰∏Ä‰∏™ÂÖ®Â±ÄËØªÈîÅÔºå‰ªéËÄåÈòªÂ°û‰ΩèÂÖ∂‰ªñÊï∞ÊçÆÂ∫ìÂÆ¢Êà∑Á´ØÁöÑÂÜôÊìç‰Ωú„ÄÇ ÂºÄÂêØ‰∏Ä‰∏™ÂèØÈáçÂ§çËØªËØ≠‰πâÁöÑ‰∫ãÂä°ÔºåÊù•‰øùËØÅÂêéÁª≠ÁöÑÂú®Âêå‰∏Ä‰∏™‰∫ãÂä°ÂÜÖËØªÊìç‰ΩúÈÉΩÊòØÂú®‰∏Ä‰∏™‰∏ÄËá¥ÊÄßÂø´ÁÖß‰∏≠ÂÆåÊàêÁöÑ„ÄÇ ËØªÂèñbinlogÁöÑÂΩìÂâç‰ΩçÁΩÆ„ÄÇ ËØªÂèñËøûÊé•Âô®‰∏≠ÈÖçÁΩÆÁöÑÊï∞ÊçÆÂ∫ìÂíåË°®ÁöÑÊ®°ÂºèÔºàschemaÔºâ‰ø°ÊÅØ„ÄÇ ÈáäÊîæÂÖ®Â±ÄËØªÈîÅÔºåÂÖÅËÆ∏ÂÖ∂‰ªñÁöÑÊï∞ÊçÆÂ∫ìÂÆ¢Êà∑Á´ØÂØπÊï∞ÊçÆÂ∫ìËøõË°åÂÜôÊìç‰Ωú„ÄÇ ÔºàÂèØÈÄâÔºâÊääDDLÊîπÂèò‰∫ã‰ª∂ÂÜôÂÖ•Ê®°ÂºèÊîπÂèò topicÔºàschema change topicÔºâÔºåÂåÖÊã¨ÊâÄÊúâÁöÑÂøÖË¶ÅÁöÑDROPÂíåCREATEDDLËØ≠Âè•„ÄÇ Êâ´ÊèèÊâÄÊúâÊï∞ÊçÆÂ∫ìÁöÑË°®ÔºåÂπ∂‰∏î‰∏∫ÊØè‰∏Ä‰∏™Ë°®‰∫ßÁîü‰∏Ä‰∏™ÂíåÁâπÂÆöË°®Áõ∏ÂÖ≥ÁöÑkafka topicÂàõÂª∫‰∫ã‰ª∂ÔºàÂç≥‰∏∫ÊØè‰∏Ä‰∏™Ë°®ÂàõÂª∫‰∏Ä‰∏™kafka topicÔºâ„ÄÇ Êèê‰∫§‰∫ãÂä°„ÄÇ ËÆ∞ÂΩïËøûÊé•Âô®ÊàêÂäüÂÆåÊàêÂø´ÁÖß‰ªªÂä°Êó∂ÁöÑËøûÊé•Âô®ÂÅèÁßªÈáè„ÄÇ ÈÉ®ÁΩ≤ÊñπÂºèÂü∫‰∫é Kafka ConnectÊúÄÂ∏∏ËßÅÁöÑÊû∂ÊûÑÊòØÈÄöËøá Apache Kafka Connect ÈÉ®ÁΩ≤ Debezium„ÄÇKafka Connect ‰∏∫Âú® Kafka ÂíåÂ§ñÈÉ®Â≠òÂÇ®Á≥ªÁªü‰πãÈó¥Á≥ªÁªüÊï∞ÊçÆÊèê‰æõ‰∫Ü‰∏ÄÁßçÂèØÈù†‰∏îÂèØ‰º∏Áº©ÊÄßÁöÑÊñπÂºè„ÄÇÂÆÉ‰∏∫ Connector Êèí‰ª∂Êèê‰æõ‰∫Ü‰∏ÄÁªÑ API Âíå‰∏Ä‰∏™ËøêË°åÊó∂ÔºöConnect Ë¥üË¥£ËøêË°åËøô‰∫õÊèí‰ª∂ÔºåÂÆÉ‰ª¨ÂàôË¥üË¥£ÁßªÂä®Êï∞ÊçÆ„ÄÇÈÄöËøá Kafka Connect ÂèØ‰ª•Âø´ÈÄüÂÆûÁé∞ Source Connector Âíå Sink Connector ËøõË°å‰∫§‰∫íÊûÑÈÄ†‰∏Ä‰∏™‰ΩéÂª∂ËøüÁöÑÊï∞ÊçÆ PipelineÔºö Source ConnectorÔºà‰æãÂ¶ÇÔºåDebeziumÔºâÔºöÂ∞ÜËÆ∞ÂΩïÂèëÈÄÅÂà∞ Kafka Sink ConnectorÔºöÂ∞Ü Kafka Topic ‰∏≠ÁöÑËÆ∞ÂΩïÂèëÈÄÅÂà∞ÂÖ∂‰ªñÁ≥ªÁªü Â¶Ç‰∏äÂõæÊâÄÁ§∫ÔºåÈÉ®ÁΩ≤‰∫Ü MySQL Âíå PostgresSQL ÁöÑ Debezium Connector ‰ª•ÊçïËé∑Ëøô‰∏§ÁßçÁ±ªÂûãÊï∞ÊçÆÂ∫ìÁöÑÂèòÊõ¥„ÄÇÊØè‰∏™ Debezium Connector ÈÉΩ‰ºö‰∏éÂÖ∂Ê∫êÊï∞ÊçÆÂ∫ìÂª∫Á´ãËøûÊé•Ôºö MySQL Connector ‰ΩøÁî®ÂÆ¢Êà∑Á´ØÂ∫ìÊù•ËÆøÈóÆ binlog„ÄÇ PostgreSQL Connector ‰ªéÈÄªËæëÂâØÊú¨ÊµÅ‰∏≠ËØªÂèñÊï∞ÊçÆ„ÄÇ Èô§‰∫Ü Kafka Broker ‰πãÂ§ñÔºåKafka Connect ‰πü‰Ωú‰∏∫‰∏Ä‰∏™ÂçïÁã¨ÁöÑÊúçÂä°ËøêË°å„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊï∞ÊçÆÂ∫ìË°®ÁöÑÂèòÊõ¥‰ºöÂÜôÂÖ•ÂêçÁß∞‰∏éË°®ÂêçÁß∞ÂØπÂ∫îÁöÑ Kafka Topic ‰∏≠„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÔºåÊÇ®ÂèØ‰ª•ÈÄöËøáÈÖçÁΩÆ Debezium ÁöÑ Topic Ë∑ØÁî±ËΩ¨Êç¢Êù•Ë∞ÉÊï¥ÁõÆÊ†á Topic ÂêçÁß∞„ÄÇ‰æãÂ¶ÇÔºåÊÇ®ÂèØ‰ª•Ôºö Â∞ÜËÆ∞ÂΩïË∑ØÁî±Âà∞ÂêçÁß∞‰∏éË°®Âêç‰∏çÂêåÁöÑ Topic ‰∏≠ Â∞ÜÂ§ö‰∏™Ë°®ÁöÑÂèòÊõ¥‰∫ã‰ª∂ËÆ∞ÂΩïÊµÅÂºè‰º†ËæìÂà∞‰∏Ä‰∏™ Topic ‰∏≠ ÂèòÊõ¥‰∫ã‰ª∂ËÆ∞ÂΩïÂú® Apache Kafka ‰∏≠ÂêéÔºåKafka Connect ÁîüÊÄÅÁ≥ªÁªü‰∏≠ÁöÑ‰∏çÂêå Sink Connector ÂèØ‰ª•Â∞ÜËÆ∞ÂΩïÊµÅÂºè‰º†ËæìÂà∞ÂÖ∂‰ªñÁ≥ªÁªü„ÄÅÊï∞ÊçÆÂ∫ìÔºå‰æãÂ¶Ç Elasticsearch„ÄÅDatabend„ÄÅÂàÜÊûêÁ≥ªÁªüÊàñËÄÖÁºìÂ≠ò„ÄÇ Âü∫‰∫éDebezium ServerÁ¨¨‰∫åÁßçÈÉ®ÁΩ≤ Debezium ÁöÑÊñπÊ≥ïÊòØ‰ΩøÁî® Debezium Server„ÄÇDebezium Server ÊòØ‰∏Ä‰∏™ÂèØÈÖçÁΩÆÁöÑ„ÄÅÈöèÊó∂ÂèØÁî®ÁöÑÂ∫îÁî®Á®ãÂ∫èÔºåÂèØ‰ª•Â∞ÜÂèòÊõ¥‰∫ã‰ª∂‰ªéÊ∫êÊï∞ÊçÆÂ∫ìÊµÅÂºè‰º†ËæìÂà∞ÂêÑÁßçÊ∂àÊÅØ‰∏≠Èó¥‰ª∂‰∏ä„ÄÇ ‰∏ãÂõæÂ±ïÁ§∫‰∫ÜÂü∫‰∫é Debezium Server ÁöÑÂèòÊõ¥Êï∞ÊçÆÊçïËé∑ Pipeline Êû∂ÊûÑÔºö Debezium Server ÈÖçÁΩÆ‰ΩøÁî® Debezium Source Connector Êù•ÊçïËé∑Ê∫êÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂèòÊõ¥„ÄÇÂèòÊõ¥‰∫ã‰ª∂ÂèØ‰ª•Â∫èÂàóÂåñ‰∏∫‰∏çÂêåÁöÑÊ†ºÂºèÔºå‰æãÂ¶Ç JSON Êàñ Apache AvroÔºåÁÑ∂ÂêéÂèëÈÄÅÂà∞ÂêÑÁßçÊ∂àÊÅØ‰∏≠Èó¥‰ª∂Ôºå‰æãÂ¶Ç Amazon Kinesis„ÄÅApache Pulsar„ÄÇ Âü∫‰∫é Debezium Engine‰ΩøÁî® Debezium Connector ÁöÑÂè¶‰∏ÄÁßçÊñπÊ≥ïÊòØÂü∫‰∫é Debezium Engine„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåDebezium ‰∏ç‰ºöÈÄöËøá Kafka Connect ËøêË°åÔºåËÄåÊòØ‰Ωú‰∏∫ÂµåÂÖ•Âà∞Áî®Êà∑Ëá™ÂÆö‰πâ Java Â∫îÁî®Á®ãÂ∫è‰∏≠ÁöÑÂ∫ìËøêË°å„ÄÇËøôÂØπ‰∫éÂú®Â∫îÁî®Á®ãÂ∫èÊú¨Ë∫´Ëé∑ÂèñÂèòÊõ¥‰∫ã‰ª∂ÈùûÂ∏∏ÊúâÂ∏ÆÂä©ÔºåÊó†ÈúÄÈÉ®ÁΩ≤ÂÆåÊï¥ÁöÑ Kafka Âíå Kafka Connect ÈõÜÁæ§Ôºå‰πü‰∏çÁî®Â∞ÜÂèòÊõ¥ÊµÅÂºè‰º†ËæìÂà∞Ê∂àÊÅØ‰∏≠Èó¥‰ª∂‰∏ä„ÄÇËøôÁØáÊñáÁ´†Â±ïÁ§∫‰∫ÜÂ¶Ç‰Ωï‰ΩøÁî® Debezium Databend Server ÂÆûÁé∞‰ªé MySQL ÁöÑÊï∞ÊçÆÂÖ®Â¢ûÈáèÂêåÊ≠•„ÄÇ ÁâπÊÄßÊÄªÁªìDebezium ÊòØ‰∏ÄÁªÑÁî®‰∫é Apache Kafka Connect ÁöÑ Source Connector„ÄÇÊØè‰∏™ Connector ÈÉΩÈÄöËøá‰ΩøÁî®ËØ•Êï∞ÊçÆÂ∫ìÁöÑÂèòÊõ¥Êï∞ÊçÆÊçïËé∑ (CDC) ÂäüËÉΩ‰ªé‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ì‰∏≠Ëé∑ÂèñÂèòÊõ¥„ÄÇ‰∏éÂÖ∂‰ªñÊñπÊ≥ïÔºà‰æãÂ¶ÇËΩÆËØ¢ÊàñÂèåÈáçÂÜôÂÖ•Ôºâ‰∏çÂêåÔºåDebezium ÁöÑÂÆûÁé∞Âü∫‰∫éÊó•ÂøóÁöÑ CDCÔºö Á°Æ‰øùÊçïËé∑ÊâÄÊúâÁöÑÊï∞ÊçÆÂèòÊõ¥„ÄÇ ‰ª•ÊûÅ‰ΩéÁöÑÂª∂ËøüÁîüÊàêÂèòÊõ¥‰∫ã‰ª∂ÔºåÂêåÊó∂ÈÅøÂÖçÂõ†‰∏∫È¢ëÁπÅËΩÆËØ¢ÂØºËá¥ CPU ‰ΩøÁî®ÁéáÂ¢ûÂä†„ÄÇ‰æãÂ¶ÇÔºåÂØπ‰∫é MySQL Êàñ PostgreSQLÔºåÂª∂ËøüÂú®ÊØ´ÁßíËåÉÂõ¥ÂÜÖ„ÄÇ ‰∏çÈúÄË¶ÅÊõ¥ÊîπÊï∞ÊçÆÊ®°ÂûãÔºå‰æãÂ¶ÇÂ¢ûÂä† ‚ÄòLast Updated‚Äô Âàó„ÄÇ ÂèØ‰ª•ÊçïËé∑Âà†Èô§Êìç‰Ωú„ÄÇ ÂèØ‰ª•ÊçïËé∑ÊóßËÆ∞ÂΩïÁä∂ÊÄÅ‰ª•ÂèäÂÖ∂‰ªñÂÖÉÊï∞ÊçÆÔºå‰æãÂ¶ÇÔºå‰∫ãÂä° IDÔºåÂÖ∑‰ΩìÂèñÂÜ≥‰∫éÊï∞ÊçÆÂ∫ìÁöÑÂäüËÉΩÂíåÈÖçÁΩÆ„ÄÇ Flink CDCFlink CDC ÊòØÂü∫‰∫éÊï∞ÊçÆÂ∫ìÊó•Âøó CDCÔºàChange Data CaptureÔºâÊäÄÊúØÁöÑÂÆûÊó∂Êï∞ÊçÆÈõÜÊàêÊ°ÜÊû∂ÔºåÊîØÊåÅ‰∫ÜÂÖ®Â¢ûÈáè‰∏Ä‰ΩìÂåñ„ÄÅÊó†ÈîÅËØªÂèñ„ÄÅÂπ∂Ë°åËØªÂèñ„ÄÅË°®ÁªìÊûÑÂèòÊõ¥Ëá™Âä®ÂêåÊ≠•„ÄÅÂàÜÂ∏ÉÂºèÊû∂ÊûÑÁ≠âÈ´òÁ∫ßÁâπÊÄß„ÄÇFlink CDC ÂèëÂ±ï‰∫Ü‰∏âÂπ¥Â§öÁöÑÊó∂Èó¥„ÄÇ2020 Âπ¥Ôºå‰ªé‰Ωú‰∏∫‰∏™‰∫∫ÁöÑ Side project Âá∫ÂèëÔºåÂêéÊù•Ë¢´Ë∂äÊù•Ë∂äÂ§ö‰∫∫ËÆ§ËØÜÂà∞„ÄÇ Flink CDC Ëø≠‰ª£ÂéÜÁ®ã1.0Flink CDC 1.0 ÊØîÁÆÄÂçïÔºåÁõ¥Êé•Â∞±ÊòØÂ∫ïÂ±ÇÂ∞ÅË£Ö‰∫Ü DebeziumÔºå ËÄå Debezium ÂêåÊ≠•‰∏ÄÂº†Ë°®ÂàÜ‰∏∫‰∏§‰∏™Èò∂ÊÆµÔºö ÂÖ®ÈáèÈò∂ÊÆµÔºöÊü•ËØ¢ÂΩìÂâçË°®‰∏≠ÊâÄÊúâËÆ∞ÂΩïÔºõ Â¢ûÈáèÈò∂ÊÆµÔºö‰ªé binlog Ê∂àË¥πÂèòÊõ¥Êï∞ÊçÆ„ÄÇ Â§ßÈÉ®ÂàÜÁî®Êà∑‰ΩøÁî®ÁöÑÂú∫ÊôØÈÉΩÊòØÂÖ®Èáè + Â¢ûÈáèÂêåÊ≠•ÔºåÂä†ÈîÅÊòØÂèëÁîüÂú®ÂÖ®ÈáèÈò∂ÊÆµÔºåÁõÆÁöÑÊòØ‰∏∫‰∫ÜÁ°ÆÂÆöÂÖ®ÈáèÈò∂ÊÆµÁöÑÂàùÂßã‰ΩçÁÇπÔºå‰øùËØÅÂ¢ûÈáè + ÂÖ®ÈáèÂÆûÁé∞‰∏ÄÊù°‰∏çÂ§öÔºå‰∏ÄÊù°‰∏çÂ∞ëÔºå‰ªéËÄå‰øùËØÅÊï∞ÊçÆ‰∏ÄËá¥ÊÄß„ÄÇ‰ªé‰∏ãÂõæ‰∏≠Êàë‰ª¨ÂèØ‰ª•ÂàÜÊûêÂÖ®Â±ÄÈîÅÂíåË°®ÈîÅÁöÑ‰∏Ä‰∫õÂä†ÈîÅÊµÅÁ®ãÔºåÂ∑¶ËæπÁ∫¢Ëâ≤Á∫øÊù°ÊòØÈîÅÁöÑÁîüÂëΩÂë®ÊúüÔºåÂè≥ËæπÊòØ MySQL ÂºÄÂêØÂèØÈáçÂ§çËØª‰∫ãÂä°ÁöÑÁîüÂëΩÂë®Êúü„ÄÇ ‰ª•ÂÖ®Â±ÄÈîÅ‰∏∫‰æãÔºåÈ¶ñÂÖàÊòØËé∑Âèñ‰∏Ä‰∏™ÈîÅÔºåÁÑ∂ÂêéÂÜçÂéªÂºÄÂêØÂèØÈáçÂ§çËØªÁöÑ‰∫ãÂä°„ÄÇËøôÈáåÈîÅ‰ΩèÊìç‰ΩúÊòØËØªÂèñ binlog ÁöÑËµ∑Âßã‰ΩçÁΩÆÂíåÂΩìÂâçË°®ÁöÑ schema„ÄÇËøôÊ†∑ÂÅöÁöÑÁõÆÁöÑÊòØ‰øùËØÅ binlog ÁöÑËµ∑Âßã‰ΩçÁΩÆÂíåËØªÂèñÂà∞ÁöÑÂΩìÂâç schema ÊòØÂèØ‰ª•ÂØπÂ∫î‰∏äÁöÑÔºåÂõ†‰∏∫Ë°®ÁöÑ schema ÊòØ‰ºöÊîπÂèòÁöÑÔºåÊØîÂ¶ÇÂ¶ÇÂà†Èô§ÂàóÊàñËÄÖÂ¢ûÂä†Âàó„ÄÇÂú®ËØªÂèñËøô‰∏§‰∏™‰ø°ÊÅØÂêéÔºåSnapshotReader ‰ºöÂú®ÂèØÈáçÂ§çËØª‰∫ãÂä°ÈáåËØªÂèñÂÖ®ÈáèÊï∞ÊçÆÔºåÂú®ÂÖ®ÈáèÊï∞ÊçÆËØªÂèñÂÆåÊàêÂêéÔºå‰ºöÂêØÂä® BinlogReader ‰ªéËØªÂèñÁöÑ binlog Ëµ∑Âßã‰ΩçÁΩÆÂºÄÂßãÂ¢ûÈáèËØªÂèñÔºå‰ªéËÄå‰øùËØÅÂÖ®ÈáèÊï∞ÊçÆ + Â¢ûÈáèÊï∞ÊçÆÁöÑÊó†ÁºùË°îÊé•„ÄÇ Ë°®ÈîÅÊòØÂÖ®Â±ÄÈîÅÁöÑÈÄÄÂåñÁâàÔºåÂõ†‰∏∫ÂÖ®Â±ÄÈîÅÁöÑÊùÉÈôê‰ºöÊØîËæÉÈ´òÔºåÂõ†Ê≠§Âú®Êüê‰∫õÂú∫ÊôØÔºåÁî®Êà∑Âè™ÊúâË°®ÈîÅ„ÄÇË°®ÈîÅÈîÅÁöÑÊó∂Èó¥‰ºöÊõ¥ÈïøÔºåÂõ†‰∏∫Ë°®ÈîÅÊúâ‰∏™ÁâπÂæÅÔºöÈîÅÊèêÂâçÈáäÊîæ‰∫ÜÂèØÈáçÂ§çËØªÁöÑ‰∫ãÂä°ÈªòËÆ§‰ºöÊèê‰∫§ÔºåÊâÄ‰ª•ÈîÅÈúÄË¶ÅÁ≠âÂà∞ÂÖ®ÈáèÊï∞ÊçÆËØªÂÆåÂêéÊâçËÉΩÈáäÊîæ„ÄÇËÄå FLUSH TABLE WITH READ LOCK ÁöÑÊìç‰Ωú‰ºöÂ≠òÂú®‰ª•‰∏ãÈóÆÈ¢òÔºö ËØ•ÂëΩ‰ª§Á≠âÂæÖÊâÄÊúâÊ≠£Âú®ËøõË°åÁöÑ update ÂÆåÊàêÔºåÂêåÊó∂ÈòªÊ≠¢ÊâÄÊúâÊñ∞Êù•ÁöÑ update; ÊâßË°åÊàêÂäü‰πãÂâçÂøÖÈ°ªÁ≠âÂæÖÊâÄÊúâÊ≠£Âú®ËøêË°åÁöÑ select ÂÆåÊàêÔºåÁ≠âÂæÖÊâßË°åÁöÑ update Â∞±‰ºöÁ≠âÂæÖÁöÑÊõ¥‰πÖ„ÄÇ ‰ºöÈòªÊ≠¢ÂÖ∂‰ªñÁöÑ‰∫ãÂä° commit„ÄÇ ÊâÄ‰ª•ÂØπ‰∫éÂä†ÈîÅÊù•ËØ¥Âú®Êó∂Èó¥‰∏äÊòØ‰∏çÁ°ÆÂÆöÁöÑÔºå‰∏•ÈáçÁöÑÂèØËÉΩ‰ºö hang ‰ΩèÊï∞ÊçÆÂ∫ì„ÄÇ ÂΩìÁÑ∂ÔºåFlink CDC 1.x ÁâàÊú¨‰πüÂèØ‰ª•‰∏çÂä†ÈîÅÔºå‰ΩÜÊòØ‰ºö‰∏¢Â§±‰∏ÄÂÆöÁöÑÊï∞ÊçÆÂáÜÁ°ÆÊÄß„ÄÇÊÄªÁöÑÊù•ËØ¥ 1.x Â≠òÂú®ÁöÑÈóÆÈ¢òÊòØÔºö ÂÖ®Èáè + Â¢ûÈáèËØªÂèñÁöÑËøáÁ®ãÈúÄË¶Å‰øùËØÅÊâÄÊúâÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºåÂõ†Ê≠§ÈúÄË¶ÅÈÄöËøáÂä†ÈîÅ‰øùËØÅÔºå‰ΩÜÊòØÂä†ÈîÅÂú®Êï∞ÊçÆÂ∫ìÂ±ÇÈù¢‰∏äÊòØ‰∏Ä‰∏™ÂçÅÂàÜÈ´òÂç±ÁöÑÊìç‰Ωú„ÄÇÂ∫ïÂ±Ç Debezium Âú®‰øùËØÅÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÊó∂ÔºåÈúÄË¶ÅÂØπËØªÂèñÁöÑÂ∫ìÊàñË°®Âä†ÈîÅÔºåÂÖ®Â±ÄÈîÅÂèØËÉΩÂØºËá¥Êï∞ÊçÆÂ∫ìÈîÅ‰ΩèÔºåË°®Á∫ßÈîÅ‰ºöÈîÅ‰ΩèË°®ÁöÑËØªÔºåDBA ‰∏ÄËà¨‰∏çÁªôÈîÅÊùÉÈôê„ÄÇ ‰∏çÊîØÊåÅÊ∞¥Âπ≥Êâ©Â±ïÔºåÂõ†‰∏∫ Flink CDC Â∫ïÂ±ÇÊòØÂü∫‰∫é DebeziumÔºåËµ∑Êû∂ÊûÑÊòØÂçïËäÇÁÇπÔºåÊâÄ‰ª•Flink CDC Âè™ÊîØÊåÅÂçïÂπ∂Âèë„ÄÇÂú®ÂÖ®ÈáèÈò∂ÊÆµËØªÂèñÈò∂ÊÆµÔºåÂ¶ÇÊûúË°®ÈùûÂ∏∏Â§ß (‰∫øÁ∫ßÂà´)ÔºåËØªÂèñÊó∂Èó¥Âú®Â∞èÊó∂ÁîöËá≥Â§©Á∫ßÂà´ÔºåÁî®Êà∑‰∏çËÉΩÈÄöËøáÂ¢ûÂä†ËµÑÊ∫êÂéªÊèêÂçá‰Ωú‰∏öÈÄüÂ∫¶„ÄÇ ÂÖ®ÈáèËØªÂèñÈò∂ÊÆµ‰∏çÊîØÊåÅ checkpointÔºöCDC ËØªÂèñÂàÜ‰∏∫‰∏§‰∏™Èò∂ÊÆµÔºåÂÖ®ÈáèËØªÂèñÂíåÂ¢ûÈáèËØªÂèñÔºåÁõÆÂâçÂÖ®ÈáèËØªÂèñÈò∂ÊÆµÊòØ‰∏çÊîØÊåÅ checkpoint ÁöÑÔºåÂõ†Ê≠§‰ºöÂ≠òÂú®‰∏Ä‰∏™ÈóÆÈ¢òÔºöÂΩìÊàë‰ª¨ÂêåÊ≠•ÂÖ®ÈáèÊï∞ÊçÆÊó∂ÔºåÂÅáËÆæÈúÄË¶Å 5 ‰∏™Â∞èÊó∂ÔºåÂΩìÊàë‰ª¨ÂêåÊ≠•‰∫Ü 4 Â∞èÊó∂ÁöÑÊó∂ÂÄô‰Ωú‰∏öÂ§±Ë¥•ÔºåËøôÊó∂ÂÄôÂ∞±ÈúÄË¶ÅÈáçÊñ∞ÂºÄÂßãÔºåÂÜçËØªÂèñ 5 ‰∏™Â∞èÊó∂„ÄÇ 2.0‰∫ÜËß£‰∫Ü 1.0 ÁöÑÁóõÁÇπ‰πãÂêéÔºå2.0 ‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÈóÆÈ¢òÊúâ‰∏â‰∏™ÔºöÊîØÊåÅÊó†ÈîÅ„ÄÅÊ∞¥Âπ≥Êâ©Â±ï„ÄÅcheckpoint„ÄÇ Flink CDC 2.0 Âú®ÂÄüÈâ¥‰∫Ü Netflix ËøôÁØáËÆ∫Êñá ‰πãÂêéÂèØ‰ª•ÂÅöÂà∞ÂÖ®Á®ãÊó†ÈîÅÂíåÂπ∂ÂèëËØªÂèñ„ÄÇ 3.0 Flink CDC 3.0 Êã•Êúâ‰∫ÜÊõ¥Â§öÊï∞ÊçÆÂêåÊ≠•ËøáÁ®ã‰∏≠ÁöÑÂÆûÁî®ÁâπÊÄßÔºåÊàê‰∏∫‰∫Ü‰∏Ä‰∏™Á´ØÂà∞Á´ØÁöÑÊï∞ÊçÆÈõÜÊàêÊ°ÜÊû∂Ôºö ‰∏äÊ∏∏ schema ÂèòÊõ¥Ëá™Âä®ÂêåÊ≠•Âà∞‰∏ãÊ∏∏ÔºåÂ∑≤Êúâ‰Ωú‰∏öÊîØÊåÅÂä®ÊÄÅÂä†Ë°® Á©∫Èó≤ËµÑÊ∫êËá™Âä®ÂõûÊî∂Ôºå‰∏Ä‰∏™ sink ÂÆû‰æãÊîØÊåÅÂÜôÂÖ•Â§öË°® API ËÆæËÆ°Áõ¥Êé•Èù¢ÂêëÊï∞ÊçÆÈõÜÊàêÂú∫ÊôØÔºåÂ∏ÆÂä©Áî®Êà∑ËΩªÊùæÊûÑÂª∫ÂêåÊ≠•‰Ωú‰∏ö Databend ‰πüÊèê‰æõ‰∫Ü Flink-Databend-ConnectorÔºåËøôÁØáÊñáÁ´†Â±ïÁ§∫‰∫ÜÂ¶Ç‰Ωï‰ΩøÁî® databend connector ÂÆûÁé∞‰ªé MySQL ÁöÑÊï∞ÊçÆÂêåÊ≠•„ÄÇ Canalcanal [k…ô‚Äôn√¶l]ÔºåËØëÊÑè‰∏∫Ê∞¥ÈÅì/ÁÆ°ÈÅì/Ê≤üÊ∏†Ôºå‰∏ªË¶ÅÁî®ÈÄîÊòØÂü∫‰∫é MySQL Êï∞ÊçÆÂ∫ìÂ¢ûÈáèÊó•ÂøóËß£ÊûêÔºåÊèê‰æõÂ¢ûÈáèÊï∞ÊçÆËÆ¢ÈòÖÂíåÊ∂àË¥π„ÄÇ Êó©ÊúüÈòøÈáåÂ∑¥Â∑¥Âõ†‰∏∫Êù≠Â∑ûÂíåÁæéÂõΩÂèåÊú∫ÊàøÈÉ®ÁΩ≤ÔºåÂ≠òÂú®Ë∑®Êú∫ÊàøÂêåÊ≠•ÁöÑ‰∏öÂä°ÈúÄÊ±ÇÔºåÂÆûÁé∞ÊñπÂºè‰∏ªË¶ÅÊòØÂü∫‰∫é‰∏öÂä° trigger Ëé∑ÂèñÂ¢ûÈáèÂèòÊõ¥„ÄÇ‰ªé 2010 Âπ¥ÂºÄÂßãÔºå‰∏öÂä°ÈÄêÊ≠•Â∞ùËØïÊï∞ÊçÆÂ∫ìÊó•ÂøóËß£ÊûêËé∑ÂèñÂ¢ûÈáèÂèòÊõ¥ËøõË°åÂêåÊ≠•ÔºåÁî±Ê≠§Ë°çÁîüÂá∫‰∫ÜÂ§ßÈáèÁöÑÊï∞ÊçÆÂ∫ìÂ¢ûÈáèËÆ¢ÈòÖÂíåÊ∂àË¥π‰∏öÂä°„ÄÇ Âü∫‰∫éÊó•ÂøóÂ¢ûÈáèËÆ¢ÈòÖÂíåÊ∂àË¥πÁöÑ‰∏öÂä°ÂåÖÊã¨Ôºö Êï∞ÊçÆÂ∫ìÈïúÂÉè Êï∞ÊçÆÂ∫ìÂÆûÊó∂Â§á‰ªΩ Á¥¢ÂºïÊûÑÂª∫ÂíåÂÆûÊó∂Áª¥Êä§(ÊãÜÂàÜÂºÇÊûÑÁ¥¢Âºï„ÄÅÂÄíÊéíÁ¥¢ÂºïÁ≠â) ‰∏öÂä° cache Âà∑Êñ∞ Â∏¶‰∏öÂä°ÈÄªËæëÁöÑÂ¢ûÈáèÊï∞ÊçÆÂ§ÑÁêÜ ÂΩìÂâçÁöÑcanalÊîØÊåÅÊ∫êÁ´ØMySQLÁâàÊú¨ÂåÖÊã¨ 5.1.x , 5.5.x , 5.6.x , 5.7.x , 8.0.x„ÄÇ canal Â∑•‰ΩúÂéüÁêÜ canal Ê®°Êãü MySQL slave ÁöÑ‰∫§‰∫íÂçèËÆÆÔºå‰º™Ë£ÖËá™Â∑±‰∏∫MySQL slave,ÂêëMySQL masterÂèëÈÄÅdumpÂçèËÆÆ MySQL masterÊî∂Âà∞ dump ËØ∑Ê±ÇÔºåÂºÄÂßãÊé®ÈÄÅ binary log Áªô slave (Âç≥ canal ) canal Ëß£Êûê binary log ÂØπË±°(ÂéüÂßã‰∏∫ byte ÊµÅ) BinlogËé∑ÂèñËØ¶Ëß£BinlogÂèëÈÄÅÊé•Êî∂ÊµÅÁ®ãÔºåÊµÅÁ®ãÂ¶Ç‰∏ãÂõæÊâÄÁ§∫: È¶ñÂÖàÔºåÊàë‰ª¨ÈúÄË¶Å‰º™ÈÄ†‰∏Ä‰∏™slaveÔºåÂêëmasterÊ≥®ÂÜåÔºåËøôÊ†∑masterÊâç‰ºöÂèëÈÄÅbinlog event„ÄÇÊ≥®ÂÜåÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂêëmasterÂèëÈÄÅCOM_REGISTER_SLAVEÂëΩ‰ª§ÔºåÂ∏¶‰∏äslaveÁõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÔºåÂõ†‰∏∫Âú®MySQLÁöÑreplication topology‰∏≠ÔºåÈÉΩÈúÄË¶Å‰ΩøÁî®‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑserver idÊù•Âå∫Âà´Ê†áÁ§∫‰∏çÂêåÁöÑserverÂÆû‰æãÔºåÊâÄ‰ª•ËøôÈáåÊàë‰ª¨‰º™ÈÄ†ÁöÑslave‰πüÈúÄË¶Å‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑserver id„ÄÇ Êé•ÁùÄÂÆûÁé∞binlogÁöÑdump„ÄÇMySQLÂè™ÊîØÊåÅ‰∏ÄÁßç binlog dumpÊñπÂºèÔºå‰πüÂ∞±ÊòØÊåáÂÆöbinlog filename + positionÔºåÂêëmasterÂèëÈÄÅCOM_BINLOG_DUMPÂëΩ‰ª§„ÄÇÂú®ÂèëÈÄÅdumpÂëΩ‰ª§ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•ÊåáÂÆöflag‰∏∫BINLOG_DUMP_NON_BLOCKÔºåËøôÊ†∑masterÂú®Ê≤°ÊúâÂèØÂèëÈÄÅÁöÑbinlog event‰πãÂêéÔºåÂ∞±‰ºöËøîÂõû‰∏Ä‰∏™EOF package„ÄÇ‰∏çËøáÈÄöÂ∏∏ÂØπ‰∫éslaveÊù•ËØ¥Ôºå‰∏ÄÁõ¥ÊääËøûÊé•ÊåÇÁùÄÂèØËÉΩÊõ¥Â•ΩÔºåËøôÊ†∑ËÉΩÊõ¥ÂèäÊó∂Êî∂Âà∞Êñ∞‰∫ßÁîüÁöÑbinlog event„ÄÇ Canal Êû∂ÊûÑ server‰ª£Ë°®‰∏Ä‰∏™canalËøêË°åÂÆû‰æãÔºåÂØπÂ∫î‰∫é‰∏Ä‰∏™jvmÔºå‰πüÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™ËøõÁ®ã instanceÂØπÂ∫î‰∫é‰∏Ä‰∏™Êï∞ÊçÆÈòüÂàó Ôºà1‰∏™serverÂØπÂ∫î1..n‰∏™instance)ÔºåÊØè‰∏Ä‰∏™Êï∞ÊçÆÈòüÂàóÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÂÆû‰æã„ÄÇ instance‰ª£Ë°®‰∫Ü‰∏Ä‰∏™ÂÆûÈôÖËøêË°åÁöÑÊï∞ÊçÆÈòüÂàóÔºåÂåÖÊã¨‰∫ÜEventPaser,EventSink,EventStoreÁ≠âÁªÑ‰ª∂„ÄÇ ÊäΩË±°‰∫ÜCanalInstanceGeneratorÔºå‰∏ªË¶ÅÊòØËÄÉËôëÈÖçÁΩÆÁöÑÁÆ°ÁêÜÊñπÂºèÔºö managerÊñπÂºèÔºöÂíå‰Ω†Ëá™Â∑±ÁöÑÂÜÖÈÉ®web console/managerÁ≥ªÁªüËøõË°åÂØπÊé•„ÄÇ(ÁõÆÂâç‰∏ªË¶ÅÊòØÂÖ¨Âè∏ÂÜÖÈÉ®‰ΩøÁî®ÔºåOtterÈááÁî®ËøôÁßçÊñπÂºè) springÊñπÂºèÔºöÂü∫‰∫éspring xml + propertiesËøõË°åÂÆö‰πâÔºåÊûÑÂª∫springÈÖçÁΩÆ. ‰∏ãÈù¢ÊòØ canalServer Âíå instance ‰ª£Á†ÅÔºö 12345678910111213141516171819202122232425262728293031323334canalServer.setCanalInstanceGenerator(new CanalInstanceGenerator() &#123; public CanalInstance generate(String destination) &#123; Canal canal = canalConfigClient.findCanal(destination); // Ê≠§Â§ÑÁúÅÁï•ÈÉ®ÂàÜ‰ª£Á†Å Â§ßËá¥ÈÄªËæëÊòØËÆæÁΩÆcanal‰∏Ä‰∫õÂ±ûÊÄß CanalInstanceWithManager instance = new CanalInstanceWithManager(canal, filter) &#123; protected CanalHAController initHaController() &#123; HAMode haMode = parameters.getHaMode(); if (haMode.isMedia()) &#123; return new MediaHAController(parameters.getMediaGroup(), parameters.getDbUsername(), parameters.getDbPassword(), parameters.getDefaultDatabaseName()); &#125; else &#123; return super.initHaController(); &#125; &#125; protected void startEventParserInternal(CanalEventParser parser, boolean isGroup) &#123; //Â§ßËá¥ÈÄªËæëÊòØ ËÆæÁΩÆÊîØÊåÅÁöÑÁ±ªÂûã //ÂàùÂßãÂåñËÆæÁΩÆMysqlEventParserÁöÑ‰∏ªÂ∫ì‰ø°ÊÅØÔºåËøôÂ§ÑÊäΩË±°‰∏çÂ•ΩÔºåÁõÆÂâçÂè™ÊîØÊåÅmysql &#125; &#125;; return instance; &#125; &#125;); canalServer.start(); //ÂêØÂä®canalServer canalServer.start(destination);//ÂêØÂä®ÂØπÂ∫îinstance this.clientIdentity = new ClientIdentity(destination, pipeline.getParameters().getMainstemClientId(), filter); canalServer.subscribe(clientIdentity);// ÂèëËµ∑‰∏ÄÊ¨°ËÆ¢ÈòÖÔºåÂΩìÁõëÂê¨Âà∞instanceÈÖçÁΩÆÊó∂ÔºåË∞ÉÁî®generateÊñπÊ≥ïÊ≥®ÂÖ•Êñ∞ÁöÑinstance instanceÊ®°ÂùóÔºö eventParser (Êï∞ÊçÆÊ∫êÊé•ÂÖ•ÔºåÊ®°ÊãüslaveÂçèËÆÆÂíåmasterËøõË°å‰∫§‰∫íÔºåÂçèËÆÆËß£Êûê) eventSink (ParserÂíåStoreÈìæÊé•Âô®ÔºåËøõË°åÊï∞ÊçÆËøáÊª§ÔºåÂä†Â∑•ÔºåÂàÜÂèëÁöÑÂ∑•‰Ωú) eventStore (Êï∞ÊçÆÂ≠òÂÇ®) metaManager (Â¢ûÈáèËÆ¢ÈòÖ&amp;Ê∂àË¥π‰ø°ÊÅØÁÆ°ÁêÜÂô®) Âü∫‰∫é Canal ÁöÑÂÆûÁé∞ÂéüÁêÜÊù•ÁúãÔºåCanal Âπ∂‰∏çÊîØÊåÅÂÖ®Èáè+Â¢ûÈáèÁöÑÂêåÊ≠•Ê®°Âºè„ÄÇ AirbyteAirbyte ÊòØ‰∏Ä‰∏™ÊØîËæÉÊñ∞ÁöÑÊï∞ÊçÆÈõÜÊàêÂπ≥Âè∞ÔºåÊèê‰æõ‰∫ÜÈùûÂ∏∏Â§öÁöÑ connectorÔºåÂè∑Áß∞ÊîØÊåÅ‰∏äÂçÉÁßçÊï∞ÊçÆÊ∫ê„ÄÇDatabend ‰πüÊèê‰æõ‰∫ÜAirbyte Destination ConnectoÔºåÁî®Êà∑ÂèØ‰ª•‰ªé Airbyte ÊîØÊåÅÁöÑ‰∏äÁôæ‰∏™ source connector ÊØîÂ¶Ç mysql, es, pg Á≠âÂêåÊ≠•Êï∞ÊçÆÂà∞ Databend„ÄÇ Airbyte ÁöÑ‰ºòÂäøÊòØÊîØÊåÅÁöÑÊï∞ÊçÆÊ∫êÈùûÂ∏∏Â§öÔºåÁîöËá≥ÂÉè Google Docs, Facebook ÈÉΩÊîØÊåÅ„ÄÇ Airbyte ÊòØ ELT Ê®°ÂºèÔºåÂÖàÊäΩÂèñÊï∞ÊçÆÂà∞ÁõÆÊ†áË°®ÂêéÔºåÂÜçËøõË°åÊ∏ÖÊ¥ó„ÄÇ‰ΩÜÊòØÁº∫ÁÇπ‰πüÈùûÂ∏∏ÊòéÊòæÔºåAirbyte ÊòØ‰∏Ä‰∏™ÊâìÂåÖÁöÑÂπ≥Âè∞ÔºåÊâÄÊúâÁöÑÊï∞ÊçÆÊ∫êÈÉΩË¶ÅË¢´ÈõÜÊàêÂà∞ÈáåÈù¢ÔºåÊâÄ‰ª•‰ΩøÁî®Ëµ∑Êù•ÈùûÂ∏∏Âú∞Èáç„ÄÇÂπ∂‰∏îAirbyte ÂêåÊ≠•ËøáÊù•ÁöÑÊï∞ÊçÆÊòØ‰∏ÄÂº†Â§ßÂÆΩË°®Ôºå‰æùËµñ dbt Normalization ÊàñËÄÖ‰∏Ä‰∫õ ELT Â∑•‰ΩúÊâçËÉΩÂ§üË°®Â±ïÂºÄ„ÄÇÊâÄ‰ª•ÈÄÇÂêàÁöÑÊòØÊï∞ÊçÆÊ∫êÂ§öÔºåÂπ∂‰∏îÈúÄË¶ÅÁªü‰∏ÄÁÆ°ÁêÜÁöÑÂú∫ÊôØ„ÄÇ DataXDataX ÊòØÈòøÈáåÂºÄÊ∫êÁöÑ‰∏Ä‰∏™ÂºÇÊûÑÊï∞ÊçÆÊ∫êÁ¶ªÁ∫øÂêåÊ≠•Â∑•ÂÖ∑ÔºåËÉΩÂ§üÂÆûÁé∞ÂåÖÊã¨ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ì(MySQL„ÄÅOracleÁ≠â)„ÄÅHDFS„ÄÅHiveÁ≠âÂêÑÁßçÂºÇÊûÑÊï∞ÊçÆÊ∫ê‰πãÈó¥Á®≥ÂÆöÈ´òÊïàÁöÑÊï∞ÊçÆÂêåÊ≠•ÂäüËÉΩ„ÄÇDataX Êú¨Ë∫´‰Ωú‰∏∫Êï∞ÊçÆÂêåÊ≠•Ê°ÜÊû∂ÔºåÂ∞Ü‰∏çÂêåÊï∞ÊçÆÊ∫êÁöÑÂêåÊ≠•, ÊäΩË±°‰∏∫‰ªé source Á´ØËØªÂèñÊï∞ÊçÆÁöÑ Reader Êèí‰ª∂Ôºå‰ª•ÂèäÂêëÁõÆÊ†áÁ´ØÂÜôÂÖ•Êï∞ÊçÆÁöÑWriterÊèí‰ª∂ÔºåÁêÜËÆ∫‰∏äDataXÊ°ÜÊû∂ÂèØ‰ª•ÊîØÊåÅ‰ªªÊÑèÊï∞ÊçÆÊ∫êÁöÑÊï∞ÊçÆÂêåÊ≠•Â∑•‰Ωú„ÄÇ Databend Êèê‰æõ‰∫Ü Databend Writer ÁöÑ Datax Plugin , ÂèØ‰ª•ÊîØÊåÅ‰ªé‰ªªÊÑèÂÖ∑Êúâ Datax Reader Êèí‰ª∂ÁöÑÊï∞ÊçÆÂ∫ìÂêåÊ≠•Êï∞ÊçÆÂà∞ DatabendÔºåÂπ∂‰∏îÊîØÊåÅÂÖ®Èáèinsert Âíå upsert ‰∏§ÁßçÂêåÊ≠•Ê®°Âºè„ÄÇDatax ÊúÄÈÄÇÂêàÁöÑÂú∫ÊôØÊòØ T+1 ÁöÑÁ¶ªÁ∫øÊï∞ÊçÆÂêåÊ≠•„ÄÇ ÊÄªÁªìCDC ÁöÑÊäÄÊúØÊñπÊ°àÈùûÂ∏∏Â§öÔºåÁõÆÂâç‰∏öÁïå‰∏ªÊµÅÁöÑÂÆûÁé∞Êú∫Âà∂ÂèØ‰ª•ÂàÜ‰∏∫‰∏§ÁßçÔºö Âü∫‰∫éÊü•ËØ¢ÁöÑ CDCÔºö Á¶ªÁ∫øË∞ÉÂ∫¶Êü•ËØ¢‰Ωú‰∏öÔºåÊâπÂ§ÑÁêÜ„ÄÇÊää‰∏ÄÂº†Ë°®ÂêåÊ≠•Âà∞ÂÖ∂‰ªñÁ≥ªÁªüÔºåÊØèÊ¨°ÈÄöËøáÊü•ËØ¢ÂéªËé∑ÂèñË°®‰∏≠ÊúÄÊñ∞ÁöÑÊï∞ÊçÆÔºõ Êó†Ê≥ï‰øùÈöúÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÔºåÊü•ÁöÑËøáÁ®ã‰∏≠ÊúâÂèØËÉΩÊï∞ÊçÆÂ∑≤ÁªèÂèëÁîü‰∫ÜÂ§öÊ¨°ÂèòÊõ¥Ôºõ ‰∏ç‰øùÈöúÂÆûÊó∂ÊÄßÔºåÂü∫‰∫éÁ¶ªÁ∫øË∞ÉÂ∫¶Â≠òÂú®Â§©ÁÑ∂ÁöÑÂª∂Ëøü„ÄÇ Âü∫‰∫éÊó•ÂøóÁöÑ CDCÔºö ÂÆûÊó∂Ê∂àË¥πÊó•ÂøóÔºåÊµÅÂ§ÑÁêÜÔºå‰æãÂ¶Ç MySQL ÁöÑ binlog Êó•ÂøóÂÆåÊï¥ËÆ∞ÂΩï‰∫ÜÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂèòÊõ¥ÔºåÂèØ‰ª•Êää binlog Êñá‰ª∂ÂΩì‰ΩúÊµÅÁöÑÊï∞ÊçÆÊ∫êÔºõ ‰øùÈöúÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÔºåÂõ†‰∏∫ binlog Êñá‰ª∂ÂåÖÂê´‰∫ÜÊâÄÊúâÂéÜÂè≤ÂèòÊõ¥ÊòéÁªÜÔºõ ‰øùÈöúÂÆûÊó∂ÊÄßÔºåÂõ†‰∏∫Á±ª‰ºº binlog ÁöÑÊó•ÂøóÊñá‰ª∂ÊòØÂèØ‰ª•ÊµÅÂºèÊ∂àË¥πÁöÑÔºåÊèê‰æõÁöÑÊòØÂÆûÊó∂Êï∞ÊçÆ„ÄÇ ÂØπÊØîÂ∏∏ËßÅÁöÑÂºÄÊ∫ê CDC ÊñπÊ°àÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ÔºåÂØπÊØîÂ¢ûÈáèÂêåÊ≠•ËÉΩÂäõ: Âü∫‰∫éÊó•ÂøóÁöÑÊñπÂºèÔºåÂèØ‰ª•ÂæàÂ•ΩÁöÑÂÅöÂà∞Â¢ûÈáèÂêåÊ≠•Ôºõ ËÄåÂü∫‰∫éÊü•ËØ¢ÁöÑÊñπÂºèÊòØÂæàÈöæÂÅöÂà∞Â¢ûÈáèÂêåÊ≠•ÁöÑ„ÄÇ ÂØπÊØîÂÖ®ÈáèÂêåÊ≠•ËÉΩÂäõÔºåÂü∫‰∫éÊü•ËØ¢ÊàñËÄÖÊó•ÂøóÁöÑ CDC ÊñπÊ°àÂü∫Êú¨ÈÉΩÊîØÊåÅÔºåÈô§‰∫Ü Canal„ÄÇ ËÄåÂØπÊØîÂÖ®Èáè + Â¢ûÈáèÂêåÊ≠•ÁöÑËÉΩÂäõÔºåÂè™Êúâ Flink CDC„ÄÅDebezium ÊîØÊåÅËæÉÂ•Ω„ÄÇ ‰ªéÊû∂ÊûÑËßíÂ∫¶ÂéªÁúãÔºåËØ•Ë°®Â∞ÜÊû∂ÊûÑÂàÜ‰∏∫ÂçïÊú∫ÂíåÂàÜÂ∏ÉÂºèÔºåËøôÈáåÁöÑÂàÜÂ∏ÉÂºèÊû∂ÊûÑ‰∏çÂçïÁ∫Ø‰ΩìÁé∞Âú®Êï∞ÊçÆËØªÂèñËÉΩÂäõÁöÑÊ∞¥Âπ≥Êâ©Â±ï‰∏äÔºåÊõ¥ÈáçË¶ÅÁöÑÊòØÂú®Â§ßÊï∞ÊçÆÂú∫ÊôØ‰∏ãÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊé•ÂÖ•ËÉΩÂäõ„ÄÇ‰æãÂ¶Ç Flink CDC ÁöÑÊï∞ÊçÆÂÖ•ÊπñÊàñËÄÖÂÖ•‰ªìÁöÑÊó∂ÂÄôÔºå‰∏ãÊ∏∏ÈÄöÂ∏∏ÊòØÂàÜÂ∏ÉÂºèÁöÑÁ≥ªÁªüÔºåÂ¶Ç Hive„ÄÅHDFS„ÄÅIceberg„ÄÅHudi Á≠âÔºåÈÇ£‰πà‰ªéÂØπÊé•ÂÖ•ÂàÜÂ∏ÉÂºèÁ≥ªÁªüËÉΩÂäõ‰∏äÁúãÔºåFlink CDC ÁöÑÊû∂ÊûÑËÉΩÂ§üÂæàÂ•ΩÂú∞Êé•ÂÖ•Ê≠§Á±ªÁ≥ªÁªü„ÄÇ Âú®Êï∞ÊçÆËΩ¨Êç¢ / Êï∞ÊçÆÊ∏ÖÊ¥óËÉΩÂäõ‰∏äÔºåÂΩìÊï∞ÊçÆËøõÂÖ•Âà∞ CDC Â∑•ÂÖ∑ÁöÑÊó∂ÂÄôÊòØÂê¶ËÉΩËæÉÊñπ‰æøÁöÑÂØπÊï∞ÊçÆÂÅö‰∏Ä‰∫õËøáÊª§ÊàñËÄÖÊ∏ÖÊ¥ó Âú® Flink CDC ‰∏äÊìç‰ΩúÂæàÁÆÄÂçïÔºåÂèØ‰ª•ÈÄöËøá Flink SQL ÂéªÊìç‰ΩúÔºõ ‰ΩÜÊòØÂÉè DataX„ÄÅDebezium Á≠âÂàôÈúÄË¶ÅÈÄöËøáËÑöÊú¨ÊàñËÄÖÊ®°ÊùøÂéªÂÅöÔºåÊâÄ‰ª•Áî®Êà∑ÁöÑ‰ΩøÁî®Èó®Êßõ‰ºöÊØîËæÉÈ´ò„ÄÇ Âè¶Â§ñÔºåÂú®ÁîüÊÄÅÊñπÈù¢ÔºåËøôÈáåÊåáÁöÑÊòØ‰∏ãÊ∏∏ÁöÑ‰∏Ä‰∫õÊï∞ÊçÆÂ∫ìÊàñËÄÖÊï∞ÊçÆÊ∫êÁöÑÊîØÊåÅ„ÄÇFlink CDC ‰∏ãÊ∏∏Êúâ‰∏∞ÂØåÁöÑ ConnectorÔºå‰æãÂ¶ÇÂÜôÂÖ•Âà∞ Databend„ÄÅMySQL„ÄÅPg„ÄÅClickHouse Á≠âÂ∏∏ËßÅÁöÑ‰∏Ä‰∫õÁ≥ªÁªüÔºå‰πüÊîØÊåÅÂêÑÁßçËá™ÂÆö‰πâ connector„ÄÇ]]></content>
      <categories>
        <category>Databend</category>
      </categories>
      <tags>
        <tag>CDC</tag>
        <tag>Databend</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[databend debezium server support auto schema evolution]]></title>
    <url>%2F2024%2F01%2F25%2Fdatabend-debezium-server-support-auto-schema-evolution%2F</url>
    <content type="text"><![CDATA[ËÉåÊôØDebezium Server Databend ÊòØ‰∏Ä‰∏™Âü∫‰∫é Debezium Engine Ëá™Á†îÁöÑËΩªÈáèÁ∫ß CDC È°πÁõÆÔºåÁî®‰∫éÂÆûÊó∂ÊçïËé∑Êï∞ÊçÆÂ∫ìÊõ¥ÊîπÂπ∂Â∞ÜÂÖ∂‰Ωú‰∏∫‰∫ã‰ª∂ÊµÅ‰º†ÈÄíÊúÄÁªàÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•ÁõÆÊ†áÊï∞ÊçÆÂ∫ì Databend„ÄÇÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁßçÁÆÄÂçïÁöÑÊñπÂºèÊù•ÁõëËßÜÂíåÊçïËé∑ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁöÑÂèòÂåñÔºåÂπ∂ÊîØÊåÅÂ∞ÜËøô‰∫õÂèòÂåñËΩ¨Êç¢‰∏∫ÂèØÊ∂àË¥π‰∫ã‰ª∂„ÄÇ‰ΩøÁî® Debezium server databend ÂÆûÁé∞ CDC Êó†È°ª‰æùËµñÂ§ßÂûãÁöÑ Data Infra ÊØîÂ¶Ç Flink, Kafka, Spark Á≠âÔºåÂè™ÈúÄ‰∏Ä‰∏™ÂêØÂä®ËÑöÊú¨Âç≥ÂèØÂºÄÂêØÂÆûÊó∂Êï∞ÊçÆÂêåÊ≠•„ÄÇ CDC ËøáÁ®ã‰∏≠ÁöÑ Schema ÂèòÊõ¥Â§ÑÁêÜÊòØ‰∏äÊ∏∏Êï∞ÊçÆÂ∫ì‰∏≠ÂçÅÂàÜÂ∏∏ËßÅÁöÑÁî®Êà∑Âú∫ÊôØÔºå‰πüÊòØÊï∞ÊçÆÂêåÊ≠•Ê°ÜÊû∂ÂÆûÁé∞ÁöÑÈöæÁÇπ„ÄÇÈíàÂØπËØ•Âú∫ÊôØÔºåDatabend-debezium-server 0.3.0 ÂºïÂÖ•‰∫Ü Auto Schema Evolution ÁöÑËÉΩÂäõÔºåÂú®ÊØè‰∏ÄÊâπÊ¨°ÁöÑÊï∞ÊçÆ‰∏≠ÂçèË∞ÉÂπ∂ÊéßÂà∂‰Ωú‰∏öÊãìÊâë‰∏≠ÁöÑ schema ÂèòÊõ¥‰∫ã‰ª∂Â§ÑÁêÜ„ÄÇ ÂÆûÁé∞ËøáÁ®ãDebezium Server Databend ÂÆûÁé∞ Schema Auto Evolution ÂäüËÉΩÁöÑÂéüÁêÜÂ§ßËá¥ÊòØÔºö Âú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠Êñ∞Â¢û debezium.sink.databend.schema.evolution ÁöÑÈÖçÁΩÆÔºåÈªòËÆ§‰∏∫ false ‰∏çÂºÄÂêØËØ•ÂäüËÉΩ„ÄÇ ÂΩì‰∏äÊ∏∏Êï∞ÊçÆÊ∫êÂèëÁîü schema ÂèòÊõ¥Êó∂ÔºåÂÖàÂ∞ÜÊµÅÊ∞¥Á∫ø‰∏≠Â∑≤ÁªèËØªÂá∫ÁöÑÁöÑÊï∞ÊçÆÂÖ®ÈÉ®Âà∑Âá∫‰ª•‰øùËØÅËøõÂÖ•Êï∞ÊçÆÊµÅÁöÑËøô‰∏ÄÊâπ schema ÁöÑ‰∏ÄËá¥ÊÄßÔºö ÁÑ∂ÂêéÂÖàÂ∞ÜËØ•Á±ª schemachangekey ‰∫ã‰ª∂ÊöÇÂ≠òÂà∞ schemaEvolutionEvents ÁöÑ ArrayList ‰∏≠„ÄÇ 123456List&lt;DatabendChangeEvent&gt; schemaEvolutionEvents = new ArrayList&lt;&gt;(); for (DatabendChangeEvent event : events) &#123; if (DatabendUtil.isSchemaChanged(event.schema()) &amp;&amp; isSchemaEvolutionEnabled) &#123; schemaEvolutionEvents.add(event); &#125; &#125; ÂÖàÂ∞Ü‰∏äÈù¢Âà∑Âá∫ÁöÑÊï∞ÊçÆÊâßË°åÂÜôÂÖ•Êìç‰ΩúÔºåÂÜôÂÖ•ËøôÊâπÊï∞ÊçÆ‰πãÂêé‰∏îËß£Êûê schema ÂèòÊõ¥ÁöÑ‰∫ã‰ª∂‰πãÂâçÁöÑÊó∂Èó¥Èáå‰∏ç‰ºöÊúâÊñ∞ÁöÑÊï∞ÊçÆËøõÊù•„ÄÇÊï∞ÊçÆÂ§ÑÁêÜÂÆåÂêéÂÜçÂéªËß£Êûê schema change eventsÔºåÂ¶ÇÊûú‰∫ã‰ª∂Á±ªÂûãÂ±û‰∫é DDL Âπ∂‰∏î‰∏∫ alter table ËØ≠Âè•ÔºåÂ∞±ÂØπÁõÆÊ†á database.table ÊâßË°åËØ• DDL„ÄÇ 123456// handle schema evolution try &#123; schemaEvolution(table, schemaEvolutionEvents); &#125; catch (Exception e) &#123; throw new RuntimeException(e.getMessage()); &#125; 1234567891011121314151617public void schemaEvolution(RelationalTable table, List&lt;DatabendChangeEvent&gt; events) &#123; for (DatabendChangeEvent event : events) &#123; Map&lt;String, Object&gt; values = event.valueAsMap(); for (Map.Entry&lt;String, Object&gt; entry : values.entrySet()) &#123; if (entry.getKey().contains("ddl") &amp;&amp; entry.getValue().toString().toLowerCase().contains("alter table")) &#123; String tableName = getFirstWordAfterAlterTable(entry.getValue().toString()); String ddlSql = replaceFirstWordAfterTable(entry.getValue().toString(), table.databaseName + "." + tableName); try (PreparedStatement statement = connection.prepareStatement(ddlSql)) &#123; System.out.println(ddlSql); statement.execute(ddlSql); &#125; catch (SQLException e) &#123; throw new RuntimeException(e.getMessage()); &#125; &#125; &#125; &#125; &#125; ÂΩì schema ÂèòÊõ¥‰∫ã‰ª∂Â§ÑÁêÜÊàêÂäüÂêéÔºå‰ºöÁªßÁª≠Êñ∞ÁöÑÊï∞ÊçÆÂêåÊ≠•ÊµÅÁ®ã„ÄÇ Âü∫Êú¨ÁöÑÂ§ÑÁêÜÊµÅÁ®ãÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÂÆûË∑µ&amp;ÊºîÁ§∫Debezium Server Databend Clone È°πÁõÆ: git clone `https://github.com/databendcloud/debezium-server-databend.git` ‰ªéÈ°πÁõÆÊ†πÁõÆÂΩïÂºÄÂßã: ÊûÑÂª∫ÂíåÊâìÂåÖ debezium server: mvn -Passembly -Dmaven.test.skip package ÊûÑÂª∫ÂÆåÊàêÂêéÔºåËß£ÂéãÊúçÂä°Âô®ÂàÜÂèëÂåÖ: unzip debezium-server-databend-dist/target/debezium-server-databend-dist*.zip -d databendDist ËøõÂÖ•Ëß£ÂéãÂêéÁöÑÊñá‰ª∂Â§π: cd databendDist ÂàõÂª∫ application.properties Êñá‰ª∂Âπ∂‰øÆÊîπ: nano conf/application.propertiesÔºåÂ∞Ü‰∏ãÈù¢ÁöÑ application.properties Êã∑Ë¥ùËøõÂéªÔºåÊ†πÊçÆÁî®Êà∑ÂÆûÈôÖÊÉÖÂÜµ‰øÆÊîπÁõ∏Â∫îÁöÑÈÖçÁΩÆ„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445debezium.sink.type=databenddebezium.sink.databend.upsert=truedebezium.sink.databend.upsert-keep-deletes=falsedebezium.sink.databend.database.databaseName=debeziumdebezium.sink.databend.database.url=jdbc:databend://tnf34b0rm--xxxxxx.default.databend.cn:443debezium.sink.databend.database.username=cloudappdebezium.sink.databend.database.password=passworddebezium.sink.databend.database.primaryKey=iddebezium.sink.databend.database.tableName=productsdebezium.sink.databend.database.param.ssl=truedebezium.sink.databend.schema.evolution=true // Enable Auto Schema Evolution# enable event schemasdebezium.format.value.schemas.enable=truedebezium.format.key.schemas.enable=truedebezium.format.value=jsondebezium.format.key=json# mysql sourcedebezium.source.connector.class=io.debezium.connector.mysql.MySqlConnectordebezium.source.offset.storage.file.filename=data/offsets.datdebezium.source.offset.flush.interval.ms=60000debezium.source.database.hostname=127.0.0.1debezium.source.database.port=3306debezium.source.database.user=rootdebezium.source.database.password=123456debezium.source.database.dbname=mydbdebezium.source.database.server.name=from_mysqldebezium.source.include.schema.changes=falsedebezium.source.table.include.list=mydb.products# debezium.source.database.ssl.mode=required# Run without Kafka, use local file to store checkpointsdebezium.source.database.history=io.debezium.relational.history.FileDatabaseHistorydebezium.source.database.history.file.filename=data/status.dat# do event flattening. unwrap message!debezium.transforms=unwrapdebezium.transforms.unwrap.type=io.debezium.transforms.ExtractNewRecordStatedebezium.transforms.unwrap.delete.handling.mode=rewritedebezium.transforms.unwrap.drop.tombstones=true# ############ SET LOG LEVELS ############quarkus.log.level=INFO# Ignore messages below warning level from Jetty, because it's a bit verbosequarkus.log.category."org.eclipse.jetty".level=WARN ‰ΩøÁî®Êèê‰æõÁöÑËÑöÊú¨ËøêË°åÊúçÂä°: bash run.sh Debezium Server with Databend Â∞Ü‰ºöÂêØÂä® Mysql ‰∏≠ÂáÜÂ§áË°®ÂíåÊï∞ÊçÆÂàõÂª∫Êï∞ÊçÆÂ∫ì mydb ÂíåË°® productsÔºåÂπ∂ÊèíÂÖ•Êï∞ÊçÆ: 12345678910111213141516CREATE DATABASE mydb;USE mydb;CREATE TABLE products (id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,name VARCHAR(255) NOT NULL,description VARCHAR(512));ALTER TABLE products AUTO_INCREMENT = 10;INSERT INTO products VALUES (default,"scooter","Small 2-wheel scooter"),(default,"car battery","12V car battery"),(default,"12-pack drill bits","12-pack of drill bits with sizes ranging from #40 to #3"),(default,"hammer","12oz carpenter's hammer"),(default,"hammer","14oz carpenter's hammer"),(default,"hammer","16oz carpenter's hammer"),(default,"rocks","box of assorted rocks"),(default,"jacket","water resistent black wind breaker"),(default,"cloud","test for databend"),(default,"spare tire","24 inch spare tire"); Databend Cloud ‰∏≠ÂàõÂª∫ Database1create database debezium NOTE: Áî®Êà∑ÂèØ‰ª•‰∏çÂøÖÂÖàÂú® Databend ‰∏≠ÂàõÂª∫Ë°®ÔºåÁ≥ªÁªüÊ£ÄÊµãÂà∞Âêé‰ºöËá™Âä®‰∏∫Áî®Êà∑Âª∫Ë°®„ÄÇ ÂêØÂä® Debezium Server Databend1bash run.sh È¶ñÊ¨°ÂêØÂä®‰ºöËøõÂÖ• init snapshot Ê®°ÂºèÔºåÈÄöËøáÈÖçÁΩÆÁöÑ Batch Size ÂÖ®ÈáèÂ∞Ü MySQL ‰∏≠ÁöÑÊï∞ÊçÆÂêåÊ≠•Âà∞ DatabendÔºåÊâÄ‰ª•Âú® Databend ‰∏≠ÂèØ‰ª•ÁúãÂà∞ MySQL ‰∏≠ÁöÑÊï∞ÊçÆÂ∑≤ÁªèÂêåÊ≠•ËøáÊù•‰∫ÜÔºö ÊîπÂèò Mysql Ë°®ÁªìÊûÑ1alter table products add columm a int; Âú® products Ë°®‰∏≠Êñ∞Â¢û‰∏ÄÂàó a int ÂêåÊó∂Âú® Databend Cloud ‰∏≠‰πüÂèØ‰ª•ÁúãÂà∞ÁõÆÊ†áÂêåÊ≠•Ë°®ÁöÑÁªìÊûÑ‰πüÈöè‰πãÂèòÊõ¥‰∫ÜÔºö Ê≠§Êó∂Âú® mysql ‰∏≠ÊèíÂÖ•Êï∞ÊçÆÔºåÊñ∞ÁöÑÊï∞ÊçÆÂ∞±‰ºö‰ª•Êñ∞ÁöÑ Schema ÂΩ¢ÂºèÂÜôÂÖ•ÁõÆÊ†áË°®Ôºö ÁªìËÆ∫Debezium Server Databend Âú®ÊîØÊåÅ Auto Schema Evolution ‰πãÂêéÔºåÁî®Êà∑Êó†ÈúÄÂú®Êï∞ÊçÆÊ∫êÂèëÁîü schema ÂèòÊõ¥Êó∂ÊâãÂä®‰ªãÂÖ•ÔºåÂ§ßÂ§ßÈôç‰ΩéÁî®Êà∑ÁöÑËøêÁª¥ÊàêÊú¨ÔºõÂè™ÈúÄÂØπÂêåÊ≠•‰ªªÂä°ËøõË°åÁÆÄÂçïÈÖçÁΩÆÂç≥ÂèØÂ∞ÜÂ§öË°®„ÄÅÂ§ö‰∏™Êï∞ÊçÆÂ∫ìÂêåÊ≠•Ëá≥‰∏ãÊ∏∏ÔºåÊèêÈ´ò‰∫ÜÊï∞ÊçÆÂêåÊ≠•ÁöÑÊïàÁéáÂπ∂‰∏îÈôç‰Ωé‰∫ÜÁî®Êà∑ÁöÑÂºÄÂèëÈöæÂ∫¶„ÄÇ]]></content>
      <categories>
        <category>Databend</category>
      </categories>
      <tags>
        <tag>CDC</tag>
        <tag>databend</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[(ÊåÅÁª≠Êõ¥Êñ∞)Databend SDK Êé•ÂÖ•ÊúÄ‰Ω≥ÂÆûË∑µ&Â∏∏ËßÅÈóÆÈ¢ò]]></title>
    <url>%2F2024%2F01%2F06%2FDatabend-SDK-%E6%8E%A5%E5%85%A5%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáÊ°£ÂåÖÂê´ Databend ÊîØÊåÅÁöÑÊâÄÊúâ SDK Êé•ÂÖ•ÁöÑÊúÄ‰Ω≥ÂÆûË∑µ‰ª•ÂèäÂú®‰ΩøÁî®ËøáÁ®ã‰∏≠ÂèØËÉΩ‰ºöÂá∫Áé∞ÁöÑÈóÆÈ¢ò‰ª•ÂèäÂØπÂ∫îÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇÂ∏åÊúõÂèØ‰ª•Êàê‰∏∫Áî®Êà∑Êé•ÂÖ• Databend ÁöÑ‰∏ÄÊääÈáëÈí•ÂåôÔºåÊâìÂºÄÈÄöÂêë Databend ÁöÑÂ§ßÈó®„ÄÇ Databend JDBC Github: https://github.com/datafuselabs/databend-jdbc ÂÖ•Èó®Á§∫‰æãÔºöhttps://github.com/datafuselabs/databend-jdbc/blob/main/databend-jdbc/src/main/java/com/databend/jdbc/examples/Examples.java ÂàõÂª∫ JDBC Connection12345private Connection createConnection() throws SQLException &#123; String url = "jdbc:databend://localhost:8000"; return DriverManager.getConnection(url, "databend", "databend"); // user, password&#125; Âª∫Ë°®12Connection c = createConnection();c.createStatement().execute("create table test_basic_driver.table1(i int)"); ÂçïÊù°ÊèíÂÖ•Êï∞ÊçÆ123Connection c = createConnection();c.createStatement().execute("create table test_basic_driver.table1(i int, j varchar)");c.createStatement().execute("insert into test_basic_driver.table1 values(1,'j')"); ÂçïÊù°ÊèíÂÖ•Êó†Ê≥ïÂèëÊå• databend ÁöÑÊÄßËÉΩÔºåÂÜôÂÖ•ÊÄßËÉΩËæÉÂ∑ÆÔºåÂè™ËÉΩ‰Ωú‰∏∫ÊµãËØï‰ΩøÁî®„ÄÇÊé®Ëçê‰ΩøÁî®ÊâπÈáèÊèíÂÖ•ÔºàBatch InsertÔºâ ÊâπÈáèÊèíÂÖ•12345678910111213141516171819202122232425262728public void BatchInsert() throws SQLException &#123; Connection c = createConnection(); c.setAutoCommit(false); c.createStatement().execute("create table test_basic_driver.test_prepare_statement(i int, j varchar)"); PreparedStatement ps = c.prepareStatement("insert into test_prepare_statement values"); ps.setInt(1, 1); ps.setString(2, "a"); ps.addBatch(); ps.setInt(1, 2); ps.setString(2, "b"); ps.addBatch(); System.out.println("execute batch insert"); int[] ans = ps.executeBatch(); ps.close(); Statement statement = c.createStatement(); System.out.println("execute select"); statement.execute("SELECT * from test_prepare_statement"); ResultSet r = statement.getResultSet(); while (r.next()) &#123; System.out.println(r.getInt(1)); System.out.println(r.getString(2)); &#125; statement.close(); c.close();&#125; Âú®ÂÆûÈôÖ‰ΩøÁî®‰∏≠ÔºåÊé®ËçêÂ¢ûÂ§ß Batch size Âà∞ 10w~100w ‰πãÈó¥ ËøûÊé•ÂèÇÊï∞https://github.com/datafuselabs/databend-jdbc/blob/main/docs/Connection.md Â∏∏ËßÅÈóÆÈ¢òQ: Upload to stream failed Êä•Èîô A: Ê£ÄÊü• Client Âà∞ OSS ÁöÑÁΩëÁªúÊÉÖÂÜµ Q: Spring boot Á≠âÈ°πÁõÆ Slf4j provider not found A: ËøôÂèØËÉΩÊòØÂºïÂÖ•ÁöÑ slf4j ÂåÖ‰∫ßÁîü‰∫ÜÂÜ≤Á™ÅÔºåÊ£ÄÊü• pom ‰∏≠ slf4j ÁâàÊú¨ÊòØÂê¶‰∏ÄËá¥ Q: Â¶Ç‰ΩïÂ∞Ü NULL ÂÜôÂÖ•Ë°® A: ps.setNull(index, Types.NULL) Q: Spring boot JDBCTemplate getParameterType not implement A: getParameterType Âú® databend JDBC ‰∏≠ÁõÆÂâçËøòÊ≤°ÊúâÂÆûÁé∞ÔºåÂ∑≤Âú®ÂºÄÂèëËÆ°Âàí‰∏≠ Golang SDK Github: https://github.com/datafuselabs/databend-go ÂàõÂª∫ sql.db client123456789101112import ("database/sql"_ "github.com/datafuselabs/databend-go")func main() &#123; db, err := sql.Open("databend", dsn) if err != nil &#123; return err &#125; db.Ping() db.Close()&#125; ÊâßË°å SQL12345678910conn, err := sql.Open("databend", dsn)if err != nil &#123; fmt.Println(err) &#125;conn.Exec(`DROP TABLE IF EXISTS data`)_, err = conn.Exec(` CREATE TABLE IF NOT EXISTS data( Col1 TINYINT, Col2 VARCHAR )`)if err != nil &#123; fmt.Println(err) &#125;_, err = conn.Exec("INSERT INTO data VALUES (1, 'test-1')") ÊâπÈáèÊèíÂÖ•12345678910111213141516171819202122func main() &#123; conn, err := sql.Open("databend", "http://databend:databend@localhost:8000/default?sslmode=disable") tx, err := conn.Begin() if err != nil &#123; fmt.Println(err) &#125; batch, err := tx.Prepare(fmt.Sprintf("INSERT INTO %s VALUES", "test")) for i := 0; i &lt; 10; i++ &#123; _, err = batch.Exec( "1234", "2345", "3.1415", "test", "test2", "[4, 5, 6]", "[1, 2, 3]", "2021-01-01", "2021-01-01 00:00:00", ) &#125; err = tx.Commit()&#125; ËØ∑Ê±ÇÂçïË°å/Â§öË°å (Querying Row/s)123456789101112131415func main() &#123; // create table data (col1 uint8, col2 string);// insert into data values(1,'col2');conn, err := sql.Open("databend", "http://databend:databend@localhost:8000/default?sslmode=disable") if err != nil &#123; fmt.Println(err) &#125; row := conn.QueryRow("SELECT * FROM data") var ( col1 uint8col2 string ) if err := row.Scan(&amp;col1, &amp;col2); err != nil &#123; fmt.Println(err) &#125; fmt.Println(col2)&#125; Python SDKdatabend-py Github: https://github.com/datafuselabs/databend-py ÂàõÂª∫ client1c = Client.from_url("http://user:password@host:port/db?secure=false") Databend py DSN ‰∏≠ÊîØÊåÅÁöÑÂèÇÊï∞ÂèØ‰ª•ÂèÇËÄÉÔºö https://github.com/datafuselabs/databend-py/blob/main/docs/connection.md Âª∫Ë°®&amp;Êü•ËØ¢12345c = Client.from_url(databend_url)c.execute('CREATE TABLE if not exists test (x Int32,y VARCHAR)')t, r = c.execute('INSERT INTO test VALUES', [(3, 'aa'),(4,'bb')],with_column_types=True)# execute ËøîÂõûÂÄºÊúâ‰∏§‰∏™ÔºåÁ¨¨‰∏Ä‰∏™ÊòØ(column_name, column_type)Ôºö[('a', 'Int32'), ('b', 'String')], Âè™ÊúâÂΩì with_column_types=True ÁöÑÊó∂ÂÄôÊâçËøîÂõûÔºåÈªòËÆ§‰∏∫ False;# Á¨¨‰∫å‰∏™ËøîÂõûÂÄºÊòØÊï∞ÊçÆÈõÜÔºö [(1, 'a'), (2, 'b')] ÊâπÈáèÊèíÂÖ•12345678c = Client.from_url(databend_url)c.execute('DROP TABLE IF EXISTS test')c.execute('CREATE TABLE if not exists test (x Int32,y VARCHAR)')c.execute('DESC test')_, r1 = c.execute('INSERT INTO test VALUES', [(3, 'aa'), (4, 'bb')])assertEqual(r1, 2)_, ss = c.execute('select * from test')assertEqual(ss, [(3, 'aa'), (4, 'bb')]) Upload data to stagedatabend py ÂèØ‰ª•Áõ¥Êé•Â∞Ü python slice Êï∞ÊçÆ‰ª• csv Ê†ºÂºèÂØºÂÖ•Âà∞ databend stage 1234from databend_py import Clientclient = Client.from_url(databend_url)stage_path = client.upload_to_stage('@~', "upload.csv", [(1, 'a'), (1, 'b')])# stage_path is @~/upload.csv Upload file to stageDatabend py ‰πüÂèØ‰ª•Áõ¥Êé•Â∞ÜÊñá‰ª∂‰∏ä‰º†Âà∞ stage 12345from databend_py import Clientclient = Client.from_url(self.databend_url)with open("upload.csv", "rb") as f: stage_path = client.upload_to_stage('@~', "upload.csv", f) print(stage_path) Databend sqlalchemy GithubÔºö https://github.com/datafuselabs/databend-sqlalchemy ÂàõÂª∫ sqlalchemy connect Âπ∂Êü•ËØ¢123456789from sqlalchemy import create_engine, textfrom sqlalchemy.engine.base import Connection, Engineengine = create_engine( f"databend://&#123;username&#125;:&#123;password&#125;@&#123;host_port_name&#125;/&#123;database_name&#125;?sslmode=disable" )connection = engine.connect()result = connection.execute(text("SELECT 1"))print(result.fetchall()) databend-sqlalchemy Âú®ÁâàÊú¨&lt;v0.4.0 ‰ΩøÁî®[databend-py]Ôºàhttps://github.com/datafuselabs/databend-pyÔºâÊó∂‰Ωú‰∏∫ÂÜÖÈÉ® DriverÔºå&gt;= v0.4.0 Êó∂‰ΩøÁî® databend driver python binding‰Ωú‰∏∫ÂÜÖÈÉ®È©±Âä®Á®ãÂ∫è„ÄÇ‰∏§ËÄÖ‰πãÈó¥ÁöÑÂîØ‰∏ÄÂå∫Âà´ÊòØÔºåDSN‰∏≠Êèê‰æõÁöÑËøûÊé•ÂèÇÊï∞‰∏çÂêå„ÄÇ‰ΩøÁî®Áõ∏Â∫îÁöÑÁâàÊú¨Êó∂Â∫îËØ•ÂèÇËÄÉÁõ∏Â∫îÈ©±Âä®Á®ãÂ∫èÊèê‰æõÁöÑËøûÊé•ÂèÇÊï∞„ÄÇ Bendsql GitHubÔºöhttps://github.com/datafuselabs/bendsql Exec1234567891011121314use databend_driver::Client;let dsn = "databend://root:@localhost:8000/default?sslmode=disable".to_string();let client = Client::new(dsn);let conn = client.get_conn().await.unwrap();let sql_create = "CREATE TABLE books ( title VARCHAR, author VARCHAR, date Date);";conn.exec(sql_create).await.unwrap();let sql_insert = "INSERT INTO books VALUES ('The Little Prince', 'Antoine de Saint-Exup√©ry', '1943-04-06');";conn.exec(sql_insert).await.unwrap(); ËØ∑Ê±ÇÂçïË°åÊï∞ÊçÆ123let row = conn.query_row("SELECT * FROM books;").await.unwrap();let (title,author,date): (String,String,i32) = row.unwrap().try_into().unwrap();println!("&#123;&#125; &#123;&#125; &#123;&#125;", title, author, date); ËØ∑Ê±ÇÂ§öË°å12345let mut rows = conn.query_iter("SELECT * FROM books;").await.unwrap();while let Some(row) = rows.next().await &#123; let (title,author,date): (String,String,chrono::NaiveDate) = row.unwrap().try_into().unwrap(); println!("&#123;&#125; &#123;&#125; &#123;&#125;", title, author, date);&#125; DSN ÂèÇÊï∞ÂèÇËÄÉÔºöhttps://github.com/datafuselabs/bendsql/blob/main/README.md#dsn]]></content>
      <categories>
        <category>Databend</category>
      </categories>
      <tags>
        <tag>Databend</tag>
        <tag>driver SDK</tag>
        <tag>ÁîüÊÄÅ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ªé AutoMQ Kafka ÂØºÂá∫Êï∞ÊçÆÂà∞ Databend]]></title>
    <url>%2F2024%2F01%2F02%2F%E4%BB%8E-AutoMQ-Kafka-%E5%AF%BC%E5%87%BA%E6%95%B0%E6%8D%AE%E5%88%B0-Databend%2F</url>
    <content type="text"><![CDATA[DatabendÊòØ‰ΩøÁî® Rust Á†îÂèë„ÄÅÂºÄÊ∫êÁöÑ„ÄÅÂÆåÂÖ®Èù¢Âêë‰∫ëÊû∂ÊûÑ„ÄÅÂü∫‰∫éÂØπË±°Â≠òÂÇ®ÊûÑÂª∫ÁöÑÊñ∞‰∏Ä‰ª£‰∫ëÂéüÁîüÊï∞ÊçÆ‰ªìÂ∫ìÔºå‰∏∫‰ºÅ‰∏öÊèê‰æõÊπñ‰ªì‰∏Ä‰ΩìÂåñ„ÄÅËÆ°ÁÆóÂíåÂ≠òÂÇ®ÂàÜÁ¶ªÁöÑÂ§ßÊï∞ÊçÆÂàÜÊûêÂπ≥Âè∞„ÄÇ Êú¨ÊñáÂ∞Ü‰ªãÁªçÂ¶Ç‰ΩïÈÄöËøá bend-ingest-kafka Â∞ÜÊï∞ÊçÆ‰ªé AutoMQ for Kafka ÂØºÂÖ• Databend„ÄÇ Êú¨Êñá‰∏≠ÊèêÂèäÁöÑ AutoMQ Kafka ÊúØËØ≠ÔºåÂùáÁâπÊåáÂÆâÊâòÁõü‰∏òÔºàÊù≠Â∑ûÔºâÁßëÊäÄÊúâÈôêÂÖ¨Âè∏ÈÄöËøá GitHub AutoMQ ÁªÑÁªá‰∏ãÂºÄÊ∫êÁöÑ automq-for-kafka È°πÁõÆ„ÄÇ ÁéØÂ¢ÉÂáÜÂ§áÂáÜÂ§á Databend Cloud ‰ª•ÂèäÊµãËØïÊï∞ÊçÆÈ¶ñÂÖàÂà∞ Databend Cloud ÂºÄÂêØ‰Ω†ÁöÑ Warehouse ÔºåÂπ∂Âú® worksheet ‰∏≠ÂàõÂª∫Êï∞ÊçÆÂ∫ìÂ∫ìÂíåÊµãËØïË°®: 1234567create database automq_db;create table users ( id bigint NOT NULL, name string NOT NULL, ts timestamp, status string) ÂáÜÂ§á AutoMQ Kafka ÁéØÂ¢ÉÂíåÊµãËØïÊï∞ÊçÆÂèÇËÄÉ ÈÉ®ÁΩ≤ AutoMQ Âà∞ AWS‚ñ∏ ÈÉ®ÁΩ≤Â•Ω AutoMQ Kafka ÈõÜÁæ§ÔºåÁ°Æ‰øù AutoMQ Kafka ‰∏é StarRocks ‰πãÈó¥‰øùÊåÅÁΩëÁªúËøûÈÄö„ÄÇ Âú®AutoMQ Kafka‰∏≠Âø´ÈÄüÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ example_topic ÁöÑ‰∏ªÈ¢òÂπ∂ÂêëÂÖ∂‰∏≠ÂÜôÂÖ•‰∏ÄÊù°ÊµãËØï JSON Êï∞ÊçÆÔºåÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÊ≠•È™§ÂÆûÁé∞Ôºö ÂàõÂª∫Topic:‰ΩøÁî® Apache Kafka ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑Êù•ÂàõÂª∫‰∏ªÈ¢ò„ÄÇ‰Ω†ÈúÄË¶ÅÊúâ Kafka ÁéØÂ¢ÉÁöÑËÆøÈóÆÊùÉÈôêÔºåÂπ∂‰∏îÁ°Æ‰øù Kafka ÊúçÂä°Ê≠£Âú®ËøêË°å„ÄÇ‰ª•‰∏ãÊòØÂàõÂª∫‰∏ªÈ¢òÁöÑÂëΩ‰ª§Ôºö 1./kafka-topics.sh --create --topic exampleto_topic --bootstrap-server 10.0.96.4:9092 --partitions 1 --replication-factor 1 Ê≥®ÊÑèÔºöÊâßË°åÂëΩ‰ª§Êó∂ÔºåÈúÄË¶ÅÂ∞Ü topic Âíå bootstarp-server ÊõøÊç¢‰∏∫ÂÆûÈôÖ‰ΩøÁî®ÁöÑ Kafka ÊúçÂä°Âô®Âú∞ÂùÄ„ÄÇ ÂàõÂª∫ topic ‰πãÂêéÂèØ‰ª•Áî®‰ª•‰∏ãÂëΩ‰ª§Ê£ÄÊü• topic ÂàõÂª∫ÁöÑÁªìÊûú„ÄÇ 1./kafka-topics.sh --describe example_topic --bootstrap-server 10.0.96.4:9092 ÁîüÊàêÊµãËØïÊï∞ÊçÆ:ÁîüÊàê‰∏ÄÊù°ÁÆÄÂçïÁöÑ JSON Ê†ºÂºèÁöÑÊµãËØïÊï∞ÊçÆÔºåÂíåÂâçÊñáÁöÑË°®ÈúÄË¶ÅÂØπÂ∫î„ÄÇ 123456&#123; "id":1, "name":"Test User", "ts":"2023-11-10T12:00:00", "status":"active"&#125; ÂÜôÂÖ•ÊµãËØïÊï∞ÊçÆ‰ΩøÁî® Kafka ÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÊàñËÄÖÁºñÁ®ãÊñπÂºèÂ∞ÜÊµãËØïÊï∞ÊçÆÂÜôÂÖ•Âà∞ example_topic„ÄÇ‰ª•‰∏ãÊòØ‰ΩøÁî®ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÁöÑ‰∏Ä‰∏™Á§∫‰æãÔºö 1echo '&#123;"id": 1, "name": "ÊµãËØïÁî®Êà∑", "ts": "2023-11-10T12:00:00", "status": "active"&#125;' | sh kafka-console-producer.sh --broker-list 10.0.96.4:9092 --topic example_topic ‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ÂèØ‰ª•Êü•ÁúãÂàöÂÜôÂÖ•ÁöÑ topic Êï∞ÊçÆÔºö 1sh kafka-console-consumer.sh --bootstrap-server 10.0.96.4:9092 --topic example_topic --from-beginning ÂàõÂª∫ bend-ingest-databend jobbend-ingest-kafka ËÉΩÂ§üÁõëÊéß kafka Âπ∂Â∞ÜÊï∞ÊçÆÊâπÈáèÂÜôÂÖ• Databend Table„ÄÇ ÈÉ®ÁΩ≤ bend-ingest-kafka ‰πãÂêéÔºåÂç≥ÂèØÂºÄÂêØÊï∞ÊçÆÂØºÂÖ• job„ÄÇ 1bend-ingest-kafka --kafka-bootstrap-servers="localhost:9094" --kafka-topic="example_topic" --kafka-consumer-group="Consumer Group" --databend-dsn="https://cloudapp:password@host:443" --databend-table="automq_db.users" --data-format="json" --batch-size=5 --batch-max-interval=30s Ê≥®ÊÑèÔºöÂ∞Ü kafka_broker_list ÊõøÊç¢‰∏∫ÂÆûÈôÖ‰ΩøÁî®ÁöÑ Kafka ÊúçÂä°Âô®Âú∞ÂùÄ„ÄÇ ÂèÇÊï∞ËØ¥Êòédatabend-dsnDatabend Cloud Êèê‰æõÁöÑËøûÊé•Âà∞ warehouse ÁöÑ DSNÔºåÂèØ‰ª•ÂèÇËÄÉËØ•ÊñáÊ°£ Ëé∑Âèñ„ÄÇ batch-sizebend-ingest-kafka ‰ºöÁßØÊîíÂà∞ batch-size Êù°Êï∞ÊçÆÂÜçËß¶Âèë‰∏ÄÊ¨°Êï∞ÊçÆÂêåÊ≠•„ÄÇ È™åËØÅÊï∞ÊçÆÂØºÂÖ•Âà∞ Databend Cloud worksheet ‰∏≠Êü•ËØ¢ automq_db.users Ë°®ÔºåÂèØ‰ª•ÁúãÂà∞Êï∞ÊçÆÂ∑≤Áªè‰ªé AutoMq ÂêåÊ≠•Âà∞ Databend Table„ÄÇ]]></content>
      <categories>
        <category>Databend</category>
      </categories>
      <tags>
        <tag>Databend</tag>
        <tag>kafka</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî® LF Edge eKuiper Â∞ÜÁâ©ËÅîÁΩëÊµÅÂ§ÑÁêÜÊï∞ÊçÆÂÜôÂÖ• Databend]]></title>
    <url>%2F2023%2F09%2F15%2F%E4%BD%BF%E7%94%A8-LF-Edge-eKuiper-%E5%B0%86%E7%89%A9%E8%81%94%E7%BD%91%E6%B5%81%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5-Databend%2F</url>
    <content type="text"><![CDATA[LF Edge eKuiper[LF Edge eKuiper(https://github.com/lf-edge/ekuiper) ÊòØ Golang ÂÆûÁé∞ÁöÑËΩªÈáèÁ∫ßÁâ©ËÅîÁΩëËæπÁºòÂàÜÊûê„ÄÅÊµÅÂºèÂ§ÑÁêÜÂºÄÊ∫êËΩØ‰ª∂ÔºåÂèØ‰ª•ËøêË°åÂú®ÂêÑÁ±ªËµÑÊ∫êÂèóÈôêÁöÑËæπÁºòËÆæÂ§á‰∏ä„ÄÇeKuiper ÁöÑ‰∏ªË¶ÅÁõÆÊ†áÊòØÂú®ËæπÁºòÁ´ØÊèê‰æõ‰∏Ä‰∏™ÊµÅÂ™í‰ΩìËΩØ‰ª∂Ê°ÜÊû∂ÔºàÁ±ª‰ºº‰∫é Apache Flink (opens new window)Ôºâ„ÄÇeKuiper ÁöÑËßÑÂàôÂºïÊìéÂÖÅËÆ∏Áî®Êà∑Êèê‰æõÂü∫‰∫é SQL ÊàñÂü∫‰∫éÂõæÂΩ¢ÔºàÁ±ª‰ºº‰∫é Node-REDÔºâÁöÑËßÑÂàôÔºåÂú®Âá†ÂàÜÈíüÂÜÖÂàõÂª∫Áâ©ËÅîÁΩëËæπÁºòÂàÜÊûêÂ∫îÁî®„ÄÇÂÖ∑‰Ωì‰ªãÁªçÂèØ‰ª•ÂèÇËÄÉ LF Edge eKuiper - Ë∂ÖËΩªÈáèÁâ©ËÅîÁΩëËæπÁºòÊµÅÂ§ÑÁêÜËΩØ‰ª∂„ÄÇ Databend Sql SinkeKuiper ÊîØÊåÅÈÄöËøá Golang ÊàñËÄÖ Python Âú®Ê∫ê (Source)ÔºåSQL ÂáΩÊï∞, ÁõÆÊ†á (Sink) ‰∏â‰∏™ÊñπÈù¢ÁöÑÊâ©Â±ïÔºåÈÄöËøáÊîØÊåÅ‰∏çÂêåÁöÑ SinkÔºåÂÖÅËÆ∏Áî®Êà∑Â∞ÜÂàÜÊûêÁªìÊûúÂèëÈÄÅÂà∞‰∏çÂêåÁöÑÊâ©Â±ïÁ≥ªÁªü‰∏≠„ÄÇDatabend ‰Ωú‰∏∫ Sink ‰πüË¢´ÈõÜÊàêÂà∞‰∫Ü eKuiper plugin ÂΩì‰∏≠Ôºå‰∏ãÈù¢ÈÄöËøá‰∏Ä‰∏™Ê°à‰æãÊù•Â±ïÁ§∫Â¶Ç‰Ωï‰ΩøÁî® eKuiper Â∞ÜÁâ©ËÅîÁΩëÊµÅÂ§ÑÁêÜÊï∞ÊçÆÂÜôÂÖ• Databend„ÄÇ ÁºñËØë ekuiper Âíå Databend Sql PluginEkuiper12git clone https://github.com/lf-edge/ekuiper &amp; cd ekuipermake Databend Sql Plugin1go build -trimpath --buildmode=plugin -tags databend -o plugins/sinks/Sql.so extensions/sinks/sql/sql.go ÁºñËØëÂêéÁöÑ sink plugin Êã∑Ë¥ùÂà∞ build ÁõÆÂΩïÔºö 1cp plugins/sinks/Sql.so _build/kuiper-1.11.1-18-g42d9147f-darwin-arm64/plugins/sinks Databend Âª∫Ë°®Âú® Databend ‰∏≠ÂÖàÂàõÂª∫ÁõÆÊ†áË°® ekuiper_testÔºö 1create table ekuiper_test (name string,size bigint,id bigint); ÂêØÂä® ekuiperd12cd _build/kuiper-1.11.1-18-g42d9147f-darwin-arm64 ./bin/kuiperd ÊúçÂä°Ê≠£Â∏∏ÂêØÂä®Ôºö ÂàõÂª∫ÊµÅÔºàstreamÔºâ Âíå ËßÑÂàô (rule)Ekuiper Êèê‰æõ‰∫Ü‰∏§ÁßçÁÆ°ÁêÜÂêÑÁßçÊµÅ„ÄÅËßÑÂàôÔºåÁõÆÊ†áÁ´ØÁöÑÊñπÂºèÔºå‰∏ÄÁßçÊòØÈÄöËøá ekuiper-manager ÁöÑ docker imageÔºàhttps://hub.docker.com/r/lfedge/ekuiperÔºâÂêØÂä®ÂèØËßÜÂåñÁÆ°ÁêÜÁïåÈù¢Ôºå‰∏ÄÁßçÊòØÈÄöËøá CLI Â∑•ÂÖ∑Êù•ÁÆ°ÁêÜ„ÄÇËøôÈáåÊàë‰ª¨‰ΩøÁî® CLI„ÄÇ ÂàõÂª∫ streamÊµÅÊòØ eKuiper ‰∏≠Êï∞ÊçÆÊ∫êËøûÊé•Âô®ÁöÑËøêË°åÂΩ¢Âºè„ÄÇÂÆÉÂøÖÈ°ªÊåáÂÆö‰∏Ä‰∏™Ê∫êÁ±ªÂûãÊù•ÂÆö‰πâÂ¶Ç‰ΩïËøûÊé•Âà∞Â§ñÈÉ®ËµÑÊ∫ê„ÄÇËøôÈáåÊàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™ÊµÅÔºå‰ªé json Êñá‰ª∂Êï∞ÊçÆÊ∫ê‰∏≠Ëé∑ÂèñÊï∞ÊçÆÔºåÂπ∂ÂèëÈÄÅÂà∞ ekuiper ‰∏≠„ÄÇ È¶ñÂÖàÈÖçÁΩÆÊñá‰ª∂Êï∞ÊçÆÊ∫êÔºåËøûÊé•Âô®ÁöÑÈÖçÁΩÆÊñá‰ª∂‰Ωç‰∫é /etc/sources/file.yaml„ÄÇ 1234567891011121314151617181920212223242526272829default: # Êñá‰ª∂ÁöÑÁ±ªÂûãÔºåÊîØÊåÅ jsonÔºå csv Âíå lines fileType: json # Êñá‰ª∂‰ª• eKuiper ‰∏∫Ê†πÁõÆÂΩïÁöÑÁõÆÂΩïÊàñÊñá‰ª∂ÁöÑÁªùÂØπË∑ØÂæÑ„ÄÇ # ËØ∑ÂãøÂú®Ê≠§Â§ÑÂåÖÂê´Êñá‰ª∂Âêç„ÄÇÊñá‰ª∂ÂêçÂ∫îÂú®ÊµÅÊï∞ÊçÆÊ∫ê‰∏≠ÂÆö‰πâ path: data # ËØªÂèñÊñá‰ª∂ÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÂçï‰Ωç‰∏∫ms„ÄÇÂ¶ÇÊûúÂè™ËØªÂèñ‰∏ÄÊ¨°ÔºåÂàôÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ 0 interval: 0 # ËØªÂèñÂêéÔºå‰∏§Êù°Êï∞ÊçÆÂèëÈÄÅÁöÑÈó¥ÈöîÊó∂Èó¥ sendInterval: 0 # ÊòØÂê¶Âπ∂Ë°åËØªÂèñÁõÆÂΩï‰∏≠ÁöÑÊñá‰ª∂ parallel: false # Êñá‰ª∂ËØªÂèñÂêéÁöÑÊìç‰Ωú # 0: Êñá‰ª∂‰øùÊåÅ‰∏çÂèò # 1: Âà†Èô§Êñá‰ª∂ # 2: ÁßªÂä®Êñá‰ª∂Âà∞ moveTo ÂÆö‰πâÁöÑ‰ΩçÁΩÆ actionAfterRead: 0 # ÁßªÂä®Êñá‰ª∂ÁöÑ‰ΩçÁΩÆ, ‰ªÖÁî®‰∫é actionAfterRead ‰∏∫ 2 ÁöÑÊÉÖÂÜµ moveTo: /tmp/kuiper/moved # ÊòØÂê¶ÂåÖÂê´Êñá‰ª∂Â§¥ÔºåÂ§öÁî®‰∫é csv„ÄÇËã•‰∏∫ trueÔºåÂàôÁ¨¨‰∏ÄË°åËß£Êûê‰∏∫Êñá‰ª∂Â§¥„ÄÇ hasHeader: false # ÂÆö‰πâÊñá‰ª∂ÁöÑÂàó„ÄÇÂ¶ÇÊûúÂÆö‰πâ‰∫ÜÊñá‰ª∂Â§¥ÔºåËØ•ÈÄâÈ°πÂ∞ÜË¢´Ë¶ÜÁõñ„ÄÇ # columns: [id, name] # ÂøΩÁï•ÂºÄÂ§¥Â§öÂ∞ëË°åÁöÑÂÜÖÂÆπ„ÄÇ ignoreStartLines: 0 # ÂøΩÁï•ÁªìÂ∞æÂ§öÂ∞ëË°åÁöÑÂÜÖÂÆπ„ÄÇÊúÄÂêéÁöÑÁ©∫Ë°å‰∏çËÆ°ÁÆóÂú®ÂÜÖ„ÄÇ ignoreEndLines: 0 # ‰ΩøÁî®ÊåáÂÆöÁöÑÂéãÁº©ÊñπÊ≥ïËß£ÂéãÁº©Êñá‰ª∂„ÄÇÁé∞Âú®ÊîØÊåÅ`gzip`„ÄÅ`zstd` ÊñπÊ≥ï„ÄÇ decompression: "" ‰ΩøÁî® CLI ÂàõÂª∫ steam Âêç‰∏∫ stream1: 1./bin/kuiper create stream stream1 '(id BIGINT, name STRING,size BIGINT) WITH (DATASOURCE="test.json", FORMAT="json", TYPE="file");' Json Êñá‰ª∂ÁöÑÂÜÖÂÆπ‰∏∫Ôºö 123456[ &#123;"id": 1,"size":100, "name": "John Doe"&#125;, &#123;"id": 2,"size":200, "name": "Jane Smith"&#125;, &#123;"id": 3,"size":300, "name": "Kobe Brant"&#125;, &#123;"id": 4,"size":400, "name": "Alen Iverson"&#125;] ÂàõÂª∫ Databend Sink Rule‰∏Ä‰∏™ËßÑÂàô‰ª£Ë°®‰∫Ü‰∏Ä‰∏™ÊµÅÂ§ÑÁêÜÊµÅÁ®ãÔºåÂÆö‰πâ‰∫Ü‰ªéÂ∞ÜÊï∞ÊçÆËæìÂÖ•ÊµÅÁöÑÊï∞ÊçÆÊ∫êÂà∞ÂêÑÁßçÂ§ÑÁêÜÈÄªËæëÔºåÂÜçÂà∞Â∞ÜÊï∞ÊçÆËæìÂÖ•Âà∞Â§ñÈÉ®Á≥ªÁªüÁöÑÂä®‰Ωú„ÄÇekuiper Êúâ‰∏§ÁßçÊñπÊ≥ïÊù•ÂÆö‰πâËßÑÂàôÁöÑ‰∏öÂä°ÈÄªËæë„ÄÇË¶Å‰πà‰ΩøÁî®SQL/Âä®‰ΩúÁªÑÂêàÔºåË¶Å‰πà‰ΩøÁî®Êñ∞Â¢ûÂä†ÁöÑÂõæAPI„ÄÇ ËøôÈáåÊàë‰ª¨ÈÄöËøáÊåáÂÆö sql Âíå actions Â±ûÊÄßÔºå‰ª•Â£∞ÊòéÁöÑÊñπÂºèÂÆö‰πâËßÑÂàôÁöÑ‰∏öÂä°ÈÄªËæë„ÄÇÂÖ∂‰∏≠Ôºåsql ÂÆö‰πâ‰∫ÜÈíàÂØπÈ¢ÑÂÆö‰πâÊµÅËøêË°åÁöÑ SQL Êü•ËØ¢ÔºåËøôÂ∞ÜËΩ¨Êç¢Êï∞ÊçÆ„ÄÇÁÑ∂ÂêéÔºåËæìÂá∫ÁöÑÊï∞ÊçÆÂèØ‰ª•ÈÄöËøá action Ë∑ØÁî±Âà∞Â§ö‰∏™‰ΩçÁΩÆ„ÄÇ ËßÑÂàôÁî± JSON ÂÆö‰πâÔºå‰∏ãÈù¢ÊòØÂáÜÂ§áÂàõÂª∫ÁöÑËßÑÂàô myRule.jsonÔºö 123456789101112131415&#123; "id": "myRule", "sql": "SELECT id, name from stream1", "actions": [ &#123; "log": &#123; &#125;, "sql": &#123; "url": "databend://databend:databend@localhost:8000/default?sslmode=disable", "table": "ekuiper_test", "fields": ["id","name"] &#125; &#125; ]&#125; ÊâßË°å CLI ÂàõÂª∫ËßÑÂàôÔºö 1./bin/kuiper create rule myRule -f myRule.json ÂèØ‰ª•Êü•ÁúãÊâÄÂàõÂª∫ËßÑÂàôÁöÑËøêË°åÁä∂ÊÄÅÔºö 1./bin/kuiper getstatus rule myRule ËßÑÂàôÂàõÂª∫ÂêéÔºå‰ºöÁ´ãÂç≥Â∞ÜÁ¨¶ÂêàËßÑÂàôÊù°‰ª∂ÁöÑÊï∞ÊçÆÂèëÈÄÅÂà∞ÁõÆÊ†áÁ´ØÔºåÊ≠§Êó∂Êàë‰ª¨Êü•Áúã databend ÁöÑ ekuiper_test Ë°®ÔºåÂèØ‰ª•ÁúãÂà∞Êñá‰ª∂Êï∞ÊçÆÊ∫ê‰∏≠ÁöÑÊï∞ÊçÆÂ∑≤ÁªèË¢´ÂÜôÂÖ•Âà∞ databendÔºö ÂèØ‰ª•ÁúãÂà∞Áî±‰∫éÊàë‰ª¨ÁöÑËßÑÂàô SQL ‰∏≠Âè™ÊåáÂÆö‰∫Ü id, name Â≠óÊÆµÔºåÊâÄ‰ª•ËøôÈáåÂè™ÊúâËøô‰∏§‰∏™Â≠óÊÆµË¢´ÂÜôÂÖ•„ÄÇ ÁªìËÆ∫Ekuiper ÊòØ EMQ Êóó‰∏ãÁöÑ‰∏ÄÊ¨æÊµÅÂ§ÑÁêÜËΩØ‰ª∂ÔºåÂÖ∂‰ΩìÁßØÂ∞è„ÄÅÂäüËÉΩÂº∫Â§ßÔºåÂú®Â∑•‰∏öÁâ©ËÅîÁΩë„ÄÅËΩ¶ËæÜÁΩë„ÄÅÂÖ¨ÂÖ±Êï∞ÊçÆÂàÜÊûêÁ≠âÂæàÂ§öÂú∫ÊôØ‰∏≠ÂæóÂà∞ÂπøÊ≥õ‰ΩøÁî®„ÄÇÊú¨Êñá‰ªãÁªçÂ¶Ç‰Ωï‰ΩøÁî® eKuiper Â∞ÜÁâ©ËÅîÁΩëÊµÅÂ§ÑÁêÜÊï∞ÊçÆÂÜôÂÖ• Databend„ÄÇ]]></content>
      <categories>
        <category>Databend</category>
      </categories>
      <tags>
        <tag>Databend</tag>
        <tag>EMQ</tag>
        <tag>stream data</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[databend kafka connect ÊûÑÂª∫ÂÆûÊó∂Êï∞ÊçÆÂêåÊ≠•]]></title>
    <url>%2F2023%2F09%2F08%2Fdatabend-kafka-connect-%E6%9E%84%E5%BB%BA%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%2F</url>
    <content type="text"><![CDATA[kafka connect ‰ªãÁªçKafka Connect ÊòØ‰∏Ä‰∏™Áî®‰∫éÂú®Apache Kafka¬ÆÂíåÂÖ∂‰ªñÊï∞ÊçÆÁ≥ªÁªü‰πãÈó¥ÂèØÊâ©Â±ï‰∏îÂèØÈù†Âú∞ÊµÅÂºè‰º†ËæìÊï∞ÊçÆÁöÑÂ∑•ÂÖ∑„ÄÇÈÄöËøáÂ∞ÜÊï∞ÊçÆÁßªÂÖ•ÂíåÁßªÂá∫ Kafka ËøõË°åÊ†áÂáÜÂåñÔºå‰ΩøÂæóÂø´ÈÄüÂÆö‰πâËøûÊé•Âô®‰ª•Âú® Kafka ‰∏≠‰º†ËæìÂ§ßÂûãÊï∞ÊçÆÈõÜÂèòÂæóÁÆÄÂçïÔºåÂèØ‰ª•Êõ¥ËΩªÊùæÂú∞ÊûÑÂª∫Â§ßËßÑÊ®°ÁöÑÂÆûÊó∂Êï∞ÊçÆÁÆ°ÈÅì„ÄÇÊàë‰ª¨‰ΩøÁî® Kafka Connector ËØªÂèñÊàñÂÜôÂÖ•Â§ñÈÉ®Á≥ªÁªü„ÄÅÁÆ°ÁêÜÊï∞ÊçÆÊµÅ‰ª•ÂèäÊâ©Â±ïÁ≥ªÁªüÔºåÊâÄÊúâËøô‰∫õÈÉΩÊó†ÈúÄÂºÄÂèëÊñ∞‰ª£Á†Å„ÄÇKafka Connect ÁÆ°ÁêÜ‰∏éÂÖ∂‰ªñÁ≥ªÁªüËøûÊé•Êó∂ÁöÑÊâÄÊúâÂ∏∏ËßÅÈóÆÈ¢òÔºàSchema ÁÆ°ÁêÜ„ÄÅÂÆπÈîô„ÄÅÂπ∂Ë°åÊÄß„ÄÅÂª∂Ëøü„ÄÅÊäïÈÄíËØ≠‰πâÁ≠âÔºâÔºåÊØè‰∏™ Connector Âè™ÂÖ≥Ê≥®Â¶Ç‰ΩïÂú®ÁõÆÊ†áÁ≥ªÁªüÂíå Kafka ‰πãÈó¥Â§çÂà∂Êï∞ÊçÆ„ÄÇ Kafka ËøûÊé•Âô®ÈÄöÂ∏∏Áî®Êù•ÊûÑÂª∫ data pipelineÔºå‰∏ÄËà¨Êúâ‰∏§Áßç‰ΩøÁî®Âú∫ÊôØÔºö ÂºÄÂßãÂíåÁªìÊùüÁöÑÁ´ØÁÇπÔºö‰æãÂ¶ÇÔºåÂ∞Ü Kafka ‰∏≠ÁöÑÊï∞ÊçÆÂØºÂá∫Âà∞ Databend Êï∞ÊçÆÂ∫ìÔºåÊàñËÄÖÊää Mysql Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆÂØºÂÖ• Kafka ‰∏≠„ÄÇÊï∞ÊçÆ‰º†ËæìÁöÑ‰∏≠Èó¥‰ªãË¥®Ôºö‰æãÂ¶ÇÔºå‰∏∫‰∫ÜÊääÊµ∑ÈáèÁöÑÊó•ÂøóÊï∞ÊçÆÂ≠òÂÇ®Âà∞ Elasticsearch ‰∏≠ÔºåÂèØ‰ª•ÂÖàÊääËøô‰∫õÊó•ÂøóÊï∞ÊçÆ‰º†ËæìÂà∞ Kafka ‰∏≠ÔºåÁÑ∂ÂêéÂÜç‰ªé Kafka ‰∏≠Â∞ÜËøô‰∫õÊï∞ÊçÆÂØºÂÖ•Âà∞ Elasticsearch ‰∏≠ËøõË°åÂ≠òÂÇ®„ÄÇKafka ËøûÊé•Âô®ÂèØ‰ª•‰Ωú‰∏∫Êï∞ÊçÆÁÆ°ÈÅìÂêÑ‰∏™Èò∂ÊÆµÁöÑÁºìÂÜ≤Âå∫ÔºåÂ∞ÜÊ∂àË¥πËÄÖÁ®ãÂ∫èÂíåÁîü‰∫ßËÄÖÁ®ãÂ∫èÊúâÊïàÂú∞ËøõË°åËß£ËÄ¶„ÄÇ Kafka connect ÂàÜ‰∏∫‰∏§ÁßçÔºö Source connectÔºöË¥üË¥£Â∞ÜÊï∞ÊçÆÂØºÂÖ• Kafka„ÄÇSink connectÔºöË¥üË¥£Â∞ÜÊï∞ÊçÆ‰ªé Kafka Á≥ªÁªü‰∏≠ÂØºÂá∫Âà∞ÁõÆÊ†áË°®„ÄÇ Databend Kafka ConnectKafka ÁõÆÂâçÂú® Confluent Hub ‰∏äÊèê‰æõ‰∫Ü‰∏äÁôæÁßç connectorÔºåÊØîÂ¶Ç Elasticsearch Service Sink Connector, Amazon Sink Connector, HDFS Sink Á≠âÔºåÁî®Êà∑ÂèØ‰ª•‰ΩøÁî®Ëøô‰∫õ connector ‰ª• kafka ‰∏∫‰∏≠ÂøÉÊûÑÂª∫‰ªªÊÑèÁ≥ªÁªü‰πãÈó¥ÁöÑÊï∞ÊçÆÁÆ°ÈÅì„ÄÇÁé∞Âú®Êàë‰ª¨‰πü‰∏∫ Databend Êèê‰æõ‰∫Ü kafka connect sink pluginÔºåËøôÁØáÊñáÁ´†Êàë‰ª¨Â∞Ü‰ºö‰ªãÁªçÂ¶Ç‰Ωï‰ΩøÁî® MySQL JDBC Source Connector Âíå [Databend Sink Connector] ÊûÑÂª∫ÂÆûÊó∂ÁöÑÊï∞ÊçÆÂêåÊ≠•ÁÆ°ÈÅì„ÄÇ ÂêØÂä® Kafka ConnectÊú¨ÊñáÂÅáÂÆöÊìç‰ΩúÁöÑÊú∫Âô®‰∏äÂ∑≤ÁªèÂÆâË£Ö Apache KafkaÔºåÂ¶ÇÊûúÁî®Êà∑ËøòÊ≤°ÊúâÂÆâË£ÖÔºåÂèØ‰ª•ÂèÇËÄÉ Kafka quickstart ËøõË°åÂÆâË£Ö„ÄÇ Kafka Connect ÁõÆÂâçÊîØÊåÅ‰∏§ÁßçÊâßË°åÊ®°ÂºèÔºöStandalone Ê®°ÂºèÂíåÂàÜÂ∏ÉÂºèÊ®°Âºè„ÄÇ ÂêØÂä®Ê®°ÂºèStandalone Ê®°ÂºèÂú® Standalone Ê®°Âºè‰∏ãÔºåÊâÄÊúâÁöÑÂ∑•‰ΩúÈÉΩÂú®Âçï‰∏™ËøõÁ®ã‰∏≠ÂÆåÊàê„ÄÇËøôÁßçÊ®°ÂºèÊõ¥ÂÆπÊòìÈÖçÁΩÆ‰ª•ÂèäÂÖ•Èó®Ôºå‰ΩÜ‰∏çËÉΩÂÖÖÂàÜÂà©Áî® Kafka Connect ÁöÑÊüê‰∫õÈáçË¶ÅÂäüËÉΩÔºå‰æãÂ¶ÇÔºåÂÆπÈîô„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ÂêØÂä® Standalone ËøõÁ®ãÔºö 1bin/connect-standalone.sh config/connect-standalone.properties connector1.properties [connector2.properties ...] Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ config/connect-standalone.properties ÊòØ worker ÁöÑÈÖçÁΩÆ„ÄÇËøôÂÖ∂‰∏≠ÂåÖÊã¨ Kafka ËøûÊé•ÂèÇÊï∞„ÄÅÂ∫èÂàóÂåñÊ†ºÂºè‰ª•ÂèäÊèê‰∫§ Offset ÁöÑÈ¢ëÁéáÁ≠âÈÖçÁΩÆÔºö 12345bootstrap.servers=localhost:9092key.converter.schemas.enable=truevalue.converter.schemas.enable=trueoffset.storage.file.filename=/tmp/connect.offsetsoffset.flush.interval.ms=10000 ÂêéÈù¢ÁöÑÈÖçÁΩÆÊòØÊåáÂÆöË¶ÅÂêØÂä®ÁöÑ connector ÁöÑÂèÇÊï∞„ÄÇ ‰∏äËø∞Êèê‰æõÁöÑÈªòËÆ§ÈÖçÁΩÆÈÄÇÁî®‰∫é‰ΩøÁî® config/server.properties Êèê‰æõÁöÑÈªòËÆ§ÈÖçÁΩÆËøêË°åÁöÑÊú¨Âú∞ÈõÜÁæ§„ÄÇÂ¶ÇÊûú‰ΩøÁî®‰∏çÂêåÈÖçÁΩÆÊàñËÄÖÂú®Áîü‰∫ßÈÉ®ÁΩ≤ÔºåÈÇ£Â∞±ÈúÄË¶ÅÂØπÈªòËÆ§ÈÖçÁΩÆÂÅöË∞ÉÊï¥„ÄÇ‰ΩÜÊó†ËÆ∫ÊÄéÊ†∑ÔºåÊâÄÊúâ WorkerÔºàÁã¨Á´ãÁöÑÂíåÂàÜÂ∏ÉÂºèÁöÑÔºâÈÉΩÈúÄË¶Å‰∏Ä‰∫õÈÖçÁΩÆÔºö bootstrap.serversÔºöËØ•ÂèÇÊï∞ÂàóÂá∫‰∫ÜÂ∞ÜË¶Å‰∏é Connect ÂçèÂêåÂ∑•‰ΩúÁöÑ broker ÊúçÂä°Âô®ÔºåConnector Â∞Ü‰ºöÂêëËøô‰∫õ broker ÂÜôÂÖ•Êï∞ÊçÆÊàñËÄÖ‰ªéÂÆÉ‰ª¨ÈÇ£ÈáåËØªÂèñÊï∞ÊçÆ„ÄÇ‰Ω†‰∏çÈúÄË¶ÅÊåáÂÆöÈõÜÁæ§ÁöÑÊâÄÊúâ brokerÔºå‰ΩÜÊòØÂª∫ËÆÆËá≥Â∞ëÊåáÂÆö3‰∏™„ÄÇ key.converter Âíå value.converterÔºöÂàÜÂà´ÊåáÂÆö‰∫ÜÊ∂àÊÅØÈîÆÂíåÊ∂àÊÅØÂÄºÊâÄ‰ΩøÁî®ÁöÑÁöÑËΩ¨Êç¢Âô®ÔºåÁî®‰∫éÂú® Kafka Connect Ê†ºÂºèÂíåÂÜôÂÖ• Kafka ÁöÑÂ∫èÂàóÂåñÊ†ºÂºè‰πãÈó¥ËøõË°åËΩ¨Êç¢„ÄÇËøôÊéßÂà∂‰∫ÜÂÜôÂÖ• Kafka Êàñ‰ªé Kafka ËØªÂèñÁöÑÊ∂àÊÅØ‰∏≠ÈîÆÂíåÂÄºÁöÑÊ†ºÂºè„ÄÇÁî±‰∫éËøô‰∏é Connector Ê≤°Êúâ‰ªª‰ΩïÂÖ≥Á≥ªÔºåÂõ†Ê≠§‰ªª‰Ωï Connector ÂèØ‰ª•‰∏é‰ªª‰ΩïÂ∫èÂàóÂåñÊ†ºÂºè‰∏ÄËµ∑‰ΩøÁî®„ÄÇÈªòËÆ§‰ΩøÁî® Kafka Êèê‰æõÁöÑ JSONConverter„ÄÇÊúâ‰∫õËΩ¨Êç¢Âô®ËøòÂåÖÂê´‰∫ÜÁâπÂÆöÁöÑÈÖçÁΩÆÂèÇÊï∞„ÄÇ‰æãÂ¶ÇÔºåÈÄöËøáÂ∞Ü key.converter.schemas.enable ËÆæÁΩÆÊàê true ÊàñËÄÖ false Êù•ÊåáÂÆö JSON Ê∂àÊÅØÊòØÂê¶ÂåÖÂê´ schema„ÄÇ offset.storage.file.filenameÔºöÁî®‰∫éÂ≠òÂÇ® Offset Êï∞ÊçÆÁöÑÊñá‰ª∂„ÄÇ Ëøô‰∫õÈÖçÁΩÆÂèÇÊï∞ÂèØ‰ª•ËÆ© Kafka Connect ÁöÑÁîü‰∫ßËÄÖÂíåÊ∂àË¥πËÄÖËÆøÈóÆÈÖçÁΩÆ„ÄÅOffset ÂíåÁä∂ÊÄÅ Topic„ÄÇÈÖçÁΩÆ Kafka Source ‰ªªÂä°‰ΩøÁî®ÁöÑÁîü‰∫ßËÄÖÂíå Kafka Sink ‰ªªÂä°‰ΩøÁî®ÁöÑÊ∂àË¥πËÄÖÔºåÂèØ‰ª•‰ΩøÁî®Áõ∏ÂêåÁöÑÂèÇÊï∞Ôºå‰ΩÜÈúÄË¶ÅÂàÜÂà´Âä†‰∏ä ‚Äòproducer.‚Äô Âíå ‚Äòconsumer.‚Äô ÂâçÁºÄ„ÄÇbootstrap.servers ÊòØÂîØ‰∏Ä‰∏çÈúÄË¶ÅÊ∑ªÂä†ÂâçÁºÄÁöÑ Kafka ÂÆ¢Êà∑Á´ØÂèÇÊï∞„ÄÇ distributed Ê®°ÂºèÂàÜÂ∏ÉÂºèÊ®°ÂºèÂèØ‰ª•Ëá™Âä®Âπ≥Ë°°Â∑•‰ΩúË¥üËΩΩÔºåÂπ∂ÂèØ‰ª•Âä®ÊÄÅÊâ©Â±ïÔºàÊàñÁº©ÂáèÔºâ‰ª•ÂèäÊèê‰æõÂÆπÈîô„ÄÇÂàÜÂ∏ÉÂºèÊ®°ÂºèÁöÑÊâßË°å‰∏é Standalone Ê®°ÂºèÈùûÂ∏∏Áõ∏‰ººÔºö 1bin/connect-distributed.sh config/connect-distributed.properties ‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÂêØÂä®ÁöÑËÑöÊú¨‰ª•ÂèäÈÖçÁΩÆÂèÇÊï∞„ÄÇÂú®ÂàÜÂ∏ÉÂºèÊ®°Âºè‰∏ãÔºå‰ΩøÁî® connect-distributed.sh Êù•‰ª£Êõø connect-standalone.sh„ÄÇÁ¨¨‰∏Ä‰∏™ worker ÈÖçÁΩÆÂèÇÊï∞‰ΩøÁî®ÁöÑÊòØ config/connect-distributed.properties ÈÖçÁΩÆÊñá‰ª∂Ôºö 12345678910111213bootstrap.servers=localhost:9092group.id=connect-clusterkey.converter.schemas.enable=truevalue.converter.schemas.enable=trueoffset.storage.topic=connect-offsetsoffset.storage.replication.factor=1#offset.storage.partitions=25config.storage.topic=connect-configsconfig.storage.replication.factor=1status.storage.topic=connect-statusstatus.storage.replication.factor=1#status.storage.partitions=5offset.flush.interval.ms=10000 Kafka Connect Â∞Ü Offset„ÄÅÈÖçÁΩÆ‰ª•Âèä‰ªªÂä°Áä∂ÊÄÅÂ≠òÂÇ®Âú® Kafka Topic ‰∏≠„ÄÇÂª∫ËÆÆÊâãÂä®ÂàõÂª∫ Offset„ÄÅÈÖçÁΩÆÂíåÁä∂ÊÄÅÁöÑ TopicÔºå‰ª•ËææÂà∞ÊâÄÈúÄÁöÑÂàÜÂå∫Êï∞ÂíåÂ§çÂà∂Âõ†Â≠ê„ÄÇÂ¶ÇÊûúÂú®ÂêØÂä® Kafka Connect Êó∂Â∞öÊú™ÂàõÂª∫ TopicÔºåÂ∞Ü‰ΩøÁî®ÈªòËÆ§ÂàÜÂå∫Êï∞ÂíåÂ§çÂà∂Âõ†Â≠êÊù•Ëá™Âä®ÂàõÂª∫ TopicÔºåËøôÂèØËÉΩ‰∏çÈÄÇÂêàÊàë‰ª¨ÁöÑÂ∫îÁî®„ÄÇÂú®ÂêØÂä®ÈõÜÁæ§‰πãÂâçÈÖçÁΩÆÂ¶Ç‰∏ãÂèÇÊï∞Ëá≥ÂÖ≥ÈáçË¶ÅÔºö group.idÔºöConnect ÈõÜÁæ§ÁöÑÂîØ‰∏ÄÂêçÁß∞ÔºåÈªòËÆ§‰∏∫ connect-cluster„ÄÇÂÖ∑ÊúâÁõ∏Âêå group id ÁöÑ worker Â±û‰∫éÂêå‰∏Ä‰∏™ Connect ÈõÜÁæ§„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËøô‰∏çËÉΩ‰∏éÊ∂àË¥πËÄÖÁªÑ ID ÂÜ≤Á™Å„ÄÇ config.storage.topicÔºöÁî®‰∫éÂ≠òÂÇ® Connector Âíå‰ªªÂä°ÈÖçÁΩÆÁöÑ TopicÔºåÈªòËÆ§‰∏∫ connect-configs„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËøôÊòØ‰∏Ä‰∏™Âè™Êúâ‰∏Ä‰∏™ÂàÜÂå∫„ÄÅÈ´òÂ∫¶Â§çÂà∂„ÄÅÂéãÁº©ÁöÑ Topic„ÄÇÊàë‰ª¨ÂèØËÉΩÈúÄË¶ÅÊâãÂä®ÂàõÂª∫ Topic ‰ª•Á°Æ‰øùÈÖçÁΩÆÁöÑÊ≠£Á°ÆÔºåÂõ†‰∏∫Ëá™Âä®ÂàõÂª∫ÁöÑ Topic ÂèØËÉΩÊúâÂ§ö‰∏™ÂàÜÂå∫ÊàñËá™Âä®ÈÖçÁΩÆ‰∏∫Âà†Èô§ËÄå‰∏çÊòØÂéãÁº©„ÄÇ offset.storage.topicÔºöÁî®‰∫éÂ≠òÂÇ® Offset ÁöÑ TopicÔºåÈªòËÆ§‰∏∫ connect-offsets„ÄÇËøô‰∏™ Topic ÂèØ‰ª•ÊúâÂ§ö‰∏™ÂàÜÂå∫„ÄÇ status.storage.topicÔºöÁî®‰∫éÂ≠òÂÇ®Áä∂ÊÄÅÁöÑ TopicÔºåÈªòËÆ§‰∏∫ connect-status„ÄÇËøô‰∏™ Topic ÂèØ‰ª•ÊúâÂ§ö‰∏™ÂàÜÂå∫„ÄÇ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÂú®ÂàÜÂ∏ÉÂºèÊ®°Âºè‰∏ãÈÄöËøárest apiÊù•ÁÆ°ÁêÜconnector„ÄÇ ÊØîÂ¶ÇÔºö 12345GET /connectors ‚Äì ËøîÂõûÊâÄÊúâÊ≠£Âú®ËøêË°åÁöÑconnectorÂêç„ÄÇPOST /connectors ‚Äì Êñ∞Âª∫‰∏Ä‰∏™connector; ËØ∑Ê±Ç‰ΩìÂøÖÈ°ªÊòØjsonÊ†ºÂºèÂπ∂‰∏îÈúÄË¶ÅÂåÖÂê´nameÂ≠óÊÆµÂíåconfigÂ≠óÊÆµÔºånameÊòØconnectorÁöÑÂêçÂ≠óÔºåconfigÊòØjsonÊ†ºÂºèÔºåÂøÖÈ°ªÂåÖÂê´‰Ω†ÁöÑconnectorÁöÑÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇGET /connectors/&#123;name&#125; ‚Äì Ëé∑ÂèñÊåáÂÆöconnetorÁöÑ‰ø°ÊÅØ„ÄÇGET /connectors/&#123;name&#125;/config ‚Äì Ëé∑ÂèñÊåáÂÆöconnectorÁöÑÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇPUT /connectors/&#123;name&#125;/config ‚Äì Êõ¥Êñ∞ÊåáÂÆöconnectorÁöÑÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇ ÈÖçÁΩÆ ConnectorMySQL Source Connector ÂÆâË£Ö MySQL Source Connector plugin ËøôÈáåÊàë‰ª¨‰ΩøÁî® Confluent Êèê‰æõÁöÑ JDBC Source Connector„ÄÇ ‰ªé Confluent hub ‰∏ãËΩΩ Kafka Connect JDBC Êèí‰ª∂Âπ∂Â∞Ü zip Êñá‰ª∂Ëß£ÂéãÂà∞ /path/kafka/libs ÁõÆÂΩï‰∏ã„ÄÇ ÂÆâË£Ö MySQL JDBC Driver Âõ†‰∏∫ Connector ÈúÄË¶Å‰∏éÊï∞ÊçÆÂ∫ìËøõË°åÈÄö‰ø°ÔºåÊâÄ‰ª•ËøòÈúÄË¶Å JDBC È©±Âä®Á®ãÂ∫è„ÄÇJDBC Connector Êèí‰ª∂‰πüÊ≤°ÊúâÂÜÖÁΩÆ MySQL È©±Âä®Á®ãÂ∫èÔºåÈúÄË¶ÅÊàë‰ª¨ÂçïÁã¨‰∏ãËΩΩÈ©±Âä®Á®ãÂ∫è„ÄÇMySQL ‰∏∫ËÆ∏Â§öÂπ≥Âè∞Êèê‰æõ‰∫Ü JDBC È©±Âä®Á®ãÂ∫è„ÄÇÈÄâÊã© Platform Independent ÈÄâÈ°πÔºåÁÑ∂Âêé‰∏ãËΩΩÂéãÁº©ÁöÑ TAR Êñá‰ª∂„ÄÇËØ•Êñá‰ª∂ÂåÖÂê´ JAR Êñá‰ª∂ÂíåÊ∫ê‰ª£Á†Å„ÄÇÂ∞ÜÊ≠§ tar.gz Êñá‰ª∂ÁöÑÂÜÖÂÆπËß£ÂéãÂà∞‰∏Ä‰∏™‰∏¥Êó∂ÁõÆÂΩï„ÄÇÂ∞Ü jar Êñá‰ª∂Ôºà‰æãÂ¶ÇÔºåmysql-connector-java-8.0.17.jarÔºâÔºåÂπ∂‰∏î‰ªÖÂ∞ÜÊ≠§ JAR Êñá‰ª∂Â§çÂà∂Âà∞‰∏é kafka-connect-jdbc jar Êñá‰ª∂Áõ∏ÂêåÁöÑ libs ÁõÆÂΩï‰∏ãÔºö 1cp mysql-connector-j-8.0.32.jar /opt/homebrew/Cellar/kafka/3.4.0/libexec/libs/ ÈÖçÁΩÆ MySQL Connector Âú® /path/kafka/config ‰∏ãÂàõÂª∫ mysql.properties ÈÖçÁΩÆÊñá‰ª∂ÔºåÂπ∂‰ΩøÁî®‰∏ãÈù¢ÁöÑÈÖçÁΩÆ: 1234567891011121314name=test-source-mysql-autoincrementconnector.class=io.confluent.connect.jdbc.JdbcSourceConnectortasks.max=1connection.url=jdbc:mysql://localhost:3306/mydb?useSSL=falseconnection.user=rootconnection.password=123456#mode=timestamp+incrementingmode=incrementingtable.whitelist=mydb.test_kafkapoll.interval.ms=1000table.poll.interval.ms=3000incrementing.column.name=id#timestamp.column.name=tmstopics=test_kafka ÈíàÂØπÈÖçÁΩÆÊàë‰ª¨ËøôÈáåÈáçÁÇπ‰ªãÁªç mode Ôºå incrementing.column.name ÔºåÂíå timestamp.column.name Âá†‰∏™Â≠óÊÆµ„ÄÇKafka Connect MySQL JDBC Source Êèê‰æõ‰∫Ü‰∏âÁßçÂ¢ûÈáèÂêåÊ≠•Ê®°ÂºèÔºö incrementing timestamp timestamp+incrementing Âú® incrementing Ê®°Âºè‰∏ãÔºåÊØèÊ¨°ÈÉΩÊòØÊ†πÊçÆ incrementing.column.name ÂèÇÊï∞ÊåáÂÆöÁöÑÂàóÔºåÊü•ËØ¢Â§ß‰∫éËá™‰∏äÊ¨°ÊãâÂèñÁöÑÊúÄÂ§ßidÔºö 123SELECT * FROM mydb.test_kafkaWHERE id &gt; ?ORDER BY id ASC ËøôÁßçÊ®°ÂºèÁöÑÁº∫ÁÇπÊòØÊó†Ê≥ïÊçïËé∑Ë°å‰∏äÊõ¥Êñ∞Êìç‰ΩúÔºà‰æãÂ¶ÇÔºåUPDATE„ÄÅDELETEÔºâÁöÑÂèòÊõ¥ÔºåÂõ†‰∏∫Êó†Ê≥ïÂ¢ûÂ§ßËØ•Ë°åÁöÑ id„ÄÇ timestamp Ê®°ÂºèÂü∫‰∫éË°®‰∏äÊó∂Èó¥Êà≥ÂàóÊù•Ê£ÄÊµãÊòØÂê¶ÊòØÊñ∞Ë°åÊàñËÄÖ‰øÆÊîπÁöÑË°å„ÄÇËØ•ÂàóÊúÄÂ•ΩÊòØÈöèÁùÄÊØèÊ¨°ÂÜôÂÖ•ËÄåÊõ¥Êñ∞ÔºåÂπ∂‰∏îÂÄºÊòØÂçïË∞ÉÈÄíÂ¢ûÁöÑ„ÄÇÈúÄË¶Å‰ΩøÁî® timestamp.column.name ÂèÇÊï∞ÊåáÂÆöÊó∂Èó¥Êà≥Âàó„ÄÇ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÊó∂Èó¥Êà≥ÂàóÂú®Êï∞ÊçÆË°®‰∏≠‰∏çËÉΩËÆæÁΩÆ‰∏∫ Nullable. Âú® timestamp Ê®°Âºè‰∏ãÔºåÊØèÊ¨°ÈÉΩÊòØÊ†πÊçÆ timestamp.column.name ÂèÇÊï∞ÊåáÂÆöÁöÑÂàóÔºåÊü•ËØ¢Â§ß‰∫éËá™‰∏äÊ¨°ÊãâÂèñÊàêÂäüÁöÑ gmt_modifiedÔºö 123SELECT * FROM mydb.test_kafkaWHERE tms &gt; ? AND tms &lt; ?ORDER BY tms ASC ËøôÁßçÊ®°ÂºèÂèØ‰ª•ÊçïËé∑Ë°å‰∏ä UPDATE ÂèòÊõ¥ÔºåÁº∫ÁÇπÊòØÂèØËÉΩÈÄ†ÊàêÊï∞ÊçÆÁöÑ‰∏¢Â§±„ÄÇÁî±‰∫éÊó∂Èó¥Êà≥Âàó‰∏çÊòØÂîØ‰∏ÄÂàóÂ≠óÊÆµÔºåÂèØËÉΩÂ≠òÂú®Áõ∏ÂêåÊó∂Èó¥Êà≥ÁöÑ‰∏§ÂàóÊàñËÄÖÂ§öÂàóÔºåÂÅáËÆæÂú®ÂØºÂÖ•Á¨¨‰∫åÊù°ÁöÑËøáÁ®ã‰∏≠ÂèëÁîü‰∫ÜÂ¥©Ê∫ÉÔºåÂú®ÊÅ¢Â§çÈáçÊñ∞ÂØºÂÖ•Êó∂ÔºåÊã•ÊúâÁõ∏ÂêåÊó∂Èó¥Êà≥ÁöÑÁ¨¨‰∫åÊù°‰ª•ÂèäÂêéÈù¢Âá†Êù°Êï∞ÊçÆÈÉΩ‰ºö‰∏¢Â§±„ÄÇËøôÊòØÂõ†‰∏∫Á¨¨‰∏ÄÊù°ÂØºÂÖ•ÊàêÂäüÂêéÔºåÂØπÂ∫îÁöÑÊó∂Èó¥Êà≥‰ºöË¢´ËÆ∞ÂΩïÂ∑≤ÊàêÂäüÊ∂àË¥πÔºåÊÅ¢Â§çÂêé‰ºö‰ªéÂ§ß‰∫éËØ•Êó∂Èó¥Êà≥ÁöÑËÆ∞ÂΩïÂºÄÂßãÂêåÊ≠•„ÄÇÊ≠§Â§ñÔºå‰πüÈúÄË¶ÅÁ°Æ‰øùÊó∂Èó¥Êà≥ÂàóÊòØÈöèÁùÄÊó∂Èó¥ÈÄíÂ¢ûÁöÑÔºåÂ¶ÇÊûú‰∫∫‰∏∫ÁöÑ‰øÆÊîπÊó∂Èó¥Êà≥ÂàóÂ∞è‰∫éÂΩìÂâçÂêåÊ≠•ÊàêÂäüÁöÑÊúÄÂ§ßÊó∂Èó¥Êà≥Ôºå‰πü‰ºöÂØºËá¥ËØ•ÂèòÊõ¥‰∏çËÉΩÂêåÊ≠•„ÄÇ ‰ªÖ‰ΩøÁî® incrementing Êàñ timestamp Ê®°ÂºèÈÉΩÂ≠òÂú®Áº∫Èô∑„ÄÇÂ∞Ü timestamp Âíå incrementing ‰∏ÄËµ∑‰ΩøÁî®ÔºåÂèØ‰ª•ÂÖÖÂàÜÂà©Áî® incrementing Ê®°Âºè‰∏ç‰∏¢Â§±Êï∞ÊçÆÁöÑ‰ºòÁÇπ‰ª•Âèä timestamp Ê®°ÂºèÊçïËé∑Êõ¥Êñ∞Êìç‰ΩúÂèòÊõ¥ÁöÑ‰ºòÁÇπ„ÄÇÈúÄË¶Å‰ΩøÁî® incrementing.column.name ÂèÇÊï∞ÊåáÂÆö‰∏•Ê†ºÈÄíÂ¢ûÂàó„ÄÅ‰ΩøÁî® timestamp.column.name ÂèÇÊï∞ÊåáÂÆöÊó∂Èó¥Êà≥Âàó„ÄÇ 1234SELECT * FROM mydb.test_kafkaWHERE tms &lt; ? AND ((tms = ? AND id &gt; ?) OR tms &gt; ?)ORDER BY tms, id ASC Áî±‰∫é MySQL JDBC Source Connector ÊòØÂü∫‰∫é query-based ÁöÑÊï∞ÊçÆËé∑ÂèñÊñπÂºèÔºå‰ΩøÁî® SELECT Êü•ËØ¢Êù•Ê£ÄÁ¥¢Êï∞ÊçÆÔºåÂπ∂Ê≤°ÊúâÂ§çÊùÇÁöÑÊú∫Âà∂Êù•Ê£ÄÊµãÂ∑≤Âà†Èô§ÁöÑË°åÔºåÊâÄ‰ª•‰∏çÊîØÊåÅ DELETE Êìç‰Ωú„ÄÇÂèØ‰ª•‰ΩøÁî®Âü∫‰∫é log-based ÁöÑ [Kafka Connect Debezium]„ÄÇ ÂêéÈù¢ÁöÑÊºîÁ§∫‰∏≠‰ºöÂàÜÂà´ÊºîÁ§∫‰∏äËø∞Ê®°ÂºèÁöÑÊïàÊûú„ÄÇÊõ¥Â§öÁöÑÈÖçÁΩÆÂèÇÊï∞ÂèØ‰ª•ÂèÇËÄÉ MySQL Source Configs „ÄÇ Databend Kafka Connector ÂÆâË£Ö OR ÁºñËØë Databend Kafka Connector ÂèØ‰ª•‰ªéÊ∫êÁ†ÅÁºñËØëÂæóÂà∞ jar ÊàñËÄÖ‰ªé release Áõ¥Êé•‰∏ãËΩΩ„ÄÇ 12git clone https://github.com/databendcloud/databend-kafka-connect.git &amp; cd databend-kafka-connectmvn -Passembly -Dmaven.test.skip package Â∞Ü databend-kafka-connect.jar Êã∑Ë¥ùËá≥ /path/kafka/libs ÁõÆÂΩï‰∏ã„ÄÇ ÂÆâË£Ö Databend JDBC Driver ‰ªé Maven Central ‰∏ãËΩΩÊúÄÊñ∞ÁöÑ databend jdbc Âπ∂Êã∑Ë¥ùËá≥ /path/kafka/libs ÁõÆÂΩï‰∏ã„ÄÇ ÈÖçÁΩÆ Databend Kafka Connector Âú® /path/kafka/config ‰∏ãÂàõÂª∫ mysql.properties ÈÖçÁΩÆÊñá‰ª∂ÔºåÂπ∂‰ΩøÁî®‰∏ãÈù¢ÁöÑÈÖçÁΩÆ: 1234567891011121314151617181920name=databendconnector.class=com.databend.kafka.connect.DatabendSinkConnectorconnection.url=jdbc:databend://localhost:8000connection.user=databendconnection.password=databendconnection.attempts=5connection.backoff.ms=10000connection.database=defaulttable.name.format=default.$&#123;topic&#125;max.retries=10batch.size=1auto.create=trueauto.evolve=trueinsert.mode=upsertpk.mode=record_valuepk.fields=idtopics=test_kafkaerrors.tolerance=all auto.create Âíå auto.evolve ËÆæÁΩÆÊàê true Âêé‰ºöËá™Âä®Âª∫Ë°®Âπ∂Âú®Ê∫êË°®ÁªìÊûÑÂèëÁîüÂèòÂåñÊó∂ÂêåÊ≠•Âà∞ÁõÆÊ†áË°®„ÄÇÂÖ≥‰∫éÊõ¥Â§öÈÖçÁΩÆÂèÇÊï∞ÁöÑ‰ªãÁªçÂèØ‰ª•ÂèÇËÄÉ databend kafka connect properties„ÄÇ ÊµãËØï Databend Kafka ConnectÂáÜÂ§áÂêÑ‰∏™ÁªÑ‰ª∂ ÂêØÂä® MySQL 123456789101112131415161718version: '2.1'services: postgres: image: debezium/example-postgres:1.1 ports: - "5432:5432" environment: - POSTGRES_DB=postgres - POSTGRES_USER=postgres - POSTGRES_PASSWORD=postgres mysql: image: debezium/example-mysql:1.1 ports: - "3306:3306" environment: - MYSQL_ROOT_PASSWORD=123456 - MYSQL_USER=mysqluser - MYSQL_PASSWORD=mysqlpw ÂêØÂä® Databend 123456789101112131415version: '3'services: databend: image: datafuselabs/databend volumes: - /Users/hanshanjie/databend/local-test/databend/databend-query.toml:/etc/databend/query.toml environment: QUERY_DEFAULT_USER: databend QUERY_DEFAULT_PASSWORD: databend MINIO_ENABLED: 'true' ports: - '8000:8000' - '9000:9000' - '3307:3307' - '8124:8124' ‰ª• standalone Ê®°ÂºèÂêØÂä® kafka connectÔºåÂπ∂Âä†ËΩΩ MySQL Source Connector Âíå Databend Sink Connector: 1./bin/connect-standalone.sh config/connect-standalone.properties config/databend.properties config/mysql.properties 12345678[2023-09-06 17:39:23,128] WARN [databend|task-0] These configurations '[metrics.context.connect.kafka.cluster.id]' were supplied but are not used yet. (org.apache.kafka.clients.consumer.ConsumerConfig:385)[2023-09-06 17:39:23,128] INFO [databend|task-0] Kafka version: 3.4.0 (org.apache.kafka.common.utils.AppInfoParser:119)[2023-09-06 17:39:23,128] INFO [databend|task-0] Kafka commitId: 2e1947d240607d53 (org.apache.kafka.common.utils.AppInfoParser:120)[2023-09-06 17:39:23,128] INFO [databend|task-0] Kafka startTimeMs: 1693993163128 (org.apache.kafka.common.utils.AppInfoParser:121)[2023-09-06 17:39:23,148] INFO Created connector databend (org.apache.kafka.connect.cli.ConnectStandalone:113)[2023-09-06 17:39:23,148] INFO [databend|task-0] [Consumer clientId=connector-consumer-databend-0, groupId=connect-databend] Subscribed to topic(s): test_kafka (org.apache.kafka.clients.consumer.KafkaConsumer:969)[2023-09-06 17:39:23,150] INFO [databend|task-0] Starting Databend Sink task (com.databend.kafka.connect.sink.DatabendSinkConfig:33)[2023-09-06 17:39:23,150] INFO [databend|task-0] DatabendSinkConfig values:... InsertInsert Ê®°Âºè‰∏ãÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®Â¶Ç‰∏ãÁöÑ MySQL Connector ÈÖçÁΩÆÔºö 1234567891011121314name=test-source-mysql-jdbc-autoincrementconnector.class=io.confluent.connect.jdbc.JdbcSourceConnectortasks.max=1connection.url=jdbc:mysql://localhost:3306/mydb?useSSL=falseconnection.user=rootconnection.password=123456#mode=timestamp+incrementingmode=incrementingtable.whitelist=mydb.test_kafkapoll.interval.ms=1000table.poll.interval.ms=3000incrementing.column.name=id#timestamp.column.name=tmstopics=test_kafka Âú® MySQL ‰∏≠ÂàõÂª∫Êï∞ÊçÆÂ∫ì mydb ÂíåË°® test_kafka: 12345CREATE DATABASE mydb;USE mydb;CREATE TABLE test_kafka (id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,name VARCHAR(255) NOT NULL,description VARCHAR(512));ALTER TABLE test_kafka AUTO_INCREMENT = 10; Âú®ÊèíÂÖ•Êï∞ÊçÆ‰πãÂâçÔºådatabend-kafka-connect Âπ∂‰∏ç‰ºöÊî∂Âà∞ event ËøõË°åÂª∫Ë°®ÂíåÊï∞ÊçÆÂÜôÂÖ•Ôºö ÊèíÂÖ•Êï∞ÊçÆÔºö 12345678910INSERT INTO test_kafka VALUES (default,"scooter","Small 2-wheel scooter"),(default,"car battery","12V car battery"),(default,"12-pack drill bits","12-pack of drill bits with sizes ranging from #40 to #3"),(default,"hammer","12oz carpenter's hammer"),(default,"hammer","14oz carpenter's hammer"),(default,"hammer","16oz carpenter's hammer"),(default,"rocks","box of assorted rocks"),(default,"jacket","water resistent black wind breaker"),(default,"cloud","test for databend"),(default,"spare tire","24 inch spare tire"); Ê∫êË°®Á´ØÊèíÂÖ•Êï∞ÊçÆÂêéÔºå Databend ÁõÆÊ†áÁ´ØÁöÑË°®Â∞±Êñ∞Âª∫Âá∫Êù•‰∫ÜÔºö ÂêåÊó∂Êï∞ÊçÆ‰πü‰ºöÊàêÂäüÊèíÂÖ•Ôºö Support DDLÊàë‰ª¨Âú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ auto.evolve=trueÔºåÊâÄ‰ª•Âú®Ê∫êË°®ÁªìÊûÑÂèëÁîüÂèòÂåñÁöÑÊó∂ÂÄôÔºå‰ºöÂ∞Ü DDL ÂêåÊ≠•Ëá≥ÁõÆÊ†áË°®„ÄÇËøôÈáåÊàë‰ª¨Ê≠£Â•ΩÈúÄË¶ÅÂ∞Ü MySQL Source Connector ÁöÑÊ®°Âºè‰ªé incrementing ÊîπÊàê timestamp+incrementingÔºåÈúÄË¶ÅÊñ∞Â¢û‰∏Ä‰∏™ timestamp Â≠óÊÆµÂπ∂ÊâìÂºÄ timestamp.column.name=tms ÈÖçÁΩÆ„ÄÇÊàë‰ª¨Âú®ÂéüË°®‰∏≠ÊâßË°åÔºö 1alter table test_kafka add column tms timestamp; Âπ∂ÊèíÂÖ•‰∏ÄÊù°Êï∞ÊçÆÔºö 1insert into test_kafka values(20,"new data","from kafka",now()); Âà∞ÁõÆÊ†áË°®‰∏≠Êü•ÁúãÔºö ÂèëÁé∞ tms Â≠óÊÆµÂ∑≤ÁªèÂêåÊ≠•Ëá≥ Databend tableÔºåÂπ∂‰∏îËØ•Êù°Êï∞ÊçÆ‰πüÂ∑≤ÁªèÊèíÂÖ•ÊàêÂäüÔºö Upsert‰øÆÊîπ MySQL Connector ÁöÑÈÖçÁΩÆ‰∏∫Ôºö 1234567891011121314name=test-source-mysql-jdbc-autoincrementconnector.class=io.confluent.connect.jdbc.JdbcSourceConnectortasks.max=1connection.url=jdbc:mysql://localhost:3306/mydb?useSSL=falseconnection.user=rootconnection.password=123456mode=timestamp+incrementing#mode=incrementingtable.whitelist=mydb.test_kafkapoll.interval.ms=1000table.poll.interval.ms=3000incrementing.column.name=idtimestamp.column.name=tmstopics=test_kafka ÈáçÂêØ kafka connect„ÄÇ Âú®Ê∫êË°®‰∏≠Êõ¥Êñ∞‰∏ÄÊù°Êï∞ÊçÆÔºö 1update test_kafka set name="update from kafka test" where id=20; Âà∞ÁõÆÊ†áË°®‰∏≠ÂèØ‰ª•ÁúãÂà∞Êõ¥Êñ∞ÁöÑÊï∞ÊçÆÔºö ÊÄªÁªìÈÄöËøá‰∏äÈù¢ÁöÑÂÜÖÂÆπÂèØ‰ª•ÁúãÂà∞ databend kafka connect ÂÖ∑Êúâ‰ª•‰∏ãÁâπÊÄßÔºö Table Âíå Column ÊîØÊåÅËá™Âä®ÂàõÂª∫Ôºöauto.create Âíå `auto-evolve ÁöÑÈÖçÁΩÆÊîØÊåÅ‰∏ãÔºåÂèØ‰ª•Ëá™Âä®ÂàõÂª∫ Table Âíå ColumnÔºåTable nameÊòØÂü∫‰∫é Kafka topic name ÂàõÂª∫ÁöÑÔºõ Kafka Shemas ÊîØÊåÅÔºöconnector ÊîØÊåÅ Avro„ÄÅJSON Schema Âíå Protobuf ËæìÂÖ•Êï∞ÊçÆÊ†ºÂºè„ÄÇÂøÖÈ°ªÂêØÁî® Schema Registry ÊâçËÉΩ‰ΩøÁî®Âü∫‰∫é Schema Registry ÁöÑÊ†ºÂºèÔºõ Â§ö‰∏™ÂÜôÂÖ•Ê®°ÂºèÔºöConnector ÊîØÊåÅ insert Âíå upsert ÂÜôÂÖ•Ê®°ÂºèÔºõ Â§ö‰ªªÂä°ÊîØÊåÅÔºöÂú® kafka connect ÁöÑËÉΩÂäõ‰∏ãÔºåconnector ÊîØÊåÅËøêË°å‰∏Ä‰∏™ÊàñÂ§ö‰∏™‰ªªÂä°„ÄÇÂ¢ûÂä†‰ªªÂä°ÁöÑÊï∞ÈáèÂèØ‰ª•ÊèêÈ´òÁ≥ªÁªüÊÄßËÉΩÔºõ È´òÂèØÁî®ÔºöÂàÜÂ∏ÉÂºèÊ®°Âºè‰∏ãÂèØ‰ª•Ëá™Âä®Âπ≥Ë°°Â∑•‰ΩúË¥üËΩΩÔºåÂπ∂ÂèØ‰ª•Âä®ÊÄÅÊâ©Â±ïÔºàÊàñÁº©ÂáèÔºâ‰ª•ÂèäÊèê‰æõÂÆπÈîôËÉΩÂäõ„ÄÇ ÂêåÊó∂ÔºåDatabend Kafka Connect ‰πüËÉΩÂ§ü‰ΩøÁî®ÂéüÁîü connect ÊîØÊåÅÁöÑÈÖçÁΩÆÔºåÊõ¥Â§öÈÖçÁΩÆÂèÇËÄÉ Kafka Connect Sink Configuration Properties for Confluent Platform„ÄÇ]]></content>
      <categories>
        <category>Databend</category>
      </categories>
      <tags>
        <tag>CDC</tag>
        <tag>Databend</tag>
        <tag>kafka connect</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ªé 0 Âà∞ 1 ‰∏∫ Databend ÂºÄÂèëËΩªÈáèÁ∫ß CDC]]></title>
    <url>%2F2023%2F07%2F18%2F%E4%BB%8E-0-%E5%88%B0-1-%E4%B8%BA-Databend-%E8%AE%BE%E8%AE%A1%E8%BD%BB%E9%87%8F%E7%BA%A7-CDC%2F</url>
    <content type="text"><![CDATA[‰ªÄ‰πàÊòØ CDCCDCÔºàChange Data CaptureÔºâÊòØ‰∏ÄÁßçÊï∞ÊçÆÂêåÊ≠•ÊäÄÊúØÔºåÁî®‰∫éÂÆûÊó∂ÊçïËé∑Âíå‰º†ÈÄíÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆÊõ¥Êîπ„ÄÇÈÄöËøá CDCÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂèòÊõ¥‰∫ã‰ª∂ÊçïËé∑Âπ∂ËΩ¨Êç¢ÊàêÊï∞ÊçÆÊµÅÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂‰º†ÈÄíÁªôÂÖ∂‰ªñÁ≥ªÁªüÊàñÂ∫îÁî®Á®ãÂ∫èÔºå‰ª•ÂÆûÁé∞Êï∞ÊçÆÁöÑÂÆûÊó∂ÂêåÊ≠•ÂíåÂàÜÂèë„ÄÇ Â∏∏ËßÅÁöÑ CDC Ê†ºÂºè‰∏∫Ôºö 12345678910&#123; "op": "Update", // "Insert", "Delete", "event_time": "2022-11-01 12:00:00", "payload": &#123; "id": 123, "author": "Franz Kafka", "title": "Metamorphosis", "published_at": "1915-01-01" &#125;&#125; ‰∏ÄÁßçÁîü‰∫ßÂèØÁî®ÁöÑ CDC Á≥ªÁªüÊû∂ÊûÑÂèØ‰ª•ÊòØ‰∏ãÂõæÔºö Áé∞Èò∂ÊÆµ‰∏ªÊµÅ CDC ÊñπÊ°àÂíåÊû∂ÊûÑÂú®ÁõÆÂâçÁöÑÊäÄÊúØÂèëÂ±ï‰∏≠ÔºåÊúâÂá†Áßç‰∏ªÊµÅÁöÑCDCÊñπÊ°àÂíåÊû∂ÊûÑÔºö 1. Flink CDC Flink CDC ÊòØÂü∫‰∫é Apache Flink ÁöÑ CDC ÊñπÊ°à„ÄÇÂÆÉÂèØ‰ª•ÂÆûÊó∂ÊçïËé∑Êï∞ÊçÆÂ∫ìÁöÑÂèòÊõ¥‰∫ã‰ª∂ÔºåÂπ∂Â∞ÜÂÖ∂ËΩ¨Êç¢ÊàêÊµÅÊï∞ÊçÆ„ÄÇFlink CDC Êèê‰æõ‰∫ÜÈùûÂ∏∏Â§öÁöÑËøûÊé•Âô®ÁªÑ‰ª∂ÔºåÂèØ‰ª•Âú®ÂºÇÊûÑÁöÑÊï∞ÊçÆÊ∫ê‰πãÈó¥ÂÆûÁé∞Êï∞ÊçÆÊµÅÂä®„ÄÇ Databend ‰πüÊèê‰æõ‰∫Ü flink-databend-connectorÔºåÂèØ‰ª•‰∏é MySQLÔºåPG Á≠â RDBMS ÊûÑÂª∫ÂÆûÊó∂Êï∞ÊçÆÂêåÊ≠•„ÄÇ 2. Kafka Connector Kafka Connector ÊòØÂü∫‰∫é Apache Kafka ÁöÑ CDC ÊñπÊ°à„ÄÇKafka ‰Ωú‰∏∫ÂàÜÂ∏ÉÂºèÊ∂àÊÅØÈòüÂàóÔºåÂèØ‰ª•Áî®‰∫éÊï∞ÊçÆ‰º†ÈÄíÂíåÂàÜÂèë„ÄÇKafka Connector ÂÖÅËÆ∏Â∞ÜÊï∞ÊçÆ‰ªéÊï∞ÊçÆÂ∫ì‰∏≠ÊçïËé∑ÔºåÂπ∂Â∞ÜÂÖ∂ÂèëÂ∏ÉÂà∞ Kafka ‰∏ªÈ¢ò‰∏≠Ôºå‰æõÂÖ∂‰ªñÁ≥ªÁªüÊ∂àË¥π„ÄÇ 3. Canal Canal ÊòØÈòøÈáåÂ∑¥Â∑¥ÂºÄÊ∫êÁöÑ CDC Ëß£ÂÜ≥ÊñπÊ°à„ÄÇÂÆÉÂèØ‰ª•ÊçïËé∑ MySQL Êï∞ÊçÆÂ∫ìÁöÑÂèòÊõ¥ÔºåÂπ∂Â∞ÜÂÖ∂ËΩ¨Êç¢ÊàêÊ∂àÊÅØÊ†ºÂºèËæìÂá∫ÔºåÂ∏∏Áî®‰∫éÊï∞ÊçÆÂêåÊ≠•Âíå‰∏öÂä°Ëß£ËÄ¶„ÄÇÈôêÂà∂ÊòØÂè™ËÉΩÂü∫‰∫é MySQL Êï∞ÊçÆÂ∫ìÂ¢ûÈáèÊó•ÂøóËß£Êûê„ÄÇ Debezium Server Debezium Server ÊòØ‰∏Ä‰∏™Âü∫‰∫é Debezium Engine ÁöÑ CDC È°πÁõÆ„ÄÇDebezium Engine ÊòØ Debezium È°πÁõÆÁöÑÊ†∏ÂøÉÔºåÁî®‰∫éÊçïËé∑Êï∞ÊçÆÂ∫ìÁöÑÂèòÊõ¥‰∫ã‰ª∂„ÄÇDebezium Server ÊûÑÂª∫Âú®ËØ•ÂºïÊìé‰πã‰∏äÔºåÊèê‰æõ‰∫Ü‰∏ÄÁßçËΩªÈáèÁ∫ßÁöÑ CDC Ëß£ÂÜ≥ÊñπÊ°àÔºåÁî®‰∫éÂÆûÊó∂ÊçïËé∑Êï∞ÊçÆÂ∫ìÊõ¥ÊîπÔºåÂπ∂Â∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫‰∫ã‰ª∂ÊµÅÔºåÊúÄÁªàÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•ÁõÆÊ†áÊï∞ÊçÆÂ∫ì„ÄÇ Debezium Server DatabendDebezium Server Databend ÊòØ‰∏Ä‰∏™Âü∫‰∫é Debezium Engine Ëá™Á†îÁöÑËΩªÈáèÁ∫ß CDC È°πÁõÆÔºåÁî®‰∫éÂÆûÊó∂ÊçïËé∑Êï∞ÊçÆÂ∫ìÊõ¥ÊîπÂπ∂Â∞ÜÂÖ∂‰Ωú‰∏∫‰∫ã‰ª∂ÊµÅ‰º†ÈÄíÊúÄÁªàÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•ÁõÆÊ†áÊï∞ÊçÆÂ∫ì Databend„ÄÇÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁßçÁÆÄÂçïÁöÑÊñπÂºèÊù•ÁõëËßÜÂíåÊçïËé∑ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁöÑÂèòÂåñÔºåÂπ∂ÊîØÊåÅÂ∞ÜËøô‰∫õÂèòÂåñËΩ¨Êç¢‰∏∫ÂèØÊ∂àË¥π‰∫ã‰ª∂„ÄÇ‰ΩøÁî® Debezium server databend ÂÆûÁé∞ CDC Êó†È°ª‰æùËµñÂ§ßÂûãÁöÑ Data Infra ÊØîÂ¶Ç Flink, Kafka, Spark Á≠âÔºåÂè™ÈúÄ‰∏Ä‰∏™ÂêØÂä®ËÑöÊú¨Âç≥ÂèØÂºÄÂêØÂÆûÊó∂Êï∞ÊçÆÂêåÊ≠•„ÄÇ Ê∫êÁ†ÅÂàÜÊûê debezium-server-databend ÂÆûÁé∞Debezium Server Databend ÂÆûÁé∞‰∫ÜËΩªÈáèÁ∫ßCDCÊñπÊ°àÔºåÈÄöËøá Debezium Engine ÊçïËé∑Êï∞ÊçÆÂ∫ìÂèòÊõ¥‰∫ã‰ª∂ÔºåÂ∞ÜÂÖ∂ËΩ¨Êç¢Êàê‰∫ã‰ª∂ÊµÅÔºåÁÑ∂ÂêéÂ∞Ü‰∫ã‰ª∂ÊµÅ‰º†ÈÄíÁªô Databend Êï∞ÊçÆÂ∫ìÔºåÂÆûÁé∞Êï∞ÊçÆÁöÑÂÆûÊó∂ÂêåÊ≠•„ÄÇ‰∏ãÈù¢ÂÖà‰ªé‰ª£Á†ÅÂ±ÇÈù¢ÂàÜÊûê‰∏Ä‰∏ãËØ•ÁªÑ‰ª∂ÁöÑÂÆûÁé∞ÂéüÁêÜ„ÄÇ ‰∏ªË¶Å‰ª£Á†ÅÁöÑÁªìÊûÑÊòØÔºö 1234567891011121314151617.‚îú‚îÄ‚îÄ DatabendChangeConsumer.java‚îú‚îÄ‚îÄ DatabendChangeEvent.java‚îú‚îÄ‚îÄ DatabendTypes.java‚îú‚îÄ‚îÄ DatabendUtil.java‚îú‚îÄ‚îÄ DebeziumMetrics.java‚îú‚îÄ‚îÄ batchsizewait‚îÇ ‚îú‚îÄ‚îÄ InterfaceBatchSizeWait.java‚îÇ ‚îú‚îÄ‚îÄ MaxBatchSizeWait.java‚îÇ ‚îî‚îÄ‚îÄ NoBatchSizeWait.java‚îî‚îÄ‚îÄ tablewriter ‚îú‚îÄ‚îÄ AppendTableWriter.java ‚îú‚îÄ‚îÄ BaseTableWriter.java ‚îú‚îÄ‚îÄ RelationalTable.java ‚îú‚îÄ‚îÄ TableNotFoundException.java ‚îú‚îÄ‚îÄ TableWriterFactory.java ‚îî‚îÄ‚îÄ UpsertTableWriter.java Debezium server ÁöÑÂÖ•Âè£ÈÄªËæëÂú® DatabendChangeConsumer ‰∏≠ÔºåÁªßÊâø BaseChangeConsumer Âπ∂ÂÆûÁé∞Áõ∏Â∫îÊñπÊ≥ïÔºå ‰ΩúÁî®ÊòØÂä†ËΩΩÈÖçÁΩÆÔºåÂàùÂßãÂåñ server, database‰ª•ÂèäÂ§ÑÁêÜ batch eventÔºö 12345678910111213141516/** * Implementation of the consumer that delivers the messages to databend database tables. * * @author hantmac */@Named("databend")@Dependentpublic class DatabendChangeConsumer extends BaseChangeConsumer implements DebeziumEngine.ChangeConsumer&lt;ChangeEvent&lt;Object, Object&gt;&gt; &#123; ...// @ConfigProperty(name = "debezium.sink.databend.xxx", defaultValue = "") void connect() throws Exception &#123; ... &#125; public void handleBatch(List&lt;ChangeEvent&lt;Object, Object&gt;&gt; records, DebeziumEngine.RecordCommitter&lt;ChangeEvent&lt;Object, Object&gt;&gt; committer) throws InterruptedException &#123;...&#125; &#125; Ê†∏ÂøÉ‰ª£Á†ÅÊòØÂú® handleBatch ‰∏≠ÔºåÂú®ËøôÈáåÊé•Êî∂ÂèòÊõ¥‰∫ã‰ª∂Âπ∂ÂèëÈÄÅÂà∞ tablewriter ‰∏≠Ëøõ‰∏ÄÊ≠•Â§ÑÁêÜ„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637@Override public void handleBatch(List&lt;ChangeEvent&lt;Object, Object&gt;&gt; records, DebeziumEngine.RecordCommitter&lt;ChangeEvent&lt;Object, Object&gt;&gt; committer) throws InterruptedException &#123; Instant start = Instant.now(); //group events by destination Map&lt;String, List&lt;DatabendChangeEvent&gt;&gt; result = records.stream() .map((ChangeEvent&lt;Object, Object&gt; e) -&gt; &#123; try &#123; return new DatabendChangeEvent(e.destination(), valDeserializer.deserialize(e.destination(), getBytes(e.value())), e.key() == null ? null : valDeserializer.deserialize(e.destination(), getBytes(e.key())), mapper.readTree(getBytes(e.value())).get("schema"), e.key() == null ? null : mapper.readTree(getBytes(e.key())).get("schema") ); &#125; catch (IOException ex) &#123; throw new DebeziumException(ex); &#125; &#125;) .collect(Collectors.groupingBy(DatabendChangeEvent::destination)); // consume list of events for each destination table for (Map.Entry&lt;String, List&lt;DatabendChangeEvent&gt;&gt; tableEvents : result.entrySet()) &#123; RelationalTable tbl = this.getDatabendTable(mapDestination(tableEvents.getKey()), tableEvents.getValue().get(0).schema()); // Ëé∑Âèñ tablewriter ÂÆû‰æã tableWriter.addToTable(tbl, tableEvents.getValue()); // Â∞Ü‰∫ã‰ª∂Êé®ÈÄÅËá≥ tablewriter &#125; for (ChangeEvent&lt;Object, Object&gt; record : records) &#123; LOGGER.trace("Processed event '&#123;&#125;'", record); committer.markProcessed(record); &#125; committer.markBatchFinished(); this.logConsumerProgress(records.size()); batchSizeWait.waitMs(records.size(), (int) Duration.between(start, Instant.now()).toMillis()); TableWriterFactory‰∏≠Êèê‰æõ‰∫Ü Append Âíå Upsert ‰∏§ÁßçÊ®°ÂºèÔºö 1234567public BaseTableWriter get(final Connection connection) &#123; if (upsert) &#123; return new UpsertTableWriter(connection, identifierQuoteCharacter.orElse(""), upsertKeepDeletes); &#125; else &#123; return new AppendTableWriter(connection, identifierQuoteCharacter.orElse("")); &#125;&#125; ÊØèÁßçÊ®°ÂºèÈÉΩÂÆûÁé∞‰∫Ü addTable ÊñπÊ≥ï„ÄÇ Append modeÂú® CDC ‰∏≠ÔºåAppend Mode ÊòØ‰∏ÄÁßçÊï∞ÊçÆÂÜôÂÖ•Ê®°Âºè„ÄÇÂΩìÊï∞ÊçÆÂ∫ìÁöÑ‰∏ÄÊù°ËÆ∞ÂΩïÂèëÁîüÂèòÂåñÊó∂ÔºåCDC ‰ºöÂ∞ÜËØ•ÂèòÂåñ‰Ωú‰∏∫‰∏ÄÊù°Êñ∞ÁöÑ‰∫ã‰ª∂ËøΩÂä†Âà∞‰∫ã‰ª∂ÊµÅ‰∏≠„ÄÇ Upsert modeUpsert Mode ÊòØÂè¶‰∏ÄÁßçÊï∞ÊçÆÂÜôÂÖ•Ê®°Âºè„ÄÇÂΩìÊï∞ÊçÆÂ∫ìÁöÑ‰∏ÄÊù°ËÆ∞ÂΩïÂèëÁîüÂèòÂåñÊó∂ÔºåCDC ‰ºöÂ∞ÜËØ•ÂèòÂåñ‰Ωú‰∏∫‰∏Ä‰∏™Êõ¥Êñ∞Êìç‰ΩúÔºåÂ¶ÇÊûúËÆ∞ÂΩï‰∏çÂ≠òÂú®ÔºåÂàô‰Ωú‰∏∫ÊèíÂÖ•Êìç‰ΩúÔºå‰ª•ÂÆûÁé∞Êï∞ÊçÆÁöÑÊõ¥Êñ∞ÂíåÊèíÂÖ•„ÄÇ Upsert mode Áî®Âà∞‰∫Ü Databend ÁöÑ Replace into ËØ≠Ê≥ïÔºåÊâÄ‰ª•ÈúÄË¶ÅÁî®Êà∑ÊåáÂÆö‰∏Ä‰∏™ conflict keyÔºåËøôÈáåÊàë‰ª¨Êèê‰æõ‰∏Ä‰∏™ÈÖçÁΩÆÔºö 1debezium.sink.databend.database.primaryKey=id Â¶ÇÊûúÊ≤°ÊúâÊèê‰æõËØ•ÈÖçÁΩÆÔºå‰ºöÈÄÄÂåñÊàêËøΩÂä†Ê®°Âºè„ÄÇ DeleteDeleteÊìç‰ΩúÊòØÊåáÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑËÆ∞ÂΩïË¢´Âà†Èô§ÔºåCDC ‰ºöÂ∞ÜËØ•Êìç‰Ωú‰Ωú‰∏∫‰∏Ä‰∏™‰∫ã‰ª∂ÂÜôÂÖ•‰∫ã‰ª∂ÊµÅÔºå‰ª•ÈÄöÁü•ÂÖ∂‰ªñÁ≥ªÁªüËØ•ËÆ∞ÂΩïÂ∑≤Ë¢´Âà†Èô§„ÄÇ Debezim Server ÂØπ Delete ÁöÑÂ§ÑÁêÜÊØîËæÉÂ§çÊùÇÔºåÂú® DELETE Êìç‰Ωú‰∏ã‰ºöÁîüÊàê‰∏§Êù°‰∫ã‰ª∂ËÆ∞ÂΩïÔºö ‰∏Ä‰∏™ÂåÖÂê´ ‚Äúop‚Äù: ‚Äúd‚ÄùÔºåÂÖ∂‰ªñÁöÑË°åÊï∞ÊçÆ‰ª•ÂèäÂ≠óÊÆµÔºõ ‰∏Ä‰∏™tombstonesËÆ∞ÂΩïÔºåÂÆÉÂÖ∑Êúâ‰∏éË¢´Âà†Èô§Ë°åÁõ∏ÂêåÁöÑÈîÆÔºå‰ΩÜÂÄº‰∏∫null„ÄÇ Ëøô‰∏§Êù°‰∫ã‰ª∂‰ºöÂêåÊó∂ÂèëÂá∫ÔºåÂú® Debezium Server Databend ‰∏≠Êàë‰ª¨ÈÄâÊã©ÂØπ Delete Êï∞ÊçÆÂÆûË°åËΩØÂà†Èô§ÔºåËøôÂ∞±Ë¶ÅÊ±ÇÊàë‰ª¨Âú® target table ‰∏≠Êã•Êúâ __deleted Â≠óÊÆµÔºåÂΩì Delete ‰∫ã‰ª∂ËøáÊù•ÁöÑÊó∂ÂÄôÊàë‰ª¨Â∞ÜËØ•Â≠óÊÆµÁΩÆ‰∏∫ TRUE ÂêéÊèíÂÖ•Âà∞ÁõÆÊ†áË°®„ÄÇ ËøôÊ†∑ËÆæËÆ°ÁöÑÂ•ΩÂ§ÑÊòØÔºåÊúâ‰∫õÁî®Êà∑ÊúÄÂºÄÂßãÊÉ≥Ë¶Å‰øùÁïôËøô‰∫õÊï∞ÊçÆÔºå‰ΩÜÂèØËÉΩÊú™Êù•‰ºöÊÉ≥Âà∞Â∞ÜÂÖ∂Âà†Èô§ÔºåËøôÊ†∑Â∞±‰∏∫Áî®Êà∑Êèê‰æõ‰∫ÜÂèØÈÄâÁöÑÊñπÊ°àÔºåÊú™Êù•ÊÉ≥Ë¶ÅÂà†Èô§Ëøô‰∫õÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºåÂè™ÈúÄË¶Å delete from table where __deleted=true Âç≥ÂèØ„ÄÇ ÂÖ≥‰∫é Debezium ÂØπÂà†Èô§‰∫ã‰ª∂ÁöÑËØ¥Êòé‰ª•ÂèäÂ§ÑÁêÜÊñπÂºèÔºåËØ¶ÊÉÖÂèØÂèÇËÄÉÊñáÊ°£„ÄÇ ‰ΩøÁî®ËΩªÈáèÁ∫ß CDC debezium-server-databend ÊûÑÂª∫ MySQL Âà∞ Databend ÁöÑ ÂÆûÊó∂Êï∞ÊçÆÂêåÊ≠•‰∏ãÈù¢Áî®‰∏Ä‰∏™ÂÆûÈôÖÊ°à‰æãÂ±ïÁ§∫Â¶Ç‰ΩïÂü∫‰∫é Debezium server databend Âø´ÈÄüÊûÑÂª∫ MySQL Âà∞ Databend ÁöÑÂÆûÊó∂Êï∞ÊçÆÂêåÊ≠•„ÄÇ ÂáÜÂ§áÈò∂ÊÆµÂáÜÂ§á‰∏ÄÂè∞Â∑≤ÁªèÂÆâË£Ö‰∫Ü Docker Ôºådocker-compose ‰ª•Âèä Java 11 ÁéØÂ¢É ÁöÑ Linux ÊàñËÄÖ MacOS „ÄÇ ÂáÜÂ§áÊïôÁ®ãÊâÄÈúÄË¶ÅÁöÑÁªÑ‰ª∂Êé•‰∏ãÊù•ÁöÑÊïôÁ®ãÂ∞Ü‰ª• docker-compose ÁöÑÊñπÂºèÂáÜÂ§áÊâÄÈúÄË¶ÅÁöÑÁªÑ‰ª∂„ÄÇ debezium-MySQLdocker-compose.yaml 123456789101112131415161718version: '2.1'services: postgres: image: debezium/example-postgres:1.1 ports: - "5432:5432" environment: - POSTGRES_DB=postgres - POSTGRES_USER=postgres - POSTGRES_PASSWORD=postgres mysql: image: debezium/example-mysql:1.1 ports: - "3306:3306" environment: - MYSQL_ROOT_PASSWORD=123456 - MYSQL_USER=mysqluser - MYSQL_PASSWORD=mysqlpw Debezium Server Databend Clone È°πÁõÆ: git clone `https://github.com/databendcloud/debezium-server-databend.git` ‰ªéÈ°πÁõÆÊ†πÁõÆÂΩïÂºÄÂßã: ÊûÑÂª∫ÂíåÊâìÂåÖ debezium server: mvn -Passembly -Dmaven.test.skip package ÊûÑÂª∫ÂÆåÊàêÂêéÔºåËß£ÂéãÊúçÂä°Âô®ÂàÜÂèëÂåÖ: unzip debezium-server-databend-dist/target/debezium-server-databend-dist*.zip -d databendDist ËøõÂÖ•Ëß£ÂéãÂêéÁöÑÊñá‰ª∂Â§π: cd databendDist ÂàõÂª∫ application.properties Êñá‰ª∂Âπ∂‰øÆÊîπ: nano conf/application.propertiesÔºåÂ∞Ü‰∏ãÈù¢ÁöÑ application.properties Êã∑Ë¥ùËøõÂéªÔºåÊ†πÊçÆÁî®Êà∑ÂÆûÈôÖÊÉÖÂÜµ‰øÆÊîπÁõ∏Â∫îÁöÑÈÖçÁΩÆ„ÄÇ ‰ΩøÁî®Êèê‰æõÁöÑËÑöÊú¨ËøêË°åÊúçÂä°: bash run.sh Debezium Server with Databend Â∞Ü‰ºöÂêØÂä® ÂêåÊó∂Êàë‰ª¨‰πüÊèê‰æõ‰∫ÜÁõ∏Â∫îÁöÑ Docker imageÔºåÂèØ‰ª•Âú®ÂÆπÂô®‰∏≠‰∏ÄÈîÆÂêØÂä®Ôºö 12345678910version: '2.1'services: debezium: image: ghcr.io/databendcloud/debezium-server-databend:pr-2 ports: - "8080:8080" - "8083:8083" volumes: - $PWD/conf:/app/conf - $PWD/data:/app/data NOTE: Âú®ÂÆπÂô®‰∏≠ÂêØÂä®Ê≥®ÊÑèÊâÄËøûÊé•Êï∞ÊçÆÂ∫ìÁöÑÁΩëÁªú„ÄÇ Debezium Server Databend Application PropertiesÊú¨ÊñáÁ´†‰ΩøÁî®‰∏ãÈù¢Êèê‰æõÁöÑÈÖçÁΩÆÔºåÊõ¥Â§öÁöÑÂèÇÊï∞ËØ¥Êòé‰ª•ÂèäÈÖçÁΩÆÂèØ‰ª•ÂèÇËÄÉÊñáÊ°£„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344debezium.sink.type=databenddebezium.sink.databend.upsert=truedebezium.sink.databend.upsert-keep-deletes=falsedebezium.sink.databend.database.databaseName=debeziumdebezium.sink.databend.database.url=jdbc:databend://tnf34b0rm--xxxxxx.default.databend.cn:443debezium.sink.databend.database.username=cloudappdebezium.sink.databend.database.password=passworddebezium.sink.databend.database.primaryKey=iddebezium.sink.databend.database.tableName=productsdebezium.sink.databend.database.param.ssl=true# enable event schemasdebezium.format.value.schemas.enable=truedebezium.format.key.schemas.enable=truedebezium.format.value=jsondebezium.format.key=json# mysql sourcedebezium.source.connector.class=io.debezium.connector.mysql.MySqlConnectordebezium.source.offset.storage.file.filename=data/offsets.datdebezium.source.offset.flush.interval.ms=60000debezium.source.database.hostname=127.0.0.1debezium.source.database.port=3306debezium.source.database.user=rootdebezium.source.database.password=123456debezium.source.database.dbname=mydbdebezium.source.database.server.name=from_mysqldebezium.source.include.schema.changes=falsedebezium.source.table.include.list=mydb.products# debezium.source.database.ssl.mode=required# Run without Kafka, use local file to store checkpointsdebezium.source.database.history=io.debezium.relational.history.FileDatabaseHistorydebezium.source.database.history.file.filename=data/status.dat# do event flattening. unwrap message!debezium.transforms=unwrapdebezium.transforms.unwrap.type=io.debezium.transforms.ExtractNewRecordStatedebezium.transforms.unwrap.delete.handling.mode=rewritedebezium.transforms.unwrap.drop.tombstones=true# ############ SET LOG LEVELS ############quarkus.log.level=INFO# Ignore messages below warning level from Jetty, because it's a bit verbosequarkus.log.category."org.eclipse.jetty".level=WARN ÂáÜÂ§áÊï∞ÊçÆÂú® MySQL Êï∞ÊçÆÂ∫ì‰∏≠ÂáÜÂ§áÊï∞ÊçÆËøõÂÖ• MySQL ÂÆπÂô® 1docker-compose exec mysql mysql -uroot -p123456 ÂàõÂª∫Êï∞ÊçÆÂ∫ì mydb ÂíåË°® productsÔºåÂπ∂ÊèíÂÖ•Êï∞ÊçÆ: 12345678910111213141516CREATE DATABASE mydb;USE mydb;CREATE TABLE products (id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,name VARCHAR(255) NOT NULL,description VARCHAR(512));ALTER TABLE products AUTO_INCREMENT = 10;INSERT INTO products VALUES (default,"scooter","Small 2-wheel scooter"),(default,"car battery","12V car battery"),(default,"12-pack drill bits","12-pack of drill bits with sizes ranging from #40 to #3"),(default,"hammer","12oz carpenter's hammer"),(default,"hammer","14oz carpenter's hammer"),(default,"hammer","16oz carpenter's hammer"),(default,"rocks","box of assorted rocks"),(default,"jacket","water resistent black wind breaker"),(default,"cloud","test for databend"),(default,"spare tire","24 inch spare tire"); Âú® Databend ‰∏≠ÂàõÂª∫ Database NOTE: Áî®Êà∑ÂèØ‰ª•‰∏çÂøÖÂÖàÂú® Databend ‰∏≠ÂàõÂª∫Ë°®ÔºåÁ≥ªÁªüÊ£ÄÊµãÂà∞Âêé‰ºöËá™Âä®‰∏∫Áî®Êà∑Âª∫Ë°®„ÄÇ ÂêØÂä® Debezium Server Databend1bash run.sh È¶ñÊ¨°ÂêØÂä®‰ºöËøõÂÖ• init snapshot Ê®°ÂºèÔºåÈÄöËøáÈÖçÁΩÆÁöÑ Batch Size ÂÖ®ÈáèÂ∞Ü MySQL ‰∏≠ÁöÑÊï∞ÊçÆÂêåÊ≠•Âà∞ DatabendÔºåÊâÄ‰ª•Âú® Databend ‰∏≠ÂèØ‰ª•ÁúãÂà∞ MySQL ‰∏≠ÁöÑÊï∞ÊçÆÂ∑≤ÁªèÂêåÊ≠•ËøáÊù•‰∫ÜÔºö ÂêåÊ≠• Insert Êï∞ÊçÆÊàë‰ª¨ÁªßÁª≠ÂæÄ MySQL ‰∏≠ÊèíÂÖ• 5 Êù°Êï∞ÊçÆÔºö 12345INSERT INTO products VALUES (default,"scooter","Small 2-wheel scooter"),(default,"car battery","12V car battery"),(default,"12-pack drill bits","12-pack of drill bits with sizes ranging from #40 to #3"),(default,"hammer","12oz carpenter's hammer"),(default,"hammer","14oz carpenter's hammer"); Debezium server databend Êó•ÂøóÔºö ÂêåÊó∂Âú® Databend ‰∏≠ÂèØ‰ª•Êü•Âà∞ 5 Êù°Êï∞ÊçÆÂ∑≤ÁªèÂêåÊ≠•ËøáÊù•‰∫ÜÔºö ÂêåÊ≠• Update Êï∞ÊçÆÈÖçÁΩÆÊñá‰ª∂‰∏≠ debezium.sink.databend.upsert=true ÔºåÊâÄ‰ª•Êàë‰ª¨‰πüÂèØ‰ª•Â§ÑÁêÜ Update/Delete ÁöÑ‰∫ã‰ª∂„ÄÇ Âú® MySQL ‰∏≠Êõ¥Êñ∞ id=10 ÁöÑÊï∞ÊçÆÔºö 1update products set name="from debezium" where id=10; Âú® Databend ‰∏≠ÂèØ‰ª•Êü•Âà∞ id ‰∏∫ 10 ÁöÑÊï∞ÊçÆÂ∑≤ÁªèË¢´Êõ¥Êñ∞Ôºö ÂêåÊ≠• Delete Êï∞ÊçÆÂú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÔºåÊúâ‰ª•‰∏ãÁöÑÈÖçÁΩÆÔºåÊó¢ÂèØÂºÄÂêØÂ§ÑÁêÜ Delete ‰∫ã‰ª∂ÁöÑËÉΩÂäõÔºö 12345debezium.sink.databend.upsert-keep-deletes=falsedebezium.transforms=unwrapdebezium.transforms.unwrap.type=io.debezium.transforms.ExtractNewRecordStatedebezium.transforms.unwrap.delete.handling.mode=rewritedebezium.transforms.unwrap.drop.tombstones=true Âú® MySQL ‰∏≠Âà†Èô§ id=12 ÁöÑÊï∞ÊçÆÔºö 1delete from products where id=12; Âú® Databend ‰∏≠ÂèØ‰ª•ËßÇÂØüÂà∞ id=12 ÁöÑÂÄºÁöÑ __deleted Â≠óÊÆµÂ∑≤ÁªèË¢´ÁΩÆ‰∏∫ true„ÄÇ ÁéØÂ¢ÉÊ∏ÖÁêÜÊìç‰ΩúÁªìÊùüÂêéÔºåÂú® docker-compose.yml Êñá‰ª∂ÊâÄÂú®ÁöÑÁõÆÂΩï‰∏ãÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÂÅúÊ≠¢ÊâÄÊúâÂÆπÂô®Ôºö 1docker-compose down ÁªìËÆ∫ÊñáÁ´†‰ªãÁªç‰∫Ü databend ÁöÑËΩªÈáèÁ∫ß CDC ÂÆûÁé∞ÂéüÁêÜÔºåÊºîÁ§∫‰∫ÜÂü∫‰∫éËΩªÈáèÁ∫ß CDC debezium server databend ÊûÑÂª∫ MySQL Âà∞ Databend ÁöÑ ÂÆûÊó∂Êï∞ÊçÆÂêåÊ≠•ÁöÑÂÖ®ÈÉ®ËøáÁ®ãÔºåËøôÁßçÊñπÂºè‰∏çÈúÄË¶Å‰æùËµñ Flink, Kafka Á≠âÂ§ßÂûãÁªÑ‰ª∂ÔºåÂêØÂä®ÂíåÁÆ°ÁêÜÈùûÂ∏∏Êñπ‰æø„ÄÇ]]></content>
      <categories>
        <category>CDC</category>
      </categories>
      <tags>
        <tag>CDC</tag>
        <tag>Database</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∏∫ Databend Rust Driver ÂÆûÁé∞ Python Binding]]></title>
    <url>%2F2023%2F05%2F27%2F%E4%B8%BA-Databend-Rust-Driver-%E5%AE%9E%E7%8E%B0-Python-Binding%2F</url>
    <content type="text"><![CDATA[HOW? PyO3 + MaturinRust Âíå Python ÈÉΩÊã•Êúâ‰∏∞ÂØåÁöÑÂåÖÂíåÂ∫ì„ÄÇÂú® Python ‰∏≠ÔºåÂæàÂ§öÂåÖÁöÑÂ∫ïÂ±ÇÊòØ‰ΩøÁî® C/C++ ÁºñÂÜôÁöÑÔºåËÄå Rust Â§©Áîü‰∏é C ÂÖºÂÆπ„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® Rust ‰∏∫ Python ÁºñÂÜôËΩØ‰ª∂ÂåÖÔºåÂÆûÁé∞ Python Ë∞ÉÁî® Rust ÁöÑÂäüËÉΩÔºå‰ªéËÄåËé∑ÂæóÊõ¥Â•ΩÁöÑÊÄßËÉΩÂíåÈÄüÂ∫¶„ÄÇ ‰∏∫‰∫ÜÂÆûÁé∞Ëøô‰∏ÄÁõÆÊ†áÔºåPyO3 Â∫îËøêËÄåÁîü„ÄÇPyO3 ‰∏ç‰ªÖÊèê‰æõ‰∫Ü Rust ‰∏é Python ÁöÑÁªëÂÆöÂäüËÉΩÔºåËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ maturin ÁöÑÂºÄÁÆ±Âç≥Áî®ÁöÑËÑöÊâãÊû∂Â∑•ÂÖ∑„ÄÇÈÄöËøá maturinÔºåÊàë‰ª¨ÂèØ‰ª•Êñπ‰æøÂú∞ÂàõÂª∫Âü∫‰∫é Rust ÂºÄÂèëÁöÑ Python Êâ©Â±ïÊ®°Âùó„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÊàë‰ª¨ÂèØ‰ª•ÈáçÊñ∞ÁªÑÁªá‰ª£Á†ÅÔºå‰ΩøÁî® Rust ÁºñÂÜôÊÄßËÉΩÊõ¥Â•ΩÁöÑÈÉ®ÂàÜÔºåËÄåÂÖ∂‰ΩôÈÉ®ÂàÜ‰ªçÁÑ∂ÂèØ‰ª•‰ΩøÁî®ÂéüÂßãÁöÑ Python ‰ª£Á†Å„ÄÇ Databend ÁõÆÂâçÊúâÈíàÂØπ Rust„ÄÅGo„ÄÅPython„ÄÅJava ÁöÑÂ§öÂ•ó Driver SDKÔºåÁª¥Êä§ÊàêÊú¨È¢áÈ´òÔºå‰∏äÊ∏∏‰∏ÄÊó¶Âá∫Áé∞Êõ¥Êñ∞ SDK ‰æø‰ºöÊâãÂøôËÑö‰π±„ÄÇ Rust ËÉΩÊèê‰æõÂØπÂÖ∂‰ªñËØ≠Ë®ÄÁöÑ Binding ÂÆûÁé∞‰∏ÄÂ•ó‰ª£Á†ÅÂà∞Â§Ñ‰ΩøÁî®ÔºåËÄå‰∏îÂèàËÉΩËé∑ÂæóÊõ¥Â•ΩÂú∞ÊÄßËÉΩÂíåÈÄüÂ∫¶Ôºå‰Ωï‰πêËÄå‰∏ç‰∏∫Âë¢Ôºü Êú¨ÁØáÊñáÁ´†Êàë‰ª¨ÂÖ≥Ê≥®Â¶Ç‰ΩïÂú® python ‰∏≠Ë∞ÉÁî® Rust ÂºÄÂèëÁöÑÊ®°ÂùóÔºå‰ª•Ê≠§Êù•‰∏∫ Databend Rust Driver ÂÆûÁé∞ Python Binding„ÄÇ ÁÆÄÂçïÁöÑ DemoËøôÈáåÊàë‰ª¨‰ª•ÂÆòÁΩëÊèê‰æõÁöÑÊúÄÁÆÄÂçïÁöÑÊñπÂºèÊù•ÂÅö‰∏™ÊºîÁ§∫„ÄÇ 1234567891011$ mkdir string_sum$ cd string_sum# ÂàõÂª∫ venv ÁöÑËøô‰∏ÄÊ≠•‰∏çËÉΩÁúÅÁï•ÔºåÂê¶ÂàôÂêéÁª≠ËøêË°åÁöÑÊó∂ÂÄô‰ºöÊä•Èîô$ python -m venv .env$ source .env/bin/activate$ pip install maturin# Áõ¥Êé•‰ΩøÁî® maturin ÂàùÂßãÂåñÈ°πÁõÆÂç≥ÂèØÔºåÈÄâÊã© pyo3ÔºåÊàñËÄÖÁõ¥Êé•ÊâßË°å maturin init --bindings pyo3‚ùØ maturin init‚úî ü§∑ Which kind of bindings to use? üìñ Documentation: https://maturin.rs/bindings.html ¬∑ pyo3 ‚ú® Done! Initialized project /Users/hanshanjie/rustProj/string_sum Ëøô‰∏™Êó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™ÁÆÄÂçïÁöÑ Rust È°πÁõÆÔºåÂπ∂‰∏îÂåÖÂê´‰∫ÜË∞ÉÁî®ÁöÑÁ§∫‰æãÔºåÊâìÂºÄ src/lib.rsÔºö 1234567891011121314use pyo3::prelude::*;/// Formats the sum of two numbers as string.#[pyfunction]fn sum_as_string(a: usize, b: usize) -&gt; PyResult&lt;String&gt; &#123; Ok((a + b).to_string())&#125;/// A Python module implemented in Rust.#[pymodule]fn string_sum(_py: Python, m: &amp;PyModule) -&gt; PyResult&lt;()&gt; &#123; m.add_function(wrap_pyfunction!(sum_as_string, m)?)?; Ok(())&#125; ÂèØ‰ª•ÁúãÂà∞ pyfunction Âíå pymodule ‰∏§‰∏™ Rust ÁöÑÂÆèÔºå#[pymodule] ËøáÁ®ãÂÆèÂ±ûÊÄßË¥üË¥£Â∞ÜÊ®°ÂùóÁöÑÂàùÂßãÂåñÂáΩÊï∞ÂØºÂá∫Âà∞Python„ÄÇÂÆÉÂèØ‰ª•Êé•ÂèóÊ®°ÂùóÁöÑÂêçÁß∞‰Ωú‰∏∫ÂèÇÊï∞ÔºåËØ•ÂêçÁß∞ÂøÖÈ°ªÊòØ.soÊàñ.pydÊñá‰ª∂ÁöÑÂêçÁß∞ÔºõÈªòËÆ§ÂÄº‰∏∫RustÂáΩÊï∞ÁöÑÂêçÁß∞„ÄÇ#[pyfunction] Ê≥®Èáä‰∏Ä‰∏™ÂáΩÊï∞ÔºåÁÑ∂Âêé‰ΩøÁî® wrap_pyfunction ÂÆèÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞ÂàöÂàöÂÆö‰πâÁöÑÊ®°Âùó‰∏≠„ÄÇ Êàë‰ª¨Êó†ÈúÄ‰øÆÊîπ‰ªª‰Ωï‰ª£Á†ÅÔºåÂèØ‰ª•Áõ¥Êé•ÊâßË°å‰∏ãÈù¢ÁöÑÂëΩ‰ª§ÊµãËØïÔºö 123456# maturin develop ‰ºöËá™Âä®ÊâìÂåÖÂá∫‰∏Ä‰∏™ wheel ÂåÖÔºåÂπ∂‰∏îÂÆâË£ÖÂà∞ÂΩìÂâçÁöÑ venv ‰∏≠ $ maturin develop$ python&gt;&gt;&gt; import string_sum&gt;&gt;&gt; string_sum.sum_as_string(5, 20)'25' ÊûÑÂª∫ Databend Driver ÁöÑ Python BindingÂàùÂßãÂåñÈ°πÁõÆÂú® bendsql Ê†πÁõÆÂΩï‰∏ãÂàõÂª∫ bindings/pythonÁöÑ rust È°πÁõÆÔºö 12345678$ cd bendsql $ mkdir bindings &amp; cd bindings$ mkdir python &amp; cd python$ python -m venv .env$ source .env/bin/activate$ pip install maturin# Áõ¥Êé•‰ΩøÁî® maturin ÂàùÂßãÂåñÈ°πÁõÆÂç≥ÂèØÔºåÈÄâÊã© pyo3‚ùØ maturin init ‰∏∫‰∫Ü‰ΩøÁî®PyO3ÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÖ∂‰Ωú‰∏∫‰æùËµñÈ°πÊ∑ªÂä†Âà∞Êàë‰ª¨ÁöÑCargo.tomlÊñá‰ª∂‰∏≠Ôºå‰ª•ÂèäÂÖ∂‰ªñ‰æùËµñÈ°π„ÄÇÊàë‰ª¨ÁöÑCargo.tomlÊñá‰ª∂Â∫îËØ•Â¶Ç‰∏ãÊâÄÁ§∫Ôºö 12345678910111213141516171819[package]name = "databend-python"version = "0.0.1"edition = "2021"license = "Apache-2.0"publish = false[lib]crate-type = ["cdylib"]doc = false[dependencies]chrono = &#123; version = "0.4.24", default-features = false, features = ["std"] &#125;futures = "0.3.28"databend-driver = &#123; path = "../../driver", version = "0.2.20", features = ["rustls", "flight-sql"] &#125;databend-client = &#123; version = "0.1.15", path = "../../core" &#125;pyo3 = &#123; version = "0.18", features = ["abi3-py37"] &#125;pyo3-asyncio = &#123; version = "0.18", features = ["tokio-runtime"] &#125;tokio = "1" PyO3 Ê∑ªÂä†‰∏∫‰æùËµñÈ°πÔºåÂπ∂‰ΩøÁî®ÈÄÇÂΩìÁöÑÂ±ûÊÄßÊ≥®Ëß£ Rust ÂáΩÊï∞ÔºàÊàë‰ª¨Â∞ÜÂú®ÂêéÈù¢‰ªãÁªçÔºâÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî® PyO3 Â∫ìÂàõÂª∫‰∏Ä‰∏™ÂèØ‰ª•Ë¢´ÂØºÂÖ•Âà∞ Python ËÑöÊú¨‰∏≠ÁöÑ Python Êâ©Â±ïÊ®°Âùó„ÄÇ Â∞Ü Rust Struct ËΩ¨Êç¢Êàê Python Ê®°Âùódatabend-client ‰∏≠Êèê‰æõ‰∫Ü‰∏§ÁßçËøûÊé•Âà∞ databend ÁöÑÊñπÂºèÔºåflightSQL Âíå httpÔºå databend-driver package ÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ TraitÊù•Áªü‰∏ÄÂÖ•Âè£Âπ∂Ëá™Âä®Ëß£ÊûêÂçèËÆÆÔºö bendsql/driver/src/conn.rs 12345678910111213141516171819202122232425262728293031#[async_trait]pub trait Connection: DynClone + Send + Sync &#123; fn info(&amp;self) -&gt; ConnectionInfo; async fn version(&amp;self) -&gt; Result&lt;String&gt; &#123; let row = self.query_row("SELECT version()").await?; let version = match row &#123; Some(row) =&gt; &#123; let (version,): (String,) = row.try_into()?; version &#125; None =&gt; "".to_string(), &#125;; Ok(version) &#125; async fn exec(&amp;self, sql: &amp;str) -&gt; Result&lt;i64&gt;; async fn query_row(&amp;self, sql: &amp;str) -&gt; Result&lt;Option&lt;Row&gt;&gt;; async fn query_iter(&amp;self, sql: &amp;str) -&gt; Result&lt;RowIterator&gt;; async fn query_iter_ext(&amp;self, sql: &amp;str) -&gt; Result&lt;(Schema, RowProgressIterator)&gt;; async fn stream_load( &amp;self, sql: &amp;str, data: Reader, size: u64, file_format_options: Option&lt;BTreeMap&lt;&amp;str, &amp;str&gt;&gt;, copy_options: Option&lt;BTreeMap&lt;&amp;str, &amp;str&gt;&gt;, ) -&gt; Result&lt;QueryProgress&gt;;&#125;dyn_clone::clone_trait_object!(Connection); ÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË¶ÅÂ∞ÜËØ• Trait ËΩ¨Êç¢Êàê Python class ÔºåÂ∞±ËÉΩÂú® python ‰∏≠Ë∞ÉÁî®Ëøô‰∫õÊñπÊ≥ï„ÄÇPyo3 ÂÆòÁΩë‰∏≠Êèê‰æõ‰∫ÜËΩ¨Êç¢ Trait ÁöÑÊñπÂºèÔºåhttps://pyo3.rs/v0.12.3/trait_boundsÔºå‰ΩÜÊòØËøôÁßçÊñπÂºèËøá‰∫éÂ§çÊùÇÔºåÈúÄË¶ÅÂÜôÂ§™Â§öÁöÑËÉ∂Ê∞¥‰ª£Á†ÅÔºåËÄå‰∏îÂØπÁî®Êà∑‰πü‰∏çÂèãÂ•ΩÔºå‰∏çËÉΩÂÅöÂà∞ÂºÄÁÆ±Âç≥Áî®„ÄÇÂ∑¶ÊÄùÂè≥ÊÉ≥Ôºå‰∏∫‰Ωï‰∏çÂ∞Ü Trait Â∞ÅË£Ö‰∏Ä‰∏™ Struct ÁÑ∂ÂêéÂ∞Ü Struct Áõ¥Êé•Â∞ÜËΩ¨Êç¢Êàê python module Ôºü 1234567891011121314151617#[derive(Clone)]pub struct Connector &#123; pub connector: FusedConnector,&#125;pub type FusedConnector = Arc&lt;dyn Connection&gt;;// For bindingsimpl Connector &#123; pub fn new_connector(dsn: &amp;str) -&gt; Result&lt;Box&lt;Self&gt;, Error&gt; &#123; let conn = new_connection(dsn).unwrap(); let r = Self &#123; connector: FusedConnector::from(conn), &#125;; Ok(Box::new(r)) &#125;&#125; ËøôÈáåÂÜô‰∫Ü‰∏Ä‰∏™ Connector ÁöÑ structÔºåÈáåÈù¢Â∞ÅË£Ö‰∫Ü Connection TraitÔºå‰∏∫ Connector ÂÆûÁé∞‰∫Ü new_connector ÊñπÊ≥ïÔºåËøîÂõûÁöÑÊ≠£ÊòØ‰∏Ä‰∏™ÊåáÂêë Connector ÁöÑÊåáÈíàÔºåÊõ¥Â§ö‰ª£Á†ÅÂèØ‰ª•ÁúãËøôÈáå „ÄÇ Âú® asyncio.rs ‰∏≠Êàë‰ª¨Â∞±ÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™ Struct AsyncDatabendDriver Êö¥Èú≤‰∏∫ python classÔºåÂπ∂ÂÆö‰πâ python module ‰∏∫ databend-driver: 123/// `AsyncDatabendDriver` is the entry for all public async API#[pyclass(module = "databend_driver")]pub struct AsyncDatabendDriver(Connector); Êé•‰∏ãÊù•Â∞±Ë¶Å‰∏∫ AsyncDatabendDriver ÂÆûÁé∞Áõ∏Â∫îÁöÑÊñπÊ≥ïÔºåËÄåÂ∫ïÂ±ÇË∞ÉÁî®ÁöÑÂ∞±ÊòØ rust ‰∏≠ÂÆûÁé∞ÁöÑ Trait ‰∏≠ÁöÑÊñπÊ≥ïÔºàËøôÈáå‰ª• exec ‰∏∫‰æãÔºâÔºö 123456789101112131415161718#[pymethods]impl AsyncDatabendDriver &#123; #[new] #[pyo3(signature = (dsn))] pub fn new(dsn: &amp;str) -&gt; PyResult&lt;Self&gt; &#123; Ok(AsyncDatabendDriver(build_connector(dsn)?)) &#125; /// exec pub fn exec&lt;'p&gt;(&amp;'p self, py: Python&lt;'p&gt;, sql: String) -&gt; PyResult&lt;&amp;'p PyAny&gt; &#123; let this = self.0.clone(); future_into_py(py, async move &#123; // Ë∞ÉÁî® connection ‰∏≠ÁöÑ exec ÊñπÊ≥ï let res = this.connector.exec(&amp;sql).await.unwrap(); Ok(res) &#125;) &#125; &#125; ÊúÄÂêéÂú® lib.rs ‰∏≠Â∞Ü AsyncDatabendDriver Ê∑ªÂä†‰∏∫ python class: 12345#[pymodule]fn _databend_driver(_py: Python, m: &amp;PyModule) -&gt; PyResult&lt;()&gt; &#123; m.add_class::&lt;AsyncDatabendDriver&gt;()?; Ok(())&#125; ÂÆö‰πâ python Êâ©Â±ïÊ®°Âùó‰ø°ÊÅØÂàõÂª∫ pyproject.toml Âíå python/databend_driver Âπ∂ÂÆö‰πâ python module Áõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇ ÊµãËØïËøôÈáåÊàë‰ª¨‰ΩøÁî® behave ËøõË°åÊµãËØïÔºåÂêåÊó∂‰πüÂèØ‰ª•ÁúãÂà∞ËÉΩÂ§ü‰ª• import databend_driver ÁöÑÂΩ¢ÂºèÂú® python È°πÁõÆ‰∏≠‰ΩøÁî®Ôºö 1234567Feature: Databend-Driver Binding Scenario: Databend-Driver Async Operations Given A new Databend-Driver Async Connector When Async exec "CREATE TABLE if not exists test_data (x Int32,y VARCHAR)" When Async exec "INSERT INTO test_data(x,y) VALUES(1,'xx')" Then The select "SELECT * FROM test_data" should run 123456789101112131415161718192021import osfrom behave import given, when, thenfrom behave.api.async_step import async_run_until_completeimport databend_driver@given("A new Databend-Driver Async Connector")@async_run_until_completeasync def step_impl(context): dsn = os.getenv("TEST_DATABEND_DSN", "databend+http://root:root@localhost:8000/?sslmode=disable") context.ad = databend_driver.AsyncDatabendDriver(dsn)@when('Async exec "&#123;sql&#125;"')@async_run_until_completeasync def step_impl(context, sql): await context.ad.exec(sql)@then('The select "&#123;select_sql&#125;" should run')@async_run_until_completeasync def step_impl(context, select_sql): await context.ad.exec(select_sql) ËøêË°å maturin develop ‰ºöËá™Âä®ÊâìÂåÖÂá∫‰∏Ä‰∏™ wheel ÂåÖÔºåÂπ∂‰∏îÂÆâË£ÖÂà∞ÂΩìÂâçÁöÑ venv ‰∏≠ Ôºå 1234 .... Finished dev [unoptimized + debuginfo] target(s) in 8.71süì¶ Built wheel for abi3 Python ‚â• 3.7 to /var/folders/x5/4hndsx0x7cb5_45qgpfqx4th0000gn/T/.tmpyzRsUc/databend_driver-0.0.1-cp37-abi3-macosx_11_0_arm64.whlüõ† Installed databend-driver-0.0.1 ÊâßË°å behave tests ËøêË°åÊµãËØïÈõÜ: ÁªìËÆ∫Âü∫‰∫é Pyo3ÔºåÊàë‰ª¨ÂèØ‰ª•ÊØîËæÉÊñπ‰æøÂú∞‰∏ìÊ≥®‰∫é Rust ÂÆûÁé∞ÈÄªËæëÊú¨Ë∫´ÔºåÊó†ÈúÄÂÖ≥Ê≥®Â§™Â§ö FFI ÔºàForeign Function InterfaceÔºâÂíåËΩ¨Êç¢ÁªÜËäÇÂ∞±ÂèØ‰ª•Â∞Ü Rust ‰ΩéÊàêÊú¨Âú∞ËΩ¨Êç¢Êàê Python Ê®°ÂùóÔºåÂêéÊúü‰πüÂè™ÈúÄË¶ÅÁª¥Êä§‰∏ÄÂ•ó‰ª£Á†ÅÔºåÊûÅÂ§ßÂú∞Èôç‰Ωé‰∫ÜÁª¥Êä§ÊàêÊú¨„ÄÇÊú¨ÊñáÁ´†ÊäõÁ†ñÂºïÁéâÔºåÂè™ÊòØÂ∞ÜÂæàÂ∞ëÈÉ®ÂàÜ‰ª£Á†ÅÂÅö‰∫ÜËΩ¨Êç¢ÔºåÂêéÈù¢‰ºöÈôÜÁª≠Â∞Ü rust driver ÂÖ®ÈÉ®Êèê‰æõ Python binding ÊúÄÁªàÊõøÊç¢ÊéâÁé∞Âú®ÁöÑ databend-py„ÄÇ HTML ‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã ‚Äã]]></content>
      <categories>
        <category>rust</category>
      </categories>
      <tags>
        <tag>databend</tag>
        <tag>rust</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2023 12 Open Source weekly report]]></title>
    <url>%2F2023%2F03%2F17%2F2023-12-Open-Source-weekly-report%2F</url>
    <content type="text"><![CDATA[‰∏çÂá∫ÊÑèÂ§ñËøôÊòØ 2023 Âπ¥Á¨¨‰∏Ä‰ªΩÂë®Êä•Ôºå‰∏ÄÁõ¥ÊãñÁùÄ‰∏çÂÜôÂÄí‰∏çÊòØÂõ†‰∏∫Ê≤°‰ªÄ‰πàÂèØÂÜôÁöÑÔºåÂèçËÄåÊòØÂõ†‰∏∫ÊúÄËøëËøôÂá†‰∏™ÊúàÊé•Êî∂ÁöÑ‰ø°ÊÅØÈáèÂ§™Â§ßÔºå‰∏ÄÊó∂Èó¥Ê≤°ÊúâÂäûÊ≥ïÂêÉÈÄè„ÄÅÁêÜËß£ÔºåËá™ÁÑ∂Â∞±Êó†Ê≥ïÂÅöÂà∞ÊúâÊïàËæìÂá∫„ÄÇÈô§‰∫ÜÂ∏∏ËßÑÁöÑÂ∑•‰Ωú‰ª•Â§ñÔºåËøôÊÆµÊó∂Èó¥ÂºÄÂßãÊé•Ëß¶ ELT Áõ∏ÂÖ≥ÁöÑ‰∏úË•øÔºåÊØîÂ¶Ç Airbyte„ÄÅdbtÔºåCDC È¢ÜÂüü‰∏≠ÁöÑ TapData„ÄÅFlink CDC ÔºåÂÆåÂñÑ databend Âú® BI Á±ªÂ∑•ÂÖ∑ÁöÑÁîüÊÄÅ‚Ä¶.ÊØîÂ¶Ç superset, redash, metadata Á≠âÔºå‰ø°ÊÅØÈáèÂèØ‰ª•ËØ¥ÊòØÁàÜÁÇ∏ÂºèÂ¢ûÈïøÔºåÂæàÂ§ö‰∏úË•ø‰πüÊòØ‰∏ÄÁü•ÂçäËß£ÁöÑ„ÄÇ ËøôÂë®‰πãÊâÄ‰ª•ÊÉ≥Ëµ∑Êù•ÂÜôÊòØÂõ†‰∏∫ÂÜô‰∫Ü‰∏ÄÁÇπÊØîËæÉÊúâÊÑèÊÄùÁöÑÊñ∞‰∏úË•øÔºåÊâÄ‰ª•ÊÉ≥ËÆ∞ÂΩïÂπ∂ÂàÜ‰∫´‰∏Ä‰∏ã„ÄÇ Clojure &amp; MetabaseÊòØÁöÑ‰Ω†Ê≤°ÁúãÈîôÔºåËøôÂë®‰∏ÄÁõ¥Âú®ÂÜô Clojure„ÄÇËµ∑Âõ†ÊòØË¶ÅÂú® Metabase ‰∏≠ÊîØÊåÅ databendÔºåmetabase ÊòØ‰∏ÄÊ¨æÊòìÁî®„ÄÅÂºÄÊ∫ê„ÄÅÊäÄÊúØÊàêÁÜü„ÄÅ‰∏çÊñ≠Âπ∂Âø´ÈÄüËø≠‰ª£ÁöÑ BI Â∑•ÂÖ∑ÔºåÊâìÂºÄ metabase ÁöÑ Github È¶ñÈ°µ ÂèØ‰ª•ÁúãÂà∞ÂÖ∂‰∏ªË¶ÅÊòØÁºñÁ®ãËØ≠Ë®ÄÊ≠£ÊòØ Clojure„ÄÇ ÂæàÂ§öÂπ¥ËΩªÁöÑÊúãÂèãÂèØËÉΩÈÉΩÊ≤°Âê¨ËØ¥ËøáËøôÈó®ÁºñÁ®ãËØ≠Ë®Ä„ÄÇClojure ÊòØ‰∏ÄÁßçËøêË°åÂú®JavaÂπ≥Âè∞‰∏äÁöÑÁ±ª Lisp ËØ≠Ë®ÄÔºåÁúãÂà∞ Lisp ÊòØ‰∏çÊòØ‰∏ÄÁßç‰∏äÂè§ÁöÑÊ∞îÊÅØÊâëÈù¢ËÄåÊù•„ÄÇClojure ÊØîËæÉÊàêÂäüÂú∞ÊääÂáΩÊï∞ÂºèÁºñÁ®ãÂºïÂÖ•‰∫Ü JVMÔºåÂú®JVMÂπ≥Âè∞ËøêË°åÁöÑÊó∂ÂÄôÔºå‰ºöË¢´ÁºñËØë‰∏∫JVMÁöÑÂ≠óËäÇÁ†ÅËøõË°åËøêÁÆó„ÄÇÂÖ∂ÊúÄÂ§ßÁöÑ‰ºòÂäøÂ∞±ÊòØÂú®‰øùÊåÅ‰∫ÜÂáΩÊï∞ÂºèËØ≠Ë®ÄÁöÑ‰∏ªË¶ÅÁâπÊÄßÁöÑÂâçÊèê‰∏ãÔºå‰æãÂ¶Çimmutable stateÔºåFull Lisp-style macro supportÔºåpersistent data structuresÁ≠âÁ≠âÔºåËøòËÉΩÂ§üÈùûÂ∏∏Êñπ‰æøÁöÑË∞ÉÁî®JavaÁ±ªÂ∫ìÁöÑAPIÔºåÂíåJavaÁ±ªÂ∫ìËøõË°åËâØÂ•ΩÁöÑÊï¥Âêà„ÄÇ Metabase Êèê‰æõ‰∫Ü‰∏ÄÁßçÊèí‰ª∂Á≥ªÁªüÔºåÊñπ‰æøÂºÄÂèëËÄÖ‰ª•ÂºÄÂèëÊèí‰ª∂ÁöÑÊñπÂºèÔºåÂ∞ÜÊï∞ÊçÆÊ∫êÊ∑ªÂä†Âà∞ metabase ‰∏≠ÔºåÂõ†‰∏∫Ë¶ÅË∞ÉÁî® metabase driver ÁöÑ APIÔºåÊâÄ‰ª•Êèí‰ª∂ÁöÑÁºñÂÜô‰πüÈúÄË¶Å‰ΩøÁî® Clojure Êù•ÂÆåÊàê„ÄÇ ‰∏äÊâã Clojure Clojure ÊòØÂÆåÂÖ®ÁöÑÂáΩÊï∞ÂºèÁºñÁ®ãÔºåÂü∫Êú¨ËØ≠Ê≥ïÊØîËæÉÁÆÄÂçïÔºåÂ§ßÊ¶ÇÁúã‰∫ÜÂçäÂ§©ÁöÑÊïôÁ®ãÈÖçÁΩÆÂ•ΩÂºÄÂèëÁéØÂ¢ÉÂ∞±ËÉΩÂÜô hello world ‰∫Ü„ÄÇA few days later‚Ä¶.ÔºåÊîØÊåÅ databend ÁöÑ metabase Êèí‰ª∂Â∞±ÂÆåÊàê‰∫ÜÔºåÈ°πÁõÆÂèäÁõ∏ÂÖ≥‰ª£Á†ÅÂú® metabase databend driver „ÄÇ Êèí‰ª∂‰ΩøÁî®Metabase ÁöÑÊèí‰ª∂‰ΩøÁî®Ëµ∑Êù•ÈùûÂ∏∏Êñπ‰æøÔºåÂè™ÈúÄË¶Å‰∏§‰∏™ jar Â∞±ËÉΩ‰ªé databend ËØªÂèñÂπ∂ÂàÜÊûêÊï∞ÊçÆÂá∫Êä•Ë°®‰∫Ü„ÄÇ Download metabase.jarMetabaseÊòØ‰∏Ä‰∏™JavaÂ∫îÁî®Á®ãÂ∫èÔºåÂèØ‰ª•ÈÄöËøá‰∏ãËΩΩJARÊñá‰ª∂ Âπ∂ÊâßË°å java -jar metabase.jarÊù•ËøêË°å„ÄÇMetabase ‰ΩøÁî® JDBC Driver ËøûÊé•Âà∞ Databend„ÄÇ Download metabase Databend Driver Âú®‰∏ãËΩΩ metabase.jar ÁöÑÁõÆÂΩï‰∏ãÂàõÂª∫ÁõÆÂΩï plugins 123$ lsmetabase.jar$ mkdir plugins ‰∏ãËΩΩÊúÄÊñ∞ÁöÑ databend metabase driver: https://github.com/databendcloud/metabase-databend-driver/releases/latest Âà∞ plugins ÁõÆÂΩï‰∏ã ÂêØÂä® metabase 1java -jar metabase.jar ÂêØÂä®ËøáÁ®ã‰∏≠ÁúãÂà∞‰∏ãÈù¢ÁöÑÊó•ÂøóÂ∞±Ë°®Á§∫ databend È©±Âä®Ë¢´Ê≠£Â∏∏Âä†ËΩΩ: 122019-05-07 23:27:32 INFO plugins.lazy-loaded-driver :: Registering lazy loading driver :databend...2019-05-07 23:27:32 INFO metabase.driver :: Registered driver :databend (parents: #&#123;:sql-jdbc&#125;) üöö ËÆøÈóÆ http://hostname:3000 Âç≥ÂèØÊâìÂºÄ metabase È¶ñÈ°µ Connect Metabase to Databend Â°´ÂÜôÂü∫Êú¨‰ø°ÊÅØÔºåÈÄâÊã© I&#39;ll add my data later ÁÇπÂáªAdd your own data ÂàõÂª∫ databend Êï∞ÊçÆÂ∫ìËøûÊé• ÈÄâÊã© databend (databend version &gt;=DatabendQuery v1.0.17) Â°´ÂÜôÊï∞ÊçÆÂ∫ìËøûÊé•‰ø°ÊÅØÂêéÁÇπÂáª‰øùÂ≠ò ÈÄÄÂá∫ÂêéÂè∞ÁÆ°ÁêÜ Run a SQL query ÈÄÄÂá∫ÂêéÂè∞ÁÆ°ÁêÜÂêéÔºåÂú®Âè≥‰∏äËßíÔºåÂçïÂáª + New ËèúÂçïÔºåÂèØ‰ª•ËøêË°åSQLÊü•ËØ¢ÂíåÊûÑÂª∫‰ª™Ë°®Áõò„ÄÇ ‰∏æ‰∏™ SQL Êü•ËØ¢ÁöÑüå∞ ÁÇπÂáªÂ∑¶‰∏ãËßíÁöÑÂèØËßÜÂåñÊåâÈíÆÂèØ‰ª•ÊûÑÂª∫‰ª™Ë°®Áõò Learn moreÊúâÂÖ≥Metabase‰ª•ÂèäÂ¶Ç‰ΩïÊûÑÂª∫‰ª™Ë°®ÊùøÁöÑÊõ¥Â§ö‰ø°ÊÅØÔºåËØ∑ËÆøÈóÆ Metabase ÊñáÊ°£„ÄÇ ‰∏Ä‰∫õÊÑüÂèóÂÜô Clojure ËøáÁ®ã‰∏≠ÊÑüÂèóÊúÄÊ∑±ÁöÑËøòÊòØÂúÜÊã¨Âè∑Ê±ÇÂÄº ()ÔºåÂõ†‰∏∫ Clojure ‰∏≠‰ªª‰ΩïËØ≠Âè•ÁöÑ‰∏ÄËà¨ÂΩ¢ÂºèÈúÄË¶ÅÂú®Â§ßÊã¨Âè∑‰∏≠Ê±ÇÂÄºÔºåÂêë‰∏ãÈù¢ËøôÊ†∑Ôºö 12345678(+ 1 2) ;ËøêÁÆóÁ¨¶Âú®Ââç------(ns clojure.examples.hello (:gen-class))(defn Example [] (println (str "Hello" "World")) (println (+ 1 2)))(Example) ÊâÄ‰ª•ÂΩì‰∏Ä‰∏™ÂáΩÊï∞ÊØîËæÉÂ§ßËÄå‰∏îÊúâÈ´òÈò∂ÂáΩÊï∞ÁöÑÊó∂ÂÄôÔºåÊï∞Êã¨Âè∑Â∞±‰ºöÊàê‰∏∫‰∏ÄÁßçÁÅæÈöæüòÇÔºåËøô‰∏™Êó∂ÂÄôÂ∞±‰∏çÂæó‰∏ç‰æùËµñ IDE ÁöÑÊèêÁ§∫‰∫Ü„ÄÇ Êú∫ÁºòÂ∑ßÂêàÁ≤óÊµÖÂú∞‰∫ÜËß£‰∫ÜËøôÈó®ÁºñÁ®ãËØ≠Ë®ÄÔºå‰∏çËøáÁõÆÂâçÊù•Áúã‰ΩøÁî® Clojure ‰Ωú‰∏∫‰∏ªÂäõÂºÄÂèëËØ≠Ë®ÄÁöÑÂÖ¨Âè∏ÈùûÂ∏∏Â∞ëÔºåÂùäÈó¥ÁîöËá≥‰∏ÄÂ∫¶‰º†Èóª Clojure is dead„ÄÇ‰ΩÜÊòØËØ≠Ë®ÄÂè™ÊòØÂ∑•ÂÖ∑ÔºåÂç≥‰ΩøÂ∑•‰Ωú‰∏≠Êó†Ê≥ï‰ΩøÁî®Ôºå‰∫ÜËß£ËøôÈó®‰ºòÈõÖ„ÄÅÂØåÊúâË°®Áé∞ÂäõÁöÑËØ≠Ë®ÄÊù•Êâ©Â±ïËá™Â∑±ÁöÑÁúºÁïåÔºå‰πüÊòØ‰∏çÈîôÁöÑÈÄâÊã©„ÄÇClojure Á§æÂå∫‰πüÊúâ‰∏Ä‰∫õÊúâÊÑèÊÄùÁöÑÈ°πÁõÆÔºåËøôÈáåÊäõÁ†ñÂºïÁéâÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂêåÂ≠¶ÂèØ‰ª•Âéª‰∫ÜËß£‰∏Ä‰∏ã„ÄÇ Á¥¢ÊÄßÂú®ËøôÈáåËÆ∞ÂΩïË∑üË∏™‰∏Ä‰∏ãÊúÄËøëÁöÑ‰∏Ä‰∫õË∑üÂºÄÊ∫êÁõ∏ÂÖ≥ÁöÑÂ∑•‰Ωú tapdata/tapdata üéâ New connector: databend clickvisual/clickvisual Feat: support databend source getredash/redash feat: New support databend for redash apache/superset feat: support databend for superset airbytehq/airbyte üéâ New source connector: databend metabase-databend-driver flink-connector-databend]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 51 Open source weekly report]]></title>
    <url>%2F2022%2F12%2F17%2F2022-51-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[Ë∑ùÁ¶ª‰∏ä‰∏ÄÊ¨° weekly report Â∑≤ÁªèËøáÂéªÊï¥Êï¥‰∏Ä‰∏™ÊúàÔºåÂú® databend-py„ÄÅdatabend-sqlalchemy Âü∫Êú¨ÂèØÁî®ÁöÑÂâçÊèê‰∏ãÊàëÂºÄÂßãÁùÄÊâãÂú® dbt ÁöÑÁîüÊÄÅ‰∏≠ÊîØÊåÅ databend cloud„ÄÇdbt Êèê‰æõ‰∫Ü‰∏ÄÁßçÊèí‰ª∂ÁîüÊÄÅÔºåÊàë‰ª¨ÂèØ‰ª•ÂºÄÂèë‰∏ìÊúâÁöÑ adapter plugin ‰ªéËÄåÂ∞Ü DBT Êâ©Â±ïÂà∞‰ªª‰ΩïÊï∞ÊçÆÂπ≥Âè∞„ÄÇdbt ÁÆóÊòØÂú®Êï∞ÊçÆÈ¢ÜÂüüÁöÑÊñ∞Áâ©ÁßçÔºåÂú®ÂõΩÂÜÖÊÑüËßâÁî®ÁöÑËøò‰∏çÊòØÂæàÂ§öÔºå‰ΩÜÊòØÂú®ÂõΩÂ§ñÂ∑≤Áªè‰ø®ÁÑ∂Êàê‰∏∫Áé∞‰ª£Êï∞ÊçÆÈ¢ÜÂüüÁöÑÂêéËµ∑‰πãÁßÄ„ÄÇÊâÄ‰ª•‰∏ãÈù¢ÂÖàÊäõÁ†ñÂºïÁéâÔºåÁÆÄÂçï‰ªãÁªç‰∏Ä‰∏ã dbt„ÄÇ What is dbt?dbt ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Âº∫Â§ßÂíåÁÅµÊ¥ªÁöÑÊï∞ÊçÆÂ∑•ÂÖ∑ÔºåÂÆÉÂèØ‰ª•Âø´ÈÄüÊûÑÂª∫Êï∞ÊçÆ pipe„ÄÅÂü∫‰∫é jinjia Ê®°Êùø‰ª•Ëá™Âä®ÊµãËØï„ÄÅÊûÑÂª∫ÂíåÂ°´ÂÖÖÂàÜÊûêÊ®°ÂûãÔºåÂåÖÊã¨ÊñáÊ°£ÁöÑËá™Âä®ÁîüÊàêÂíåÂºÄÁÆ±Âç≥Áî®ÁöÑÊï∞ÊçÆË°ÄÁºòÔºåÈùûÂ∏∏ÈÄÇÂêàËá™Âä®ÂåñÊï∞‰ªìÁöÑÂ∑•‰Ωú„ÄÇÂÖ∂Ê†∏ÂøÉ‰ª£Á†ÅÊòØ‰∏Ä‰∏™ÂºÄÊ∫ê Python Â∫ì - dbt-core „ÄÇÂèØ‰ª•ÂèÇËÄÉËøô‰∏™È°πÁõÆÂø´ÈÄü‰∏äÊâã‰ΩìÈ™å‰∏Ä‰∏ã„ÄÇ ÈúÄË¶ÅÂº∫Ë∞ÉÁöÑ‰∏ÄÁÇπÊòØ dbt Âπ∂‰∏çÊòØ‰º†ÁªüÁöÑ ETL Â∑•ÂÖ∑Ôºå ÂÆÉÂπ∂‰∏çÂú®Á≥ªÁªü‰πãÈó¥‰º†ËæìÊàñËÄÖÂä†ËΩΩÊï∞ÊçÆÔºåËÄåÊòØÈÄöËøá‰ΩøÁî® SQL Âíå YAML Êù•ËΩ¨Êç¢Â∑≤ÁªèË¢´Âä†ËΩΩÂà∞Êï∞‰ªì‰∏≠ÁöÑÊï∞ÊçÆ„ÄÇËøôÁßçÂÖàÂä†ËΩΩÂêéËΩ¨Êç¢ÁöÑÊ¶ÇÂøµÔºåÁß∞‰∏∫ ELT„ÄÇ Âú® ELT ÁöÑËøáÁ®ã‰∏≠ÔºåÊï∞ÊçÆÊó†È°ªÁ≠âÂæÖÂç≥ÂèØËøõÂÖ•Êï∞‰ªìÔºåËΩ¨Êç¢Âá∫Áé∞ÈîôËØØ‰πü‰∏çÈúÄË¶ÅÈáçÊñ∞Âä†ËΩΩÔºåËÉΩÂ§üÊèêÈ´òÊïàÁéáÂπ∂Èôç‰ΩéÊàêÊú¨„ÄÇ‰∏ãÈù¢Êàë‰πü‰ºö‰ªãÁªç‰∏Ä‰∏™ EL ÁöÑÂ∑•ÂÖ∑ - airbyteÔºåÁúã airbyte + dbt Â¶Ç‰ΩïÂÆûÁé∞ÂÆåÁæéÁöÑ ELT ÊµÅÁ®ã„ÄÇÂÖ≥‰∫é dbt ÁöÑ‰ªãÁªçÂ∞±Âà∞ËøôÈáåÔºåÊÉ≥Ë¶ÅÊ∑±ÂÖ•‰∫ÜËß£ÁöÑÂêåÂ≠¶ÂèØ‰ª•ÂèÇËÄÉ dbt ÂÆòÁΩëÂíå dbt-core ÁöÑ github ‰∏ªÈ°µ„ÄÇ How to use dbt with Databend CloudÁªèËøáÂá†Âë®‰∏é dbt ÁöÑÊêèÊñóÔºåÊîØÊåÅ databend ÁöÑ dbt adapter Êèí‰ª∂ dbt-databend-cloud Áªà‰∫éËÉΩÂ§üË∑ëÈÄöÂÆòÊñπÁöÑ case ‰∫Ü‚úø‚úø„ÉΩ(¬∞‚ñΩ¬∞)„Éé‚úø„ÄÇÂºÄÂèëÁöÑËøáÁ®ã‰∏≠‰πüÂ∏Æ databend Êú¨Ë∫´ÂèëÁé∞Âπ∂Ëß£ÂÜ≥‰∫Ü‰∏Ä‰∫õÈóÆÈ¢ò: IssueFeature: support a.* in SQL Feature: support || concat function in SQL Feature: support SQL-style double-quoted identifier in get_path PRfix: double-quote in get_path ÊúüÈó¥‰πüÊúâË∑ü dbt Á§æÂå∫ÁöÑËÆ®ËÆ∫ÔºåÈùûÂ∏∏ÊÑüË∞¢ dbt Á§æÂå∫ÁöÑÁÉ≠ÂøÉÂ∏ÆÂä©: DisscussionField ‚Äúpath‚Äù of type Path in DatabendRelation has invalid value Êàë‰ª¨ÂèØ‰ª•Ë∑üÁùÄËøô‰∏™ wiki - How to use dbt with Databend Cloud ‰ΩìÈ™å‰∏Ä‰∏ã dbt ÁöÑÂº∫Â§ßËÉΩÂäõÔºåÂ∏åÊúõÂêéÈù¢ËÉΩÈ°∫Âà©Â∞Ü dbt-databend Âä†ÂÖ•Âà∞ÂÆòÊñπ dbt-adapters ÁöÑÁª¥Êä§ÈòµËê•ÂΩì‰∏≠Âéª„ÄÇ What is airbyte?‰∏äÈù¢Êàë‰ª¨‰ªãÁªç ELT ÁöÑÊó∂ÂÄôÊèêÂà∞Ëøá airbyteÔºåËøôÈáåÂÜçÂ±ïÂºÄ‰ªãÁªç‰∏Ä‰∏ã„ÄÇAirbyte ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑ‰∫ëÂéüÁîüÊï∞ÊçÆÈõÜÊàêÂπ≥Âè∞ÔºåÂèØ‰ª•ËÆ©Áî®Êà∑‰ªéÂêÑÁßçÊù•Ê∫êÊèêÂèñ„ÄÅËΩ¨Êç¢ÂíåÂä†ËΩΩÊï∞ÊçÆÂà∞ÂêÑÁßçÁõÆÊ†á„ÄÇ airbyte ÁöÑÊû∂ÊûÑËÆæËÆ°Êòì‰∫éÊâ©Â±ïÔºåÈùûÂ∏∏ÁÅµÊ¥ªÔºåÂÖÅËÆ∏Áî®Êà∑ÂºÄÂèëËá™ÂÆö‰πâÁöÑ source/destination connector ÔºåÂπ∂‰∏îÂèØ‰ª•ÂæàÊñπ‰æøÂú∞Âä†ÂÖ•Âà∞ airbyte ÁöÑÂπ≥Âè∞Èáå„ÄÇËøôÈáåÊàë‰∏ªË¶ÅÊòØÂºÄÂèë‰∫Ü‰∏Ä‰∏™ destination connectorÔºåÂ∞Ü databend cloud ‰Ωú‰∏∫Êï∞ÊçÆÁöÑÁõÆÁöÑÂÖ•Âè£ÔºåËøôÊ†∑Áî®Êà∑Â∞±ÂèØ‰ª•ÂæàÂÆπÊòìÂú∞‰ªéÂêÑ‰∏™Êï∞ÊçÆÊ∫êÔºåÊØîÂ¶Ç S3, Clickhouse, Filebot ÔºåÁîöËá≥Êú¨Âú∞Êñá‰ª∂ÂêåÊ≠•Êï∞ÊçÆÂà∞ databend cloudÔºåÂπ∂‰∏î airbyte ÁöÑ Normalization ËÉΩÂäõÁªìÂêà dbt ÂêéËÉΩÂ§üÂ∞ÜÂéüÂßãÊï∞ÊçÆËΩ¨Êç¢ÊàêÂÆåÊï¥Ë°®ÁªìÊûÑÁöÑÊï∞ÊçÆË°®„ÄÇ Á≠âËøô‰∏™ PR ÂêàÂπ∂ÂêéÂ∞±ÂèØ‰ª•Âú® airbyte cloud ‰∏ä‰ΩøÁî® databend cloud ‰Ωú‰∏∫ data source ‰∫Ü„ÄÇ ClickVisual ÊîØÊåÅ databend sourceClickVisual ÊòØ‰∏Ä‰∏™ËΩªÈáèÁ∫ßÁöÑÁî±Áü≥Â¢®ÊñáÊ°£ÂºÄÊ∫êÁöÑÊó•ÂøóÊü•ËØ¢„ÄÅÂàÜÊûê„ÄÅÊä•Ë≠¶ÁöÑÂèØËßÜÂåñÂπ≥Âè∞ÔºåÊèê‰æõ‰∏ÄÁ´ôÂºèÂ∫îÁî®ÂèØÈù†ÊÄßÁöÑÂèØËßÜÂåñÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇÊó¢ÂèØ‰ª•Áã¨Á´ãÈÉ®ÁΩ≤‰ΩøÁî®Ôºå‰πüÂèØ‰Ωú‰∏∫Êèí‰ª∂ÈõÜÊàêÂà∞Á¨¨‰∏âÊñπÁ≥ªÁªü„ÄÇÁõÆÂâçÊòØÂ∏ÇÈù¢‰∏äÂîØ‰∏Ä‰∏ÄÊ¨æÊîØÊåÅ ClickHouse ÁöÑÁ±ª Kibana ÁöÑ‰∏öÂä°Êó•ÂøóÊü•ËØ¢Âπ≥Âè∞„ÄÇ‰πãÂâç ClickVisual Âè™ÊîØÊåÅ Clickhouse ‰Ωú‰∏∫Êï∞ÊçÆÊ∫êÊù•Â≠òÂÇ®„ÄÅÊü•ËØ¢Êó•ÂøóÔºåÊàëÊ∑ªÂä†‰∫Ü‰∏Ä‰∫õ‰ª£Á†ÅÁªèËøáË∞ÉËØïÂêéÁé∞Âú®‰πüËÉΩÊîØÊåÅ databend cloud ‰Ωú‰∏∫Êï∞ÊçÆÊ∫ê„ÄÇ Feat: support databend source feat: support exist log table for databend ‰ΩÜÊòØÁî±‰∫éÁõÆÂâç databend ‰∏çÊîØÊåÅÁ±ª‰ºº Clickhouse status=&#39;200&#39; ( status ÊòØ int32 Á±ªÂûã) ËøôÊ†∑ÁöÑËØ≠Ê≥ïÔºåÊâÄ‰ª•Â≠óÊÆµËøáÊª§Êü•ËØ¢ÁöÑÂäüËÉΩÈúÄË¶ÅÁ≠âËøô‰∏™ issue-836 Ëß£ÂÜ≥ÂêéÊâçËÉΩÊ≠£Â∏∏‰ΩøÁî®„ÄÇ Openkruise ÈÅóÁïô PRËØ¥Ëµ∑Êù•ÁúüÊòØÈùûÂ∏∏ÊÉ≠ÊÑßÔºå‰∏ç‰ªÖÂ∑≤ÁªèÂæà‰πÖÊ≤°ÊúâÂèÇÂä† OpenKruise ÁöÑÂèåÂë®‰ºö‰∫ÜËÄå‰∏îËøòÈÅóÁïô‰∫Ü‰∏Ä‰∏™ÈôàÂπ¥ËÄÅ PR Ê≤°ÊúâÂÆåÊàêÔºåÂÖ∂ÂÆû‰∏§Âë®Ââç zmberg Â∞±ËÅîÁ≥ªÊàëÂ∞ΩÂø´Â§ÑÁêÜ‰∏Ä‰∏ãËøô‰∏™ÈóÆÈ¢òÔºåÊâÄ‰ª•ËøôÂë®Êó†ËÆ∫Â¶Ç‰Ωï‰πüË¶ÅÊääËøô‰∏™ PR ÂÖ≥Êéâ üò≠„ÄÇ Áªº‰∏äÔºåÂ∏åÊúõ 2022 ÁöÑÊúÄÂêé‰∏§Âë®Â∑•‰ΩúÈ°∫Âà©üéâ„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 47 Open source weekly report]]></title>
    <url>%2F2022%2F11%2F13%2F2022-47-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[Ëá™‰ªé databend-go release ÂêéÔºåÊúÄËøëÂ§ßÈÉ®ÂàÜÊó∂Èó¥ÈÉΩÂú®‰∏é Python ÊêèÊñóüòÇÔºåÂ§™ÈïøÊó∂Èó¥Ê≤°ÊúâÊ≠£ÂÑøÂÖ´ÁªèÂÜô Python ‰∫ÜÁúüÊòØÁ£®Âêà‰∫ÜÂ•ΩÂá†Â§©ÊâçÊâæÂà∞ÁÇπÊÑüËßâ„ÄÇÁî®‰∫ÜÂ∑Æ‰∏çÂ§ö‰∏§Âë®Ôºådatabend ÁöÑ Python Deiver databend-py ‰ª•ÂèäÊîØÊåÅ SQLAlchemy ËØ≠Ê≥ïÁöÑ databend-sqlalchemy Â∑≤ÁªèÂü∫Êú¨ÂèØÁî®„ÄÇ‰∏çÂæó‰∏çËØ¥ Python Âú®Êï∞ÊçÆÁöÑÁîüÊÄÅÈáåËøòÊòØÁéãËÄÖÔºåÂâçÂá†Â§©ÊúâÁî®Êà∑Âú®‰ΩøÁî® go driver ÁöÑÊó∂ÂÄôÈÅáÂà∞‰∫Ü‰∏Ä‰∏™ data type parser ÁöÑÈóÆÈ¢òÔºå‰πãÂâçÂú®ÂÆûÁé∞ËøáÁ®ã‰∏≠Â∞±ÈÅáÂà∞ËøáÁ±ª‰ººÁöÑÁ±ªÂûãÈóÆÈ¢òÔºåËøôÁßçÈóÆÈ¢òÂú®Âº∫Á±ªÂûãËØ≠Ë®ÄÈáåÁÆÄÁõ¥Â∞±ÊòØÁÅæÈöæÔºå‰ΩÜÊòØÂØπ‰∫é Python Êù•ËØ¥Â∞±‰∏çÂ≠òÂú®„ÄÇÊâÄ‰ª•ÊúÄÂêéÁî®Êà∑ËøòÊòØÁî®‰∫Ü Python ÁöÑ driver Ëß£ÂÜ≥‰∫ÜÈóÆÈ¢òÔºåÁúãÊù•ÂêéÈù¢Ë¶ÅËÆ§ÁúüÊâìÁ£® databend-py ‰∫Ü„ÄÇ Âú®‰ΩøÁî®ÊñπÈù¢‰πüÊòØ python Âç†‰ºòÔºåpip install ÁÑ∂Âêé import Áõ¥Êé•Â∞±ÊòØÊâãÂà∞ÊìíÊù•Ôºö 1pip install databend-py 1234567from databend_py import Clientclient = Client( host='hostName', database="default", user="user", password="pass")print(client.execute("SELECT 1")) ‰∏çËøá databend-py ‰ªÖÊòØÊèê‰æõ‰∫Ü python ËøûÊé•Âà∞ databend cloud ÁöÑÊ°•Ê¢ÅÔºåÂπ∂‰∏çËÉΩÂÉè‰ΩøÁî® ORM Â∑•ÂÖ∑‰∏ÄÊ†∑‰ΩøÁî® cursor.next„ÄÅfetchall Á≠âÊñπÊ≥ï„ÄÇÂú®ÂáÜÂ§áÂÆûÁé∞ dbt adapter ÁöÑÊó∂ÂÄôÂèëÁé∞ÈúÄË¶Å‰æùËµñ‰∏äÈù¢ÊèêÂà∞ÁöÑ ORM ÁöÑÊñπÊ≥ïÔºåÂú® Python ÁîüÊÄÅÈáå SQLAlchemy ÊòØ Python ‰∏≠ÊúÄÊúâÂêçÁöÑ ORM Â∑•ÂÖ∑ÔºåÊâÄ‰ª•Â∞±Êúâ‰∫Ü databend-sqlalchemy Ëøô‰∏™È°πÁõÆ„ÄÇÁî±‰∫éÊó∂Èó¥Á¥ßËø´ÔºåÂÖàÂÆûÁé∞‰∫ÜÂØπÊé• dbt ÂøÖÈ°ªË¶ÅÁî®Âà∞ÁöÑ cursor, description, next, fetch ÊñπÊ≥ïÔºåÂú® databend-py ÁöÑÈì∫Âû´‰∏ãÔºåÂÆûÁé∞Ëµ∑Êù•Á°ÆÂÆûÊñπ‰æøÂæàÂ§ö„ÄÇ 12345cursor = connector.connect('http://root:@localhost:8081').cursor() cursor.execute('select 1') # print(cursor.fetchone()) print(cursor.fetchall()) print(cursor.description) Âá†‰∏™Â≠óÊÄªÁªì‰∏Ä‰∏ãËøëÊúüÁöÑÁä∂ÊÄÅÂ∞±ÊòØÔºö‰∏é Python ÊêèÊñóÔºåÂΩìÁÑ∂Êé•‰∏ãÊù•ÂèØ‰ª•È¢ÑËßÅÁöÑ‰æùÁÑ∂‰ºöË∑ü python ÊêèÊñó‰∏ÄÊÆµÊó•Â≠êÔºåÂõ†‰∏∫ÊúÄËøëË¶ÅÊêûÁöÑ dbt adapter ÊòØ‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑ, ÈôåÁîüÈ¢ÜÂüüÔºåÂÆåÂÖ®Â∞±ÊòØ‰∏ÄÂ§¥ÈõæÊ∞¥ÔºåÊâÄ‰ª•Êé•‰∏ãÊù•ÂèØËÉΩ‰ºöÂÖàÂÜôÂá†ÁØáÂÖ≥‰∫é dbt ÁöÑÂ≠¶‰π†ÊñáÁ´†Âêß„ÄÇ ÂÜçÂ∞±ÊòØÊúÄËøëÂºÄÁöÑ repo ÊúâÁÇπÂ§öÔºåÂä†‰∏äÂÆûÁé∞ÁöÑÊó∂Èó¥ÊØîËæÉÁ¥ßÔºåÊÑüËßâÊúâ‰∫õÁñ≤‰∫éÂ∫îÂØπÔºåÂæàÂ§öÂÆûÁé∞Âè™ËÉΩËçâËçâ‰∫Ü‰∫ãÔºå‰º∞ËÆ° bug ‰ºöÊØîËæÉÂ§öÔºåÊâÄ‰ª•ÂêéÈù¢Â∫îËØ•‰ºöÂ§öÊäΩÂá∫‰∏Ä‰∫õ‰∏™‰∫∫ÁöÑÊó∂Èó¥Êù•ÂÆåÂñÑËøô‰∫õÈ°πÁõÆ„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 43 Open source weekly report]]></title>
    <url>%2F2022%2F10%2F21%2F2022-43-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[Go driver SDK for databend cloud released!Áî±‰∫éÂú® databend cloud ÂêÑ‰∏™È°πÁõÆÁöÑ‰ª£Á†Å‰∏≠Â∑≤ÁªèÂÖÖÊñ•ÁùÄÂ§ßÈáèÈáçÂ§çÁöÑËØ∑Ê±Ç databend-query ÁöÑ‰ª£Á†ÅÔºåÊâÄ‰ª•‰∫üÈúÄ‰∏Ä‰∏™ driver SDK Êù•ÂÆûÁé∞Â§ß‰∏ÄÁªüÔºå‰∫éÊòØÂú®Âá†Âë®ÂâçÂ∞±ÂºÄÂßãÁùÄÊâãÂÆûÁé∞ databend cloud ÁöÑ go driverÔºåÂΩìÊó∂Áî®ÊØîËæÉÁü≠ÁöÑÊó∂Èó¥Â§ßÊ¶ÇÂÆûÁé∞‰∫Ü‰∏Ä‰∏™Êû∂Â≠êÔºåËØ¶ÊÉÖÂèØ‰ª•ËßÅ ËøôÁØáÊñáÁ´†„ÄÇÁ¢ç‰∫é‰∏≠Èó¥ÊúâÂá†‰∏™‰ºòÂÖàÁ∫ßÊØîËæÉÈ´òÁöÑÂ∑•‰ΩúÂ∞±ÊöÇÊó∂ÊêÅÁΩÆ‰∫ÜÔºåÊú¨Âë® all in Ëøô‰∏™È°πÁõÆ‰∏ÄÂë®ÔºåÁªà‰∫é release ‰∫Ü v0.0.1 ÁâàÊú¨ÔºåËôΩÁÑ∂‰ª£Á†ÅÁöÑÁªìÊûÑ„ÄÅÂäüËÉΩÁöÑ‰∏∞ÂØåÁ®ãÂ∫¶„ÄÅ‰ª£Á†ÅÁöÑ‰ºòÈõÖÁ®ãÂ∫¶ÈÉΩË∑üÊ†áÊùÜ SDK - clickhouse-go ÁöÑÊ∞¥Âπ≥ÊúâËæÉÂ§ßÂ∑ÆË∑ùÔºå‰ΩÜÂü∫Êú¨ÁöÑÊñπÊ≥ïÊØîÂ¶Ç sql.Open, Exec, Query, Next, Rows Á≠âÈÉΩÂ∑≤ÁªèÂèØÁî®„ÄÇÂÖàÊù•ÁúãÂá†‰∏™üå∞Âêß! Execution12345678910111213141516171819 dsn, cfg, err := getDSN() if err != nil &#123; log.Fatalf("failed to create DSN from Config: %v, err: %v", cfg, err) &#125;conn, err := sql.Open("databend", dsn) if err != nil &#123; return err &#125; conn.Exec(`DROP TABLE IF EXISTS data`) _, err = conn.Exec(` CREATE TABLE IF NOT EXISTS data( Col1 UInt8, Col2 String ) `) if err != nil &#123; return err &#125; _, err = conn.Exec("INSERT INTO data VALUES (1, 'test-1')") Query RowÂèØ‰ª•Áî® Scan ÊñπÊ≥ïÊù•Ëß£ÊûêÂá∫ÂçïÊù°Êï∞ÊçÆ12345678910row := conn.QueryRow("SELECT * FROM data")var ( col1 uint8 col2, col3, col4 string col5 []string col6 time.Time)if err := row.Scan(&amp;col1, &amp;col2, &amp;col3, &amp;col4, &amp;col5, &amp;col6); err != nil &#123; return err&#125; Query RowsÂΩìÁÑ∂ÂèØ‰ª•Áî® Next Êù•‰∏çÊñ≠Ëø≠‰ª£Ëé∑ÂèñÊâÄÊúâÊï∞ÊçÆ 12345678910111213row := conn.QueryRow("SELECT * FROM data")var ( col1 uint8 col2, col3, col4 string col5 []string col6 time.Time)for rows.Next() &#123; if err := row.Scan(&amp;col1, &amp;col2, &amp;col3, &amp;col4, &amp;col5, &amp;col6); err != nil &#123; return err &#125; fmt.Printf("row: col1=%d, col2=%s, col3=%s, col4=%s, col5=%v, col6=%v\n", col1, col2, col3, col4, col5, col6)&#125; ËøôÊ†∑Âú®ËØ∑Ê±Ç databend-query ÁöÑÊó∂ÂÄôÔºåÂ∞±‰∏çÁî®ÂÜçÊØèÊ¨°ÈÉΩÂÜô‰∏ÄÈÅç http ËØ∑Ê±Ç/Ëß£ÊûêÁöÑ‰ª£Á†ÅÂï¶„ÄÇ bendsql Â∞ùÈ≤ú go driverGo driver release ÂêéÈ©¨‰∏äÂ∞±ËøéÊù•‰∫ÜÁ¨¨‰∏Ä‰∏™Áî®Êà∑(Â∞èÁôΩÈº†) - bendsql„ÄÇbendsql ‰∏≠Êúâ‰∏™ÂëΩ‰ª§Áî®Êù•ÊâßË°å SQL ËØ≠Âè•Ôºå bendsql query &quot;select * from table&quot;ÔºåÊâÄ‰ª•ÊàëÂÖàÂ∞ÜËøôÈáåÈù¢ËØ∑Ê±Ç databend-query ÁöÑ‰ª£Á†ÅÈÉΩÊç¢Êàê‰∫Ü go driver - https://github.com/databendcloud/bendsql/pull/22ÔºåÂèØ‰ª•ÁúãÂà∞Âà†Êéâ‰∫Ü‰∏çÂ∞ë‰ª£Á†ÅÔºåÊ∏ÖÊô∞‰∫Ü‰∏çÂ∞ë„ÄÇÊé•‰∏ãÊù•Ë¶ÅÂú®ÂÖ∂‰ªñÈ°πÁõÆ‰∏≠ÂéªÊ£ÄÈ™å‰∫Ü„ÄÇ Êù•ÁúãÁúãÊïàÊûúÔºö kruise-toolsÊú¨Âë® kubectl-kruise Êèí‰ª∂ËøéÊù•‰∫Ü‰∏ÄÊ¨°Êõ¥Êñ∞ÔºåÂåÖÂê´‰∫Ü‰∏§‰∏™ bug-fix ÂíåÊñ∞ÁöÑ feature: üêõ Bug fix: Fix rollout status of partitioned update https://github.com/openkruise/kruise-tools/pull/68 Fix ads patch for rollout undo https://github.com/openkruise/kruise-tools/pull/71 üöÄ Feat: Support kubectl-kruise create ContainerRecreateRequest https://github.com/openkruise/kruise-tools/pull/66 Add resourcedistribution generator https://github.com/openkruise/kruise-tools/pull/69. Thanks @dong4325 ÂÖ∂‰∏≠ resourcedistribution generator ÊòØÂºÄÊ∫ê‰πãÂ§èÁöÑ‰∏Ä‰∏™È°πÁõÆÔºå‰∏ªË¶ÅÊòØÁî®Êù•Êñπ‰æøÁî®Êà∑ÁîüÊàê resourceDistrubution ËµÑÊ∫êÁöÑÔºåÂÖ≥‰∫é resouceDistribution ÂíåËøô‰∏™ generator ÂêéÈù¢Á≠âÂäüËÉΩÁ®≥ÂÆöÂêéÂÜçÂ§öÂÅö‰ªãÁªç„ÄÇ Â•Ω‰∫ÜÔºå‰ª•‰∏ä„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022-41 homebrew formula example for go]]></title>
    <url>%2F2022%2F10%2F06%2Fhomebrew-formula-example-for-go%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÂáÜÂ§áÂ∞Ü bendsql ÂèëÂ∏ÉÂà∞ homebrew ÁöÑ repoÔºåËøôÊ†∑Â∞±ÂèØ‰ª•‰ΩøÁî® brew install bendsql Êñπ‰æøÂú∞ÂÆâË£Ö bendsql ‰∫Ü„ÄÇÂèëÂ∏ÉÁöÑÊñπÂºèÂ∞±ÊòØ‰∏∫ bendsql ÂÜô‰∏Ä‰∏™ formula Âπ∂Êèê pr Âà∞ homebrew-coreÔºåÂú®Ê≠§ËÆ∞ÂΩï‰∏Ä‰∏ãÂ¶Ç‰ΩïÁîüÊàê homebrew formula„ÄÇ ËØ¥Âπ≤Â∞±Âπ≤Ôºå fork ‰∫Ü homebrew-core ÁöÑ repo ÁÑ∂Âêé checkout ÂàÜÊîØÂáÜÂ§áÊèê PR„ÄÇ ÊâßË°å brew create $download_URL ÊâßË°åÂêé‰ºöÁîüÊàê install Ê®°ÊùøÔºåÊ†πÊçÆÊ®°ÊùøÂ°´ÂÜôÈúÄË¶ÅÁöÑ‰ø°ÊÅØ„ÄÇ 123456789101112131415161718class Bendsql &lt; Formula desc "Work seamlessly with Databend Cloud from the command line." homepage "https://github.com/databendcloud/bendsql" url "https://github.com/databendcloud/bendsql/releases/download/v0.0.2/bendsql-darwin-amd64.tar.gz" sha256 "25c1a2a4e1922261535325634a939fe42a0ffcc12ae6c262ed7021dab611f622" license "MIT" head "https://github.com/databendcloud/bendsql.git", branch: "main" depends_on "go" =&gt; :build def install system "go", "build", *std_go_args(ldflags: "-s -w") end test do system "make test" endend Ê†πÊçÆ homebrew-core ÁöÑÊñáÊ°£ÔºåÂú®Êèê PR ‰πãÂâçË¶ÅÂÆåÊàêÂá†‰∏™ÂâçÁΩÆÊìç‰ΩúÔºö ÂΩìÊâßË°åÂà∞ brew test bendsql ÁöÑÊó∂ÂÄôÔºåÂèëÁé∞Âêë homebrew ÂÆòÊñπ‰ªìÂ∫ìÊèê‰∫§Â∫îÁî®ÊòØÈúÄË¶ÅÊª°Ë∂≥‰∏ÄÂÆöÊù°‰ª∂ÁöÑÔºö bendsql ÂàöÂºÄÊ∫ê‰∏ÄÂë®ËøòÊ≤°Êª°Ë∂≥‰ª•‰∏äÊù°‰ª∂ÔºåÊâÄ‰ª•Ê≤°Ê≥ïÁõ¥Êé•‰ΩøÁî® brew install bendsqlÔºåÂè™ËÉΩÂè¶ËæüËπäÂæÑ‰∫Ü„ÄÇ ÊÉ≥Ëµ∑Êù•‰πãÂâçÂÜôÂÖ∂‰ªñÂ∑•ÂÖ∑ÁöÑÊó∂ÂÄôÔºåÂè™Ë¶ÅÂú®Ëá™Â∑±ÁöÑË¥¶Êà∑‰∏≠ÂàõÂª∫‰∏Ä‰∏™ homebrew-tap ÁöÑ repo, ÊØîÂ¶Ç https://github.com/hantmac/homebrew-tap, Â∞±ËÉΩÂÆûÁé∞Á±ª‰ººÁöÑ‰∏ãËΩΩÊïàÊûú„ÄÇ ÊâÄ‰ª•Âè™Ë¶ÅÂú® databendcloud ÁöÑË¥¶Êà∑‰∏ãÔºåÊñ∞Âª∫‰∏Ä‰∏™ËøôÊ†∑ÁöÑ repoÔºåÂ∞Ü‰∏äÈù¢ÈÖçÂ•ΩÁöÑ formula Êèê‰∫§ËøõÂéªÂ∞±ÂèØ‰ª• brew tap databendcloud/homebrew-tap &amp;&amp; brew install bendsql ÂæàÊñπ‰æøÂú∞‰∏ãËΩΩ‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
        <tag>homebrew</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 40 Open source weekly report]]></title>
    <url>%2F2022%2F09%2F25%2F2022-40-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[ËÉåÊôØ‰∏çÁü•‰∏çËßâ Weekly report Â∑≤ÊãñÊõ¥‰∏âÂë®ÔºåÈô§‰∫ÜÊó•Â∏∏ÂøôÁ¢å‰πãÂ§ñÔºå‰πüÊòØËßâÂæóÊ≤°Êúâ‰ªÄ‰πàÁâπÂà´ÂÄºÂæóÂÜôÁöÑ„ÄÇÂÖ´Êúà‰∏≠Êó¨ÁöÑÊó∂ÂÄôÂºÄÂßãÁùÄÊâãÂÜô‰∏Ä‰∏™Â∑•ÂÖ∑ - bendsqlÔºàËßÅ33 weekly reportÔºâÔºåÁî®Êù•Â∏ÆÂä©Áî®Êà∑Êõ¥È´òÊïàÂú∞Êìç‰Ωú Databend CloudÔºåÂΩìÊó∂ÊòØÁî®‰∫ÜÂ§ßÊ¶Ç‰∏ÄÂë®ÁöÑÊó∂Èó¥ÂÆåÊàê‰∫ÜËøô‰∏™È°πÁõÆÔºåÁªèËøáÂá†Âë®ÁöÑÂÜÖÈÉ®‰ΩøÁî®ÂíåËø≠‰ª£ÔºåÁé∞Âú®Â∑≤ÁªèË¢´Áî®Âú® perf test Âíå e2e test ‰∏≠ÔºåË∑ëÂæóËøòÁÆóÁ®≥ÂÆöQUQÔºåÊâÄ‰ª•ÂÜ≥ÂÆöÊú¨Âë®Â∞ÜÂÖ∂ÂºÄÊ∫êÔºåËÆ©Êõ¥Â§öÁöÑÁî®Êà∑/ÂºÄÂèëËÄÖ‰ΩøÁî®Âπ∂ÂèÇ‰∏éÂà∞‰∫ßÂìÅÁöÑÂºÄÂèë‰∏≠„ÄÇ bensql Âú®ËøôÈáåÂÖàÁÆÄÂçï‰ªãÁªç‰∏Ä‰∏ã Databend Cloud: Databend Cloud Áî± Databend Âº∫ÂäõÈ©±Âä®ÔºåÊòØ‰∏ÄÊ¨æÂü∫‰∫é Databend ÂÜÖÊ†∏ÊâìÈÄ†ÁöÑ SAAS ‰∫ëÊï∞‰ªìÂπ≥Âè∞ÔºåÂÖ∑ÊúâÁÆÄÂçï„ÄÅÂºπÊÄß„ÄÅÂÆâÂÖ®„ÄÅÈÄüÂ∫¶Âø´„ÄÅÊàêÊú¨‰ΩéÁ≠âÁâπÊÄßÔºå‰∏ìÊ≥®‰∫é‰∫ëÁ´ØÂ§ßÊï∞ÊçÆ‰∏ÄÁ´ôÂºèËß£ÂÜ≥ÊñπÊ°àÔºå‰ª•Ëß£ÂÜ≥‰º†ÁªüÂ§ßÊï∞ÊçÆÈ°πÁõÆ‰∏≠ËøêÁª¥ÈöæÔºåÊàêÊú¨È´òÔºå‰ΩøÁî®Â§çÊùÇÁöÑÈóÆÈ¢ò„ÄÇ bendsql ÊòØ‰∏Ä‰∏™‰∏∫ Databend Cloud ÊâìÈÄ†ÁöÑ Cli Â∑•ÂÖ∑ÔºåËÉΩÂ§üÂ∏ÆÂä©Áî®Êà∑È´òÊïàÂú∞Êìç‰ΩúÊï∞‰ªìÂπ≥Âè∞ÔºåÊØîÂ¶Ç list/create/delete warehouse, list stage, upload Êñá‰ª∂ÔºåÊâßË°å SQL Á≠âÔºåÊèê‰æõË∑ü web È°µÈù¢Ëøë‰πé‰∏ÄËá¥ÁöÑ‰ΩìÈ™å„ÄÇ How to useÂú®‰ΩøÁî® bendsql ‰πãÂâçÔºåÈúÄË¶ÅÁé∞Âú® Databend Cloud ‰∏äÁî≥ËØ∑Ê≥®ÂÜåË¥¶Âè∑ÔºåÁÑ∂ÂêéÂú® ‰∏ãËΩΩÈ°µÈù¢ ÊâæÂà∞ÂØπÂ∫îÂπ≥Âè∞ÁöÑ‰∫åËøõÂà∂ÂåÖ‰∏ãËΩΩÂÆâË£Ö„ÄÇ auth loginÈ¶ñÂÖàÁî®Ê≥®ÂÜåÁöÑË¥¶Âè∑ÁôªÂΩï, 1bendsql auth login ÁôªÂΩïËøáÁ®ã‰∏≠ÈÄâÊã©ÈúÄË¶Å‰ΩøÁî®ÁöÑÁªÑÁªáÔºåÁõ¥Êé•ÂõûËΩ¶‰ΩøÁî®ÈªòËÆ§ÁªÑÁªá„ÄÇÂΩìÁÑ∂ÔºåÁôªÂΩïÂêé‰πüÂèØ‰ª•‰ΩøÁî® bendsql configure --org YOURORG Êù•‰øÆÊîπ„ÄÇ Êìç‰Ωú warehouse‰ΩøÁî® bendsql Â∞±ÂèØ‰ª•ÂÆåÊàêÂØπ warehouse ÁöÑÊâÄÊúâÊìç‰ΩúÔºå12345678910111213141516USAGE bendsql warehouse cmd [flags]CORE COMMANDS create: Create a warehouse delete: Delete a warehouse ls: show warehouse list resume: Resume a warehouse status: show warehouse status suspend: Suspend a warehouseINHERITED FLAGS --help Show help for commandLEARN MORE Use 'bendsql &lt;command&gt; &lt;subcommand&gt; --help' for more information about a command. ÂèÇËÄÉ‰ΩøÁî®ÊñáÊ°£Âç≥ÂèØÔºåËøôÈáåÂ∞±‰∏çËØ¶ÁªÜÂ±ïÂºÄ‰∫Ü„ÄÇ Êìç‰Ωú stage1234567891011121314Operate stageUSAGE bendsql stage &lt;command&gt; [flags]CORE COMMANDS ls: List stage or files in stage upload: Upload file to stage using warehouseINHERITED FLAGS --help Show help for commandLEARN MORE Use 'bendsql &lt;command&gt; &lt;subcommand&gt; --help' for more information about a command. ÂèØ‰ª•‰ΩøÁî® bendsql ÂæàÊñπ‰æøÂú∞Â∞ÜÊñá‰ª∂‰∏ä‰º†Âà∞ stage ‰∏≠„ÄÇ‰πüÂèØ‰ª•Êü•ÁúãÁõÆÊ†á stage ‰∏≠ÁöÑÊñá‰ª∂ÊÉÖÂÜµ„ÄÇ Exec SQL bendsql ÂèØ‰ª•Êù•ÊâßË°å SQL ËØ≠Âè•Ôºå ÂÅáÂ¶Ç‰Ω†ÊâßË°åÁöÑ SQL ËØ≠Âè•ÊØîËæÉËÄóË¥πËµÑÊ∫êÔºåÂèØ‰ª•Âú®ÊâßË°å SQL ÁöÑÂêåÊó∂ÊåáÂÆö‰ΩøÁî®Êõ¥Â§ßËßÑÊ†ºÁöÑ warehouse,1bendsql query --sql YOURSQL --warehouse WAREHOUSE ‰ΩÜÊòØËøôÁßçÊâßË°å SQL ÁöÑÊñπÂºèÂØπÁî®Êà∑Êù•ËØ¥‰∏çÂ§™ÂèãÂ•ΩÔºåÂêéÈù¢ÁöÑ RoadMap ‰∏≠‰ºöËÄÉËôëÊîØÊåÅ bendsql query Â∞±ËøõÂÖ•Âà∞‰∫§‰∫íÂºè SQL ÁöÑÁéØÂ¢É‰∏≠ÔºåÂÜçÊîØÊåÅÂëΩ‰ª§Ë°•ÂÖ®ÂêéÔºå‰ΩìÈ™åÂ∞±Â§ßÂπÖÊèêÂçá‰∫Ü„ÄÇ ÂÖ≥‰∫é‰ΩøÁî®Â∞±ÂÖà‰ªãÁªçËøô‰∫õÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•‰∏ãËΩΩÂÆâË£Ö bendsql -h ÂêéÁªßÁª≠Êé¢Á¥¢„ÄÇ ÂΩ©Ëõã‚ùÄ ÊúÄÂºÄÂßãÁöÑÊó∂ÂÄôËøô‰∏™Â∑•ÂÖ∑Âπ∂‰∏çÊòØÂè´ bendsql ÔºåËÄåÊòØ bendctlÔºåÂ§ßÂÆ∂ËßâÂæó bendctl Ëøô‰∏™ÂëΩÂêçÂ§™Ëøá‰∫éÂ∑•Á®ãÂ∏àÂåñ‰∫Ü =.=ÔºåÁªèËøáËÆ®ËÆ∫ÊúÄÂêéÊîπ‰∏∫ bendsql„ÄÇ ‰ª•‰∏ä„ÄÇÂæÄÊúüÊñáÁ´†ÂèØ‰ª•ËÆøÈóÆ https://cloudsjhan.github.io/ ÁªßÁª≠ÈòÖËØª„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 36 Open source weekly report]]></title>
    <url>%2F2022%2F09%2F02%2F2022-36-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[Â∑•‰ΩúÊñ∞ÁöÑÊåëÊàòÊú¨Âë®ÂºÄ‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÈ°πÁõÆ databend-go-driverÔºåÊòØ‰∏ÄÂ•óÁ±ª‰ºº‰∫é gosnowflake ÁöÑÊï∞ÊçÆÂ∫ì SDKÔºå‰∏ªË¶ÅÊòØÂü∫‰∫é Go ÁöÑ database/sql packageÔºåÂÆûÁé∞Áõ∏Â∫îÁöÑ interface Âπ∂Ê≥®ÂÜå databend Âà∞ database/sqlÔºåÂèØ‰ª•‰ΩøÁî®‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂÉèÊìç‰Ωú mysql ‰∏ÄÊ†∑Êìç‰Ωú databend Ôºö 12345678910111213141516171819func main() &#123; dsn, cfg, err := getDSN() if err != nil &#123; log.Fatalf("failed to create DSN from Config: %v, err: %v", cfg, err) &#125; db, err := sql.Open("databend", dsn) if err != nil &#123; log.Fatalf("failed to connect. %v, err: %v", dsn, err) &#125; defer db.Close() query := "SELECT 1" rows, err := db.Exec(query) // no cancel is allowed if err != nil &#123; log.Fatalf("failed to run a query. %v, err: %v", query, err) &#125; fmt.Println(rows.RowsAffected()) fmt.Printf("Congrats! You have successfully run %v with databend DB!\n", query)&#125; ÁõÆÂâçÈ°πÁõÆÁöÑÊû∂Â≠êÊê≠‰∫Ü‰∏Ä‰∏ãÔºåÂ∑≤ÁªèÂÆåÊàêÂü∫Êú¨ÁöÑÊ≥®ÂÜåÂíåÁÆÄÂçïÁöÑ exec ÂäüËÉΩÔºå‰ΩÜË∑ùÁ¶ªÁúüÊ≠£Áîü‰∫ßÂèØÁî®ÊØîËæÉÈÅ•Ëøú„ÄÇ„ÄÇ„ÄÇËøòË¶ÅÂÆûÁé∞ query, rows, async rows Á≠âÂäüËÉΩÔºåÂÆåÊàêËøô‰∫õÂ∑•‰ΩúÂ∞±ÈúÄË¶ÅÂØπ databend ÁöÑÂ∑•‰ΩúÂéüÁêÜ„ÄÅÁªìÊûÑÊúâ‰∏ÄÂÆö‰∫ÜËß£ÔºåÂèØËÉΩÊòØ‰∏Ä‰∏™Â∞èÊåëÊàòQUQ„ÄÇ ÂºÄÊ∫êÊúÄËøëÁî±‰∫éÈ°πÁõÆÈúÄË¶ÅÂèàÁî®‰∫Ü‰∏Ä‰∏ã fuckdbÔºåËøôÊòØ‰∏Ä‰∏™ËÉΩÂ§ü‰∏ÄÈîÆÂ∞Ü mysql schema ËΩ¨ÊàêÂ∏¶ÂêÑÁßç tag ÁöÑ golang struct ÁöÑÂ§ßÂ§ßÊèêÈ´òÂºÄÂèëÊïàÁéáÁöÑÂ∑•ÂÖ∑ÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•Á†îÁ©∂‰∏Ä‰∏ãËøôÈáå‰∏çÂ§ö‰Ωú‰ªãÁªç‰∫Ü„ÄÇ‰∏ªË¶ÅÊòØÂú®ÊâìÂºÄ github È°πÁõÆÈ°µÈù¢ÁöÑÊó∂ÂÄôÂèëÁé∞‰∏Ä‰∏™ÈôàÂπ¥ËÄÅ issueÔºåÁ´üÁÑ∂ÊòØÂéªÂπ¥ 7 Êúà‰ªΩÁî®Êà∑ÊèêÂá∫Êù•ÁöÑÔºåÂõûÊÉ≥Ëµ∑ÂéªÂπ¥ 7 ÊúàÔºåÁ°ÆÂÆûÊòØÂøôÂæóÁÑ¶Â§¥ÁÉÇÈ¢ùÔºàÊáÇÁöÑÈÉΩÊáÇÔºâÔºå‰ΩÜÊ≤°ÊÉ≥Âà∞Ëøô‰∏™ÈóÆÈ¢ò‰∏ÄÊêÅÁΩÆÂ∞±ÊòØ‰∏ÄÂπ¥„ÄÇËøô‰∏™ÈúÄÊ±ÇÊòØÂ∞Ü struct ÁöÑ json tag ‰ªé snake case ËΩ¨Êàê camel caseÔºåÊîπÂä®‰πãÂâçÁîüÊàêÁöÑ‰ª£Á†ÅÊòØËøôÊ†∑ÁöÑÔºö 1234567type structName struct &#123; Age string `gorm:"column:slug" json:"age"` Name string `gorm:"column:name" json:"name"` CreatorID int64 `gorm:"column:creator_id" json:"creator_id"` CreatedAt time.Time `gorm:"column:created_at" json:"created_at"` UpdatedAt time.Time `gorm:"column:updated_at" json:"updated_at"`&#125; snake case Êú¨Ë∫´‰πü‰∏çÁ¨¶Âêà golang ÁöÑ‰ª£Á†ÅÈ£éÊ†ºÔºåÊâÄ‰ª•Â∞±È≤Å‰∫Ü‰∏Ä‰∏™ PR Ëß£ÂÜ≥‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºåËæìÂá∫ÁöÑ struct Â∞±ÊòØÔºö 1234567type structName struct &#123; Age string `gorm:"column:slug" json:"age"` Name string `gorm:"column:name" json:"name"` CreatorID int64 `gorm:"column:creator_id" json:"creatorId"` CreatedAt time.Time `gorm:"column:created_at" json:"createdAt"` UpdatedAt time.Time `gorm:"column:updated_at" json:"updatedAt"`&#125; ÂóØÔºå‰ºòÈõÖ‰∫Ü =.=„ÄÇ ÂÖ∂‰ªñËÆ∞ÂΩï‰∏Ä‰∫õÈöèÊâãÊãçÔºö]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 34 Open source weekly report]]></title>
    <url>%2F2022%2F08%2F22%2F2022-34-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[Â∑•‰Ωúbendctl ‰∏ÄÊúüÁöÑÂ∑•‰ΩúÂ∑≤ÂÆåÊàê 70%ÔºåËøõÂ∫¶‰πãÂø´Âá∫‰πéÊàëÁöÑÊÑèÊñôÔºåÁ≠â‰∏ãÂë®ÂÜôÂÆåÂÜçÊù•ÊÄªÁªìÂíå‰ªãÁªç‰∏Ä‰∏ã„ÄÇ ÁîüÊ¥ªÁêêÁ¢éÁöÑ‰∫ãÊÉÖÂ•ΩÂÉè‰∏ÄÁõ¥‰∏çÊñ≠ÔºåÂπ∂Ê≤°ÊúâÂ§ßÊÆµÁöÑÊó∂Èó¥Êù•ÈòÖËØªÔºåÊó†ÊÑèÈó¥ÂÄíÊòØÂÅ∂ÁÑ∂ÈáçËØª‰∫ÜÂÜØÈ™•ÊâçÁöÑ„ÄäËã¶Â§è„ÄãÔºåÁ™ÅÁÑ∂ÂèëÁé∞Ëá™Â∑±Â∑≤ÁªèÂ•Ω‰πÖÊ≤°ÊúâÈùô‰∏ãÂøÉÊù•ËØªÂÆåËøá‰∏ÄÁØáÊï£Êñá‰∫Ü„ÄÇÊ≠§Êó∂Ê≠£ÂÄºÂåóÊñπ‰∏ÄÂ§úÂÖ•ÁßãÁöÑÂ§©Ê∞îÔºåËØªÁΩ¢ÊñáÁ´†Êõ¥ÊÑüËßâÁßãÊÑèÊ∏êÊµì„ÄÇ Â•ΩÁöÑÊñáÁ´†ËÆ©‰∫∫ÊÑüÂä®ÔºåÂÜçÊÉ≥Ëµ∑ÊúÄËøëË∫´ËæπÂèëÁîüÁöÑ‰∏Ä‰∫õ‰∫ãÊÉÖÔºåË∂äÂèëÂú∞ËßâÂæó Áî∑‰∫∫‰ª¨ÁöÑÁ´•Âπ¥ÂæÄ‰∫ãÂ§ßÂ§öÊòØÂú®Â§èÂ§©Èáå ÊúâÂ§ö‰πàÁöÑË¥¥ÂàáÔºåÂ∫îËØ•ËØ¥Ôºå‰∫∫ÁîüÊúâ‰∏ÄÂçäÁöÑÂø´‰πêÊù•Ëá™Á´•Âπ¥ÔºåÁ´•Âπ¥ÊúâÂ§ßÂçäÁöÑÂø´‰πêÊù•Ëá™Â§èÂ§©ÔºåÂú®Âø´‰πêÁöÑÁ´•Âπ¥ÈáåÔºå‰Ω†Ê†πÊú¨‰∏ç‰ºöÊÑüÂà∞Ëí∏Á¨ºËà¨Â§èÂ§©ÁöÑÈöæËÄê‰∏éÁÖéÁÜ¨„ÄÇËôΩÁÑ∂ÈïøÂ§ßÂêéËøôÁßçÊÑüËßâÊ∏êË°åÊ∏êËøúÔºåÁîöËá≥Âú®Ê≠§ÂêéËâ∞ÈöæÁöÑ‰∫∫ÁîüÈáåÔºå‰Ω†ËÉΩ‰Ωì‰ºöÂà∞‰∏Ä‰∏ùËã¶Â§èËà¨ÁöÑÊªãÂë≥Ôºå‰ΩÜÈÇ£‰∫õÁ´•Âπ¥Â§èÂ§©ÈáåÁöÑÁæéÂ•ΩÁöÑ‰∫ãÁâ©ÊÄªÊòØÂú®ÈªòÈªòÂú∞Ê≤ªÊÑà‰Ω†„ÄÇ Âø´‰πêÊääÊó∂ÂÖâÁº©Áü≠ÔºåËã¶ÈöæÊääÂ≤ÅÊúàÊãâÈïøÔºå‰∏ÄÂ¶ÇËøôÈïøÈïøÁöÑÊ≤°ÊúâÂ∞ΩÂ§¥ÁöÑËã¶Â§è„ÄÇÂÜØÈ™•ÊâçÂú®ÊÄÄÂøµ‰∫ÜÁ´•Âπ¥ÁöÑÁæéÂ•ΩÂêéÔºåÂπ∂Ê≤°ÊúâÊä®Âáª„ÄÅÂéåÊÅ∂ËøôÊ†∑ÁöÑÂ§èÂ§©ÔºåÁõ∏ÂèçÔºå‰ªñËßâÂæó Ëã¶ ÔºåÂéüÊòØÁîüÊ¥ª‰∏≠ÁöÑËúú„ÄÇ‰∫∫ÁîüÁöÑ‰∏ÄÂàáÊî∂Ëé∑ÈÉΩÂéãÂú®ËøôÊ≤âÁî∏Áî∏ÁöÑËã¶Â≠ó‰∏ãÈù¢ÔºåÁÑ∂ËÄå‰∏ÄÂçäÁöÑËã¶Â≠ó‰∏ãËæπÂèàÊòØ‰∏ÄÊó†ÊâÄÊúâ„ÄÇÂΩì‰Ω†Áî®Â∞ΩÂπ≥ÁîüÁöÑÂäõÊ∞îÔºåÊúÄÁªàÊâÄËé∑‰∏éÂàùÂßãÊó∂ÁöÑÊÑøÊúõÁ´üÁÑ∂Âéª‰πãÂçÉÈáå„ÄÇ‰Ω†ËØ•ÊÄé‰πàÊÉ≥Ôºü ÂÜØÈ™•ÊâçÊòØËøôÊ†∑ÊÉ≥ÁöÑÔºåËã¶Â§è-ÂÆÉ‰∏çÊòØÊó†Â∞ΩÂ§¥ÁöÑÊöëÁÉ≠ÁöÑÊäòÁ£®ÔºåËÄåÊòØÊàë‰ª¨È°∂ÁùÄÊØíÊó•Â§¥ÈªòÈªòÂèàÂùöÂøçÁöÑËã¶ÊñóÁöÑÊú¨Ë∫´„ÄÇ‰∫∫ÁîüÁöÑÂäõÈáèÂÖ®ÊòØÂØπÊâãÁªôÁöÑÔºåÈÇ£Â∞±ÊòØË¶ÅÊääÂØπÊâãÁöÑÂéãÂäõÂê∏ÂÖ•Ëá™Â∑±ÁöÑÈ™®Â§¥Èáå„ÄÇÂº∫ËÄÖ‰πãÂäõÊúÄ‰∏ªË¶ÅÁöÑÊòØÊâøÂèóÂäõ„ÄÇÂè™ÊúâÂú®Âå™Â§∑ÊâÄÊÄùÁöÑÊâøÂèó‰∏≠Êâç‰ºöÊÑüÂà∞Ëá™Â∑±Â±û‰∫éÂº∫ËÄÖ„ÄÇÊâÄ‰ª•ÂÜØÈ™•ÊâçÁöÑÂÜô‰Ωú‰∏ÄÂ§ßÂçäÊòØÂú®Â§èÂ≠£ÂÆåÊàêÁöÑ„ÄÇ ÂèØËÉΩÊòØÈÇ£‰∫õÊ≤âÈáçÁöÑ‰∫∫ÁîüÁöÑËã¶Â§èÔºåÁÖÖÈÄ†Âá∫ËøôÊ†∑ÁöÑÊÄßÊ†º‰π†ÊÉØ„ÄÇ ÂîîÔºåÊóß‰π¶‰∏çÂéåÁôæÂõûËØªÔºåÂπ¥ÂπºÊó∂ËØªËøáÁöÑ‰π¶Âú®Ë∞à‰∏ç‰∏äÂ§öÂ∞ëÁîüÊ¥ªÈòÖÂéÜÁöÑÂèëÈÖµ‰∏ã‰πüÊòØËÉΩÂÇ¨ÂåñÂá∫‰∏Ä‰∫õ‰∏ç‰∏ÄÊ†∑ÁöÑÊÑüÊÇü„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 33 Open source weekly report]]></title>
    <url>%2F2022%2F08%2F16%2F2022-33-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[Êú¨Âë®Êó†ÊùÇ‰∫ãÔºå all in bendctl ‚îì( ¬¥‚àÄ` )‚îè. Á™ÅÁÑ∂ÊÑüËßâÂÜô‰ª£Á†ÅÂíåÁõñÊàøÂ≠êÊúâÂºÇÊõ≤ÂêåÂ∑•‰πãÂ¶ô„ÄÇÁõñÊàøÂ≠êÈúÄË¶ÅËä±ÂæàÈïøÁöÑÊó∂Èó¥Êù•ÂùöÂõ∫Âú∞Âü∫ÔºåÊµáÁÅåÊ∑∑ÂáùÂúüÔºåÂú∞Âü∫Áâ¢Èù†Âêé‰∏ÄÂ±Ç‰∏ÄÂ±ÇÂú∞ÁõñÂ∞±‰∫ãÂçäÂäüÂÄç‰∫ÜÔºåÂ¶ÇÊûú‰Ω†Âú∞Âü∫Êê≠Âæó‰∏çÂ•ΩÔºåÁõñÁöÑËøáÁ®ã‰∏≠ËøòË¶ÅÂõûÂ§¥‰øÆË°•Âú∞Âü∫Ôºå‰∏ç‰ªÖÈ°πÁõÆËøõÂ∫¶ÂæàÊÖ¢ÔºåË¥®Èáè‰πüÂæó‰∏çÂà∞‰øùËØÅ„ÄÇÂÜô‰ª£Á†Å‰πüÊòØ‰∏ÄÊ†∑Ôºå‰∏çË¶ÅÁùÄÊÄ•ÂÜôÂäüËÉΩÔºåÊääÂêÑÁßç‰æùËµñ„ÄÅÊ°ÜÊû∂„ÄÅ‰ª£Á†ÅÁªìÊûÑÂÖàÂÜôÂ•ΩÔºåÂú®Ê≠§‰πã‰∏äÂÜçÂÜôÂäüËÉΩÈÄªËæë‰ª£Á†Å‰æøÊâãÂà∞ÊìíÊù•‰∫Ü„ÄÇ ‰∏äÂë®ËØ¥Ë¶ÅÊäΩÂá∫ÁÇπÊó∂Èó¥Áúã‰∏Ä‰∏ãÂºÄÊ∫ê‰πãÂ§èÁöÑ proposal ÁªìÊûúÊîæ‰∫ÜÈ∏ΩÂ≠êÔºåÊú¨Âë®Êó†ËÆ∫Â¶Ç‰Ωï‰πüË¶ÅÂ§öËä±ÁÇπÊó∂Èó¥Âú®‰∏äÈù¢ÔºåÂê¶Âàô‰æøÊúâ‰∏çË¥üË¥£‰ªª‰πãÂ´åQUQ„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 32 Open source weekly report]]></title>
    <url>%2F2022%2F08%2F08%2F2022-32-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[ÂºÄÊ∫êÊú¨Âë®ÂèÇÂä†‰∫ÜÂºÄÊ∫ê‰πãÂ§èÁöÑÂèåÂë®‰ºöÔºåreview ‰∫ÜÂèÇËµõÂêåÂ≠¶ÂÖ≥‰∫é rollout history ÁöÑ ProposalÔºåËøòÊúâËÆ∏Â§öË¶Å‰øÆÊîπÁöÑÂú∞ÊñπÔºåÈöæÂ∫¶ÊÑüËßâÊØîÊÉ≥Ë±°‰∏≠È´òÔºå‰∏ãÂë®Ë¶ÅÂ§öÊäΩÂá∫ÁÇπÊó∂Èó¥Êù•Áúã‰∏Ä‰∏ã‰∫Ü„ÄÇ Â∑•‰Ωú‰æùÊóßÂøôÁ¢åÔºåÊó∂Èó¥Á¥ßÂº†ÊöÇÊó∂‰∏çÂ±ïÂºÄËØ¥‰∫Ü„ÄÇ Â≠¶‰π†&amp;ÁîüÊ¥ªËøôÂë®ÂÄíÊòØË∂ÅÁùÄÂçàÈ•≠Êó∂Èó¥Áúã‰∫Ü‰∏Ä‰∫õ Rust ÁöÑ‰∏úË•øÔºå‰∏ªË¶ÅÊòØ Trait ‰ª•ÂèäÁîüÂëΩÂë®ÊúüÁõ∏ÂÖ≥ÁöÑ„ÄÇTrait ÊúâÁÇπÂÉè Go ÈáåÈù¢ÁöÑ interfaceÔºåimpl ÂéªÂÆûÁé∞ÊñπÊ≥ï„ÄÇÁîüÂëΩÂë®ÊúüÁùÄÂÆûÊòØÊØîËæÉÂ§çÊùÇÔºåÊúâÂáΩÊï∞‰∏≠ÁöÑÁîüÂëΩÂë®ÊúüÔºåÊñπÊ≥ïÁöÑÔºåÂèòÈáèÁöÑ„ÄÇ„ÄÇ„ÄÇ,‰∏ªË¶ÅÊòØ Rust ÁîüÂëΩÂë®ÊúüÁöÑËØ≠Ê≥ï‰πüËÆ©‰∫∫ÁúºËä±QUQ„ÄÇ&lt;`a&gt; Â±ÖÁÑ∂ÊòØÁîüÂëΩÂë®ÊúüÁöÑÊ≥®Ëß£Ôºåu1s1Ôºåugly„ÄÇ1234567fn longest&lt;'a&gt;(x: &amp;'a str, y: &amp;'a str) -&gt; &amp;'a str &#123; if x.len() &gt; y.len() &#123; x &#125; else &#123; y &#125;&#125; AnywayÔºå ÊúüÂæÖËÉΩÊó©Êó•‰∏äÊâãÁî® Rust Âπ≤ÁÇπÂ•ΩÁé©ÁöÑ‰∫ãÊÉÖ (Ôºö„ÄÇ ‰ª•‰∏ä„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 31 Open source weekly report]]></title>
    <url>%2F2022%2F07%2F30%2F2022-31-Open-source-weekly-report-1%2F</url>
    <content type="text"><![CDATA[2022 Âπ¥Á¨¨ 31 Âë®Ôºå‰ª•‰∏ãÊòØÊú¨Âë®ÁöÑÂºÄÊ∫êÂë®Êä•„ÄÇ Êú¨Âë®‰∏ªË¶Å focus Âú® databend cloud Êñ∞ÁâàÊú¨ÁöÑÂäüËÉΩÂÆûÁé∞‰∏äÔºåÂπ∂‰∏îÁî±‰∫éÂØπÁ≥ªÁªüÂíå‰ª£Á†ÅÂÆûÁé∞Áº∫Â∞ëÊ∑±ÂÖ•ÁöÑ‰∫ÜËß£ÔºåÂú®ÂØπ‰∏Ä‰∫õ corner case ÁöÑÂ§ÑÁêÜ‰∏äÊ¨†ËÄÉËôëÔºåÂØºËá¥‰∫Ü‰∏Ä‰∫õÊú¨‰∏çËØ•Âá∫Áé∞ÁöÑ bugÔºåÊµ™Ë¥π‰∫Ü‰∏Ä‰∫õÊó∂Èó¥„ÄÇË≠¶Á§∫Ëá™Â∑±Âú®ËÄÉËôëÈóÆÈ¢òÁöÑÊó∂ÂÄôË¶ÅÂÖ®Èù¢ÔºåÂêåÊó∂‰πüË¶ÅÂ∞ΩÂø´Âú∞ÁÜüÊÇâ databend cloud ÁöÑ‰ª£Á†ÅÁªÜËäÇ„ÄÇ ËøôÈáåÂè™ËÆ∞ÂΩï‰∏Ä‰∏™Â∞èÁöÑÈóÆÈ¢òÔºå‰ΩøÁî® lister ‰ªé k8s ÈõÜÁæ§ get ËµÑÊ∫êÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂØπËøîÂõûÁöÑ err ÂÅö NotFoundErr ÂíåÂÖ∂‰ªñ Error ÁöÑÂà§Êñ≠ÔºåÂ∞§ÂÖ∂ÊòØÂú®Ëé∑ÂèñÂÖ∂‰ªñËµÑÊ∫êÁöÑÊó∂ÂÄôÔºå‰∏çËÉΩÂõ†‰∏∫ NotFoundErr ÁöÑÂ≠êËµÑÊ∫êÂ∞±ËøîÂõûÊä•Èîô„ÄÇ 1r, err := lister.Resources(ns).Get(name) Ë¶ÅÂÅöËøôÊ†∑ÁöÑÂ§ÑÁêÜÔºö12345if err != nil &amp;&amp; errors.IsNotFound(err) &#123; // something&#125;else if err != nil &#123; // return err&#125; ÂºÄÊ∫êÊñπÈù¢Ôºåkubectl-kruise Êèí‰ª∂Êî∂Âà∞‰∫ÜÂºÄÂèëËÄÖ‰∏Ä‰∏™ bug report Ôºå‰∏ªË¶ÅÊòØËØ¥ kubectl-kruise rollout status clone/sample Âú®ÂéüÂú∞ÂçáÁ∫ßÁöÑÂú∫ÊôØ‰∏ã‰ºöÂç°‰∏ªÔºåÂç≥‰ΩøÊâÄÊúâ Pod ÈÉΩÂ∑≤ÁªèÊõ¥Êñ∞ÂÆåÊàêÁ®ãÂ∫è‰πü‰∏ç‰ºöÈÄÄÂá∫„ÄÇËøô‰∏™ÈóÆÈ¢òÊòØÁî±‰∫é rollout status ‰∏≠Áº∫Â∞ëÂØπÂéüÂú∞ÂçáÁ∫ßÂÆåÊàêÁöÑÂà§Êñ≠Êù°‰ª∂Ôºå‰∫éÊòØÂ∞±Êèê‰∫Ü‰∏Ä‰∏™ PR Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ Âè¶Â§ñ‰∏Ä‰∏™ÊîØÊåÅ Openkruise SidecarSet Ê†πÊçÆ namespace selector Ê≥®ÂÖ• Pod ÁöÑ PR Ê≠£Âú® review ‰∏≠ÔºåËøòÈúÄË¶ÅÊ†πÊçÆ reviewer ÁöÑ comment ËøõË°å‰øÆÊîπ„ÄÇ ÁªøÊ†ëÊµìËç´Â§èÊó•ÈïøÔºå‰∏çÁü•‰∏çËßâ‰∏ÉÊúàÂ∑≤ËøëÂ∞æÂ£∞Ôºå‰∏ã‰∏™Âë®Êä•Â∞±ÂÖ´Êúà‰ªΩËßÅ‰∫ÜÔºåÂ§èÂ§©Â§ßÊ¶ÇË¶ÅËøáÂéª‰∫ÜÂêß„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[kubectl kruise - OpenKruise Cli Âà©Âô®]]></title>
    <url>%2F2022%2F07%2F24%2Fkubectl-kruise-OpenKruise-Cli-%E5%88%A9%E5%99%A8%2F</url>
    <content type="text"><![CDATA[]]></content>
      <categories>
        <category>OpenKruise</category>
      </categories>
      <tags>
        <tag>OpenKruise</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2022 NO.30 Open source weekly report]]></title>
    <url>%2F2022%2F07%2F24%2F2022-30-Open-source-weekly-report%2F</url>
    <content type="text"><![CDATA[2022 Âπ¥Á¨¨ 30 Âë®Ôºå‰ª•‰∏ãÊòØÊú¨Âë®ÁöÑÂºÄÊ∫êÂë®Êä•„ÄÇ ‰∫ãÂá∫ÊúâÂõ†Âë®‰∏≠ÁöÑÊó∂ÂÄôÂú® OpenKruise ÂºÄÊ∫êÁ§æÂå∫Áæ§ÈáåÁúãÂà∞ÊúâÂºÄÂèëËÄÖÊèêÂà∞ËÉΩ‰∏çËÉΩÂú® kubectl-kruise Êèí‰ª∂‰∏≠Êèê‰æõ‰∏ÄÁßç‰æøÊç∑ÁöÑÊñπÂºèÔºåËÆ©Áî®Êà∑ËÉΩÂ§üÂø´ÈÄü‰ΩøÁî® ContainerRecreateRequest ÂÆûÁé∞ÂéüÂú∞ÈáçÂêØÂÆπÂô®ÁöÑËÉΩÂäõ„ÄÇ ÂÖ∂ÂÆûËøô‰∏™ÊÉ≥Ê≥ïÊàëÂú®Âæà‰πÖ‰πãÂâçÂ∞±Êúâ‰∫ÜÔºåÂΩìÊó∂ÊêÅÁΩÆ‰∫Ü‰∏Ä‰∏ãÂ∞±Ê∑πÊ≤°Âú®ÁêêÁ¢é‰πã‰∏≠ÔºåËØ¶ËßÅËøô‰∏™ issue„ÄÇË∂ÅÁùÄËøôÂë®Êú´ÁöÑÁ©∫Èó≤ÔºåÊâìÁÆóÊääËøô‰∏™ÂäüËÉΩÂÆûÁé∞‰∏ÄÊää„ÄÇ ËÉåÊôØContainerRecreateRequest ÊòØ OpenKruise Êèê‰æõÁöÑ‰∏ÄÁßçËøêÁª¥Â¢ûÂº∫ÁöÑÁªÑ‰ª∂ÔºåÂèØ‰ª•Â∏ÆÂä©Áî®Êà∑ÈáçÂêØ/ÈáçÂª∫Â≠òÈáè Pod ‰∏≠‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÆπÂô®„ÄÇÂíå Kruise Êèê‰æõÁöÑÂéüÂú∞ÂçáÁ∫ßÁ±ª‰ººÔºåÂΩì‰∏Ä‰∏™ÂÆπÂô®ÈáçÂª∫ÁöÑÊó∂ÂÄôÔºåPod ‰∏≠ÁöÑÂÖ∂‰ªñÂÆπÂô®Ëøò‰øùÊåÅÊ≠£Â∏∏ËøêË°å„ÄÇÈáçÂª∫ÂÆåÊàêÂêéÔºåPod ‰∏≠Èô§‰∫ÜËØ•ÂÆπÂô®ÁöÑ restartCount Â¢ûÂä†‰ª•Â§ñ‰∏ç‰ºöÊúâ‰ªÄ‰πàÂÖ∂‰ªñÂèòÂåñ„ÄÇ ÁõÆÂâçÁî®Êà∑ÂàõÂª∫ CRR ÂÆûÁé∞ÂÆπÂô®ÂéüÂú∞ÈáçÂêØÁöÑÊñπÂºè‰∏ªË¶ÅÊúâ‰∏§ÁßçÊñπÂºèÔºö kubectl apply -f crr.yaml OpenKruise API Ëøô‰∏§ÁßçÊñπÂºèÂØπÈõÜÁæ§ËøêÁª¥‰∫∫ÂëòÊù•ËØ¥ÈÉΩ‰∏çÂ§üÂèãÂ•ΩÔºåËøá‰∫éÁπÅÁêê„ÄÇÊúÄÂ•ΩÁöÑÊñπÂºèÂ∞±ÊòØÂú® terminal ‰∏≠‰ΩøÁî®‰∏ÄË°åÂëΩ‰ª§Â∞±ËÉΩÂàõÂª∫ CRR ÂÆåÊàêÂéüÂú∞ÈáçÂêØ„ÄÇËÄå Kruise-tools ‰∏∫ Kruise ÁöÑÂäüËÉΩÊèê‰æõ‰∫Ü‰∏ÄÁ≥ªÂàóÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºåÂåÖÊã¨ kubectl-kruiseÔºåÂÆÉÁöÑÊòØ kubectl ÁöÑÊ†áÂáÜÊèí‰ª∂„ÄÇÂú®Ëøô‰∏™Êèí‰ª∂‰∏≠ÂèØ‰ª•ÂæàÂÆπÊòìÈõÜÊàêËØ•ÂäüËÉΩ„ÄÇÔºàÂÖ≥‰∫é kubectl-kruise ÂêéÈù¢ÊâìÁÆó‰∏ìÈó®ÂºÄ‰∏ÄÁØáÊñáÁ´†Êù•ËØ¶ÁªÜ‰ªãÁªç„ÄÇ) Á°ÆÂÆöÁõÆÊ†áÈ¶ñÂÖàÊàë‰ª¨ÈúÄË¶Å‰øùËØÅËæìÂÖ•ÁöÑÂèÇÊï∞Â∞ΩÈáèÂ∞ëÔºåÂÖ∂‰ªñÁöÑÂøÖÈ°ªÂèÇÊï∞ÈÉΩÁªôÂà∞ÂêàÁêÜÁöÑÈªòËÆ§ÂÄºÔºå‰ª•‰æøÁî®Êà∑ËÉΩÂ§ü‰ª•ÊúÄÂø´ÁöÑÈÄüÂ∫¶ÂàõÂª∫ CRR ÈáçÂêØÂÆπÂô®ÔºåÊâÄ‰ª•ÊàëÂú®Êèí‰ª∂‰∏≠ÂÆö‰πâ‰∫Ü CRR ÁöÑ‰∏Ä‰∏™ÈªòËÆ§Á≠ñÁï•Ôºö 123456strategy: failurePolicy: Fail orderedRecreate: false unreadyGracePeriodSeconds: 3 activeDeadlineSeconds: 300 ttlSecondsAfterFinished: 1800 Á°ÆÂÆöÊúÄÁªàÁöÑÂëΩ‰ª§‰∏∫Ôºö 1kubectl kruise create ContainerRecreateRequest test-crr --pod=sample-k52bq --containers=nginx ÊâßË°åËøôÊù°ÂëΩ‰ª§Â∞±ÂèØ‰ª•ÈáçÂêØ pod sample-k52bq ‰∏≠ÂêçÂ≠ó‰∏∫ nginx ÁöÑÂÆπÂô®ÔºåÂÖ∂‰∏≠ --containers ‰∏∫‰∏Ä‰∏™ÂàóË°®ÔºåÂ¶ÇÊûú‰∏∫Á©∫Â∞±ÈáçÂêØ pod ‰∏≠ÊâÄÊúâÁöÑÂÆπÂô®ÔºåÂê¶ÂàôÈáçÂêØÊåáÂÆöÂÆπÂô®„ÄÇ Èô§‰∫Ü --pod„ÄÅ--containers ËøòÊîØÊåÅ unreadyGracePeriodSeconds Âíå terminationGracePeriodSecondsÔºåËøô‰∏§‰∏™ÂèÇÊï∞ÈÉΩÊòØÈÄâÂ°´„ÄÇ unreadyGracePeriodSeconds: ÈáçÂª∫ÂêéÊñ∞ÂÆπÂô®Ëá≥Â∞ë‰øùÊåÅËøêË°åËøôÊÆµÊó∂Èó¥ÔºåÊâçËÆ§‰∏∫ËØ•ÂÆπÂô®ÈáçÂª∫ÊàêÂäü terminationGracePeriodSecondsÔºö Á≠âÂæÖÂÆπÂô®‰ºòÈõÖÈÄÄÂá∫ÁöÑÊó∂Èó¥Ôºå‰∏çÂ°´ÈªòËÆ§Áî® Pod ‰∏≠ÂÆö‰πâÁöÑ ÂÆûÁé∞Áõ∏ÂÖ≥ÁöÑ‰ª£Á†ÅÂÆûÁé∞ÂèØ‰ª•Êü•ÁúãËøô‰∏™ PR„ÄÇ ËøôÈÉ®ÂàÜ‰ª£Á†ÅÂêàÂπ∂Âêé‰∏ãÂë®‰ºö release Êñ∞ÁâàÊú¨ÔºåÊÉ≥Ë¶ÅÂ∞ùÈ≤úÁöÑÂêåÂ≠¶ÂèØ‰ª• clone È°πÁõÆÂêéËá™Ë°åÁºñËØë„ÄÇ Á¢éÁ¢éÂøµËøôÁØáÊñáÁ´†ÊòØ weekly-report Á≥ªÂàóÁöÑÁ¨¨‰∏ÄÁØáÔºå‰πãÊâÄ‰ª•ÂºÄÂßãËøô‰∏™Á≥ªÂàóÔºåÁúüÊòØËØ¥Êù•ËØùÈïø„ÄÇÂ∑Æ‰∏çÂ§öÂ∞±ÊòØÂàöÂºÄÂßãÂÜô blog ÁöÑÊó∂ÂÄôÊòØÊÉ≥ÊØèÂë®ÈÉΩËæìÂá∫‰∏ÄÁØáÊúâÁÇπÂ≠êË¥®ÈáèÁöÑÊäÄÊúØÊñáÁ´†ÔºåÂèëÁé∞ËøôÊ†∑Â§™Èöæ‰∫ÜÔºå‰∏ÄÊòØÊ≤°ÊúâËøô‰πàÂ§öÂÜÖÂÆπËæìÂá∫Ôºå‰∫åÊòØÂæàÂÆπÊòìË¢´ÂÖ∂‰ªñÊùÇ‰∫ãÊâì‰π±ÔºåÂæàÈöæÂùöÊåÅ„ÄÇËøôÊ¨°ÂºÄÂßã‰ª•ÂºÄÊ∫êÂë®Êä•ÁöÑÂêç‰πâÂÜôÊØèÂë®ÁöÑ blogÔºåÂÆûÈôÖ‰∏äÊòØÊÉ≥‰ª•‰∏ÄÁßçÈöèÊÑè„ÄÅËá™Áî±ÁöÑÊñπÂºèÔºåËæìÂá∫‰∏ÄÁÇπ‰∏úË•øÔºå‰∏çËÆ°ÁØáÂπÖ‰πü‰∏çËÄÉÁ©∂Ë¥®ÈáèÔºåÂè™‰∏∫ËÆ∞ÂΩïÔºåËøôÊ†∑Â§ßÊ¶ÇËÉΩÂùöÊåÅ‰∏ãÂéªÂêß„ÄÇ ÈÉΩËØ¥Êó•Êã±‰∏ÄÂçíÔºåÊàëÂÖàÂë®Êã±‰∏ÄÂçí„ÄÇ]]></content>
      <categories>
        <category>weekly-report</category>
      </categories>
      <tags>
        <tag>weekly-report</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[OpenKruise Ê∫êÁ†ÅÂàÜÊûê‰πã ResourceDistribution]]></title>
    <url>%2F2022%2F07%2F11%2FOpenKruise-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B-ResourceDistribution%2F</url>
    <content type="text"><![CDATA[OpenKruise ÊòØÂü∫‰∫é CRD ÁöÑÊãìÂ±ïÔºåÂåÖÂê´‰∫ÜÂæàÂ§öÂ∫îÁî®Â∑•‰ΩúË¥üËΩΩÂíåËøêÁª¥Â¢ûÂº∫ËÉΩÂäõÔºåÊú¨Á≥ªÂàóÊñáÁ´†‰ºö‰ªéÊ∫êÁ†ÅÂíåÂ∫ïÂ±ÇÂéüÁêÜ‰∏äËß£ËØªÂêÑ‰∏™ÁªÑ‰ª∂Ôºå‰ª•Â∏ÆÂä©Â§ßÂÆ∂Êõ¥Â•ΩÂú∞‰ΩøÁî®ÂíåÁêÜËß£ OpenKruise„ÄÇËÆ©Êàë‰ª¨ÂºÄÂßã OpenKruise ÁöÑÊ∫êÁ†Å‰πãÊóÖÂêßÔºÅ ÂâçË®Ä]]></content>
      <categories>
        <category>OpenKruise</category>
      </categories>
      <tags>
        <tag>OpenKruise</tag>
        <tag>kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[OpenKruise Ê∫êÁ†ÅÂàÜÊûê‰πã ContainerRecreateRequest]]></title>
    <url>%2F2022%2F07%2F03%2FOpenKruise-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B-ContainerRecreateRequest%2F</url>
    <content type="text"><![CDATA[OpenKruise ÊòØÂü∫‰∫é CRD ÁöÑÊãìÂ±ïÔºåÂåÖÂê´‰∫ÜÂæàÂ§öÂ∫îÁî®Â∑•‰ΩúË¥üËΩΩÂíåËøêÁª¥Â¢ûÂº∫ËÉΩÂäõÔºåÊú¨Á≥ªÂàóÊñáÁ´†‰ºö‰ªéÊ∫êÁ†ÅÂíåÂ∫ïÂ±ÇÂéüÁêÜ‰∏äËß£ËØªÂêÑ‰∏™ÁªÑ‰ª∂Ôºå‰ª•Â∏ÆÂä©Â§ßÂÆ∂Êõ¥Â•ΩÂú∞‰ΩøÁî®ÂíåÁêÜËß£ OpenKruise„ÄÇËÆ©Êàë‰ª¨ÂºÄÂßã OpenKruise ÁöÑÊ∫êÁ†Å‰πãÊóÖÂêßÔºÅ ÂâçË®ÄÂú®‰∏ä‰∏ÄÁØáÊñáÁ´†‰∏≠Êàë‰ª¨Ëß£ËØª‰∫Ü OpenKruise ÂéüÂú∞ÂçáÁ∫ßÁöÑÂéüÁêÜÂíåÁõ∏ÂÖ≥‰ª£Á†ÅÔºåÂú®Ê≠§Âü∫Á°Ä‰∏äÊàë‰ª¨Êù•Á†îÁ©∂‰∏Ä‰∏™Âü∫‰∫éÂéüÂú∞ÂçáÁ∫ßËÉΩÂäõÁöÑÁªÑ‰ª∂ - ContainerRecreateRequest„ÄÇContainerRecreateRequest(‰∏ãÊñáÁÆÄÁß∞ CRR) ËÉΩÂ§üÈáçÂª∫ Pod ‰∏≠‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÆπÂô®„ÄÇËØ•ÂäüËÉΩÂíå Kruise Êèê‰æõÁöÑÂéüÂú∞ÂçáÁ∫ßÁ±ª‰ººÔºåÂΩì‰∏Ä‰∏™ÂÆπÂô®ÈáçÂª∫ÁöÑÊó∂ÂÄôÔºåPod ‰∏≠ÁöÑÂÖ∂‰ªñÂÆπÂô®Ëøò‰øùÊåÅÊ≠£Â∏∏ËøêË°å„ÄÇÈáçÂª∫ÂÆåÊàêÂêéÔºåPod ‰∏≠Èô§‰∫ÜËØ•ÂÆπÂô®ÁöÑ restartCount Â¢ûÂä†‰ª•Â§ñ‰∏ç‰ºöÊúâ‰ªÄ‰πàÂÖ∂‰ªñÂèòÂåñ„ÄÇÂ¶ÇÊûúÊåÇËΩΩ‰∫Ü volume mount ÊåÇËΩΩÂç∑ÔºåÂç∑‰∏≠ÁöÑÊï∞ÊçÆ‰∏ç‰ºö‰∏¢Â§±‰πü‰∏çÈúÄË¶ÅÈáçÊñ∞ÊåÇËΩΩ„ÄÇËøô‰∏™ÂäüËÉΩÂÆûÁé∞‰∫ÜËøêÁª¥ÂÆπÂô®‰∏é‰∏öÂä°ÂÆπÂô®ÁöÑÁÆ°ÁêÜÂàÜÁ¶ªÔºåÊØîÂ¶Ç‰∏Ä‰∏™ Pod ‰∏≠‰ºöÊúâ‰∏ªÂÆπÂô®‰∏≠ËøêË°åÊ†∏ÂøÉ‰∏öÂä°Ôºåsidecar ‰∏≠ËøêË°åËøêÁª¥ÂÆπÂô®ÔºåÊØîÂ¶ÇÊó•ÂøóÊî∂ÈõÜÁ≠â.ÂΩì‰∏öÂä°ÂÆπÂô®ÈúÄË¶ÅÈáçÂêØÁöÑÊó∂ÂÄôÔºå‰º†ÁªüÁöÑÊõ¥Êñ∞ÊñπÂºè‰ºöËÆ©Êï¥‰∏™ Pod ÈáçÂêØ‰ªéËÄåÂØºËá¥ËøêÁª¥ÂÆπÂô®Êó†ÊïÖË¢´ÈáçÂêØ‰ªéËÄå‰∏≠Êñ≠ÊúçÂä°ÔºåËÄå‰ΩøÁî® ContainerRecreateRequest ÂèØ‰ª•ÂÆûÁé∞Âè™ËÆ©ÁâπÂÆöÁöÑÂÆπÂô®ÈáçÂêØÔºåÈ´òÊïàÁöÑÂêåÊó∂Êõ¥Âä†ÂÆâÂÖ®„ÄÇ ‰ªäÂ§©Â∞±ËÆ©Êàë‰ª¨‰ªéÊ∫êÁ†ÅÁöÑËßíÂ∫¶Êù•Áúã‰∏Ä‰∏ã ContainerRecreateRequest ÁöÑÂÆûÁé∞ÂéüÁêÜ„ÄÇ Ê∫êÁ†ÅËß£ËØªÊàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏ãÊï¥‰∏™ CRR ÁöÑ‰ª£Á†ÅÊµÅÁ®ãÊ¶ÇËßàÔºåÂèØ‰ª•ÁúãÂà∞Êï¥‰∏™ËøáÁ®ã‰∏ªË¶ÅÊúâ‰∏â‰∏™ÁªÑ‰ª∂ÂèÇ‰∏éÔºåÂåÖÊã¨ CRR ÁöÑ admission webhookÔºå controller managerÔºå‰ª•ÂèäÊàë‰ª¨‰∏ä‰∏ÄÁØáÂ∞±ÊèêÂà∞ËøáÁöÑÂéüÂú∞ÂçáÁ∫ß‰∏≠ÁöÑÈáçË¶ÅÁªÑ‰ª∂ - kruise-daemon ‰∏≠ÁöÑ crr daemon controller„ÄÇ ÁÑ∂ÂêéÊàë‰ª¨ÂÜçÈÄêÊ≠•ÊãÜÂºÄËÆ≤Ëß£ÊØè‰∏ÄÊ≠•ÁöÑÂÜÖÂÆπ„ÄÇ 1. create CRRÂÖàÁúã‰∏Ä‰∏ã CRR Ëøô‰∏™Ëá™ÂÆö‰πâËµÑÊ∫êÁöÑ schema ÂÆö‰πâ: 123456789101112131415161718apiVersion: apps.kruise.io/v1alpha1kind: ContainerRecreateRequestmetadata: namespace: pod-namespace name: xxxspec: podName: pod-name containers: # Ë¶ÅÈáçÂª∫ÁöÑÂÆπÂô®ÂêçÂ≠óÂàóË°®ÔºåËá≥Â∞ëË¶ÅÊúâ 1 ‰∏™ - name: app - name: sidecar strategy: failurePolicy: Fail # 'Fail' Êàñ 'Ignore'ÔºåË°®Á§∫‰∏ÄÊó¶ÊúâÊüê‰∏™ÂÆπÂô®ÂÅúÊ≠¢ÊàñÈáçÂª∫Â§±Ë¥•Ôºå CRR Á´ãÂç≥ÁªìÊùü orderedRecreate: false # 'true' Ë°®Á§∫Ë¶ÅÁ≠âÂâç‰∏Ä‰∏™ÂÆπÂô®ÈáçÂª∫ÂÆåÊàê‰∫ÜÔºåÂÜçÂºÄÂßãÈáçÂª∫‰∏ã‰∏Ä‰∏™ terminationGracePeriodSeconds: 30 # Á≠âÂæÖÂÆπÂô®‰ºòÈõÖÈÄÄÂá∫ÁöÑÊó∂Èó¥Ôºå‰∏çÂ°´ÈªòËÆ§Áî® Pod ‰∏≠ÂÆö‰πâÁöÑ unreadyGracePeriodSeconds: 3 # Âú®ÈáçÂª∫‰πãÂâçÂÖàÊää Pod ËÆæ‰∏∫ not readyÔºåÂπ∂Á≠âÂæÖËøôÊÆµÊó∂Èó¥ÂêéÂÜçÂºÄÂßãÊâßË°åÈáçÂª∫ minStartedSeconds: 10 # ÈáçÂª∫ÂêéÊñ∞ÂÆπÂô®Ëá≥Â∞ë‰øùÊåÅËøêË°åËøôÊÆµÊó∂Èó¥ÔºåÊâçËÆ§‰∏∫ËØ•ÂÆπÂô®ÈáçÂª∫ÊàêÂäü activeDeadlineSeconds: 300 # Â¶ÇÊûú CRR ÊâßË°åË∂ÖËøáËøô‰∏™Êó∂Èó¥ÔºåÂàôÁõ¥Êé•Ê†áËÆ∞‰∏∫ÁªìÊùüÔºàÊú™ÁªìÊùüÁöÑÂÆπÂô®Ê†áËÆ∞‰∏∫Â§±Ë¥•Ôºâ ttlSecondsAfterFinished: 1800 # CRR ÁªìÊùüÂêéÔºåËøá‰∫ÜËøôÊÆµÊó∂Èó¥Ëá™Âä®Ë¢´Âà†Èô§Êéâ ÁÑ∂ÂêéÂºÄÂßãËµ∞ËØª‰ª£Á†ÅÊµÅÁ®ã„ÄÇ 1.1 Ê£ÄÊü• feature-gateÂΩìÊàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™ CRR ÁöÑÊó∂ÂÄôÔºå‰ºöÊúÄÂÖàÁªèËøá adminssion webhookÔºåwebhook ‰∏≠‰ºöÊúÄÂÖàÊ£ÄÊü•ÂΩìÂâç feature gates ‰∏≠ÊòØÂê¶ÂºÄÂêØ‰∫Ü kruise-daemon ÔºåÂõ†‰∏∫Ëøô‰∏™ÂäüËÉΩ‰æùËµñ‰∫é kruise-daemon ÁªÑ‰ª∂Êù•ÂÅúÊ≠¢ Pod ÂÆπÂô®ÔºåÂ¶ÇÊûú KruiseDaemon feature-gate Ë¢´ÂÖ≥Èó≠‰∫ÜÔºåContainerRecreateRequest ‰πüÂ∞ÜÊó†Ê≥ï‰ΩøÁî®„ÄÇ 123456func (h *ContainerRecreateRequestHandler) Handle(ctx context.Context, req admission.Request) admission.Response &#123; if !utilfeature.DefaultFeatureGate.Enabled(features.KruiseDaemon) &#123; return admission.Errored(http.StatusForbidden, fmt.Errorf("feature-gate %s is not enabled", features.KruiseDaemon)) &#125; ...&#125; 1.2 Ê≥®ÂÖ•ÈªòËÆ§ÂÄºÂπ∂Ê£ÄÊü• PodÂàõÂª∫ CRR ÁöÑÊó∂ÂÄôË¶Å‰∏∫ÂÖ∂Ê≥®ÂÖ•‰∏Ä‰∫õÁâπÂÆöÁöÑÊ†áÁ≠æÔºå‰∏∫ÂêéÈù¢ÊéßÂà∂ÂêØÂä®ÂÆπÂô®ÁöÑÊµÅÁ®ãÂÅöÂáÜÂ§áÔºåÊØîÂ¶ÇÊâì‰∏ä ContainerRecreateRequestPodNameKeyÔºåContainerRecreateRequestActiveKeyÁöÑÊ†áÁ≠æ: 12obj.Labels[appsv1alpha1.ContainerRecreateRequestPodNameKey] = obj.Spec.PodNameobj.Labels[appsv1alpha1.ContainerRecreateRequestActiveKey] = "true" Ê£ÄÊü•ÂΩìÂâçÂ§ÑÁêÜÁöÑ Pod ÊòØÂê¶Á¨¶ÂêàÊõ¥Êñ∞Êù°‰ª∂ÔºåÊØîÂ¶Ç Pod ÊòØÂê¶ÊòØ active ÁöÑÔºö12345func IsPodActive(p *v1.Pod) bool &#123; return v1.PodSucceeded != p.Status.Phase &amp;&amp; v1.PodFailed != p.Status.Phase &amp;&amp; p.DeletionTimestamp == nil&#125; ‰ª•Âèä Pod ÊòØÂê¶Â∑≤ÁªèÂÆåÊàêË∞ÉÂ∫¶ÔºåÂ¶ÇÊûúÊú™ÂÆåÊàêË∞ÉÂ∫¶ÁöÑËØùÂ∞±Êó†Ê≥ïÂÆåÊàêÂéüÂú∞ÈáçÂêØ(Êó†Ê≥ï‰ΩøÁî®ÈÉ®ÁΩ≤Âà∞ËäÇÁÇπ‰∏äÁöÑ kruise-daemon)Ôºö 12345if !kubecontroller.IsPodActive(pod) &#123; return admission.Errored(http.StatusBadRequest, fmt.Errorf("not allowed to recreate containers in an inactive Pod")) &#125; else if pod.Spec.NodeName == "" &#123; return admission.Errored(http.StatusBadRequest, fmt.Errorf("not allowed to recreate containers in a pending Pod")) &#125; 1.3 Â∞Ü Pod ‰∏≠ÁöÑ‰ø°ÊÅØÊ≥®ÂÖ•Âà∞ CRRCRR ÁöÑËøêË°åÈúÄË¶ÅËé∑Âèñ Pod ÁöÑ‰ø°ÊÅØÔºåÊØîÂ¶ÇËé∑Âèñ Pod ‰∏≠ÁöÑ Lifecycle.PreStop ËÆ© kruise-daemon ÊâßË°å preStop hook ÂêéÊääÂÆπÂô®ÂÅúÊéâÔºåËé∑ÂèñÊåáÂÆöÂÆπÂô®ÁöÑ containerID Êù•Âà§Êñ≠ÈáçÂêØÂêé containerID ÁöÑÂèòÂåñÁ≠â„ÄÇ12345678910111213err = injectPodIntoContainerRecreateRequest(obj, pod) if err != nil &#123; return admission.Errored(http.StatusBadRequest, err) &#125;...if podContainer.Lifecycle != nil &amp;&amp; podContainer.Lifecycle.PreStop != nil &#123; c.PreStop = &amp;appsv1alpha1.ProbeHandler&#123; Exec: podContainer.Lifecycle.PreStop.Exec, HTTPGet: podContainer.Lifecycle.PreStop.HTTPGet, TCPSocket: podContainer.Lifecycle.PreStop.TCPSocket, &#125; &#125; ...... 2. CRR controllerÂàõÂª∫ CRR Âπ∂‰∏∫ÂÖ∂Ê≥®ÂÖ•Áõ∏ÂÖ≥‰ø°ÊÅØÂêéÔºåCRR ÁöÑ controller manager Êé•ÁÆ° CRR ÁöÑÊõ¥Êñ∞„ÄÇ 2.1 ÂêåÊ≠• container statusCRR ÁöÑ status ‰∏≠ÂåÖÂê´ÊâÄË¶ÅÈáçÂêØÁöÑ container ÁöÑÁõ∏ÂÖ≥Áä∂ÊÄÅ‰ø°ÊÅØÔºö1234567891011121314151617181920type ContainerRecreateRequestStatus struct &#123; // Phase of this ContainerRecreateRequest, e.g. Pending, Recreating, Completed Phase ContainerRecreateRequestPhase `json:"phase"` // Represents time when the ContainerRecreateRequest was completed. It is not guaranteed to // be set in happens-before order across separate operations. // It is represented in RFC3339 form and is in UTC. CompletionTime *metav1.Time `json:"completionTime,omitempty"` // A human readable message indicating details about this ContainerRecreateRequest. Message string `json:"message,omitempty"` // ContainerRecreateStates contains the recreation states of the containers. ContainerRecreateStates []ContainerRecreateRequestContainerRecreateState `json:"containerRecreateStates,omitempty"`&#125;type ContainerRecreateRequestContainerRecreateState struct &#123; // Name of the container. Name string `json:"name"` // Phase indicates the recreation phase of the container. Phase ContainerRecreateRequestPhase `json:"phase"` // A human readable message indicating details about this state. Message string `json:"message,omitempty"`&#125; CRR controller ‰∏çÊñ≠Êõ¥Êñ∞ container ÁöÑÈáçÂêØ‰ø°ÊÅØÂà∞ status ‰∏≠„ÄÇ 123func (r *ReconcileContainerRecreateRequest) syncContainerStatuses(crr *appsv1alpha1.ContainerRecreateRequest, pod *v1.Pod) error &#123; ...&#125; controller ÂêåÊ≠• container status ÁöÑÈÄªËæëÈùûÂ∏∏ÈáçË¶ÅÔºåÂú®ËøôÈáåÁ¨îËÄÖÊõæÁªèÈÅáÂà∞‰∏Ä‰∏™ËØ°ÂºÇÁöÑÈóÆÈ¢òÔºåÂ∞±ÊòØÂàõÂª∫‰∫ÜÂ•ΩÂá†‰∏™ CRR ÂêéÔºåÂÖ∂‰∏≠Âá†‰∏™ CRR ‰∏ÄÁõ¥Âç°Âú® Recreating ÁöÑÁä∂ÊÄÅÔºåÂç≥‰Ωø container Â∑≤ÁªèÈáçÂêØÂÆåÊàêÊàñËÄÖ TTL Âà∞Êúü‰πü‰∏ç‰ºöÂèëÁîüÂèòÂåñÔºåËØ¶ÊÉÖÂèØ‰ª•ËßÅËøô‰∏™ issue„ÄÇÂéüÂõ†Â∞±ÊòØÂêåÊ≠• container status ÁöÑÈÄªËæëË∑üÊó∂ÈíüÂêåÊ≠•ÊúâÂÖ≥Ôºö 123456789containerStatus := util.GetContainerStatus(c.Name, pod) if containerStatus == nil &#123; klog.Warningf("Not found %s container in Pod Status for CRR %s/%s", c.Name, crr.Namespace, crr.Name) continue &#125; else if containerStatus.State.Running == nil || containerStatus.State.Running.StartedAt.Before(&amp;crr.CreationTimestamp) &#123; // Âè™Êúâ container ÁöÑÂàõÂª∫Êó∂Èó¥Êôö‰∫é crr ÁöÑÂàõÂª∫Êó∂Èó¥ÔºåÊâçËÆ§‰∏∫ crr ÈáçÂêØ‰∫Ü containerÔºåÂÅáÂ¶ÇÊ≠§Êó∂ CRR ÊâÄÂ§ÑËäÇÁÇπÊàñËÄÖ Pod ÊâÄÂú®ËäÇÁÇπÁöÑÊó∂ÈíüÂèëÁîüÊºÇÁßªÔºåÈÇ£ÊúâÂèØËÉΩÂá∫Áé∞ container ÂàõÂª∫ÁöÑÊó∂Èó¥Êó©‰∫é crr ÂàõÂª∫Êó∂Èó¥ÔºåÂç≥‰ΩøËØ• container ÊòØÁî± crr ÊéßÂà∂ÈáçÂêØ„ÄÇ continue &#125; ... ÁªèËøáÊéíÊü•ÂêéÂèëÁé∞Á°ÆÂÆûÊòØÂ•ΩÂ§ö k8s Node ÁöÑ NTP server Âá∫Áé∞ÈóÆÈ¢òÂØºËá¥Êó∂ÈíüÊºÇÁßªÔºåÂÜçÂä†‰∏ä‰∏äËø∞ÁöÑÈÄªËæëÔºåÂ∞±‰∏çÈöæËß£Èáä‰∏∫‰Ωï CRR ‰ºöÂç°‰Ωè‰∏çÂä®‰∫Ü„ÄÇ 2.2 make pod not readyCRR Âú®ÈáçÂêØ container ‰πãÂâç‰ºöÁªô Pod Ê≥®ÂÖ•‰∏Ä‰∏™ v1.PodConditionType - KruisePodReadyConditionType Âπ∂ÁΩÆ‰∏∫ falseÔºå ‰Ωø Pod ËøõÂÖ• not ready Áä∂ÊÄÅÔºå‰ªé service ÁöÑ Endpoint ‰∏äÊëòÊéâÊµÅÈáè„ÄÇ 1234567891011121314151617condition := GetReadinessCondition(newPod) // Ëé∑Âèñ KruisePodReadyConditionType condition if condition == nil &#123; // Â¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆÔºåÂ∞±Êñ∞Âª∫‰∏Ä‰∏™ _, messages := addMessage("", msg) newPod.Status.Conditions = append(newPod.Status.Conditions, v1.PodCondition&#123; Type: appspub.KruisePodReadyConditionType, Message: messages.dump(), LastTransitionTime: metav1.Now(), &#125;) &#125; else &#123;// Â¶ÇÊûúÂ≠òÂú®ËØ• conditionÔºåÂ∞±ÁΩÆ‰∏∫ false changed, messages := addMessage(condition.Message, msg) if !changed &#123; return nil &#125; condition.Status = v1.ConditionFalse condition.Message = messages.dump() condition.LastTransitionTime = metav1.Now() &#125; 3. kruise daemon controllerCRR kruise daemon controller ‰ºöÁõëÂê¨ CRR ËµÑÊ∫êÁöÑ create, update, delete ‰∫ã‰ª∂ÔºåÁÑ∂ÂêéÂú® manage ÂáΩÊï∞‰∏≠Êõ¥Êñ∞ CRR„ÄÇ 3.1 watch CRRCRR controller Â∞Ü update Âíå create ‰∫ã‰ª∂ÈÉΩÂä†ÂÖ•Âà∞ process ÈòüÂàó‰∏≠ÔºåÁ≠âÂæÖÂ§ÑÁêÜ„ÄÇ1234567891011121314151617181920informer.AddEventHandler(cache.ResourceEventHandlerFuncs&#123; AddFunc: func(obj interface&#123;&#125;) &#123; crr, ok := obj.(*appsv1alpha1.ContainerRecreateRequest) if ok &#123; enqueue(queue, crr) &#125; &#125;, UpdateFunc: func(oldObj, newObj interface&#123;&#125;) &#123; crr, ok := newObj.(*appsv1alpha1.ContainerRecreateRequest) if ok &#123; enqueue(queue, crr) &#125; &#125;, DeleteFunc: func(obj interface&#123;&#125;) &#123; crr, ok := obj.(*appsv1alpha1.ContainerRecreateRequest) if ok &#123; resourceVersionExpectation.Delete(crr) &#125; &#125;, &#125;) 3.2 CRR phase to recreatingdaemon controller ÁöÑ‰ª£Á†ÅÂÖ•Âè£Â§ÑÂÖàÊää CRR ÁöÑ phase ËÆæÁΩÆ‰∏∫ ContainerRecreateRequestRecreating1234// once first update its phase to recreatingif crr.Status.Phase != appsv1alpha1.ContainerRecreateRequestRecreating &#123; return c.updateCRRPhase(crr, appsv1alpha1.ContainerRecreateRequestRecreating)&#125; 3.3 wait for unready grace periodCRR ‰∏≠ÁöÑ unreadyGracePeriodSeconds Ë°®Á§∫Âú® 2.2 Ê≠•È™§‰∏≠Â∞Ü Pod ËÆæÁΩÆ‰∏∫ not ready ÂêéÁ≠âÂæÖÂ§ö‰πÖÂÜçÊâßË°å restart container„ÄÇ 12345678// crr_daemon_controller.goleftTime := time.Duration(*crr.Spec.Strategy.UnreadyGracePeriodSeconds)*time.Second - time.Since(unreadyTime) if leftTime &gt; 0 &#123; klog.Infof("CRR %s/%s is waiting for unready grace period %v left time.", crr.Namespace, crr.Name, leftTime) c.queue.AddAfter(crr.Namespace+"/"+crr.Spec.PodName, leftTime+100*time.Millisecond) return nil &#125; 3.4 KillContainerkruise-daemon ‰ºöÊâßË°å preStop hook ÂêéÊääÂÆπÂô®ÂÅúÊéâÔºåÁÑ∂Âêé kubelet ÊÑüÁü•Âà∞ÂÆπÂô®ÈÄÄÂá∫ÔºåÂàô‰ºöÊñ∞Âª∫‰∏Ä‰∏™ÂÆπÂô®Âπ∂ÂêØÂä®„ÄÇ ÊúÄÂêé kruise-daemon ÁúãÂà∞Êñ∞ÂÆπÂô®Â∑≤ÁªèÂêØÂä®ÊàêÂäüË∂ÖËøá minStartedSeconds Êó∂Èó¥ÂêéÔºå‰ºö‰∏äÊä•Ëøô‰∏™ÂÆπÂô®ÁöÑ phase Áä∂ÊÄÅ‰∏∫ Succeeded„ÄÇ12// crr_daemon_controller.go err := runtimeManager.KillContainer(pod, kubeContainerStatus.ID, state.Name, msg, nil) 3.5 Êõ¥Êñ∞ CRRContainerRecreateStates‰∏çÊñ≠Êõ¥Êñ∞ CRR status ‰∏≠ÂÖ≥‰∫é container ÁöÑÁä∂ÊÄÅ‰ø°ÊÅØ - containerRecreateStates„ÄÇ1c.patchCRRContainerRecreateStates(crr, newCRRContainerRecreateStates) 4. ÂÆåÊàê CRR4.1 CRR ÁΩÆ‰∏∫ completedËøôÈÉ®ÂàÜÈÄªËæëÂú® controller manager Âíå kruise daemon ÈÉΩÊúâÔºåËÄå‰∏îÂà§ÂÆö CRR completed ÁöÑÊñπÂºèÊØîËæÉÂ§öÔºåËøôÈáå‰∏æÂá†‰∏™ÂÖ∏ÂûãÁöÑ‰æãÂ≠êÔºö 4.1.1ÂΩìÂÆåÊàêÈáçÂêØ container ÁöÑÊï∞ÈáèË∑ü CRR ‰∏≠ ContainerRecreateStates ÁöÑÊï∞ÁªÑÈïøÂ∫¶‰∏ÄËá¥ÁöÑÊó∂ÂÄôËÆ§‰∏∫Â∑≤ÁªèÂÆåÊàêÊâÄÊúâÂÆπÂô®ÁöÑÈáçÂêØÂ∑•‰ΩúÔºåÂèØ‰ª•Ê†áËÆ∞ CRR ‰∏∫ÂÆåÊàê„ÄÇ123if completedCount == len(newCRRContainerRecreateStates) &#123; return c.completeCRRStatus(crr, "") &#125; 4.1.2ÂΩìÂèëÁé∞ÊúâÂÆπÂô®ÈáçÂêØÂ§±Ë¥•‰∫ÜÔºåÂπ∂‰∏îÁ≠ñÁï•ÊòØ ignore Â∞±Áõ¥Êé•Ê†áËÆ∞Êú¨Ê¨° CRR ‰∏∫ completed„ÄÇ123456case appsv1alpha1.ContainerRecreateRequestFailed: completedCount++ if crr.Spec.Strategy.FailurePolicy == appsv1alpha1.ContainerRecreateRequestFailurePolicyIgnore &#123; continue &#125; return c.completeCRRStatus(crr, "") 4.1.3‰∏äÈù¢‰∏§‰∏™‰æãÂ≠êÈÉΩÊòØÂú® crr_daemon_controller.go ‰∏≠ÁöÑÔºåËøôÈáåÂàó‰∏Ä‰∏™ crr_controller Âà§ÂÆöÂÆåÊàêÁöÑ‰æãÂ≠êÔºö 12345678if crr.Spec.ActiveDeadlineSeconds != nil &#123; leftTime := time.Duration(*crr.Spec.ActiveDeadlineSeconds)*time.Second - time.Since(crr.CreationTimestamp.Time) if leftTime &lt;= 0 &#123; klog.Warningf("Complete CRR %s/%s as failure for recreating has exceeded the activeDeadlineSeconds", crr.Namespace, crr.Name) return reconcile.Result&#123;&#125;, r.completeCRR(crr, "recreating has exceeded the activeDeadlineSeconds") &#125; duration.Update(leftTime) &#125; CRR Âú®ËßÑÂÆöÁöÑ TTL Êó∂Èó¥ÈáåÊ≤°ÊúâÂÆåÊàê‰ªªÂä°Ôºå‰ºöË¢´Âú®ËøôÈáåÊ†áËÆ∞‰∏∫ÂÆåÊàêÔºå‰ΩÜÊòØ‰ºöÊ†áËÆ∞‰∏Ä‰∏™Âê´ÊúâÂ§±Ë¥•‰ø°ÊÅØÁöÑ message„ÄÇ 4.2 Âà∞ÊúüÂà†Èô§ CRRÂ¶ÇÊûú CRR ËÆæÁΩÆ‰∫Ü TTLSecondsAfterFinished Â≠óÊÆµÔºåËææÂà∞ËØ•Êó∂Èó¥ÂêéÔºåÁ≥ªÁªüÂ∞±‰ºöÂ∞Ü CRR Âà†Èô§ÔºåËøôÂØπÂÆöÊúüÊ∏ÖÁêÜÂ∑≤ÁªèÂÆåÊàêÁöÑ CRR ÂæàÊúâÂ∏ÆÂä©„ÄÇ 12345678910if crr.Spec.TTLSecondsAfterFinished != nil &#123; leftTime = time.Duration(*crr.Spec.TTLSecondsAfterFinished)*time.Second - time.Since(crr.Status.CompletionTime.Time) if leftTime &lt;= 0 &#123; klog.Infof("Deleting CRR %s/%s for ttlSecondsAfterFinished", crr.Namespace, crr.Name) if err = r.Delete(context.TODO(), crr); err != nil &#123; return reconcile.Result&#123;&#125;, fmt.Errorf("delete CRR error: %v", err) &#125; return reconcile.Result&#123;&#125;, nil &#125; &#125; ÁªìËØ≠ÊñáÁ´†ÁöÑÁªìÂ∞æÂÜçÊù•ÂõûÈ°æ‰∏Ä‰∏ã CRR ÊòØÂ¶Ç‰ΩïÂú®Âá†‰∏™ÁªÑ‰ª∂Âçè‰Ωú‰πã‰∏ãÂ∑•‰ΩúÁöÑÔºö ‰º†ÁªüÁöÑ Pod ÈáçÂêØÂ∞±ÊòØÂ∞ÜÂéüÊúâÁöÑ Pod Âà†Èô§ÔºåÁ≠âÂæÖÈáçÂª∫Êñ∞ÁöÑ PodÔºåËÄå CRR ÁöÑÂá∫Áé∞‰∏∫Êàë‰ª¨Êèê‰æõ‰∫Ü‰∏ÄÁßçÂÖ®Êñ∞ÁöÑÈáçÂêØÊúçÂä°ÁöÑÊñπÂºè„ÄÇ]]></content>
      <categories>
        <category>OpenKruise</category>
      </categories>
      <tags>
        <tag>OpenKruise</tag>
        <tag>kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[OpenKruise Ê∫êÁ†ÅÂâñÊûê‰πãÂéüÂú∞ÂçáÁ∫ß]]></title>
    <url>%2F2022%2F06%2F19%2FOpenKruise-%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB%E4%B9%8B%E5%8E%9F%E5%9C%B0%E5%8D%87%E7%BA%A7%2F</url>
    <content type="text"><![CDATA[OpenKruise ÊòØÂü∫‰∫é CRD ÁöÑÊãìÂ±ïÔºåÂåÖÂê´‰∫ÜÂæàÂ§öÂ∫îÁî®Â∑•‰ΩúË¥üËΩΩÂíåËøêÁª¥Â¢ûÂº∫ËÉΩÂäõÔºåÊú¨Á≥ªÂàóÊñáÁ´†‰ºö‰ªéÊ∫êÁ†ÅÂíåÂ∫ïÂ±ÇÂéüÁêÜ‰∏äËß£ËØªÂêÑ‰∏™ÁªÑ‰ª∂Ôºå‰ª•Â∏ÆÂä©Â§ßÂÆ∂Êõ¥Â•ΩÂú∞‰ΩøÁî®ÂíåÁêÜËß£ OpenKruise„ÄÇËÆ©Êàë‰ª¨ÂºÄÂßã OpenKruise ÁöÑÊ∫êÁ†Å‰πãÊóÖÂêßÔºÅ 1. ËÉåÊôØOpenKruise ÊòØÈíàÂØπ Kubernetes ÁöÑÂ¢ûÂº∫ËÉΩÂäõÂ•ó‰ª∂ÔºåËÅöÁÑ¶‰∫é‰∫ëÂéüÁîüÂ∫îÁî®ÁöÑÈÉ®ÁΩ≤„ÄÅÂçáÁ∫ß„ÄÅËøêÁª¥„ÄÅÁ®≥ÂÆöÊÄßÈò≤Êä§Á≠âÈ¢ÜÂüü„ÄÇOpenKruise Êèê‰æõÁöÑÁªùÂ§ßÈÉ®ÂàÜËÉΩÂäõÈÉΩÊòØÂü∫‰∫é CRD Êâ©Â±ïÊù•ÂÆö‰πâÔºåÂÆÉ‰ª¨‰∏çÂ≠òÂú®‰∫é‰ªª‰ΩïÂ§ñÈÉ®‰æùËµñÔºåÂèØ‰ª•ËøêË°åÂú®‰ªªÊÑèÁ∫ØÂáÄÁöÑ Kubernetes ÈõÜÁæ§‰∏≠„ÄÇÂÆÉÂåÖÂê´‰∫Ü‰∏ÄÁ≥ªÂàóÂ¢ûÂº∫ÁâàÊú¨ÁöÑ WorkloadsÔºàÂ∑•‰ΩúË¥üËΩΩÔºâÔºåÊØîÂ¶Ç CloneSet„ÄÅAdvanced StatefulSet„ÄÅAdvanced DaemonSet„ÄÅBroadcastJob Á≠â, ÂÆÉ‰ª¨‰∏ç‰ªÖÊîØÊåÅÁ±ª‰ºº‰∫é Kubernetes ÂéüÁîü Workloads ÁöÑÂü∫Á°ÄÂäüËÉΩÔºåËøòÊèê‰æõ‰∫ÜÂ¶ÇÂéüÂú∞ÂçáÁ∫ß„ÄÅÂèØÈÖçÁΩÆÁöÑÊâ©Áº©ÂÆπ/ÂèëÂ∏ÉÁ≠ñÁï•„ÄÅÂπ∂ÂèëÊìç‰ΩúÁ≠â„ÄÇÂÖ∂‰∏≠ÂéüÂú∞ÂçáÁ∫ßÊòØ OpenKruise ÁöÑÊ†∏ÂøÉÂäüËÉΩ, ÂÆÉÂè™ÈúÄË¶Å‰ΩøÁî®Êñ∞ÁöÑÈïúÂÉèÈáçÂª∫ Pod ‰∏≠ÁöÑÁâπÂÆöÂÆπÂô®ÔºåÊï¥‰∏™ Pod ‰ª•ÂèäÂÖ∂‰∏≠ÁöÑÂÖ∂‰ªñÂÆπÂô®ÈÉΩ‰∏ç‰ºöË¢´ÂΩ±Âìç„ÄÇÂõ†Ê≠§ÂÆÉÂ∏¶Êù•‰∫ÜÊõ¥Âø´ÁöÑÂèëÂ∏ÉÈÄüÂ∫¶Ôºå‰ª•ÂèäÈÅøÂÖç‰∫ÜÂØπÂÖ∂‰ªñ Scheduler„ÄÅCNI„ÄÅCSI Á≠âÁªÑ‰ª∂ÁöÑË¥üÈù¢ÂΩ±ÂìçÔºå ÂÉè CloneSet„ÄÅAdvancedStatefulSet„ÄÅAdvancedDaemonSet„ÄÅSidecarSet ÁöÑÁÉ≠Êõ¥Êñ∞Êú∫Âà∂ÔºåContainerRestartRequest Á≠âÂäüËÉΩÈÉΩ‰æùËµñÂéüÂú∞ÂçáÁ∫ß„ÄÇÁêÜËß£ÂéüÂú∞ÂçáÁ∫ß‰πãÂêéÂÜçÂéªÁ†îÁ©∂ÂÖ∂‰ªñÁªÑ‰ª∂Â∞±‰ºö‰∫ãÂçäÂäüÂÄçÔºåÊâÄ‰ª•Êú¨ÊñáÈ¶ñÂÖàÂ∏¶Â§ßÂÆ∂ÂàÜÊûêÂéüÂú∞ÂçáÁ∫ßÁöÑÊ∫êÁ†ÅÔºåÊù•‰∏ÄÁ™•ÂÖ∂Â∫ïÂ±ÇÂéüÁêÜ„ÄÇ ÊúâÂÖ≥ÂéüÂú∞ÂçáÁ∫ßÁöÑ‰ΩøÁî®Âíå‰ªãÁªçÂèØ‰ª•ÂÖàÈòÖËØªËøôÁØáÊñáÊ°£Ôºå‰∏ãÈù¢ËÆ©Êàë‰ª¨ÂºÄÂßãËß£ËØªÊ∫êÁ†Å„ÄÇ 2. Ê∫êÁ†ÅËß£ËØª2.1 Before Pod Update2.1.1 reconcile ÂÖ•Âè£ÂáΩÊï∞Êàë‰ª¨‰ª• CloneSet ‰∏∫‰æãÔºåÂΩì CloneSet Êõ¥Êñ∞ÂêéÔºåÁõ∏Â∫îÁöÑ controller ÊÑüÁü•Âà∞ËµÑÊ∫êÂèòÂåñÔºåÊ≠§Êó∂‰ª£Á†Å‰ºöËµ∞Âà∞ cloneset_controller.go ÁöÑ doReconcile ÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞ÊòØÂ§ÑÁêÜ CloneSet Êõ¥Êñ∞ÁöÑ‰∏ªÂπ≤ÂÖ•Âè£„ÄÇ 1func (r *ReconcileCloneSet) doReconcile(request reconcile.Request) (res reconcile.Result, retErr error) 2.1.2 syncCloneSetÁªèËøá‰∏ÄÁ≥ªÂàóÊ£ÄÊü•ÂêéÔºåÊâßË°åÂà∞ syncCloneSet, ËØ•ÂáΩÊï∞‰∏ªË¶ÅÊòØÂ§ÑÁêÜ CloneSet ÁöÑ scale Âíå update pod ÁöÑÁªÜËäÇ, Êàë‰ª¨ËøôÈáåÂè™ÂÖ≥Ê≥® update Êìç‰Ωú„ÄÇ 12345func (r *ReconcileCloneSet) syncCloneSet( instance *appsv1alpha1.CloneSet, newStatus *appsv1alpha1.CloneSetStatus, currentRevision, updateRevision *apps.ControllerRevision, revisions []*apps.ControllerRevision, filteredPods []*v1.Pod, filteredPVCs []*v1.PersistentVolumeClaim,) error Kruise ‰∏ìÈó®‰∏∫Ëøô‰∏§‰∏™Êìç‰ΩúÂ£∞Êòé‰∫Ü‰∏§‰∏™ interface, 12345678910111213// Interface for managing pods scaleing and updating.type Interface interface &#123; Scale( currentCS, updateCS *appsv1alpha1.CloneSet, currentRevision, updateRevision string, pods []*v1.Pod, pvcs []*v1.PersistentVolumeClaim, ) (bool, error) Update(cs *appsv1alpha1.CloneSet, currentRevision, updateRevision *apps.ControllerRevision, revisions []*apps.ControllerRevision, pods []*v1.Pod, pvcs []*v1.PersistentVolumeClaim, ) error&#125; cloneset_update.go ‰∏≠ÂÆûÁé∞‰∫Ü‰∏äËø∞Êé•Âè£„ÄÇ 1234func (c *realControl) Update(cs *appsv1alpha1.CloneSet, currentRevision, updateRevision *apps.ControllerRevision, revisions []*apps.ControllerRevision, pods []*v1.Pod, pvcs []*v1.PersistentVolumeClaim,) error &#123;&#125; 2.1.3 Pod Áä∂ÊÄÅÊ£ÄÊü•Âú®ÂØπ pod ÊâßË°åÁúüÊ≠£ÁöÑ Update ‰πãÂâçÔºåKruise ÂÅö‰∫ÜÂæàÂ§öÁöÑÊ†°È™åÔºåÊØîÂ¶ÇÊõ¥Êñ∞ pod ÁöÑ lifecycle ÁöÑ stateÔºåËÆæÁΩÆÂèØ‰ª•Êõ¥Êñ∞ÁöÑÊúÄÂ§ßÊï∞ÈáèÔºåËøáÊª§Êéâ‰∏çÁ¨¶Âêà update Êù°‰ª∂ÁöÑ podÁ≠â„ÄÇ‰∏ãÈù¢‰ª£Á†ÅÁöÑÊ≥®Èáä‰∏≠ÁªôÂá∫‰∫ÜËØ¶ÁªÜÁöÑÂàÜÊûê„ÄÇ ÊúâÂÖ≥ lifecycle(ÁîüÂëΩÂë®ÊúüÈí©Â≠ê) ÁöÑÊõ¥Â§ö‰ªãÁªçÔºåÂèØ‰ª•ÁªßÁª≠ÈòÖËØª ËøôÁØáÊñáÊ°£ 12345678910111213141516171819202122232425262728293031323334353637383940for i, pod := range pods &#123; // Âà§Êñ≠ËØ• pod ÊòØÂê¶ÊöÇÂÅúÂçáÁ∫ß if coreControl.IsPodUpdatePaused(pod) &#123; continue &#125; var waitUpdate, canUpdate bool if diffRes.updateNum &gt; 0 &#123; waitUpdate = !clonesetutils.EqualToRevisionHash("", pod, updateRevision.Name) &#125; else &#123; waitUpdate = clonesetutils.EqualToRevisionHash("", pod, updateRevision.Name) &#125; if waitUpdate &#123; switch lifecycle.GetPodLifecycleState(pod) &#123; // ÂáÜÂ§áÂà†Èô§ÁöÑ Pod Â∞±‰∏çÂçáÁ∫ß‰∫Ü case appspub.LifecycleStatePreparingDelete: klog.V(3).Infof("CloneSet %s/%s find pod %s in state %s, so skip to update it", cs.Namespace, cs.Name, pod.Name, lifecycle.GetPodLifecycleState(pod)) // Â∑≤ÁªèÊõ¥Êñ∞ÂÆåÊàêÁöÑ Pod Êó†È°ªÂçáÁ∫ß case appspub.LifecycleStateUpdated: klog.V(3).Infof("CloneSet %s/%s find pod %s in state %s but not in updated revision", cs.Namespace, cs.Name, pod.Name, appspub.LifecycleStateUpdated) canUpdate = true default: if gracePeriod, _ := appspub.GetInPlaceUpdateGrace(pod); gracePeriod != "" &#123; // ÂéüÂú∞ÂçáÁ∫ß‰∏≠Êèê‰æõ‰∫Ü graceful period ÈÄâÈ°πÔºå‰Ωú‰∏∫‰ºòÈõÖÂéüÂú∞ÂçáÁ∫ßÁöÑÁ≠ñÁï•„ÄÇÁî®Êà∑Â¶ÇÊûúÈÖçÁΩÆ‰∫Ü gracePeriodSeconds Ëøô‰∏™Â≠óÊÆµÔºåÊéßÂà∂Âô®Âú®ÂéüÂú∞ÂçáÁ∫ßÁöÑËøáÁ®ã‰∏≠‰ºöÂÖàÊää Pod status Êîπ‰∏∫ not-readyÔºåÁÑ∂ÂêéÁ≠â‰∏ÄÊÆµÊó∂Èó¥ÔºàgracePeriodSecondsÔºâÔºåÊúÄÂêéÂÜçÂéª‰øÆÊîπ Pod spec ‰∏≠ÁöÑÈïúÂÉèÁâàÊú¨„ÄÇ ËøôÊ†∑ÔºåÂ∞±‰∏∫ endpoints-controller Ëøô‰∫õÊéßÂà∂Âô®ÁïôÂá∫‰∫ÜÂÖÖË∂≥ÁöÑÊó∂Èó¥Êù•Â∞Ü Pod ‰ªé endpoints Á´ØÁÇπÂàóË°®‰∏≠ÂéªÈô§„ÄÇ klog.V(3).Infof("CloneSet %s/%s find pod %s still in grace period %s, so skip to update it", cs.Namespace, cs.Name, pod.Name, gracePeriod) &#125; else &#123; canUpdate = true &#125; &#125; &#125; if canUpdate &#123; waitUpdateIndexes = append(waitUpdateIndexes, i) &#125; &#125; ...... // PUB ÊòØ OPenKruise ÁöÑÂèØÁî®ÊÄßÈò≤Êä§ÁªÑ‰ª∂ÔºåÊòØÂéüÁîü PDB ÁöÑÂçáÁ∫ßÁâàÔºåÂú®ÂçáÁ∫ßÁöÑÂú∫ÊôØÈáå‰πüÈúÄË¶ÅÊ£ÄÊü•‰∏Ä‰∏ãÊòØÂê¶Á¨¶Âêà PUB ÁöÑË¶ÅÊ±Ç allowed, _, err := pubcontrol.PodUnavailableBudgetValidatePod(c.Client, pod, pubcontrol.NewPubControl(pub, c.controllerFinder, c.Client), pubcontrol.UpdateOperation, false) ËøôÈáåÊúâÂÖ≥‰∫é PUB ÁöÑËØ¶ÁªÜ‰ªãÁªçÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•ÁªßÁª≠Ê∑±ÂÖ•‰∫ÜËß£„ÄÇ 2.2 Check About Pod Inplace Update2.2.1 ÈÄâÊã© UpdateStrategy = InplaceËøõÂÖ•Âà∞ updatePod ÂáΩÊï∞ÔºåÂºÄÂßãÂçáÁ∫ß Pod„ÄÇË¶ÅÊÉ≥‰ΩøÁî®ÂéüÂú∞ÂçáÁ∫ßÊú∫Âà∂ÔºåÂøÖÈ°ªÂú® CloneSet ÁöÑ Spec ‰∏≠ÊåáÂÆö UpdateStrategy ÁöÑ Type ‰∏∫ InPlaceIfPossible ÊàñËÄÖ InPlaceOnly„ÄÇ1234if cs.Spec.UpdateStrategy.Type == appsv1alpha1.InPlaceIfPossibleCloneSetUpdateStrategyType || cs.Spec.UpdateStrategy.Type == appsv1alpha1.InPlaceOnlyCloneSetUpdateStrategyType &#123; ... &#125; 2.2.2 CanUpdateInPlace Ê£ÄÊü•ÊòØÂê¶Êª°Ë∂≥ÂéüÂú∞ÂçáÁ∫ßÁöÑÊù°‰ª∂ÂΩì Kruise workload ÁöÑÂçáÁ∫ßÁ±ªÂûãÂêç‰∏∫ InplaceOnly ÁöÑÊó∂ÂÄôÔºåË°®Á§∫Âº∫Âà∂‰ΩøÁî®ÂéüÂú∞ÂçáÁ∫ßÔºåÂ¶ÇÊûú‰∏çÊª°Ë∂≥ÂéüÂú∞ÂçáÁ∫ßÊù°‰ª∂ÔºåÂ∞±‰ºöÊä•ÈîôÔºõ Â¶ÇÊûúÊòØ InPlaceIfPossibleÔºåÂÆÉÊÑèÂë≥ÁùÄ Kruise ‰ºöÂ∞ΩÈáèÂØπ Pod ÈááÂèñÂéüÂú∞ÂçáÁ∫ßÔºåÂ¶ÇÊûú‰∏çËÉΩÂàôÈÄÄÂåñÂà∞ÈáçÂª∫ÂçáÁ∫ß„ÄÇ Âè™ÊúâÊª°Ë∂≥‰ª•‰∏ãÁöÑÊîπÂä®Êù°‰ª∂‰ºöË¢´ÂÖÅËÆ∏ÊâßË°åÂéüÂú∞ÂçáÁ∫ßÔºö Êõ¥Êñ∞ workload ‰∏≠ÁöÑ spec.template.metadata.*ÔºåÊØîÂ¶Ç labels/annotationsÔºåKruise Âè™‰ºöÂ∞Ü metadata ‰∏≠ÁöÑÊîπÂä®Êõ¥Êñ∞Âà∞Â≠òÈáè Pod ‰∏ä„ÄÇ Êõ¥Êñ∞ workload ‰∏≠ÁöÑ spec.template.spec.containers[x].imageÔºåKruise ‰ºöÂéüÂú∞ÂçáÁ∫ß Pod ‰∏≠Ëøô‰∫õÂÆπÂô®ÁöÑÈïúÂÉèÔºåËÄå‰∏ç‰ºöÈáçÂª∫Êï¥‰∏™ Pod„ÄÇ ‰ªé Kruise v1.0 ÁâàÊú¨ÂºÄÂßãÔºàÂåÖÊã¨ v1.0 alpha/betaÔºâÔºåÊõ¥Êñ∞ spec.template.metadata.labels/annotations Âπ∂‰∏î container ‰∏≠ÊúâÈÖçÁΩÆ env from Ëøô‰∫õÊîπÂä®ÁöÑ labels/anntationsÔºåKruise ‰ºöÂéüÂú∞ÂçáÁ∫ßËøô‰∫õÂÆπÂô®Êù•ÁîüÊïàÊñ∞ÁöÑ env ÂÄº„ÄÇ Âê¶ÂàôÔºåÂÖ∂‰ªñÂ≠óÊÆµÁöÑÊîπÂä®ÔºåÊØîÂ¶Ç spec.template.spec.containers[x].env Êàñ spec.template.spec.containers[x].resourcesÔºåÈÉΩÊòØ‰ºöÂõûÈÄÄ‰∏∫ÈáçÂª∫ÂçáÁ∫ß„ÄÇ ÂÆåÊàêËøôÈ°πÊ£ÄÊü•ÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ã:1234567891011121314151617func defaultCalculateInPlaceUpdateSpec(oldRevision, newRevision *apps.ControllerRevision, opts *UpdateOptions) *UpdateSpec &#123; ... patches, err := jsonpatch.CreatePatch(oldRevision.Data.Raw, newRevision.Data.Raw) if err != nil &#123; return nil &#125; oldTemp, err := GetTemplateFromRevision(oldRevision) if err != nil &#123; return nil &#125; newTemp, err := GetTemplateFromRevision(newRevision) if err != nil &#123; return nil &#125; ...&#125; defaultCalculateInPlaceUpdateSpec ‰ºöËÆ°ÁÆóÂá∫Êñ∞Êóß‰∏§‰∏™ÁâàÊú¨ÁöÑÂ∑ÆÂºÇÔºåÂ¶ÇÊûú diff ‰∏≠Âè™ÂåÖÂê´Á¨¨2Ê≠•È™§‰∏≠ÁöÑÊîπÂä®ÔºåÂ∞±ÊâßË°åÂéüÂú∞ÂçáÁ∫ß„ÄÇ 2.2.3 Êõ¥Êñ∞ Pod Readiness-gateÁ¨¶ÂêàÂéüÂú∞ÂçáÁ∫ßÊù°‰ª∂ÁöÑ pod ÈÉΩ‰ºöÂú® condition ‰∏≠Â¢ûÂä† InPlaceUpdateReady ÁöÑ ConditionTypeÔºåÂºÄÂßãÂéüÂú∞ÂçáÁ∫ßÁöÑÊó∂ÂÄôÔºåÂ∞ÜËØ•ÂÄºÁΩÆ‰∏∫ falseÔºåÂ¶ÇÊûú Pod ‰∏äÂ±ÇÊúâ Service ÁöÑËØùÔºåÂ∞±‰ºöËá™Âä®Â∞ÜÂáÜÂ§áÂçáÁ∫ßÁöÑ pod ‰ªé Endpoint ‰∏äÊëò‰∏ãÔºåÈÅøÂÖçÂçáÁ∫ßËøáÁ®ã‰∏≠ÊúâÊµÅÈáèÊçüÂ§±„ÄÇ 12345678if containsReadinessGate(pod) &#123; newCondition := v1.PodCondition&#123; Type: appspub.InPlaceUpdateReady, LastTransitionTime: metav1.NewTime(Clock.Now()), Status: v1.ConditionFalse, Reason: "StartInPlaceUpdate", &#125; &#125; 2.3 Begin Inplace update2.3.1 Pod annotation ‰∏≠ËÆ∞ÂΩïÂçáÁ∫ß‰ø°ÊÅØ1234567inPlaceUpdateState := appspub.InPlaceUpdateState&#123; Revision: spec.Revision, UpdateTimestamp: metav1.NewTime(Clock.Now()), UpdateEnvFromMetadata: spec.UpdateEnvFromMetadata, &#125; inPlaceUpdateStateJSON, _ := json.Marshal(inPlaceUpdateState) clone.Annotations[appspub.InPlaceUpdateStateKey] = string(inPlaceUpdateStateJSON) 2.3.2 Ê†πÊçÆÈÖçÁΩÆËÆæÁΩÆ GracefulPeriodÂéüÂú∞ÂçáÁ∫ß‰∏≠Êèê‰æõ‰∫Ü graceful period ÈÄâÈ°πÔºå‰Ωú‰∏∫‰ºòÈõÖÂéüÂú∞ÂçáÁ∫ßÁöÑÁ≠ñÁï•„ÄÇÁî®Êà∑Â¶ÇÊûúÈÖçÁΩÆ‰∫Ü gracePeriodSeconds Ëøô‰∏™Â≠óÊÆµÔºåÊéßÂà∂Âô®Âú®ÂéüÂú∞ÂçáÁ∫ßÁöÑËøáÁ®ã‰∏≠‰ºöÂÖàÊää Pod status Êîπ‰∏∫ not-readyÔºåÁÑ∂ÂêéÁ≠â‰∏ÄÊÆµÊó∂Èó¥ÔºàgracePeriodSecondsÔºâÔºåÊúÄÂêéÂÜçÂéª‰øÆÊîπ Pod spec ‰∏≠ÁöÑÈïúÂÉèÁâàÊú¨„ÄÇ ËøôÊ†∑ÔºåÂ∞±‰∏∫ endpoints-controller Ëøô‰∫õÊéßÂà∂Âô®ÁïôÂá∫‰∫ÜÂÖÖË∂≥ÁöÑÊó∂Èó¥Êù•Â∞Ü Pod ‰ªé endpoints Á´ØÁÇπÂàóË°®‰∏≠ÂéªÈô§„ÄÇ 123456789if spec.GraceSeconds &lt;= 0 &#123; if clone, err = opts.PatchSpecToPod(clone, spec, &amp;inPlaceUpdateState); err != nil &#123; return err &#125; appspub.RemoveInPlaceUpdateGrace(clone) &#125; else &#123; // Put the info into annotation // Ê≠§Â§ÑËÆæÁΩÆ‰∫Ü GracePeriod ÂêéÔºåÊïàÊûú‰ºöÂú® ‰∏äÈù¢ÁöÑ reconcile controller ‰∏≠‰ΩìÁé∞ &#125; 2.3.3 Update PodÂú®ËøôÈáåÂ∞±Ë∞ÉÁî® UpdatePod ÊñπÊ≥ïÂºÄÂßãÁúüÊ≠£ÂØπ Pod ÂÅöÂçáÁ∫ß‰∫Ü„ÄÇ1newPod, updateErr := c.podAdapter.UpdatePod(clone) ‰ª•‰∏äÂéüÂú∞ÂçáÁ∫ßÁõ∏ÂÖ≥ÁöÑÈÄªËæëÈÉΩÊòØÁî± kruise_manager ÁªÑ‰ª∂Ë¥üË¥£ÁöÑÔºå‰ΩÜÊòØÂΩìÊâßË°å UpdatePod ÂêéÔºåKruise_manager Â∞±Âè™Ë¥üË¥£Ê≠£Â∏∏ÁöÑ workload Áä∂ÊÄÅÊõ¥Êñ∞ÔºåContainer ÁöÑÊõ¥Êñ∞Áî±ÂéüÂú∞ÂçáÁ∫ßÁöÑÊ†∏ÂøÉÁªÑ‰ª∂ Kruise-demaon Êé•ÁÆ°„ÄÇ 2.4 kruise_daemonÂΩì Kubelet Êî∂Âà∞‰∏Ä‰∏™ Pod ÂàõÂª∫‰πãÂêéÔºåÈÄöËøá CRIÔºàContainer Runtime InterfaceÔºâ , CNI ‰ª•ÂèäÁ±ª‰ººÁöÑÂÖ¨ÂÖ±Êé•Âè£Ôºà‰æãÂ¶Ç CSIÔºâÊù•Ë∞ÉÁî®Â∫ïÂ±ÇÁúüÊ≠£ÁöÑÊé•Âè£ÂÆûÁé∞ËÄÖÂéªÂÆåÊàêÊìç‰Ωú„ÄÇÂØπ‰∫éÂÆπÂô®ËøêË°åÊó∂Êù•ËØ¥ÔºåÊòØÈÄöËøá CRI Êé•Âè£Ë∞ÉÁî®Â∫ïÂ±ÇÁúüÊ≠£ÁöÑ Runtime ËøêË°åÊó∂Êù•ÂÆåÊàêÂØπÂÆπÂô®ÁöÑÂàõÂª∫ÂíåÂêØÂä®ÈïúÂÉèÊãâÂèñËøô‰∫õÊìç‰Ωú„ÄÇÂÖ∂‰∏≠ CRI ÊòØ Kubernetes1.5 ‰πãÂêéÂä†ÂÖ•ÁöÑ‰∏Ä‰∏™Êñ∞ÂäüËÉΩÔºåÁî±ÂçèËÆÆÁºìÂÜ≤Âå∫Âíå gRPC API ÁªÑÊàêÔºåÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÊòéÁ°ÆÂÆö‰πâÁöÑÊäΩË±°Â±ÇÔºåÂÆÉÁöÑÁõÆÁöÑÊòØÂØπ‰∫é Kubelet ËÉΩÂ±èËîΩÂ∫ï‰∏ã Runtime ÂÆûÁé∞ÁöÑÁªÜËäÇËÄåÂè™ÊòæÁ§∫ÊâÄÈúÄÁöÑÊé•Âè£„ÄÇ Kruise_daemon Â∞±ÊòØ‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑÁªÑ‰ª∂Ôºå‰Ωú‰∏∫ DaemonSet ÈÉ®ÁΩ≤Âà∞ÊØè‰∏™ËäÇÁÇπ‰∏äÔºåÂèØ‰ª•ËøûÊé•Âà∞ËäÇÁÇπ‰∏äÁöÑ CRI APIÔºåÊù•ÊãìÂ±ï Kubernetes ÂÆπÂô®ËøõË°åÊó∂ÁöÑÊìç‰Ωú, ÂÆÉ‰πüÂèØ‰ª•Ë∞ÉÁî® CRI Ëøô‰∏ÄÂ±ÇÊù•ÂÆûÁé∞ Container Runtime Â±ÇÈù¢ÁöÑËÉΩÂäõÔºåÊØîÂ¶ÇÂÆÉÂèØ‰ª•ÊãâÈïúÂÉèÔºåÂèØ‰ª•ÈáçÂêØÂÆπÂô®„ÄÇ 2.4.1 Kruise_daemon ÂÖ•Âè£kruise_daemon ÁöÑÂÖ•Âè£ÂáΩÊï∞Âú® kruise/cmd/daemon/main.go ‰∏≠Ôºå1234d, err := daemon.NewDaemon(cfg, *bindAddr) if err != nil &#123; klog.Fatalf("Failed to new daemon: %v", err) &#125; ËøõÂÖ•Âà∞ NewDaemon ÂáΩÊï∞‰∏≠Áúã‰∏ÄÁúºÔºåÂèëÁé∞Ëøô‰∏™ daemon ÊúçÂä°Êú¨Ë¥®‰∏ä‰πüÊòØÂá†‰∏™ controllerÔºåÁî®Êù•ÁõëÂê¨Áõ∏Â∫îÁöÑ Pod ÂèòÂåñÂπ∂ÊâßË°åÊìç‰Ωú„ÄÇ 1234567891011// kruise/pkg/daemon/daemon.go// Âú®ËøôÈáå‰πüËÉΩÁúãÂà∞ÂæàÂ§öÁªÑ‰ª∂ÈÉΩÂú®Ëøô‰∏™ÂáΩÊï∞‰∏≠Ê≥®ÂÜå‰∫Ü controllerÔºåÂõ†‰∏∫Ëøô‰∫õÁªÑ‰ª∂ÈÉΩ‰æùËµñÂéüÂú∞ÂçáÁ∫ßÁöÑËÉΩÂäõÔºåÊØîÂ¶Ç ImagePull, ContaienrRestartRequest Á≠â„ÄÇif utilfeature.DefaultFeatureGate.Enabled(features.DaemonWatchingPod) &#123; // DaemonWatchingPod enables kruise-daemon to list watch pods that belong to the same node. containerMetaController, err := containermeta.NewController(opts) if err != nil &#123; return nil, fmt.Errorf("failed to new containermeta controller: %v", err) &#125; runnables = append(runnables, containerMetaController) &#125; 2.4.2 ËÆ°ÁÆó PlainHash ÊàñËÄÖ ExtractedEnvFromMetadataHash2.4.2.1 Â¶ÇÊûúÂè™ÊòØ image update ÁöÑËØùÔºåÂè™ÈúÄË¶ÅÊõ¥Êñ∞ image Â≠óÊÆµÔºåkubelet Êù•ÊâßË°å preStop Âíå container restart„ÄÇËøôÊòØÂõ†‰∏∫ Kubelet Âú®ÂàõÂª∫ÊØè‰∏™ÂÆπÂô®Êó∂Ôºå‰ºö‰∏∫ÂÆπÂô®ËÆ°ÁÆó‰∏Ä‰∏™ hash ÂÄºÔºåÂΩì‰∏äÂ±Ç‰øÆÊîπ‰∫ÜÂÆπÂô®ÁöÑ image ‰πãÂêéÔºåKubelet Â∞±ËÆ§‰∏∫ÂÆπÂô®ÁöÑ hash ÂÄºÂèëÁîü‰∫ÜÂèòÂåñ„ÄÇÂΩì Kubelet ÂèëÁé∞ Pod spec ‰∏≠ÂÆπÂô®ÁöÑ hash ÂÄºÂíåÂÆûÈôÖÁöÑÔºåÂ¶Ç container ÂØπÂ∫îÁöÑ hash ÂÄº‰∏ç‰∏ÄËá¥Êó∂ÔºåÂ∞±‰ºöÊääÊóßÁöÑÂÆπÂô®ÂÅúÊéâÔºåÁî®Êñ∞ÁöÑÈïúÂÉèÂÜçÈáçÂª∫Êñ∞ÁöÑÂÆπÂô®Ôºå‰ªéËÄåÂÆûÁé∞ÂÆπÂô®ÁöÑÂéüÂú∞ÂçáÁ∫ßÁöÑËÉΩÂäõ„ÄÇ 2.4.2.2 ‰ªé Kruise v1.0 ÁâàÊú¨ÂºÄÂßãÔºàÂåÖÊã¨ v1.0 alpha/betaÔºâÔºåÊõ¥Êñ∞ spec.template.metadata.labels/annotations Âπ∂‰∏î container ‰∏≠ÊúâÈÖçÁΩÆ env from Ëøô‰∫õÊîπÂä®ÁöÑ labels/anntationsÔºåKruise ‰ºöÂéüÂú∞ÂçáÁ∫ßËøô‰∫õÂÆπÂô®Êù•ÁîüÊïàÊñ∞ÁöÑ env ÂÄº„ÄÇ‰πüÂ∞±ÊòØ‰øÆÊîπÁéØÂ¢ÉÂèòÈáè kruise ‰πüÊîØÊåÅÂéüÂú∞ÈáçÂêØÔºåËøôÈÉ®ÂàÜÂ∑•‰ΩúÂ∞±ÊòØÁî± kruise daemon Êù•ÂÆåÊàêÁöÑÔºåÊ†∏ÂøÉÁöÑ‰ª£Á†ÅÂú® kruise/pkg/daemon/containermeta/container_meta_controller.go ‰∏≠„ÄÇ ÂºÄÂêØ InPlaceUpdateEnvFromMetadata feature gate 1if utilfeature.DefaultFeatureGate.Enabled(features.InPlaceUpdateEnvFromMetadata) ËÆ°ÁÆó ExtractedEnvFromMetadataHash 1containerMeta.Hashes.ExtractedEnvFromMetadataHash, err = envHasher.GetCurrentHash(containerSpec, envGetter) Â∞Ü container ID ‰º†Âà∞ restarter ÁöÑÂ§ÑÁêÜÈòüÂàó‰∏≠ 1c.restarter.queue.AddRateLimited(status.ID) restarter controller ‰∏ìÈó®Áî®Êù•Â§ÑÁêÜÈúÄË¶ÅÂéüÂú∞ÈáçÂêØÁöÑ container ÈòüÂàóÔºåÊ†∏ÂøÉÈÄªËæëÂú® sync ÂáΩÊï∞‰∏≠Ôºå‰∏ä‰∏ÄÊ≠•‰∏≠Âä†Âà∞ÈòüÂàóÁöÑ containerID Â∞±‰ºöÂú®ËøôÈáåË¢´Â§ÑÁêÜ„ÄÇ 1func (c *restartController) sync(containerID kubeletcontainer.ContainerID) error ÊâßË°å killCOntainer 1func (m *genericRuntimeManager) KillContainer(pod *v1.Pod, containerID kubeletcontainer.ContainerID, containerName string, message string, gracePeriodOverride *int64) error KillContainer ‰∏≠Êúâ‰∏§‰∏™ÈáçË¶ÅÁöÑÊìç‰ΩúÔºåÈ¶ñÂÖàË∞ÉÁî®ÂØπÊóßÁöÑ container ÊâßË°å preStop ÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâÔºåÁÑ∂ÂêéË∞ÉÁî®ÂÆπÂô®ËøêË°åÊó∂Êé•Âè£ StopContainerÂ∞ÜÂÆπÂô®ÂÅúÊ≠¢„ÄÇ 1234567// Run the pre-stop lifecycle hooks if applicable and if there is enough time to run itif containerSpec.Lifecycle != nil &amp;&amp; containerSpec.Lifecycle.PreStop != nil &amp;&amp; gracePeriod &gt; 0 &#123; gracePeriod = gracePeriod - m.executePreStopHook(pod, containerID, containerSpec, gracePeriod)&#125; ... err := m.runtimeService.StopContainer(containerID.ID, gracePeriod) ... 2.4.3 kubelet image pull &amp; create containerÂú®‰∏ä‰∏ÄÊ≠•‰∏≠ÂÆπÂô®Ë¢´ÂÅúÊ≠¢ÂêéÔºåkubelet ‰ºöÂºÄÂßãÊñ∞Âª∫ÂÆπÂô®ÔºåÁÑ∂ÂêéÊõ¥Êñ∞ÂÆπÂô®ÁöÑÁä∂ÊÄÅ„ÄÇ 2.4.4 kruise manager ÂêåÊ≠• pod Áä∂ÊÄÅ‰∏éÊ≠§ÂêåÊó∂ÔºåÁõ∏ÂÖ≥ÁöÑ controller ‰πüÂú®ÂêåÊ≠• Pod/workloads ÂçáÁ∫ßÁöÑÁä∂ÊÄÅ„ÄÇ 123if err = r.statusUpdater.UpdateCloneSetStatus(instance, &amp;newStatus, filteredPods); err != nil &#123; return reconcile.Result&#123;&#125;, err &#125; 2.4.5 kubelet Ê†áËÆ∞ Pod ReadyÂÆåÊàêÊõ¥Êñ∞ÂêéÔºåÁî± kubelet Ê†áËÆ∞ Pod ReadyÔºåkruise manager Â∞ÜÁõ∏Â∫îÁöÑ worklod ÂêåÊ≠•‰∏∫Êõ¥Êñ∞ÂÆåÊàê„ÄÇ Ëá≥Ê≠§ÔºåÊï¥‰∏™ÂéüÂú∞ÂçáÁ∫ßÁöÑÊµÅÁ®ãÂ∞±ÂÆåÊàê‰∫Ü„ÄÇ‰∏çÈöæÂèëÁé∞ÔºåÂéüÂú∞ÂçáÁ∫ßÈô§‰∫ÜÁî®Âà∞ÂéüÁîü kubernetes Êèê‰æõÁöÑ informer controller Êú∫Âà∂Â§ñÔºåÊúÄÊ†∏ÂøÉÁöÑ‰πüÊòØÊúÄÊúâ‰∫ÆÁÇπÁöÑÂú∞ÊñπÂ∞±ÊòØÂ∑ßÂ¶ôÂú∞ÂÆûÁé∞‰∫Ü‰∏Ä‰∏™Á±ª‰ºº kubelet ÁöÑ plugin - kruise daemonÔºå ‰∏∫Êàë‰ª¨Êèê‰æõ‰∫Ü‰∏ÄÁßçÂÖ®Êñ∞ÁöÑ Kubernetes ÂÆπÂô®ËøêË°åÊó∂ operations ÁöÑÊãìÂ±ïÊÄùË∑Ø„ÄÇ 3. Ê∫êÁ†ÅÊµÅÁ®ãÂõæ‰ª•‰∏äÁöÑ‰ª£Á†ÅÂèØ‰ª•ÊÄªÁªìÁÆÄÂåñ‰∏∫‰∏ãÈù¢ËøôÂº†ÂõæÔºö 4. ÊÄªÁªìÂéüÂú∞ÂçáÁ∫ßÊòØ OpenKruise ÁöÑÊ†∏ÂøÉËÉΩÂäõÔºåÊòØÂÖ∂‰ªñÁªÑ‰ª∂ÂíåÂäüËÉΩÂÆûÁé∞ÁöÑÂü∫Áü≥„ÄÇ‰∫ÜËß£ÂÖ∂Â∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜÂíåÊ∫êÁ†ÅËÉΩÂ§üÊâ©ÂÆΩËá™Â∑±ÁöÑÊäÄÊúØËßÜÈáéÔºåÂä†Ê∑±ÂØπ kubernetes ÁöÑÁêÜËß£ÔºåÁªôÊàë‰ª¨Êèê‰æõ‰∫Ü‰∏ÄÁßçÊñ∞ÁöÑÊãìÂ±ï kubelet ÁöÑÊñ∞ÊÄùË∑Ø„ÄÇÂêåÊó∂ÔºåÂΩìÊàë‰ª¨Âú®‰ΩøÁî® Openkruise ÈÅáÂà∞ÈóÆÈ¢òÁöÑÊó∂ÂÄôÔºå‰∫ÜËß£Ê∫êÁ†Å‰πüÊúâÂä©‰∫éÈóÆÈ¢òÁöÑÊéíÊü•„ÄÇ]]></content>
      <categories>
        <category>OpenKruise</category>
      </categories>
      <tags>
        <tag>OpenKruise</tag>
        <tag>kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[ÊëòË¶Å]Â¶Ç‰ΩïÊûÑÂª∫ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ì severless ÊúçÂä°?]]></title>
    <url>%2F2022%2F06%2F12%2F%E6%91%98%E8%A6%81-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93-severless-%E6%9C%8D%E5%8A%A1%2F</url>
    <content type="text"><![CDATA[ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ì severless ÊúçÂä°Ë¶ÅÁÇπÊúÄËøëÂú®ËØª‰∏Ä‰∫õÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ì serverless ÊúçÂä°ÂåñÁöÑÊñáÁ´†Ôºå‰ªé‰∏≠ÊÄªÁªìÂá∫‰∏Ä‰∫õÊûÑÂª∫Ê≠§Á±ªÊúçÂä°Èù¢‰∏¥ÁöÑÁóõÁÇπ‰ª•ÂèäÂ¶Ç‰ΩïÁ†¥Â±ÄÁöÑË¶ÅÁÇπÔºåÁÆóÊòØ‰∏Ä‰∏™ËØª‰π¶Á¨îËÆ∞„ÄÇ‰∏ªË¶ÅÂèÇËÄÉÁöÑÊñáÁ´†Êúâ cockroachdb severless Ëß£ËØª, How we built a forever-free serverless SQL database„ÄÇ Â§ßËá¥ÂÜÖÂÆπÊèêÁ∫≤ ‰∏∫‰ªÄ‰πàË¶Å‰∫ëÂéüÁîüÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÂ∫ìÁöÑ scale ËÉΩÂäõÂÜ≥ÂÆö‰∫ÜËøô‰∏™‰∫ßÂìÅÁöÑ‰∏äÈôêÔºåËÄå‰∏ÄÂÆ∂ÂÖ¨Âè∏ËÉΩÁî®Â§öÂ∞ë‰∫∫ÊúçÂä°Â§öÂ∞ëÂÆ¢Êà∑ÁöÑ scale ËÉΩÂäõÔºåÂÜ≥ÂÆö‰∫ÜÂÖ¨Âè∏Ëê•Êî∂ÁöÑ‰∏äÈôê„ÄÇËÄåÁ†¥Â±ÄÁöÑÊñπÂºèÂ∞±ÊòØÊï∞ÊçÆÂ∫ì‰∏ä‰∫ëÔºåÊääÊï∞ÊçÆÂ∫ìÁöÑÊúçÂä°ÂåñÔºåÈôç‰ΩéÈó®Êßõ„ÄÇ ‰∏∫‰ªÄ‰πàË¶Å serverless Âåñserverless ÂçñÊúçÂä°ÁöÑÂΩ¢ÂºèÔºå‰∏Ä‰∏™ÈõÜÁæ§Â∞±ÂèØ‰ª•ÊúçÂä°‚ÄùÊó†Á©∑‚Äù‰∏™ÁßüÊà∑ÔºåÂè™Ë¶ÅÊ≤°ÊúâÂÆûÈôÖÁöÑ‰ΩøÁî®ÔºåÂπ∂‰∏ç‰ºö‰∫ßÁîüÊàêÊú¨„ÄÇÂ§öÂ¢ûÂä†‰∏Ä‰∏™ÁßüÊà∑ÔºåÂÆÉÁöÑËæπÈôÖÊàêÊú¨ÊòØÈõ∂„ÄÇÊâÄ‰ª•Ëøô‰∏™Ê®°ÂºèÊòØ scalable ÁöÑ„ÄÇ ËÄå‰∏∫‰∫ÜÂÆûÁé∞ serverless ÁöÑÁõÆÁöÑÔºå‰∫ëÂéüÁîüÊï∞ÊçÆÂ∫ìÁöÑÊû∂ÊûÑÂ§ßÂ§öÊòØÂ≠òÂÇ®ÂíåËÆ°ÁÆóÂàÜÁ¶ªÁöÑ„ÄÇ Â§öÁßüÊà∑ÁöÑËµÑÊ∫êÈöîÁ¶ªÈóÆÈ¢òÂ¶ÇÊûúÊòØÂ§öÁßüÊà∑ÂÖ±‰∫´ËÆ°ÁÆóÂ±ÇÂíåÂ≠òÂÇ®Â±ÇÔºåÈÇ£Â§çÊùÇ SQL Â∞±‰ºöÂ∞ÜÊï¥‰∏™ÈõÜÁæ§ÁöÑËµÑÊ∫êËÄóÂ∞ΩÔºåÂΩ±ÂìçÂÖ∂‰ªñÁßüÊà∑Ôºõ Â¶ÇÊûúÊòØÊØè‰∏™ÁßüÊà∑Áã¨‰∫´ÂêÑËá™ÁöÑËÆ°ÁÆóÂ±ÇÂíåÂ≠òÂÇ®Â±ÇÔºå‰πüÂ∞±ÊòØÂõûÂà∞‰∫ÜÊØè‰∏™ÁßüÊà∑‰∏ÄÂ•óÈõÜÁæ§ÁöÑÊ®°ÂºèÔºåÊàêÊú¨ÈùûÂ∏∏È´ò„ÄÇ Áªº‰∏äÂõ†Á¥†ÔºåÊØîËæÉÂ•ΩÁöÑÊñπÂºèÊòØÁã¨‰∫´ËÆ°ÁÆóÂ±ÇÔºåÂÖ±‰∫´Â≠òÂÇ®Â±Ç„ÄÇ‰∏äÂ±ÇÁöÑ SQL ÊòØÁßüÊà∑‰πãÈó¥Áâ©ÁêÜÈöîÁ¶ªÁöÑÔºå‰∏ãÈù¢ÁöÑ kv Â≠òÂÇ®ÊòØÁî±ÊâÄÊúâÁßüÊà∑ÂéªÂÖ±‰∫´ÁöÑ„ÄÇ ÂÖ±‰∫´Â≠òÂÇ®‰πãÂêéÔºåÂ¶Ç‰ΩïÂå∫ÂàÜÁßüÊà∑Êï∞ÊçÆÂÖ±‰∫´Â≠òÂÇ®Â±ÇÂêéÔºåÂèØ‰ª•Âú®ËØ∑Ê±ÇÁöÑ key ÁöÑÁºñÁ†Å‰∏≠Ê∑ªÂä† tenant-idÔºåÂ§öÁßüÊà∑Ê®°Âºè‰∏ãÔºåSQL ÁöÑË°®ÁöÑÊï∞ÊçÆÊò†Â∞ÑÊàê kv Êï∞ÊçÆÔºåÊúÄÁªàÁöÑÁºñÁ†ÅÊòØ /tenant-id/table-id/index-id/key„ÄÇ ÈõÜÁæ§Êû∂ÊûÑ ÂêçËØçËß£ÈáäBlock storage: Â§öÁßüÊà∑ÂÖ±‰∫´ÁöÑÂ≠òÂÇ® SQL Pod: ÁßüÊà∑Áã¨‰∫´ÁöÑ SQL ËÆ°ÁÆóËäÇÁÇπ Proxy Pod : Ë¥üË¥£Â∞ÜÁßüÊà∑ÁöÑËØ∑Ê±ÇË∑ØÁî±Âà∞Ê≠£Á°ÆÁöÑ SQL ËäÇÁÇπ‰∏ä ËÆ°ÁÆóËäÇÁÇπÊó†Áä∂ÊÄÅÔºåËøôÊÑèÂë≥ÁùÄ SQL pod ÂèØ‰ª•ÈöèÁî®ÈöèËµ∑Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂΩìÊüê‰∏™ tenant Ê≤°ÊúâÊµÅÈáèÊó∂ÔºåÂÆåÂÖ®ÂèØ‰ª•ÊääÂÆÉÁöÑ SQL ËäÇÁÇπÂÅú‰∏ãÂÖ≥ÊéâÔºåÈúÄË¶ÅÁöÑÊó∂ÂÄôÂÜçÂä®ÊÄÅÊãâËµ∑„ÄÇ ÊãìÂ±ïÈòÖËØª ‰ª•‰∏ä„ÄÇ]]></content>
      <categories>
        <category>kubernetes</category>
      </categories>
      <tags>
        <tag>kubernetes</tag>
        <tag>serverless</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∫ëÂéüÁîüÂ∫îÁî®ÂèëÂ∏ÉÁªÑ‰ª∂ Triton ÂºÄÊ∫ê‰πãÊóÖ]]></title>
    <url>%2F2021%2F09%2F13%2F%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E5%8F%91%E5%B8%83%E7%BB%84%E4%BB%B6-Triton-%E5%BC%80%E6%BA%90%E4%B9%8B%E6%97%85%2F</url>
    <content type="text"><![CDATA[Triton Ê¶ÇËø∞‰º¥ÈöèÁùÄ‰∫ëÂéüÁîüÊäÄÊúØÂú®Ë∂äÊù•Ë∂äÂ§öÁöÑ‰ºÅ‰∏öËêΩÂú∞ÔºåÂ¶Ç‰ªäÁöÑ Kubernetes ÂíåÂÆπÂô®Â∑≤ÁªèÂÆåÂÖ®ËøõÂÖ•‰∏ªÊµÅÂ∏ÇÂú∫ÔºåÊàê‰∏∫‰∫ëËÆ°ÁÆóÁöÑÊñ∞ÁïåÈù¢ÔºåÂ∏ÆÂä©‰ºÅ‰∏öÂÖÖÂàÜ‰∫´Âèó‰∫ëÂéüÁîüÁöÑ‰ºòÂäøÔºåÂä†ÈÄüÂ∫îÁî®Ëø≠‰ª£ÂàõÊñ∞ÊïàÁéáÔºåÈôç‰ΩéÂºÄÂèëËøêÁª¥ÊàêÊú¨„ÄÇ‰ΩÜÂú®ÂêëÁùÄ‰∫ëÂéüÁîüÊû∂ÊûÑËΩ¨ÂûãÁöÑËøáÁ®ã‰∏≠Ôºå‰πüÊúâËÆ∏Â§öÈóÆÈ¢òÈúÄË¶ÅË¢´Ëß£ÂÜ≥„ÄÇÊØîÂ¶ÇÂéüÁîü Kubernetes ÁöÑÂ§çÊùÇÊÄß„ÄÅÂÆπÂô®ÂåñÂ∫îÁî®ÁöÑÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜÔºå‰ª•ÂèäÂêë‰ª•ÂÆπÂô®‰∏∫Âü∫Á°ÄËÆæÊñΩËøÅÁßªÁöÑËøáÁ®ã‰∏≠ÂèØËÉΩÂá∫Áé∞ÁöÑÊúçÂä°Á®≥ÂÆöÊÄßÊåëÊàòÁ≠âÁ≠â„ÄÇ ÂºÄÊ∫ê‰∫ëÂéüÁîüÂ∫îÁî®ÂèëÂ∏ÉÁªÑ‰ª∂ Triton ÁöÑÂá∫Áé∞ÔºåÂ∞±ÊòØ‰∏∫‰∫ÜËß£ÂÜ≥‰ºÅ‰∏öÂ∫îÁî®Âú®ÂÆπÂô®ÂåñËøáÁ®ã‰∏≠ÂÆâÂÖ®ËêΩÂú∞Áîü‰∫ßÁöÑÈóÆÈ¢ò„ÄÇTriton ‰ª• OpenKruise ‰Ωú‰∏∫ÂÆπÂô®Â∫îÁî®Ëá™Âä®ÂåñÂºïÊìéÔºåÂÆûÁé∞Â∫îÁî®Ë¥üËΩΩÁöÑÊâ©Â±ïÂ¢ûÂº∫ËÉΩÂäõÔºå‰∏∫ÂéüÊúâÊåÅÁª≠‰∫§‰ªòÁ≥ªÁªüÂ∏¶Êù•ÂÖ®Èù¢ÂçáÁ∫ßÔºå‰∏ç‰ªÖËß£ÂÜ≥‰∫ÜÂ∫îÁî®ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜÁöÑÈóÆÈ¢òÔºåÂåÖÊã¨ÂºÄÂèë„ÄÅÈÉ®ÁΩ≤„ÄÅËøêÁª¥Á≠âÔºåÂêåÊó∂ÊâìÈÄöÂæÆÊúçÂä°Ê≤ªÁêÜÔºåÂèØ‰ª•Â∏ÆÂä©Á†îÂèëÊèêÂçáÊåÅÁª≠‰∫§‰ªòÁöÑÊïàÁéá„ÄÇ ÊúâÂÖ≥ Trion ËÆæËÆ°ÊñπÊ°à„ÄÅÂÆûÁé∞ÂéüÁêÜÁöÑËØ¶ÁªÜ‰ªãÁªçÂèØ‰ª•ÂèÇËÄÉËøôÁØáÊñáÁ´†„ÄÇÊú¨ÊñáÂ∞Ü‰ªéÊ∫êÁ†ÅÁ∫ßÂÆâË£Ö„ÄÅdebug„ÄÅdemo Â∫îÁî®ÂèëÂ∏ÉÊºîÁ§∫‰∏â‰∏™ÊñπÈù¢‰ªãÁªç Triton ÁöÑÊ†∏ÂøÉÁâπÊÄß‰ª•Âèä Triton ÁöÑÂø´ÈÄü‰∏äÊâã‰ΩøÁî®„ÄÅÂºÄÂèëÔºåÊúÄÂêé‰ªãÁªç Triton ÁöÑ Roadmap„ÄÇÁî±‰∫éÊó∂Èó¥ÂÖ≥Á≥ªÔºå‰∏ÄÈîÆÂÆâË£Ö„ÄÅHelm ÂÆâË£ÖÁöÑÊñπÂºèÊ≠£Âú®ÂºÄÂèë‰∏≠Ôºå‰ºöÂú®Ê≠£ÂºèÁâàÊú¨ release ‰∏≠Êèê‰æõ„ÄÇ Ê†∏ÂøÉËÉΩÂäõÊú¨Ê¨°Â∏¶Êù•ÁöÑ v0.1.0 ÂºÄÊ∫êÁâàÊú¨Âú®‰ª£Á†Å‰∏äËøõË°å‰∫ÜÈáçÊûÑÔºåÊöÇÊó∂ÂéªÊéâ‰∫ÜÂØπÁΩëÁªúÊñπÊ°à„ÄÅÂæÆÊúçÂä°Êû∂ÊûÑÁöÑ‰æùËµñÔºåÊäΩË±°Âá∫Â∫îÁî®Ê®°ÂûãÁöÑÊ¶ÇÂøµÔºåÊõ¥ÂÖ∑Â§áÊôÆÈÄÇÊÄßÔºåÊ†∏ÂøÉÁâπÊÄßÂ¶Ç‰∏ãÔºö ÂÖ®ÊâòÁÆ°‰∫é k8s ÈõÜÁæ§Ôºå‰æø‰∫éÁªÑ‰ª∂ÂÆâË£Ö„ÄÅÁª¥Êä§ÂíåÂçáÁ∫ßÔºõ ÊîØÊåÅ‰ΩøÁî® API Âíå kubectl Êèí‰ª∂ÔºàËßÑÂàí‰∏≠ÔºâÂÆåÊàêÂ∫îÁî®ÂàõÂª∫„ÄÅÈÉ®ÁΩ≤„ÄÅÂçáÁ∫ßÔºåÂπ∂ÊîØÊåÅÂçïÊâπÂèëÂ∏É„ÄÅÂàÜÊâπÂèëÂ∏ÉÂíåÈáë‰∏ùÈõÄÂèëÂ∏ÉÔºõ Êèê‰æõ‰ªéÂàõÂª∫Âà∞ËøêË°åÁöÑÂ∫îÁî®ÂÖ®ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜÊúçÂä°ÔºåÂåÖÊã¨Â∫îÁî®ÁöÑÂèëÂ∏É„ÄÅÂêØÂä®„ÄÅÂÅúÊ≠¢„ÄÅÊâ©ÂÆπ„ÄÅÁº©ÂÆπÂíåÂà†Èô§Á≠âÊúçÂä°ÔºåÂèØ‰ª•ËΩªÊùæÁÆ°ÁêÜ‰∏äÂçÉ‰∏™Â∫îÁî®ÂÆû‰æãÁöÑ‰∫§‰ªòÈóÆÈ¢òÔºõ Triton Êèê‰æõ‰∫ÜÂ§ßÈáè API Êù•ÁÆÄÂåñÈÉ®ÁΩ≤Á≠âÊìç‰ΩúÔºåÂ¶ÇNext„ÄÅCancel„ÄÅPause„ÄÅResume„ÄÅScale„ÄÅGets„ÄÅRestart Á≠âÔºåËΩªÊùæÂØπÊé•ÂÖ¨Âè∏ÂÜÖÈÉ®ÁöÑ PaaS Á≥ªÁªüÔºõ Êìç‰ΩúÊåáÂçó Âú®ÂºÄÂßã‰πãÂâçÔºåÊ£ÄÊü•‰∏Ä‰∏ãÂΩìÂâçÁéØÂ¢ÉÊòØÂê¶Êª°Ë∂≥‰∏Ä‰∏ãÂâçÊèêÊù°‰ª∂: Á°Æ‰øùÁéØÂ¢ÉËÉΩÂ§ü‰∏é kube-apiserver ËøûÈÄöÔºõ Á°Æ‰øù OpenKruise Â∑≤ÁªèÂú®ÂΩìÂâçÊìç‰Ωú k8s ÈõÜÁæ§ÂÆâË£ÖÔºåËã•Êú™ÂÆâË£ÖÂèØ‰ª•ÂèÇËÄÉÊñáÊ°£Ôºõ Á°Æ‰øùÊúâ Golang ÂºÄÂèëÁéØÂ¢ÉÔºåFork &amp; git clone ‰ª£Á†ÅÂêéÔºåÊâßË°å make install ÂÆâË£Ö CRD DeployFlow Ôºõ Êìç‰Ωú API ÁöÑËøáÁ®ã‰∏≠ÈúÄË¶Å grpcurl Ëøô‰∏™Â∑•ÂÖ∑ÔºåÂèÇËÄÉ grpcurl ÊñáÊ°£ËøõË°åÂÆâË£ÖÔºõ ÂàõÂª∫ DeployFlow Êù•ÂèëÂ∏É Nginx Demo ApplicationËøêË°å DeployFlow controller ËøõÂÖ•Âà∞‰ª£Á†ÅÊ†πÁõÆÂΩï‰∏ãÊâßË°å make run ÂàõÂª∫ DeployFlow ÂáÜÂ§áÂèëÂ∏ÉÂ∫îÁî® 1kubectl apply -f https://github.com/triton-io/triton/raw/main/docs/tutorial/v1/nginx-deployflow.yaml ‰ºöÂàõÂª∫Âá∫‰∏Ä‰∏™ DeployFlow ËµÑÊ∫êÂíåÊú¨Â∫îÁî®ÂØπÂ∫îÁöÑ ServiceÔºåÂèØ‰ª•Êü•ÁúãËØ• yaml Êñá‰ª∂‰∫ÜËß£ËØ¶ÁªÜÁöÑ DeployFlow ÂÆö‰πâ„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041apiVersion: apps.triton.io/v1alpha1kind: DeployFlowmetadata: labels: app: "12122" app.kubernetes.io/instance: 12122-sample-10010 app.kubernetes.io/name: deploy-demo-hello group: "10010" managed-by: triton-io name: 12122-sample-10010-df namespace: defaultspec: action: create application: appID: 12122 appName: deploy-demo-hello groupID: 10010 instanceName: 12122-sample-10010 replicas: 3 selector: matchLabels: app: "12122" app.kubernetes.io/instance: 12122-sample-10010 app.kubernetes.io/name: deploy-demo-hello group: "10010" managed-by: triton-io template: metadata: &#123;&#125; spec: containers: - image: nginx:latest name: 12122-sample-10010-container ports: - containerPort: 80 protocol: TCP resources: &#123;&#125; updateStrategy: batchSize: 1 batchIntervalSeconds: 10 canary: 1 # the number of canary batch mode: auto # the mode is auto after canary batch ÂèØ‰ª•ÁúãÂà∞Êàë‰ª¨Êú¨Ê¨°ÂèëÂ∏ÉÁöÑÂ∫îÁî®ÂêçÂ≠óÊòØ 12122-sample-10010ÔºåÂâØÊú¨Êï∞ÈáèÊòØ 3ÔºåÊâπÊ¨°Â§ßÂ∞èÊòØ 1ÔºåÊúâ‰∏Ä‰∏™Èáë‰∏ùÈõÄÊâπÊ¨°ÔºåÊâπÊ¨°Â§ßÂ∞èÊòØ 1ÔºåÂèëÂ∏ÉÁöÑÊ®°ÂºèÊòØ autoÔºåÊÑèÂë≥ÁùÄÊú¨Ê¨°ÂèëÂ∏ÉÂè™‰ºöÂú®Èáë‰∏ùÈõÄÊâπÊ¨°ÂíåÊôÆÈÄöÊâπÊ¨°‰πãÈó¥ÊöÇÂÅúÔºåÂêéÁª≠‰∏§‰∏™ÊâπÊ¨°‰ºö‰ª• batchIntervalSeconds ‰∏∫Êó∂Èó¥Èó¥ÈöîËá™Âä®Ëß¶Âèë„ÄÇ Ê£ÄÊü• DeployFlow Áä∂ÊÄÅ ÂèØ‰ª•ÁúãÂà∞Êàë‰ª¨ÂàõÂª∫Âá∫‰∏Ä‰∏™Âêç‰∏∫ 12122-sample-10010-df ÁöÑ DeployFlow ËµÑÊ∫êÔºåÈÄöËøáÂ±ïÁ§∫ÁöÑÂ≠óÊÆµ‰∫ÜËß£Âà∞Êú¨Ê¨°ÂèëÂ∏ÉÂàÜ‰∏∫ 3 ‰∏™ÊâπÊ¨°ÔºåÂΩìÂâçÊâπÊ¨°ÁöÑÂ§ßÂ∞èÊòØ 1ÔºåÂ∑≤ÂçáÁ∫ßÂíåÂ∑≤ÂÆåÊàêÁöÑÂâØÊú¨Êï∞ÈáèÈÉΩÊòØ 0„ÄÇ ÂêØÂä®Âá†ÂçÅÁßíÂêéÔºåÊ£ÄÊü• DeployFlow ÁöÑ status Â≠óÊÆµÔºö 1kubectl get df 12122-sample-10010-df -o yaml 12345678910111213141516171819202122232425262728293031323334status: availableReplicas: 0 batches: 3 conditions: - batch: 1 batchSize: 1 canary: true failedReplicas: 0 finishedAt: null phase: Smoked pods: - ip: 172.31.230.23 name: 12122-sample-10010-2mwkt phase: ContainersReady port: 80 pullInStatus: "" pulledInAt: null startedAt: "2021-09-13T12:49:04Z" failedReplicas: 0 finished: false finishedAt: null finishedBatches: 0 finishedReplicas: 0 paused: false phase: BatchStarted pods: - 12122-sample-10010-2mwkt replicas: 1 replicasToProcess: 3 startedAt: "2021-09-13T12:49:04Z" updateRevision: 12122-sample-10010-6ddf9b7cf4 updatedAt: "2021-09-13T12:49:21Z" updatedReadyReplicas: 0 updatedReplicas: 1 ÂèØ‰ª•ÁúãÂà∞ÁõÆÂâçÂú®ÂêØÂä®ÁöÑÊòØ canary ÊâπÊ¨°ÔºåËØ•ÊâπÊ¨°Â∑≤ÁªèÂ§Ñ‰∫é smoked Èò∂ÊÆµÔºåËØ•ÊâπÊ¨°‰∏≠ÁöÑ pod ÊòØ 12122-sample-10010-2mwkt ÔºåÂêåÊó∂‰πüËÉΩÁúãÂà∞ÂΩìÂâçÊâπÊ¨°‰∏≠ pod ÁöÑÊãâÂÖ•Áä∂ÊÄÅ„ÄÅÊãâÂÖ•Êó∂Èó¥Á≠â‰ø°ÊÅØ„ÄÇ Â∞ÜÂ∫îÁî®ÊãâÂÖ•ÊµÅÈáèÂú®Ê≠§‰πãÂâçÊàë‰ª¨ÂèØ‰ª•ÂÖàÊ£ÄÊü•‰∏Ä‰∏ã Service ÁöÑÁä∂ÊÄÅÔºö 1kubectl describe svc sample-12122-svc -o yaml ‰ªéÊòæÁ§∫ÁöÑÁªìÊûúÊù•ÁúãÔºåpod 12122-sample-10010-2mwkt Âπ∂Ê≤°ÊúâÂá∫Áé∞Âú® Service ÁöÑ Endpoints ‰∏≠ÔºåÊÑèÂë≥ÁùÄÂΩìÂâçÂ∫îÁî®Ê≤°ÊúâÊ≠£ÂºèÊé•ÂÖ•ÊµÅÈáèÔºö 123456789101112131415161718Name: sample-12122-svcNamespace: defaultLabels: app=12122 app.kubernetes.io/instance=12122-sample-10010 app.kubernetes.io/name=deploy-demo-hello group=10010 managed-by=triton-ioAnnotations: &lt;none&gt;Selector: app.kubernetes.io/instance=12122-sample-10010,app.kubernetes.io/name=deploy-demo-hello,app=12122,group=10010,managed-by=triton-ioType: ClusterIPIP Families: &lt;none&gt;IP: 10.22.6.154IPs: &lt;none&gt;Port: web 80/TCPTargetPort: 80/TCPEndpoints:Session Affinity: NoneEvents: &lt;none&gt; Êé•‰∏ãÊù•Êàë‰ª¨ÊâßË°åÊãâÂÖ•Êìç‰Ωú(Bake)ÔºåÂØπÂ∫î pod ÁöÑÁä∂ÊÄÅ‰ºö‰ªé ContainerReady Âèò‰∏∫ ReadyÔºå‰ªéËÄåË¢´ÊåÇËΩΩÂà∞ÂØπÂ∫î Service ÁöÑ Endpoints ‰∏äÂºÄÂßãÊ≠£ÂºèÊé•ÂÖ•ÊµÅÈáèÔºö 1grpcurl --plaintext -d '&#123;"deploy":&#123;"name":"12122-sample-10010-df","namespace":"default"&#125;&#125;' localhost:8099 deployflow.DeployFlow/Next ÂÜçÊ¨°Ê£ÄÊü• DeployFlowÔºåServiceÔºåCloneSet ÁöÑÁä∂ÊÄÅÂêéÔºåÂèëÁé∞ Pod Â∑≤Ë¢´ÊåÇËΩΩÂà∞ EndpointsÔºåDeployFlow ÁöÑ UPDATED_READY_REPLICAS Â≠óÊÆµÂèò‰∏∫ 1ÔºåÈáë‰∏ùÈõÄÊâπÊ¨°ËøõÂÖ• baking Èò∂ÊÆµÔºåÂ¶ÇÊûúÊ≠§Êó∂Â∫îÁî®Ê≠£Â∏∏Â∑•‰ΩúÔºåÊàë‰ª¨ÂÜçÊ¨°ÊâßË°å‰∏äÈù¢ÁöÑ Next Êìç‰ΩúÔºåÂ∞Ü DeployFlow ÁΩÆ‰∏∫ baked Èò∂ÊÆµÔºåË°®Á§∫Êú¨ÊâπÊ¨°ÁÇπÁÅ´ÊàêÂäüÔºåÂ∫îÁî®ÊµÅÈáèÊ≠£Â∏∏„ÄÇ Rollout Êìç‰ΩúÈáë‰∏ùÈõÄÊâπÊ¨°Âà∞Ëææ baked Èò∂ÊÆµÂêéÔºåÊâßË°å Next Êìç‰ΩúÂ∞±‰ºöËøõÂÖ•ÂêéÈù¢ÁöÑÊôÆÈÄöÊâπÊ¨°ÂèëÂ∏ÉÔºåÁî±‰∫éÊàë‰ª¨Â∫îÁî®ÁöÑÂâØÊú¨Êï∞ÈáèËÆæÁΩÆ‰∏∫ 3ÔºåÂéªÊéâÈáë‰∏ùÈõÄÊâπÊ¨°‰∏≠ÁöÑ‰∏Ä‰∏™ÂâØÊú¨ÂêéÔºåËøòÂâ© 2 ‰∏™ÔºåËÄå batchSize ÁöÑÂ§ßÂ∞è‰∏∫ 1ÔºåÊâÄÊúâÂâ©‰ΩôÁöÑÊôÆÈÄöÊâπÊ¨°‰ºöÂàÜ‰∏§‰∏™ÊâπÊ¨°ÂèëÂ∏ÉÔºå‰∏§‰∏™ÊâπÊ¨°‰πãÈó¥‰ºöÈó¥Èöî 10s Ëß¶Âèë„ÄÇ 1grpcurl --plaintext -d '&#123;"deploy":&#123;"name":"12122-sample-10010-df","namespace":"default"&#125;&#125;' localhost:8099 deployflow.DeployFlow/Next ÊúÄÂêéÂ∫îÁî®ÂèëÂ∏ÉÂÆåÊàêÔºåÊ£ÄÊü• DeployFlow ÁöÑÁä∂ÊÄÅ‰∏∫ Success: ÂÜçÊ¨°Êü•Áúã Service ÁöÑ Endpoints ÂèØ‰ª•ÁúãÂà∞Êú¨Ê¨°ÂèëÂ∏ÉÁöÑ 3 ‰∏™ÂâØÊú¨ÈÉΩÂ∑≤ÁªèÊåÇËΩΩ‰∏äÂéª„ÄÇ ÂÜçÊ¨°ÂõûÈ°æÊï¥‰∏™ÂèëÂ∏ÉÊµÅÁ®ãÔºåÂèØ‰ª•ÊÄªÁªì‰∏∫‰∏ãÈù¢ÁöÑÁä∂ÊÄÅÊµÅËΩ¨ÂõæÔºö ÊöÇÂÅú/ÁªßÁª≠ DeployFlowÂú®ÈÉ®ÁΩ≤ËøáÁ®ã‰∏≠ÔºåÂ¶ÇÊûúË¶ÅÊöÇÂÅú DeployFlowÔºåÂèØ‰ª•ÊâßË°å Pause Êìç‰ΩúÔºö 1grpcurl --plaintext -d '&#123;"deploy":&#123;"name":"12122-sample-10010-df","namespace":"default"&#125;&#125;' localhost:8099 deployflow.DeployFlow/Pause ÂèØ‰ª•ÁªßÁª≠ÂèëÂ∏É‰∫ÜÔºåÂ∞±ÊâßË°å Resume Êìç‰ΩúÔºö 1grpcurl --plaintext -d '&#123;"deploy":&#123;"name":"12122-sample-10010-df","namespace":"default"&#125;&#125;' localhost:8099 deployflow.DeployFlow/Resume ÂèñÊ∂àÊú¨Ê¨°ÂèëÂ∏ÉÂ¶ÇÊûúÂú®ÂèëÂ∏ÉËøáÁ®ã‰∏≠ÔºåÈÅáÂà∞ÂêØÂä®Â§±Ë¥•ÔºåÊàñËÄÖÊãâÂÖ•Â§±Ë¥•ÁöÑÊÉÖÂÜµÔºåË¶ÅÂèñÊ∂àÊú¨Ê¨°ÂèëÂ∏ÉÔºåÂèØÊâßË°å Cancel Êìç‰ΩúÔºö 1grpcurl --plaintext -d '&#123;"deploy":&#123;"name":"12122-sample-10010-df","namespace":"default"&#125;&#125;' localhost:8099 deployflow.DeployFlow/Cancel ÂêØÂä®‰∏Ä‰∏™Êâ©Áº©ÂÆπ DeployFlowÂêåÊ†∑ÂèØ‰ª•‰ΩøÁî® auto Êàñ mannual Ê®°ÂºèÂàíÂàÜÂ§ö‰∏™ÊâπÊ¨°Êù•ÊâßË°åÊâ©Áº©ÂÆπÊìç‰Ωú„ÄÇ ÂΩì‰∏Ä‰∏™ CloneSet Áº©ÂÆπÊó∂ÔºåÊúâÊó∂Áî®Êà∑ÂÄæÂêë‰∫éÂà†Èô§ÁâπÂÆöÁöÑ PodÔºåÂèØ‰ª•‰ΩøÁî® podsToDelete Â≠óÊÆµÂÆûÁé∞ÊåáÂÆö Pod Áº©ÂÆπÔºö 1234kubectl get pod | grep 12122-sample12122-sample-10010-2mwkt 1/1 Running 0 29m12122-sample-10010-hgdp6 1/1 Running 0 9m55s12122-sample-10010-zh98f 1/1 Running 0 10m Êàë‰ª¨Âú®Áº©ÂÆπÁöÑÊó∂ÂÄôÊåáÂÆöË¢´Áº©ÊéâÁöÑ Pod ‰∏∫ 12122-sample-10010-zh98f: 123456789grpcurl --plaintext -d '&#123;"instance":&#123;"name":"12122-sample-10010","namespace":"default"&#125;,"replicas":2,"strategy":&#123;"podsToDelete":["12122-sample-10010-zh98f"],"batchSize":"1","batches":"1","batchIntervalSeconds":10&#125;&#125;' \localhost:8099 application.Application/Scale&#123; "deployName": "12122-sample-10010-kvn6b"&#125;‚ùØ kubectl get pod | grep 12122-sample12122-sample-10010-2mwkt 1/1 Running 0 29m12122-sample-10010-zh98f 1/1 Running 0 11m CloneSet Ë¢´Áº©ÂÆπ‰∏∫ 2 ‰∏™ÂâØÊú¨ÔºåË¢´Áº©ÂÆπÁöÑ Pod Ê≠£ÊòØÊåáÂÆöÁöÑÈÇ£‰∏™„ÄÇËØ•ÂäüËÉΩÁöÑÂÆûÁé∞ÂæóÁõä‰∫é OpenKruise ‰∏≠Â¢ûÂº∫ÂûãÊó†Áä∂ÊÄÅ workload CloneSet Êèê‰æõÁöÑËÉΩÂäõÔºåÂÖ∑‰ΩìÁöÑÂäüËÉΩÊèèËø∞ÂèØ‰ª•ÂèÇËÄÉ OpenKruise ÊñáÊ°£„ÄÇ Âú®Êìç‰ΩúËøáÁ®ã‰∏≠ÔºåTriton ‰πüÊèê‰æõ‰∫Ü Get ÊñπÊ≥ïÂÆûÊó∂Ëé∑ÂèñÂΩìÂâç DeployFlow ÁöÑ Pod ‰ø°ÊÅØÔºö 1grpcurl --plaintext -d '&#123;"deploy":&#123;"name":"12122-sample-10010-df","namespace":"default"&#125;&#125;' localhost:8099 deployflow.DeployFlow/Get 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&#123; "deploy": &#123; "namespace": "default", "name": "12122-sample-10010-df", "appID": 12122, "groupID": 10010, "appName": "deploy-demo-hello", "instanceName": "12122-sample-10010", "replicas": 3, "action": "create", "availableReplicas": 3, "updatedReplicas": 3, "updatedReadyReplicas": 3, "updateRevision": "6ddf9b7cf4", "conditions": [ &#123; "batch": 1, "batchSize": 1, "canary": true, "phase": "Baked", "pods": [ &#123; "name": "12122-sample-10010-2mwkt", "ip": "172.31.230.23", "port": 80, "phase": "Ready", "pullInStatus": "PullInSucceeded" &#125; ], "startedAt": "2021-09-13T12:49:04Z", "finishedAt": "2021-09-13T13:07:43Z" &#125;, &#123; "batch": 2, "batchSize": 1, "phase": "Baked", "pods": [ &#123; "name": "12122-sample-10010-zh98f", "ip": "172.31.226.94", "port": 80, "phase": "Ready", "pullInStatus": "PullInSucceeded" &#125; ], "startedAt": "2021-09-13T13:07:46Z", "finishedAt": "2021-09-13T13:08:03Z" &#125;, &#123; "batch": 3, "batchSize": 1, "phase": "Baked", "pods": [ &#123; "name": "12122-sample-10010-hgdp6", "ip": "172.31.227.215", "port": 80, "phase": "Ready", "pullInStatus": "PullInSucceeded" &#125; ], "startedAt": "2021-09-13T13:08:15Z", "finishedAt": "2021-09-13T13:08:45Z" &#125; ], "phase": "Success", "finished": true, "batches": 3, "batchSize": 1, "finishedBatches": 3, "finishedReplicas": 3, "startedAt": "2021-09-13T12:49:04Z", "finishedAt": "2021-09-13T13:08:45Z", "mode": "auto", "batchIntervalSeconds": 10, "canary": 1, "updatedAt": "2021-09-13T13:08:45Z" &#125;&#125; TODOS‰∏äÈù¢ÊºîÁ§∫ÁöÑÂ∞±ÊòØ Triton Êèê‰æõÁöÑÊ†∏ÂøÉËÉΩÂäõ„ÄÇÂØπ‰∫éÂü∫Á°ÄÂõ¢ÈòüÊù•ËØ¥ÔºåTriton ‰∏ç‰ªÖ‰ªÖÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÈ°πÁõÆÔºåÂÆÉ‰πüÊòØ‰∏Ä‰∏™ÁúüÂÆûÁöÑÊØîËæÉÊé•Âú∞Ê∞îÁöÑ‰∫ëÂéüÁîüÊåÅÁª≠‰∫§‰ªòÈ°πÁõÆ„ÄÇÈÄöËøáÂºÄÊ∫êÔºåÊàë‰ª¨Â∏åÊúõ Triton ËÉΩ‰∏∞ÂØå‰∫ëÂéüÁîüÁ§æÂå∫ÁöÑÊåÅÁª≠‰∫§‰ªòÂ∑•ÂÖ∑‰ΩìÁ≥ªÔºå‰∏∫Êõ¥Â§öÂºÄÂèëËÄÖÂíå‰ºÅ‰∏öÊê≠Âª∫‰∫ëÂéüÁîüÂåñÁöÑ PaaS Âπ≥Âè∞Âä©ÂäõÔºåÊèê‰æõ‰∏ÄÁßçÁé∞‰ª£ÁöÑ„ÄÅÈ´òÊïàÁöÑÁöÑÊäÄÊúØÊñπÊ°à„ÄÇ ÂºÄÊ∫êÂè™ÊòØËøàÂá∫ÁöÑ‰∏ÄÂ∞èÊ≠•ÔºåÊú™Êù•Êàë‰ª¨‰ºöËøõ‰∏ÄÊ≠•Êé®Âä® Triton ‰∏çÊñ≠Ëµ∞ÂêëÂÆåÂñÑÔºåÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫é‰ª•‰∏ãÂá†ÁÇπÔºö ÊîØÊåÅËá™ÂÆö‰πâÊ≥®ÂÜå‰∏≠ÂøÉÔºåÂèØ‰ª•ÁúãÂà∞ÁõÆÂâç Triton ÈááÁî®ÁöÑÊòØ k8s ÂéüÁîüÁöÑ Service ‰Ωú‰∏∫Â∫îÁî®ÁöÑÊ≥®ÂÜå‰∏≠ÂøÉÔºå‰ΩÜÊçÆÊàë‰ª¨ÊâÄ‰∫ÜËß£ÔºåÂæàÂ§ö‰ºÅ‰∏öÈÉΩ‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑÊ≥®ÂÜå‰∏≠ÂøÉÔºåÊØîÂ¶Ç spring cloud ÁöÑ Nacos Á≠âÔºõ Êèê‰æõ helm ÂÆâË£ÖÊñπÂºèÔºõ ÂÆåÂñÑ REST &amp; GRPC API ‰ª•ÂèäÁõ∏Â∫îÊñáÊ°£Ôºõ ÁªìÂêàÂÜÖÂ§ñÈÉ®Áî®Êà∑ÈúÄÊ±ÇÔºåÊåÅÁª≠Ëø≠‰ª£„ÄÇÈ°πÁõÆÂºÄÊ∫êÂêéÔºåÊàë‰ª¨‰πü‰ºöÊ†πÊçÆÂºÄÂèëËÄÖÈúÄÊ±ÇÂºÄÂ±ïËø≠‰ª£„ÄÇ Ê¨¢ËøéÂ§ßÂÆ∂Âêë Triton Êèê‰∫§ issue Âíå PR ÂÖ±Âª∫ Triton Á§æÂå∫„ÄÇÊàë‰ª¨ËØöÂøÉÊúüÂæÖÊõ¥Â§öÁöÑÂºÄÂèëËÄÖÂä†ÂÖ•Ôºå‰πüÊúüÂæÖ Triton ËÉΩÂ§üÂä©ÂäõË∂äÊù•Ë∂äÂ§öÁöÑ‰ºÅ‰∏öÂø´ÈÄüÊûÑÂª∫‰∫ëÂéüÁîüÊåÅÁª≠‰∫§‰ªòÂπ≥Âè∞„ÄÇÂ¶ÇÊûúÊúâ‰ºÅ‰∏öÊàñËÄÖÁî®Êà∑ÊÑüÂÖ¥Ë∂£ÔºåÊàë‰ª¨ÂèØ‰ª•Êèê‰æõ‰∏ìÈ°πÊäÄÊúØÊîØÊåÅÂíå‰∫§ÊµÅÔºåÊ¨¢ËøéÂÖ•Áæ§Âí®ËØ¢„ÄÇ Áõ∏ÂÖ≥ÈìæÊé•È°πÁõÆÂú∞ÂùÄÔºöhttps://github.com/triton-io/triton ‰∫§ÊµÅÁæ§]]></content>
      <categories>
        <category>ÊåÅÁª≠‰∫§‰ªò</category>
      </categories>
      <tags>
        <tag>‰∫ëÂéüÁîü</tag>
        <tag>k8s</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊéåÈó®‰∏ã‰∏Ä‰ª£ÂÆπÂô®ÂèëÂ∏ÉÁ≥ªÁªü Triton]]></title>
    <url>%2F2021%2F07%2F21%2F%E6%8E%8C%E9%97%A8%E4%B8%8B%E4%B8%80%E4%BB%A3%E5%AE%B9%E5%99%A8%E5%8F%91%E5%B8%83%E7%B3%BB%E7%BB%9F-Triton%2F</url>
    <content type="text"><![CDATA[ÊéåÈó®‰∏ã‰∏Ä‰ª£ÂÆπÂô®ÂèëÂ∏ÉÁ≥ªÁªü Triton CD Âπ≥Âè∞ÊòØÊéåÈó®ÁöÑÊåÅÁª≠‰∫§‰ªòÁ≥ªÁªüÔºåTriton ‰Ωú‰∏∫ CD Âπ≥Âè∞ÁöÑÊ†∏ÂøÉÂÆπÂô®ÂèëÂ∏ÉÁªÑ‰ª∂ÔºåËá™ 2020.4 ÊúàÂú® CD Âπ≥Âè∞‰∏äÊ≠£Âºè‰∏äÁ∫øÔºåÊîØÊíë‰∫ÜÊéåÈó®Ëøë 1000 ‰∏™Â∫îÁî®‰ªéËôöÊú∫ËøÅÁßªËá≥ÂÆπÂô®ÁöÑËøáÁ®ãÔºå‰øùÈöú‰∫ÜËôöÊú∫ËøÅÂÆπÂô®ËøáÁ®ãÁöÑÁ®≥ÂÆöÊÄß„ÄÇÁõÆÂâçÔºåTriton Èô§‰∫ÜÊèê‰æõÊó•Â∏∏ÁöÑÂ∫îÁî®ÂÆπÂô®ÂèëÂ∏É„ÄÅÁΩëÁªúÁ≠ñÁï•ÈÖçÁΩÆ„ÄÅIngress ÂüüÂêçÈÖçÁΩÆÁ≠âËÉΩÂäõ‰πãÂ§ñÔºå‰πüÊàê‰∏∫ÂÖ∂‰ªñÁªÑ‰ª∂„ÄÅÂπ≥Âè∞ÁöÑËµÑÊ∫ê‰∫§‰ªòÂü∫Â∫ßÔºåÊØîÂ¶ÇÔºåÂ§ßËßÑÊ®°ÁöÑÊµÅÊ∞¥Á∫ø‰∫§‰ªòÔºåÂéãÊµãÂπ≥Âè∞Á≠â„ÄÇTriton Ëß£ÂÜ≥‰∫ÜÂ∫îÁî®ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜÁöÑÈóÆÈ¢òÔºåÂåÖÊã¨ÂºÄÂèë„ÄÅÈÉ®ÁΩ≤„ÄÅËøêÁª¥Á≠âÔºåÂêåÊó∂ÊâìÈÄö‰∫ÜÂæÆÊúçÂä°Ê≤ªÁêÜÔºåÊûÅÂ§ßÂú∞Â∏ÆÂä©Á†îÂèëÊèêÂçá‰∫ÜÊåÅÁª≠‰∫§‰ªòÁöÑÊïàÁéá„ÄÇ 1. ËÉåÊôØ‰∫ëÂéüÁîüÊû∂ÊûÑÁöÑÂø´ÈÄüÊôÆÂèäÂ∏¶Êù•‰∫Ü‰ºÅ‰∏öÂü∫Á°ÄËÆæÊñΩÂíåÂ∫îÁî®Êû∂ÊûÑÁ≠âÊäÄÊúØÂ±ÇÈù¢ÁöÑÈù©Êñ∞„ÄÇÂú® CNCF 2020 Âπ¥Â∫¶‰∏≠ÂõΩÂå∫‰∫ëÂéüÁîüË∞ÉÊü•Êä•ÂëäÈáåÈù¢Êúâ‰∏Ä‰∏™‰∫ÆÁúºÁöÑÊï∞Â≠óÔºå72% ÁöÑÂèóËÆøËÄÖÂ∑≤ÁªèÂú®Áîü‰∫ßÁéØÂ¢ÉÂΩì‰∏≠‰ΩøÁî® KubernetesÔºåÂêåÊúüÂÖ®ÁêÉË∞ÉÊü•Êä•ÂëäÁöÑÊï∞Â≠óÊòØ 83%„ÄÇÂèØ‰ª•ÁúãÂà∞ÔºåÂú® Kubernetes ÁöÑ‰ΩøÁî®Áéá‰∏äÔºå‰∏≠ÂõΩÂíåÂÖ®ÁêÉÊòØÊåÅÂπ≥ÁöÑ„ÄÇÂ¶ÇÊûúÁúãÁ∫ØÂÆπÂô®‰ΩøÁî®ÁéáÔºåÂàôÊõ¥Âä†ÊÉä‰∫∫ÔºåË∂ÖËøá 92%„ÄÇ‰ªéËøô‰∫õÊï∞ÊçÆÊù•ÁúãÔºåÊàë‰ª¨ÂèØ‰ª•ÂæóÂá∫ÁªìËÆ∫ÔºöKubernetes ÂíåÂÆπÂô®Â∑≤ÁªèÂÆåÂÖ®ËøõÂÖ•‰∏ªÊµÅÂ∏ÇÂú∫ÔºåÊàê‰∏∫ÊâÄÊúâ‰∫∫ÈÉΩÂú®‰ΩøÁî®ÁöÑÊäÄÊúØ„ÄÇ Âú®Ê≠§‰πãÂâçÔºåÊéåÈó®ÁöÑÂ∫îÁî®‰∏ÄÁõ¥Ë∑ëÂú®ËôöÊú∫ÈáåÔºå‰ΩÜÊòØÈöèÁùÄÂ∫îÁî®ËßÑÊ®°ÁöÑ‰∏çÊñ≠Êâ©Â§ßÔºåËôöÊú∫Êï∞Èáè‰πüÈöè‰πãÂø´ÈÄüÂ¢ûÂä†ÔºåÊàë‰ª¨ÂºÄÂßãÂú®ËøêÁª¥ÊàêÊú¨„ÄÅ‰∫§‰ªòÊïàÁéá„ÄÅÂ∫îÁî®ÁÆ°ÁêÜ‰∏äÈù¢‰∏¥‰∏Ä‰∫õÁóõÁÇπÔºö Â∫îÁî®Êï∞Èáè‰∏çÊñ≠Â¢ûÂä†ÔºåÂü∫Á°ÄËÆæÊñΩÁöÑÊàêÊú¨Èöè‰πã‰∏äÂçáÔºåÈôçÊú¨Ëø´Âú®ÁúâÁù´Ôºõ ‰∏öÂä°È£ûÈÄüÂèëÂ±ïÔºåÂÜÖÈÉ®ÂØπËµÑÊ∫ê„ÄÅÁéØÂ¢É„ÄÅÂ∫îÁî®ÁöÑ‰∫§‰ªòÊïàÁéáÁöÑË¶ÅÊ±Ç‰∏çÊñ≠ÊèêÈ´òÔºõ Â∫îÁî®Êï∞ÈáèÂ¢ûÈïøÂæàÂø´ÔºåÂ§ßÈáèÂ∫îÁî®ÁöÑÁÆ°ÁêÜÁªôËøêÁª¥Â∏¶Êù•ÂæàÂ§ßÂéãÂäõ„ÄÇ ÊâÄ‰ª•Ôºå‰∏∫‰∫ÜËÉΩÂ§üÂÖÖÂàÜÂèëÊå•‰∫ëÂéüÁîüÁöÑ‰ºòÂäøÔºåÁÅµÊ¥ªÂú∞Â∫îÂØπÂèòÂåñÂíåÂºπÊÄßÊâ©Â±ï‰ª•ÊèêÂçáÂºÄÂèëÊïàÁéáÔºåÂä†ÈÄüËø≠‰ª£Âπ∂Èôç‰ΩéÊàêÊú¨ÔºåÊéåÈó®‰∫é 2020 Âπ¥ 4 Êúà‰ªΩÊ≠£ÂºèÂêØÂä®ÂÆπÂô®ÂåñÈ°πÁõÆ„ÄÇ ‰∏∫‰∫ÜÊúÄÂ§ßÁ®ãÂ∫¶Èôç‰ΩéËøÅÁßªÂÆπÂô®ËøáÁ®ã‰∏≠ÂØπÂºÄÂèëÂíå‰∏öÂä°ÁöÑÂΩ±ÂìçÔºåÊàë‰ª¨ÂÜ≥ÂÆöÂú®Â∫îÁî®ÂèëÂ∏É‰∏≠ÂÆåÊàê‰ªéËôöÊú∫Âà∞ÂÆπÂô®ÁöÑËøÅÁßªÔºå‰ª•‰øùÈöúËøÅÁßªËøáÁ®ã‰∏≠ÊúçÂä°ÁöÑÁ®≥ÂÆöÊÄßÔºåÂÆûÁé∞‰∏çÂÅúÊúçËøÅÁßª„ÄÇË¶ÅÂÆûÁé∞Ëøô‰∏™ÁõÆÊ†áÔºå‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑ„ÄÅÊîØÊåÅÂÆπÂô®ÂèëÂ∏ÉÁöÑÂπ≥Âè∞Âëº‰πãÊ¨≤Âá∫ÔºåTriton Â∞±ÊòØÂú®ËøôÁßçËÉåÊôØ‰∏ãËØûÁîüÁöÑ„ÄÇ‰∏ãÈù¢Â∞Ü‰ªãÁªçÂÆπÂô®ÂèëÂ∏ÉÂπ≥Âè∞ Triton ÁöÑËÆæËÆ°ÂéüÁêÜ„ÄÅÂÆûÁé∞ÊñπÊ°à„ÄÇ 2. Triton ËÆæËÆ°ÂéüÁêÜÂèäÂÆûÁé∞ÊñπÊ°àÂú®‰ªãÁªç Triton ‰πãÂâçÊàë‰ª¨ÂÖàÁúã‰∏Ä‰∏ã CNCF ÂØπÊåÅÁª≠‰∫§‰ªòÁöÑÂÆö‰πâÔºåÊ∂µÁõñ‰∫Ü‰∏Ä‰∏™‰∫ëÂéüÁîüÂ∫îÁî®ÁöÑÂÖ®ÁîüÂëΩÂë®ÊúüÊµÅÁ®ãÔºåÂõæ‰∏≠ÁöÑ‰∏Ä‰∫õÊäÄÊúØÊúØËØ≠Âú®Êú¨Êñá‰∏≠‰πü‰ºöÁî®Âà∞ÔºåÊØîÂ¶Ç workloadÔºårolloutÔºåcanaryÁ≠âÔºå ËøôÁØáÊñáÊ°£ ‰∏≠ÊúâËØ¶ÁªÜÁöÑ‰ªãÁªçÔºåÈúÄË¶ÅÁöÑËØùÂèØ‰ª•Êü•ÈòÖ„ÄÇ ÂêåÊó∂ÈÄöËøáËøôÂº†ÂõæÔºå‰πüÂèØ‰ª•Ê∏ÖÊô∞Âú∞‰∫ÜËß£ Triton Âú®Êï¥‰∏™ÊåÅÁª≠ÂèëÂ∏ÉÁ≥ªÁªü‰∏≠ÁöÑÂÆö‰Ωç„ÄÇTopic 1ÔºåTopic 1.5 ÁöÑ‰∏ªË¶ÅÂÜÖÂÆπÊòØÂ∫îÁî®Ê®°ÂûãÊèèËø∞ÔºåÊâìÂåÖ„ÄÅÂèÇÊï∞ÈÖçÁΩÆÔºõTopic 4 ÊòØËµÑÊ∫êÁÆ°ÁêÜÔºåÁΩëÁªúÔºåÊó•Âøó / ÁõëÊéßÁ≠âÂπ≥Âè∞‰æßÁöÑÂäüËÉΩÔºõËÄå Triton ËÅöÁÑ¶ÁöÑÂ∑•‰ΩúÊòØÂú® Topic 2 Âíå Topic 3 Ôºå‰∏ªË¶ÅÂÜÖÂÆπÊòØÂ∫îÁî®ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜÔºåÊµÅÈáèÁÆ°ÁêÜÔºåworkload ÁÆ°ÁêÜÔºåÊèê‰æõÂèëÂ∏ÉÁ≠ñÁï•ÔºåÊØîÂ¶ÇËìùÁªøÈÉ®ÁΩ≤„ÄÅÈáë‰∏ùÈõÄÈÉ®ÁΩ≤Á≠â„ÄÇ ‰∫ÜËß£‰∫Ü Triton ÁöÑÂÆö‰ΩçÂêéÔºå‰∏ãÈù¢Â∞Ü‰ªéÊñπÊ°àÈÄâÂûãÔºåÊû∂ÊûÑËÆæËÆ°ÔºåUI ‰∫§‰∫í 3 ‰∏™Áª¥Â∫¶Êù•ËØ¶ÁªÜ‰ªãÁªç Triton ÁöÑËÆæËÆ°ÂéüÁêÜÂíåÂÆûÁé∞ÊñπÊ°à„ÄÇ 2.1 ÊñπÊ°àÈÄâÂûã2.1.1 workload ÈÄâÂûã‰ºóÊâÄÂë®Áü•Ôºå‰∏çÁÆ°ÊòØÊó†Áä∂ÊÄÅÁöÑ Deployment ËøòÊòØÊúâÁä∂ÊÄÅÁöÑ StatefulSetÔºåkubernetes ÈÉΩÊòØÊîØÊåÅÊúçÂä°ÁöÑÊªöÂä®Êõ¥Êñ∞ÁöÑ„ÄÇÊàë‰ª¨‰πüÁªèÂ∏∏Âú®‰∏Ä‰∫õÊñáÁ´†‰∏≠ÁúãÂà∞ÊúâÂü∫‰∫éÂéüÁîü Deployment ÂÆûÁé∞Â∫îÁî®ÁöÑÊªöÂä®ÂèëÂ∏ÉÂíåÁÅ∞Â∫¶ÂèëÂ∏ÉÔºåËøôÁßçÊñπÂºèÂºÄÂèëÁÆÄÂçïÂÆπÊòì‰∏äÊâãÔºå‰ΩÜÊòØÈöè‰πãÂ∏¶Êù•‰∫ÜÂæàÂ§öÁº∫Èô∑Ôºå‰ΩøÂæóÊàë‰ª¨Êó†Ê≥ïÁªÜÁ≤íÂ∫¶ÊéßÂà∂ÂèëÂ∏ÉÁöÑËøáÁ®ãÔºåÊØîÂ¶Ç‰∏çÊîØÊåÅÂèëÂ∏ÉËøáÁ®ã‰∏≠ÊöÇÂÅú„ÄÅÁªßÁª≠Ôºå‰ª•ÂèäÊµÅÈáèÁöÑ‰ºòÈõÖÊãâÂÖ•ÊãâÂá∫Á≠âËÉΩÂäõ„ÄÇ ‰∏∫‰∫ÜÂÆûÁé∞Êõ¥‰∏∞ÂØåÁöÑÂèëÂ∏ÉÁ≠ñÁï•‰ª•ÂèäÊõ¥Âä†ÁªÜÁ≤íÂ∫¶ÁöÑÂèëÂ∏ÉÊéßÂà∂Ôºå‰ª•‰øùÈöúÂÆπÂô®ÂèëÂ∏ÉËøáÁ®ãÁöÑÂÆâÂÖ®„ÄÅÁ®≥ÂÆöÔºåTriton ÈÄâÊã© OpenKruise ‰Ωú‰∏∫Â∫îÁî®ÁöÑ workload„ÄÇOpenKruise ÊòØ Kubernetes ÁöÑ‰∏Ä‰∏™Ê†áÂáÜÊâ©Â±ïÔºåÂÆÉÂèØ‰ª•ÈÖçÂêàÂéüÁîü Kubernetes ‰ΩøÁî®ÔºåÂπ∂‰∏∫ÁÆ°ÁêÜÂ∫îÁî®ÂÆπÂô®„ÄÅsidecar„ÄÅÈïúÂÉèÂàÜÂèëÁ≠âÊñπÈù¢Êèê‰æõÊõ¥Âä†Âº∫Â§ßÂíåÈ´òÊïàÁöÑËÉΩÂäõ„ÄÇOpenKruise Êèê‰æõ‰∫ÜÂæàÂ§öÂéüÁîü kubernetes ÁöÑÂ¢ûÂº∫ÂûãËµÑÊ∫êÔºåCloneSet„ÄÅAdvanced StatefulSet„ÄÅSidecarSet Á≠â„ÄÇÂÖ∂‰∏≠ÔºåCloneSet Êèê‰æõ‰∫ÜÊõ¥Âä†È´òÊïà„ÄÅÁ°ÆÂÆöÂèØÊéßÁöÑÂ∫îÁî®ÁÆ°ÁêÜÂíåÈÉ®ÁΩ≤ËÉΩÂäõÔºåÊîØÊåÅ‰ºòÈõÖÂéüÂú∞ÂçáÁ∫ß„ÄÅÊåáÂÆöÂà†Èô§„ÄÅÂèëÂ∏ÉÈ°∫Â∫èÂèØÈÖçÁΩÆ„ÄÅÂπ∂Ë°å / ÁÅ∞Â∫¶ÂèëÂ∏ÉÁ≠â‰∏∞ÂØåÁöÑÁ≠ñÁï•ÔºåÂèØ‰ª•Êª°Ë∂≥Êõ¥Â§öÊ†∑ÂåñÁöÑÂ∫îÁî®Âú∫ÊôØÔºåÊâÄ‰ª• Triton ÈÄâÊã©Âü∫‰∫é CloneSet Êù•ÂÆûÁé∞Êó†Áä∂ÊÄÅÂ∫îÁî®ÁöÑÂèëÂ∏ÉÊµÅÁ®ã„ÄÇ 2.1.2 ÂèëÂ∏ÉÊµÅÁ®ãÊäÄÊúØÈÄâÂûãÂ¶Ç‰ΩïÂÆö‰πâ‰∏ÄÁßçÂèëÂ∏ÉÊµÅÁ®ãÔºåÂπ∂ÊåâÁÖßÊµÅÁ®ãÁöÑÂÆö‰πâÂéªÂÆûÁé∞Êú¨Ê¨°ÂèëÂ∏ÉÔºü‰∏∫‰∫ÜÂØªÊâæ‰∏Ä‰∫õÁÅµÊÑüÔºåÂú®ËÆæËÆ° Triton ‰πãÂâçÊàë‰ª¨Ë∞ÉÁ†î‰∫ÜÁõÆÂâçÂú®‰∫ëÂéüÁîüÈ¢ÜÂüüÂÅöÂæóÊØîËæÉÂ•ΩÁöÑÁöÑ‰∏Ä‰∫õ CI/CD ÁªÑ‰ª∂ÔºåÂÉè‰∫ëÂéüÁîü CI Â∑•ÂÖ∑ TektonÔºå‰∫§‰ªòÂ∑•ÂÖ∑ Argo ÈÉΩÊòØËÆæËÆ°‰∫Ü‰∏ÄÂ•ó CRD ÔºàËá™ÂÆö‰πâËµÑÊ∫êÔºâÔºåÁÑ∂ÂêéÂú® Operator ‰∏≠ÂÆûÁé∞Áõ∏Â∫îÁöÑÈÄªËæë‰ª•ËææÂà∞ÊúÄÁªàÁöÑÁõÆÊ†áÁä∂ÊÄÅÔºàOperator ÊòØÁî± CoreOS ÂºÄÂèëÁöÑÔºåÁî®Êù•Êâ©Â±ï Kubernetes APIÔºåÁâπÂÆöÁöÑÂ∫îÁî®Á®ãÂ∫èÊéßÂà∂Âô®ÔºåÂÖ∂Âü∫‰∫é Kubernetes ÁöÑËµÑÊ∫êÂíåÊéßÂà∂Âô®Ê¶ÇÂøµ‰πã‰∏äÊûÑÂª∫Ôºå‰ΩÜÂêåÊó∂ÂèàÂåÖÂê´‰∫ÜÂ∫îÁî®Á®ãÂ∫èÁâπÂÆöÁöÑÈ¢ÜÂüüÁü•ËØÜ„ÄÇÂàõÂª∫ Operator ÁöÑÂÖ≥ÈîÆÊòØ CRD ÁöÑËÆæËÆ°Ôºâ„ÄÇ ‰∫éÊòØÊàë‰ª¨ÈááÁî®‰∫ëÂéüÁîüÁöÑÊñπÂºèËÆæËÆ°ÂÆπÂô®ÂèëÂ∏ÉÔºåÂéüÁîü‰∏∫‰∫ëËÄåËÆæËÆ°ÔºåÂú®‰∫ë‰∏äËøêË°åÔºåÂÖÖÂàÜÂà©Áî®ÂíåÂèëÊå•‰∫ëÂπ≥Âè∞ÁöÑÂºπÊÄß + ÂàÜÂ∏ÉÂºè‰ºòÂäø„ÄÇÊàë‰ª¨ËÆæËÆ°‰∫Ü‰∏ÄÁßç CRD Êù•ÊèèËø∞‰∏ÄÊ¨°ÂÆπÂô®ÂèëÂ∏ÉÁöÑÂÆåÊï¥ÊµÅÁ®ãÔºåËøôÊ†∑ÊØèÊ¨°ÂèëÂ∏ÉÂè™ÈúÄË¶ÅÂàõÂª∫ CRD ËµÑÊ∫êÔºåÂ∞±ËÉΩÂÆö‰πâÂ•ΩÊú¨Ê¨°ÁöÑÂèëÂ∏ÉÊµÅÁ®ãÔºåÂêéÁª≠Âè™ÈúÄË¶ÅÂú®Ê≠§ËµÑÊ∫êÂü∫Á°Ä‰∏ä‰øÆÊîπÂç≥ÂèØ„ÄÇÁªèËøáÂÜÖÈÉ®ËÆ®ËÆ∫ÔºåÊúÄÁªàËØ• CRD Ë¢´ÂëΩÂêç‰∏∫ DeployFlowÔºåÂç≥ÂèëÂ∏ÉÊµÅÁöÑÊÑèÊÄùÔºåÂÖ≥‰∫é DeployFlow ÁöÑËØ¶ÁªÜ‰ªãÁªçËØ∑ÁªßÁª≠ÈòÖËØª‰∏ãÈù¢ÁöÑÊû∂ÊûÑËÆæËÆ°„ÄÇ 2.2 Êû∂ÊûÑËÆæËÆ°Âú®Ëß£ÂÜ≥‰∫Ü workload ÂíåÂèëÂ∏ÉÊµÅÁ®ãÁöÑÊäÄÊúØÈÄâÂûãÂêéÔºåDeployFlow Ëøô‰∏™ CRD ÁöÑËÆæËÆ°Â∞±Êàê‰∏∫‰∫ÜÊàë‰ª¨Ë¶ÅÂéªËÅöÁÑ¶ÁöÑÊ†∏ÂøÉÂ∑•‰Ωú„ÄÇ‰∏ãÂõæÂ±ïÁ§∫‰∫Ü Triton ÁöÑ‰∏ªË¶ÅËÆæËÆ°Êû∂ÊûÑÔºåÂèØ‰ª•ÁúãÂà∞Âú® Kubernetes Âíå OpenKruise ÁöÑÂü∫Á°Ä‰πã‰∏äÔºåÂÆåÊàê‰∏ÄÊ¨°ÂèëÂ∏ÉÈúÄË¶ÅÁöÑÈÖçÁΩÆÁî± CRD ÂÆö‰πâÔºåÂèëÂ∏ÉÊµÅÁ®ãÁõ∏ÂÖ≥ÁöÑÈÄªËæëÊéßÂà∂ÈÄöËøá Operator ÂÆûÁé∞ÔºåÂêåÊó∂ Triton Êèê‰æõ REST„ÄÅGRPC API ÂíåÂâçÁ´Ø UI ÂÆûÁé∞‰∫§‰∫í„ÄÇ 2.2.1 DeployFlow Âíå Operator ÂÆûÁé∞È¶ñÂÖà‰ªãÁªç‰∏ã DeployFlow Ëøô‰∏™ CRDÔºåÈÄöËøá DeployFlow Êàë‰ª¨ÂÆö‰πâ‰∫Ü‰∏ÄÊ¨°ÂèëÂ∏É‰∏≠ÈúÄË¶ÅÁöÑÈÖçÁΩÆ‰ª•ÂèäÂèëÂ∏ÉËøáÁ®ã‰∏≠ÈúÄË¶ÅÁöÑÁä∂ÊÄÅÂ±ïÁ§∫„ÄÇ 12345678// DeployFlow is the Schema for the deploys APItype DeployFlow struct &#123; metav1.TypeMeta `json:",inline"` metav1.ObjectMeta `json:"metadata,omitempty"` Spec DeployFlowSpec `json:"spec,omitempty"` Status DeployFlowStatus `json:"status,omitempty"`&#125; Spec Â≠óÊÆµÁöÑÂÜÖÂÆπÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜÔºå‰∏ÄÈÉ®ÂàÜÊòØ‰∏éÂ∫îÁî®Áõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÔºåÊØîÂ¶Ç AppID„ÄÅGroupId„ÄÅÂâØÊú¨Êï∞Èáè„ÄÅAppNameÁ≠âÔºåÂè¶‰∏ÄÈÉ®ÂàÜÊòØÊåáÂÆöÂèëÂ∏ÉÁ≠ñÁï•ÔºåÊØîÂ¶ÇÊòØ createËøòÊòØ update Êìç‰ΩúÔºåÊòØ scale in ËøòÊòØ scale outÔºå‰∏çÂêåÁöÑÊìç‰ΩúÂØπÂ∫î‰∏çÂêåÁöÑÂèëÂ∏ÉÁ≠ñÁï•ÔºåËØ¶ÁªÜÁöÑÂ≠óÊÆµËß£ÈáäÂèØ‰ª•ÈÄöËøá‰∏ãÈù¢‰ª£Á†ÅÊù•ÁêÜËß£„ÄÇ 123456789101112131415type DeployFlowSpec struct &#123; // Important: Run "make" to regenerate code after modifying this file AppID int `json:"appID"` GroupID int `json:"groupID"` AppName string `json:"appName"` ...... Action string `json:"action"` // +nullable UpdateStrategy *DeployUpdateStrategy `json:"updateStrategy,omitempty"` // +nullable NonUpdateStrategy *DeployNonUpdateStrategy `json:"nonUpdateStrategy,omitempty"`&#125; DeployUpdateStrategy ‰ª£Ë°®‰∫ÜÊú¨Ê¨°ÂèëÂ∏ÉÊòØ‰∏ÄÊ¨°Êõ¥Êñ∞Êìç‰ΩúÔºå‰πüÂ∞±ÊòØ‰ºö‰Ωø CloneSet ‰∏≠ÁöÑ UpdateRevision Â≠óÊÆµÂèëÁîüÂèòÂåñÔºå‰∏ÄËà¨ create„ÄÅupdate rollback Â∞±ÊòØÈááÁî® DeployUpdateStrategy ÁöÑÂ≠óÊÆµÂÆö‰πâ„ÄÇ DeployNonUpdateStrategy ‰ª£Ë°®Êú¨Ê¨°ÂèëÂ∏É‰∏ç‰ºöËß¶ÂèëËµÑÊ∫êÊõ¥Êñ∞Ôºå‰πüÂ∞±ÊòØ UpdateRevision ‰∏ç‰ºöÂèëÁîüÂèòÂåñÔºå‰∏ÄËà¨ scale in„ÄÅscale out„ÄÅrestart Á≠âÊìç‰ΩúË¶ÅÈááÁî® DeployNonUpdateStrategy„ÄÇ ‰∏çÂêåÁöÑÂèëÂ∏ÉÁ≠ñÁï•ËÇØÂÆöÊúâ‰∏çÂêåÁöÑÂ≠óÊÆµÔºå‰ΩÜÂ§ßÈÉ®ÂàÜÁöÑÁ≠ñÁï•ÈÉΩÊòØÂèØ‰ª•ÂÖ±Áî®ÁöÑÔºåÊâÄ‰ª•Âú®Ê≠§‰πã‰∏äÊàë‰ª¨ÊäΩË±°Âá∫‰∏Ä‰∏™Âü∫Á°ÄÂèëÂ∏ÉÁ≠ñÁï• BaseStrategyÔºåÁî±‰∫é BaseStrategy ‰∏≠ÁöÑÂ≠óÊÆµÂ§™Â§öÔºåÊàë‰ª¨ËøôÈáåÊîæ‰∏ÄÂº† CRD ÁöÑ schema ËµÑÊ∫êËßÜÂõæÔºåÁÑ∂ÂêéÂÜçÈÄâÊã©ÂÖ∂‰∏≠ÈáçË¶ÅÁöÑÂ≠óÊÆµËøõË°åËß£Èáä„ÄÇ ÂÖà‰ªãÁªç DeployPhase Â≠óÊÆµÔºåDeployPhase Ë°®Á§∫‰∏ÄÊ¨°ÂèëÂ∏ÉËøáÁ®ã‰∏≠ÔºåDeployFlow ÊâÄÁªèÂéÜÁöÑÈò∂ÊÆµ„ÄÇ Â≠óÊÆµÁöÑÊÑèÊÄùÈÉΩÊØîËæÉÂ•ΩÁêÜËß£ÔºåËøôÈáåÂ∞±‰∏çÂ±ïÂºÄËÆ≤ ‰∫Ü„ÄÇ Âú® BaseStrategy ‰∏≠Êúâ‰∏™ÊØîËæÉÈáçË¶ÅÁöÑÂ≠óÊÆµ - BatchSize ÔºåË°®Á§∫ÊâπÊ¨°Â§ßÂ∞è„ÄÇËøôÊÑèÂë≥ÁùÄ DeployFlow ÊîØÊåÅÂàÜÊâπÊ¨°ÂèëÂ∏ÉÔºåÁî®Êà∑ÂèØ‰ª•Ëá™ÂÆö‰πâÊØè‰∏™ÊâπÊ¨°ÊúÄÂ§ßÂèëÂ∏ÉÁöÑÂâØÊú¨Êï∞ÈáèÔºåDeployFlow ‰ºöËÆ°ÁÆóÂá∫Êú¨Ê¨°ÂèëÂ∏ÉÁöÑÊÄªÊâπÊ¨°ÊòØÂ§öÂ∞ë‰ªéËÄåÊèêÂâçÁªôÂá∫ÂèëÂ∏ÉÊ¶ÇËßà„ÄÇ ‰ªé BaseStrategy ÁöÑ paused„ÄÅcanceled Â≠óÊÆµÂ∞±ÂèØ‰ª•Áü•ÈÅìÔºåÂú®ÂèëÂ∏ÉËøáÁ®ã‰∏≠ÂèØ‰ª•ÈöèÊó∂ÊöÇÂÅú„ÄÅÁªßÁª≠ÊàñËÄÖÂèñÊ∂àÊú¨Ê¨°ÂèëÂ∏É„ÄÇMode Ë°®Á§∫ DeployFlow ‰∏çÂêåÊâπÊ¨°‰πãÈó¥ÁöÑËß¶ÂèëÊñπÂºèÔºåÂàÜ‰∏∫ auto Âíå manual ‰∏§ÁßçÔºåÂΩìÈÄâÊã© auto Ê®°ÂºèÁöÑÊó∂ÂÄôÔºåÈÄöËøáÂ≠óÊÆµ BatchIntervalSeconds ÂèØ‰ª•ËÆæÁΩÆ‰∏çÂêåÊâπÊ¨°‰πãÈó¥ÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÂ¶ÇÊûúÈÄâÊã©ÊâãÂä®Ê®°ÂºèÂàôÊØè‰∏™ÊâπÊ¨°‰πãÈó¥ÈúÄË¶ÅÊâãÂ∑•Ëß¶Âèë„ÄÇ Áî±‰∫é DeployFlow ÊòØÂàÜÊâπÊ¨°ÂèëÂ∏ÉÔºåÊâÄ‰ª•ÊØè‰∏™ÊâπÊ¨°ÈúÄË¶ÅÊúâÈò∂ÊÆµÊòæÁ§∫ - BatchPhase Ôºå‰ª•Ë°®Á§∫ÂΩìÂâçÁöÑÊâπÊ¨°ÊâÄÂ§ÑÁöÑÈò∂ÊÆµÔºåÊàë‰ª¨Êù•ËØ¶ÁªÜËß£ÈáäÊØèÁßçÈò∂ÊÆµÁöÑÂê´‰πâ„ÄÇ BatchPending: Ë°®Á§∫ÂΩìÂâçÊâπÊ¨°ÁöÑ pod Ê≠£Âú®ÂáÜÂ§áËµÑÊ∫êÔºåÊØîÂ¶ÇÊ≠§Êó∂ pod Ê≠£Âú®Ë¢´Ë∞ÉÂ∫¶‰∏≠Ôºåimage Âú®‰∏ãËΩΩ‰∏≠ÔºåÂØπÂ∫î Kubernetes ‰∏≠ÁöÑ pod Â§Ñ‰∫é PendingÔºåContainerCreating Áä∂ÊÄÅ„ÄÇ BatchSmoking: Ë°®Á§∫ÂΩìÂâçÊâπÊ¨°ÁöÑ pod Ê≠£Âú®ÂêØÂä®ËøáÁ®ã‰∏≠Ôºåpod Â§Ñ‰∫é Running Áä∂ÊÄÅÔºå‰ΩÜÊòØ ContainerReady Â≠óÊÆµËøòÊ≤°ÊúâÁΩÆ‰∏∫ true„ÄÇ BatchSmoked: Ë°®Á§∫ÂΩìÂâçÊâπÊ¨°ÁöÑÊâÄÊúâ pod ÈÉΩÂ∑≤ÁªèÂêØÂä®ÊàêÂäüÔºå‰πüÂ∞±ÊòØ pod ‰∏≠ÁöÑ ContainerReady Â≠óÊÆµÂ∑≤ÁªèË¢´ÁΩÆ‰∏∫ trueÔºå‰ΩÜÊòØ Ready Â≠óÊÆµËøòÂ§Ñ‰∫é false„ÄÇÊ≠§Êó∂Â¶ÇÊûúÈÄöËøá service Êù•Â§ÑÁêÜÊúçÂä°ÊµÅÈáèÁöÑËØùÔºåÂêØÂä®ÁöÑ pod Âπ∂‰∏ç‰ºöË¢´Âä†ÂÖ•Âà∞ÂØπÂ∫î service ÁöÑ endpointÔºåÂ¶ÇÊûúÊòØÂæÆÊúçÂä°Êû∂ÊûÑÔºåÂàôËØ• pod Âπ∂‰∏ç‰ºöË¢´ÊãâÂÖ•Âà∞ÂæÆÊúçÂä°ÁöÑÊ≥®ÂÜå‰∏≠ÂøÉÔºå‰ªéËÄå‰øùËØÅ‰∫Ü‰∏öÂä°ÊµÅÈáèÁöÑÂÆâÂÖ®„ÄÇÊ≠£ÊòØÊã•Êúâ‰∫ÜËøôÁßçÊú∫Âà∂‰ª•ÂèäÊâπÊ¨°Èó¥ÂèØÊöÇÂÅúÁöÑËÉΩÂäõÔºåÊàë‰ª¨ÂèØ‰ª•ËΩªÊùæÂÆûÁé∞Â∫îÁî®ÁöÑÈáë‰∏ùÈõÄÂèëÂ∏ÉÔºåËøô‰∏™Âú®ÂêéÈù¢Ëøò‰ºöËØ¶ÁªÜËÆ≤Âà∞„ÄÇ BatchBaking: Ë°®Á§∫ÂΩìÂâçÊâπÊ¨°ÁöÑÊâÄÊúâ pod ÈÉΩÂ∑≤ÁªèÂêØÂä®ÊàêÂäüÔºåÊ≠£Âú®ÊâßË°åÊµÅÈáèÊãâÂÖ•Êìç‰ΩúÔºå‰πüÂ∞±ÊòØÂ∞Ü pod ÁöÑ Ready Â≠óÊÆµÁΩÆ‰∏∫ true„ÄÇ BatchBaked: Ë°®Á§∫ÂΩìÂâçÊâπÊ¨°ÁöÑÊâÄÊúâ pod ÁöÑ Ready Â≠óÊÆµÈÉΩÂ∑≤Ë¢´ÁΩÆ‰∏∫ trueÔºåpod ÂºÄÂßãÊé•Êî∂Áîü‰∫ßÊµÅÈáèÔºåËá≥Ê≠§‰πüÊÑèÂë≥ÁùÄÊú¨ÊâπÊ¨°ÁöÑÁªìÊùüÔºåÂèØ‰ª•ÂºÄÂßã‰∏ã‰∏ÄÊâπÊ¨°ÁöÑÊìç‰Ωú„ÄÇ Âú®ÊâπÊ¨°ËøõË°åËøáÁ®ã‰∏≠Ôºå‰ºöÊúâ smoke Â§±Ë¥•ÊàñËÄÖ bake Â§±Ë¥•ÁöÑÊÉÖÂÜµÔºåÂØπÂ∫îÁöÑÁä∂ÊÄÅÂ∞±ÊòØ SmokeFailedÂíå BakeFailed„ÄÇ Âú® UpdateStrategy ‰∏≠Êúâ‰∏Ä‰∏™ canary Â≠óÊÆµÔºåÊÑèÂë≥ÁùÄ DeployFlow ÊîØÊåÅÈáë‰∏ùÈõÄÂèëÂ∏É„ÄÇÂÖ∂ÂÆûÂú®ËÆ≤Ëß£‰∫Ü‰∏äËø∞ DeployFlow ÂàÜÊâπÊ¨°Â§ÑÁêÜÁöÑËÉΩÂäõÂêéÔºåÂú®Ê≠§Âü∫Á°Ä‰πã‰∏äÂÆûÁé∞Èáë‰∏ùÈõÄÂèëÂ∏ÉÊòØÊØîËæÉÁÆÄÂçïÁöÑ„ÄÇ‰πüÂ∞±ÊòØÂú®Èáë‰∏ùÈõÄÊâπÊ¨°Â§Ñ‰∫é BatchSmoked Áä∂ÊÄÅÁöÑÊó∂ÂÄôÔºåËÆ©ÂèëÂ∏ÉÊöÇÂÅúÔºåÂú®ÊµÅÈáèÊãâÂÖ•‰πãÂâç‰πüÂèØ‰ª•ËøõË°å‰∏Ä‰∫õ API È™åËØÅÁöÑÊìç‰ΩúÔºåÂºÄÂèëËÄÖÂú®È™åËØÅÊ≤°ÈóÆÈ¢ò‰πãÂêéÊâãÂ∑•Â∞ÜËØ•ÊâπÊ¨°ÊãâÂÖ•ÔºåÊãâÂÖ•Èáë‰∏ùÈõÄÊâπÊ¨°ÂêéÔºå DeployFlow ‰πüÂ§Ñ‰∫éÊöÇÂÅúÁöÑÁä∂ÊÄÅÔºåÊ≠§Êó∂ÂºÄÂèëËÄÖÂèØ‰ª•ËßÇÂØüÁ∫ø‰∏äÊµÅÈáèÁöÑÁõëÊéßÔºåÁ°ÆËÆ§Ê≤°ÊúâÈóÆÈ¢òÂêéÂÜçÊâßË°åÂêéÈù¢ÊâπÊ¨°ÁöÑÂèëÂ∏É„ÄÇÂêéÈù¢ÁöÑ UI ‰∫§‰∫í‰ºöÊõ¥Âä†Áõ¥ËßÇÂú∞Â±ïÁ§∫ËØ•ÂäüËÉΩÔºåËøôÈáåÊàë‰ª¨ÂÖàÈÄöËøá‰∏ÄÂº† DeployFlow ÁöÑÁä∂ÊÄÅÊµÅËΩ¨Á§∫ÊÑèÂõæÂÆåÊï¥Âú∞Â±ïÁ§∫‰∏ÄÊ¨°ÂèëÂ∏ÉÁöÑËøáÁ®ãÔºåÊàë‰ª¨‰ª•Êú¨Ê¨°ÂèëÂ∏ÉÂàÜ‰∏∫‰∏§‰∏™ÊâπÊ¨°‰∏∫‰æãÔºåÈáë‰∏ùÈõÄÊâπÊ¨°ÂíåÊôÆÈÄöÊâπÊ¨°„ÄÇÁªìÂêàÊú¨Âõæ‰∏é‰∏äÊñáÁöÑ CRD Ëß£ÈáäÔºåÁõ∏‰ø°ËØªËÄÖ‰ºöÂØπ DeployFlow Êúâ‰∏Ä‰∏™Êõ¥Âä†Ê∏ÖÊô∞ÁöÑËÆ§Áü•„ÄÇ Ëá≥Ê≠§ÔºåÂú® DeployUpdateStrategy „ÄÅBaseStrategy ‰∏≠ÁöÑÊ†∏ÂøÉÂ≠óÊÆµÈÉΩÂ∑≤Áªè‰ªãÁªçÂÆå‰∫ÜÔºåÂú® DeployNonUpdateStrategy ‰∏≠ËøòÊúâ‰∏Ä‰∏™ PodsToDelete Â≠óÊÆµÔºåËøô‰∏™Â≠óÊÆµÊòØÂú®Â∫îÁî®Áº©ÂÆπ„ÄÅÈáçÂêØÊìç‰ΩúÊó∂Ëµ∑‰ΩúÁî®ÁöÑÔºåÂéüÁîü Kubernetes ÂØπ‰∫éËµÑÊ∫êÁöÑÁº©ÂÆπÊìç‰ΩúÊúâËá™Â∑±ÁöÑËßÑÂàôÔºå‰∏çËÉΩÈöèÊÑèÈÄâÊã©ÊÉ≥Ë¶ÅÁº©ÂÆπÁöÑ pod„ÄÇ‰ΩÜÊòØÂú® DeployFlow ‰∏≠Ôºå‰Ω†ÂèØ‰ª•ÊåáÂÆö pod Áº©ÂÆπÔºåÊåáÂÆö pod ÈáçÂêØ„ÄÇ ÈÄöËøá‰∏äÈù¢ÁöÑ‰ªãÁªçÔºåËØªËÄÖÂØπ DeployFlow Ëøô‰∏™ CRD ÁöÑ spec Â≠óÊÆµÊúâ‰∫Ü‰∏ÄÂÆö‰∫ÜËß£Ôºå‰∏ãÈù¢Êù•Áúã‰∏ãÂèëÂ∏ÉËøáÁ®ã‰∏≠Êàë‰ª¨ÈúÄË¶ÅÂ±ïÁ§∫ÁöÑ status Â≠óÊÆµ„ÄÇ ÁÜüÊÇâ Kubernetes ÁöÑÂêåÂ≠¶Â∫îËØ•ËÉΩÂ§ü‰ªéÂ≠óÊÆµÁöÑÂ≠óÈù¢ÊÑèÊÄù‰∫ÜËß£Ëøô‰∫õÂ≠óÊÆµÁöÑÂê´‰πâÔºåËøôÈáåÂ∞±‰∏çËØ¶ÁªÜÂ±ïÂºÄ‰∫Ü„ÄÇ CRD ËÆæËÆ°ÂÆåÊàêÂêéÔºåOperator ÁöÑÂÆûÁé∞‰πüÂ∞±ÊòØÊ∞¥Âà∞Ê∏†ÊàêÁöÑ‰∫ãÊÉÖ‰∫ÜÔºåÈô§‰∫Ü DeployFlow ÁöÑ OperatorÔºåTriton ‰∏≠ËøòÈáçÊñ∞ÂÆûÁé∞‰∫Ü‰∏Ä‰∫õ controller Êù•Êª°Ë∂≥‰∏™ÊÄßÂåñÁöÑÈúÄÊ±ÇÔºåÊØîÂ¶Ç Event controller Áî®Êù•Â∞ÜÂèëÂ∏ÉËøáÁ®ã‰∏≠ pod„ÄÅCloneset„ÄÅDeployFlow Á≠âÁªÑ‰ª∂ÁöÑÊó•ÂøóÂèëÈÄÅÂà∞ ES ‰ª•Êñπ‰æøÂºÄÂèëËÄÖÊü•ÁúãÂèëÂ∏ÉÁöÑÊÉÖÂÜµÔºåReadinessGates controller Áî®Êù•ÊéßÂà∂Ëá™ÂÆö‰πâ ReadinessGate ÁöÑÊãâÂÖ•ÊãâÂá∫Êìç‰ΩúÁ≠â„ÄÇ ÂêåÊó∂ Triton Êèê‰æõ REST &amp; GRPC API Êù•Êìç‰Ωú DeployFlowÔºåË∞ÉÁî®ÊñπÂç≥‰Ωø‰∏ç‰∫ÜËß£ÂÆπÂô®Âíå Kubernetes ÁöÑÁü•ËØÜÔºå‰πüÂèØ‰ª•ÂæàÂÆπÊòìÂØπÊé•Âà∞ Triton ‰∏äÂÆûÁé∞ÂèëÂ∏ÉÁöÑÂäüËÉΩ„ÄÇ 2.3 UI ‰∫§‰∫íÂ∫ïÂ±ÇÊû∂ÊûÑ‰ª•ÂèäÊ†∏ÂøÉÁªÑ‰ª∂ DeployFlow ÁöÑËÆæËÆ°ÈÄªËæëËôΩÁÑ∂Á®çÊòæÂ§çÊùÇÔºå‰ΩÜÂæóÁõä‰∫é Triton Êö¥Èú≤ÁöÑ REST &amp; GRPC API ‰ª•Âèä‰∏∞ÂØåÁöÑ status Â≠óÊÆµÔºå‰ΩøÂæóÂâçÁ´ØÂú®ÂèëÂ∏ÉÁöÑ UI ‰∫§‰∫íÈÄªËæë‰∏äËÉΩÂ§üÂÅöÂà∞ÁÆÄÊ¥ÅÁõ¥ËßÇ„ÄÇ‰∏ãÈù¢ËÆ©Êàë‰ª¨‰ªé UI ÂÖ•ÊâãÔºåÁúã‰∏ã Triton Â¶Ç‰ΩïËøõË°åÂ∫îÁî®ÁöÑ‰∫§‰ªò‰ª•ÂèäÂØπÂ∫îÁî®ÁöÑÂâØÊú¨ÂÆû‰æãÁöÑËßÑÂàí„ÄÇ 2.3.1 ÂèëÂ∏ÉÂÖ•Âè£ÂèäÂèëÂ∏ÉÊ∏ÖÂçïËøõÂÖ•Áîü‰∫ßÂèëÂ∏ÉÈ°µÈù¢ÔºåÂú®ÂÆπÂô®ÂèëÂ∏ÉÈ°µÁ≠æÔºåÈÄâÊã©ÈúÄË¶ÅÂèëÂ∏ÉÁöÑ groupÔºåÁÇπÂáª‚ÄúÂèëÂ∏É‚Äù„ÄÇ ÁÇπÂáªÂêéÂºπÂá∫‰∏Ä‰∏™ÂèëÂ∏ÉÊ∏ÖÂçïÁöÑÈ°µÈù¢ÔºåÂú®ËøôÈáåÈúÄË¶ÅÈÖçÁΩÆÊú¨Ê¨°ÂèëÂ∏ÉÈúÄË¶ÅÁöÑÁ≠ñÁï•‰ª•ÂèäÁõ∏ÂÖ≥ÂèÇÊï∞„ÄÇ ÂÖ∂‰∏≠Êúâ‰∫õÂèÇÊï∞Âú®‰∏äÈù¢ÁöÑ CRD ËÆæËÆ°ÁØáÁ´†‰∏≠Â∑≤ÁªèÊúâÊâÄÊèèËø∞ÔºåÊØîÂ¶ÇÂ∫îÁî®ÊèèËø∞ÔºåÊâπÊ¨°Â§ßÂ∞èÔºåÊâπÊ¨°Èó¥Â§ÑÁêÜÊñπÂºèÔºåÊâπÊ¨°Èó¥ÈöîÁ≠âÔºåËøôÈáå‰∏çÂÜçËµòËø∞„ÄÇÂêØÂä®Ë∂ÖÊó∂Êó∂Èó¥ ÊòØÂºÄÊîæÁªôÂºÄÂèëËÄÖËá™ÂÆö‰πâÂ∫îÁî®ÈúÄË¶ÅÁî®Êù•ÂêØÂä®ÁöÑÊó∂Èó¥ÔºåÊØîÂ¶ÇÊúâ‰∫õÂ∫îÁî®Â∞§ÂÖ∂ÊòØ java Â∫îÁî®ÔºåÂú®ÁúüÊ≠£ÂêØÂä®‰πãÂâçÈúÄË¶ÅÊâßË°å‰∏Ä‰∫õ warm up ÁöÑÊìç‰ΩúÔºåÂºÄÂèëËÄÖÂ∞±ÂèØ‰ª•Ê†πÊçÆËá™Â∑±Â∫îÁî®ÁöÑÂÆûÈôÖÊÉÖÂÜµÂ°´ÂÜôËØ•ÂÄºÔºåÈÅøÂÖçËøôÁ±ªÂ∫îÁî®ÂêØÂä®Â§±Ë¥•„ÄÇÂæÆÊúçÂä°ÊãâÂá∫Á≠âÂæÖÊó∂Èó¥ ÊòØÁî®Êù•ÊîØÊåÅÂæÆÊúçÂä° pod ‰ºòÈõÖÈÄÄÂá∫ÁöÑ„ÄÇ ÈÇ£‰ΩïË∞ì‰ºòÈõÖÈÄÄÂá∫Ôºå‰∏∫‰ªÄ‰πàË¶Å‰ºòÈõÖÈÄÄÂá∫Âë¢ÔºüÂú® Kubernetes ‰∏≠ÂΩìÂà†Êéâ‰∏Ä‰∏™ pod ÁöÑÊó∂ÂÄôÔºåÁêÜÊÉ≥Áä∂ÂÜµÂΩìÁÑ∂ÊòØ Kubernetes ‰ªéÂØπÂ∫îÁöÑ ServiceÔºàÂÅáÂ¶ÇÊúâÁöÑËØùÔºâÊääËøô‰∏™ pod ÊëòÊéâÔºåÂêåÊó∂Áªô pod Âèë SIGTERM ‰ø°Âè∑ËÆ© pod ‰∏≠ÁöÑÂêÑ‰∏™ÂÆπÂô®‰ºòÈõÖÈÄÄÂá∫Â∞±Ë°å‰∫Ü„ÄÇ‰ΩÜÂÆûÈôÖ‰∏ä pod ÊúâÂèØËÉΩÁäØÂêÑÁßçÂπ∫ËõæÂ≠êÔºö Â∑≤ÁªèÂç°Ê≠ª‰∫ÜÔºåÂ§ÑÁêÜ‰∏ç‰∫Ü‰ºòÈõÖÈÄÄÂá∫ÁöÑ‰ª£Á†ÅÈÄªËæëÊàñÈúÄË¶ÅÂæà‰πÖÊâçËÉΩÂ§ÑÁêÜÂÆåÊàêÔºõ ‰ºòÈõÖÈÄÄÂá∫ÁöÑÈÄªËæëÊúâ BUGÔºåËá™Â∑±Ê≠ªÂæ™ÁéØ‰∫ÜÔºõ ‰ª£Á†ÅÂÜôÂæóÈáéÔºåÊ†πÊú¨‰∏çÁêÜ‰ºö SIGTERM; Âõ†Ê≠§ÔºåKubernetes ÁöÑ pod ÁªàÊ≠¢ÊµÅÁ®ã‰∏≠ËøòÊúâ‰∏Ä‰∏™‚ÄùÊúÄÂ§öÂèØ‰ª•ÂÆπÂøçÁöÑÊó∂Èó¥‚ÄùÔºåÂç≥ grace period ÔºàÂú® pod ÁöÑ .spec.terminationGracePeriodSeconds Â≠óÊÆµ‰∏≠ÂÆö‰πâÔºâÔºåËøô‰∏™ÂÄºÈªòËÆ§ÊòØ 30 ÁßíÔºåÊàë‰ª¨Âú®ÊâßË°å kubectl delete ÁöÑÊó∂ÂÄô‰πüÂèØÈÄöËøá --grace-period ÂèÇÊï∞ÊòæÂºèÊåáÂÆö‰∏Ä‰∏™‰ºòÈõÖÈÄÄÂá∫Êó∂Èó¥Êù•Ë¶ÜÁõñ pod ‰∏≠ÁöÑÈÖçÁΩÆ„ÄÇËÄåÂΩì grace period Ë∂ÖÂá∫‰πãÂêéÔºåKubernetes Â∞±Âè™ËÉΩÈÄâÊã© SIGKILL Âº∫Âà∂Âπ≤Êéâ pod ‰∫Ü„ÄÇ ‰ΩÜÊòØÂú®ÂæÆÊúçÂä°ÁöÑÂú∫ÊôØ‰∏ãÔºåÈô§‰∫ÜÊää pod ‰ªé Kubernetes ÁöÑ Service ‰∏äÊëò‰∏ãÊù•‰ª•ÂèäËøõÁ®ãÂÜÖÈÉ®ÁöÑ‰ºòÈõÖÈÄÄÂá∫‰πãÂ§ñÔºåÊàë‰ª¨ËøòÂøÖÈ°ªÂÅö‰∏Ä‰∫õÈ¢ùÂ§ñÁöÑ‰∫ãÊÉÖÔºåÊØîÂ¶ÇËØ¥‰ªé Kubernetes Â§ñÈÉ®ÁöÑÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉ‰∏äÂèçÊ≥®ÂÜåÔºå‰∏çÁÑ∂ÂèØËÉΩ‰ºöÂá∫Áé∞ pod Â∑≤ÁªèË¢´Âà†ÊéâÔºå‰ΩÜÊòØÊ≥®ÂÜå‰∏≠ÂøÉ‰∏äËøòÁïôÁùÄÂ∑≤Âà†Êéâ pod ÁöÑÊúçÂä°‰ø°ÊÅØÔºåÊ≠§Êó∂ÊúâÊµÅÈáèËøõÂÖ•ÁöÑËØùÂ∞±‰ºöÂá∫Áé∞ÊúçÂä°‰∏çÂèØÁî®ÁöÑÊÉÖÂÜµ„ÄÇÊâÄ‰ª•Êàë‰ª¨Âú® prestop hook ‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ gracefully_shutdown ÁöÑÊñá‰ª∂Êù•Â§ÑÁêÜ pod Âà†Èô§ÂêéÁöÑÂæÆÊúçÂä°‰ºòÈõÖÈÄÄÂá∫„ÄÇ 1234567spec: contaienrs: - name: demo-container lifecycle: preStop: exec: command: ["/bin/sh"Ôºå"-c"Ôºå"/gracefully_shutdown"] Âè≥‰æßÁöÑÂèëÂ∏ÉÁ≠ñÁï•‰ª•ÂèäÊú¨Ê¨°ÂèëÂ∏ÉÊ¶ÇËßàÂú®‰πãÂâçÁöÑÊû∂ÊûÑËÆæËÆ°‰∏≠Â∑≤ÁªèËÆ≤ËøáÔºåËøôÈáå‰∏çÂú®ËµòËø∞„ÄÇ 2.3.2 ÂºÄÂßãÂèëÂ∏ÉÂÆåÊàêÂèëÂ∏ÉÈÖçÁΩÆÂêéÔºåÂç≥ÂèØÂºÄÂßãÂèëÂ∏É„ÄÇ ÂèëÂ∏ÉËøõÂ∫¶ÔºöÂ±ïÁ§∫ÂèëÂ∏ÉÁöÑÊâπÊ¨°ÔºåÂèäÂêÑ‰∏™ÊâπÊ¨°ÊâÄÂêØÂä®ÁöÑÂÆû‰æãÊï∞ÈáèÂíåÁä∂ÊÄÅ„ÄÇÂú®ÂèëÂ∏ÉËøáÁ®ã‰∏≠Ôºå‰∫∫Â∑•Êìç‰ΩúÁöÑÂÖ•Âè£‰πüÂú®Ê≠§Âå∫ÂüüÔºõ ÂÆû‰æãÂàóË°®ÔºöÂ±ïÁ§∫ÂèëÂ∏ÉÁöÑÂÆû‰æãÔºåÂèØ‰ª•ÂàáÊç¢ÂÆû‰æãÁâàÊú¨Êü•ÁúãÂêÑÁâàÊú¨ÁöÑÂÆû‰æãÔºõ ÂâØÊú¨Áä∂ÊÄÅÔºöÂΩ¢Â¶Ç 0/1/0/0 ÂØπÂ∫î Pending/Running/Ready/Failed Âõõ‰∏™Áä∂ÊÄÅÁöÑÊï∞Èáè (1 ‰∏™ pod Âú®ÂèëÂ∏É‰∏≠ÔºâÔºåÂÖ∂‰∏≠ Running ÂØπÂ∫îÂèëÂ∏É‰∏≠ÂÆû‰æãÊï∞ÔºåReady ÂèëÂ∏ÉÊàêÂäüÂÆû‰æãÊï∞ÔºåFailed ÂèëÂ∏ÉÂ§±Ë¥•ÂÆû‰æãÊï∞„ÄÇ 2.3.3 ÂèëÂ∏ÉËøáÁ®ã‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÂèëÂ∏ÉÂåÖÊã¨‚ÄúÈáë‰∏ùÈõÄÊâπÊ¨°ÂêØÂä®ÔºàSmokingÔºâ‚Äù-‚ÄúÈáë‰∏ùÈõÄÊâπÊ¨°ÁÇπÁÅ´ÔºàBakingÔºâ‚Äù-‚ÄúÊªöÂä®ÂèëÂ∏ÉÔºàRolloutÔºâ‚Äù ‰∏â‰∏™Èò∂ÊÆµ„ÄÇ Èáë‰∏ùÈõÄÊâπÊ¨°ÂêØÂä®‰∏≠ÔºàSmokingÔºâ Èáë‰∏ùÈõÄÊâπÊ¨°ÂêØÂä®ÊàêÂäüÔºåÂèØ‰ª•È™åËØÅÊé•Âè£ÔºåÁ°ÆËÆ§Ê≤°ÈóÆÈ¢òÔºåÂèØÂ∞ÜÂÖ∂ÊãâÂÖ•ÁÇπÁÅ´ÔºàBakingÔºâ Èáë‰∏ùÈõÄÊâπÊ¨°ÁÇπÁÅ´‰∏≠ÔºåÂÆû‰æãÂ∑≤Êé•ÊµÅÈáèÔºåÁî±‰∫éÊ≠§Êó∂ DeployFlow Â§Ñ‰∫éÊöÇÂÅúÁä∂ÊÄÅÔºåÂºÄÂèëËÄÖÂèØ‰ª•ÊúâÂÖÖË∂≥ÁöÑÊó∂Èó¥ÂèØËßÇÂØüÊó•Âøó„ÄÅÁõëÊéßÁ≠âÊòØÂê¶ÊúâÂºÇÂ∏∏ÔºåÁ°ÆËÆ§Ê≤°ÈóÆÈ¢òÂêéÂÜçËß¶ÂèëÊªöÂä®ÂèëÂ∏ÉÔºàRolloutÔºâ ÊªöÂä®ÂèëÂ∏É‰∏≠ÔºåÂ¶ÇÈÄâÊã©‚ÄúÊâãÂä®‚Äù Ê®°ÂºèÔºåÊØè‰∏™ÊªöÂä®ÊâπÊ¨°ÈÉΩÈúÄË¶Å‰∫∫‰∏∫Ëß¶Âèë ÊªöÂä®ÂèëÂ∏ÉËøáÁ®ã‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞Êñ∞ÊóßÂÆû‰æãÁöÑÁâàÊú¨Êï∞ÈáèÂú®‰∫§ÊõøÂèòÂåñ„ÄÇ ÂèëÂ∏ÉÊàêÂäü Ëá≥Ê≠§Ôºå‰∏ÄÊ¨°ÂÆåÊï¥ÁöÑ DeployFlow ÊµÅÁ®ãÂ∞±Ëµ∞ÂÆå‰∫ÜÔºåÂèëÂ∏ÉÂà∞ËææÊàêÂäüÁöÑÁä∂ÊÄÅ„ÄÇÂèØ‰ª•ÁúãÂà∞ÊØè‰∏™ÊâπÊ¨°ÊâÄË¥üË¥£ÁöÑ pod Êï∞Èáè‰ª•Âèä pod Áä∂ÊÄÅ„ÄÅÊó•ÂøóÁ≠â‰ø°ÊÅØ„ÄÇ 2.3.4 ÊåáÂÆöÂÆû‰æãÁöÑÊìç‰ΩúÂú®ÂÆû‰æãËøêË°åËøáÁ®ã‰∏≠ÔºåÂ¶ÇÊûúÂèëÁé∞ÂÆû‰æãË¥üËΩΩÂºÇÂ∏∏ÊàñÈúÄË¶ÅÈáçÊñ∞Âä†ËΩΩ apollo ÈÖçÁΩÆÔºåÂ∞±‰ºöÊúâÈáçÂêØÂÆû‰æãÁöÑÈúÄÊ±Ç„ÄÇKubernetes Êú¨Ë∫´Ê≤°ÊúâÊèê‰æõÈáçÂêØÁöÑÊìç‰ΩúÈÄªËæëÔºå‰∏ÄËà¨ÈÄöËøáÊùÄÊéâ‰∏Ä‰∏™ pod Êù•ËææÂà∞ÈáçÂêØÁöÑÊïàÊûúÔºå‰ΩÜËøôÁßçÊñπÂºèÊØîËæÉÁ≤óÊö¥ËÄå‰∏îÂ≠òÂú®ÂÆâÂÖ®ÈöêÊÇ£„ÄÇTriton Êèê‰æõ‰∫ÜÂÆâÂÖ®ÁöÑÈáçÂêØÁ≠ñÁï•Ôºå‰ºöÂÖàÊñ∞Â¢û‰∏Ä‰∏™ pod Â¶ÇÊûúËØ• pod ÂêØÂä®ÊàêÂäüÊàêÂäüÔºåÂÜçÂà†Êéâ‰Ω†ÊâÄÊåáÂÆöË¶ÅÈáçÂêØÁöÑ podÔºå‰ª•Ê≠§Êù•ËææÂà∞ÂÆâÂÖ®ÈáçÂêØÁöÑÊïàÊûúÔºåËøôÂ∞±ÊòØ Triton ÁöÑÊåáÂÆöÂÆû‰æãÈáçÂêØÁöÑÂäüËÉΩ„ÄÇ ÂêåÊ†∑ÁöÑÂéüÁêÜÔºåÁº©ÂÆπÁöÑÊìç‰Ωú‰πüÂèØ‰ª•ÊåáÂÆöÊÉ≥Ë¶ÅÁº©ÊéâÁöÑ pod „ÄÇ ËØ•ÂäüËÉΩÁöÑÂÆûÁé∞ÂæóÁõä‰∫é OpenKruise ‰∏≠Â¢ûÂº∫ÂûãÊó†Áä∂ÊÄÅ workload CloneSet Êèê‰æõÁöÑËÉΩÂäõÔºåÂÖ∑‰ΩìÁöÑÂäüËÉΩÊèèËø∞ÂèØ‰ª•ÂèÇËÄÉ OpenKruise ÊñáÊ°£„ÄÇ ‰∏äÈù¢ÁöÑÂÜÖÂÆπÂ∞±ÊòØÊúâÂÖ≥ Triton Ê†∏ÂøÉËÉΩÂäõÁöÑ UI ‰∫§‰∫íÔºåÊï¥‰∏™ËøáÁ®ãÂäõÊ±ÇÁÆÄÊ¥Å„ÄÅÊ∏ÖÊô∞ÔºåÈÅøÂÖçÁªôÂºÄÂèëËÄÖÈÄ†ÊàêÈ¢ùÂ§ñÁöÑÁêÜËß£Ë¥üÊãÖÔºåËøô‰∏∫Êàë‰ª¨ÂÆπÂô®ÁöÑÊé•ÂÖ•„ÄÅÊé®ËøõÊèê‰æõ‰∫ÜÂæàÂ§ßÁöÑ‰æøÊç∑„ÄÇ 3. ÊÄªÁªì‰∏éÂ±ïÊúõÊØè‰∏™ÂÖ¨Âè∏ÁöÑÂÆπÂô®ÂèëÂ∏ÉÂπ≥Âè∞ÈÉΩ‰∏çÂ∞ΩÁõ∏ÂêåÔºåÂèØËÉΩ‰ºöÊúâËØªËÄÖÁúãÂÆåËØ¥ Triton Â∞ÅË£Ö‰∫ÜÂ§™Â§öÁöÑ Kubernetes ÁªÜËäÇÔºåÊ≤°ÊúâÂêëÂºÄÂèëËÄÖÁúüÊ≠£Â±ïÁ§∫ÂéüÁîü Kubenetes ÁöÑÁä∂ÊÄÅ„ÄÅÂê´‰πâÊàñËÄÖÁêÜÂøµ„ÄÇÂÖ∂ÂÆû‰ªé‰∏ÄÂºÄÂßãÔºåÊàë‰ª¨ÁöÑÁõÆÊ†áÂ∞±ÊòØËÆæËÆ°ÈÄÇÁî®‰∫éÊéåÈó®Ëá™Ë∫´Á†îÂèë‰ΩìÁ≥ªÁöÑÂÆπÂô®ÂèëÂ∏ÉÁ≥ªÁªüÔºåÂáèÂ∞ëÂºÄÂèëÂØπÂèëÂ∏ÉÊìç‰ΩúÁöÑÂ≠¶‰π†ÊàêÊú¨Ôºå‰ªéËÄåÂø´ÈÄü‰∏äÊâã‰ª•Êõ¥Âø´Âú∞ËµãËÉΩÁ†îÂèëÊµÅÁ®ãÁöÑËø≠‰ª£ÔºåÂä†ÈÄü‰∏öÂä°Â∫îÁî®ÁöÑ‰∏äÁ∫ø„ÄÇËÄåÁÆÄÊ¥ÅÊ∏ÖÊô∞ÁöÑ API ‰πüÊúâÂà©‰∫éÊàë‰ª¨ËÆæËÆ°Âá∫Êõ¥Âä†ÁÆÄÂçïÁöÑÁî®Êà∑ÁïåÈù¢ÔºåÁÆÄÂçïÁöÑÁî®Êà∑ÁïåÈù¢ÂèàËÆ©Êàë‰ª¨Âú®Êé®ÂπøÊó∂ÂèóÁõä„ÄÇ ‰∏äÂõæÊòØ Triton ÁöÑ‰∏Ä‰∫õÂÖ≥ÈîÆÊåáÊ†áÔºåÂèØËßÅ Triton Â∑≤ÁªèÊàê‰∏∫ CD Âπ≥Âè∞ÁöÑÊ†∏ÂøÉËÉΩÂäõÔºåÂú®Áî®Êà∑ÈúÄÊ±ÇÁöÑËø≠‰ª£‰∏≠‰∏çÊñ≠ËøõÂåñÔºå‰∏çËøáÔºåÁé∞Âú®ÁöÑ Triton ‰æùÁÑ∂ÊúâÂæàÂ§ßÁöÑ‰ºòÂåñÁ©∫Èó¥Ôºå‰∏ªË¶ÅÊúâÔºö ÊéåÈó®ÊúâÂ§ßÈáèÁöÑ socket ÈïøËøûÊé•Â∫îÁî®ÔºåÂØπ‰∫éËøôÁ±ªÂ∫îÁî®ÁöÑÂÆπÂô®ÂåñÔºå‰ª•ÂèäÂÆπÂô®ÂåñÂêéÂ¶Ç‰ΩïÂèëÂ∏ÉÔºåËøòÊ≤°ÊúâÊ∏ÖÊô∞ÁöÑËÆæËÆ°ÊñπÊ°àÔºõ Triton ÊåâÂ∫îÁî®Á≤íÂ∫¶ËøõË°åÂèëÂ∏ÉÔºå‰∏çÊîØÊåÅË∑®Â∫îÁî®ÁöÑÂèëÂ∏ÉÊµÅÁ®ãÁºñÊéíÔºõ ÂØπÂºÄÂèëËÄÖÂø´ÈÄüÊãâËµ∑Êú¨Âú∞ÊµãËØïÁéØÂ¢ÉÁöÑÊîØÊåÅËæÉÂº±„ÄÇ Êàë‰ª¨ÁõÆÂâç‰πüÂú®ËøõË°åÈíàÂØπËøô‰∫õ‰ºòÂåñÈ°πÁöÑÂ∑•‰Ωú„ÄÇ]]></content>
      <categories>
        <category>kubernetes</category>
      </categories>
      <tags>
        <tag>go</tag>
        <tag>kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ê∑±ÂÖ•ÁêÜËß£ Kubernetes Deletion]]></title>
    <url>%2F2021%2F07%2F21%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-Kubernetes-Deletion%2F</url>
    <content type="text"><![CDATA[kubectl delete Ëøô‰∏™ÂëΩ‰ª§Êàë‰ª¨Âá†‰πéÊØèÂ§©ÈÉΩÂú®‰ΩøÁî®ÔºåÁúãËµ∑Êù•ÂæàÂÆπÊòìÁêÜËß£Ôºå‰∏çÂ∞±ÊòØÂà†Èô§ Kubernetes ÁöÑÊüêÁßçËµÑÊ∫êÂêóÔºü‰ΩÜÊòØË¶ÅÂÆåÂÖ®ÁêÜËß£ Delete Êìç‰ΩúËøòÊòØÂæàÊúâÊåëÊàòÁöÑÔºåÁêÜËß£Âà†Èô§Êìç‰ΩúËÉåÂêéÁúüÊ≠£ÁöÑÂéüÁêÜÔºåËÉΩÂ§üÂ∏ÆÂä©‰Ω†‰ªéÂÆπÂ∫îÂØπ‰∏Ä‰∫õÂ•áËë©Âú∫ÊôØ„ÄÇËøôÁØáÊñáÁ´†Â∞Ü‰ªé‰ª•‰∏ãÂá†‰∏™ÊñπÈù¢ËØ¶ÁªÜËß£ÈáäÂà†Èô§Êìç‰ΩúËÉåÂêéÁöÑÊïÖ‰∫ãÔºö Âü∫Êú¨ÁöÑÂà†Èô§Êìç‰Ωú Finalizers Âíå Owner Reference ‰ºöÂØπÂà†Èô§Êìç‰Ωú‰∫ßÁîü‰ªÄ‰πàÂΩ±Âìç Â¶Ç‰ΩïÂà©Áî® propagation policy ÊîπÂèòÂà†Èô§ÁöÑÈ°∫Â∫è ÈÄöËøá examples ÊºîÁ§∫‰∏äËø∞Âà†Èô§Êìç‰Ωú ÁÆÄÂçïËµ∑ËßÅÔºåÊâÄÊúâÁ§∫‰æãÈÉΩÂ∞Ü‰ΩøÁî® ConfigMaps Âíå Basic Shell ÂëΩ‰ª§Êù•ÊºîÁ§∫Êìç‰ΩúËøáÁ®ã„ÄÇ The basic deleteKubernetes ÊúâÂá†Áßç‰∏çÂêåÁöÑÂëΩ‰ª§ÔºåÊÇ®ÂèØ‰ª•‰ΩøÁî®ÂÆÉÂÖÅËÆ∏ÊÇ®ÂàõÂª∫ÔºåËØªÂèñÔºåÊõ¥Êñ∞ÂíåÂà†Èô§ÂØπË±°„ÄÇ Âá∫‰∫éÊú¨ÂçöÂÆ¢ÊñáÁ´†ÁöÑÁõÆÁöÑÔºåÊàë‰ª¨Â∞Ü‰∏ìÊ≥®‰∫éÂõõ‰∏™ kubectl ÂëΩ‰ª§Ôºöcreate,get,patch, Âíådelete„ÄÇ ‰∏ãÈù¢ÊòØÂá†‰∏™ÊúÄÁÆÄÂçïÁöÑ kubectl delete ‰ΩøÁî®Âú∫ÊôØÔºö 12kubectl create configmap mymapconfigmap/mymap created 123kubectl get configmap/mymapNAME DATA AGEmymap 0 12s 12kubectl delete configmap/mymapconfigmap "mymap" deleted 12kubectl get configmap/mymapError from server (NotFound): configmaps "mymap" not found ÊºîÁ§∫‰∫Ü‰∏Ä‰∏™ configMap ‰ªéÂàõÂª∫„ÄÅÊü•ËØ¢„ÄÅÂà∞Âà†Èô§„ÄÅÂÜçÊü•ËØ¢ÁöÑËøáÁ®ãÔºåËøô‰∏™ËøáÁ®ãÂèØ‰ª•Áî®‰∏ãÈù¢ÁöÑÁä∂ÊÄÅÂõæË°®Á§∫Ôºö ËøôÁßç delete Êìç‰ΩúÊòØÈùûÂ∏∏ÁÆÄÂçïÁõ¥ËßÇÁöÑÔºå‰ΩÜÂΩì‰Ω†ÈÅáÂà∞ FinalizerÂíå Owner References ÁöÑÊó∂ÂÄôÂ∞±‰ºöÂá∫Áé∞ÂêÑÁßçÈöæ‰ª•ÁêÜËß£ÁöÑÁé∞Ë±°„ÄÇ Understanding FinalizersÂú®ÁêÜËß£ Kubernetes ÁöÑËµÑÊ∫êÂà†Èô§Êó∂Ôºå‰∫ÜËß£ Finalizers ÁöÑÂ∑•‰ΩúÂéüÁêÜËÉΩÂ§üÂú®‰Ω†Êó†Ê≥ïÂà†Èô§ËµÑÊ∫êÊó∂Áªô‰Ω†‰∏Ä‰∫õËß£ÂÜ≥ÈóÆÈ¢òÁöÑÁÅµÊÑü„ÄÇ Finalizers ÊòØËß¶Âèë pre-delete Êìç‰ΩúÁöÑÂÖ≥ÈîÆÔºåËÉΩÂ§üÊéßÂà∂ËµÑÊ∫êÁöÑÂûÉÂúæÂõûÊî∂„ÄÇFinalizers ËÆæËÆ°ÁöÑÂàùË°∑ÊòØÂ∏ÆÂä© controller Âú®Â§ÑÁêÜËµÑÊ∫êÂà†Èô§‰πãÂâçÔºå‰ºòÂÖàÂ§ÑÁêÜ‰∏Ä‰∫õ clean up ÁöÑÈÄªËæë„ÄÇ‰ΩÜÊòØ Finalizers Âπ∂‰∏çÂåÖÂê´‰ª£Á†ÅÈÄªËæëÔºå‰ΩøÁî®‰∏äË∑ü Annotation Êúâ‰∫õÁõ∏‰ººÔºåÂæàÂÆπÊòìË¢´Ê∑ªÂä†ÊàñËÄÖÂà†Èô§„ÄÇ ‰Ω†ÂèØ‰ª•Â∑≤ÁªèËßÅËøá‰∏ãÈù¢ÁöÑ Finalizers: 12kubernetes.io/pv-protectionkubernetes.io/pvc-protection Ëøô‰∏§‰∏™ Finalizer ÊòØÁî®Êù•Èò≤Ê≠¢ËØØÂà†Èô§ volume ÁöÑÔºåÁ±ª‰ººÂäüËÉΩÁöÑ Finalizer ËøòÊúâÂæàÂ§ö„ÄÇ ‰∏ãÈù¢ÊòØ‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ configmapÔºåÂè™ÂåÖÂê´‰∏Ä‰∏™ Finalizer: 12345678cat &lt;&lt;EOF | kubectl create -f -apiVersion: v1kind: ConfigMapmetadata: name: mymap finalizers: - kubernetesEOF Ë¥üË¥£ÁÆ°ÁêÜ configmap ÁöÑ controller Âπ∂‰∏çÁü•ÈÅìËØ•Â¶Ç‰ΩïÂ§ÑÁêÜ kubernetes Ëøô‰∏™ Finalizer„ÄÇÁé∞Âú®ÊàëÂ∞ùËØïÂéªÂà†Èô§Ëøô‰∏™ configmap: 1234kubectl delete configmap/mymap &amp;configmap "mymap" deletedjobs[1]+ Running kubectl delete configmap/mymap Kubernetes ‰ºöËøîÂõû‰∏Ä‰∏™‰ø°ÊÅØÂëäËØâ‰Ω†Ëøô‰∏™ configmap Â∑≤ÁªèË¢´Âà†Èô§‰∫ÜÔºåÁÑ∂ËÄåÂπ∂‰∏çÊòØ‰º†ÁªüÊÑè‰πâ‰∏äÁöÑÂà†Èô§ÔºåËÄåÊòØÂá∫‰∫é‰∏Ä‰∏™ deleting ÁöÑÁä∂ÊÄÅ„ÄÇÂΩìÊàë‰ª¨ÂÜçÊ¨°ÊâßË°å get Êìç‰ΩúÂéªËé∑ÂèñËØ• configmapÔºå‰ºöÂèëÁé∞ configmap ËµÑÊ∫êÂ∑≤ÁªèË¢´‰øÆÊîπËøá‰∫ÜÔºådeletionTimeStamp ËÆæÁΩÆ‰∫ÜÂÄº„ÄÇ 1234567891011121314kubectl get configmap/mymap -o yamlapiVersion: v1kind: ConfigMapmetadata: creationTimestamp: "2020-10-22T21:30:18Z" deletionGracePeriodSeconds: 0 deletionTimestamp: "2020-10-22T21:30:34Z" finalizers: - kubernetes name: mymap namespace: default resourceVersion: "311456" selfLink: /api/v1/namespaces/default/configmaps/mymap uid: 93a37fed-23e3-45e8-b6ee-b2521db81638 Êç¢Âè•ËØùËØ¥ÔºåËøô‰∏™ configmap ËµÑÊ∫êÂπ∂Ê≤°ÊúâË¢´Âà†Èô§ËÄåÊòØË¢´Êõ¥Êñ∞‰∫ÜÔºåËøôÊòØÂõ†‰∏∫ Kubernetes ÁúãÂà∞ËµÑÊ∫ê‰∏≠Êúâ‰∏Ä‰∏™ Finalizer ÂêéÊääÂÆÉÁΩÆ‰∏∫‰∫Ü read-only Áä∂ÊÄÅ„ÄÇËøô‰∏™ configmap Âè™ÊúâÂú®ÁßªÈô§‰∫Ü Finalizer ÂêéÔºåÊâç‰ºöÁúüÊ≠£‰ªéÈõÜÁæ§‰∏≠Âà†Èô§„ÄÇ Êàë‰ª¨‰ΩøÁî® patch ÂëΩ‰ª§ÁßªÈô§ Finalizer Êù•È™åËØÅ‰∏Ä‰∏ã‰∏äÈù¢ÁöÑËØ¥Ê≥ï„ÄÇ 12345kubectl patch configmap/mymap \ --type json \ --patch='[ &#123; "op": "remove", "path": "/metadata/finalizers" &#125; ]'configmap/mymap patched[1]+ Done kubectl delete configmap/mymap Ê≠§Êó∂Êàë‰ª¨ÂÜçÂéª get configmapÔºåÂèëÁé∞Â∑≤ÁªèËé∑Âèñ‰∏çÂà∞‰∫Ü„ÄÇ 12kubectl get configmap/mymap -o yamlError from server (NotFound): configmaps "mymap" not found ‰∏äÈù¢Â±ïÁ§∫‰∫ÜÂΩì‰∏Ä‰∏™ËµÑÊ∫êÂ∏¶Êúâ Finalizer Êó∂ÔºåÊâßË°åÂà†Èô§Êìç‰ΩúÂêéÁöÑÁä∂ÊÄÅÊµÅËΩ¨Âõæ„ÄÇ Owner ReferencesOwner reference ÊèèËø∞‰∫ÜÂ§öÁßçËµÑÊ∫ê‰πãÈó¥ÁöÑÂÖ≥ËÅîÂÖ≥Á≥ª„ÄÇÂÆÉ‰ª¨ÊòØÂÖ≥‰∫éËµÑÊ∫êÁöÑÂ±ûÊÄßÔºåÂèØ‰ª•ÂΩºÊ≠§ÊåáÂÆöÂÖ≥ËÅîÂÖ≥Á≥ªÔºåÂõ†Ê≠§ÂèØ‰ª•ÂÅöÂà∞Á∫ßËÅîÂà†Èô§„ÄÇ Kubernetes ‰∏≠ÊúÄÂ∏∏ËßÅÁöÑÂÖ∑Â§á owner reference ÂÖ≥Á≥ªÁöÑÂú∫ÊôØÂ∞±ÊòØ pod Â∞Ü replica set ‰Ωú‰∏∫Ëá™Â∑±ÁöÑ ownerÔºåÊâÄ‰ª•ÂΩì deployment ÊàñËÄÖ statefulSet Âà†Èô§ÁöÑÊó∂ÂÄôÔºå‰Ωú‰∏∫Â≠êËµÑÊ∫êÁöÑ replica set Âíå pod ÈÉΩÂ∞ÜË¢´Âà†Èô§„ÄÇ ‰∏ãÈù¢ÁöÑ‰æãÂ≠êËß£Èáä‰∫Ü owner reference ÁöÑÂ∑•‰ΩúÂéüÁêÜ„ÄÇÊàë‰ª¨È¶ñÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™Áà∂ËµÑÊ∫êÔºåÁÑ∂ÂêéÂàõÂª∫Â≠êËµÑÊ∫êÁöÑÊó∂ÂÄôÊåáÂÆöÂÖ∂ owner referenceÔºö 12345678910111213141516171819cat &lt;&lt;EOF | kubectl create -f -apiVersion: v1kind: ConfigMapmetadata: name: mymap-parentEOFCM_UID=$(kubectl get configmap mymap-parent -o jsonpath="&#123;.metadata.uid&#125;")cat &lt;&lt;EOF | kubectl create -f -apiVersion: v1kind: ConfigMapmetadata: name: mymap-child ownerReferences: - apiVersion: v1 kind: ConfigMap name: mymap-parent uid: $CM_UIDEOF ÂΩìÂà†Èô§Â≠êËµÑÊ∫êÊó∂ÔºåÁà∂ËµÑÊ∫êÂπ∂‰∏ç‰ºöË¢´Âà†Èô§Ôºö 1234567891011kubectl get configmapNAME DATA AGEmymap-child 0 12m4smymap-parent 0 12m4skubectl delete configmap/mymap-childconfigmap "mymap-child" deletedkubectl get configmapNAME DATA AGEmymap-parent 0 12m10s Êàë‰ª¨ÂÜçÊ†πÊçÆ‰∏äÈù¢ÁöÑ yaml Âª∫Á´ãËµÑÊ∫êÔºåÁÑ∂ÂêéÊàë‰ª¨Âà†Èô§Áà∂ËµÑÊ∫êÔºåËøôÊó∂ÂèëÁé∞ÊâÄÊúâÁöÑËµÑÊ∫êÈÉΩË¢´Âà†Èô§‰∫ÜÔºö 12345678910kubectl get configmapNAME DATA AGEmymap-child 0 10m2smymap-parent 0 10m2skubectl delete configmap/mymap-parentconfigmap "mymap-parent" deletedkubectl get configmapNo resources found in default namespace. ÁÆÄËÄåË®Ä‰πãÔºåÂΩìÁà∂ - Â≠êËµÑÊ∫ê‰πãÈó¥Â≠òÂú® owner reference ÂÖ≥Á≥ªÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Âà†Èô§Áà∂ËµÑÊ∫êÔºåÂ≠êËµÑÊ∫ê‰πü‰ºöÈöè‰πãÂà†Èô§ÔºåËøôÂè´ÂÅö cascade ÔºàÁ∫ßËÅîÂà†Èô§Ôºâ„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåcascade ÁöÑÂÄºÊòØ trueÔºå‰Ω†ÂèØ‰ª•ÊâßË°å kubectl delete ÁöÑÊó∂ÂÄôÂä†‰∏äÂèÇÊï∞ --cascade=false ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Âè™Âà†Èô§Áà∂ËµÑÊ∫êËÄå‰øùÁïôÂ≠êËµÑÊ∫ê„ÄÇ Âú®‰ª•‰∏ãÁ§∫‰æã‰∏≠ÔºåÊúâ‰∏ÄÂØπÁà∂Â≠êËµÑÊ∫êÔºåÂ¶ÇÊûúÊàë‰ΩøÁî® --cascade = false Âà†Èô§Áà∂ËµÑÊ∫êÔºå‰ΩÜÂ≠êËµÑÊ∫ê‰ªçÁÑ∂Â≠òÂú®Ôºö 1234567891011kubectl get configmapNAME DATA AGEmymap-child 0 13m8smymap-parent 0 13m8skubectl delete --cascade=false configmap/mymap-parentconfigmap "mymap-parent" deletedkubectl get configmapNAME DATA AGEmymap-child 0 13m21s ‚Äî‚Äîcascade ÂèÇÊï∞ËÉΩÂ§üÊéßÂà∂ API ‰∏≠ÁöÑÂà†Èô§‰º†Êí≠Á≠ñÁï•Ôºà propagation policyÔºâÔºåÂÆÉÂÖÅËÆ∏ÊéßÂà∂Âà†Èô§ÂØπË±°ÁöÑÈ°∫Â∫è„ÄÇÂú®‰∏ãÈù¢ÁöÑÁ§∫‰æã‰∏≠Ôºå‰ΩøÁî® API ËÆøÈóÆÂàõÂª∫‰∏Ä‰∏™Â∏¶Êúâ background ‰º†Êí≠Á≠ñÁï•ÁöÑËá™ÂÆö‰πâ delete API Ë∞ÉÁî®Ôºö 1234567891011121314kubectl proxy --port=8080 &amp;Starting to serve on 127.0.0.1:8080curl -X DELETE \ localhost:8080/api/v1/namespaces/default/configmaps/mymap-parent \ -d &apos;&#123; &quot;kind&quot;:&quot;DeleteOptions&quot;, &quot;apiVersion&quot;:&quot;v1&quot;, &quot;propagationPolicy&quot;:&quot;Background&quot; &#125;&apos; \ -H &quot;Content-Type: application/json&quot;&#123; &quot;kind&quot;: &quot;Status&quot;, &quot;apiVersion&quot;: &quot;v1&quot;, &quot;metadata&quot;: &#123;&#125;, &quot;status&quot;: &quot;Success&quot;, &quot;details&quot;: &#123; ... &#125;&#125; Ë¶ÅÊ≥®ÊÑèÔºå‰∏çËÉΩ‰ΩøÁî® kubectl Âú®ÂëΩ‰ª§Ë°å‰∏äÊåáÂÆö‰º†Êí≠Á≠ñÁï•„ÄÇÂøÖÈ°ª‰ΩøÁî®Ëá™ÂÆö‰πâ API Ë∞ÉÁî®Êù•ÊåáÂÆö„ÄÇÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™‰ª£ÁêÜÔºåËøôÊ†∑Â∞±ÂèØ‰ª•‰ªéÂÆ¢Êà∑Á´ØËÆøÈóÆ API ServerÔºåÂπ∂ÊâßË°å curl ÂëΩ‰ª§Êù•ÊâßË°åËØ•Âà†Èô§ÂëΩ‰ª§„ÄÇ ‰∏ÄÂÖ±Êúâ‰∏âÁßç‰º†Êí≠Á≠ñÁï•Ôºö ForegroundÔºöÂÖàÂà†Èô§Â≠êËµÑÊ∫êÂÜçÂà†Èô§Áà∂ËµÑÊ∫êÔºàpost-orderÔºâ BackgroundÔºöÂÖàÂà†Èô§Áà∂ËµÑÊ∫êÂÜçÂà†Èô§Â≠êËµÑÊ∫êÔºàpre-orderÔºâ OrphanÔºöÂøΩÁï• owner reference Ë¶ÅÊ≥®ÊÑèÔºåÂÅáÂ¶Ç‰∏Ä‰∏™ËµÑÊ∫ê‰∏≠ÂêåÊó∂ËÆæÁΩÆ‰∫Ü owner reference Âíå finalizerÔºåfinalizer ÁöÑ‰ºòÂÖàÁ∫ßÊòØÊúÄÈ´òÁöÑ„ÄÇ Forcing a Deletion of a Namespace‰Ω†ÂèØ‰ª•Â∑≤ÁªèÈÅáÂà∞ËøáÊâßË°å kubectl delete ns NS ÂêéÔºåns Êó†Ê≥ïÂà†Èô§ÁöÑÊÉÖÂÜµÔºåËøôÊó∂ÂÄô‰Ω†ÂèØ‰ª•ÈÄöËøá update ÊâÄÂà†Èô§ ns ÁöÑ Finalizer Â≠óÊÆµÊù•ÂÆûË°åÂº∫Âà∂Âà†Èô§„ÄÇËøô‰∏™Êìç‰Ωú‰ºöÈÄöÁü•Âà∞ namespace controller ÁßªÈô§ finalizer Ôºö 123456789101112131415cat &lt;&lt;EOF | curl -X PUT \ localhost:8080/api/v1/namespaces/test/finalize \ -H "Content-Type: application/json" \ --data-binary @-&#123; "kind": "Namespace", "apiVersion": "v1", "metadata": &#123; "name": "test" &#125;, "spec": &#123; "finalizers": null &#125;&#125;EOF Ëøô‰∏™Êìç‰ΩúË¶ÅË∞®ÊÖéÔºåÂõ†‰∏∫ÂÆÉÂèØËÉΩÂè™Âà†Èô§ÂêçÁß∞Á©∫Èó¥ÔºåËÄåÂ∞ÜÂ≠§Á´ãËµÑÊ∫êÁïôÂú®Áé∞Âú®‰∏çÂ≠òÂú®ÁöÑÂêçÁß∞Á©∫Èó¥‰∏≠Ôºå‰ºöËÆ©ÈõÜÁæ§Â§Ñ‰∫éËÆ©‰∫∫ÂæàËø∑ÊÉëÁöÑÁä∂ÊÄÅ„ÄÇÂ¶ÇÊûúÂèëÁîüËøôÁßçÊÉÖÂÜµÔºåÂèØ‰ª•ÊâãÂä®ÈáçÊñ∞ÂàõÂª∫ËØ•ÂêçÁß∞Á©∫Èó¥ÔºåÊúâÂ≠§Á´ãÁöÑËµÑÊ∫êÂØπË±°Â∞ÜÈáçÊñ∞Âá∫Áé∞Âú®ÂàöÂàöÂàõÂª∫ÁöÑÂêçÁß∞Á©∫Èó¥‰∏ãÔºåÂèØ‰ª•ÊâãÂä®Ê∏ÖÁêÜÂíåÊÅ¢Â§ç„ÄÇ Key Takeaways‰∏äÈù¢ÁöÑ‰æãÂ≠êËØ¥ÊòéÔºåFinalizer ËÉΩÂ§üÈòªÊ≠¢ Kubernetes Âà†Èô§ËµÑÊ∫êÔºå‰ΩÜÊòØÈÄöÂ∏∏Âú®‰ª£Á†Å‰∏≠Ê∑ªÂä† Finalizer ÊòØÊúâÂéüÂõ†ÁöÑÔºåÂõ†Ê≠§Â∫îËØ•Âú®ÊâãÂä®Âà†Èô§ÂÆÉ‰πãÂâçËøõË°åÊ£ÄÊü•„ÄÇOwner reference ÊîØÊåÅÁ∫ßËÅîÂà†Èô§ËµÑÊ∫êÔºå‰ΩÜ Finalizer ÁöÑ‰ºòÂÖàÁ∫ßÊõ¥È´ò„ÄÇÊúÄÂêéÔºåÂèØ‰ª•‰ΩøÁî®‰º†Êí≠Á≠ñÁï•ÈÄöËøáËá™ÂÆö‰πâ API Ë∞ÉÁî®ÊåáÂÆöÂà†Èô§È°∫Â∫èÔºå‰ªéËÄåÊéßÂà∂ÂØπË±°ÁöÑÂà†Èô§ÊñπÂºè„ÄÇÈÄöËøá‰∏äÈù¢ÁöÑ‰æãÂ≠êÔºåÁõ∏‰ø°Â§ßÂÆ∂ÂØπ Kubernetes ‰∏≠ÁöÑÂà†Èô§Â∑•‰ΩúÂéüÁêÜÊúâ‰∫ÜÊõ¥Â§öÁöÑ‰∫ÜËß£ÔºåÁé∞Âú®ÂèØ‰ª•‰ΩøÁî®ÊµãËØïÈõÜÁæ§Ëá™Â∑±Â∞ùËØï‰∏Ä‰∏ã„ÄÇ ÂéüÊñáÂú∞ÂùÄÔºöhttps://kubernetes.io/blog/2021/05/14/using-finalizers-to-control-deletion/]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fuzzing is Beta Ready]]></title>
    <url>%2F2021%2F06%2F15%2FFuzzing-is-Beta-Ready%2F</url>
    <content type="text"><![CDATA[ËøëÊó• Golang Âõ¢ÈòüÂÆ£Â∏ÉÔºågo ÂéüÁîüÊîØÊåÅÁöÑÊ®°Á≥äÊµãËØï (fuzzing) ÁöÑ beta ÁâàÊú¨Âú® development ÂàÜÊîØ‰∏äÂ∑≤ÁªèÂèØ‰ª•‰ΩøÁî®‰∫Ü„ÄÇÂºÄÂèë‰∫∫ÂëòÂèØ‰ª•‰ΩøÁî®ËØ•ÁâπÊÄß‰∏∫È°πÁõÆÊûÑÂª∫ fuzzing ÊµãËØï„ÄÇ ÈÇ£‰πàÂÖàÊù•Áúã‰∏ã‰ªÄ‰πàÊòØ Fuzzing Âë¢Ôºü ‰ªÄ‰πàÊòØ FuzzingÔºüFuzz Êú¨ÊÑèÊòØ‚ÄúÁæΩÊØõ„ÄÅÁªÜÂ∞èÁöÑÊØõÂèë„ÄÅ‰ΩøÊ®°Á≥ä„ÄÅÂèòÂæóÊ®°Á≥ä‚ÄùÔºåÂêéÊù•Áî®Âú®ËΩØ‰ª∂ÊµãËØïÈ¢ÜÂüüÔºå‰∏≠Êñá‰∏ÄËà¨Êåá‚ÄúÊ®°Á≥äÊµãËØï‚ÄùÔºåËã±ÊñáÊúâÁöÑÂè´‚ÄúFuzzing‚ÄùÔºåÊúâÁöÑÂè´‚ÄúFuzz Testing‚Äù„ÄÇÊú¨ÊñáÁî® fuzzing Ë°®Á§∫Ê®°Á≥äÊµãËØï„ÄÇ Fuzzing ÊäÄÊúØÂèØ‰ª•ËøΩÊ∫ØÂà∞ 1950 Âπ¥ÔºåÂΩìÊó∂ËÆ°ÁÆóÊú∫ÁöÑÊï∞ÊçÆ‰∏ªË¶Å‰øùÂ≠òÂú®ÊâìÂ≠îÂç°Áâá‰∏äÔºåËÆ°ÁÆóÊú∫Á®ãÂ∫èËØªÂèñËøô‰∫õÂç°ÁâáÁöÑÊï∞ÊçÆËøõË°åËÆ°ÁÆóÂíåËæìÂá∫„ÄÇÂ¶ÇÊûúÁ¢∞Âà∞‰∏Ä‰∫õÂûÉÂúæÂç°ÁâáÊàñ‰∏Ä‰∫õÂ∫üÂºÉ‰∏çÈÄÇÈÖçÁöÑÂç°ÁâáÔºåÂØπÂ∫îÁöÑËÆ°ÁÆóÊú∫Á®ãÂ∫èÂ∞±ÂèØËÉΩ‰∫ßÁîüÈîôËØØÂíåÂºÇÂ∏∏ÁîöËá≥Â¥©Ê∫ÉÔºåËøôÊ†∑ÔºåBug Â∞±‰∫ßÁîü‰∫Ü„ÄÇÊâÄ‰ª•ÔºåFuzzing ÊäÄÊúØÂπ∂‰∏çÊòØ‰ªÄ‰πàÊñ∞È≤úÊäÄÊúØÔºåËÄåÊòØÈöèÁùÄËÆ°ÁÆóÊú∫ÁöÑ‰∫ßÁîü‰∏ÄËµ∑‰∫ßÁîüÁöÑÂè§ËÄÅÁöÑÊµãËØïÊäÄÊúØ„ÄÇ Fuzzing ÊäÄÊúØÊòØ‰∏ÄÁßçÂü∫‰∫éÈªëÁõíÔºàÊàñÁÅ∞ÁõíÔºâÁöÑÊµãËØïÊäÄÊúØÔºåÈÄöËøáËá™Âä®ÂåñÁîüÊàêÂπ∂ÊâßË°åÂ§ßÈáèÁöÑÈöèÊú∫ÊµãËØïÁî®‰æãÊù•ÂèëÁé∞‰∫ßÂìÅÊàñÂçèËÆÆÁöÑÊú™Áü•ÊºèÊ¥û„ÄÇÈöèÁùÄËÆ°ÁÆóÊú∫ÁöÑÂèëÂ±ïÔºåFuzzing ÊäÄÊúØ‰πüÂú®‰∏çÊñ≠ÂèëÂ±ï„ÄÇ FuzzingÊúâÁî®‰πàÔºüFuzzing ÊòØÊ®°Á≥äÊµãËØïÔºåÈ°æÂêçÊÄù‰πâÔºåÊÑèÂë≥ÁùÄÊµãËØïÁî®‰æãÊòØ‰∏çÁ°ÆÂÆöÁöÑ„ÄÅÊ®°Á≥äÁöÑ„ÄÇ ËÆ°ÁÆóÊú∫ÊòØÁ≤æÁ°ÆÁöÑÁßëÂ≠¶ÂíåÊäÄÊúØÔºåÊµãËØïÊäÄÊúØÂ∫îËØ•‰πüÊòØ‰∏ÄÊ†∑ÁöÑÔºåÊúâ‰ªÄ‰πàÁöÑËæìÂÖ•ÔºåÂØπÂ∫î‰ªÄ‰πàÊ†∑ÁöÑËæìÂá∫ÔºåÈÉΩÂ∫îËØ•ÊòØÊòéÁ°ÆÁöÑÔºåÊÄé‰πà‰ºöÊúâÊ®°Á≥ä‰∏çÁ°ÆÂÆöÁöÑÁî®‰æãÂë¢ÔºüËøô‰∫õ‰∏çÁ°ÆÂÆöÁöÑÊµãËØïÁî®‰æãÂÖ∑‰Ωì‰ºöÊúâ‰ªÄ‰πà‰ΩúÁî®Âë¢Ôºü ‰∏∫‰ªÄ‰πà‰ºöÊúâ‰∏çÁ°ÆÂÆöÁöÑÊµãËØïÁî®‰æãÔºåÊàëÊÉ≥‰∏ªË¶ÅÁöÑÂéüÂõ†ÊòØ‰∏ãÈù¢Âá†ÁÇπÔºö 1„ÄÅÊàë‰ª¨Êó†Ê≥ïÁ©∑‰∏æÊâÄÊúâÁöÑËæìÂÖ•‰Ωú‰∏∫ÊµãËØïÁî®‰æã„ÄÇÊàë‰ª¨ÁºñÂÜôÊµãËØïÁî®‰æãÁöÑÊó∂ÂÄôÔºå‰∏ÄËà¨ËÄÉËôëÊ≠£ÂêëÊµãËØï„ÄÅÂèçÂêëÊµãËØï„ÄÅËæπÁïåÂÄº„ÄÅË∂ÖÈïø„ÄÅË∂ÖÁü≠Á≠â‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÂú∫ÊôØÔºå‰ΩÜÊàë‰ª¨ÊòØÊ≤°ÊúâÂäûÊ≥ïÊääÊâÄÊúâÁöÑËæìÂÖ•ÈÉΩÈÅçÂéÜËøõË°åÊµãËØïÁöÑ„ÄÇ 2„ÄÅÊàë‰ª¨Êó†Ê≥ïÊÉ≥Âà∞ÊâÄÊúâÂèØËÉΩÁöÑÂºÇÂ∏∏Âú∫ÊôØ„ÄÇÁî±‰∫é‰∫∫Á±ªËÑëÂäõÁöÑÈôêÂà∂ÔºåÊàë‰ª¨Ê≤°ÊúâÂäûÊ≥ïÊÉ≥Âà∞ÊâÄÊúâÂèØËÉΩÁöÑÂºÇÂ∏∏ÁªÑÂêàÔºåÂ∞§ÂÖ∂ÊòØÁé∞Âú®ÁöÑËΩØ‰ª∂Ë∂äÊù•Ë∂äÂ§öÁöÑ‰æùËµñÊìç‰ΩúÁ≥ªÁªü„ÄÅ‰∏≠Èó¥‰ª∂„ÄÅÁ¨¨‰∏âÊñπÁªÑ‰ª∂ÔºåËøô‰∫õÁ≥ªÁªüÈáåÁöÑbugÊàñËÄÖÁªÑÂêàÂêéÂΩ¢ÊàêÁöÑ bugÔºåÊòØÊàë‰ª¨Êüê‰∏™È°πÁõÆÁªÑÁöÑÂºÄÂèë‰∫∫Âëò„ÄÅÊµãËØï‰∫∫ÂëòÊó†Ê≥ïÈ¢ÑÁü•ÁöÑ„ÄÇ 3„ÄÅFuzzing ËΩØ‰ª∂‰πüÂêåÊ†∑Êó†Ê≥ïÈÅçÂéÜÊâÄÊúâÁöÑÂºÇÂ∏∏Âú∫ÊôØ„ÄÇÈöèÁùÄÁé∞Âú®ËΩØ‰ª∂Ë∂äÊù•Ë∂äÂ§çÊùÇÔºåÂèØÈÄâÁöÑËæìÂÖ•ÂèØ‰ª•ËÆ§‰∏∫ÊúâÊó†Èôê‰∏™ÁªÑÂêàÔºåÊâÄ‰ª•Âç≥‰ΩøÊòØ‰ΩøÁî®ËΩØ‰ª∂Êù•ÈÅçÂéÜ‰πüÊòØ‰∏çÂèØËÉΩÂÆûÁé∞ÁöÑÔºåÂê¶Âàô‰Ω†ÁöÑÁâàÊú¨ÂèØËÉΩÂ∞±Ê∞∏Ëøú‰πüÂèëÂ∏É‰∏ç‰∫Ü„ÄÇFuzzing ÊäÄÊúØÊú¨Ë¥®ÊòØ‰æùÈù†ÈöèÊú∫ÂáΩÊï∞ÁîüÊàêÈöèÊú∫ÊµãËØïÁî®‰æãÊù•ËøõË°åÊµãËØïÈ™åËØÅÔºåÊâÄ‰ª•ÊòØ‰∏çÁ°ÆÂÆöÁöÑ„ÄÇ Ëøô‰∫õ‰∏çÁ°ÆÂÆöÁöÑÊµãËØïÁî®‰æã‰ºöËµ∑Âà∞Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÊµãËØïÁªìÊûú‰πàÔºüËÉΩÂèëÁé∞ÁúüÊ≠£ÁöÑ Bug ‰πàÔºü1„ÄÅFuzzing ÊäÄÊúØÈ¶ñÂÖàÊòØ‰∏ÄÁßçËá™Âä®ÂåñÊäÄÊúØÔºåÂç≥ËΩØ‰ª∂Ëá™Âä®ÊâßË°åÁõ∏ÂØπÈöèÊú∫ÁöÑÊµãËØïÁî®‰æã„ÄÇÂõ†‰∏∫ÊòØ‰æùÈù†ËÆ°ÁÆóÊú∫ËΩØ‰ª∂Ëá™Âä®ÊâßË°åÔºåÊâÄ‰ª•ÊµãËØïÊïàÁéáÁõ∏ÂØπ‰∫∫Êù•ËÆ≤ËøúËøúÈ´òÂá∫Âá†‰∏™Êï∞ÈáèÁ∫ß„ÄÇÊØîÂ¶ÇÔºå‰∏Ä‰∏™‰ºòÁßÄÁöÑÊµãËØï‰∫∫ÂëòÔºå‰∏ÄÂ§©ËÉΩÊâßË°åÁöÑÊµãËØïÁî®‰æãÊï∞ÈáèÊúÄÂ§ö‰πüÂ∞±ÊòØÂá†ÂçÅ‰∏™ÔºåÂæàÈöæËææÂà∞ 100 ‰∏™„ÄÇËÄå Fuzzing Â∑•ÂÖ∑ÂèØËÉΩÂá†ÂàÜÈíüÂ∞±ÂèØ‰ª•ËΩªÊùæÊâßË°å‰∏äÁôæ‰∏™ÊµãËØïÁî®‰æã„ÄÇ 2„ÄÅFuzzing ÊäÄÊúØÊú¨Ë¥®ÊòØ‰æùËµñÈöèÊú∫ÂáΩÊï∞ÁîüÊàêÈöèÊú∫ÊµãËØïÁî®‰æãÔºåÈöèÊú∫ÊÄßÊÑèÂë≥ÁùÄ‰∏çÈáçÂ§ç„ÄÅ‰∏çÂèØÈ¢ÑÊµãÔºåÂèØËÉΩÊúâÊÑèÊÉ≥‰∏çÂà∞ÁöÑËæìÂÖ•ÂíåÁªìÊûú„ÄÇ 3„ÄÅÊ†πÊçÆÊ¶ÇÁéáËÆ∫ÈáåÈù¢ÁöÑ‚ÄúÂ§ßÊï∞ÂÆöÂæã‚ÄùÔºåÂè™Ë¶ÅÊàë‰ª¨ÈáçÂ§çÁöÑÊ¨°Êï∞Â§üÂ§ö„ÄÅÈöèÊú∫ÊÄßÂ§üÂº∫ÔºåÈÇ£‰∫õÊ¶ÇÁéáÊûÅ‰ΩéÁöÑÂÅ∂ÁÑ∂‰∫ã‰ª∂Â∞±ÂøÖÁÑ∂‰ºöÂá∫Áé∞„ÄÇFuzzing ÊäÄÊúØÂ∞±ÊòØÂ§ßÊï∞ÂÆöÂæãÁöÑÂÖ∏ËåÉÂ∫îÁî®ÔºåË∂≥Â§üÂ§öÁöÑÊµãËØïÁî®‰æãÂíåÈöèÊú∫ÊÄßÔºåÂ∞±ÂèØ‰ª•ËÆ©ÈÇ£‰∫õÈöêËóèÁöÑÂæàÊ∑±ÂæàÈöæÂá∫Áé∞ÁöÑBugÊàê‰∏∫ÂøÖÁÑ∂Áé∞Ë±°„ÄÇ ÁõÆÂâçÔºåFuzzing ÊäÄÊúØÂ∑≤ÁªèÊòØËΩØ‰ª∂ÊµãËØï„ÄÅÊºèÊ¥ûÊåñÊéòÈ¢ÜÂüüÁöÑÊúÄÊúâÊïàÁöÑÊâãÊÆµ‰πã‰∏Ä„ÄÇFuzzing ÊäÄÊúØÁâπÂà´ÈÄÇÂêàÁî®‰∫éÂèëÁé∞ 0 Day ÊºèÊ¥ûÔºå‰πüÊòØ‰ºóÂ§öÈªëÂÆ¢ÊàñÈªëÂ∏ΩÂ≠êÂèëÁé∞ËΩØ‰ª∂ÊºèÊ¥ûÁöÑÈ¶ñÈÄâÊäÄÊúØ„ÄÇFuzzing ËôΩÁÑ∂‰∏çËÉΩÁõ¥Êé•ËææÂà∞ÂÖ•‰æµÁöÑÊïàÊûúÔºå‰ΩÜÊòØ Fuzzing ÈùûÂ∏∏ÂÆπÊòìÊâæÂà∞ËΩØ‰ª∂ÊàñÁ≥ªÁªüÁöÑÊºèÊ¥ûÔºå‰ª•Ê≠§‰∏∫Á™ÅÁ†¥Âè£Ê∑±ÂÖ•ÂàÜÊûêÔºåÂ∞±Êõ¥ÂÆπÊòìÊâæÂà∞ÂÖ•‰æµË∑ØÂæÑÔºåËøôÂ∞±ÊòØÈªëÂÆ¢ÂñúÊ¨¢ Fuzzing ÊäÄÊúØÁöÑÂéüÂõ†„ÄÇ ÊÉ≥Ë¶Å‰∫ÜËß£Êõ¥Â§öÁâπÊÄßÂèØ‰ª•ÂèÇËÄÉ golang fuzzing ÁöÑËÆæËÆ°ËçâÊ°à draft-fuzzing) Âø´ÈÄü‰∏äÊâã12$ go get golang.org/dl/gotip$ gotip download dev.fuzz ËøôÂ∞Ü‰ªé Dev.Fuzz ÂºÄÂèëÂàÜÊîØ‰∏≠ÊûÑÂª∫ Go ToolchainÔºåÁ≠âÂ∞ÜÊù•‰ª£Á†ÅÂêàÂπ∂Âà∞ Master ÂàÜÊîØÂêéÂ∞±‰∏çÈúÄË¶ÅËá™Â∑±ÊûÑÂª∫‰∫Ü„ÄÇ 1gotip test -fuzz=FuzzFoo DEV.Fuzz ÂàÜÊîØ‰∏≠‰ºöÊúâÊ≠£Âú®ËøõË°åÁöÑÂºÄÂèëÂíåÈîôËØØ‰øÆÂ§çÔºåÈúÄË¶ÅÊØèÊ¨°ËøêË°å gotip download dev.fuzz ‰ª•ÊãâÂèñÊúÄÊñ∞ÁöÑ‰ª£Á†Å„ÄÇ ‰∏∫‰∫Ü‰øùÈöú‰ª£Á†ÅÂÖºÂÆπÊÄßÔºåÂú®Êèê‰∫§ÂåÖÂê´Ê®°Á≥äÊµãËØïÁöÑÊ∫êÊñá‰ª∂Êó∂‰ΩøÁî® gofuzzbeta ÊûÑÂª∫ tag„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÂú®Dev.FuzzÂàÜÊîØ‰∏≠ÁöÑÊûÑÂª∫Êó∂Â∑≤ÁªèÂêØÁî®Ê≠§ tag„ÄÇ 1// +build gofuzzbeta Fuzz ÊµãËØïÊ†∑‰æãFuzz ÊµãËØï‰∏éÊôÆÈÄöÁöÑÂçïÂÖÉÊµãËØïÁ±ª‰ººÔºåÈúÄË¶ÅÂú® *_test.go ‰∏≠ÂÆö‰πâ Fuzzxxx ÂáΩÊï∞„ÄÇ Ê≠§ÂáΩÊï∞ÂøÖÈ°ª‰º†ÈÄí*testing.f ÂèÇÊï∞ÔºåÂ∞±ÂÉè * testing.t ÂèÇÊï∞‰º†ÈÄíÁªô testxxx ÂáΩÊï∞‰∏ÄÊ†∑„ÄÇ ‰∏ãÈù¢ÊòØÊµãËØï net/url ÁöÑ fuzzing target ÁöÑÁ§∫‰æã„ÄÇ 123456789101112131415161718192021222324252627// +build gofuzzbetapackage fuzzimport ( "net/url" "reflect" "testing")func FuzzParseQuery(f *testing.F) &#123; f.Add("x=1&amp;y=2") f.Fuzz(func(t *testing.T, queryStr string) &#123; query, err := url.ParseQuery(queryStr) if err != nil &#123; t.Skip() &#125; queryStr2 := query.Encode() query2, err := url.ParseQuery(queryStr2) if err != nil &#123; t.Fatalf("ParseQuery failed to decode a valid encoded query %s: %v", queryStr2, err) &#125; if !reflect.DeepEqual(query, query2) &#123; t.Errorf("ParseQuery gave different query after being encoded\nbefore: %v\nafter: %v", query, query2) &#125; &#125;)&#125; ÂèØ‰ª•ÈÄöËøá‰∏ãÈù¢ÁöÑÂëΩ‰ª§‰ΩøÁî® Go Doc ÈòÖËØªÊúâÂÖ≥ Fuzz API ÁöÑÊõ¥Â§ö‰ø°ÊÅØ„ÄÇ 1234gotip doc testinggotip doc testing.Fgotip doc testing.F.Addgotip doc testing.F.Fuzz È°ªÁü• Ê®°Á≥äÊµãËØï‰ºöÊ∂àËÄóÂ§ßÈáèÂÜÖÂ≠òÔºåÂπ∂Âú®ËøêË°åÊó∂ÂèØËÉΩ‰ºöÂΩ±ÂìçÊú∫Âô®ÁöÑÊÄßËÉΩ„ÄÇ go test -fuzz ÈªòËÆ§ÂÄº‰ª•Âπ∂Ë°åËøêË°å $ gomaxProcs ËøõÁ®ã‰∏≠ÁöÑÊ®°Á≥ä„ÄÇ ÂèØ‰ª•Âú®ËøêË°å Go Test Êó∂Âä†‰∏ä --parallel Êù•ÈôêÂà∂Âπ∂Âèë‰ΩøÁî® cpu ÁöÑÊï∞Èáè„ÄÇ Ë¶ÅÊ≥®ÊÑèÁõÆÂâçÊ≤°ÊúâÈôêÂà∂ÂÜôÂÖ• fuzzing ÁºìÂ≠òÁöÑÊñá‰ª∂Êï∞ÊàñÊÄªÂ≠óËäÇÊï∞ÔºåÂõ†Ê≠§ÂÆÉÂèØËÉΩÂç†ÊçÆÂ§ßÈáèÂ≠òÂÇ®ÔºàÂç≥Âá†‰∏™GBÔºâÔºåÂèØ‰ª•ÈÄöËøáËøêË°å gotip clean -fuzzcache Êù•Ê∏ÖÈô§Ê®°Á≥äÊµãËØïÂêéÁöÑÁºìÂ≠ò„ÄÇ ÊúÄÂêéËøô‰∏™ÁâπÊÄßÂπ∂‰∏ç‰ºöÂá∫Áé∞Âú®Âç≥Â∞ÜÂèëÂ∏ÉÁöÑ Go1.17 ‰∏≠Ôºå‰ΩÜÊòØËÆ°ÂàíÂú®Êú™Êù•ÁöÑÊüê‰∏™ Go ÁâàÊú¨‰∏≠Ê≠£Âºè release Ëøô‰∏™ÁâπÊÄß„ÄÇÂÆòÊñπÂ∏åÊúõËøô‰∏™ÁâπÊÄßËÉΩÂ§üÂ∏ÆÂä© Go ÂºÄÂèë‰∫∫ÂëòÂºÄÂßãÁºñÂÜô fuzzing ÊµãËØïÔºåÂπ∂Êèê‰æõÂÖ≥‰∫é fuzzing ÁöÑËÆæËÆ°ÁöÑÂèçÈ¶àÔºå‰∏∫Êú™Êù•ËØ•ÂäüËÉΩÁöÑ‰ª£Á†ÅÊ≠£ÂºèÂêàÂπ∂ master ÂÅöÂáÜÂ§á„ÄÇ Happy fuzzing!]]></content>
      <categories>
        <category>Go</category>
      </categories>
      <tags>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Go 1.16 is released, Apple silicon M1 ÂèØ‰ª•ÊîæÂøÉ‰π∞Âï¶]]></title>
    <url>%2F2021%2F02%2F20%2FGo-1-16-is-released-Apple-silicon-M1-%E5%8F%AF%E4%BB%A5%E6%94%BE%E5%BF%83%E4%B9%B0%E5%95%A6%2F</url>
    <content type="text"><![CDATA[2021 Âπ¥ 2 Êúà 16 Êó•ÔºåÊò•ËäÇÂÅáÊúüÁöÑÊúÄÂêé‰∏ÄÂ§©ÔºåGo ÂÆòÊñπÁªà‰∫éÂ∞Ü 1.16 ÁâàÊú¨ released„ÄÇ ‰∏ãÈù¢ÁÆÄË¶Å‰ªãÁªç‰∏Ä‰∏ã 1.16 ÁâàÊú¨ÊúÄÈáçË¶ÅÁöÑ‰∏Ä‰∫õÁâπÊÄßÔºö Ê†∏ÂøÉÂ∫ìÂä†ÂÖ•‰∫ÜÊñ∞ÁöÑÊàêÂëò - embedpackage embed ÂèØËÆøÈóÆÊ≠£Âú®ËøêË°åÁöÑ Go Á®ãÂ∫è‰∏≠ÊâÄÂµåÂÖ•ÁöÑÈùôÊÄÅÊñá‰ª∂„ÄÇ ‰ΩøÁî® embed ÂèØ‰ª•‰ΩøÁî® // goÔºöembed Êåá‰ª§Âú®ÁºñËØëÊó∂‰ªéÂåÖÁõÆÂΩïÊàñÂ≠êÁõÆÂΩïËØªÂèñÁöÑÊñá‰ª∂ÁöÑÂÜÖÂÆπÂπ∂‰ΩøÁî®ÂÆÉ‰ª¨„ÄÇ ‰æãÂ¶ÇÔºå‰ª•‰∏ã‰∏âÁßçÊñπÊ≥ïÂèØ‰ª•ÂµåÂÖ•Âêç‰∏∫ hello.txt ÁöÑÊñá‰ª∂ÔºåÁÑ∂ÂêéÂú®ËøêË°åÊó∂ÊâìÂç∞ÂÖ∂ÂÜÖÂÆπ„ÄÇ Â∞Ü‰∏Ä‰∏™Êñá‰ª∂ÂµåÂÖ•Âà∞Â≠óÁ¨¶‰∏≤‰∏≠ 12345import _ "embed"//go:embed hello.txtvar s stringprint(s) Â∞Ü‰∏Ä‰∏™Êñá‰ª∂ÂµåÂÖ• []byte 12345import _ "embed"//go:embed hello.txtvar b []byteprint(string(b)) Â∞Ü‰∏Ä‰∏™ÊàñÂ§ö‰∏™Êñá‰ª∂ÂµåÂÖ•Âà∞Êñá‰ª∂Á≥ªÁªü‰∏≠ 123456import "embed"//go:embed hello.txtvar f embed.FSdata, _ := f.ReadFile("hello.txt")print(string(data)) ËøôÁßçÂ∞ÜÈùôÊÄÅÊñá‰ª∂Âú®ÁºñËØëÊó∂ÂµåÂÖ•ÂèØÊâßË°åÊñá‰ª∂ÁöÑÊñπÂºèÔºåÂú®ÊûÅÂ§ßÂú∞ÊèêÈ´ò‰∫Ü go ËÆøÈóÆÈùôÊÄÅÊñá‰ª∂ÁöÑÁÅµÊ¥ªÊÄßÁöÑÂêåÊó∂Ôºå‰πüËÉΩÊèêÈ´ò‰∫ÜÊïèÊÑüÈÖçÁΩÆÊñá‰ª∂ÁöÑÂÆâÂÖ®ÊÄß„ÄÇÊõ¥Â§ßËÉÜ‰∏ÄÁÇπÔºåÊòØ‰∏çÊòØÂú®ÂâçÁ´ØÈ¢ÜÂüüÔºågolang ‰πüËÉΩÊèí‰∏ÄËÑö‰∫ÜÔºü Â¢ûÂä†ÂØπ Apple silicon ARM 64 Êû∂ÊûÑÁöÑÊîØÊåÅGo 1.16 ËøòÊ∑ªÂä†‰∫ÜmacOS ARM64 ÊîØÊåÅÔºà‰πüÁß∞‰∏∫Apple siliconÔºâ„ÄÇ Ëá™ Apple ÂÆ£Â∏ÉÂÖ∂Êñ∞ÁöÑ ARM64 Êû∂ÊûÑ‰ª•Êù•Ôºågo team ‰∏ÄÁõ¥Âú®‰∏é‰ªñ‰ª¨Á¥ßÂØÜÂêà‰Ωú‰ª•Á°Æ‰øù Go ÂæóÂà∞ÂÆåÂÖ®ÁöÑÊîØÊåÅ„ÄÇ‰∏ÄÁõ¥Âú® ËßÇÊúõ M1 ÁöÑÂºÄÂèëËÄÖËøô‰∏ãÂèØ‰ª•ÊîæÂøÉÂéª‰π∞Êñ∞ÁöÑ Mac Âï¶„ÄÇ ÈªòËÆ§ÂºÄÂêØ Go modulesGo 1.16 ÈªòËÆ§‰ΩøÁî® Go modules„ÄÇÂõ†‰∏∫Ê†πÊçÆ go team ÁöÑ 2020 Go ÂºÄÂèë‰∫∫ÂëòË∞ÉÊü•ÔºåÁé∞Âú®Êúâ96ÔºÖÁöÑ Go ÂºÄÂèë‰∫∫ÂëòÂ∑≤ÁªèÂú®‰ΩøÁî® Go modules‰∫Ü„ÄÇ ÂÖ∂‰ªñÁöÑÊÄßËÉΩÊîπÂñÑ‰∏éÊèêÈ´òÊúÄÂêéÔºåËøòÊúâËÆ∏Â§öÂÖ∂‰ªñÊîπËøõÂíå bug fixÔºåÊØîÂ¶ÇÊûÑÂª∫ÈÄüÂ∫¶ÊèêÈ´ò‰∫Ü25ÔºÖÔºåÂÜÖÂ≠ò‰ΩøÁî®ÈáèÂáèÂ∞ë‰∫Ü15ÔºÖ„ÄÇ ÊúâÂÖ≥Êõ¥ÊîπÁöÑÂÆåÊï¥ÂàóË°®‰ª•ÂèäÊúâÂÖ≥‰∏äËø∞ÊîπËøõÁöÑÊõ¥Â§ö‰ø°ÊÅØÔºåÂèØ‰ª•ÂèÇËÄÉ Go 1.16ÂèëË°åËØ¥Êòé)„ÄÇ ‰ª•‰∏äÂ∞±ÊòØ Go 1.16 Â∏¶Êù•ÁöÑÊñ∞ÁâπÊÄßÔºåÊúâÂºÄÂèëËÄÖË∞É‰æÉÂà∞ ‚ÄúÊúÄÂ§ßÁöÑÁâπÊÄßÂ∞±ÊòØÁ¶ªÊ≥õÂûãÁöÑÁâàÊú¨Âè∑Êõ¥Ëøë‰∫ÜÔºàÁãóÂ§¥Ôºâ‚ÄùÂìàÂìàÂìà„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Redirecting godoc.org requests to pkg.go.dev]]></title>
    <url>%2F2020%2F12%2F16%2FRedirecting-godoc-org-requests-to-pkg-go-dev%2F</url>
    <content type="text"><![CDATA[Áé∞Áä∂ÈöèÁùÄ Go Module ÁöÑÂºïÂÖ•Âíå Go ÁîüÊÄÅÁ≥ªÁªüÁöÑÂèëÂ±ïÔºåpkg.go.dev ‰∫é 2019 Âπ¥ÂêØÂä®Ôºå‰∏∫ÂºÄÂèë‰∫∫ÂëòÊèê‰æõ‰∫Ü‰∫Ü‰∏Ä‰∏™Êü•Êâæ Go package ÁöÑÂú∞ÊñπÔºåÂÆòÊñπÁß∞‰πã‰∏∫ center place„ÄÇ ÂÉè godoc.org ‰∏ÄÊ†∑Ôºåpkg.go.dev Êèê‰æõ Go ÊñáÊ°£Ôºå‰ΩÜÂÆÉ‰πüÊîØÊåÅ Go Module„ÄÅÊõ¥Â•ΩÁöÑÊêúÁ¥¢ÂäüËÉΩ‰ª•ÂèäÂ∏ÆÂä© Go Áî®Êà∑ÊâæÂà∞Ê≠£Á°ÆËΩØ‰ª∂ÂåÖÁöÑÊåáÂºï„ÄÇ Ê≠£Â¶ÇÂÆòÊñπÂú® 2020Âπ¥1ÊúàÂàÜ‰∫´ ÁöÑÈÇ£Ê†∑ÔºåÂÆòÊñπÁöÑÁõÆÊ†áÊòØÊúÄÁªàÂ∞ÜÊµÅÈáè‰ªé godoc.org ÈáçÂÆöÂêëÂà∞ pkg.go.dev ‰∏äÁöÑÁõ∏Â∫îÈ°µÈù¢„ÄÇ Áî®Êà∑ÂèØ‰ª•ËøòÂèØ‰ª•ÈÄâÊã©Â∞ÜËá™Â∑±ÁöÑËØ∑Ê±Ç‰ªégodoc.org ÈáçÂÆöÂêëÂà∞ pkg.go.dev„ÄÇ ‰ªäÂπ¥ÂÆòÊñπÊî∂Âà∞‰∫ÜÂæàÂ§öÂèçÈ¶àÔºåÂæàÂ§öÈóÆÈ¢òÂ∑≤ÁªèÂú® pkgsite/godoc.org-redirect Âíå pkgsite/design-2020 ËøõË°åË∑üË∏™ÂíåËß£ÂÜ≥„ÄÇ Áî®Êà∑ÁöÑÂèçÈ¶àÊÑèËßÅÊîØÊåÅÂØπ pkg.go.dev ‰∏äÁöÑÈ´òÈ¢ëÂäüËÉΩÁöÑÊîπËøõÔºå‰ª•ÂèäÊúÄËøëÂØπpkg.go.dev ÁöÑÈáçÊñ∞ËÆæËÆ°ÈÉΩÊúâÂæàÂ§ßÁöÑÂ∏ÆÂä©„ÄÇ ‰∏ã‰∏ÄÊ≠•‰∏ÄÊó¶Âú® pkgsite/godoc.org-redirect ÈáåÁ®ãÁ¢ë‰∏≠Ë∑üË∏™ÁöÑÂ∑•‰ΩúÂÆåÊàê, ÂÆòÊñπÂ∞±‰ºöÂ∞ÜÊâÄÊúâËØ∑Ê±Ç‰ªé godoc.org ÈáçÂÆöÂêëÂà∞pkg.go.dev‰∏äÁöÑÁõ∏Â∫îÈ°µÈù¢,ËøôÂ§ßÊ¶Ç‰ºöÂú®2021 Âπ¥ÂàùÂºÄÂßã„ÄÇ ÂÆòÊñπÈºìÂä±Â§ßÂÆ∂Áé∞Áä∂Â∞±ÂºÄÂßã‰ΩøÁî® pkg.go.dev, ÂèØ‰ª•ÈÄöËøáËÆøÈóÆ godoc.org?redirect=on ÊàñÂçïÂáª‰ªª‰Ωïgodoc.org È°µÈù¢Âè≥‰∏äËßíÁöÑ ‚ÄúAlways use pkg.go.dev‚Äù Êù•ÂÆûÁé∞„ÄÇ FAQs A: godoc.org ËøòÂèØ‰ª•ÁªßÁª≠‰ΩøÁî®ÂêóÔºüQ: YES! Êàë‰ª¨‰ºöÂ∞ÜÊâÄÊúâËÆøÈóÆ godoc.org ÁöÑËØ∑Ê±ÇÈáçÂÆöÂêëÂà∞ pkg.go.dev ‰∏äÁöÑÁõ∏Â∫îÈ°µÈù¢ÔºåÂõ†Ê≠§‰Ω†ÊâÄÊúâÁöÑ‰π¶Á≠æÂíåÈìæÊé•‰æùÁÑ∂ÊúâÊïà„ÄÇ A: golang/gddo repo Â∞Ü‰ºöÂ¶Ç‰ΩïÂ§ÑÁêÜÔºüQ: repo ÂèØ‰ª•ÁªßÁª≠ fork Âíå‰ΩøÁî®Ôºå‰ΩÜÊòØÂÆòÊñπÂ∞ÜÂØπÂÖ∂Ê†áËÆ∞‰∏∫ archived„ÄÇ A: api.godoc.org ËøòËÉΩÁªßÁª≠‰ΩøÁî®ÂêóÔºüQ: Ê≠§ËøáÊ∏°‰∏ç‰ºöÂØπ api.godoc.org ‰∫ßÁîüÂΩ±Âìç„ÄÇ Âú® pkg.go.dev Êèê‰æõ API ‰πãÂâçÔºåapi.godoc.org Â∞ÜÁªßÁª≠‰∏∫ÊµÅÈáèÊèê‰æõÊúçÂä°„ÄÇ ÊúâÂÖ≥ pkg.go.dev ÁöÑ API ÁöÑÊõ¥Êñ∞ÔºåËØ∑ÂèÇËßÅ issue 36785„ÄÇ Contributing Pkg.go.dev ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÈ°πÁõÆ„ÄÇ Â¶ÇÊûú‰Ω†ÊúâÂÖ¥Ë∂£‰∏∫ pkg site ÂÅöÂá∫Ë¥°ÁåÆÔºåÂèØ‰ª•Âä†ÂÖ• Gophers Slack ‰∏äÁöÑ #pkgsite È¢ëÈÅì‰ª•‰∫ÜËß£Êõ¥Â§ö‰ø°ÊÅØ„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Can I convert a []T to an []interface{}?]]></title>
    <url>%2F2020%2F12%2F09%2FCan-I-convert-a-T-to-an-interface%2F</url>
    <content type="text"><![CDATA[Can I convert a []T to an []interface{}?‰ºóÊâÄÂë®Áü•ÔºåÂú® Golang ‰∏≠Ôºåinterface ÊòØ‰∏ÄÁßçÊäΩË±°Á±ªÂûãÔºåÁõ∏ÂØπ‰∫éÊäΩË±°Á±ªÂûãÁöÑÊòØÂÖ∑‰ΩìÁ±ªÂûãÔºàconcrete typeÔºâÔºöintÔºåstring„ÄÇinterface{} ÊòØ‰∏Ä‰∏™Á©∫ÁöÑ interface Á±ªÂûãÔºå‰∏Ä‰∏™Á±ªÂûãÂ¶ÇÊûúÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ interface ÁöÑÊâÄÊúâÊñπÊ≥ïÂ∞±ËØ¥ËØ•Á±ªÂûãÂÆûÁé∞‰∫ÜËøô‰∏™ interfaceÔºåÁ©∫ÁöÑ interface Ê≤°ÊúâÊñπÊ≥ïÔºåÊâÄ‰ª•ÂèØ‰ª•ËÆ§‰∏∫ÊâÄÊúâÁöÑÁ±ªÂûãÈÉΩÂÆûÁé∞‰∫Ü interface{}„ÄÇÂ¶ÇÊûúÂÆö‰πâ‰∏Ä‰∏™ÂáΩÊï∞ÂèÇÊï∞ÊòØ interface{} Á±ªÂûãÔºåËøô‰∏™ÂáΩÊï∞Â∫îËØ•ÂèØ‰ª•Êé•Âèó‰ªª‰ΩïÁ±ªÂûã‰Ωú‰∏∫ÂÆÉÁöÑÂèÇÊï∞„ÄÇ 12func changeType(v interface&#123;&#125;)&#123; &#125; Êó¢ÁÑ∂Á©∫ÁöÑ interface ÂèØ‰ª•Êé•Âèó‰ªª‰ΩïÁ±ªÂûãÁöÑÂèÇÊï∞ÔºåÈÇ£‰πà‰∏Ä‰∏™ interface{}Á±ªÂûãÁöÑ slice ÊòØ‰∏çÊòØÂ∞±ÂèØ‰ª•Êé•Âèó‰ªª‰ΩïÁ±ªÂûãÁöÑ slice ?Áúã‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö 12345678910func traverseSlice(vals []interface&#123;&#125;) &#123; for _, val := range vals &#123; fmt.Println(val) &#125;&#125;func main()&#123; nums := []string&#123;"1", "2", "3"&#125; traverseSlice(nums)&#125; ‰∏çÊòØËØ¥Á©∫ÁöÑ interface ÂèØ‰ª•ÊòØ‰ªª‰ΩïÁ±ªÂûãÂêóÔºü‰∏∫‰ΩïÊä•‰∫Ü‰∏ãÈù¢ÁöÑÈîôËØØÔºü Ëøô‰∏™ÈîôËØØËØ¥Êòé go Ê≤°ÊúâËá™Âä®Êää []string ËΩ¨Êç¢Êàê []interface{} ÔºåÊâÄ‰ª•Âá∫Èîô‰∫Ü„ÄÇgo ‰∏ç‰ºöÂØπ Á±ªÂûãÊòØinterface{} ÁöÑ slice ËøõË°åËΩ¨Êç¢ „ÄÇ‰∏∫‰ªÄ‰πà go ‰∏çÂ∏ÆÊàë‰ª¨Ëá™Âä®ËΩ¨Êç¢? Âú® golang ÂÆòÊñπ blog ÁöÑ FAQ ‰∏≠ÊâæÂà∞‰∫ÜÂØπËøô‰∏™ÈóÆÈ¢òÁöÑËß£ÈáäÔºåÁî±‰∫éinterface{} ‰ºöÂç†Áî®‰∏§ÈÉ®ÂàÜÂ≠òÂÇ®Á©∫Èó¥Ôºå‰∏Ä‰∏™ÊòØËá™Ë∫´ÁöÑ methods Êï∞ÊçÆÔºå‰∏Ä‰∏™ÊòØÊåáÂêëÂÖ∂Â≠òÂÇ®ÂÄºÁöÑÊåáÈíàÔºå‰πüÂ∞±ÊòØ interface ÂèòÈáèÂ≠òÂÇ®ÁöÑÂÄºÔºåÂõ†ËÄå slice []interface{} ÂÖ∂ÈïøÂ∫¶ÊòØÂõ∫ÂÆöÁöÑN*2Ôºå‰ΩÜÊòØ []T ÁöÑÈïøÂ∫¶ÊòØN*sizeof(T)ÔºåÁî®ÂÆòÊñπÁöÑËß£ÈáäÂ∞±ÊòØ‰∏§ÁßçÁ±ªÂûãÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑË°®Áé∞ÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ„ÄÇÈÇ£ËØ•Â¶Ç‰ΩïÂéªËΩ¨Êç¢Âë¢ÔºüÂèØ‰ª•ÊåâÁÖßÂçï‰∏™ÂÖÉÁ¥†Êù•ËΩ¨Êç¢Ôºö 123456789101112import "fmt"func main() &#123; t := []int&#123;1, 2, 3, 4&#125; s := make([]interface&#123;&#125;, len(t)) for i, v := range t &#123; s[i] = v &#125; fmt.Println(s)&#125; ÈôÑ https://golang.org/doc/faq#convert_slice_of_interface ÂØπËøô‰∏™ÈóÆÈ¢òÁöÑËß£ÈáäÔºö]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[kubectl delete pod Á≠âÂæÖ 30s ÁöÑÈóÆÈ¢òÊéíÊü•‰∏éËß£ÂÜ≥]]></title>
    <url>%2F2020%2F11%2F23%2Fkubectl-delete-pod-%E7%AD%89%E5%BE%85-30s-%E7%9A%84%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E4%B8%8E%E8%A7%A3%E5%86%B3%2F</url>
    <content type="text"><![CDATA[Êàë‰ª¨Âπ≥Êó∂Âú®‰ΩøÁî® Kubernetes ÁöÑÊó∂ÂÄôÔºå‰∏ÄËà¨‰ºö‰ΩøÁî® kubectl delete pod podName ÁöÑÊñπÂºèÂà†Èô§‰∏Ä‰∏™ÂÆπÂô®„ÄÇ ‰ΩÜÊàë‰ª¨ÂèëÁé∞ÔºåÊØèÊ¨°ÊâßË°å kubectl delete pod ‰πãÂêéÈÉΩË¶ÅÁ≠âÂæÖ 30s kubectl Êâç‰ºöËøîÂõû„ÄÇ‰πüËÆ∏‰Ω†‰ºöËßâÂæó 30s ÊòØ‰∏Ä‰∏™ÂèØ‰ª•ÂøçÂèóÁöÑÊó∂Èó¥Ôºå Âè™Ë¶ÅÊúÄÁªàËÉΩÂà†Êéâ pod Â∞±Ë°åÔºå‰ΩÜËøôÊ†∑ÁöÑÈóÆÈ¢òÁúüÁöÑÂè™Êúâ 30s Ëøô‰πàÁÆÄÂçïÂêóÔºü ‰∏∫‰ªÄ‰πà‰∏çËÉΩÂæàÂø´ÂÖ≥Èó≠ÂÆπÂô®Âë¢Ôºü ÊàñËÄÖ‰∏∫‰ªÄ‰πàÊÅ∞Â•ΩÂ∞±ÊòØ 30s Âë¢Ôºü‰∏ãÈù¢Â∞±ËÆ©Êàë‰ª¨‰ªéÊ†πÊ∫êÂºÑÊ∏ÖÊ•öËøô‰ª∂‰∫ãÊÉÖÂπ∂Ëß£ÂÜ≥ÂÆÉ„ÄÇ kubectl delete Â¶Ç‰ΩïÂÖ≥Èó≠Âπ∂Âà†Èô§ÂÆπÂô®Ôºükubectl delete ÂëΩ‰ª§ÊòØÂú®ÂØπÂÆπÂô®ÂèëÂá∫ÂÅúÊ≠¢ÂëΩ‰ª§Êó∂‰ΩøÁî®ÁöÑÔºå‰ªéÂèëÈÄÅ‰ø°Âè∑‰∏äÊù•ËÆ≤ÔºåÂÆÉÂ∞ÜÂèëÈÄÅ SIGTERM ‰ø°Âè∑ÁªôÂÆπÂô®ÔºåÈÄöÁü•ÂÖ∂ÁªìÊùüËøêË°å„ÄÇ SIGINT ‰∏ÄËà¨Áî®‰∫éÂÖ≥Èó≠ÂâçÂè∞ËøõÁ®ãÔºåSIGTERM ‰ºöË¶ÅÊ±ÇËøõÁ®ãËá™Â∑±Ê≠£Â∏∏ÈÄÄÂá∫„ÄÇ ÂΩìÊàë‰ª¨Âú® shell ‰∏≠ÁªôËøõÁ®ãÂèëÈÄÅ SIGTERM Âíå SIGINT ‰ø°Âè∑ÁöÑÊó∂ÂÄôÔºåËøô‰∫õËøõÁ®ãÂæÄÂæÄÈÉΩËÉΩÊ≠£Á°ÆÁöÑÂ§ÑÁêÜ„ÄÇ ‰ΩÜÊòØÂú®ÂÆπÂô®‰∏≠Âç¥‰∏çÁîüÊïà, ËøôÊòØÂõ†‰∏∫Âú® docker ‰∏≠ÔºåÂè™‰ºöÂ∞Ü SIGTERM Á≠âÊâÄÊúâÁöÑ signal ‰ø°Âè∑ÂèëÈÄÅÁªô PID ‰∏∫ 1 ÁöÑËøõÁ®ãÔºåÂΩìÊàë‰ª¨ docker ‰∏≠ËøêË°åÁöÑËøõÁ®ãÁöÑ PID ‰∏çÊòØ 1 Êó∂ÔºåÂ∞±‰∏ç‰ºöÊî∂Âà∞ËøôÊ†∑ÁöÑ‰ø°Âè∑„ÄÇ ÈÇ£‰πà‰∏∫‰ªÄ‰πàÊòØÁ≠âÂæÖ 30s ? ‰∏äÂõæÊòØÂÆòÊñπÊñáÊ°£ÁöÑ‰∏ÄÊÆµÊà™ÂõæÔºåKubernetes ÁöÑ pod ‰∏≠Êúâ‰∏Ä‰∏™ÂèÇÊï∞ terminationGracePeriodSecondsÔºåÊ≠§Êó∂Ôºåk8s Á≠âÂæÖÊåáÂÆöÁöÑÊó∂Èó¥Áß∞‰∏∫‰ºòÈõÖÁªàÊ≠¢ÂÆΩÈôêÊúü„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËøô‰∏™ÂÄºÊòØ 30s„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåËøô‰∏™ËøáÁ®ã‰∏≠ preStop Hook Âíå SIGTERM ‰ø°Âè∑Âπ∂Ë°åÂèëÁîü„ÄÇKubernetes ‰∏ç‰ºöÁ≠âÂæÖ preStop Hook ÂÆåÊàê„ÄÇËøôÊÑèÂë≥ÁùÄÂ¶ÇÊûú‰Ω†ÁöÑÂ∫îÁî®Á®ãÂ∫èÂÆåÊàêÂÖ≥Èó≠Âπ∂Âú® terminationGracePeriod ÂÆåÊàê‰πãÂâçÈÄÄÂá∫ÔºåKubernetes ‰ºöÁ´ãÂç≥ËøõÂÖ•‰∏ã‰∏ÄÊ≠•„ÄÇÂ¶ÇÊûú‰Ω†ÁöÑ Pod ÈÄöÂ∏∏ÈúÄË¶ÅË∂ÖËøá 30s ÊâçËÉΩÂÖ≥Èó≠ÔºåÈÇ£‰πàÂøÖÈ°ªÂ¢ûÂä†Ëøô‰∏™ÂèÇÊï∞ÁöÑÂ§ßÂ∞èÔºåÂèØ‰ª•ÈÄöËøáÂú® pod Ê®°Êùø‰∏≠ËÆæÁΩÆ terminationGracePeriodSeconds Êù•ÂÆûÁé∞„ÄÇ Â¶ÇÊûúËææÂà∞‰∏äÈù¢ÁöÑÊó∂Èó¥ÈôêÂà∂Ôºåk8s Â∞Ü‰ºöÈÄöËøáÁªôÂÜÖÊ†∏ÂèëÈÄÅ SIGKILL ‰ªéËÄåÂº∫Âà∂ÁªìÊùüÂÆπÂô®„ÄÇËøôÂ∞±Ëß£Èáä‰∫Ü‰∏∫‰ªÄ‰πàÊØèÊ¨° delete pod ÈÉΩË¶ÅÁ≠âÂæÖ 30sÔºåÊ†πÊú¨ÂéüÂõ†ËøòÊòØÂÆπÂô®‰∏≠ÁöÑ java ËøõÁ®ãÁöÑ PID ‰∏çÊòØ 1ÔºåÊâÄ‰ª•ËØ•ËøõÁ®ã‰∏ç‰ºöÁêÜËß£Êî∂Âà∞ SIGTERMÔºåÂú®Á≠âÂæÖ default terminationGracePeriodSeconds ÁöÑÊó∂ÈïøÂêéË¢´Âº∫Âà∂ÁªìÊùü„ÄÇ Âº∫Âà∂ÂÖ≥Èó≠ÂÆπÂô®ÁöÑÂêéÊûúÊòØ‰ªÄ‰πàÔºüÁé∞Âú®Êàë‰ª¨Â∑≤Áªè‰∫ÜËß£‰∫Ü kubectl delete pod Á≠âÂæÖ 30s ÁöÑÂéüÂõ†‰∫Ü„ÄÇ Êàë‰ª¨ÂÜçÊù•ÁúãÁúãÂè¶‰∏Ä‰∏™ÈóÆÈ¢òÔºö Âº∫Âà∂ÂÖ≥Èó≠ÂÆπÂô®ÔºåÁúüÁöÑÂ∞±Ê≤°ÈóÆÈ¢òÂêóÔºü ÊàñËÆ∏‰Ω†ËÉΩÊÉ≥Âà∞ÔºåÂæàÂ§öËøõÁ®ãÂú®ÁªìÊùüÈò∂ÊÆµ‰ºöÂÅö‰∏Ä‰∫õÊ∏ÖÁêÜÂ∑•‰ΩúÔºöÊØîÂ¶ÇÂà†Èô§‰∏¥Êó∂ÁõÆÂΩï„ÄÅÊâßË°å shutdown hook Á≠â„ÄÇ ‰ΩÜÊòØÂΩìËøõÁ®ãË¢´Âº∫Âà∂ÂÖ≥Èó≠Êó∂ÔºåËøô‰∫õ‰ªªÂä°Â∞±‰∏ç‰ºöË¢´ÊâßË°åÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØËÉΩÂæóÂà∞‰∏Ä‰∫õÂπ∂‰∏çÊúüÊúõÁöÑÁªìÊûú„ÄÇ ‰ª• Eureka ‰∏∫‰æãÔºåEureka client Âú®ÁªìÊùüËøõÁ®ãÊó∂ÔºåÈúÄË¶ÅÂêë Eureka server ÂèëÈÄÅ shutdown ‰ø°Âè∑Ôºå‰ª•Ê≥®ÈîÄ client„ÄÇ ËøôÊú¨Êù•Ê≤°‰ªÄ‰πàÈóÆÈ¢òÔºåÂõ†‰∏∫ Eureka server Âç≥‰ΩøÊ≤°ÊúâÊî∂Âà∞ËøôÊ†∑ÁöÑ‰ø°ÊÅØÔºå‰πü‰ºöÂÆöÊúüÊ∏ÖÁêÜ client ‰ø°ÊÅØ„ÄÇ ‰ΩÜÊòØ Eureka server ËøòÊúâ‰∏Ä‰∏™ self preservation Ê®°ÂºèÔºå‰ª•Èò≤Ê≠¢ÊÑèÂ§ñÁöÑÁΩëÁªú‰∫ã‰ª∂ÂØºËá¥Â§ßÈáèÁöÑ client ‰∏ãÁ∫ø„ÄÇ ËøôÂ∞±ÊúâÂèØËÉΩÂØºËá¥ Eureka ÈõÜÁæ§ÁöÑÊ≥®ÂÜåË°®‰∏≠Âá∫Áé∞Â§ßÈáèÁöÑ client ‰ø°ÊÅØÔºå‰ΩÜÂÆÉ‰ª¨ÂÖ∂ÂÆûÂ∑≤ÁªèÂÖ≥Èó≠‰∫Ü„ÄÇ ÈÇ£‰πàÂ¶Ç‰Ωï‰ºòÈõÖÂú∞ÂÖ≥Èó≠ÂÆπÂô®?ÈÄöËøá‰∏äÈù¢ÁöÑÂàÜÊûêÊàë‰ª¨‰∏çÈöæÊâæÂá∫Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÁöÑÊñπÊ≥ïÔºåÂ∞±ÊòØËÆ©ÂÆπÂô®‰∏≠ÁöÑÂêØÂä®ÁöÑËøõÁ®ã PID ‰∏∫ 1„ÄÇÂÖàÁúã‰∏ã‰πãÂâçÁöÑÂÆπÂô®‰∏≠ java ËøõÁ®ãÁöÑ PIDÔºåÁ°ÆÂÆû‰∏çÊòØ 1Ôºå ÊòØ 8Ôºö ÂèØ‰ª•ÁúãÂà∞ PID ‰∏∫ 1 ÁöÑÊòØÂêØÂä® java ËøõÁ®ãÁöÑ shell ËÑöÊú¨„ÄÇ ËøôÂ∞±Ë¶ÅËøΩÊ∫ØÂà∞ Dockerfile ÁöÑ ENTRYPOINT ÁöÑ‰∏§ÁßçÂÜôÊ≥ïÔºåÂç≥ exec Âíå shellÔºå‰∏§ËÄÖÁöÑÂå∫Âà´Âú®‰∫éÔºö exec ÂΩ¢ÂºèÁöÑÂëΩ‰ª§‰ºö‰ΩøÁî® PID 1 ÁöÑËøõÁ®ãÔºõ shell ÂΩ¢ÂºèÁöÑÂëΩ‰ª§‰ºöË¢´ÊâßË°å‰∏∫ /bin/sh -c Ôºå‰∏ç‰ºöÊâßË°åÂú® PID 1 ‰∏äÔºå‰πüÂ∞±‰∏ç‰ºöÊî∂Âà∞ signal„ÄÇ Êàë‰ª¨Ê£ÄÊü•‰∫Ü‰∏ãÂêØÂä® java ËøõÁ®ãÁöÑËÑöÊú¨ÔºåÂèëÁé∞Á°ÆÂÆûÊòØÁî® exec ÁöÑÊñπÂºèÂêØÂä®ÁöÑÔºåÈÇ£‰∏∫‰ªÄ‰πà java ËøõÁ®ãÁöÑ PID Ëøò‰∏çÊòØ 1 Âë¢Ôºü ÂéüÂõ†ÊòØ exec ÂΩ¢ÂºèÁöÑ ENTRYPOINT Âè™ËÉΩËß£ÂÜ≥ Êó†ÈúÄ‰ªª‰ΩïÂáÜÂ§áÂ∑•‰ΩúÂ∞±ÂêØÂä®ËøõÁ®ã ÁöÑÂú∫ÊôØÔºåËÄå‰∏çËÉΩËß£ÂÜ≥‰∏Ä‰∫õÈúÄË¶ÅÂáÜÂ§áÂ∑•‰ΩúÁöÑÂ§çÊùÇÂú∫ÊôØ„ÄÇ‰∏æ‰∏™Ê†óÂ≠êÔºåÊàë‰ª¨ÁöÑ ENTRYPOINT ÂæÄÂæÄÈúÄË¶ÅÊâßË°å‰∏Ä‰∏™ shell ËÑöÊú¨ÔºåÁÑ∂ÂêéÂú®ËÑöÊú¨ÁöÑÊúÄÂêéÊâç‰ºöÂéªÊâßË°å java -jar xxxÔºåËøôÊó∂ÂÄôÔºåÊàë‰ª¨ÁöÑ java ËøõÁ®ãÂ∞±Êó†Ê≥ïÊàê‰∏∫ PID 1 ËøõÁ®ã„ÄÇ Êàë‰ª¨ÂèØ‰ª•Âú® shell ‰∏≠‰ΩøÁî® exec ÂëΩ‰ª§Êù•Ëß£ÂÜ≥„ÄÇËøô‰∏™ÂëΩ‰ª§ÁöÑ‰ΩúÁî®Â∞±ÊòØ‰ΩøÁî®Êñ∞ÁöÑËøõÁ®ãÊõø‰ª£ÂéüÊúâÁöÑËøõÁ®ãÔºåÂπ∂‰øùÊåÅ PID ‰∏çÂèò„ÄÇ ËøôÂ∞±ÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•Âú®ÊâßË°å java ÂëΩ‰ª§ÁöÑÊó∂ÂÄô‰ΩøÁî®ÂÆÉÔºå‰ªéËÄåÊõøÊç¢Êéâ PID 1 ÁöÑ shell ËÑöÊú¨„ÄÇ entrypoint.sh demo123#!/bin/shecho "prepare..."exec java -jar app.jar ‰øÆÊîπÂêéÊàë‰ª¨ÂÜçÊù•Áúã‰∏ãÂÆπÂô®‰∏≠ÁöÑ java ËøõÁ®ãÁöÑ PIDÔºö ‰ΩøÁî® exec ‰πãÂêéÔºåÂÆπÂô®‰∏≠ java ËøõÁ®ãÁöÑ PID Êàê‰∏∫ 1ÔºåÊàë‰ª¨ÂèëÂá∫ delete pod ËØ∑Ê±ÇËÉΩËÆ©ËøõÁ®ãÊé•Êî∂Âà∞ SIGTERM ‰ø°Âè∑ÔºåÊâßË°åÁõ∏Â∫îÁöÑÊìç‰ΩúÂêéÁ´ãÂç≥ÈÄÄÂá∫„ÄÇ ÁØáÂ§ñÔºödocker ÊòØÂ¶Ç‰ΩïÂàõÂª∫ÂÆπÂô®ÁöÑ PID ‰∏∫ 1 ÁöÑËøõÁ®ã?ÂΩìÊàë‰ª¨ÊâßË°å docker run -it busybox /bin/sh ÁöÑÊó∂ÂÄôÔºåÂØπ‰∫éÊìç‰ΩúÁ≥ªÁªüÊù•ËÆ≤ÊòØ‰∏™ËøõÁ®ã, Êìç‰ΩúÁ≥ªÁªü‰ºöÂàÜÈÖç‰∏Ä‰∏™ PID ÁªôËøô‰∏™ËøõÁ®ã, ÊØîÂ¶ÇËøô‰∏™ËøõÁ®ãÂè∑ÊòØ PID=8, ÂØπ‰∫éÊìç‰ΩúÁ≥ªÁªüÂÖ®Â±ÄÊù•ËÆ≤ÂÆÉÊòØ PID=8 ÁöÑ‰∏Ä‰∏™ËøõÁ®ã, ‰ΩÜÊòØÊàë‰ª¨ËøõÂÖ•ÂÆπÂô®ÊâßË°åÂëΩ‰ª§ps, ‰ºöÂèëÁé∞ /bin/sh ÁöÑ PID=1„ÄÇËøôÁßçÂ∞±ÊòØ docker ÁöÑ namespace Êú∫Âà∂, ÂØπ‰∫éÂÖ®Â±ÄÊù•ËÆ≤, ËøôÊù° docker ÂëΩ‰ª§ÁöÑÁöÑ PID ÂèØËÉΩÊòØ 8, ‰ΩÜÊòØÂØπ‰∫éÂÆπÂô®ÂÜÖÈÉ®Êù•ËÆ≤ , ÂÆÉÊûÑÂª∫‰∫Ü‰∏Ä‰∏™ÂÅáÁöÑÂëΩÂêçÁ©∫Èó¥, ‰Ωø /bin/sh ÁöÑ PID ËøõÁ®ãÁ≠â‰∫é 1„ÄÇ ÂÖ∂‰∏≠Áî®Âà∞ÁöÑÊäÄÊúØÂ∞±ÊòØLinuxÁöÑÂàõÂª∫Á∫øÁ®ãÁöÑ system call, ÂØπÂ∫îÁöÑÁ≥ªÁªüË∞ÉÁî®ÂáΩÊï∞Â∞±ÊòØ clone()„ÄÇ 1int pid = clone(main_function, stack_size, SIGCHLD, NULL); Ëøô‰∏™Á≥ªÁªüË∞ÉÁî®ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑËøõÁ®ãÔºåÂπ∂‰∏îËøîÂõûÂÆÉÁöÑ PIDÔºåËÄåÂΩìÊàë‰ª¨Áî® clone() Á≥ªÁªüË∞ÉÁî®ÂàõÂª∫‰∏Ä‰∏™Êñ∞ËøõÁ®ãÊó∂ÔºåÂ∞±ÂèØ‰ª•Âú®ÂèÇÊï∞‰∏≠ÊåáÂÆö CLONE_NEWPID ÂèÇÊï∞Ôºö 1int pid = clone(main_function, stack_size, CLONE_NEWPID | SIGCHLD, NULL); ËøôÊó∂ÔºåÊñ∞ÂàõÂª∫ÁöÑËøô‰∏™ËøõÁ®ãÂ∞Ü‰ºöÁúãÂà∞‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑËøõÁ®ãÁ©∫Èó¥ÔºåÂú®Ëøô‰∏™ËøõÁ®ãÁ©∫Èó¥ÈáåÔºåÂÆÉÁöÑ PID ÊòØ 1„ÄÇ‰ΩÜÊòØÂú®ÂÆø‰∏ªÊú∫ÁúüÂÆûÁöÑËøõÁ®ãÁ©∫Èó¥ÈáåÔºåËøô‰∏™ËøõÁ®ãÁöÑ PID ËøòÊòØÁ≥ªÁªüÁöÑÊï∞ÂÄº 8„ÄÇ ‰ª•‰∏ä„ÄÇ]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>kubernetes</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Why is there no Goroutine ID?]]></title>
    <url>%2F2020%2F11%2F09%2FWhy-is-there-no-goroutine-ID%2F</url>
    <content type="text"><![CDATA[Âú®C/C++/JavaÁ≠âËØ≠Ë®Ä‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Ëé∑ÂèñThread IdÔºåÁÑ∂ÂêéÈÄöËøáÊò†Â∞ÑThread IdÂíå‰∫åÁ∫ßË∞ÉÂ∫¶Task IdÁöÑÂÖ≥Á≥ªÔºåÂèØ‰ª•Âú®Êó•Âøó‰∏≠ÊâìÂç∞ÂΩìÂâçÁöÑTaskIdÔºåÂç≥Áî®Êà∑‰∏çÊÑüÁü•Task IdÁöÑÊâìÂç∞ÔºåÈÄÇÈÖçÂ±ÇÁªü‰∏ÄÂ∞ÅË£ÖÔºåËøô‰ΩøÂæóÂ§öÁ∫øÁ®ãÂπ∂ÂèëÁöÑÊó•ÂøóÁöÑÊü•ÁúãÊàñËøáÊª§ÂèòÂæóÈùûÂ∏∏ÂÆπÊòì„ÄÇ Goroutine ÊòØ Golang ‰∏≠ËΩªÈáèÁ∫ßÁ∫øÁ®ãÁöÑÂÆûÁé∞ÔºåÁî± Go Runtime ÁÆ°ÁêÜ„ÄÇGolang Âú®ËØ≠Ë®ÄÁ∫ßÂà´ÊîØÊåÅËΩªÈáèÁ∫ßÁ∫øÁ®ãÔºåÂè´ÂçèÁ®ã„ÄÇGolang Ê†áÂáÜÂ∫ìÊèê‰æõÁöÑÊâÄÊúâÁ≥ªÁªüË∞ÉÁî®Êìç‰ΩúÔºàÂΩìÁÑ∂‰πüÂåÖÊã¨ÊâÄÊúâÂêåÊ≠• IO Êìç‰ΩúÔºâÔºåÈÉΩ‰ºöÂá∫ËÆ© CPU ÁªôÂÖ∂‰ªñ Goroutine„ÄÇËøôËÆ©‰∫ãÊÉÖÂèòÂæóÈùûÂ∏∏ÁÆÄÂçïÔºåËÆ©ËΩªÈáèÁ∫ßÁ∫øÁ®ãÁöÑÂàáÊç¢ÁÆ°ÁêÜ‰∏ç‰æùËµñ‰∫éÁ≥ªÁªüÁöÑÁ∫øÁ®ãÂíåËøõÁ®ãÔºå‰πü‰∏ç‰æùËµñ‰∫é CPU ÁöÑÊ†∏ÂøÉÊï∞Èáè„ÄÇ ÂÆòÊñπÊõæÁªè‰ΩøÁî® IIRC Êù•Êö¥Èú≤ GoId Ôºå‰ΩÜÊòØËá™‰ªé go1.4 ÁâàÊú¨‰ª•ÂêéÔºåGoroutine Id Êó†Ê≥ïÁõ¥Êé•‰ªé Go Runtime Ëé∑Âèñ‰∫Ü„ÄÇ Á¶ÅÁî®ÁöÑÂéüÂõ†Êúâ‰ª•‰∏ã‰∏§ÁÇπÔºö ÂΩì Goroutine ÂÖ≥Èó≠Êó∂ÔºåGoroutine ÁöÑ local storage Âπ∂‰∏ç‰ºöÁ´ãÂç≥Ë¢´ÂûÉÂúæÂõûÊî∂ÔºåËøôÊÑèÂë≥‰Ω†Âè™ËÉΩÊãøÂà∞ÂΩìÂâçÁöÑ Goroutine ÁöÑ IDÔºå‰ΩÜÊòØ‰∏çËÉΩÊ≠£Á°ÆÊãøÂà∞Á≥ªÁªü‰∏≠ÊâÄÊúâÊ≠£Âú®ËøêË°åÁöÑ GoId ÂàóË°®„ÄÇ ‰Ω†Âè™ËÉΩËé∑Âèñ‰Ω†ÂÜôÁöÑ‰ª£Á†ÅÁîüÊàêÁöÑ Goroutine IDÔºå‰ΩÜÊòØÈÄöÂ∏∏‰Ω†‰∏çËÉΩÁ°Æ‰øùÊâÄÊúâÁöÑÊ†áÂáÜÂ∫ì‰ª•ÂèäÁ¨¨‰∏âÊñπ‰ª£Á†ÅÂ∫ìÈÉΩÂÅö‰∫ÜËøô‰∫õÂ∑•‰Ωú„ÄÇ ËøôÊ†∑Â∞±ÂæàÈöæÂØπÈ´òÂπ∂ÂèëÊó•ÂøóËøõË°åÊü•ÁúãÂíåËøáÊª§„ÄÇÂ∞ΩÁÆ°Âú®Êó•Âøó‰∏≠ÂèØ‰ª•‰ΩøÁî®‰∏öÂä°Êú¨Ë∫´ÁöÑ ID Ôºå‰ΩÜÊòØÂú®ÂæàÂ§öÂáΩÊï∞‰∏≠‰ªÖ‰ªÖ‰∏∫‰∫ÜÊâìÂç∞ËÄåÂ¢ûÂä†‰∏Ä‰∫õÂèÇÊï∞ ID ‰ºöËÆ©‰ª£Á†ÅÁúãËµ∑Êù•Ê≤°ÊúâÈÇ£‰πà‰ºòÈõÖ„ÄÇ ÂèØ‰ª•Âà∞ https://golang.org/doc/faq#no_Goroutine_id ‰∏≠ÁúãÂà∞ÂÆòÊñπÂØπËøô‰∏™ÈóÆÈ¢òÁöÑËØ¶ÁªÜËß£ÈáäÔºåÂéüÊñá‰∏çÈïøÊâÄ‰ª•ÊîæÂú®ÊñáÁ´†Èáå„ÄÇ Why is there no Goroutine ID?Goroutines do not have names; they are just anonymous workers. They expose no unique identifier, name, or data structure to the programmer. Some people are surprised by this, expecting the go statement to return some item that can be used to access and control the Goroutine later. The fundamental reason Goroutines are anonymous is so that the full Go language is available when programming concurrent code. By contrast, the usage patterns that develop when threads and Goroutines are named can restrict what a library using them can do. Here is an illustration of the difficulties. Once one names a Goroutine and constructs a model around it, it becomes special, and one is tempted to associate all computation with that Goroutine, ignoring the possibility of using multiple, possibly shared Goroutines for the processing. If the net/http package associated per-request state with a Goroutine, clients would be unable to use more Goroutines when serving a request. Moreover, experience with libraries such as those for graphics systems that require all processing to occur on the ‚Äúmain thread‚Äù has shown how awkward and limiting the approach can be when deployed in a concurrent language. The very existence of a special thread or Goroutine forces the programmer to distort the program to avoid crashes and other problems caused by inadvertently operating on the wrong thread. For those cases where a particular Goroutine is truly special, the language provides features such as channels that can be used in flexible ways to interact with it.]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Go team ÂÖ≥‰∫éÂ¶Ç‰Ωï‰øùÊåÅ Go Modules ÂÖºÂÆπÊÄßÁöÑ‰∏Ä‰∫õÂÆûË∑µ]]></title>
    <url>%2F2020%2F08%2F13%2FGo-team-%E5%85%B3%E4%BA%8E%E5%A6%82%E4%BD%95%E4%BF%9D%E6%8C%81-Go-Modules-%E5%85%BC%E5%AE%B9%E6%80%A7%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AE%9E%E8%B7%B5%2F</url>
    <content type="text"><![CDATA[ËøëÊó•ÔºåGo team Âú®ÂÖ∂ÂÆòÊñπ blog ‰∏äËÆ®ËÆ∫‰∫ÜÂ¶Ç‰ΩïËÆ©‰Ω†ÁöÑ Go Modules ‰øùÊåÅÂÖºÂÆπÊÄßÁöÑËØùÈ¢òÔºåÂπ∂ÁªôÂá∫‰∫Ü‰∏Ä‰∫õÂª∫ËÆÆÔºåËøô‰∫õÂª∫ËÆÆÈÉΩÊòØËØ•Âõ¢ÈòüÂú®ÂÆûÈôÖÂºÄÂèë‰∏≠‰∏çÊñ≠Ë∏©ÂùëÊÄªÁªìÂá∫Êù•ÁöÑÁ≤æÂçéÔºåÂèØ‰ª•ËØ¥ÊòØÊúÄ‰Ω≥ÂÆûË∑µ„ÄÇÊàë‰ª¨Á´ôÂú®Â∑®‰∫∫ÁöÑËÇ©ËÜÄ‰∏äÔºåÂèØ‰ª•ÂÜôÂá∫Êõ¥‰ºòÈõÖÔºåÊõ¥ÂÖ∑ÊúâÂÖºÂÆπÊÄßÁöÑ‰ª£Á†ÅÔºå‰∏ãÈù¢ËÆ©Êàë‰ª¨Ê∑±ÂÖ•ÈÄêÊù°Ëß£ËØªËøô‰∫õÂª∫ËÆÆ„ÄÇ ÈöèÁùÄÊñ∞ÂäüËÉΩÁöÑÊ∑ªÂä†ÔºåÊàñËÄÖÈáçÊûÑ Go Module ÁöÑÊüê‰∫õÂÖ¨ÂÖ±ÈÉ®ÂàÜÔºåGo Module Â∞ÜÈöèÁùÄÊó∂Èó¥ÁöÑÊé®ÁßªËÄå‰∏çÊñ≠ÂèëÁîüÂèòÂåñ„ÄÇ ‰ΩÜÊòØÔºåÂèëÂ∏ÉÊñ∞ÁöÑ Go Module ÁâàÊú¨ÂØπ‰ΩøÁî®ËÄÖÊù•ÊòØ‰∏Ä‰∏™Âô©ËÄó„ÄÇ ‰ªñ‰ª¨ÂøÖÈ°ªÊâæÂà∞Êñ∞ÁâàÊú¨ÔºåÂ≠¶‰π†Êñ∞ÁöÑAPIÔºåÂπ∂Êõ¥ÊîπÂÖ∂‰ª£Á†Å„ÄÇ ËÄå‰∏îÊüê‰∫õÁî®Êà∑ÂèØËÉΩÊ∞∏Ëøú‰∏ç‰ºöÊõ¥Êñ∞ÔºåËøôÊÑèÂë≥ÁùÄÊÇ®ÂøÖÈ°ªÊ∞∏Ëøú‰∏∫‰ª£Á†ÅÁª¥Êä§‰∏§‰∏™ÁâàÊú¨„ÄÇ Âõ†Ê≠§ÔºåÈÄöÂ∏∏ÊúÄÂ•Ω‰ª•ÂÖºÂÆπÁöÑÊñπÂºèÊõ¥ÊîπÁé∞ÊúâÁöÑ Go Module„ÄÇ Âú®Êú¨Êñá‰∏≠ÔºåÊàë‰ª¨Â∞ÜÊé¢ËÆ®‰∏Ä‰∫õ‰ª£Á†ÅÊäÄÂ∑ßÔºåËÉΩÂ§üËÆ©‰Ω†‰øùÊåÅ Go Module ÁöÑÂÖºÂÆπÊÄß„ÄÇ Ê†∏ÂøÉÁöÑÊÄùÊÉ≥Â∞±ÊòØÊòØÔºöÊ∑ªÂä†Ôºå‰ΩÜÊòØ‰∏çË¶ÅÊõ¥ÊîπÊàñÂà†Èô§‰Ω†ÁöÑ Go Module ‰ª£Á†Å„ÄÇ Êàë‰ª¨ËøòÂ∞Ü‰ªéÂÆèËßÇËßíÂ∫¶ËÆ®ËÆ∫Â¶Ç‰ΩïËÆæËÆ°ÂÖ∑Â§áÈ´òÂ∫¶ÂÖºÂÆπÊÄßÁöÑ API „ÄÇ Êñ∞Â¢ûÂáΩÊï∞ÈÄöÂ∏∏Êù•ËØ¥ÔºåÊîπÂèòÂáΩÊï∞ÁöÑÂΩ¢ÂèÇÊòØÁ†¥Âùè‰ª£Á†ÅÂÖºÂÆπÊÄßÊúÄÂ∏∏ËßÅÁöÑÊÉÖÂÜµ„ÄÇÊàë‰ª¨ËÆ≤ËøáËÆ®ËÆ∫Âá†‰∏™Ëß£ÂÜ≥ËøôÁßçÈóÆÈ¢òÁöÑÊñπÂºèÔºå‰ΩÜËÆ©Êàë‰ª¨È¶ñÂÖàÁúã‰∏Ä‰∏™‰∏çÂ•ΩÁöÑÂÆûË∑µ„ÄÇ ÊúâËøô‰πà‰∏Ä‰∏™ÂáΩÊï∞Ôºö 1func Run(name string) ÂΩìÊàë‰ª¨Âá∫‰∫éÊüê‰∏™ÊÉÖÂÜµË¶ÅÊâ©Â±ïËøô‰∏™ÂáΩÊï∞Ôºå‰∏∫Ëøô‰∏™ÂáΩÊï∞Ê∑ªÂä†‰∏Ä‰∏™ÂΩ¢ÂèÇ size Ôºö 1func Run(name string, size ...int) ÂÅáÂ¶Ç‰Ω†Âú®ÂÖ∂‰ªñ‰ª£Á†Å‰∏≠ÔºåÊàñËÄÖ Go Module ÁöÑ‰ΩøÁî®ËÄÖÊõ¥Êñ∞‰∫ÜÔºåÈÇ£‰πàÂÉè‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂ∞±‰ºöÂá∫Áé∞ÈóÆÈ¢òÔºö 12package mypkgvar runner func(string) = yourpkg.Run ÂéüÊù•ÁöÑ Run ÂáΩÊï∞ÁöÑÁ±ªÂûãÊòØ func(string)Ôºå‰ΩÜÊòØÊñ∞ÁöÑ Run ÂáΩÊï∞ÁöÑÁ±ªÂûãÂèòÊàê‰∫Ü func(string, ...int)ÔºåÊâÄ‰ª•Âú®ÁºñËØëÈò∂ÊÆµÂ∞±‰ºöÊä•Èîô„ÄÇÂøÖÈ°ªË¶ÅÊ†πÊçÆÊñ∞ÁöÑÂáΩÊï∞Á±ªÂûã‰øÆÊîπË∞ÉÁî®ÊñπÂºèÔºåËøôÁªô‰ΩøÁî® Go Module ÁöÑÂºÄÂèëËÄÖÈÄ†ÊàêÂæàÂ§ö‰∏ç‰æøÔºåÁîöËá≥Âá∫Áé∞ bug„ÄÇ ÈíàÂØπËøôÁßçÊÉÖÂÜµÔºåÊàë‰ª¨ÂèØ‰ª•Êñ∞Â¢û‰∏Ä‰∏™ÂáΩÊï∞Êù•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåËÄå‰∏çÊòØ‰øÆÊîπÂáΩÊï∞Á≠æÂêç„ÄÇÊàë‰ª¨ÈÉΩÁü•ÈÅìÔºåcontext ÂåÖÊòØ Golang 1.17 ÁâàÊú¨‰πãÂêéÊâçÂºïÂÖ•ÁöÑÔºåÈÄöÂ∏∏ ctx ‰ºöÂÅö‰∏∫ÂáΩÊï∞ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰º†ÂÖ•„ÄÇ‰ΩÜÊòØÁé∞ÊúâÁöÑÂ∑≤ÁªèÂæàÁ®≥ÂÆöÁöÑ API ÁöÑÂèØÂØºÂá∫ÂáΩÊï∞‰∏çÂèØËÉΩÂéª‰øÆÊîπÂáΩÊï∞Á≠æÂêçÔºåÂú®ÂÖ∂ÂáΩÊï∞Á¨¨‰∏Ä‰∏™ÂÖ•ÂèÇÊ∑ªÂä† context.ContextÔºåËøôÊ†∑‰ºöÂΩ±ÂìçÊâÄÊúâÂáΩÊï∞Ë∞ÉÁî®ÊñπÔºåÂ∞§ÂÖ∂Âú®‰∏Ä‰∫õÂ∫ïÂ±Ç‰ª£Á†ÅÂ∫ì‰∏≠ÔºåËøôÊòØÈùûÂ∏∏Âç±Èô©ÁöÑÊìç‰Ωú„ÄÇ Go team ‰ΩøÁî®Êñ∞Â¢ûÂáΩÊï∞ ÁöÑÊñπÊ≥ïËß£ÂÜ≥‰∫ÜËøô‰∏™ÈóÆÈ¢ò„ÄÇ‰∏æ‰∏™Ê†óÂ≠êÔºådatabase/sql Ëøô‰∏™ package ÁöÑ Query ÊñπÊ≥ïÁöÑÁ≠æÂêç‰∏ÄÁõ¥ÊòØ: 1func (db *DB) Query(query string, args ...interface&#123;&#125;) (*Rows, error) ÂΩì context package ÂºïÂÖ•ÁöÑÊó∂ÂÄôÔºåGo team Êñ∞Â¢û‰∫ÜËøôÊ†∑‰∏Ä‰∏™ÂáΩÊï∞Ôºö 1func (db *DB) QueryContext(ctx context.Context, query string, args ...interface&#123;&#125;) (*Rows, error) Âπ∂‰∏îÂè™‰øÆÊîπ‰∫Ü‰∏ÄÂ§Ñ‰ª£Á†ÅÔºö 123func (db *DB) Query(query string, args ...interface&#123;&#125;) (*Rows, error) &#123; return db.QueryContext(context.Background(), query, args...)&#125; ÈÄöËøáËøôÁßçÊñπÂºèÔºåGo team ËÉΩÂ§üÂú®Âπ≥ÊªëÂú∞ÂçáÁ∫ß‰∏Ä‰∏™ package ÁöÑÂêåÊó∂‰∏çÂØπ‰ª£Á†ÅÁöÑÂèØËØªÊÄß„ÄÅÂÖºÂÆπÊÄßÈÄ†ÊàêÂΩ±Âìç„ÄÇÁ±ª‰ººÁöÑ‰ª£Á†ÅÂú® golang Ê∫êÁ†Å‰∏≠ÈöèÂ§ÑÂèØËßÅ„ÄÇ ÂèØÈÄâÂèÇÊï∞Ôºàoptional argumentsÔºâÂ¶ÇÊûú‰Ω†Âú®ÂÆûÁé∞ package ‰πãÂâçÂ∞±Á°ÆÂÆöËøô‰∏™ÂáΩÊï∞ÂêéÈù¢ÂèØËÉΩ‰ºöÈúÄË¶ÅÊ∑ªÂä†ÂèÇÊï∞Êù•Êâ©Â±ïÊüê‰∫õÂäüËÉΩÔºåÈÇ£‰πà‰Ω†ÂèØ‰ª•ÊèêÂâçÂú®ÂáΩÊï∞Á≠æÂêçÊòØ‰ΩøÁî®ÂèØÈÄâÂèÇÊï∞Ôºàoptional argumentsÔºâ„ÄÇÊúÄÁÆÄÂçïÁöÑÊñπÊ≥ïÊòØÂú®ÂáΩÊï∞Á≠æÂêç‰∏≠‰ΩøÁî®ÁªìÊûÑ‰ΩìÂèÇÊï∞Ôºå‰∏ãÈù¢ÊòØ golang Ê∫êÁ†Å‰∏≠ crypto/tls.Dial ÁöÑ‰∏ÄÊÆµ‰ª£Á†ÅÔºö 1func Dial(network, addr string, config *Config) (*Conn, error) Dial ÂáΩÊï∞ÂÆûÁé∞ TLS ÁöÑÊè°ÊâãÊìç‰ΩúÔºåËøô‰∏™ËøáÁ®ã‰∏≠ÈúÄË¶ÅÂÖ∂‰ªñÂæàÂ§öÂèÇÊï∞ÔºåÂêåÊó∂ËøòÊîØÊåÅÈªòËÆ§ÂÄº„ÄÇÂΩìÁªô config ‰º†ÈÄí nil ÁöÑÊó∂ÂÄôÂ∞±ÊòØ‰ΩøÁî®ÈªòËÆ§ÂÄºÔºõÂΩì‰º†ÈÄí Config struct ÁöÑÊó∂ÂÄôÂ∞Ü‰ºöË¶ÜÁõñÈªòËÆ§ÂÄº„ÄÇÂÅáÂ¶Ç‰ª•ÂêéÂá∫Áé∞‰∫ÜÊñ∞ÁöÑ TLS ÈÖçÁΩÆÂèÇÊï∞ÔºåÂèØ‰ª•ÂæàËΩªÊùæÂú∞ÈÄöËøáÂú® Config struct ‰∏≠Ê∑ªÂä†Êñ∞Â≠óÊÆµÊù•ÂÆûÁé∞ÔºåËøôÁßçÊñπÂºèÊòØÂêëÂêéÂÖºÂÆπÁöÑ„ÄÇ Êúâ‰∫õÊÉÖÂÜµ‰∏ãÔºåÊñ∞Â¢ûÂáΩÊï∞Âíå‰ΩøÁî®ÂèØÈÄâÂèÇÊï∞ÁöÑÊñπÂºèÂèØ‰ª•ÁªìÂêàËµ∑Êù•ÔºåÈÄöËøáÊääÂèØÈÄâÂèÇÊï∞ÁöÑÁªìÊûÑ‰ΩìÂèòÊàê‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÊé•Êî∂ËÄÖ(receiver)„ÄÇÊØîÂ¶ÇÔºåÂú® Go 1.11 ‰πãÂâçÔºånet package ‰∏≠ÁöÑListen ÊñπÊ≥ïÁöÑÁ≠æÂêçÊòØÔºö 1func Listen(network, address string) (Listener, error) ‰ΩÜÊòØÂú® Go 1.11 ‰∏≠ÔºåGo team Êñ∞Â¢ûÂä†‰∫Ü‰∏§‰∏™ feature : ‰º†ÈÄí‰∫Ü context ÂèÇÊï∞Ôºõ Â¢ûÂä†‰∫Ü control functionÔºåÂÖÅËÆ∏Ë∞ÉÁî®ËÄÖÂú®ÁΩëÁªúËøûÊé•ËøòÊ≤°Êúâ bind ÁöÑÊó∂ÂÄôË∞ÉÊï¥ÂéüÂßãËøûÊé•ÁöÑÂèÇÊï∞„ÄÇ ËøôÁúãËµ∑Êù•ÊòØÁõ∏ÂΩìÂ§ßÁöÑË∞ÉÊï¥‰∫ÜÔºåÂ¶ÇÊûúÊòØ‰∏ÄËà¨ÂºÄÂèëËÄÖÔºåÊúÄÂ§ö‰πüÂ∞±‰ºöÊñ∞Â¢û‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂèÇÊï∞‰∏≠Ê∑ªÂä† context, control function„ÄÇ‰ΩÜÊòØ Go team ÁöÑÂºÄÂèëËÄÖÈùûÁ≠âÈó≤‰πãËæàÔºånet package ÁöÑ‰ΩúËÄÖÊÉ≥Âà∞Êú™Êù•ÁöÑÊüê‰∏ÄÂ§©Ëøô‰∏™ÂáΩÊï∞ÊòØ‰∏çÊòØ‰ºöÊúâË∞ÉÊï¥ÔºåÊàñËÄÖÈúÄË¶ÅÊõ¥Â§öÁöÑÂèÇÊï∞Ôºü‰∫éÊòØÂ∞±È¢ÑÁïô‰∫Ü‰∏Ä‰∏™ ListenConfig ÁöÑÁªìÊûÑ‰ΩìÔºå‰∏∫Ëøô‰∏™ strcut ÂÆûÁé∞‰∫Ü Listen ÊñπÊ≥ïÔºå‰ªéËÄå‰πü‰∏çÁî®ÂÜçÊñ∞Â¢û‰∏Ä‰∏™ÂáΩÊï∞ÊâçËÉΩËß£ÂÜ≥ÈóÆÈ¢ò„ÄÇ 12345type ListenConfig struct &#123; Control func(network, address string, c syscall.RawConn) error&#125;func (*ListenConfig) Listen(ctx context.Context, network, address string) (Listener, error) ËøòÊúâ‰∏ÄÁßçÂè´ÂÅöÂèØÈÄâÁ±ªÂûãÁöÑËÆæËÆ°Ê®°ÂºèÔºåÊòØÊääÂèØÈÄâÁöÑÂáΩÊï∞‰Ωú‰∏∫ÂáΩÊï∞ÂΩ¢ÂèÇÔºåÊØè‰∏Ä‰∏™ÂèØÈÄâÂáΩÊï∞ÈÉΩÂèØ‰ª•ÈÄöËøáÂèÇÊï∞Êù•Ë∞ÉÊï¥ÂÖ∂Áä∂ÊÄÅ„ÄÇÂú® Rob Pike ÁöÑ blog (https://commandcenter.blogspot.com/2014/01/self-referential-functions-and-design.html) ÈáåÂØπËøôÁßçÊ®°ÂºèËøõË°å‰∫ÜËØ¶ÁªÜÁöÑËß£ËØª„ÄÇËøôÁßçËÆæËÆ°Ê®°ÂºèÂú® grpc ÁöÑÊ∫êÁ†Å‰∏≠Â§ßÈáè‰ΩøÁî®„ÄÇ option types ‰∏éÂáΩÊï∞ÂèÇÊï∞‰∏≠ÁöÑ option structÂÖ∑ÊúâÁõ∏ÂêåÁöÑ‰ΩúÁî®ÔºöÂÆÉ‰ª¨ÊòØ‰º†ÈÄíË°å‰∏∫Ôºå‰øÆÊîπÈÖçÁΩÆÁöÑÂèØÊâ©Â±ïÊñπÂºè„ÄÇ ÂÜ≥ÂÆöÈÄâÊã©Âì™‰∏™ÂæàÂ§ßÁ®ãÂ∫¶‰∏äÂèñÂÜ≥‰∫éÂÖ∑‰ΩìÂú∫ÊôØ„ÄÇ Êù•Áúã‰∏Ä‰∏ã gRPC ÁöÑ DialOption ÈÄâÈ°πÁ±ªÂûãÁöÑÁî®Ê≥ïÔºö 1234grpc.Dial("some-target", grpc.WithAuthority("some-authority"), grpc.WithMaxDelay(time.Second), grpc.WithBlock()) ÂΩìÁÑ∂‰Ω†‰πüÂèØ‰ª•‰Ωú‰∏∫ struct ÈÄâÈ°πÂÆûÁé∞Ôºö 12345notgrpc.Dial("some-target", &amp;notgrpc.Options&#123; Authority: "some-authority", MaxDelay: time.Minute, Block: true,&#125;) ‰ª•‰∏äÔºå‰ªª‰∏ÄÁßçÊñπÂºèÈÉΩÊòØËÉΩÂ§üÁª¥ÊåÅ Go Module ÂÖºÂÆπÊÄßÁöÑÊñπÊ≥ïÔºåÂèØ‰ª•Ê†πÊçÆ‰∏çÂêåÁöÑÂú∫ÊôØÈÄâÊã©ÂêàÁêÜÁöÑÂÆûÁé∞„ÄÇ ‰øùËØÅ interfaces ÁöÑÂÖºÂÆπÊÄßÊúâÊó∂ÂÄôÔºåÊñ∞ÁâπÊÄßÁöÑÊîØÊåÅÈúÄË¶ÅÊõ¥ÊîπÂØπÂ§ñÊö¥Èú≤ÁöÑÔºàpublicÔºâÁöÑÊé•Âè£: ÈúÄË¶Å‰ΩøÁî®Êñ∞ÁöÑÊñπÊ≥ïÊù•Êâ©Â±ïÊé•Âè£„ÄÇÁõ¥Êé•ÂêëÊé•Âè£Ê∑ªÂä†ÊñπÊ≥ïÊòØ‰∏çÂêàÈÄÇÁöÑÔºåËøô‰ºöÂØºËá¥Êé•Âè£ÁöÑÂÆûÁé∞ÊñπÈÉΩÈúÄË¶Å‰øÆÊîπ‰ª£Á†Å„ÄÇÈÇ£‰πàÔºåÊàë‰ª¨Â¶Ç‰ΩïÊâçËÉΩÂú®ÂÖ¨ÂºÄÁöÑÊé•Âè£‰∏äÊîØÊåÅÊñ∞ÊñπÊ≥ïÂë¢Ôºü Go team ÁªôÂá∫ÁöÑÂª∫ËÆÆÊòØÔºö‰ΩøÁî®Êñ∞ÊñπÊ≥ïÂÆö‰πâ‰∏Ä‰∏™Êñ∞Êé•Âè£ÔºåÁÑ∂ÂêéÂú®‰ΩøÁî®ÊóßÊé•Âè£ÁöÑ‰ªª‰ΩïÂú∞ÊñπÂä®ÊÄÅÊ£ÄÊü•Êèê‰æõÁöÑÁ±ªÂûãÊòØÊóßÁ±ªÂûãËøòÊòØÊñ∞Á±ªÂûã„ÄÇ ËÆ©Êàë‰ª¨‰ª• golang Ê∫êÁ†Å‰∏≠ archive/tar package Êù•ËØ¶ÁªÜËØ¥Êòé‰∏Ä‰∏ã„ÄÇ tar.NewReader ‰ª• io.Reader ‰Ωú‰∏∫ÂèÇÊï∞Ôºå‰ΩÜÊòØÂêéÊù• Go team ËßâÂæóÂ∫îËØ•Êèê‰æõ‰∏ÄÁßçÊõ¥Âä†È´òÊïàÁöÑÊñπÂºèÔºåÂ∞±ÊòØÂΩìË∞ÉÁî® Seek ÊñπÊ≥ïÁöÑÊó∂ÂÄôÂèØ‰ª•Ë∑≥Ëøá‰∏Ä‰∏™Êñá‰ª∂ÁöÑ header„ÄÇ‰ΩÜÊòØÂèà‰∏çËÉΩÁõ¥Êé•Âú® io.Reader ‰∏≠Êñ∞Â¢û Seek ÊñπÊ≥ïÔºåËøô‰ºöÂΩ±ÂìçÊâÄÊúâÂÆûÁé∞‰∫Ü io.Reader ÁöÑÊñπÊ≥ïÔºàÂ¶ÇÊûú‰Ω†ÊúâÁúãËøá golang Ê∫êÁ†ÅÔºåÂ∞±‰ºöÁü•ÈÅì io.Reader Êé•Âè£ÁöÑÂ∫îÁî®ÊúâÂ§öÂπøÊ≥õ‰∫ÜÔºâ„ÄÇ Âè¶Â§ñ‰∏ÄÁßçÊñπÊ≥ïÊòØÂ∞Ü tar.NeaReader ÁöÑÂÖ•ÂèÇÊîπÊàê io.ReaderSeeker interfaceÔºåÂõ†‰∏∫ËØ• interface ÂêåÊó∂ÊîØÊåÅ io.Reader Âíå Seek „ÄÇ‰ΩÜÊòØÊ≠£Â¶ÇÂâçÈù¢ÊâÄËÆ≤ÔºåÊîπÂèò‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÁ≠æÂêçÔºå‰∏çÊòØ‰∏ÄÁßçÂ•ΩÁöÑÊñπÂºè„ÄÇ ÊâÄ‰ª• Go team ÂÜ≥ÂÆöÁª¥ÊåÅ tar.NewReader ÁöÑÁ≠æÂêç‰∏çÂèòÔºåÂú® Read ÊñπÊ≥ï‰∏≠ËøõË°åÁ±ªÂûãÊ£ÄÊü•Ôºö 12345678910111213141516package tartype Reader struct &#123; r io.Reader&#125;func NewReader(r io.Reader) *Reader &#123; return &amp;Reader&#123;r: r&#125;&#125;func (r *Reader) Read(b []byte) (int, error) &#123; if rs, ok := r.r.(io.Seeker); ok &#123; // Use more efficient rs.Seek. &#125; // Use less efficient r.r.Read.&#125; Â¶ÇÊûúÈÅáÂà∞Ë¶ÅÂêëÁé∞ÊúâÊé•Âè£Ê∑ªÂä†ÊñπÊ≥ïÁöÑÊÉÖÂÜµÔºåÂàôÂèØ‰ª•ÈÅµÂæ™Ê≠§Á≠ñÁï•„ÄÇ È¶ñÂÖà‰ΩøÁî®Êñ∞ÊñπÊ≥ïÂàõÂª∫Êñ∞Êé•Âè£ÔºåÊàñËÄÖ‰ΩøÁî®Êñ∞ÊñπÊ≥ïÊ†áËØÜÁé∞ÊúâÊé•Âè£„ÄÇ Êé•‰∏ãÊù•ÔºåÁ°ÆÂÆöÈúÄË¶ÅÊ∑ªÂä†ÁöÑÁõ∏ÂÖ≥‰ª£Á†ÅÂïäÔºåÂØπÁ¨¨‰∫å‰∏™Êé•Âè£ËøõË°åÁ±ªÂûãÊ£ÄÊü•ÔºåÂπ∂Ê∑ªÂä†‰ΩøÁî®ÂÆÉÁöÑ‰ª£Á†Å„ÄÇ Âú®ÂèØËÉΩÁöÑÊÉÖÂÜµ‰∏ãÔºåÊúÄÂ•ΩÈÅøÂÖçËøôÁßçÈóÆÈ¢ò„ÄÇ ‰æãÂ¶ÇÔºåÂú®ËÆæËÆ°ÊûÑÈÄ†ÂáΩÊï∞Êó∂ÔºåÊúÄÂ•ΩËøîÂõûÂÖ∑‰ΩìÁ±ªÂûã„ÄÇ ‰∏éÊé•Âè£‰∏çÂêåÔºå‰ΩøÁî®ÂÖ∑‰ΩìÁ±ªÂûãÂèØ‰ª•ËÆ©‰Ω†Â∞ÜÊù•Âú®‰∏ç‰∏≠Êñ≠Áî®Êà∑‰ΩøÁî®ÁöÑÊÉÖÂÜµ‰∏ãÊ∑ªÂä†Êñ∞ÊñπÊ≥ïÔºåÂêåÊó∂Â∞ÜÊù•ÂèØ‰ª•Êõ¥ËΩªÊùæÂú∞Êâ©Â±ï‰Ω†ÁöÑ Go Module„ÄÇ Tip: Â¶ÇÊûú‰Ω†Áî®Âà∞‰∫Ü‰∏Ä‰∏™ interfaceÔºå‰ΩÜÊòØ‰Ω†‰∏çÊÉ≥Áî®Êà∑ÂéªÂÆûÁé∞ÂÆÉÔºå‰Ω†ÂèØ‰ª•‰∏∫ interface Ê∑ªÂä† unexported ÁöÑÊñπÊ≥ï„ÄÇ 1234567891011type TB interface &#123; Error(args ...interface&#123;&#125;) Errorf(format string, args ...interface&#123;&#125;) // ... // A private method to prevent users implementing the // interface and so future additions to it will not // violate Go 1 compatibility.// private ÈÅøÂÖçÁî®Êà∑ÂéªÂÆûÁé∞ÂÆÉ private()&#125; Êñ∞Â¢ûÈÖçÁΩÆÊñπÊ≥ïÂà∞ÁõÆÂâç‰∏∫Ê≠¢ÔºåÊàë‰ª¨ËÆ®ËÆ∫‰∫Ü‰øÆÊîπÂáΩÊï∞Á≠æÂêçÊàñËÄÖ‰∏∫ interface Ê∑ªÂä†ÊñπÊ≥ïÔºå‰ºöÂΩ±ÂìçÂà∞Áî®Êà∑ÁöÑ‰ª£Á†ÅÂØºËá¥ÁºñËØëÂ§±Ë¥•„ÄÇÂÆûÈôÖ‰∏äÔºåÂáΩÊï∞Ë°å‰∏∫ÁöÑÊîπÂèò‰ºöÈÄ†ÊàêÂêåÊ†∑ÁöÑÈóÆÈ¢ò„ÄÇ‰æãÂ¶ÇÔºåÂæàÂ§öÂºÄÂèëËÄÖÂ∏åÊúõ json.Decoder ÂèØ‰ª•ÂøΩÁï• struct ‰∏≠Ê≤°ÊúâÁöÑ json Â≠óÊÆµ„ÄÇ‰ΩÜÊòØÂΩì Go team ÊÉ≥Ë¶ÅÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãËøîÂõû‰∏Ä‰∫õÈîôËØØÁöÑÊó∂ÂÄôÔºåÂ∞±ÂøÖÈ°ªË¶ÅÂ∞èÂøÉÔºåÂõ†‰∏∫ËøôÊ†∑ÂÅö‰ºöÂØºËá¥ÂæàÂ§ö‰ΩøÁî®ËØ•ÊñπÊ≥ïÁöÑÁî®Êà∑Á™ÅÁÑ∂Êî∂Âà∞‰ª•Ââç‰ªéÊú™ÈÅáÂà∞ÁöÑÈîôËØØ„ÄÇ Âõ†Ê≠§Ôºå‰ªñ‰ª¨Ê≤°ÊúâÊõ¥ÊîπÊâÄÊúâÁî®Êà∑ÁöÑË°å‰∏∫ÔºåËÄåÊòØÂêëDecoderÁªìÊûÑÊ∑ªÂä†‰∫Ü‰∏ÄÁßçÈÖçÁΩÆÊñπÊ≥ïÔºöDecoder.DisallowUnknownFields „ÄÇ Ë∞ÉÁî®Ê≠§ÊñπÊ≥ï‰ºö‰ΩøÁî®Êà∑ÈÄâÊã©Êñ∞Ë°å‰∏∫ÔºåÂêåÊó∂‰ºö‰∏∫Áé∞ÊúâÁî®Êà∑‰øùÁïôÊóßÁöÑÊñπÊ≥ï„ÄÇ ‰øùÊåÅ struct ÁöÑÂÖºÂÆπÊÄßÈÄöËøá‰∏äÈù¢ÁöÑÂÜÖÂÆπÊàë‰ª¨‰∫ÜËß£Âà∞ÔºåÂØπÂáΩÊï∞Á≠æÂêçÁöÑ‰ªª‰ΩïÊõ¥ÊîπÈÉΩÊòØ‰∏ÄÁßçÁ†¥ÂùèÊÄßÁöÑÊîπÂä®„ÄÇ ‰ΩÜÊòØÂ¶ÇÊûú‰ΩøÁî® struct Â∞±‰ºöËÆ©‰Ω†ÁöÑ‰ª£Á†ÅÁÅµÊ¥ªÂæàÂ§öÔºå Â¶ÇÊûúÂÖ∑ÊúâÂèØÂØºÂá∫ÁöÑÁªìÊûÑ‰ΩìÁ±ªÂûãÔºåÂàôÂá†‰πéÂèØ‰ª•ÈöèÊó∂Ê∑ªÂä†‰∏Ä‰∏™Â≠óÊÆµÊàñÂà†Èô§‰∏Ä‰∏™Êú™ÂØºÂá∫ÁöÑÂ≠óÊÆµËÄå‰∏ç‰ºöÁ†¥ÂùèÂÖºÂÆπÊÄß„ÄÇ Ê∑ªÂä†Â≠óÊÆµÊó∂ÔºåËØ∑Á°Æ‰øùÂÖ∂Èõ∂ÂÄºÊúâÊÑè‰πâÂπ∂‰øùÁïôÊóßÁöÑË°å‰∏∫Ôºå‰ª•‰æøÊú™ËÆæÁΩÆËØ•Â≠óÊÆµÁöÑÁé∞Êúâ‰ª£Á†ÅÁªßÁª≠Ëµ∑‰ΩúÁî®„ÄÇ ËøòËÆ∞Âæó‰∏äÈù¢ËÆ≤Âà∞ÁöÑ net package ÁöÑ‰ΩúËÄÖÂú® Go 1.11 ÁöÑÊó∂ÂÄôÊ∑ªÂä†ÁöÑ ListenConfig struct ÂêóÔºü‰∫ãÂÆûËØÅÊòé‰ªñÁöÑËÆæËÆ°ÊòØÂØπÁöÑ„ÄÇÂú® Go 1.13 ‰∏≠ÔºåÊñ∞Â¢û‰∫Ü KeepAlive Â≠óÊÆµÔºåÂÖÅËÆ∏ÂèñÊ∂àÊàñ‰ΩøÁî® keep-alive ÁöÑÂäüËÉΩ„ÄÇÊúâ‰∫Ü‰πãÂâçÁöÑËÆæËÆ°ÔºåËøô‰∏™Â≠óÊÆµÁöÑÂä†ÂÖ•Â∞±ÂÆπÊòìÂ§ö‰∫Ü„ÄÇ ÂÖ≥‰∫é struct ÁöÑ‰ΩøÁî®ÔºåÊúâ‰∏Ä‰∏™ÁªÜËäÇÂ¶ÇÊûú‰Ω†Ê≤°ÊúâÊ≥®ÊÑèÂà∞ÁöÑËØùÔºå‰πü‰ºöÂØπÁî®Êà∑ÈÄ†ÊàêÂæàÂ§ßÁöÑÂΩ±Âìç„ÄÇÂ¶ÇÊûú struct ‰∏≠ÊâÄÊúâÁöÑÂ≠óÊÆµÈÉΩÊòØÂèØÂà§Á≠âÁöÑÔºàÊÑèÊÄùÊòØÂèØÁî®ÈÄöËøá == or !=Êù•ÊØîËæÉÔºåÊàñËÄÖÂèØ‰ª•‰Ωú‰∏∫ map ÁöÑ keyÔºâÔºåÈÇ£‰πàËøô‰∏™ struct Â∞±ÊòØÂèØÂà§Á≠âÁöÑ„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûú‰Ω†‰∏∫ struct Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™‰∏çÂèØÂà§Á≠âÁöÑÁ±ªÂûãÔºåÂ∞Ü‰ºöÂØºËá¥Ëøô‰∏™ struct ‰πüÂèòÊàê‰∏çÂèØÂà§Á≠âÁöÑ„ÄÇÂ¶ÇÊûúÁî®Êà∑Âú®‰ª£Á†Å‰∏≠‰ΩøÁî®‰∫Ü‰Ω†ÁöÑ struct ËøõË°åÂà§Á≠âÊìç‰ΩúÔºåÈÇ£‰πàÂ∞±‰ºöÈÅáÂà∞‰ª£Á†ÅÈîôËØØ„ÄÇ Â¶ÇÊûú‰Ω†Ë¶Å‰øùÊåÅÁªìÊûÑ‰ΩìÂèØÂà§Á≠âÔºåÂ∞±‰∏çË¶ÅÂêëÂÖ∂Ê∑ªÂä†‰∏çÂèØÊØîËæÉÁöÑÂ≠óÊÆµ„ÄÇÂèØ‰ª•‰∏∫Ê≠§ÁºñÂÜôÊµãËØïÁî®‰æãÊù•ÈÅøÂÖçÈÅóÂøò„ÄÇ Conclusion‰ªéÂ§¥ÂºÄÂßãËßÑÂàí API ÁöÑÊó∂ÂÄôÔºåËØ∑‰ªîÁªÜËÄÉËôë API Âú®Â∞ÜÊù•ÁöÑÂèØÊâ©Â±ïÊÄß„ÄÇ ËÄå‰∏îÂΩì‰Ω†Á°ÆÂÆûÈúÄË¶ÅÊ∑ªÂä†Êñ∞ÂäüËÉΩÊó∂ÔºåËØ∑ËÆ∞‰Ωè‰ª•‰∏ãËßÑÂàôÔºöÊ∑ªÂä†Ôºå‰∏çË¶ÅÊõ¥ÊîπÊàñÂà†Èô§„ÄÇËØ∑Áâ¢ËÆ∞ÔºåÊ∑ªÂä†Êé•Âè£ÊñπÊ≥ïÔºåÂáΩÊï∞ÂèÇÊï∞ÂíåËøîÂõûÂÄºÈÉΩ‰ºöÂØºËá¥ Go Module ‰∏çËÉΩÂêëÂêéÂÖºÂÆπ„ÄÇ Â¶ÇÊûú‰Ω†Á°ÆÂÆûÈúÄË¶ÅÂ§ßËßÑÊ®°Êõ¥Êîπ APIÔºåÊàñËÄÖË¶ÅÊ∑ªÂä†Êõ¥Â§öÊñ∞ÁâπÊÄßÔºåÈÇ£‰πà‰ΩøÁî®Êñ∞ÁöÑ API ÁâàÊú¨‰ºöÊòØÊõ¥Â•ΩÁöÑÊñπÂºè„ÄÇ ‰ΩÜÊòØÂ§ßÂ§öÊï∞Êó∂ÂÄôÔºåËøõË°åÂêëÂêéÂÖºÂÆπÁöÑÊõ¥ÊîπÂ∫îËØ•ÊòØ‰Ω†ÁöÑÈ¶ñÈÄâÔºåËÉΩÂ§üÈÅøÂÖçÁªôÁî®Êà∑Â∏¶Êù•È∫ªÁÉ¶„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lxcfs ÂÆûÁé∞ÂÆπÂô®ËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÁöÑÊúÄ‰Ω≥ÂÆûË∑µ]]></title>
    <url>%2F2020%2F07%2F04%2Flxcfs-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E5%99%A8%E8%B5%84%E6%BA%90%E8%A7%86%E5%9B%BE%E9%9A%94%E7%A6%BB%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E9%97%B4%2F</url>
    <content type="text"><![CDATA[LXCFS is a small FUSE filesystem written with the intention of making Linux containers feel more like a virtual machine. It started as a side-project of LXC but is useable by any runtime. Áî®‰∫∫ËØùËß£Èáä‰∏Ä‰∏ãÂ∞±ÊòØÔºö xcfs ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑ FUSEÔºàÁî®Êà∑ÊÄÅÊñá‰ª∂Á≥ªÁªüÔºâÂÆûÁé∞Êù•ÊîØÊåÅ LXC ÂÆπÂô®ÔºåÂÆÉ‰πüÂèØ‰ª•ÊîØÊåÅ Docker ÂÆπÂô®„ÄÇËÆ©ÂÆπÂô®ÂÜÖÁöÑÂ∫îÁî®Âú®ËØªÂèñÂÜÖÂ≠òÂíå CPU ‰ø°ÊÅØÁöÑÊó∂ÂÄôÈÄöËøá lxcfs ÁöÑÊò†Â∞ÑÔºåËΩ¨Âà∞Ëá™Â∑±ÁöÑÈÄöËøáÂØπ cgroup ‰∏≠ÂÆπÂô®Áõ∏ÂÖ≥ÂÆö‰πâ‰ø°ÊÅØËØªÂèñÁöÑËôöÊãüÊï∞ÊçÆ‰∏ä„ÄÇ ‰ªÄ‰πàÊòØËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÔºüÂÆπÂô®ÊäÄÊúØÊèê‰æõ‰∫Ü‰∏çÂêå‰∫é‰º†ÁªüËôöÊãüÊú∫ÊäÄÊúØÁöÑÁéØÂ¢ÉÈöîÁ¶ªÊñπÂºè„ÄÇÈÄöÂ∏∏ÁöÑLinuxÂÆπÂô®ÂØπÂÆπÂô®ÊâìÂåÖÂíåÂêØÂä®ËøõË°å‰∫ÜÂä†ÈÄüÔºå‰ΩÜ‰πüÈôç‰Ωé‰∫ÜÂÆπÂô®ÁöÑÈöîÁ¶ªÂº∫Â∫¶„ÄÇÂÖ∂‰∏≠LinuxÂÆπÂô®ÊúÄ‰∏∫Áü•ÂêçÁöÑÈóÆÈ¢òÂ∞±ÊòØËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÈóÆÈ¢ò„ÄÇ ÂÆπÂô®ÂèØ‰ª•ÈÄöËøá cgroup ÁöÑÊñπÂºèÂØπËµÑÊ∫êÁöÑ‰ΩøÁî®ÊÉÖÂÜµËøõË°åÈôêÂà∂ÔºåÂåÖÊã¨: ÂÜÖÂ≠òÔºåCPU Á≠â„ÄÇ‰ΩÜÊòØÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ¶ÇÊûúÂÆπÂô®ÂÜÖÁöÑ‰∏Ä‰∏™ËøõÁ®ã‰ΩøÁî®‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÁõëÊéßÂëΩ‰ª§ÔºåÂ¶Ç: free, top Á≠âÂëΩ‰ª§ÂÖ∂ÂÆûÁúãÂà∞ËøòÊòØÁâ©ÁêÜÊú∫ÁöÑÊï∞ÊçÆÔºåËÄåÈùûÂÆπÂô®ÁöÑÊï∞ÊçÆ„ÄÇËøôÊòØÁî±‰∫éÂÆπÂô®Âπ∂Ê≤°ÊúâÂÅöÂà∞ÂØπ /proc, /sys Á≠âÊñá‰ª∂Á≥ªÁªüÁöÑËµÑÊ∫êËßÜÂõæÈöîÁ¶ª„ÄÇ ‰∏∫‰ªÄ‰πàË¶ÅÂÅöÂÆπÂô®ÁöÑËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÔºü ‰ªéÂÆπÂô®ÁöÑËßÜËßíÊù•ÁúãÔºåÈÄöÂ∏∏Êúâ‰∏Ä‰∫õ‰∏öÂä°ÂºÄÂèëËÄÖÂ∑≤Áªè‰π†ÊÉØ‰∫ÜÂú®‰º†ÁªüÁöÑÁâ©ÁêÜÊú∫ÔºåËôöÊãüÊú∫‰∏ä‰ΩøÁî® top, free` Á≠âÂëΩ‰ª§Êù•Êü•ÁúãÁ≥ªÁªüÁöÑËµÑÊ∫ê‰ΩøÁî®ÊÉÖÂÜµÔºå‰ΩÜÊòØÂÆπÂô®Ê≤°ÊúâÂÅöÂà∞ËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÔºåÈÇ£‰πàÂú®ÂÆπÂô®ÈáåÈù¢ÁúãÂà∞ÁöÑÊï∞ÊçÆËøòÊòØÁâ©ÁêÜÊú∫ÁöÑÊï∞ÊçÆ„ÄÇ ‰ªéÂ∫îÁî®Á®ãÂ∫èÁöÑËßÜËßíÊù•ÁúãÔºåÂú®ÂÆπÂô®ÈáåÈù¢ËøêË°åËøõÁ®ãÂíåÂú®Áâ©ÁêÜÊú∫ËôöÊãüÊú∫‰∏äËøêË°åËøõÁ®ãÁöÑËøêË°åÁéØÂ¢ÉÊòØ‰∏çÂêåÁöÑ„ÄÇÂπ∂‰∏îÊúâ‰∫õÂ∫îÁî®Âú®ÂÆπÂô®ÈáåÈù¢ËøêË°åËøõÁ®ã‰ºöÂ≠òÂú®‰∏Ä‰∫õÂÆâÂÖ®ÈöêÊÇ£: ÂØπ‰∫éÂæàÂ§öÂü∫‰∫é JVM ÁöÑ java Á®ãÂ∫èÔºåÂ∫îÁî®ÂêØÂä®Êó∂‰ºöÊ†πÊçÆÁ≥ªÁªüÁöÑËµÑÊ∫ê‰∏äÈôêÊù•ÂàÜÈÖç JVM ÁöÑÂ†ÜÂíåÊ†àÁöÑÂ§ßÂ∞è„ÄÇËÄåÂú®ÂÆπÂô®ÈáåÈù¢ËøêË°åËøêË°å JAVA Â∫îÁî®Áî±‰∫é JVM Ëé∑ÂèñÁöÑÂÜÖÂ≠òÊï∞ÊçÆËøòÊòØÁâ©ÁêÜÊú∫ÁöÑÊï∞ÊçÆÔºåËÄåÂÆπÂô®ÂàÜÈÖçÁöÑËµÑÊ∫êÈÖçÈ¢ùÂèàÂ∞è‰∫é JVM ÂêØÂä®Êó∂ÈúÄË¶ÅÁöÑËµÑÊ∫êÂ§ßÂ∞èÔºåÂ∞±‰ºöÂØºËá¥Á®ãÂ∫èÂêØÂä®‰∏çÊàêÂäü„ÄÇ ÂØπ‰∫éÈúÄË¶ÅËé∑Âèñ host cpu info ÁöÑÁ®ãÂ∫èÔºåÊØîÂ¶ÇÂú®ÂºÄÂèë golang ÊúçÂä°Á´ØÈúÄË¶ÅËé∑Âèñ golang‰∏≠ runtime.GOMAXPROCS(runtime.NumCPU()) ÊàñËÄÖËøêÁª¥Âú®ËÆæÁΩÆÊúçÂä°ÂêØÂä®ËøõÁ®ãÊï∞ÈáèÁöÑÊó∂ÂÄô( ÊØîÂ¶Ç nginx ÈÖçÁΩÆ‰∏≠ÁöÑ worker_processes auto )ÔºåÈÉΩÂñúÊ¨¢ÈÄöËøáÁ®ãÂ∫èËá™Âä®Âà§Êñ≠ÊâÄÂú®ËøêË°åÁéØÂ¢ÉCPUÁöÑÊï∞Èáè„ÄÇ‰ΩÜÊòØÂú®ÂÆπÂô®ÂÜÖÁöÑËøõÁ®ãÊÄª‰ºö‰ªé/proc/cpuinfo‰∏≠Ëé∑ÂèñÂà∞ CPU ÁöÑÊ†∏Êï∞ÔºåËÄåÂÆπÂô®ÈáåÈù¢ÁöÑ/procÊñá‰ª∂Á≥ªÁªüËøòÊòØÁâ©ÁêÜÊú∫ÁöÑÔºå‰ªéËÄå‰ºöÂΩ±ÂìçÂà∞ËøêË°åÂú®ÂÆπÂô®ÈáåÈù¢ÊúçÂä°ÁöÑËøêË°åÁä∂ÊÄÅ„ÄÇ Â¶Ç‰ΩïÂÅöÂÆπÂô®ÁöÑËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÔºü lxcfs Ê®™Á©∫Âá∫‰∏ñÂ∞±ÊòØ‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇlxcfs ÊòØÈÄöËøáÊñá‰ª∂ÊåÇËΩΩÁöÑÊñπÂºèÔºåÊää cgroup ‰∏≠ÂÖ≥‰∫éÁ≥ªÁªüÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØËØªÂèñÂá∫Êù•ÔºåÈÄöËøá docker ÁöÑ volume ÊåÇËΩΩÁªôÂÆπÂô®ÂÜÖÈÉ®ÁöÑ proc Á≥ªÁªü„ÄÇ ÁÑ∂ÂêéËÆ© docker ÂÜÖÁöÑÂ∫îÁî®ËØªÂèñ proc ‰∏≠‰ø°ÊÅØÁöÑÊó∂ÂÄô‰ª•‰∏∫Â∞±ÊòØËØªÂèñÁöÑÂÆø‰∏ªÊú∫ÁöÑÁúüÂÆûÁöÑ proc„ÄÇ ‰∏ãÈù¢ÊòØ lxcfs ÁöÑÂ∑•‰ΩúÂéüÁêÜÊû∂ÊûÑÂõæÔºö Ëß£Èáä‰∏Ä‰∏ãËøôÂº†ÂõæÔºåÂΩìÊàë‰ª¨ÊääÂÆø‰∏ªÊú∫ÁöÑ /var/lib/lxcfs/proc/memoinfo Êñá‰ª∂ÊåÇËΩΩÂà∞ Docker ÂÆπÂô®ÁöÑ /proc/meminfo ‰ΩçÁΩÆÂêéÔºåÂÆπÂô®‰∏≠ËøõÁ®ãËØªÂèñÁõ∏Â∫îÊñá‰ª∂ÂÜÖÂÆπÊó∂Ôºålxcfs ÁöÑ /dev/fuse ÂÆûÁé∞‰ºö‰ªéÂÆπÂô®ÂØπÂ∫îÁöÑ Cgroup ‰∏≠ËØªÂèñÊ≠£Á°ÆÁöÑÂÜÖÂ≠òÈôêÂà∂„ÄÇ‰ªéËÄå‰ΩøÂæóÂ∫îÁî®Ëé∑ÂæóÊ≠£Á°ÆÁöÑËµÑÊ∫êÁ∫¶Êùü„ÄÇ cpu ÁöÑÈôêÂà∂ÂéüÁêÜ‰πüÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ ÈÄöËøá lxcfs ÂÆûÁé∞ËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÂÆâË£Ö lxcfs12wget &lt;https://copr-be.cloud.fedoraproject.org/results/ganto/lxc3/epel-7-x86_64/01041891-lxcfs/lxcfs-3.1.2-0.2.el7.x86_64.rpm&gt;rpm -ivh lxcfs-3.1.2-0.2.el7.x86_64.rpm Ê£ÄÊü•‰∏Ä‰∏ãÂÆâË£ÖÊòØÂê¶ÊàêÂäü 1234567[root@ifdasdfe2344 system]# lxcfs -hUsage:lxcfs [-f|-d] [-p pidfile] mountpoint -f running foreground by default; -d enable debug output Default pidfile is /run/lxcfs.pidlxcfs -h ÂêØÂä® lxcfs Áõ¥Êé•ÂêéÂè∞ÂêØÂä® 1lxcfs /var/lib/lxcfs &amp; ÈÄöËøá systemd ÂêØÂä®ÔºàÊé®ËçêÔºâ 1234567891011121314151617touch /usr/lib/systemd/system/lxcfs.servicecat &gt; /usr/lib/systemd/system/lxcfs.service &lt;&lt;EOF[Unit]Description=lxcfs[Service]ExecStart=/usr/bin/lxcfs -f /var/lib/lxcfsRestart=on-failure#ExecReload=/bin/kill -s SIGHUP $MAINPID[Install]WantedBy=multi-user.targetEOFsystemctl daemon-reloadsystemctl start lxcfs.service Ê£ÄÊü•ÂêØÂä®ÊòØÂê¶ÊàêÂäü 123[root@ifdasdfe2344 system]# ps aux | grep lxcfsroot 3276 0.0 0.0 112708 980 pts/2 S+ 15:45 0:00 grep --color=auto lxcfsroot 18625 0.0 0.0 234628 1296 ? Ssl 14:16 0:00 /usr/bin/lxcfs -f /var/lib/lxcfs ÂêØÂä®ÊàêÂäü„ÄÇ È™åËØÅ lxcfs ÊïàÊûúÊú™ÂºÄÂêØ lxcfsÊàë‰ª¨È¶ñÂÖàÂú®Êú™ÂºÄÂêØ lxcfs ÁöÑÊú∫Âô®‰∏äËøêË°å‰∏Ä‰∏™ÂÆπÂô®ÔºåËøõÂÖ•Âà∞ÂÆπÂô®‰∏≠ËßÇÂØü cpu, memory ÁöÑ‰ø°ÊÅØ„ÄÇ‰∏∫‰∫ÜÁúãÂá∫ÊòéÊòæÁöÑÂ∑ÆÂà´ÔºåÊàë‰ª¨Áî®‰∫Ü‰∏ÄÂè∞È´òÈÖçÁΩÆÊúçÂä°Âô®Ôºà32c128gÔºâ„ÄÇ 123456# ÊâßË°å‰ª•‰∏ãÊìç‰Ωúsystemctl stop lxcfsdocker run -it ubuntu /bin/bash # ËøõÂÖ•Âà∞ nginx ÂÆπÂô®‰∏≠free -h ÈÄöËøá‰∏äÈù¢ÁöÑÁªìÊûúÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ËôΩÁÑ∂ÊòØÂú®ÂÆπÂô®‰∏≠Êü•ÁúãÂÜÖÂ≠ò‰ø°ÊÅØÔºå‰ΩÜÊòØÊòæÁ§∫ÁöÑËøòÊòØÂÆø‰∏ªÊú∫ÁöÑ meminfo„ÄÇ 12# Áúã‰∏Ä‰∏ã CPU ÁöÑÊ†∏Êï∞cat /proc/cpuinfo| grep "processor"| wc -l ÁªìÊûúÁ¨¶ÂêàÊàë‰ª¨ÁöÑÁåúÊÉ≥ÔºåÊ≤°ÊúâÂºÄÂêØ lxcfs ÔºåÂÆπÂô®ÊâÄÁúãÂà∞ÁöÑ cpuinfo Â∞±ÊòØÂÆø‰∏ªÊú∫ÁöÑ„ÄÇ ÂºÄÂêØ lxcfs12345678910111213systemctl start lxcfs# ÂêØÂä®‰∏Ä‰∏™ÂÆπÂô®ÔºåÁî® lxcfs ÁöÑ /proc Êñá‰ª∂Êò†Â∞ÑÂà∞ÂÆπÂô®‰∏≠ÁöÑ /proc Êñá‰ª∂ÔºåÂÆπÂô®ÂÜÖÂ≠òËÆæÁΩÆ‰∏∫ 256MÔºödocker run -it -m 256m \\ -v /var/lib/lxcfs/proc/cpuinfo:/proc/cpuinfo:rw \\ -v /var/lib/lxcfs/proc/diskstats:/proc/diskstats:rw \\ -v /var/lib/lxcfs/proc/meminfo:/proc/meminfo:rw \\ -v /var/lib/lxcfs/proc/stat:/proc/stat:rw \\ -v /var/lib/lxcfs/proc/swaps:/proc/swaps:rw \\ -v /var/lib/lxcfs/proc/uptime:/proc/uptime:rw \\ ubuntu:latest /bin/bashfree -h ÂèØ‰ª•ÁúãÂà∞ÂÆπÂô®Êú¨Ë∫´ÁöÑÂÜÖÂ≠òË¢´Ê≠£Á°ÆËé∑ÂèñÂà∞‰∫ÜÔºåÂØπ‰∫éÂÜÖÂ≠òÁöÑËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÊòØÊàêÂäüÁöÑ„ÄÇ 12345678910# --cpus 2ÔºåÈôêÂÆöÂÆπÂô®ÊúÄÂ§öÂè™ËÉΩ‰ΩøÁî®‰∏§‰∏™ÈÄªËæëCPUdocker run -it --rm -m 256m --cpus 2 \\ -v /var/lib/lxcfs/proc/cpuinfo:/proc/cpuinfo:rw \\ -v /var/lib/lxcfs/proc/diskstats:/proc/diskstats:rw \\ -v /var/lib/lxcfs/proc/meminfo:/proc/meminfo:rw \\ -v /var/lib/lxcfs/proc/stat:/proc/stat:rw \\ -v /var/lib/lxcfs/proc/swaps:/proc/swaps:rw \\ -v /var/lib/lxcfs/proc/uptime:/proc/uptime:rw \\ ubuntu:latest /bin/sh cpuinfo ‰πüÊòØÊàë‰ª¨ÊâÄÈôêÂà∂ÂÆπÂô®ÊâÄËÉΩ‰ΩøÁî®ÁöÑÈÄªËæë cpu ÁöÑÊï∞Èáè‰∫Ü„ÄÇÊåáÂÆöÂÆπÂô®Âè™ËÉΩÂú®ÊåáÂÆöÁöÑ CPU Êï∞Èáè‰∏äËøêË°åÂ∫îÂΩìÊòØÂà©Â§ß‰∫éÂºäÁöÑÔºåÂ∞±ÊòØÂú®ÂàõÂª∫ÂÆπÂô®ÁöÑÊó∂ÂÄôÈúÄË¶ÅÈ¢ùÂ§ñÂÅöÁÇπÂ∑•‰ΩúÔºåÂêàÁêÜÂàÜÈÖç cpuset„ÄÇ lxcfs ÁöÑ KubernetesÂÆûË∑µÂú®kubernetes‰∏≠‰ΩøÁî®lxcfsÈúÄË¶ÅËß£ÂÜ≥‰∏§‰∏™ÈóÆÈ¢òÔºö Á¨¨‰∏Ä‰∏™ÈóÆÈ¢òÊòØÊØè‰∏™node‰∏äÈÉΩË¶ÅÂêØÂä® lxcfsÔºõ Á¨¨‰∫å‰∏™ÈóÆÈ¢òÊòØÂ∞Ü lxcfs Áª¥Êä§ÁöÑ /proc Êñá‰ª∂ÊåÇËΩΩÂà∞ÊØè‰∏™ÂÆπÂô®‰∏≠Ôºõ DaemonSetÊñπÂºèÊù•ËøêË°å lxcfs FUSEÊñá‰ª∂Á≥ªÁªüÈíàÂØπÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢òÔºåÊàë‰ª¨‰ΩøÁî® daemonset Âú®ÊØè‰∏™ k8s node ‰∏äÈÉΩÂÆâË£Ö lxcfs„ÄÇ Áõ¥Êé•‰ΩøÁî®‰∏ãÈù¢ÁöÑ yaml Êñá‰ª∂Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344apiVersion: apps/v1kind: DaemonSetmetadata: name: lxcfs labels: app: lxcfsspec: selector: matchLabels: app: lxcfs template: metadata: labels: app: lxcfs spec: hostPID: true tolerations: - key: node-role.kubernetes.io/master effect: NoSchedule containers: - name: lxcfs image: registry.cn-hangzhou.aliyuncs.com/denverdino/lxcfs:3.0.4 imagePullPolicy: Always securityContext: privileged: true volumeMounts: - name: cgroup mountPath: /sys/fs/cgroup - name: lxcfs mountPath: /var/lib/lxcfs mountPropagation: Bidirectional - name: usr-local mountPath: /usr/local volumes: - name: cgroup hostPath: path: /sys/fs/cgroup - name: usr-local hostPath: path: /usr/local - name: lxcfs hostPath: path: /var/lib/lxcfs type: DirectoryOrCreate 1kubectl apply -f lxcfs-daemonset.yaml ÂèØ‰ª•ÁúãÂà∞ lxcfs ÁöÑ daemonset Â∑≤ÁªèÈÉ®ÁΩ≤Âà∞ÊØè‰∏™ node ‰∏ä„ÄÇ Êò†Â∞Ñ lxcfs ÁöÑ proc Êñá‰ª∂Âà∞ÂÆπÂô®ÈíàÂØπÁ¨¨‰∫å‰∏™ÈóÆÈ¢òÔºåÊàë‰ª¨‰∏§ÁßçÊñπÊ≥ïÊù•Ëß£ÂÜ≥„ÄÇ Á¨¨‰∏ÄÁßçÂ∞±ÊòØÁÆÄÂçïÂú∞Âú® k8s deployment ÁöÑ yaml Êñá‰ª∂‰∏≠Â£∞ÊòéÂØπÂÆø‰∏ªÊú∫ /var/lib/lxcfs/proc ‰∏ÄÁ≥ªÂàóÊñá‰ª∂ÁöÑÊåÇËΩΩ„ÄÇ Á¨¨‰∫åÁßçÊñπÂºèÂà©Áî®KubernetesÁöÑÊâ©Â±ïÊú∫Âà∂ InitializerÔºåÂÆûÁé∞ÂØπ lxcfs Êñá‰ª∂ÁöÑËá™Âä®ÂåñÊåÇËΩΩ„ÄÇ‰ΩÜÊòØ InitializerConfiguration ÁöÑÂäüËÉΩÂú® k8s 1.14 ‰πãÂêéÂ∞±‰∏çÂÜçÊîØÊåÅ‰∫ÜÔºåËøôÈáå‰∏çÂÜçËµòËø∞„ÄÇ‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÂÆûÁé∞ admission-webhook ÔºàÂáÜÂÖ•ÊéßÂà∂ÔºàAdmission ControlÔºâÂú®ÊéàÊùÉÂêéÂØπËØ∑Ê±ÇÂÅöËøõ‰∏ÄÊ≠•ÁöÑÈ™åËØÅÊàñÊ∑ªÂä†ÈªòËÆ§ÂèÇÊï∞, https://kubernetes.feisky.xyz/extension/auth/admissionÔºâÊù•ËææÂà∞ÂêåÊ†∑ÁöÑÁõÆÁöÑ„ÄÇ 123# È™åËØÅ‰Ω†ÁöÑ k8s ÈõÜÁæ§ÊòØÂê¶ÊîØÊåÅ admission$ kubectl api-versions | grep admissionregistration.k8s.io/v1beta1admissionregistration.k8s.io/v1beta1 ÂÖ≥‰∫é admission-webhook ÁöÑÁºñÂÜô‰∏çÂ±û‰∫éÊú¨ÊñáÁöÑËÆ®ËÆ∫ËåÉÂõ¥ÔºåÂèØ‰ª•Âà∞ÂÆòÊñπÊñáÊ°£‰∏≠Ê∑±ÂÖ•‰∫ÜËß£„ÄÇ ËøôÈáåÊúâ‰∏Ä‰∏™ÂÆûÁé∞ lxcfs admission webhook ÁöÑËåÉ‰æãÔºåÂèØ‰ª•ÂèÇËÄÉÔºöhttps://github.com/hantmac/lxcfs-admission-webhook ÊÄªÁªìÊú¨Êñá‰ªãÁªç‰∫ÜÈÄöËøá lxcfs Êèê‰æõÂÆπÂô®ËµÑÊ∫êËßÜÂõæÈöîÁ¶ªÁöÑÊñπÊ≥ïÔºåÂèØ‰ª•Â∏ÆÂä©‰∏Ä‰∫õÂÆπÂô®ÂåñÂ∫îÁî®Êõ¥Â•ΩÁöÑËØÜÂà´ÂÆπÂô®ËøêË°åÊó∂ÁöÑËµÑÊ∫êÈôêÂà∂„ÄÇ ÂêåÊó∂ÔºåÂú®Êú¨Êñá‰∏≠Êàë‰ª¨‰ªãÁªç‰∫ÜÂà©Áî®ÂÆπÂô®Âíå DaemonSet ÁöÑÊñπÂºèÈÉ®ÁΩ≤ lxcfs FUSEÔºåËøô‰∏ç‰ΩÜÊûÅÂ§ßÁÆÄÂåñ‰∫ÜÈÉ®ÁΩ≤Ôºå‰πüÂèØ‰ª•Êñπ‰æøÂú∞Âà©Áî® Kubernetes Ëá™Ë∫´ÁöÑÂÆπÂô®ÁÆ°ÁêÜËÉΩÂäõÔºåÊîØÊåÅ lxcfs ËøõÁ®ãÂ§±ÊïàÊó∂Ëá™Âä®ÊÅ¢Â§çÔºåÂú®ÈõÜÁæ§‰º∏Áº©Êó∂‰πüÂèØ‰ª•‰øùËØÅËäÇÁÇπÈÉ®ÁΩ≤ÁöÑ‰∏ÄËá¥ÊÄß„ÄÇËøô‰∏™ÊäÄÂ∑ßÂØπ‰∫éÂÖ∂‰ªñÁ±ª‰ººÁöÑÁõëÊéßÊàñËÄÖÁ≥ªÁªüÊâ©Â±ïÈÉΩÊòØÈÄÇÁî®ÁöÑ„ÄÇ Âè¶Â§ñÊàë‰ª¨‰ªãÁªç‰∫ÜÂà©Áî®KubernetesÁöÑ admission webhookÔºåÂÆûÁé∞ÂØπ lxcfs Êñá‰ª∂ÁöÑËá™Âä®ÂåñÊåÇËΩΩ„ÄÇÊï¥‰∏™ËøáÁ®ãÂØπ‰∫éÂ∫îÁî®ÈÉ®ÁΩ≤‰∫∫ÂëòÊòØÈÄèÊòéÁöÑÔºåÂèØ‰ª•ÊûÅÂ§ßÁÆÄÂåñËøêÁª¥Â§çÊùÇÂ∫¶„ÄÇ]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÈáçÁ£ÖÔºÅÂæÆËΩØ VS Code ÁöÑ Go ËØ≠Ë®ÄÊèí‰ª∂ËøÅÁßªËá≥Áî± Go ÂÆòÊñπÂõ¢ÈòüÁª¥Êä§]]></title>
    <url>%2F2020%2F06%2F12%2F%E9%87%8D%E7%A3%85%EF%BC%81%E5%BE%AE%E8%BD%AF-VS-Code-%E7%9A%84-Go-%E8%AF%AD%E8%A8%80%E6%8F%92%E4%BB%B6%E8%BF%81%E7%A7%BB%E8%87%B3%E7%94%B1-Go-%E5%AE%98%E6%96%B9%E5%9B%A2%E9%98%9F%E7%BB%B4%E6%8A%A4%2F</url>
    <content type="text"><![CDATA[Go ÂÆòÊñπ 6Êúà 9Êó•ÁîµÔºöVS Code ÁöÑ Go plugin Â∑≤ÁªèËΩ¨‰∏∫ Go ÂÆòÊñπÂõ¢ÈòüÁª¥Êä§ÁöÑÈ°πÁõÆ„ÄÇÂÖ∂‰∏≠Êúâ‰∏§‰∏™ÈáçË¶ÅÁöÑÊ†áÂøóÊÄß‰∫ã‰ª∂Ôºö GitHub ‰ªìÂ∫ìÂ∑≤Áªè‰ªé https://github.com/microsoft/vscode-go ËøÅÁßªËá≥ https://github.com/golang/vscode-go Ôºõ Âú® VS Code Êèí‰ª∂Â∏ÇÂú∫‰∏≠ÁöÑÂèëÂ∏ÉËÄÖ‰πüÁî± Microsoft ÂèòÊõ¥‰∏∫ Go Team at Google „ÄÇ Ëá™ÂéªÂπ¥ Go modules ÂèëÂ∏É‰ª•Êù•ÔºåVS Code Âõ¢ÈòüÂ∞±Âíå Go Âõ¢ÈòüÂºÄÂßã‰∫ÜÁ¥ßÂØÜÁöÑÂêà‰ΩúÔºåËÆ©Êèí‰ª∂Âæó‰ª•ÊîØÊåÅ Go ÁöÑÂÆòÊñπËØ≠Ë®ÄÊúçÂä°Âô® goplsÔºåÁõÆÂâçËøòÊ≠£Âú®ÊîπËøõÂØπ Delve Ë∞ÉËØïÂô®ÁöÑÊîØÊåÅ„ÄÇ ‰ªéÂè¶‰∏ÄÊñπÈù¢Êù•ÁúãÔºåËøÅÁßªËá≥Áî± Go Âõ¢ÈòüÁª¥Êä§ÊÑèÂë≥ÁùÄÊ≠§Êèí‰ª∂Êàê‰∏∫‰∫Ü Go È°πÁõÆÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂèØÁ°Æ‰øù Go Á§æÂå∫ÊàêÂëòËÉΩÂèÇ‰∏éÂà∞È°πÁõÆÁöÑÊØè‰∏ÄÊ≠•„ÄÇÊèí‰ª∂ÁõÆÂâç‰æùËµñ‰∫éËÆ∏Â§ö‰∏çÂêåÁöÑÂ∑•ÂÖ∑ÂíåÂ∫ìÔºåËÄåËøô‰∫õÂ∑•ÂÖ∑ÂíåÂ∫ìÂùáÁî±Á§æÂå∫Áª¥Êä§ÔºåVS Code Âõ¢ÈòüÂ∏åÊúõ‰∏éËøô‰∫õÈ°πÁõÆÁöÑÊâÄÊúâËÄÖÂêà‰ΩúÔºå‰ª•Â∏ÆÂä©ÂáèÂ∞ë Go Á§æÂå∫ÁöÑÁª¥Êä§Â∑•‰ΩúË¥üÊãÖÔºåÂπ∂ÈºìÂä±Êõ¥Â§ö Gophers ÂèÇ‰∏éËøõÊù•ÂÖ±ÂêåÁª¥Êä§„ÄÇ ÂéüÊñáÂú∞ÂùÄ: https://blog.golang.org/vscode-go]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Uber Go ËØ≠Ë®ÄÁºñÁ†ÅËßÑËåÉ]]></title>
    <url>%2F2020%2F06%2F09%2FUber-Go-%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%2F</url>
    <content type="text"><![CDATA[uber-go/guide ÁöÑ‰∏≠ÊñáÁøªËØëEnglishUber Go ËØ≠Ë®ÄÁºñÁ†ÅËßÑËåÉ Uber ÊòØ‰∏ÄÂÆ∂ÁæéÂõΩÁ°ÖË∞∑ÁöÑÁßëÊäÄÂÖ¨Âè∏Ôºå‰πüÊòØ Go ËØ≠Ë®ÄÁöÑÊó©Êúü adopter„ÄÇÂÖ∂ÂºÄÊ∫ê‰∫ÜÂæàÂ§ö golang È°πÁõÆÔºåËØ∏Â¶ÇË¢´ Gopher ÂúàÁÜüÁü•ÁöÑ zap„ÄÅjaeger Á≠â„ÄÇ2018 Âπ¥Âπ¥Êú´ Uber Â∞ÜÂÜÖÈÉ®ÁöÑ Go È£éÊ†ºËßÑËåÉ ÂºÄÊ∫êÂà∞ GitHubÔºåÁªèËøá‰∏ÄÂπ¥ÁöÑÁßØÁ¥ØÂíåÊõ¥Êñ∞ÔºåËØ•ËßÑËåÉÂ∑≤ÁªèÂàùÂÖ∑ËßÑÊ®°ÔºåÂπ∂ÂèóÂà∞ÂπøÂ§ß Gopher ÁöÑÂÖ≥Ê≥®„ÄÇÊú¨ÊñáÊòØËØ•ËßÑËåÉÁöÑ‰∏≠ÊñáÁâàÊú¨„ÄÇÊú¨ÁâàÊú¨‰ºöÊ†πÊçÆÂéüÁâàÂÆûÊó∂Êõ¥Êñ∞„ÄÇ ÁâàÊú¨ ÂΩìÂâçÊõ¥Êñ∞ÁâàÊú¨Ôºö2020-06-05 ÁâàÊú¨Âú∞ÂùÄÔºöcommit:#93 Â¶ÇÊûúÊÇ®ÂèëÁé∞‰ªª‰ΩïÊõ¥Êñ∞„ÄÅÈóÆÈ¢òÊàñÊîπËøõÔºåËØ∑ÈöèÊó∂ fork Âíå PR Please feel free to fork and PR if you find any updates, issues or improvement. ÁõÆÂΩï 2019-12-17 2019-11-26 2020-01-11 2020-02-03 2020-02-25 2020-06-05 uber-go/guide ÁöÑ‰∏≠ÊñáÁøªËØë English Uber Go ËØ≠Ë®ÄÁºñÁ†ÅËßÑËåÉ ÁâàÊú¨ ÁõÆÂΩï ‰ªãÁªç ÊåáÂØºÂéüÂàô ÊåáÂêë interface ÁöÑÊåáÈíà Interface ÂêàÁêÜÊÄßÈ™åËØÅ Êé•Êî∂Âô® (receiver) ‰∏éÊé•Âè£ Èõ∂ÂÄº Mutex ÊòØÊúâÊïàÁöÑ Âú®ËæπÁïåÂ§ÑÊã∑Ë¥ù Slices Âíå Maps Êé•Êî∂ Slices Âíå Maps ËøîÂõû slices Êàñ maps ‰ΩøÁî® defer ÈáäÊîæËµÑÊ∫ê Channel ÁöÑ size Ë¶Å‰πàÊòØ 1ÔºåË¶Å‰πàÊòØÊó†ÁºìÂÜ≤ÁöÑ Êûö‰∏æ‰ªé 1 ÂºÄÂßã ‰ΩøÁî® time Â§ÑÁêÜÊó∂Èó¥ ‰ΩøÁî® time.Time Ë°®ËææÁû¨Êó∂Êó∂Èó¥ ‰ΩøÁî® time.Duration Ë°®ËææÊó∂Èó¥ÊÆµ ÂØπÂ§ñÈÉ®Á≥ªÁªü‰ΩøÁî® time.Time Âíå time.Duration ÈîôËØØÁ±ªÂûã ÈîôËØØÂåÖË£Ö (Error Wrapping) Â§ÑÁêÜÁ±ªÂûãÊñ≠Ë®ÄÂ§±Ë¥• ‰∏çË¶Å panic ‰ΩøÁî® go.uber.org/atomic ÈÅøÂÖçÂèØÂèòÂÖ®Â±ÄÂèòÈáè ÈÅøÂÖçÂú®ÂÖ¨ÂÖ±ÁªìÊûÑ‰∏≠ÂµåÂÖ•Á±ªÂûã ÈÅøÂÖç‰ΩøÁî®ÂÜÖÁΩÆÂêçÁß∞ ÊÄßËÉΩ ‰ºòÂÖà‰ΩøÁî® strconv ËÄå‰∏çÊòØ fmt ÈÅøÂÖçÂ≠óÁ¨¶‰∏≤Âà∞Â≠óËäÇÁöÑËΩ¨Êç¢ Â∞ΩÈáèÂàùÂßãÂåñÊó∂ÊåáÂÆö Map ÂÆπÈáè ËßÑËåÉ ‰∏ÄËá¥ÊÄß Áõ∏‰ººÁöÑÂ£∞ÊòéÊîæÂú®‰∏ÄÁªÑ import ÂàÜÁªÑ ÂåÖÂêç ÂáΩÊï∞Âêç ÂØºÂÖ•Âà´Âêç ÂáΩÊï∞ÂàÜÁªÑ‰∏éÈ°∫Â∫è ÂáèÂ∞ëÂµåÂ•ó ‰∏çÂøÖË¶ÅÁöÑ else È°∂Â±ÇÂèòÈáèÂ£∞Êòé ÂØπ‰∫éÊú™ÂØºÂá∫ÁöÑÈ°∂Â±ÇÂ∏∏ÈáèÂíåÂèòÈáèÔºå‰ΩøÁî®_‰Ωú‰∏∫ÂâçÁºÄ ÁªìÊûÑ‰Ωì‰∏≠ÁöÑÂµåÂÖ• ‰ΩøÁî®Â≠óÊÆµÂêçÂàùÂßãÂåñÁªìÊûÑ‰Ωì Êú¨Âú∞ÂèòÈáèÂ£∞Êòé nil ÊòØ‰∏Ä‰∏™ÊúâÊïàÁöÑ slice Áº©Â∞èÂèòÈáè‰ΩúÁî®Âüü ÈÅøÂÖçÂèÇÊï∞ËØ≠‰πâ‰∏çÊòéÁ°Æ(Avoid Naked Parameters) ‰ΩøÁî®ÂéüÂßãÂ≠óÁ¨¶‰∏≤Â≠óÈù¢ÂÄºÔºåÈÅøÂÖçËΩ¨‰πâ ÂàùÂßãÂåñ Struct ÂºïÁî® ÂàùÂßãÂåñ Maps Â≠óÁ¨¶‰∏≤ string format ÂëΩÂêç Printf Ê†∑ÂºèÁöÑÂáΩÊï∞ ÁºñÁ®ãÊ®°Âºè Ë°®È©±Âä®ÊµãËØï ÂäüËÉΩÈÄâÈ°π Stargazers over time ‰ªãÁªçÊ†∑Âºè (style) ÊòØÊîØÈÖçÊàë‰ª¨‰ª£Á†ÅÁöÑÊÉØ‰æã„ÄÇÊúØËØ≠Ê†∑ÂºèÊúâÁÇπÁî®ËØç‰∏çÂΩìÔºåÂõ†‰∏∫Ëøô‰∫õÁ∫¶ÂÆöÊ∂µÁõñÁöÑËåÉÂõ¥‰∏çÈôê‰∫éÁî± gofmt ÊõøÊàë‰ª¨Â§ÑÁêÜÁöÑÊ∫êÊñá‰ª∂Ê†ºÂºè„ÄÇ Êú¨ÊåáÂçóÁöÑÁõÆÁöÑÊòØÈÄöËøáËØ¶ÁªÜÊèèËø∞Âú® Uber ÁºñÂÜô Go ‰ª£Á†ÅÁöÑÊ≥®ÊÑè‰∫ãÈ°πÊù•ÁÆ°ÁêÜËøôÁßçÂ§çÊùÇÊÄß„ÄÇËøô‰∫õËßÑÂàôÁöÑÂ≠òÂú®ÊòØ‰∏∫‰∫Ü‰Ωø‰ª£Á†ÅÂ∫ìÊòì‰∫éÁÆ°ÁêÜÔºåÂêåÊó∂‰ªçÁÑ∂ÂÖÅËÆ∏Â∑•Á®ãÂ∏àÊõ¥ÊúâÊïàÂú∞‰ΩøÁî® Go ËØ≠Ë®ÄÂäüËÉΩ„ÄÇ ËØ•ÊåáÂçóÊúÄÂàùÁî± Prashant Varanasi Âíå Simon Newton ÁºñÂÜôÔºåÁõÆÁöÑÊòØ‰Ωø‰∏Ä‰∫õÂêå‰∫ãËÉΩÂø´ÈÄü‰ΩøÁî® Go„ÄÇÂ§öÂπ¥Êù•ÔºåËØ•ÊåáÂçóÂ∑≤Ê†πÊçÆÂÖ∂‰ªñ‰∫∫ÁöÑÂèçÈ¶àËøõË°å‰∫Ü‰øÆÊîπ„ÄÇ Êú¨ÊñáÊ°£ËÆ∞ÂΩï‰∫ÜÊàë‰ª¨Âú® Uber ÈÅµÂæ™ÁöÑ Go ‰ª£Á†Å‰∏≠ÁöÑÊÉØÁî®Á∫¶ÂÆö„ÄÇÂÖ∂‰∏≠ËÆ∏Â§öÊòØ Go ÁöÑÈÄöÁî®ÂáÜÂàôÔºåËÄåÂÖ∂‰ªñÊâ©Â±ïÂáÜÂàô‰æùËµñ‰∫é‰∏ãÈù¢Â§ñÈÉ®ÁöÑÊåáÂçóÔºö Effective Go The Go common mistakes guide ÊâÄÊúâ‰ª£Á†ÅÈÉΩÂ∫îËØ•ÈÄöËøágolintÂíågo vetÁöÑÊ£ÄÊü•Âπ∂Êó†ÈîôËØØ„ÄÇÊàë‰ª¨Âª∫ËÆÆÊÇ®Â∞ÜÁºñËæëÂô®ËÆæÁΩÆ‰∏∫Ôºö ‰øùÂ≠òÊó∂ËøêË°å goimports ËøêË°å golint Âíå go vet Ê£ÄÊü•ÈîôËØØ ÊÇ®ÂèØ‰ª•Âú®‰ª•‰∏ã Go ÁºñËæëÂô®Â∑•ÂÖ∑ÊîØÊåÅÈ°µÈù¢‰∏≠ÊâæÂà∞Êõ¥‰∏∫ËØ¶ÁªÜÁöÑ‰ø°ÊÅØÔºöhttps://github.com/golang/go/wiki/IDEsAndTextEditorPlugins ÊåáÂØºÂéüÂàôÊåáÂêë interface ÁöÑÊåáÈíàÊÇ®Âá†‰πé‰∏çÈúÄË¶ÅÊåáÂêëÊé•Âè£Á±ªÂûãÁöÑÊåáÈíà„ÄÇÊÇ®Â∫îËØ•Â∞ÜÊé•Âè£‰Ωú‰∏∫ÂÄºËøõË°å‰º†ÈÄíÔºåÂú®ËøôÊ†∑ÁöÑ‰º†ÈÄíËøáÁ®ã‰∏≠ÔºåÂÆûË¥®‰∏ä‰º†ÈÄíÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆ‰ªçÁÑ∂ÂèØ‰ª•ÊòØÊåáÈíà„ÄÇ Êé•Âè£ÂÆûË¥®‰∏äÂú®Â∫ïÂ±ÇÁî®‰∏§‰∏™Â≠óÊÆµË°®Á§∫Ôºö ‰∏Ä‰∏™ÊåáÂêëÊüê‰∫õÁâπÂÆöÁ±ªÂûã‰ø°ÊÅØÁöÑÊåáÈíà„ÄÇÊÇ®ÂèØ‰ª•Â∞ÜÂÖ∂ËßÜ‰∏∫‚Äùtype‚Äù„ÄÇ Êï∞ÊçÆÊåáÈíà„ÄÇÂ¶ÇÊûúÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÊòØÊåáÈíàÔºåÂàôÁõ¥Êé•Â≠òÂÇ®„ÄÇÂ¶ÇÊûúÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÊòØ‰∏Ä‰∏™ÂÄºÔºåÂàôÂ≠òÂÇ®ÊåáÂêëËØ•ÂÄºÁöÑÊåáÈíà„ÄÇ Â¶ÇÊûúÂ∏åÊúõÊé•Âè£ÊñπÊ≥ï‰øÆÊîπÂü∫Á°ÄÊï∞ÊçÆÔºåÂàôÂøÖÈ°ª‰ΩøÁî®ÊåáÈíà‰º†ÈÄí„ÄÇ Interface ÂêàÁêÜÊÄßÈ™åËØÅÂú®ÁºñËØëÊó∂È™åËØÅÊé•Âè£ÁöÑÁ¨¶ÂêàÊÄß„ÄÇËøôÂåÖÊã¨Ôºö Â∞ÜÂÆûÁé∞ÁâπÂÆöÊé•Âè£ÊâÄÈúÄÁöÑÂØºÂá∫Á±ªÂûã‰Ωú‰∏∫ÂÖ∂ API ÁöÑ‰∏ÄÈÉ®ÂàÜ ÂØºÂá∫ÊàñÊú™ÂØºÂá∫ÁöÑÁ±ªÂûãÊòØÂÆûÁé∞Âêå‰∏ÄÊé•Âè£ÁöÑÁ±ªÂûãÈõÜÂêàÁöÑ‰∏ÄÈÉ®ÂàÜ ÂÖ∂‰ªñËøùÂèçÊé•Âè£ÁöÑÊÉÖÂÜµ‰ºöÁ†¥ÂùèÁî®Êà∑„ÄÇ BadGood123456789type Handler struct &#123; // ...&#125;func (h *Handler) ServeHTTP( w http.ResponseWriter, r *http.Request,) &#123; ...&#125;12345678910type Handler struct &#123; // ...&#125;var _ http.Handler = (*Handler)(nil)func (h *Handler) ServeHTTP( w http.ResponseWriter, r *http.Request,) &#123; // ...&#125; Â¶ÇÊûú *Handler Ê∞∏Ëøú‰∏ç‰ºö‰∏é http.Handler Êé•Âè£ÂåπÈÖç,ÈÇ£‰πàËØ≠Âè• var _ http.Handler = (*Handler)(nil) Â∞ÜÊó†Ê≥ïÁºñËØë ËµãÂÄºÁöÑÂè≥ËæπÂ∫îËØ•ÊòØÊñ≠Ë®ÄÁ±ªÂûãÁöÑÈõ∂ÂÄº„ÄÇÂØπ‰∫éÊåáÈíàÁ±ªÂûãÔºàÂ¶Ç *HandlerÔºâ„ÄÅÂàáÁâáÂíåÊò†Â∞ÑÔºåËøôÊòØ nilÔºõÂØπ‰∫éÁªìÊûÑÁ±ªÂûãÔºåËøôÊòØÁ©∫ÁªìÊûÑ„ÄÇ 1234567891011type LogHandler struct &#123; h http.Handler log *zap.Logger&#125;var _ http.Handler = LogHandler&#123;&#125;func (h LogHandler) ServeHTTP( w http.ResponseWriter, r *http.Request,) &#123; // ...&#125; Êé•Êî∂Âô® (receiver) ‰∏éÊé•Âè£‰ΩøÁî®ÂÄºÊé•Êî∂Âô®ÁöÑÊñπÊ≥ïÊó¢ÂèØ‰ª•ÈÄöËøáÂÄºË∞ÉÁî®Ôºå‰πüÂèØ‰ª•ÈÄöËøáÊåáÈíàË∞ÉÁî®„ÄÇ ‰æãÂ¶ÇÔºå 12345678910111213141516171819202122232425type S struct &#123; data string&#125;func (s S) Read() string &#123; return s.data&#125;func (s *S) Write(str string) &#123; s.data = str&#125;sVals := map[int]S&#123;1: &#123;"A"&#125;&#125;// ‰Ω†Âè™ËÉΩÈÄöËøáÂÄºË∞ÉÁî® ReadsVals[1].Read()// Ëøô‰∏çËÉΩÁºñËØëÈÄöËøáÔºö// sVals[1].Write("test")sPtrs := map[int]*S&#123;1: &#123;"A"&#125;&#125;// ÈÄöËøáÊåáÈíàÊó¢ÂèØ‰ª•Ë∞ÉÁî® ReadÔºå‰πüÂèØ‰ª•Ë∞ÉÁî® Write ÊñπÊ≥ïsPtrs[1].Read()sPtrs[1].Write("test") ÂêåÊ†∑ÔºåÂç≥‰ΩøËØ•ÊñπÊ≥ïÂÖ∑ÊúâÂÄºÊé•Êî∂Âô®Ôºå‰πüÂèØ‰ª•ÈÄöËøáÊåáÈíàÊù•Êª°Ë∂≥Êé•Âè£„ÄÇ 123456789101112131415161718192021222324type F interface &#123; f()&#125;type S1 struct&#123;&#125;func (s S1) f() &#123;&#125;type S2 struct&#123;&#125;func (s *S2) f() &#123;&#125;s1Val := S1&#123;&#125;s1Ptr := &amp;S1&#123;&#125;s2Val := S2&#123;&#125;s2Ptr := &amp;S2&#123;&#125;var i Fi = s1Vali = s1Ptri = s2Ptr// ‰∏ãÈù¢‰ª£Á†ÅÊó†Ê≥ïÈÄöËøáÁºñËØë„ÄÇÂõ†‰∏∫ s2Val ÊòØ‰∏Ä‰∏™ÂÄºÔºåËÄå S2 ÁöÑ f ÊñπÊ≥ï‰∏≠Ê≤°Êúâ‰ΩøÁî®ÂÄºÊé•Êî∂Âô®// i = s2Val Effective Go ‰∏≠Êúâ‰∏ÄÊÆµÂÖ≥‰∫é pointers vs. values ÁöÑÁ≤æÂΩ©ËÆ≤Ëß£„ÄÇ Èõ∂ÂÄº Mutex ÊòØÊúâÊïàÁöÑÈõ∂ÂÄº sync.Mutex Âíå sync.RWMutex ÊòØÊúâÊïàÁöÑ„ÄÇÊâÄ‰ª•ÊåáÂêë mutex ÁöÑÊåáÈíàÂü∫Êú¨ÊòØ‰∏çÂøÖË¶ÅÁöÑ„ÄÇ BadGood12mu := new(sync.Mutex)mu.Lock()12var mu sync.Mutexmu.Lock() Â¶ÇÊûú‰Ω†‰ΩøÁî®ÁªìÊûÑ‰ΩìÊåáÈíàÔºåmutex ÂèØ‰ª•ÈùûÊåáÈíàÂΩ¢Âºè‰Ωú‰∏∫ÁªìÊûÑ‰ΩìÁöÑÁªÑÊàêÂ≠óÊÆµÔºåÊàñËÄÖÊõ¥Â•ΩÁöÑÊñπÂºèÊòØÁõ¥Êé•ÂµåÂÖ•Âà∞ÁªìÊûÑ‰Ωì‰∏≠„ÄÇÂ¶ÇÊûúÊòØÁßÅÊúâÁªìÊûÑ‰ΩìÁ±ªÂûãÊàñÊòØË¶ÅÂÆûÁé∞ Mutex Êé•Âè£ÁöÑÁ±ªÂûãÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂµåÂÖ• mutex ÁöÑÊñπÊ≥ïÔºö 123456789101112131415161718type smap struct &#123; sync.Mutex // only for unexported typesÔºà‰ªÖÈÄÇÁî®‰∫éÈùûÂØºÂá∫Á±ªÂûãÔºâ data map[string]string&#125;func newSMap() *smap &#123; return &amp;smap&#123; data: make(map[string]string), &#125;&#125;func (m *smap) Get(k string) string &#123; m.Lock() defer m.Unlock() return m.data[k]&#125;123456789101112131415161718type SMap struct &#123; mu sync.Mutex // ÂØπ‰∫éÂØºÂá∫Á±ªÂûãÔºåËØ∑‰ΩøÁî®ÁßÅÊúâÈîÅ data map[string]string&#125;func NewSMap() *SMap &#123; return &amp;SMap&#123; data: make(map[string]string), &#125;&#125;func (m *SMap) Get(k string) string &#123; m.mu.Lock() defer m.mu.Unlock() return m.data[k]&#125;‰∏∫ÁßÅÊúâÁ±ªÂûãÊàñÈúÄË¶ÅÂÆûÁé∞‰∫íÊñ•Êé•Âè£ÁöÑÁ±ªÂûãÂµåÂÖ•„ÄÇÂØπ‰∫éÂØºÂá∫ÁöÑÁ±ªÂûãÔºåËØ∑‰ΩøÁî®‰∏ìÁî®Â≠óÊÆµ„ÄÇ Âú®ËæπÁïåÂ§ÑÊã∑Ë¥ù Slices Âíå Mapsslices Âíå maps ÂåÖÂê´‰∫ÜÊåáÂêëÂ∫ïÂ±ÇÊï∞ÊçÆÁöÑÊåáÈíàÔºåÂõ†Ê≠§Âú®ÈúÄË¶ÅÂ§çÂà∂ÂÆÉ‰ª¨Êó∂Ë¶ÅÁâπÂà´Ê≥®ÊÑè„ÄÇ Êé•Êî∂ Slices Âíå MapsËØ∑ËÆ∞‰ΩèÔºåÂΩì map Êàñ slice ‰Ωú‰∏∫ÂáΩÊï∞ÂèÇÊï∞‰º†ÂÖ•Êó∂ÔºåÂ¶ÇÊûúÊÇ®Â≠òÂÇ®‰∫ÜÂØπÂÆÉ‰ª¨ÁöÑÂºïÁî®ÔºåÂàôÁî®Êà∑ÂèØ‰ª•ÂØπÂÖ∂ËøõË°å‰øÆÊîπ„ÄÇ Bad Good123456789func (d *Driver) SetTrips(trips []Trip) &#123; d.trips = trips&#125;trips := ...d1.SetTrips(trips)// ‰Ω†ÊòØË¶Å‰øÆÊîπ d1.trips ÂêóÔºütrips[0] = ...12345678910func (d *Driver) SetTrips(trips []Trip) &#123; d.trips = make([]Trip, len(trips)) copy(d.trips, trips)&#125;trips := ...d1.SetTrips(trips)// ËøôÈáåÊàë‰ª¨‰øÆÊîπ trips[0]Ôºå‰ΩÜ‰∏ç‰ºöÂΩ±ÂìçÂà∞ d1.tripstrips[0] = ... ËøîÂõû slices Êàñ mapsÂêåÊ†∑ÔºåËØ∑Ê≥®ÊÑèÁî®Êà∑ÂØπÊö¥Èú≤ÂÜÖÈÉ®Áä∂ÊÄÅÁöÑ map Êàñ slice ÁöÑ‰øÆÊîπ„ÄÇ BadGood123456789101112131415161718type Stats struct &#123; mu sync.Mutex counters map[string]int&#125;// Snapshot ËøîÂõûÂΩìÂâçÁä∂ÊÄÅ„ÄÇfunc (s *Stats) Snapshot() map[string]int &#123; s.mu.Lock() defer s.mu.Unlock() return s.counters&#125;// snapshot ‰∏çÂÜçÂèó‰∫íÊñ•ÈîÅ‰øùÊä§// Âõ†Ê≠§ÂØπ snapshot ÁöÑ‰ªª‰ΩïËÆøÈóÆÈÉΩÂ∞ÜÂèóÂà∞Êï∞ÊçÆÁ´û‰∫âÁöÑÂΩ±Âìç// ÂΩ±Âìç stats.counterssnapshot := stats.Snapshot()12345678910111213141516171819type Stats struct &#123; mu sync.Mutex counters map[string]int&#125;func (s *Stats) Snapshot() map[string]int &#123; s.mu.Lock() defer s.mu.Unlock() result := make(map[string]int, len(s.counters)) for k, v := range s.counters &#123; result[k] = v &#125; return result&#125;// snapshot Áé∞Âú®ÊòØ‰∏Ä‰∏™Êã∑Ë¥ùsnapshot := stats.Snapshot() ‰ΩøÁî® defer ÈáäÊîæËµÑÊ∫ê‰ΩøÁî® defer ÈáäÊîæËµÑÊ∫êÔºåËØ∏Â¶ÇÊñá‰ª∂ÂíåÈîÅ„ÄÇ BadGood12345678910111213p.Lock()if p.count &lt; 10 &#123; p.Unlock() return p.count&#125;p.count++newCount := p.countp.Unlock()return newCount// ÂΩìÊúâÂ§ö‰∏™ return ÂàÜÊîØÊó∂ÔºåÂæàÂÆπÊòìÈÅóÂøò unlock1234567891011p.Lock()defer p.Unlock()if p.count &lt; 10 &#123; return p.count&#125;p.count++return p.count// Êõ¥ÂèØËØª Defer ÁöÑÂºÄÈîÄÈùûÂ∏∏Â∞èÔºåÂè™ÊúâÂú®ÊÇ®ÂèØ‰ª•ËØÅÊòéÂáΩÊï∞ÊâßË°åÊó∂Èó¥Â§Ñ‰∫éÁ∫≥ÁßíÁ∫ßÁöÑÁ®ãÂ∫¶Êó∂ÔºåÊâçÂ∫îÈÅøÂÖçËøôÊ†∑ÂÅö„ÄÇ‰ΩøÁî® defer ÊèêÂçáÂèØËØªÊÄßÊòØÂÄºÂæóÁöÑÔºåÂõ†‰∏∫‰ΩøÁî®ÂÆÉ‰ª¨ÁöÑÊàêÊú¨ÂæÆ‰∏çË∂≥ÈÅì„ÄÇÂ∞§ÂÖ∂ÈÄÇÁî®‰∫éÈÇ£‰∫õ‰∏ç‰ªÖ‰ªÖÊòØÁÆÄÂçïÂÜÖÂ≠òËÆøÈóÆÁöÑËæÉÂ§ßÁöÑÊñπÊ≥ïÔºåÂú®Ëøô‰∫õÊñπÊ≥ï‰∏≠ÂÖ∂‰ªñËÆ°ÁÆóÁöÑËµÑÊ∫êÊ∂àËÄóËøúË∂ÖËøá defer„ÄÇ Channel ÁöÑ size Ë¶Å‰πàÊòØ 1ÔºåË¶Å‰πàÊòØÊó†ÁºìÂÜ≤ÁöÑchannel ÈÄöÂ∏∏ size Â∫î‰∏∫ 1 ÊàñÊòØÊó†ÁºìÂÜ≤ÁöÑ„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåchannel ÊòØÊó†ÁºìÂÜ≤ÁöÑÔºåÂÖ∂ size ‰∏∫Èõ∂„ÄÇ‰ªª‰ΩïÂÖ∂‰ªñÂ∞∫ÂØ∏ÈÉΩÂøÖÈ°ªÁªèËøá‰∏•Ê†ºÁöÑÂÆ°Êü•„ÄÇÊàë‰ª¨ÈúÄË¶ÅËÄÉËôëÂ¶Ç‰ΩïÁ°ÆÂÆöÂ§ßÂ∞èÔºåËÄÉËôëÊòØ‰ªÄ‰πàÈòªÊ≠¢‰∫Ü channel Âú®È´òË¥üËΩΩ‰∏ãÂíåÈòªÂ°ûÂÜôÊó∂ÁöÑÂÜôÂÖ•Ôºå‰ª•ÂèäÂΩìËøôÁßçÊÉÖÂÜµÂèëÁîüÊó∂Á≥ªÁªüÈÄªËæëÊúâÂì™‰∫õÂèòÂåñ„ÄÇ(ÁøªËØëËß£ÈáäÔºöÊåâÁÖßÂéüÊñáÊÑèÊÄùÊòØÈúÄË¶ÅÁïåÂÆöÈÄöÈÅìËæπÁïåÔºåÁ´ûÊÄÅÊù°‰ª∂Ôºå‰ª•ÂèäÈÄªËæë‰∏ä‰∏ãÊñáÊ¢≥ÁêÜ) BadGood12// Â∫îËØ•Ë∂≥‰ª•Êª°Ë∂≥‰ªª‰ΩïÊÉÖÂÜµÔºÅc := make(chan int, 64)1234// Â§ßÂ∞èÔºö1c := make(chan int, 1) // ÊàñËÄÖ// Êó†ÁºìÂÜ≤ channelÔºåÂ§ßÂ∞è‰∏∫ 0c := make(chan int) Êûö‰∏æ‰ªé 1 ÂºÄÂßãÂú® Go ‰∏≠ÂºïÂÖ•Êûö‰∏æÁöÑÊ†áÂáÜÊñπÊ≥ïÊòØÂ£∞Êòé‰∏Ä‰∏™Ëá™ÂÆö‰πâÁ±ªÂûãÂíå‰∏Ä‰∏™‰ΩøÁî®‰∫Ü iota ÁöÑ const ÁªÑ„ÄÇÁî±‰∫éÂèòÈáèÁöÑÈªòËÆ§ÂÄº‰∏∫ 0ÔºåÂõ†Ê≠§ÈÄöÂ∏∏Â∫î‰ª•ÈùûÈõ∂ÂÄºÂºÄÂ§¥Êûö‰∏æ„ÄÇ BadGood123456789type Operation intconst ( Add Operation = iota Subtract Multiply)// Add=0, Subtract=1, Multiply=2123456789type Operation intconst ( Add Operation = iota + 1 Subtract Multiply)// Add=1, Subtract=2, Multiply=3 Âú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî®Èõ∂ÂÄºÊòØÊúâÊÑè‰πâÁöÑÔºàÊûö‰∏æ‰ªéÈõ∂ÂºÄÂßãÔºâÔºå‰æãÂ¶ÇÔºåÂΩìÈõ∂ÂÄºÊòØÁêÜÊÉ≥ÁöÑÈªòËÆ§Ë°å‰∏∫Êó∂„ÄÇ 123456789type LogOutput intconst ( LogToStdout LogOutput = iota LogToFile LogToRemote)// LogToStdout=0, LogToFile=1, LogToRemote=2 ‰ΩøÁî® time Â§ÑÁêÜÊó∂Èó¥Êó∂Èó¥Â§ÑÁêÜÂæàÂ§çÊùÇ„ÄÇÂÖ≥‰∫éÊó∂Èó¥ÁöÑÈîôËØØÂÅáËÆæÈÄöÂ∏∏ÂåÖÊã¨‰ª•‰∏ãÂá†ÁÇπ„ÄÇ ‰∏ÄÂ§©Êúâ 24 Â∞èÊó∂ ‰∏ÄÂ∞èÊó∂Êúâ 60 ÂàÜÈíü ‰∏ÄÂë®Êúâ‰∏ÉÂ§© ‰∏ÄÂπ¥ 365 Â§© ËøòÊúâÊõ¥Â§ö ‰æãÂ¶ÇÔºå1 Ë°®Á§∫Âú®‰∏Ä‰∏™Êó∂Èó¥ÁÇπ‰∏äÂä†‰∏ä 24 Â∞èÊó∂Âπ∂‰∏çÊÄªÊòØ‰∫ßÁîü‰∏Ä‰∏™Êñ∞ÁöÑÊó•ÂéÜÊó•„ÄÇ Âõ†Ê≠§ÔºåÂú®Â§ÑÁêÜÊó∂Èó¥Êó∂ÂßãÁªà‰ΩøÁî® &quot;time&quot; ÂåÖÔºåÂõ†‰∏∫ÂÆÉÊúâÂä©‰∫é‰ª•Êõ¥ÂÆâÂÖ®„ÄÅÊõ¥ÂáÜÁ°ÆÁöÑÊñπÂºèÂ§ÑÁêÜËøô‰∫õ‰∏çÊ≠£Á°ÆÁöÑÂÅáËÆæ„ÄÇ ‰ΩøÁî® time.Time Ë°®ËææÁû¨Êó∂Êó∂Èó¥Âú®Â§ÑÁêÜÊó∂Èó¥ÁöÑÁû¨Èó¥Êó∂‰ΩøÁî® time.timeÔºåÂú®ÊØîËæÉ„ÄÅÊ∑ªÂä†ÊàñÂáèÂéªÊó∂Èó¥Êó∂‰ΩøÁî® time.Time ‰∏≠ÁöÑÊñπÊ≥ï„ÄÇ BadGood123func isActive(now, start, stop int) bool &#123; return start &lt;= now &amp;&amp; now &lt; stop&#125;123func isActive(now, start, stop time.Time) bool &#123; return (start.Before(now) || start.Equal(now)) &amp;&amp; now.Before(stop)&#125; ‰ΩøÁî® time.Duration Ë°®ËææÊó∂Èó¥ÊÆµÂú®Â§ÑÁêÜÊó∂Èó¥ÊÆµÊó∂‰ΩøÁî® time.Duration . BadGood1234567func poll(delay int) &#123; for &#123; // ... time.Sleep(time.Duration(delay) * time.Millisecond) &#125;&#125;poll(10) // ÊòØÂá†ÁßíÈíüËøòÊòØÂá†ÊØ´Áßí?1234567func poll(delay time.Duration) &#123; for &#123; // ... time.Sleep(delay) &#125;&#125;poll(10*time.Second) ÂõûÂà∞Á¨¨‰∏Ä‰∏™‰æãÂ≠êÔºåÂú®‰∏Ä‰∏™Êó∂Èó¥Áû¨Èó¥Âä†‰∏ä 24 Â∞èÊó∂ÔºåÊàë‰ª¨Áî®‰∫éÊ∑ªÂä†Êó∂Èó¥ÁöÑÊñπÊ≥ïÂèñÂÜ≥‰∫éÊÑèÂõæ„ÄÇÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥Ë¶Å‰∏ã‰∏Ä‰∏™Êó•ÂéÜÊó•(ÂΩìÂâçÂ§©ÁöÑ‰∏ã‰∏ÄÂ§©)ÁöÑÂêå‰∏Ä‰∏™Êó∂Èó¥ÁÇπÔºåÊàë‰ª¨Â∫îËØ•‰ΩøÁî® Time.AddDate„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥‰øùËØÅÊüê‰∏ÄÊó∂ÂàªÊØîÂâç‰∏ÄÊó∂ÂàªÊôö 24 Â∞èÊó∂ÔºåÊàë‰ª¨Â∫îËØ•‰ΩøÁî® Time.Add„ÄÇ 12newDay := t.AddDate(0 /* years */, 0, /* months */, 1 /* days */)maybeNewDay := t.Add(24 * time.Hour) ÂØπÂ§ñÈÉ®Á≥ªÁªü‰ΩøÁî® time.Time Âíå time.DurationÂ∞ΩÂèØËÉΩÂú®‰∏éÂ§ñÈÉ®Á≥ªÁªüÁöÑ‰∫§‰∫í‰∏≠‰ΩøÁî® time.Duration Âíå time.Time ‰æãÂ¶Ç : Command-line Ê†áÂøó: flag ÈÄöËøá time.ParseDuration ÊîØÊåÅ time.Duration JSON: encoding/json ÈÄöËøáÂÖ∂ UnmarshalJSON method ÊñπÊ≥ïÊîØÊåÅÂ∞Ü time.Time ÁºñÁ†Å‰∏∫ RFC 3339 Â≠óÁ¨¶‰∏≤ SQL: database/sql ÊîØÊåÅÂ∞Ü DATETIME Êàñ TIMESTAMP ÂàóËΩ¨Êç¢‰∏∫ time.TimeÔºåÂ¶ÇÊûúÂ∫ïÂ±ÇÈ©±Âä®Á®ãÂ∫èÊîØÊåÅÂàôËøîÂõû YAML: gopkg.in/yaml.v2 ÊîØÊåÅÂ∞Ü time.Time ‰Ωú‰∏∫ RFC 3339 Â≠óÁ¨¶‰∏≤ÔºåÂπ∂ÈÄöËøá time.ParseDuration ÊîØÊåÅ time.Duration„ÄÇ ÂΩì‰∏çËÉΩÂú®Ëøô‰∫õ‰∫§‰∫í‰∏≠‰ΩøÁî® time.Duration Êó∂ÔºåËØ∑‰ΩøÁî® int Êàñ float64ÔºåÂπ∂Âú®Â≠óÊÆµÂêçÁß∞‰∏≠ÂåÖÂê´Âçï‰Ωç„ÄÇ ‰æãÂ¶ÇÔºåÁî±‰∫é encoding/json ‰∏çÊîØÊåÅ time.DurationÔºåÂõ†Ê≠§ËØ•Âçï‰ΩçÂåÖÂê´Âú®Â≠óÊÆµÁöÑÂêçÁß∞‰∏≠„ÄÇ BadGood1234// &#123;"interval": 2&#125;type Config struct &#123; Interval int `json:"interval"`&#125;1234// &#123;"intervalMillis": 2000&#125;type Config struct &#123; IntervalMillis int `json:"intervalMillis"`&#125; ÂΩìÂú®Ëøô‰∫õ‰∫§‰∫í‰∏≠‰∏çËÉΩ‰ΩøÁî® time.Time Êó∂ÔºåÈô§ÈùûËææÊàê‰∏ÄËá¥ÔºåÂê¶Âàô‰ΩøÁî® string Âíå RFC 3339 ‰∏≠ÂÆö‰πâÁöÑÊ†ºÂºèÊó∂Èó¥Êà≥„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåTime.UnmarshalText ‰ΩøÁî®Ê≠§Ê†ºÂºèÔºåÂπ∂ÂèØÈÄöËøá time.RFC3339 Âú® Time.Format Âíå time.Parse ‰∏≠‰ΩøÁî®„ÄÇ Â∞ΩÁÆ°ËøôÂú®ÂÆûË∑µ‰∏≠Âπ∂‰∏çÊàêÈóÆÈ¢òÔºå‰ΩÜËØ∑ËÆ∞‰ΩèÔºå&quot;time&quot; ÂåÖ‰∏çÊîØÊåÅËß£ÊûêÈó∞ÁßíÊó∂Èó¥Êà≥Ôºà8728ÔºâÔºå‰πü‰∏çÂú®ËÆ°ÁÆó‰∏≠ËÄÉËôëÈó∞ÁßíÔºà15190Ôºâ„ÄÇÂ¶ÇÊûúÊÇ®ÊØîËæÉ‰∏§‰∏™Êó∂Èó¥Áû¨Èó¥ÔºåÂàôÂ∑ÆÂºÇÂ∞Ü‰∏çÂåÖÊã¨Ëøô‰∏§‰∏™Áû¨Èó¥‰πãÈó¥ÂèØËÉΩÂèëÁîüÁöÑÈó∞Áßí„ÄÇ ÈîôËØØÁ±ªÂûãGo ‰∏≠ÊúâÂ§öÁßçÂ£∞ÊòéÈîôËØØÔºàError) ÁöÑÈÄâÈ°πÔºö errors.New ÂØπ‰∫éÁÆÄÂçïÈùôÊÄÅÂ≠óÁ¨¶‰∏≤ÁöÑÈîôËØØ fmt.Errorf Áî®‰∫éÊ†ºÂºèÂåñÁöÑÈîôËØØÂ≠óÁ¨¶‰∏≤ ÂÆûÁé∞ Error() ÊñπÊ≥ïÁöÑËá™ÂÆö‰πâÁ±ªÂûã Áî® &quot;pkg/errors&quot;.Wrap ÁöÑ Wrapped errors ËøîÂõûÈîôËØØÊó∂ÔºåËØ∑ËÄÉËôë‰ª•‰∏ãÂõ†Á¥†‰ª•Á°ÆÂÆöÊúÄ‰Ω≥ÈÄâÊã©Ôºö ËøôÊòØ‰∏Ä‰∏™‰∏çÈúÄË¶ÅÈ¢ùÂ§ñ‰ø°ÊÅØÁöÑÁÆÄÂçïÈîôËØØÂêóÔºüÂ¶ÇÊûúÊòØËøôÊ†∑Ôºåerrors.New Ë∂≥Â§ü‰∫Ü„ÄÇ ÂÆ¢Êà∑ÈúÄË¶ÅÊ£ÄÊµãÂπ∂Â§ÑÁêÜÊ≠§ÈîôËØØÂêóÔºüÂ¶ÇÊûúÊòØËøôÊ†∑ÔºåÂàôÂ∫î‰ΩøÁî®Ëá™ÂÆö‰πâÁ±ªÂûãÂπ∂ÂÆûÁé∞ËØ• Error() ÊñπÊ≥ï„ÄÇ ÊÇ®ÊòØÂê¶Ê≠£Âú®‰º†Êí≠‰∏ãÊ∏∏ÂáΩÊï∞ËøîÂõûÁöÑÈîôËØØÔºüÂ¶ÇÊûúÊòØËøôÊ†∑ÔºåËØ∑Êü•ÁúãÊú¨ÊñáÂêéÈù¢ÊúâÂÖ≥ÈîôËØØÂåÖË£Ö section on error wrapping) ÈÉ®ÂàÜÁöÑÂÜÖÂÆπ„ÄÇ Âê¶Âàô fmt.Errorf Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ Â¶ÇÊûúÂÆ¢Êà∑Á´ØÈúÄË¶ÅÊ£ÄÊµãÈîôËØØÔºåÂπ∂‰∏îÊÇ®Â∑≤‰ΩøÁî®ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑÈîôËØØ errors.NewÔºåËØ∑‰ΩøÁî®‰∏Ä‰∏™ÈîôËØØÂèòÈáè„ÄÇ BadGood1234567891011121314151617// package foofunc Open() error &#123; return errors.New("could not open")&#125;// package barfunc use() &#123; if err := foo.Open(); err != nil &#123; if err.Error() == "could not open" &#123; // handle &#125; else &#123; panic("unknown error") &#125; &#125;&#125;1234567891011121314151617// package foovar ErrCouldNotOpen = errors.New("could not open")func Open() error &#123; return ErrCouldNotOpen&#125;// package barif err := foo.Open(); err != nil &#123; if err == foo.ErrCouldNotOpen &#123; // handle &#125; else &#123; panic("unknown error") &#125;&#125; Â¶ÇÊûúÊÇ®ÊúâÂèØËÉΩÈúÄË¶ÅÂÆ¢Êà∑Á´ØÊ£ÄÊµãÁöÑÈîôËØØÔºåÂπ∂‰∏îÊÉ≥ÂêëÂÖ∂‰∏≠Ê∑ªÂä†Êõ¥Â§ö‰ø°ÊÅØÔºà‰æãÂ¶ÇÔºåÂÆÉ‰∏çÊòØÈùôÊÄÅÂ≠óÁ¨¶‰∏≤ÔºâÔºåÂàôÂ∫î‰ΩøÁî®Ëá™ÂÆö‰πâÁ±ªÂûã„ÄÇ BadGood12345678910111213func open(file string) error &#123; return fmt.Errorf("file %q not found", file)&#125;func use() &#123; if err := open("testfile.txt"); err != nil &#123; if strings.Contains(err.Error(), "not found") &#123; // handle &#125; else &#123; panic("unknown error") &#125; &#125;&#125;123456789101112131415161718192021type errNotFound struct &#123; file string&#125;func (e errNotFound) Error() string &#123; return fmt.Sprintf("file %q not found", e.file)&#125;func open(file string) error &#123; return errNotFound&#123;file: file&#125;&#125;func use() &#123; if err := open("testfile.txt"); err != nil &#123; if _, ok := err.(errNotFound); ok &#123; // handle &#125; else &#123; panic("unknown error") &#125; &#125;&#125; Áõ¥Êé•ÂØºÂá∫Ëá™ÂÆö‰πâÈîôËØØÁ±ªÂûãÊó∂Ë¶ÅÂ∞èÂøÉÔºåÂõ†‰∏∫ÂÆÉ‰ª¨Â∑≤Êàê‰∏∫Á®ãÂ∫èÂåÖÂÖ¨ÂÖ± API ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÊúÄÂ•ΩÂÖ¨ÂºÄÂåπÈÖçÂô®ÂäüËÉΩ‰ª•Ê£ÄÊü•ÈîôËØØ„ÄÇ 12345678910111213141516171819202122232425262728// package footype errNotFound struct &#123; file string&#125;func (e errNotFound) Error() string &#123; return fmt.Sprintf("file %q not found", e.file)&#125;func IsNotFoundError(err error) bool &#123; _, ok := err.(errNotFound) return ok&#125;func Open(file string) error &#123; return errNotFound&#123;file: file&#125;&#125;// package barif err := foo.Open("foo"); err != nil &#123; if foo.IsNotFoundError(err) &#123; // handle &#125; else &#123; panic("unknown error") &#125;&#125; ÈîôËØØÂåÖË£Ö (Error Wrapping)‰∏Ä‰∏™ÔºàÂáΩÊï∞/ÊñπÊ≥ïÔºâË∞ÉÁî®Â§±Ë¥•Êó∂ÔºåÊúâ‰∏âÁßç‰∏ªË¶ÅÁöÑÈîôËØØ‰º†Êí≠ÊñπÂºèÔºö Â¶ÇÊûúÊ≤°ÊúâË¶ÅÊ∑ªÂä†ÁöÑÂÖ∂‰ªñ‰∏ä‰∏ãÊñáÔºåÂπ∂‰∏îÊÇ®ÊÉ≥Ë¶ÅÁª¥Êä§ÂéüÂßãÈîôËØØÁ±ªÂûãÔºåÂàôËøîÂõûÂéüÂßãÈîôËØØ„ÄÇ Ê∑ªÂä†‰∏ä‰∏ãÊñáÔºå‰ΩøÁî® &quot;pkg/errors&quot;.Wrap ‰ª•‰æøÈîôËØØÊ∂àÊÅØÊèê‰æõÊõ¥Â§ö‰∏ä‰∏ãÊñá ,&quot;pkg/errors&quot;.Cause ÂèØÁî®‰∫éÊèêÂèñÂéüÂßãÈîôËØØ„ÄÇ Â¶ÇÊûúË∞ÉÁî®ËÄÖ‰∏çÈúÄË¶ÅÊ£ÄÊµãÊàñÂ§ÑÁêÜÁöÑÁâπÂÆöÈîôËØØÊÉÖÂÜµÔºå‰ΩøÁî® fmt.Errorf„ÄÇ Âª∫ËÆÆÂú®ÂèØËÉΩÁöÑÂú∞ÊñπÊ∑ªÂä†‰∏ä‰∏ãÊñáÔºå‰ª•‰ΩøÊÇ®Ëé∑ÂæóËØ∏Â¶Ç‚ÄúË∞ÉÁî®ÊúçÂä° fooÔºöËøûÊé•Ë¢´ÊãíÁªù‚Äù‰πãÁ±ªÁöÑÊõ¥ÊúâÁî®ÁöÑÈîôËØØÔºåËÄå‰∏çÊòØËØ∏Â¶Ç‚ÄúËøûÊé•Ë¢´ÊãíÁªù‚Äù‰πãÁ±ªÁöÑÊ®°Á≥äÈîôËØØ„ÄÇ Âú®Â∞Ü‰∏ä‰∏ãÊñáÊ∑ªÂä†Âà∞ËøîÂõûÁöÑÈîôËØØÊó∂ÔºåËØ∑ÈÅøÂÖç‰ΩøÁî®‚Äúfailed to‚Äù‰πãÁ±ªÁöÑÁü≠ËØ≠‰ª•‰øùÊåÅ‰∏ä‰∏ãÊñáÁÆÄÊ¥ÅÔºåËøô‰∫õÁü≠ËØ≠‰ºöÈôàËø∞ÊòéÊòæÁöÑÂÜÖÂÆπÔºåÂπ∂ÈöèÁùÄÈîôËØØÂú®Â†ÜÊ†à‰∏≠ÁöÑÊ∏óÈÄèËÄåÈÄêÊ∏êÂ†ÜÁßØÔºö BadGood12345s, err := store.New()if err != nil &#123; return fmt.Errorf( "failed to create new store: %s", err)&#125;12345s, err := store.New()if err != nil &#123; return fmt.Errorf( "new store: %s", err)&#125;1failed to x: failed to y: failed to create new store: the error1x: y: new store: the error ‰ΩÜÊòØÔºå‰∏ÄÊó¶Â∞ÜÈîôËØØÂèëÈÄÅÂà∞Âè¶‰∏Ä‰∏™Á≥ªÁªüÔºåÂ∞±Â∫îËØ•ÊòéÁ°ÆÊ∂àÊÅØÊòØÈîôËØØÊ∂àÊÅØÔºà‰æãÂ¶Ç‰ΩøÁî®errÊ†áËÆ∞ÔºåÊàñÂú®Êó•Âøó‰∏≠‰ª•‚ÄùFailed‚Äù‰∏∫ÂâçÁºÄÔºâ„ÄÇ Âè¶ËØ∑ÂèÇËßÅ Don‚Äôt just check errors, handle them gracefully. ‰∏çË¶ÅÂè™ÊòØÊ£ÄÊü•ÈîôËØØÔºåË¶Å‰ºòÈõÖÂú∞Â§ÑÁêÜÈîôËØØ Â§ÑÁêÜÁ±ªÂûãÊñ≠Ë®ÄÂ§±Ë¥•type assertion ÁöÑÂçï‰∏™ËøîÂõûÂÄºÂΩ¢ÂºèÈíàÂØπ‰∏çÊ≠£Á°ÆÁöÑÁ±ªÂûãÂ∞Ü‰∫ßÁîü panic„ÄÇÂõ†Ê≠§ÔºåËØ∑ÂßãÁªà‰ΩøÁî®‚Äúcomma ok‚ÄùÁöÑÊÉØÁî®Ê≥ï„ÄÇ BadGood1t := i.(string)1234t, ok := i.(string)if !ok &#123; // ‰ºòÈõÖÂú∞Â§ÑÁêÜÈîôËØØ&#125; ‰∏çË¶Å panicÂú®Áîü‰∫ßÁéØÂ¢É‰∏≠ËøêË°åÁöÑ‰ª£Á†ÅÂøÖÈ°ªÈÅøÂÖçÂá∫Áé∞ panic„ÄÇpanic ÊòØ cascading failures Á∫ßËÅîÂ§±Ë¥•ÁöÑ‰∏ªË¶ÅÊ†πÊ∫ê „ÄÇÂ¶ÇÊûúÂèëÁîüÈîôËØØÔºåËØ•ÂáΩÊï∞ÂøÖÈ°ªËøîÂõûÈîôËØØÔºåÂπ∂ÂÖÅËÆ∏Ë∞ÉÁî®ÊñπÂÜ≥ÂÆöÂ¶Ç‰ΩïÂ§ÑÁêÜÂÆÉ„ÄÇ BadGood1234567891011121314func foo(bar string) &#123; if len(bar) == 0 &#123; panic("bar must not be empty") &#125; // ...&#125;func main() &#123; if len(os.Args) != 2 &#123; fmt.Println("USAGE: foo &lt;bar&gt;") os.Exit(1) &#125; foo(os.Args[1])&#125;1234567891011121314151617func foo(bar string) error &#123; if len(bar) == 0 &#123; return errors.New("bar must not be empty") &#125; // ... return nil&#125;func main() &#123; if len(os.Args) != 2 &#123; fmt.Println("USAGE: foo &lt;bar&gt;") os.Exit(1) &#125; if err := foo(os.Args[1]); err != nil &#123; panic(err) &#125;&#125; panic/recover ‰∏çÊòØÈîôËØØÂ§ÑÁêÜÁ≠ñÁï•„ÄÇ‰ªÖÂΩìÂèëÁîü‰∏çÂèØÊÅ¢Â§çÁöÑ‰∫ãÊÉÖÔºà‰æãÂ¶ÇÔºönil ÂºïÁî®ÔºâÊó∂ÔºåÁ®ãÂ∫èÊâçÂøÖÈ°ª panic„ÄÇÁ®ãÂ∫èÂàùÂßãÂåñÊòØ‰∏Ä‰∏™‰æãÂ§ñÔºöÁ®ãÂ∫èÂêØÂä®Êó∂Â∫î‰ΩøÁ®ãÂ∫è‰∏≠Ê≠¢ÁöÑ‰∏çËâØÊÉÖÂÜµÂèØËÉΩ‰ºöÂºïËµ∑ panic„ÄÇ 1var _statusTemplate = template.Must(template.New("name").Parse("_statusHTML")) Âç≥‰ΩøÂú®ÊµãËØï‰ª£Á†Å‰∏≠Ôºå‰πü‰ºòÂÖà‰ΩøÁî®t.FatalÊàñËÄÖt.FailNowËÄå‰∏çÊòØ panic Êù•Á°Æ‰øùÂ§±Ë¥•Ë¢´Ê†áËÆ∞„ÄÇ BadGood123456// func TestFoo(t *testing.T)f, err := ioutil.TempFile("", "test")if err != nil &#123; panic("failed to set up test")&#125;123456// func TestFoo(t *testing.T)f, err := ioutil.TempFile("", "test")if err != nil &#123; t.Fatal("failed to set up test")&#125; ‰ΩøÁî® go.uber.org/atomic‰ΩøÁî® sync/atomic ÂåÖÁöÑÂéüÂ≠êÊìç‰ΩúÂØπÂéüÂßãÁ±ªÂûã (int32, int64Á≠âÔºâËøõË°åÊìç‰ΩúÔºåÂõ†‰∏∫ÂæàÂÆπÊòìÂøòËÆ∞‰ΩøÁî®ÂéüÂ≠êÊìç‰ΩúÊù•ËØªÂèñÊàñ‰øÆÊîπÂèòÈáè„ÄÇ go.uber.org/atomic ÈÄöËøáÈöêËóèÂü∫Á°ÄÁ±ªÂûã‰∏∫Ëøô‰∫õÊìç‰ΩúÂ¢ûÂä†‰∫ÜÁ±ªÂûãÂÆâÂÖ®ÊÄß„ÄÇÊ≠§Â§ñÔºåÂÆÉÂåÖÊã¨‰∏Ä‰∏™Êñπ‰æøÁöÑatomic.BoolÁ±ªÂûã„ÄÇ BadGood123456789101112131415type foo struct &#123; running int32 // atomic&#125;func (f* foo) start() &#123; if atomic.SwapInt32(&amp;f.running, 1) == 1 &#123; // already running‚Ä¶ return &#125; // start the Foo&#125;func (f *foo) isRunning() bool &#123; return f.running == 1 // race!&#125;123456789101112131415type foo struct &#123; running atomic.Bool&#125;func (f *foo) start() &#123; if f.running.Swap(true) &#123; // already running‚Ä¶ return &#125; // start the Foo&#125;func (f *foo) isRunning() bool &#123; return f.running.Load()&#125; ÈÅøÂÖçÂèØÂèòÂÖ®Â±ÄÂèòÈáè‰ΩøÁî®ÈÄâÊã©‰æùËµñÊ≥®ÂÖ•ÊñπÂºèÈÅøÂÖçÊîπÂèòÂÖ®Â±ÄÂèòÈáè„ÄÇÊó¢ÈÄÇÁî®‰∫éÂáΩÊï∞ÊåáÈíàÂèàÈÄÇÁî®‰∫éÂÖ∂‰ªñÂÄºÁ±ªÂûã BadGood123456// sign.govar _timeNow = time.Nowfunc sign(msg string) string &#123; now := _timeNow() return signWithTime(msg, now)&#125;12345678910111213// sign.gotype signer struct &#123; now func() time.Time&#125;func newSigner() *signer &#123; return &amp;signer&#123; now: time.Now, &#125;&#125;func (s *signer) Sign(msg string) string &#123; now := s.now() return signWithTime(msg, now)&#125;123456789// sign_test.gofunc TestSign(t *testing.T) &#123; oldTimeNow := _timeNow _timeNow = func() time.Time &#123; return someFixedTime &#125; defer func() &#123; _timeNow = oldTimeNow &#125;() assert.Equal(t, want, sign(give))&#125;12345678// sign_test.gofunc TestSigner(t *testing.T) &#123; s := newSigner() s.now = func() time.Time &#123; return someFixedTime &#125; assert.Equal(t, want, s.Sign(give))&#125; ÈÅøÂÖçÂú®ÂÖ¨ÂÖ±ÁªìÊûÑ‰∏≠ÂµåÂÖ•Á±ªÂûãËøô‰∫õÂµåÂÖ•ÁöÑÁ±ªÂûãÊ≥ÑÊºèÂÆûÁé∞ÁªÜËäÇ„ÄÅÁ¶ÅÊ≠¢Á±ªÂûãÊºîÂåñÂíåÊ®°Á≥äÁöÑÊñáÊ°£„ÄÇ ÂÅáËÆæÊÇ®‰ΩøÁî®ÂÖ±‰∫´ÁöÑ AbstractList ÂÆûÁé∞‰∫ÜÂ§öÁßçÂàóË°®Á±ªÂûãÔºåËØ∑ÈÅøÂÖçÂú®ÂÖ∑‰ΩìÁöÑÂàóË°®ÂÆûÁé∞‰∏≠ÂµåÂÖ• AbstractList„ÄÇÁõ∏ÂèçÔºåÂè™ÈúÄÊâãÂä®Â∞ÜÊñπÊ≥ïÂÜôÂÖ•ÂÖ∑‰ΩìÁöÑÂàóË°®ÔºåËØ•ÂàóË°®Â∞ÜÂßîÊâòÁªôÊäΩË±°ÂàóË°®„ÄÇ 123456789type AbstractList struct &#123;&#125;// Ê∑ªÂä†Â∞ÜÂÆû‰ΩìÊ∑ªÂä†Âà∞ÂàóË°®‰∏≠„ÄÇfunc (l *AbstractList) Add(e Entity) &#123; // ...&#125;// ÁßªÈô§‰ªéÂàóË°®‰∏≠ÁßªÈô§ÂÆû‰Ωì„ÄÇfunc (l *AbstractList) Remove(e Entity) &#123; // ...&#125; BadGood1234// ConcreteList ÊòØ‰∏Ä‰∏™ÂÆû‰ΩìÂàóË°®„ÄÇtype ConcreteList struct &#123; *AbstractList&#125;123456789101112// ConcreteList ÊòØ‰∏Ä‰∏™ÂÆû‰ΩìÂàóË°®„ÄÇtype ConcreteList struct &#123; list *AbstractList&#125;// Ê∑ªÂä†Â∞ÜÂÆû‰ΩìÊ∑ªÂä†Âà∞ÂàóË°®‰∏≠„ÄÇfunc (l *ConcreteList) Add(e Entity) &#123; return l.list.Add(e)&#125;// ÁßªÈô§‰ªéÂàóË°®‰∏≠ÁßªÈô§ÂÆû‰Ωì„ÄÇfunc (l *ConcreteList) Remove(e Entity) &#123; return l.list.Remove(e)&#125; Go ÂÖÅËÆ∏ Á±ªÂûãÂµåÂÖ• ‰Ωú‰∏∫ÁªßÊâøÂíåÁªÑÂêà‰πãÈó¥ÁöÑÊäòË°∑„ÄÇÂ§ñÈÉ®Á±ªÂûãËé∑ÂèñÂµåÂÖ•Á±ªÂûãÁöÑÊñπÊ≥ïÁöÑÈöêÂºèÂâØÊú¨„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËøô‰∫õÊñπÊ≥ïÂßîÊâòÁªôÂµåÂÖ•ÂÆû‰æãÁöÑÂêå‰∏ÄÊñπÊ≥ï„ÄÇ ÁªìÊûÑËøòËé∑Âæó‰∏éÁ±ªÂûãÂêåÂêçÁöÑÂ≠óÊÆµ„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûúÂµåÂÖ•ÁöÑÁ±ªÂûãÊòØ publicÔºåÈÇ£‰πàÂ≠óÊÆµÊòØ public„ÄÇ‰∏∫‰∫Ü‰øùÊåÅÂêëÂêéÂÖºÂÆπÊÄßÔºåÂ§ñÈÉ®Á±ªÂûãÁöÑÊØè‰∏™Êú™Êù•ÁâàÊú¨ÈÉΩÂøÖÈ°ª‰øùÁïôÂµåÂÖ•Á±ªÂûã„ÄÇ ÂæàÂ∞ëÈúÄË¶ÅÂµåÂÖ•Á±ªÂûã„ÄÇËøôÊòØ‰∏ÄÁßçÊñπ‰æøÔºåÂèØ‰ª•Â∏ÆÂä©ÊÇ®ÈÅøÂÖçÁºñÂÜôÂÜóÈïøÁöÑÂßîÊâòÊñπÊ≥ï„ÄÇ Âç≥‰ΩøÂµåÂÖ•ÂÖºÂÆπÁöÑÊäΩË±°ÂàóË°® interfaceÔºåËÄå‰∏çÊòØÁªìÊûÑ‰ΩìÔºåËøôÂ∞Ü‰∏∫ÂºÄÂèë‰∫∫ÂëòÊèê‰æõÊõ¥Â§ßÁöÑÁÅµÊ¥ªÊÄßÊù•ÊîπÂèòÊú™Êù•Ôºå‰ΩÜ‰ªçÁÑ∂Ê≥ÑÈú≤‰∫ÜÂÖ∑‰ΩìÂàóË°®‰ΩøÁî®ÊäΩË±°ÂÆûÁé∞ÁöÑÁªÜËäÇ„ÄÇ BadGood123456789// AbstractList ÊòØÂêÑÁßçÂÆû‰ΩìÂàóË°®ÁöÑÈÄöÁî®ÂÆûÁé∞„ÄÇtype AbstractList interface &#123; Add(Entity) Remove(Entity)&#125;// ConcreteList ÊòØ‰∏Ä‰∏™ÂÆû‰ΩìÂàóË°®„ÄÇtype ConcreteList struct &#123; AbstractList&#125;123456789101112// ConcreteList ÊòØ‰∏Ä‰∏™ÂÆû‰ΩìÂàóË°®„ÄÇtype ConcreteList struct &#123; list *AbstractList&#125;// Ê∑ªÂä†Â∞ÜÂÆû‰ΩìÊ∑ªÂä†Âà∞ÂàóË°®‰∏≠„ÄÇfunc (l *ConcreteList) Add(e Entity) &#123; return l.list.Add(e)&#125;// ÁßªÈô§‰ªéÂàóË°®‰∏≠ÁßªÈô§ÂÆû‰Ωì„ÄÇfunc (l *ConcreteList) Remove(e Entity) &#123; return l.list.Remove(e)&#125; Êó†ËÆ∫ÊòØ‰ΩøÁî®ÂµåÂÖ•ÂºèÁªìÊûÑËøòÊòØ‰ΩøÁî®ÂµåÂÖ•ÂºèÊé•Âè£ÔºåÂµåÂÖ•ÂºèÁ±ªÂûãÈÉΩ‰ºöÈôêÂà∂Á±ªÂûãÁöÑÊºîÂåñ. ÂêëÂµåÂÖ•ÂºèÊé•Âè£Ê∑ªÂä†ÊñπÊ≥ïÊòØ‰∏Ä‰∏™Á†¥ÂùèÊÄßÁöÑÊîπÂèò„ÄÇ Âà†Èô§ÂµåÂÖ•Á±ªÂûãÊòØ‰∏Ä‰∏™Á†¥ÂùèÊÄßÁöÑÊîπÂèò„ÄÇ Âç≥‰Ωø‰ΩøÁî®Êª°Ë∂≥Áõ∏ÂêåÊé•Âè£ÁöÑÊõø‰ª£ÊñπÊ≥ïÊõøÊç¢ÂµåÂÖ•Á±ªÂûãÔºå‰πüÊòØ‰∏Ä‰∏™Á†¥ÂùèÊÄßÁöÑÊîπÂèò„ÄÇ Â∞ΩÁÆ°ÁºñÂÜôËøô‰∫õÂßîÊâòÊñπÊ≥ïÊòØ‰πèÂë≥ÁöÑÔºå‰ΩÜÊòØÈ¢ùÂ§ñÁöÑÂ∑•‰ΩúÈöêËóè‰∫ÜÂÆûÁé∞ÁªÜËäÇÔºåÁïô‰∏ã‰∫ÜÊõ¥Â§öÁöÑÊõ¥ÊîπÊú∫‰ºöÔºåËøòÊ∂àÈô§‰∫ÜÂú®ÊñáÊ°£‰∏≠ÂèëÁé∞ÂÆåÊï¥ÂàóË°®Êé•Âè£ÁöÑÈó¥Êé•ÊÄßÊìç‰Ωú„ÄÇ ÈÅøÂÖç‰ΩøÁî®ÂÜÖÁΩÆÂêçÁß∞GoËØ≠Ë®ÄËßÑËåÉlanguage specification Ê¶ÇËø∞‰∫ÜÂá†‰∏™ÂÜÖÁΩÆÁöÑÔºå‰∏çÂ∫îÂú®GoÈ°πÁõÆ‰∏≠‰ΩøÁî®ÁöÑÂêçÁß∞Ê†áËØÜpredeclared identifiers„ÄÇ Ê†πÊçÆ‰∏ä‰∏ãÊñáÁöÑ‰∏çÂêåÔºåÂ∞ÜËøô‰∫õÊ†áËØÜÁ¨¶‰Ωú‰∏∫ÂêçÁß∞ÈáçÂ§ç‰ΩøÁî®ÔºåÂ∞ÜÂú®ÂΩìÂâç‰ΩúÁî®ÂüüÔºàÊàñ‰ªª‰ΩïÂµåÂ•ó‰ΩúÁî®ÂüüÔºâ‰∏≠ÈöêËóèÂéüÂßãÊ†áËØÜÁ¨¶ÔºåÊàñËÄÖÊ∑∑Ê∑Ü‰ª£Á†Å„ÄÇÂú®ÊúÄÂ•ΩÁöÑÊÉÖÂÜµ‰∏ãÔºåÁºñËØëÂô®‰ºöÊä•ÈîôÔºõÂú®ÊúÄÂùèÁöÑÊÉÖÂÜµ‰∏ãÔºåËøôÊ†∑ÁöÑ‰ª£Á†ÅÂèØËÉΩ‰ºöÂºïÂÖ•ÊΩúÂú®ÁöÑ„ÄÅÈöæ‰ª•ÊÅ¢Â§çÁöÑÈîôËØØ„ÄÇ BadGood12345678var error string// `error` ‰ΩúÁî®ÂüüÈöêÂºèË¶ÜÁõñ// orfunc handleErrorMessage(error string) &#123; // `error` ‰ΩúÁî®ÂüüÈöêÂºèË¶ÜÁõñ&#125;12345678var errorMessage string// `error` ÊåáÂêëÂÜÖÁΩÆÁöÑÈùûË¶ÜÁõñ// orfunc handleErrorMessage(msg string) &#123; // `error` ÊåáÂêëÂÜÖÁΩÆÁöÑÈùûË¶ÜÁõñ&#125;123456789101112131415type Foo struct &#123; // ËôΩÁÑ∂Ëøô‰∫õÂ≠óÊÆµÂú®ÊäÄÊúØ‰∏ä‰∏çÊûÑÊàêÈò¥ÂΩ±Ôºå‰ΩÜ`error`Êàñ`string`Â≠óÁ¨¶‰∏≤ÁöÑÈáçÊò†Â∞ÑÁé∞Âú®ÊòØ‰∏çÊòéÁ°ÆÁöÑ„ÄÇ error error string string&#125;func (f Foo) Error() error &#123; // `error` Âíå `f.error` Âú®ËßÜËßâ‰∏äÊòØÁõ∏‰ººÁöÑ return f.error&#125;func (f Foo) String() string &#123; // `string` and `f.string` Âú®ËßÜËßâ‰∏äÊòØÁõ∏‰ººÁöÑ return f.string&#125;12345678910111213type Foo struct &#123; // `error` and `string` Áé∞Âú®ÊòØÊòéÁ°ÆÁöÑ„ÄÇ err error str string&#125;func (f Foo) Error() error &#123; return f.err&#125;func (f Foo) String() string &#123; return f.str&#125; Ê≥®ÊÑèÔºåÁºñËØëÂô®Âú®‰ΩøÁî®È¢ÑÂÖàÂàÜÈöîÁöÑÊ†áËØÜÁ¨¶Êó∂‰∏ç‰ºöÁîüÊàêÈîôËØØÔºå‰ΩÜÊòØËØ∏Â¶Çgo vet‰πãÁ±ªÁöÑÂ∑•ÂÖ∑‰ºöÊ≠£Á°ÆÂú∞ÊåáÂá∫Ëøô‰∫õÂíåÂÖ∂‰ªñÊÉÖÂÜµ‰∏ãÁöÑÈöêÂºèÈóÆÈ¢ò„ÄÇ ÊÄßËÉΩÊÄßËÉΩÊñπÈù¢ÁöÑÁâπÂÆöÂáÜÂàôÂè™ÈÄÇÁî®‰∫éÈ´òÈ¢ëÂú∫ÊôØ„ÄÇ ‰ºòÂÖà‰ΩøÁî® strconv ËÄå‰∏çÊòØ fmtÂ∞ÜÂéüËØ≠ËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤Êàñ‰ªéÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢Êó∂ÔºåstrconvÈÄüÂ∫¶ÊØîfmtÂø´„ÄÇ BadGood123for i := 0; i &lt; b.N; i++ &#123; s := fmt.Sprint(rand.Int())&#125;123for i := 0; i &lt; b.N; i++ &#123; s := strconv.Itoa(rand.Int())&#125;1BenchmarkFmtSprint-4 143 ns/op 2 allocs/op1BenchmarkStrconv-4 64.2 ns/op 1 allocs/op ÈÅøÂÖçÂ≠óÁ¨¶‰∏≤Âà∞Â≠óËäÇÁöÑËΩ¨Êç¢‰∏çË¶ÅÂèçÂ§ç‰ªéÂõ∫ÂÆöÂ≠óÁ¨¶‰∏≤ÂàõÂª∫Â≠óËäÇ slice„ÄÇÁõ∏ÂèçÔºåËØ∑ÊâßË°å‰∏ÄÊ¨°ËΩ¨Êç¢Âπ∂ÊçïËé∑ÁªìÊûú„ÄÇ BadGood123for i := 0; i &lt; b.N; i++ &#123; w.Write([]byte("Hello world"))&#125;1234data := []byte("Hello world")for i := 0; i &lt; b.N; i++ &#123; w.Write(data)&#125;1BenchmarkBad-4 50000000 22.2 ns/op1BenchmarkGood-4 500000000 3.25 ns/op Â∞ΩÈáèÂàùÂßãÂåñÊó∂ÊåáÂÆö Map ÂÆπÈáèÂú®Â∞ΩÂèØËÉΩÁöÑÊÉÖÂÜµ‰∏ãÔºåÂú®‰ΩøÁî® make() ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÊèê‰æõÂÆπÈáè‰ø°ÊÅØ 1make(map[T1]T2, hint) ‰∏∫ make() Êèê‰æõÂÆπÈáè‰ø°ÊÅØÔºàhintÔºâÂ∞ùËØïÂú®ÂàùÂßãÂåñÊó∂Ë∞ÉÊï¥ map Â§ßÂ∞èÔºåËøôÂáèÂ∞ë‰∫ÜÂú®Â∞ÜÂÖÉÁ¥†Ê∑ªÂä†Âà∞ map Êó∂Â¢ûÈïøÂíåÂàÜÈÖçÁöÑÂºÄÈîÄ„ÄÇÊ≥®ÊÑèÔºåmap ‰∏çËÉΩ‰øùËØÅÂàÜÈÖç hint ‰∏™ÂÆπÈáè„ÄÇÂõ†Ê≠§ÔºåÂç≥‰ΩøÊèê‰æõ‰∫ÜÂÆπÈáèÔºåÊ∑ªÂä†ÂÖÉÁ¥†‰ªçÁÑ∂ÂèØ‰ª•ËøõË°åÂàÜÈÖç„ÄÇ BadGood123456m := make(map[string]os.FileInfo)files, _ := ioutil.ReadDir("./files")for _, f := range files &#123; m[f.Name()] = f&#125;1234567files, _ := ioutil.ReadDir("./files")m := make(map[string]os.FileInfo, len(files))for _, f := range files &#123; m[f.Name()] = f&#125;m ÊòØÂú®Ê≤°ÊúâÂ§ßÂ∞èÊèêÁ§∫ÁöÑÊÉÖÂÜµ‰∏ãÂàõÂª∫ÁöÑÔºõ Âú®ËøêË°åÊó∂ÂèØËÉΩ‰ºöÊúâÊõ¥Â§öÂàÜÈÖç„ÄÇm ÊòØÊúâÂ§ßÂ∞èÊèêÁ§∫ÂàõÂª∫ÁöÑÔºõÂú®ËøêË°åÊó∂ÂèØËÉΩ‰ºöÊúâÊõ¥Â∞ëÁöÑÂàÜÈÖç„ÄÇ ËßÑËåÉ‰∏ÄËá¥ÊÄßÊú¨Êñá‰∏≠Ê¶ÇËø∞ÁöÑ‰∏Ä‰∫õÊ†áÂáÜÈÉΩÊòØÂÆ¢ËßÇÊÄßÁöÑËØÑ‰º∞ÔºåÊòØÊ†πÊçÆÂú∫ÊôØ„ÄÅ‰∏ä‰∏ãÊñá„ÄÅÊàñËÄÖ‰∏ªËßÇÊÄßÁöÑÂà§Êñ≠Ôºõ ‰ΩÜÊòØÊúÄÈáçË¶ÅÁöÑÊòØÔºå‰øùÊåÅ‰∏ÄËá¥. ‰∏ÄËá¥ÊÄßÁöÑ‰ª£Á†ÅÊõ¥ÂÆπÊòìÁª¥Êä§„ÄÅÊòØÊõ¥ÂêàÁêÜÁöÑ„ÄÅÈúÄË¶ÅÊõ¥Â∞ëÁöÑÂ≠¶‰π†ÊàêÊú¨„ÄÅÂπ∂‰∏îÈöèÁùÄÊñ∞ÁöÑÁ∫¶ÂÆöÂá∫Áé∞ÊàñËÄÖÂá∫Áé∞ÈîôËØØÂêéÊõ¥ÂÆπÊòìËøÅÁßª„ÄÅÊõ¥Êñ∞„ÄÅ‰øÆÂ§ç bug Áõ∏ÂèçÔºå‰∏Ä‰∏™Âçï‰∏ÄÁöÑ‰ª£Á†ÅÂ∫ì‰ºöÂØºËá¥Áª¥Êä§ÊàêÊú¨ÂºÄÈîÄ„ÄÅ‰∏çÁ°ÆÂÆöÊÄßÂíåËÆ§Áü•ÂÅèÂ∑Æ„ÄÇÊâÄÊúâËøô‰∫õÈÉΩ‰ºöÁõ¥Êé•ÂØºËá¥ÈÄüÂ∫¶Èôç‰Ωé„ÄÅ‰ª£Á†ÅÂÆ°Êü•ÁóõËã¶„ÄÅËÄå‰∏îÂ¢ûÂä† bug Êï∞Èáè Â∞ÜËøô‰∫õÊ†áÂáÜÂ∫îÁî®‰∫é‰ª£Á†ÅÂ∫ìÊó∂ÔºåÂª∫ËÆÆÂú® packageÔºàÊàñÊõ¥Â§ßÔºâÁ∫ßÂà´ËøõË°åÊõ¥ÊîπÔºåÂ≠êÂåÖÁ∫ßÂà´ÁöÑÂ∫îÁî®Á®ãÂ∫èÈÄöËøáÂ∞ÜÂ§ö‰∏™Ê†∑ÂºèÂºïÂÖ•Âà∞Âêå‰∏Ä‰ª£Á†Å‰∏≠ÔºåËøùÂèç‰∫Ü‰∏äËø∞ÂÖ≥Ê≥®ÁÇπ„ÄÇ Áõ∏‰ººÁöÑÂ£∞ÊòéÊîæÂú®‰∏ÄÁªÑGo ËØ≠Ë®ÄÊîØÊåÅÂ∞ÜÁõ∏‰ººÁöÑÂ£∞ÊòéÊîæÂú®‰∏Ä‰∏™ÁªÑÂÜÖ„ÄÇ BadGood12import "a"import "b"1234import ( "a" "b") ËøôÂêåÊ†∑ÈÄÇÁî®‰∫éÂ∏∏Èáè„ÄÅÂèòÈáèÂíåÁ±ªÂûãÂ£∞ÊòéÔºö BadGood123456789const a = 1const b = 2var a = 1var b = 2type Area float64type Volume float641234567891011121314const ( a = 1 b = 2)var ( a = 1 b = 2)type ( Area float64 Volume float64) ‰ªÖÂ∞ÜÁõ∏ÂÖ≥ÁöÑÂ£∞ÊòéÊîæÂú®‰∏ÄÁªÑ„ÄÇ‰∏çË¶ÅÂ∞Ü‰∏çÁõ∏ÂÖ≥ÁöÑÂ£∞ÊòéÊîæÂú®‰∏ÄÁªÑ„ÄÇ BadGood12345678type Operation intconst ( Add Operation = iota + 1 Subtract Multiply ENV_VAR = "MY_ENV")123456789type Operation intconst ( Add Operation = iota + 1 Subtract Multiply)const ENV_VAR = "MY_ENV" ÂàÜÁªÑ‰ΩøÁî®ÁöÑ‰ΩçÁΩÆÊ≤°ÊúâÈôêÂà∂Ôºå‰æãÂ¶ÇÔºö‰Ω†ÂèØ‰ª•Âú®ÂáΩÊï∞ÂÜÖÈÉ®‰ΩøÁî®ÂÆÉ‰ª¨Ôºö BadGood1234567func f() string &#123; var red = color.New(0xff0000) var green = color.New(0x00ff00) var blue = color.New(0x0000ff) ...&#125;123456789func f() string &#123; var ( red = color.New(0xff0000) green = color.New(0x00ff00) blue = color.New(0x0000ff) ) ...&#125; import ÂàÜÁªÑÂØºÂÖ•Â∫îËØ•ÂàÜ‰∏∫‰∏§ÁªÑÔºö Ê†áÂáÜÂ∫ì ÂÖ∂‰ªñÂ∫ì ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËøôÊòØ goimports Â∫îÁî®ÁöÑÂàÜÁªÑ„ÄÇ BadGood123456import ( "fmt" "os" "go.uber.org/atomic" "golang.org/x/sync/errgroup")1234567import ( "fmt" "os" "go.uber.org/atomic" "golang.org/x/sync/errgroup") ÂåÖÂêçÂΩìÂëΩÂêçÂåÖÊó∂ÔºåËØ∑Êåâ‰∏ãÈù¢ËßÑÂàôÈÄâÊã©‰∏Ä‰∏™ÂêçÁß∞Ôºö ÂÖ®ÈÉ®Â∞èÂÜô„ÄÇÊ≤°ÊúâÂ§ßÂÜôÊàñ‰∏ãÂàíÁ∫ø„ÄÇ Â§ßÂ§öÊï∞‰ΩøÁî®ÂëΩÂêçÂØºÂÖ•ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰∏çÈúÄË¶ÅÈáçÂëΩÂêç„ÄÇ ÁÆÄÁü≠ËÄåÁÆÄÊ¥Å„ÄÇËØ∑ËÆ∞‰ΩèÔºåÂú®ÊØè‰∏™‰ΩøÁî®ÁöÑÂú∞ÊñπÈÉΩÂÆåÊï¥Ê†áËØÜ‰∫ÜËØ•ÂêçÁß∞„ÄÇ ‰∏çÁî®Â§çÊï∞„ÄÇ‰æãÂ¶Çnet/urlÔºåËÄå‰∏çÊòØnet/urls„ÄÇ ‰∏çË¶ÅÁî®‚Äúcommon‚ÄùÔºå‚Äúutil‚ÄùÔºå‚Äúshared‚ÄùÊàñ‚Äúlib‚Äù„ÄÇËøô‰∫õÊòØ‰∏çÂ•ΩÁöÑÔºå‰ø°ÊÅØÈáè‰∏çË∂≥ÁöÑÂêçÁß∞„ÄÇ Âè¶ËØ∑ÂèÇÈòÖ Package Names Âíå Go ÂåÖÊ†∑ÂºèÊåáÂçó. ÂáΩÊï∞ÂêçÊàë‰ª¨ÈÅµÂæ™ Go Á§æÂå∫ÂÖ≥‰∫é‰ΩøÁî® MixedCaps ‰Ωú‰∏∫ÂáΩÊï∞Âêç ÁöÑÁ∫¶ÂÆö„ÄÇÊúâ‰∏Ä‰∏™‰æãÂ§ñÔºå‰∏∫‰∫ÜÂØπÁõ∏ÂÖ≥ÁöÑÊµãËØïÁî®‰æãËøõË°åÂàÜÁªÑÔºåÂáΩÊï∞ÂêçÂèØËÉΩÂåÖÂê´‰∏ãÂàíÁ∫øÔºåÂ¶ÇÔºöTestMyFunction_WhatIsBeingTested. ÂØºÂÖ•Âà´ÂêçÂ¶ÇÊûúÁ®ãÂ∫èÂåÖÂêçÁß∞‰∏éÂØºÂÖ•Ë∑ØÂæÑÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†‰∏çÂåπÈÖçÔºåÂàôÂøÖÈ°ª‰ΩøÁî®ÂØºÂÖ•Âà´Âêç„ÄÇ 123456import ( "net/http" client "example.com/client-go" trace "example.com/trace/v2") Âú®ÊâÄÊúâÂÖ∂‰ªñÊÉÖÂÜµ‰∏ãÔºåÈô§ÈùûÂØºÂÖ•‰πãÈó¥ÊúâÁõ¥Êé•ÂÜ≤Á™ÅÔºåÂê¶ÂàôÂ∫îÈÅøÂÖçÂØºÂÖ•Âà´Âêç„ÄÇ BadGood123456import ( "fmt" "os" nettrace "golang.net/x/trace")1234567import ( "fmt" "os" "runtime/trace" nettrace "golang.net/x/trace") ÂáΩÊï∞ÂàÜÁªÑ‰∏éÈ°∫Â∫è ÂáΩÊï∞Â∫îÊåâÁ≤óÁï•ÁöÑË∞ÉÁî®È°∫Â∫èÊéíÂ∫è„ÄÇ Âêå‰∏ÄÊñá‰ª∂‰∏≠ÁöÑÂáΩÊï∞Â∫îÊåâÊé•Êî∂ËÄÖÂàÜÁªÑ„ÄÇ Âõ†Ê≠§ÔºåÂØºÂá∫ÁöÑÂáΩÊï∞Â∫îÂÖàÂá∫Áé∞Âú®Êñá‰ª∂‰∏≠ÔºåÊîæÂú®struct, const, varÂÆö‰πâÁöÑÂêéÈù¢„ÄÇ Âú®ÂÆö‰πâÁ±ªÂûã‰πãÂêéÔºå‰ΩÜÂú®Êé•Êî∂ËÄÖÁöÑÂÖ∂‰ΩôÊñπÊ≥ï‰πãÂâçÔºåÂèØËÉΩ‰ºöÂá∫Áé∞‰∏Ä‰∏™ newXYZ()/NewXYZ() Áî±‰∫éÂáΩÊï∞ÊòØÊåâÊé•Êî∂ËÄÖÂàÜÁªÑÁöÑÔºåÂõ†Ê≠§ÊôÆÈÄöÂ∑•ÂÖ∑ÂáΩÊï∞Â∫îÂú®Êñá‰ª∂Êú´Â∞æÂá∫Áé∞„ÄÇ BadGood12345678910111213func (s *something) Cost() &#123; return calcCost(s.weights)&#125;type something struct&#123; ... &#125;func calcCost(n []int) int &#123;...&#125;func (s *something) Stop() &#123;...&#125;func newSomething() *something &#123; return &amp;something&#123;&#125;&#125;12345678910111213type something struct&#123; ... &#125;func newSomething() *something &#123; return &amp;something&#123;&#125;&#125;func (s *something) Cost() &#123; return calcCost(s.weights)&#125;func (s *something) Stop() &#123;...&#125;func calcCost(n []int) int &#123;...&#125; ÂáèÂ∞ëÂµåÂ•ó‰ª£Á†ÅÂ∫îÈÄöËøáÂ∞ΩÂèØËÉΩÂÖàÂ§ÑÁêÜÈîôËØØÊÉÖÂÜµ/ÁâπÊÆäÊÉÖÂÜµÂπ∂Â∞ΩÊó©ËøîÂõûÊàñÁªßÁª≠Âæ™ÁéØÊù•ÂáèÂ∞ëÂµåÂ•ó„ÄÇÂáèÂ∞ëÂµåÂ•óÂ§ö‰∏™Á∫ßÂà´ÁöÑ‰ª£Á†ÅÁöÑ‰ª£Á†ÅÈáè„ÄÇ BadGood123456789101112for _, v := range data &#123; if v.F1 == 1 &#123; v = process(v) if err := v.Call(); err == nil &#123; v.Send() &#125; else &#123; return err &#125; &#125; else &#123; log.Printf("Invalid v: %v", v) &#125;&#125;123456789101112for _, v := range data &#123; if v.F1 != 1 &#123; log.Printf("Invalid v: %v", v) continue &#125; v = process(v) if err := v.Call(); err != nil &#123; return err &#125; v.Send()&#125; ‰∏çÂøÖË¶ÅÁöÑ elseÂ¶ÇÊûúÂú® if ÁöÑ‰∏§‰∏™ÂàÜÊîØ‰∏≠ÈÉΩËÆæÁΩÆ‰∫ÜÂèòÈáèÔºåÂàôÂèØ‰ª•Â∞ÜÂÖ∂ÊõøÊç¢‰∏∫Âçï‰∏™ if„ÄÇ BadGood123456var a intif b &#123; a = 100&#125; else &#123; a = 10&#125;1234a := 10if b &#123; a = 100&#125; È°∂Â±ÇÂèòÈáèÂ£∞ÊòéÂú®È°∂Â±ÇÔºå‰ΩøÁî®Ê†áÂáÜvarÂÖ≥ÈîÆÂ≠ó„ÄÇËØ∑ÂãøÊåáÂÆöÁ±ªÂûãÔºåÈô§ÈùûÂÆÉ‰∏éË°®ËææÂºèÁöÑÁ±ªÂûã‰∏çÂêå„ÄÇ BadGood123var _s string = F()func F() string &#123; return "A" &#125;12345var _s = F()// Áî±‰∫é F Â∑≤ÁªèÊòéÁ°Æ‰∫ÜËøîÂõû‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Á±ªÂûãÔºåÂõ†Ê≠§Êàë‰ª¨Ê≤°ÊúâÂøÖË¶ÅÊòæÂºèÊåáÂÆö_s ÁöÑÁ±ªÂûã// ËøòÊòØÈÇ£ÁßçÁ±ªÂûãfunc F() string &#123; return "A" &#125; Â¶ÇÊûúË°®ËææÂºèÁöÑÁ±ªÂûã‰∏éÊâÄÈúÄÁöÑÁ±ªÂûã‰∏çÂÆåÂÖ®ÂåπÈÖçÔºåËØ∑ÊåáÂÆöÁ±ªÂûã„ÄÇ 12345678type myError struct&#123;&#125;func (myError) Error() string &#123; return "error" &#125;func F() myError &#123; return myError&#123;&#125; &#125;var _e error = F()// F ËøîÂõû‰∏Ä‰∏™ myError Á±ªÂûãÁöÑÂÆû‰æãÔºå‰ΩÜÊòØÊàë‰ª¨Ë¶Å error Á±ªÂûã ÂØπ‰∫éÊú™ÂØºÂá∫ÁöÑÈ°∂Â±ÇÂ∏∏ÈáèÂíåÂèòÈáèÔºå‰ΩøÁî®_‰Ωú‰∏∫ÂâçÁºÄÂú®Êú™ÂØºÂá∫ÁöÑÈ°∂Á∫ßvarsÂíåconstsÔºå ÂâçÈù¢Âä†‰∏äÂâçÁºÄ_Ôºå‰ª•‰ΩøÂÆÉ‰ª¨Âú®‰ΩøÁî®Êó∂ÊòéÁ°ÆË°®Á§∫ÂÆÉ‰ª¨ÊòØÂÖ®Â±ÄÁ¨¶Âè∑„ÄÇ ‰æãÂ§ñÔºöÊú™ÂØºÂá∫ÁöÑÈîôËØØÂÄºÔºåÂ∫î‰ª•errÂºÄÂ§¥„ÄÇ Âü∫Êú¨‰æùÊçÆÔºöÈ°∂Á∫ßÂèòÈáèÂíåÂ∏∏ÈáèÂÖ∑ÊúâÂåÖËåÉÂõ¥‰ΩúÁî®Âüü„ÄÇ‰ΩøÁî®ÈÄöÁî®ÂêçÁß∞ÂèØËÉΩÂæàÂÆπÊòìÂú®ÂÖ∂‰ªñÊñá‰ª∂‰∏≠ÊÑèÂ§ñ‰ΩøÁî®ÈîôËØØÁöÑÂÄº„ÄÇ BadGood1234567891011121314151617// foo.goconst ( defaultPort = 8080 defaultUser = "user")// bar.gofunc Bar() &#123; defaultPort := 9090 ... fmt.Println("Default port", defaultPort) // We will not see a compile error if the first line of // Bar() is deleted.&#125;123456// foo.goconst ( _defaultPort = 8080 _defaultUser = "user") ÁªìÊûÑ‰Ωì‰∏≠ÁöÑÂµåÂÖ•ÂµåÂÖ•ÂºèÁ±ªÂûãÔºà‰æãÂ¶Ç mutexÔºâÂ∫î‰Ωç‰∫éÁªìÊûÑ‰ΩìÂÜÖÁöÑÂ≠óÊÆµÂàóË°®ÁöÑÈ°∂ÈÉ®ÔºåÂπ∂‰∏îÂøÖÈ°ªÊúâ‰∏Ä‰∏™Á©∫Ë°åÂ∞ÜÂµåÂÖ•ÂºèÂ≠óÊÆµ‰∏éÂ∏∏ËßÑÂ≠óÊÆµÂàÜÈöîÂºÄ„ÄÇ BadGood1234type Client struct &#123; version int http.Client&#125;12345type Client struct &#123; http.Client version int&#125; ‰ΩøÁî®Â≠óÊÆµÂêçÂàùÂßãÂåñÁªìÊûÑ‰ΩìÂàùÂßãÂåñÁªìÊûÑ‰ΩìÊó∂ÔºåÂá†‰πéÂßãÁªàÂ∫îËØ•ÊåáÂÆöÂ≠óÊÆµÂêçÁß∞„ÄÇÁé∞Âú®Áî± go vet Âº∫Âà∂ÊâßË°å„ÄÇ BadGood1k := User&#123;"John", "Doe", true&#125;12345k := User&#123; FirstName: "John", LastName: "Doe", Admin: true,&#125; ‰æãÂ§ñÔºöÂ¶ÇÊûúÊúâ 3 ‰∏™ÊàñÊõ¥Â∞ëÁöÑÂ≠óÊÆµÔºåÂàôÂèØ‰ª•Âú®ÊµãËØïË°®‰∏≠ÁúÅÁï•Â≠óÊÆµÂêçÁß∞„ÄÇ 1234567tests := []struct&#123; op Operation want string&#125;&#123; &#123;Add, "add"&#125;, &#123;Subtract, "subtract"&#125;,&#125; Êú¨Âú∞ÂèòÈáèÂ£∞ÊòéÂ¶ÇÊûúÂ∞ÜÂèòÈáèÊòéÁ°ÆËÆæÁΩÆ‰∏∫Êüê‰∏™ÂÄºÔºåÂàôÂ∫î‰ΩøÁî®Áü≠ÂèòÈáèÂ£∞ÊòéÂΩ¢Âºè (:=)„ÄÇ BadGood1var s = "foo"1s := "foo" ‰ΩÜÊòØÔºåÂú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåvar ‰ΩøÁî®ÂÖ≥ÈîÆÂ≠óÊó∂ÈªòËÆ§ÂÄº‰ºöÊõ¥Ê∏ÖÊô∞„ÄÇ‰æãÂ¶ÇÔºåÂ£∞ÊòéÁ©∫ÂàáÁâá„ÄÇ BadGood12345678func f(list []int) &#123; filtered := []int&#123;&#125; for _, v := range list &#123; if v &gt; 10 &#123; filtered = append(filtered, v) &#125; &#125;&#125;12345678func f(list []int) &#123; var filtered []int for _, v := range list &#123; if v &gt; 10 &#123; filtered = append(filtered, v) &#125; &#125;&#125; nil ÊòØ‰∏Ä‰∏™ÊúâÊïàÁöÑ slicenil ÊòØ‰∏Ä‰∏™ÊúâÊïàÁöÑÈïøÂ∫¶‰∏∫ 0 ÁöÑ sliceÔºåËøôÊÑèÂë≥ÁùÄÔºå ÊÇ®‰∏çÂ∫îÊòéÁ°ÆËøîÂõûÈïøÂ∫¶‰∏∫Èõ∂ÁöÑÂàáÁâá„ÄÇÂ∫îËØ•ËøîÂõûnil Êù•‰ª£Êõø„ÄÇ BadGood123if x == "" &#123; return []int&#123;&#125;&#125;123if x == "" &#123; return nil&#125; Ë¶ÅÊ£ÄÊü•ÂàáÁâáÊòØÂê¶‰∏∫Á©∫ÔºåËØ∑ÂßãÁªà‰ΩøÁî®len(s) == 0„ÄÇËÄåÈùû nil„ÄÇ BadGood123func isEmpty(s []string) bool &#123; return s == nil&#125;123func isEmpty(s []string) bool &#123; return len(s) == 0&#125; Èõ∂ÂÄºÂàáÁâáÔºàÁî®varÂ£∞ÊòéÁöÑÂàáÁâáÔºâÂèØÁ´ãÂç≥‰ΩøÁî®ÔºåÊó†ÈúÄË∞ÉÁî®make()ÂàõÂª∫„ÄÇ BadGood12345678910nums := []int&#123;&#125;// or, nums := make([]int)if add1 &#123; nums = append(nums, 1)&#125;if add2 &#123; nums = append(nums, 2)&#125;123456789var nums []intif add1 &#123; nums = append(nums, 1)&#125;if add2 &#123; nums = append(nums, 2)&#125; ËÆ∞‰ΩèÔºåËôΩÁÑ∂nilÂàáÁâáÊòØÊúâÊïàÁöÑÂàáÁâáÔºå‰ΩÜÂÆÉ‰∏çÁ≠â‰∫éÈïøÂ∫¶‰∏∫0ÁöÑÂàáÁâáÔºà‰∏Ä‰∏™‰∏∫nilÔºåÂè¶‰∏Ä‰∏™‰∏çÊòØÔºâÔºåÂπ∂‰∏îÂú®‰∏çÂêåÁöÑÊÉÖÂÜµ‰∏ãÔºà‰æãÂ¶ÇÂ∫èÂàóÂåñÔºâÔºåËøô‰∏§‰∏™ÂàáÁâáÁöÑÂ§ÑÁêÜÊñπÂºèÂèØËÉΩ‰∏çÂêå„ÄÇ Áº©Â∞èÂèòÈáè‰ΩúÁî®ÂüüÂ¶ÇÊûúÊúâÂèØËÉΩÔºåÂ∞ΩÈáèÁº©Â∞èÂèòÈáè‰ΩúÁî®ËåÉÂõ¥„ÄÇÈô§ÈùûÂÆÉ‰∏é ÂáèÂ∞ëÂµåÂ•óÁöÑËßÑÂàôÂÜ≤Á™Å„ÄÇ BadGood1234err := ioutil.WriteFile(name, data, 0644)if err != nil &#123; return err&#125;123if err := ioutil.WriteFile(name, data, 0644); err != nil &#123; return err&#125; Â¶ÇÊûúÈúÄË¶ÅÂú® if ‰πãÂ§ñ‰ΩøÁî®ÂáΩÊï∞Ë∞ÉÁî®ÁöÑÁªìÊûúÔºåÂàô‰∏çÂ∫îÂ∞ùËØïÁº©Â∞èËåÉÂõ¥„ÄÇ BadGood1234567891011if data, err := ioutil.ReadFile(name); err == nil &#123; err = cfg.Decode(data) if err != nil &#123; return err &#125; fmt.Println(cfg) return nil&#125; else &#123; return err&#125;1234567891011data, err := ioutil.ReadFile(name)if err != nil &#123; return err&#125;if err := cfg.Decode(data); err != nil &#123; return err&#125;fmt.Println(cfg)return nil ÈÅøÂÖçÂèÇÊï∞ËØ≠‰πâ‰∏çÊòéÁ°Æ(Avoid Naked Parameters)ÂáΩÊï∞Ë∞ÉÁî®‰∏≠ÁöÑÊÑè‰πâ‰∏çÊòéÁ°ÆÁöÑÂèÇÊï∞ÂèØËÉΩ‰ºöÊçüÂÆ≥ÂèØËØªÊÄß„ÄÇÂΩìÂèÇÊï∞ÂêçÁß∞ÁöÑÂê´‰πâ‰∏çÊòéÊòæÊó∂ÔºåËØ∑‰∏∫ÂèÇÊï∞Ê∑ªÂä† C Ê†∑ÂºèÊ≥®Èáä (/* ... */) BadGood123// func printInfo(name string, isLocal, done bool)printInfo("foo", true, true)123// func printInfo(name string, isLocal, done bool)printInfo("foo", true /* isLocal */, true /* done */) ÂØπ‰∫é‰∏äÈù¢ÁöÑÁ§∫‰æã‰ª£Á†ÅÔºåËøòÊúâ‰∏ÄÁßçÊõ¥Â•ΩÁöÑÂ§ÑÁêÜÊñπÂºèÊòØÂ∞Ü‰∏äÈù¢ÁöÑ bool Á±ªÂûãÊç¢ÊàêËá™ÂÆö‰πâÁ±ªÂûã„ÄÇÂ∞ÜÊù•ÔºåËØ•ÂèÇÊï∞ÂèØ‰ª•ÊîØÊåÅ‰∏ç‰ªÖ‰ªÖÂ±ÄÈôê‰∫é‰∏§‰∏™Áä∂ÊÄÅÔºàtrue/falseÔºâ„ÄÇ 12345678910111213141516type Region intconst ( UnknownRegion Region = iota Local)type Status intconst ( StatusReady Status= iota + 1 StatusDone // Maybe we will have a StatusInProgress in the future.)func printInfo(name string, region Region, status Status) ‰ΩøÁî®ÂéüÂßãÂ≠óÁ¨¶‰∏≤Â≠óÈù¢ÂÄºÔºåÈÅøÂÖçËΩ¨‰πâGo ÊîØÊåÅ‰ΩøÁî® ÂéüÂßãÂ≠óÁ¨¶‰∏≤Â≠óÈù¢ÂÄºÔºå‰πüÂ∞±ÊòØ ‚Äú ` ‚Äú Êù•Ë°®Á§∫ÂéüÁîüÂ≠óÁ¨¶‰∏≤ÔºåÂú®ÈúÄË¶ÅËΩ¨‰πâÁöÑÂú∫ÊôØ‰∏ãÔºåÊàë‰ª¨Â∫îËØ•Â∞ΩÈáè‰ΩøÁî®ËøôÁßçÊñπÊ°àÊù•ÊõøÊç¢„ÄÇ ÂèØ‰ª•Ë∑®Ë∂äÂ§öË°åÂπ∂ÂåÖÂê´ÂºïÂè∑„ÄÇ‰ΩøÁî®Ëøô‰∫õÂ≠óÁ¨¶‰∏≤ÂèØ‰ª•ÈÅøÂÖçÊõ¥ÈöæÈòÖËØªÁöÑÊâãÂ∑•ËΩ¨‰πâÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ BadGood1wantError := "unknown name:\"test\""1wantError := `unknown error:"test"` ÂàùÂßãÂåñ Struct ÂºïÁî®Âú®ÂàùÂßãÂåñÁªìÊûÑÂºïÁî®Êó∂ÔºåËØ∑‰ΩøÁî®&amp;T{}‰ª£Êõønew(T)Ôºå‰ª•‰ΩøÂÖ∂‰∏éÁªìÊûÑ‰ΩìÂàùÂßãÂåñ‰∏ÄËá¥„ÄÇ BadGood12345sval := T&#123;Name: "foo"&#125;// inconsistentsptr := new(T)sptr.Name = "bar"123sval := T&#123;Name: "foo"&#125;sptr := &amp;T&#123;Name: "bar"&#125; ÂàùÂßãÂåñ MapsÂØπ‰∫éÁ©∫ map ËØ∑‰ΩøÁî® make(..) ÂàùÂßãÂåñÔºå Âπ∂‰∏î map ÊòØÈÄöËøáÁºñÁ®ãÊñπÂºèÂ°´ÂÖÖÁöÑ„ÄÇËøô‰ΩøÂæó map ÂàùÂßãÂåñÂú®Ë°®Áé∞‰∏ä‰∏çÂêå‰∫éÂ£∞ÊòéÔºåÂπ∂‰∏îÂÆÉËøòÂèØ‰ª•Êñπ‰æøÂú∞Âú® make ÂêéÊ∑ªÂä†Â§ßÂ∞èÊèêÁ§∫„ÄÇ BadGood123456var ( // m1 ËØªÂÜôÂÆâÂÖ®; // m2 Âú®ÂÜôÂÖ•Êó∂‰ºö panic m1 = map[T1]T2&#123;&#125; m2 map[T1]T2)123456var ( // m1 ËØªÂÜôÂÆâÂÖ®; // m2 Âú®ÂÜôÂÖ•Êó∂‰ºö panic m1 = make(map[T1]T2) m2 map[T1]T2)Â£∞ÊòéÂíåÂàùÂßãÂåñÁúãËµ∑Êù•ÈùûÂ∏∏Áõ∏‰ººÁöÑ„ÄÇÂ£∞ÊòéÂíåÂàùÂßãÂåñÁúãËµ∑Êù•Â∑ÆÂà´ÈùûÂ∏∏Â§ß„ÄÇ Âú®Â∞ΩÂèØËÉΩÁöÑÊÉÖÂÜµ‰∏ãÔºåËØ∑Âú®ÂàùÂßãÂåñÊó∂Êèê‰æõ map ÂÆπÈáèÂ§ßÂ∞èÔºåËØ¶ÁªÜËØ∑Áúã Â∞ΩÈáèÂàùÂßãÂåñÊó∂ÊåáÂÆö Map ÂÆπÈáè„ÄÇ Âè¶Â§ñÔºåÂ¶ÇÊûú map ÂåÖÂê´Âõ∫ÂÆöÁöÑÂÖÉÁ¥†ÂàóË°®ÔºåÂàô‰ΩøÁî® map literals(map ÂàùÂßãÂåñÂàóË°®) ÂàùÂßãÂåñÊò†Â∞Ñ„ÄÇ BadGood1234m := make(map[T1]T2, 3)m[k1] = v1m[k2] = v2m[k3] = v312345m := map[T1]T2&#123; k1: v1, k2: v2, k3: v3,&#125; Âü∫Êú¨ÂáÜÂàôÊòØÔºöÂú®ÂàùÂßãÂåñÊó∂‰ΩøÁî® map ÂàùÂßãÂåñÂàóË°® Êù•Ê∑ªÂä†‰∏ÄÁªÑÂõ∫ÂÆöÁöÑÂÖÉÁ¥†„ÄÇÂê¶Âàô‰ΩøÁî® make (Â¶ÇÊûúÂèØ‰ª•ÔºåËØ∑Â∞ΩÈáèÊåáÂÆö map ÂÆπÈáè)„ÄÇ Â≠óÁ¨¶‰∏≤ string formatÂ¶ÇÊûú‰Ω†Âú®ÂáΩÊï∞Â§ñÂ£∞ÊòéPrintf-style ÂáΩÊï∞ÁöÑÊ†ºÂºèÂ≠óÁ¨¶‰∏≤ÔºåËØ∑Â∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫constÂ∏∏Èáè„ÄÇ ËøôÊúâÂä©‰∫égo vetÂØπÊ†ºÂºèÂ≠óÁ¨¶‰∏≤ÊâßË°åÈùôÊÄÅÂàÜÊûê„ÄÇ BadGood12msg := "unexpected values %v, %v\n"fmt.Printf(msg, 1, 2)12const msg = "unexpected values %v, %v\n"fmt.Printf(msg, 1, 2) ÂëΩÂêç Printf Ê†∑ÂºèÁöÑÂáΩÊï∞Â£∞ÊòéPrintf-style ÂáΩÊï∞Êó∂ÔºåËØ∑Á°Æ‰øùgo vetÂèØ‰ª•Ê£ÄÊµãÂà∞ÂÆÉÂπ∂Ê£ÄÊü•Ê†ºÂºèÂ≠óÁ¨¶‰∏≤„ÄÇ ËøôÊÑèÂë≥ÁùÄÊÇ®Â∫îÂ∞ΩÂèØËÉΩ‰ΩøÁî®È¢ÑÂÆö‰πâÁöÑPrintf-style ÂáΩÊï∞ÂêçÁß∞„ÄÇgo vetÂ∞ÜÈªòËÆ§Ê£ÄÊü•Ëøô‰∫õ„ÄÇÊúâÂÖ≥Êõ¥Â§ö‰ø°ÊÅØÔºåËØ∑ÂèÇËßÅ Printf Á≥ªÂàó„ÄÇ Â¶ÇÊûú‰∏çËÉΩ‰ΩøÁî®È¢ÑÂÆö‰πâÁöÑÂêçÁß∞ÔºåËØ∑‰ª• f ÁªìÊùüÈÄâÊã©ÁöÑÂêçÁß∞ÔºöWrapfÔºåËÄå‰∏çÊòØWrap„ÄÇgo vetÂèØ‰ª•Ë¶ÅÊ±ÇÊ£ÄÊü•ÁâπÂÆöÁöÑ Printf Ê†∑ÂºèÂêçÁß∞Ôºå‰ΩÜÂêçÁß∞ÂøÖÈ°ª‰ª•fÁªìÂ∞æ„ÄÇ 1$ go vet -printfuncs=wrapf,statusf Âè¶ËØ∑ÂèÇÈòÖ go vet: Printf family check. ÁºñÁ®ãÊ®°ÂºèË°®È©±Âä®ÊµãËØïÂΩìÊµãËØïÈÄªËæëÊòØÈáçÂ§çÁöÑÊó∂ÂÄôÔºåÈÄöËøá subtests ‰ΩøÁî® table È©±Âä®ÁöÑÊñπÂºèÁºñÂÜô case ‰ª£Á†ÅÁúã‰∏äÂéª‰ºöÊõ¥ÁÆÄÊ¥Å„ÄÇ BadGood123456789101112131415161718192021// func TestSplitHostPort(t *testing.T)host, port, err := net.SplitHostPort("192.0.2.0:8000")require.NoError(t, err)assert.Equal(t, "192.0.2.0", host)assert.Equal(t, "8000", port)host, port, err = net.SplitHostPort("192.0.2.0:http")require.NoError(t, err)assert.Equal(t, "192.0.2.0", host)assert.Equal(t, "http", port)host, port, err = net.SplitHostPort(":8000")require.NoError(t, err)assert.Equal(t, "", host)assert.Equal(t, "8000", port)host, port, err = net.SplitHostPort("1:8")require.NoError(t, err)assert.Equal(t, "1", host)assert.Equal(t, "8", port)12345678910111213141516171819202122232425262728293031323334353637// func TestSplitHostPort(t *testing.T)tests := []struct&#123; give string wantHost string wantPort string&#125;&#123; &#123; give: "192.0.2.0:8000", wantHost: "192.0.2.0", wantPort: "8000", &#125;, &#123; give: "192.0.2.0:http", wantHost: "192.0.2.0", wantPort: "http", &#125;, &#123; give: ":8000", wantHost: "", wantPort: "8000", &#125;, &#123; give: "1:8", wantHost: "1", wantPort: "8", &#125;,&#125;for _, tt := range tests &#123; t.Run(tt.give, func(t *testing.T) &#123; host, port, err := net.SplitHostPort(tt.give) require.NoError(t, err) assert.Equal(t, tt.wantHost, host) assert.Equal(t, tt.wantPort, port) &#125;)&#125; ÂæàÊòéÊòæÔºå‰ΩøÁî® test table ÁöÑÊñπÂºèÂú®‰ª£Á†ÅÈÄªËæëÊâ©Â±ïÁöÑÊó∂ÂÄôÔºåÊØîÂ¶ÇÊñ∞Â¢û test caseÔºåÈÉΩ‰ºöÊòæÂæóÊõ¥Âä†ÁöÑÊ∏ÖÊô∞„ÄÇ Êàë‰ª¨ÈÅµÂæ™ËøôÊ†∑ÁöÑÁ∫¶ÂÆöÔºöÂ∞ÜÁªìÊûÑ‰ΩìÂàáÁâáÁß∞‰∏∫tests„ÄÇ ÊØè‰∏™ÊµãËØïÁî®‰æãÁß∞‰∏∫tt„ÄÇÊ≠§Â§ñÔºåÊàë‰ª¨ÈºìÂä±‰ΩøÁî®giveÂíåwantÂâçÁºÄËØ¥ÊòéÊØè‰∏™ÊµãËØïÁî®‰æãÁöÑËæìÂÖ•ÂíåËæìÂá∫ÂÄº„ÄÇ 1234567891011tests := []struct&#123; give string wantHost string wantPort string&#125;&#123; // ...&#125;for _, tt := range tests &#123; // ...&#125; ÂäüËÉΩÈÄâÈ°πÂäüËÉΩÈÄâÈ°πÊòØ‰∏ÄÁßçÊ®°ÂºèÔºåÊÇ®ÂèØ‰ª•Âú®ÂÖ∂‰∏≠Â£∞Êòé‰∏Ä‰∏™‰∏çÈÄèÊòé Option Á±ªÂûãÔºåËØ•Á±ªÂûãÂú®Êüê‰∫õÂÜÖÈÉ®ÁªìÊûÑ‰∏≠ËÆ∞ÂΩï‰ø°ÊÅØ„ÄÇÊÇ®Êé•ÂèóËøô‰∫õÈÄâÈ°πÁöÑÂèØÂèòÁºñÂè∑ÔºåÂπ∂Ê†πÊçÆÂÜÖÈÉ®ÁªìÊûÑ‰∏äÁöÑÈÄâÈ°πËÆ∞ÂΩïÁöÑÂÖ®ÈÉ®‰ø°ÊÅØÈááÂèñË°åÂä®„ÄÇ Â∞ÜÊ≠§Ê®°ÂºèÁî®‰∫éÊÇ®ÈúÄË¶ÅÊâ©Â±ïÁöÑÊûÑÈÄ†ÂáΩÊï∞ÂíåÂÖ∂‰ªñÂÖ¨ÂÖ± API ‰∏≠ÁöÑÂèØÈÄâÂèÇÊï∞ÔºåÂ∞§ÂÖ∂ÊòØÂú®Ëøô‰∫õÂäüËÉΩ‰∏äÂ∑≤ÁªèÂÖ∑Êúâ‰∏â‰∏™ÊàñÊõ¥Â§öÂèÇÊï∞ÁöÑÊÉÖÂÜµ‰∏ã„ÄÇ BadGood123456789// package dbfunc Open( addr string, cache bool, logger *zap.Logger) (*Connection, error) &#123; // ...&#125;123456789101112131415161718192021// package dbtype Option interface &#123; // ...&#125;func WithCache(c bool) Option &#123; // ...&#125;func WithLogger(log *zap.Logger) Option &#123; // ...&#125;// Open creates a connection.func Open( addr string, opts ...Option,) (*Connection, error) &#123; // ...&#125;ÂøÖÈ°ªÂßãÁªàÊèê‰æõÁºìÂ≠òÂíåËÆ∞ÂΩïÂô®ÂèÇÊï∞ÔºåÂç≥‰ΩøÁî®Êà∑Â∏åÊúõ‰ΩøÁî®ÈªòËÆ§ÂÄº„ÄÇ1234db.Open(addr, db.DefaultCache, zap.NewNop())db.Open(addr, db.DefaultCache, log)db.Open(addr, false /* cache */, zap.NewNop())db.Open(addr, false /* cache */, log)Âè™ÊúâÂú®ÈúÄË¶ÅÊó∂ÊâçÊèê‰æõÈÄâÈ°π„ÄÇ12345678db.Open(addr)db.Open(addr, db.WithLogger(log))db.Open(addr, db.WithCache(false))db.Open( addr, db.WithCache(false), db.WithLogger(log),) Our suggested way of implementing this pattern is with an Option interfacethat holds an unexported method, recording options on an unexported optionsstruct. Êàë‰ª¨Âª∫ËÆÆÂÆûÁé∞Ê≠§Ê®°ÂºèÁöÑÊñπÊ≥ïÊòØ‰ΩøÁî®‰∏Ä‰∏™ Option Êé•Âè£ÔºåËØ•Êé•Âè£‰øùÂ≠ò‰∏Ä‰∏™Êú™ÂØºÂá∫ÁöÑÊñπÊ≥ïÔºåÂú®‰∏Ä‰∏™Êú™ÂØºÂá∫ÁöÑ options ÁªìÊûÑ‰∏äËÆ∞ÂΩïÈÄâÈ°π„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647type options struct &#123; cache bool logger *zap.Logger&#125;type Option interface &#123; apply(*options)&#125;type cacheOption boolfunc (c cacheOption) apply(opts *options) &#123; opts.cache = bool(c)&#125;func WithCache(c bool) Option &#123; return cacheOption(c)&#125;type loggerOption struct &#123; Log *zap.Logger&#125;func (l loggerOption) apply(opts *options) &#123; opts.logger = l.Log&#125;func WithLogger(log *zap.Logger) Option &#123; return loggerOption&#123;Log: log&#125;&#125;// Open creates a connection.func Open( addr string, opts ...Option,) (*Connection, error) &#123; options := options&#123; cache: defaultCache, logger: zap.NewNop(), &#125; for _, o := range opts &#123; o.apply(&amp;options) &#125; // ...&#125; Ê≥®ÊÑè: ËøòÊúâ‰∏ÄÁßç‰ΩøÁî®Èó≠ÂåÖÂÆûÁé∞Ëøô‰∏™Ê®°ÂºèÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØÊàë‰ª¨Áõ∏‰ø°‰∏äÈù¢ÁöÑÊ®°Âºè‰∏∫‰ΩúËÄÖÊèê‰æõ‰∫ÜÊõ¥Â§öÁöÑÁÅµÊ¥ªÊÄßÔºåÂπ∂‰∏îÊõ¥ÂÆπÊòìÂØπÁî®Êà∑ËøõË°åË∞ÉËØïÂíåÊµãËØï„ÄÇÁâπÂà´ÊòØÔºåÂú®‰∏çÂèØËÉΩËøõË°åÊØîËæÉÁöÑÊÉÖÂÜµ‰∏ãÂÆÉÂÖÅËÆ∏Âú®ÊµãËØïÂíåÊ®°Êãü‰∏≠ÂØπÈÄâÈ°πËøõË°åÊØîËæÉ„ÄÇÊ≠§Â§ñÔºåÂÆÉËøòÂÖÅËÆ∏ÈÄâÈ°πÂÆûÁé∞ÂÖ∂‰ªñÊé•Âè£ÔºåÂåÖÊã¨ fmt.StringerÔºåÂÖÅËÆ∏Áî®Êà∑ËØªÂèñÈÄâÈ°πÁöÑÂ≠óÁ¨¶‰∏≤Ë°®Á§∫ÂΩ¢Âºè„ÄÇ ËøòÂèØ‰ª•ÂèÇËÄÉ‰∏ãÈù¢ËµÑÊñôÔºö Self-referential functions and the design of options Functional options for friendly APIs Stargazers over time]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂÖ≥‰∫é golang ÈîôËØØÂ§ÑÁêÜÁöÑ‰∏Ä‰∫õÊÄùËÄÉ]]></title>
    <url>%2F2020%2F06%2F01%2F%E5%85%B3%E4%BA%8E-golang-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83%2F</url>
    <content type="text"><![CDATA[ÂÜôÂú®ÂâçÈù¢Ôºö‰Ω†ÊòØËøòÊ≤°Âú®error‰∏äÊ†ΩË∑üÂ§¥ÔºåÂΩì‰Ω†Ê†Ω‰∫ÜË∑üÂ§¥Êó∂Êâç‰ºöÂì≠ÁùÄÊÉ≥Ëµ∑Êù•ÔºåÂΩìÂπ¥‰∏∫‰ªÄ‰πàÊ≤°Â•ΩÂ•ΩÊÄùËÄÉÂíåÂèçÁúÅÈîôËØØÂ§ÑÁêÜËøô‰πà‰∏Ä‰∏™ÂÆèÂ§ßÁöÑËØùÈ¢ò ÂÖ≥‰∫é Golang ÈîôËØØÂ§ÑÁêÜÁöÑÂÆûË∑µ GolangÊúâÂæàÂ§ö‰ºòÁÇπÔºåËøô‰πüÊòØÂÆÉÂ¶ÇÊ≠§ÊµÅË°åÁöÑ‰∏ªË¶ÅÂéüÂõ†„ÄÇ‰ΩÜÊòØ Go 1 ÂØπÈîôËØØÂ§ÑÁêÜÁöÑÊîØÊåÅËøá‰∫éÁÆÄÂçï‰∫ÜÔºå‰ª•Ëá≥‰∫éÊó•Â∏∏ÂºÄÂèë‰∏≠‰ºöÊúâËØ∏Â§ö‰∏ç‰æøÂà©ÔºåÈÅ≠Âà∞ÂæàÂ§öÂºÄÂèëËÄÖÁöÑÂêêÊßΩ„ÄÇËøô‰∫õ‰∏çË∂≥ÂÇ¨Áîü‰∫Ü‰∏Ä‰∫õÂºÄÊ∫êËß£ÂÜ≥ÊñπÊ°à„ÄÇ‰∏éÊ≠§ÂêåÊó∂Ôºå Go ÂÆòÊñπ‰πüÂú®‰ªéËØ≠Ë®ÄÂíåÊ†áÂáÜÂ∫ìÂ±ÇÈù¢‰ΩúÂá∫ÊîπËøõ„ÄÇËøôÁØáÊñáÁ´†Â∞ÜÁªôÂá∫Âá†ÁßçÂ∏∏ËßÅÂàõÂª∫ÈîôËØØÁöÑÊñπÂºèÂπ∂ÂàÜÊûê‰∏Ä‰∫õÂ∏∏ËßÅÈóÆÈ¢òÔºåÂØπÊØîÂêÑÁßçËß£ÂÜ≥ÊñπÊ°àÔºåÂπ∂Â±ïÁ§∫‰∫ÜËøÑ‰ªä‰∏∫Ê≠¢(go 1.13)ÁöÑÊúÄ‰Ω≥ÂÆûË∑µ„ÄÇ Âá†ÁßçÂàõÂª∫ÈîôËØØÁöÑÊñπÂºè È¶ñÂÖà‰ªãÁªçÂá†ÁßçÂ∏∏ËßÅÁöÑÂàõÂª∫ÈîôËØØÁöÑÊñπÊ≥ï Âü∫‰∫éÂ≠óÁ¨¶‰∏≤ÁöÑÈîôËØØ 1234err1 := errors.New("math: square root of negative number")err2 := fmt.Errorf("math: square root of negative number %g", x) Â∏¶ÊúâÊï∞ÊçÆÁöÑËá™ÂÆö‰πâÈîôËØØ123456789101112131415161718192021222324252627282930package zErrorimport ( "fmt" "github.com/satori/go.uuid" "log" "runtime/debug" "time")type BaseError struct &#123; InnerError error Message string StackTrace string Misc map[string]interface&#123;&#125;&#125;func WrapError(err error, message string, messageArgs ...interface&#123;&#125;) BaseError &#123; return BaseError&#123; InnerError: err, Message: fmt.Sprintf(message, messageArgs), StackTrace: string(debug.Stack()), Misc: make(map[string]interface&#123;&#125;), &#125;&#125;func (err *BaseError) Error() string &#123;// ÂÆûÁé∞ Error Êé•Âè£ return err.Message&#125; ÊäõÂá∫ÈóÆÈ¢ò ÂºÄÂèë‰∏≠ÁªèÂ∏∏ÈúÄË¶ÅÊ£ÄÊü•ËøîÂõûÁöÑÈîôËØØÂÄºÂπ∂‰ΩúÁõ∏Â∫îÂ§ÑÁêÜ„ÄÇ‰∏ãÈù¢ÁªôÂá∫‰∏Ä‰∏™ÊúÄÁÆÄÂçïÁöÑÁ§∫‰æã„ÄÇ 123456789101112131415161718192021import ( "database/sql" "fmt")func GetSql() error &#123; return sql.ErrNoRows&#125;func Call() error &#123; return GetSql()&#125;func main() &#123; err := Call() if err != nil &#123; fmt.Printf("got err, %+v\n", err) &#125;&#125;//Outputs:// got err, sql: no rows in result set ÊúâÊó∂ÈúÄË¶ÅÊ†πÊçÆËøîÂõûÁöÑerrorÁ±ªÂûã‰Ωú‰∏çÂêåÂ§ÑÁêÜÔºå‰æãÂ¶ÇÔºö 1234567891011121314151617181920212223242526import ( "database/sql" "fmt")func GetSql() error &#123; return sql.ErrNoRows&#125;func Call() error &#123; return GetSql()&#125;func main() &#123; err := Call() if err == sql.ErrNoRows &#123; fmt.Printf("data not found, %+v\n", err) return &#125; if err != nil &#123; // Unknown error &#125;&#125;//Outputs:// data not found, sql: no rows in result set ÂÆûË∑µ‰∏≠ÁªèÂ∏∏ÈúÄË¶Å‰∏∫ÈîôËØØÂ¢ûÂä†‰∏ä‰∏ãÊñá‰ø°ÊÅØÂêéÂÜçËøîÂõûÔºå‰ª•Êñπ‰æøË∞ÉÁî®ËÄÖ‰∫ÜËß£ÈîôËØØÂú∫ÊôØ„ÄÇ‰æãÂ¶Ç Getcall ÊñπÊ≥ïÊó∂Â∏∏ÂÜôÊàêÔºö123func Getcall() error &#123; return fmt.Errorf("GetSql err, %v", sql.ErrNoRows)&#125; ‰∏çËøáËøô‰∏™Êó∂ÂÄô err == sql.ErrNoRows Â∞±‰∏çÊàêÁ´ã‰∫Ü„ÄÇÈô§Ê≠§‰πãÂ§ñÔºå‰∏äËø∞ÂÜôÊ≥ïÈÉΩÂú®ËøîÂõûÈîôËØØÊó∂ÈÉΩ‰∏¢Êéâ‰∫ÜË∞ÉÁî®Ê†àËøô‰∏™ÈáçË¶ÅÁöÑ‰ø°ÊÅØ„ÄÇÊàë‰ª¨ÈúÄË¶ÅÊõ¥ÁÅµÊ¥ª„ÄÅÊõ¥ÈÄöÁî®ÁöÑÊñπÂºèÊù•Â∫îÂØπÊ≠§Á±ªÈóÆÈ¢ò„ÄÇ Ëß£ÂÜ≥ÊñπÊ°à ÈíàÂØπÂ≠òÂú®ÁöÑ‰∏çË∂≥ÔºåÁõÆÂâçÊúâÂá†ÁßçËß£ÂÜ≥ÊñπÊ°à„ÄÇËøô‰∫õÊñπÂºèÂèØ‰ª•ÂØπÈîôËØØËøõË°å‰∏ä‰∏ãÊñáÂåÖË£ÖÔºåÂπ∂Êê∫Â∏¶ÂéüÂßãÈîôËØØ‰ø°ÊÅØÔºå ËøòËÉΩÂ∞ΩÈáè‰øùÁïôÂÆåÊï¥ÁöÑË∞ÉÁî®Ê†à ÊñπÊ°à 1Ôºö github.com/pkg/errorsÂ¶ÇÊûúÂè™ÊúâÈîôËØØÁöÑÊñáÊú¨ÔºåÊàë‰ª¨ÂæàÈöæÂÆö‰ΩçÂà∞ÂÖ∑‰ΩìÁöÑÂá∫ÈîôÂú∞ÁÇπ„ÄÇËôΩÁÑ∂ÈÄöËøáÂú®‰ª£Á†Å‰∏≠ÊêúÁ¥¢ÈîôËØØÊñáÊú¨‰πüÊòØÊúâÂèØËÉΩÊâæÂà∞Âá∫ÈîôÂú∞ÁÇπÁöÑÔºå‰ΩÜÊòØ‰ø°ÊÅØÊúâÈôê„ÄÇÊâÄ‰ª•ÔºåÂú®ÂÆûË∑µ‰∏≠ÔºåÊàë‰ª¨ÂæÄÂæÄ‰ºöÂ∞ÜÂá∫ÈîôÊó∂ÁöÑË∞ÉÁî®Ê†à‰ø°ÊÅØ‰πüÈôÑÂä†‰∏äÂéª„ÄÇË∞ÉÁî®Ê†àÂØπÊ∂àË¥πÊñπÊòØÊ≤°ÊúâÊÑè‰πâÁöÑÔºå‰ªéÈöîÁ¶ªÂíåËá™Ê≤ªÁöÑËßíÂ∫¶Êù•ÁúãÔºåÊ∂àË¥πÊñπÂîØ‰∏ÄÈúÄË¶ÅÂÖ≥ÂøÉÁöÑÂ∞±ÊòØÈîôËØØÊñáÊú¨ÂíåÈîôËØØÁ±ªÂûã„ÄÇË∞ÉÁî®Ê†àÂØπÂÆûÁé∞ËÄÖËá™Ë∫´ÊâçÊòØÊòØÊúâ‰ª∑ÂÄºÁöÑ„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÊñπÊ≥ïÈúÄË¶ÅËøîÂõûÈîôËØØÔºåÊàë‰ª¨‰∏ÄËà¨‰ºö‰ΩøÁî®errors.WithStack(err)ÊàñËÄÖerrors.Wrap(err, ‚Äúcustom message‚Äù)ÁöÑÊñπÂºèÔºåÊääÊ≠§ÂàªÁöÑË∞ÉÁî®Ê†àÂä†Âà∞errorÈáåÂéªÔºåÂπ∂‰∏îÂú®Êüê‰∏™Áªü‰∏ÄÂú∞ÊñπËÆ∞ÂΩïÊó•ÂøóÔºåÊñπ‰æøÂºÄÂèëËÄÖÂø´ÈÄüÂÆö‰ΩçÈóÆÈ¢ò„ÄÇ Wrap ÊñπÊ≥ïÁî®Êù•ÂåÖË£ÖÂ∫ïÂ±ÇÈîôËØØÔºåÂ¢ûÂä†‰∏ä‰∏ãÊñáÊñáÊú¨‰ø°ÊÅØÂπ∂ÈôÑÂä†Ë∞ÉÁî®Ê†à„ÄÇ ‰∏ÄËà¨Áî®‰∫éÂåÖË£ÖÂØπÁ¨¨‰∏âÊñπ‰ª£Á†ÅÔºàÊ†áÂáÜÂ∫ìÊàñÁ¨¨‰∏âÊñπÂ∫ìÔºâÁöÑË∞ÉÁî®„ÄÇ WithMessage ÊñπÊ≥ï‰ªÖÂ¢ûÂä†‰∏ä‰∏ãÊñáÊñáÊú¨‰ø°ÊÅØÔºå‰∏çÈôÑÂä†Ë∞ÉÁî®Ê†à„ÄÇ Â¶ÇÊûúÁ°ÆÂÆöÈîôËØØÂ∑≤Ë¢´ Wrap ËøáÊàñ‰∏çÂÖ≥ÂøÉË∞ÉÁî®Ê†àÔºåÂèØ‰ª•‰ΩøÁî®Ê≠§ÊñπÊ≥ï„ÄÇ Ê≥®ÊÑèÔºö‰∏çË¶ÅÂèçÂ§ç Wrap Ôºå‰ºöÂØºËá¥Ë∞ÉÁî®Ê†àÈáçÂ§ç CauseÊñπÊ≥ïÁî®Êù•Âà§Êñ≠Â∫ïÂ±ÇÈîôËØØ „ÄÇ Áé∞Âú®Êàë‰ª¨Áî®Ëøô‰∏â‰∏™ÊñπÊ≥ïÊù•ÈáçÂÜô‰∏äÈù¢ÁöÑ‰ª£Á†ÅÔºö 1234567891011121314151617181920212223242526272829303132333435363738import ( "database/sql" "fmt" "github.com/pkg/errors")func GetSql() error &#123; return errors.Wrap(sql.ErrNoRows, "GetSql failed")&#125;func Call() error &#123; return errors.WithMessage(GetSql(), "bar failed")&#125;func main() &#123; err := Call() if errors.Cause(err) == sql.ErrNoRows &#123; fmt.Printf("data not found, %v\n", err) fmt.Printf("%+v\n", err) return &#125; if err != nil &#123; // unknown error &#125;&#125;/*Output:data not found, Call failed: GetSql failed: sql: no rows in result setsql: no rows in result setmain.GetSql /usr/three/main.go:11main.Call /usr/three/main.go:15main.main /usr/three/main.go:19runtime.main ...*/ ‰ªéËæìÂá∫ÂÜÖÂÆπÂèØ‰ª•ÁúãÂà∞Ôºå ‰ΩøÁî® %v ‰Ωú‰∏∫Ê†ºÂºèÂåñÂèÇÊï∞ÔºåÈÇ£‰πàÈîôËØØ‰ø°ÊÅØ‰ºö‰øùÊåÅ‰∏ÄË°åÔºå ÂÖ∂‰∏≠‰æùÊ¨°ÂåÖÂê´Ë∞ÉÁî®Ê†àÁöÑ‰∏ä‰∏ãÊñáÊñáÊú¨„ÄÇ ‰ΩøÁî® %+v ÔºåÂàô‰ºöËæìÂá∫ÂÆåÊï¥ÁöÑË∞ÉÁî®Ê†àËØ¶ÊÉÖ„ÄÇÂ¶ÇÊûú‰∏çÈúÄË¶ÅÂ¢ûÂä†È¢ùÂ§ñ‰∏ä‰∏ãÊñá‰ø°ÊÅØÔºå‰ªÖÈôÑÂä†Ë∞ÉÁî®Ê†àÂêéËøîÂõûÔºåÂèØ‰ª•‰ΩøÁî® WithStack ÊñπÊ≥ïÔºö 123func GetSql() error &#123; return errors.WithStack(sql.ErrNoRows)&#125; Ê≥®ÊÑèÔºöÊó†ËÆ∫ÊòØ Wrap Ôºå WithMessage ËøòÊòØ WithStack ÔºåÂΩì‰º†ÂÖ•ÁöÑ err ÂèÇÊï∞‰∏∫ nil Êó∂Ôºå ÈÉΩ‰ºöËøîÂõûnilÔºå ËøôÊÑèÂë≥ÁùÄÊàë‰ª¨Âú®Ë∞ÉÁî®Ê≠§ÊñπÊ≥ï‰πãÂâçÊó†ÈúÄ‰Ωú nil Âà§Êñ≠Ôºå‰øùÊåÅ‰∫Ü‰ª£Á†ÅÁÆÄÊ¥Å ÊñπÊ°à 2Ôºögolang.org/x/xerrorsÁªìÂêàÁ§æÂå∫ÂèçÈ¶àÔºåGo Âõ¢ÈòüÂÆåÊàê‰∫ÜÂú® Go 2 ‰∏≠ÁÆÄÂåñÈîôËØØÂ§ÑÁêÜÁöÑÊèêÊ°à„ÄÇ GoÊ†∏ÂøÉÂõ¢ÈòüÊàêÂëò Russ Cox Âú®xerrors‰∏≠ÈÉ®ÂàÜÂÆûÁé∞‰∫ÜÊèêÊ°à‰∏≠ÁöÑÂÜÖÂÆπ„ÄÇÂÆÉÁî®‰∏é github.com/pkg/errorsÁõ∏‰ººÁöÑÊÄùË∑ØËß£ÂÜ≥Âêå‰∏ÄÈóÆÈ¢òÔºå ÂºïÂÖ•‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑ fmt Ê†ºÂºèÂåñÂä®ËØç: %wÔºå‰ΩøÁî® Is ËøõË°åÂà§Êñ≠„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940import ( "database/sql" "fmt" "golang.org/x/xerrors")func Call() error &#123; if err := GetSql(); err != nil &#123; return xerrors.Errorf("bar failed: %w", GetSql()) &#125; return nil&#125;func GetSql() error &#123; return xerrors.Errorf("GetSql failed: %w", sql.ErrNoRows)&#125;func main() &#123; err := Call() if xerrors.Is(err, sql.ErrNoRows) &#123; fmt.Printf("data not found, %v\n", err) fmt.Printf("%+v\n", err) return &#125; if err != nil &#123; // unknown error &#125;&#125;/* Outputs:data not found, Call failed: GetSql failed: sql: no rows in result setbar failed: main.Call /usr/four/main.go:12 - GetSql failed: main.GetSql /usr/four/main.go:18 - sql: no rows in result set*/ ‰∏é github.com/pkg/errors Áõ∏ÊØîÔºåÂÆÉÊúâÂá†ÁÇπ‰∏çË∂≥Ôºö ‰ΩøÁî® : %w ‰ª£Êõø‰∫Ü Wrap Ôºå Áúã‰ººÁÆÄÂåñÔºå ‰ΩÜÂ§±Âéª‰∫ÜÁºñËØëÊúüÊ£ÄÊü•„ÄÇ Â¶ÇÊûúÊ≤°ÊúâÂÜíÂè∑ÔºåÊàñ : %w ‰∏ç‰Ωç‰∫é‰∫éÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÁªìÂ∞æÔºåÊàñÂÜíÂè∑‰∏éÁôæÂàÜÂè∑‰πãÈó¥Ê≤°ÊúâÁ©∫Ê†ºÔºåÂåÖË£ÖÂ∞ÜÂ§±Êïà‰∏î‰∏çÊä•ÈîôÔºõ ËÄå‰∏îÔºåË∞ÉÁî® xerrors.Errorf ‰πãÂâçÈúÄË¶ÅÂØπÂèÇÊï∞ËøõË°ånilÂà§Êñ≠„ÄÇ ËøôÂÆåÂÖ®Ê≤°ÊúâÁÆÄÂåñÂºÄÂèëËÄÖÁöÑÂ∑•‰Ωú ÊñπÊ°à 3ÔºöGo 1.13 ÂÜÖÁΩÆÊîØÊåÅ Go 1.13 Â∞Ü xerrors ÁöÑÈÉ®ÂàÜÂäüËÉΩÔºà‰∏çÊòØÂÖ®ÈÉ®ÔºâÊï¥ÂêàËøõ‰∫ÜÊ†áÂáÜÂ∫ì„ÄÇ ÂÆÉÁªßÊâø‰∫Ü‰∏äÈù¢ÊèêÂà∞ÁöÑ xerrors ÁöÑÂÖ®ÈÉ®Áº∫ÁÇπÔºå Âπ∂È¢ùÂ§ñË¥°ÁåÆ‰∫Ü‰∏ÄÈ°π„ÄÇÂõ†Ê≠§ÁõÆÂâçÊ≤°Êúâ‰ΩøÁî®ÂÆÉÁöÑÂøÖË¶Å„ÄÇ 12345678910111213141516171819202122232425262728293031import ( "database/sql" "errors" "fmt")func Call() error &#123; if err := GetSql(); err != nil &#123; return fmt.Errorf("Call failed: %w", GetSql()) &#125; return nil&#125;func GetSql() error &#123; return fmt.Errorf("GetSql failed: %w", sql.ErrNoRows)&#125;func main() &#123; err := Call() if errors.Is(err, sql.ErrNoRows) &#123; fmt.Printf("data not found, %+v\n", err) return &#125; if err != nil &#123; // unknown error &#125;&#125;/* Outputs:data not found, Call failed: GetSql failed: sql: no rows in result set*/ ‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏é xerrors ÁâàÊú¨ÈùûÂ∏∏Êé•Ëøë„ÄÇ‰ΩÜÊòØÂÆÉ‰∏çÊîØÊåÅË∞ÉÁî®Ê†à‰ø°ÊÅØËæìÂá∫Ôºå Ê†πÊçÆÂÆòÊñπÁöÑËØ¥Ê≥ïÔºå Ê≠§ÂäüËÉΩÊ≤°ÊúâÊòéÁ°ÆÁöÑÊîØÊåÅÊó∂Èó¥„ÄÇÂõ†Ê≠§ÂÖ∂ÂÆûÁî®ÊÄßËøú‰Ωé‰∫é github.com/pkg/errors„ÄÇ Golang ‰∏≠Â∞ÜÊù•ÂèØËÉΩÁöÑÈîôËØØÂ§ÑÁêÜÊñπÂºè Âú®Go 2ÁöÑËçâÊ°à‰∏≠ÔºåÊàë‰ª¨ÁúãÂà∞‰∫ÜÊúâÂÖ≥‰∫éerrorÁõ∏ÂÖ≥ÁöÑ‰∏Ä‰∫õÊèêÊ°àÔºåÈÇ£Â∞±ÊòØcheck/handleÂáΩÊï∞„ÄÇ Êàë‰ª¨‰πüËÆ∏Âú®‰∏ã‰∏Ä‰∏™Â§ßÁâàÊú¨ÁöÑGolangÂèØ‰ª•ÂÉè‰∏ãÈù¢ËøôÊ†∑Â§ÑÁêÜÈîôËØØÔºö 123456789101112131415161718import "fmt"func game() error &#123; handle err &#123; return fmt.Errorf("dependencies error: %v", err) &#125; resource := check findResource() // return resource, error defer func() &#123; resource.Release() &#125;() profile := check loadProfile() // return profile, error defer func() &#123; profile.Close() &#125; // ...&#125; ÊÑüÂÖ¥Ë∂£ÁöÑÂêåÂ≠¶ÂèØ‰ª•ÂÖ≥Ê≥®‰∏ãËøô‰∏™ÊèêÊ°àÔºöhttps://go.googlesource.com/proposal/+/master/design/go2draft-error-handling-overview.md ÂæóÂá∫ÁªìËÆ∫ ÈáçË¶ÅÁöÑÊòØË¶ÅËÆ∞‰ΩèÔºåÂåÖË£ÖÈîôËØØ‰ºö‰ΩøËØ•ÈîôËØØÊàê‰∏∫ÊÇ®APIÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÂ¶ÇÊûúÊÇ®‰∏çÊÉ≥Â∞ÜÊù•Â∞ÜÈîôËØØ‰Ωú‰∏∫APIÁöÑ‰∏ÄÈÉ®ÂàÜÊù•ÊîØÊåÅÔºåÂàô‰∏çÂ∫îÂåÖË£ÖËØ•ÈîôËØØ„ÄÇÊó†ËÆ∫ÊòØÂê¶ÂåÖË£ÖÈîôËØØÔºåÈîôËØØÊñáÊú¨ÈÉΩÂ∞ÜÁõ∏Âêå„ÄÇÈÇ£‰∫õËØïÂõæÁêÜËß£ÈîôËØØÁöÑ‰∫∫Â∞ÜÂæóÂà∞Áõ∏ÂêåÁöÑ‰ø°ÊÅØÔºåÊó†ËÆ∫ÈááÁî®Âì™ÁßçÊñπÂºè; ÊòØÂê¶Ë¶ÅÂåÖË£ÖÈîôËØØÁöÑÈÄâÊã©ÂèñÂÜ≥‰∫éÊòØÂê¶Ë¶ÅÁªôÁ®ãÂ∫èÊèê‰æõÊõ¥Â§ö‰ø°ÊÅØÔºå‰ª•‰æø‰ªñ‰ª¨ÂèØ‰ª•ÂÅöÂá∫Êõ¥ÊòéÊô∫ÁöÑÂÜ≥Á≠ñÔºåËøòÊòØ‰øùÁïôËØ•‰ø°ÊÅØ‰ª•‰øùÁïôÊäΩË±°Â±Ç„ÄÇ ÈÄöËøá‰ª•‰∏äÂØπÊØîÔºå Áõ∏‰ø°‰Ω†Â∑≤ÁªèÊúâ‰∫ÜÈÄâÊã©„ÄÇ ÂÜçÊòéÁ°Æ‰∏Ä‰∏ãÊàëÁöÑÁúãÊ≥ïÔºåÂ¶ÇÊûú‰Ω†Ê≠£Âú®‰ΩøÁî® github.com/pkg/errors ÔºåÈÇ£Â∞±‰øùÊåÅÁé∞Áä∂Âêß„ÄÇÁõÆÂâçËøòÊ≤°ÊúâÊØîÂÆÉÊõ¥Â•ΩÁöÑÈÄâÊã©„ÄÇÂ¶ÇÊûú‰Ω†Â∑≤ÁªèÂ§ßÈáè‰ΩøÁî® golang.org/x/xerrors Ôºå Âà´Áõ≤ÁõÆÊç¢Êàê go 1.13 ÁöÑÂÜÖÁΩÆÊñπÊ°à„ÄÇ ÊÄªÁöÑÊù•ËØ¥ÔºåGo Âú®ËØûÁîü‰πãÂàùÂ∞±Âú®ÂêÑ‰∏™ÊñπÈù¢Ë°®Áé∞ÂæóÁõ∏ÂΩìÊàêÁÜü„ÄÅÁ®≥ÂÅ•„ÄÇ Âú®ÊºîËøõË∑ØÁ∫ø‰∏äÂæàÂ∞ëÂá∫Áé∞ÁäπÁñëÂíåÊëáÊëÜÔºå ËÄåÂú®ÈîôËØØÂ§ÑÁêÜÊñπÈù¢Âç¥ÊòØ‰∏™‰æãÂ§ñ„ÄÇ Èô§‰∫ÜË¢´ÂπøÊ≥õÂêêÊßΩÁöÑ if err != nil ‰πãÂ§ñÔºå Â∞±ËøûÂÖ∂ÊîπËøõË∑ØÁ∫ø‰πüÂ§áÂèó‰∫âËÆÆ„ÄÅÂàÜÊ≠ßÊòéÊòæÔºå‰ª•Ëá¥‰∫é‰∏Ä‰∏™ÊîπËøõÊèêÊ°àÈÉΩ‰ºöÂõ†‰∏∫ÂéãÂÄíÊÄßÁöÑÂèçÂØπÊÑèËßÅËÄå‰∏çÂæó‰∏ç‰ΩúÂá∫Ë∞ÉÊï¥„ÄÇ Â•ΩÂú® Go Âõ¢ÈòüÊØî‰ª•ÂâçÊõ¥Âä†‰πê‰∫éÂÄæÂê¨Á§æÂå∫ÊÑèËßÅÔºåÂõ¢ÈòüÁîöËá≥‰∏ìÈó®Â∞±Ê≠§ÈóÆÈ¢òÂª∫‰∫Ü‰∏™ÂèçÈ¶àÊî∂ÈõÜÈ°µÈù¢„ÄÇÁõ∏‰ø°ÊúÄÁªàÂ§ßÂÆ∂‰ºöÊâæÂà∞Êõ¥Â•ΩÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂÆòÂÆ£Ôºö2019 Âπ¥ Go ÂºÄÂèëËÄÖË∞ÉÊü•Êä•Âëä]]></title>
    <url>%2F2020%2F05%2F10%2F%E5%AE%98%E5%AE%A3%EF%BC%9A2019-%E5%B9%B4-Go-%E5%BC%80%E5%8F%91%E8%80%85%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A%2F</url>
    <content type="text"><![CDATA[2019 Âπ¥ Go ÂºÄÂèëËÄÖË∞ÉÊü• 4Êúà20Êó•ÔºåGo ÂÆòÊñπÈáäÂá∫ 2019 Âπ¥ÁöÑ Go ÂºÄÂèëËÄÖË∞ÉÁ†îÊä•Âëä„ÄÇÂÆòÊñπÈùûÂ∏∏ÊÑüË∞¢ÂèÇ‰∏éÊú¨Ê¨°Ë∞ÉÊü•ÁöÑÊï∞ÂçÉÂêçGoÂºÄÂèë‰∫∫Âëò„ÄÇ Âú®2019Âπ¥ÔºåÂÆòÊñπÊî∂Âà∞‰∫Ü 10,975 ‰ªΩÈóÆÂç∑ÔºåÂá†‰πéÊòØÂéªÂπ¥ÁöÑ‰∏§ÂÄçÔºÅ Âõ¢ÈòüÊàêÂëòÈùûÂ∏∏ÊÑüË∞¢ÂºÄÂèëËÄÖËä±Êó∂Èó¥ÂíåÁ≤æÂäõÂ°´ÂÜôËøô‰ªΩ Go ÂºÄÂèëËÄÖË∞ÉÁ†î„ÄÇ Êú¨Ê¨°Ë∞ÉÁ†îÔºåÂÆòÊñπÊîπËøõ‰∫ÜÂØπÂºÄÊîæÂºè„ÄÅËá™Áî±ÊñáÊú¨ÂõûÁ≠îÁöÑÈóÆÈ¢òÁöÑÂàÜÊûê„ÄÇÂéªÂπ¥‰ΩøÁî®ÁöÑÊòØÊú∫Âô®Â≠¶‰π†Êù•Á≤óÁï•‰ΩÜÂø´ÈÄüÂú∞ÂØπËøô‰∫õÈóÆÂç∑ËøõË°åÂàÜÁ±ª„ÄÇ‰ªäÂπ¥Ôºå‰∏§ÂêçÁ†îÁ©∂‰∫∫ÂëòÊâãÂä®ÂàÜÊûêÂíåÂàÜÁ±ª‰∫ÜËøô‰∫õÈóÆÂç∑ÔºåÂÖÅËÆ∏ËøõË°åÊõ¥ÁªÜËá¥ÁöÑÂàÜÊûêÔºå‰∏éÂéªÂπ¥ÁöÑÊï∞Â≠óËøõË°åÊúâÊïàÁöÑÊØîËæÉ„ÄÇËøô‰∏™ÂèòÂåñÁöÑÁõÆÁöÑÊòØÊèê‰æõ‰∏Ä‰∏™ 2019 Âπ¥‰ª•ÂêéÁöÑÂèØÈù†Âü∫Á∫ø„ÄÇ ‰∏ÄÂàÜÈíüÈÄüËØªËøôÁØáÊñáÁ´†ÂæàÈïø„ÄÇ‰ª•‰∏ãÊòØÊú¨Ê¨°Ë∞ÉÁ†îÁöÑ‰∏ªË¶ÅÁªìËÆ∫: ËøôÊ¨°ÁöÑÂèóËÆøËÄÖÁöÑÂèó‰ºóÁâπÂæÅ‰∏é Stack Overflow ÁöÑË∞ÉÊü•ÂèóËÆøËÄÖÁõ∏‰ººÔºå‰ΩøÂæóËøô‰∫õÁªìÊûúÂèØ‰ª•‰ª£Ë°®Êõ¥Â§öÁöÑ Go ÂºÄÂèë‰∫∫ÂëòÁöÑÂøÉÂ£∞„ÄÇ Â§ßÂ§öÊï∞ÂèóËÆøËÄÖÊØèÂ§©ÈÉΩ‰ΩøÁî® GoÔºåËÄå‰∏îËøô‰∏™Êï∞Â≠óÊØèÂπ¥ÈÉΩÂú®‰∏äÂçá„ÄÇ Go ÁöÑ‰ΩøÁî®‰ªçÈõÜ‰∏≠Âú®ÊäÄÊúØÂÖ¨Âè∏Ôºå‰ΩÜÊòØ Go Âú®Ë∂äÊù•Ë∂äÂ§öÁöÑË°å‰∏ö‰∏≠Ë¢´Áî®Âà∞Ôºå‰æãÂ¶ÇÈáëËûçË°å‰∏öÂíåÂ™í‰ΩìÁõ∏ÂÖ≥„ÄÇ ÂºÄÂèëËÄÖ‰ΩøÁî® Go Ëß£ÂÜ≥ÁöÑÈóÆÈ¢òÂæàÁõ∏‰ººÔºåÂü∫Êú¨ÈõÜ‰∏≠Âú®ÊûÑÂª∫ API, RPC ÊúçÂä°Âíå CLI Â∑•ÂÖ∑„ÄÇ Â§ßÂ§öÊï∞Âõ¢ÈòüÈÉΩËØïÂõæÂ∞ΩÂø´Êõ¥Êñ∞Âà∞ÊúÄÊñ∞ÁöÑ Go ÁâàÊú¨„ÄÇ ‰ΩÜÊòØÁ¨¨‰∏âÊñπ package ÁöÑ provider Êõ¥Êñ∞Âú∞‰ºöÁõ∏ÂØπÊÖ¢‰∏ÄÁÇπ„ÄÇ Áé∞Âú®ÔºåGoÁîüÊÄÅÁ≥ªÁªü‰∏≠ÁöÑÂá†‰πéÊØè‰∏™‰∫∫ÈÉΩÂú®‰ΩøÁî® Go ModulesÔºå‰ΩÜÊòØÁî®Êà∑ÂØπËΩØ‰ª∂ÂåÖÁÆ°ÁêÜÊñπÈù¢‰ªçÁÑ∂Â≠òÂú®Âõ∞ÊÉë„ÄÇ ÊúâÂæÖÊîπËøõÁöÑÈáçÁÇπÈ¢ÜÂüüÂåÖÊã¨ÊîπÂñÑÂºÄÂèë‰∫∫ÂëòÁöÑ debug ‰ΩìÈ™åÔºåGo Modules Âíå cloud service ÊñπÈù¢ÁöÑ‰ΩìÈ™å„ÄÇ VS Code Âíå GoLand ‰ªçÁÑ∂ÊòØÊúÄÂèóÊ¨¢ËøéÁöÑÁºñËæëÂô®ÔºåÂèóËÆøÁöÑÂõõ‰∏™‰∫∫‰∏≠Â∞±Êúâ‰∏â‰∏™Âú®‰ΩøÁî®‰ªñ‰ª¨„ÄÇ ÂèóËÆøÁöÑÂºÄÂèëËÄÖÁæ§‰ΩìÂèóËÆøËÄÖÂÖ¨Âè∏ËßÑÊ®° ÂèóËÆøËÄÖÁöÑÁºñÁ®ãÂ∑•‰ΩúÂπ¥Èôê ÂèóËÆøËÄÖ‰ΩøÁî® Go ÁºñÁ®ãÁöÑÊó∂Èó¥‰ªé‰ΩøÁî® Go ÁöÑÁªèÈ™åÊù•ÁúãÔºåÊàë‰ª¨ÂèëÁé∞Â§ßÂ§öÊï∞ÂèóËÆøËÄÖÔºà56ÔºÖÔºâ‰ΩøÁî® Go ÁöÑÊó∂Èó¥‰∏çÂà∞‰∏§Âπ¥ÔºåÁõ∏ÂØπËæÉÊñ∞„ÄÇ Â§öÊï∞‰∫∫ËøòËØ¥Ôºå‰ªñ‰ª¨Âú®Â∑•‰Ωú‰∏≠Ôºà72ÔºÖÔºâÂíåÂ∑•‰ΩúÂ§ñÔºà62ÔºÖÔºâ‰ΩøÁî®Go„ÄÇ ÂèØ‰ª•ÁúãÂà∞Âú®Â∑•‰Ωú‰∏≠‰ΩøÁî® Go ÁöÑÂèóËÆøËÄÖÊØî‰æãÊØèÂπ¥ÈÉΩÂú®‰∏äÂçá„ÄÇ ÂèóËÆøËÄÖÁöÑÂºÄÂèëËÉåÊôØ ‰ΩøÁî® Go Êó∂Èó¥ËæÉÈïøÁöÑÂèóËÆøËÄÖ‰∏éÊñ∞ÁöÑ Go ÂºÄÂèë‰∫∫ÂëòÁöÑËÉåÊôØ‰∏çÂêå„ÄÇ Ëøô‰∫õ Go ËÄÅÂÖµÊõ¥ÊúâÂèØËÉΩÊã•Êúâ C / C ++ ÁöÑ‰∏ì‰∏öÁü•ËØÜÔºåËÄå‰∏çÂ§™ÂèØËÉΩÂÖ∑Â§á JavaScriptÔºåTypeScript Âíå PHP ÁöÑ‰∏ì‰∏öÁü•ËØÜ„ÄÇ ‰ΩÜÊòØ‰∏çÁÆ°‰ªñ‰ª¨‰ΩøÁî® Go Â∑≤ÊúâÂ§öÈïøÊó∂Èó¥ÔºåPython‰ºº‰πéÈÉΩÊòØÂ§ßÂ§öÊï∞ÂèóËÆøËÄÖÁÜüÊÇâÁöÑËØ≠Ë®ÄÔºà‰∏çÊòØGoü§îÔºâ„ÄÇ ÂèóËÆøËÄÖÊâÄ‰ªé‰∫ãÁöÑË°å‰∏ö ÂéªÂπ¥ÔºåÊàë‰ª¨ËØ¢ÈóÆ‰∫ÜÂèóËÆøËÄÖ‰ªé‰∫ãÂì™‰∫õË°å‰∏öÔºåÂèëÁé∞Â§ßÂ§öÊï∞‰∫∫Âú®ËΩØ‰ª∂Ôºå‰∫íËÅîÁΩëÊàñÁΩëÁªúÊúçÂä°ÂÖ¨Âè∏Â∑•‰Ωú„ÄÇ ‰ªäÂπ¥ÁúãÊù•ÔºåÂèóËÆøËÄÖÊâÄ‰ªé‰∫ãÁöÑË°å‰∏öÊõ¥Âä†ÂπøÊ≥õ‰∫Ü„ÄÇ ÂèóËÆøËÄÖÂØπ Go ÂºÄÊ∫êÈ°πÁõÆÁöÑË¥°ÁåÆ Go ÊòØ‰∏Ä‰∏™ÊàêÂäüÁöÑÂºÄÊ∫êÈ°πÁõÆÔºå‰ΩÜËøôÂπ∂‰∏çÊÑèÂë≥ÁùÄ‰ΩøÁî®ÂÆÉÁöÑÂºÄÂèë‰∫∫Âëò‰πüÊ≠£Âú®ÁºñÂÜô‚Äã‚ÄãÂÖçË¥πÊàñÂºÄÊ∫êËΩØ‰ª∂„ÄÇ ‰∏éÂæÄÂπ¥‰∏ÄÊ†∑ÔºåÊàë‰ª¨ÂèëÁé∞Â§ßÂ§öÊï∞ÂèóËÆøËÄÖÂπ∂‰∏çÊòØ Go ÂºÄÊ∫êÈ°πÁõÆÁöÑÈ¢ëÁπÅË¥°ÁåÆËÄÖÔºåÊúâ 75ÔºÖ ÁöÑÂèóËÆøËÄÖË°®Á§∫‰ªñ‰ª¨‚ÄúÂæàÂ∞ë‚ÄùÊàñ‚Äú‰ªé‰∏ç‚ÄùÂèÇ‰∏é Go ÂºÄÊ∫êÈ°πÁõÆ„ÄÇ ÈöèÁùÄGoÁ§æÂå∫ÁöÑÊâ©Â±ïÔºåÊàë‰ª¨ÂèëÁé∞‰ªéÊú™‰∏∫ Go ÂºÄÊ∫êÈ°πÁõÆÂÅöÂá∫ËøáË¥°ÁåÆÁöÑÂèóËÆøËÄÖÊâÄÂç†ÁöÑÊØî‰æãÊ≠£Âú®ÁºìÊÖ¢‰∏äÂçá„ÄÇ ÂºÄÂèëÂ∑•ÂÖ∑ÁØáÂèóËÆøËÄÖÂºÄÂèë‰∏≠‰ΩøÁî®ÁöÑ OS ‰∏éÂæÄÂπ¥‰∏ÄÊ†∑ÔºåÁªùÂ§ßÂ§öÊï∞ÂºÄÂèëËÄÖË°®Á§∫Âú® Linux Âíå macOS Á≥ªÁªü‰∏ä‰ΩøÁî® Go„ÄÇ ËøôÊòØÊàë‰ª¨ÁöÑÂèóËÆøËÄÖ‰∏éStackOverflowÁöÑ2019 Âπ¥Ë∞ÉÊü•ÁªìÊûú‰πãÈó¥Â≠òÂú®ÂæàÂ§ßÂ∑ÆÂºÇÁöÑ‰∏Ä‰∏™ÊñπÈù¢ÔºöÂú®Êàë‰ª¨ÁöÑË∞ÉÊü•‰∏≠ÔºåÂè™Êúâ20ÔºÖÁöÑÂèóËÆøËÄÖ‰ΩøÁî® Windows ‰Ωú‰∏∫‰∏ªË¶ÅÂºÄÂèëÂπ≥Âè∞ÔºåËÄåÂØπ‰∫é StackOverflow ËÄåË®ÄÔºåËøô‰∏ÄÊØî‰æã‰∏∫ 45ÔºÖ„ÄÇ Linux ÁöÑ‰ΩøÁî®Áéá‰∏∫ 66ÔºÖÔºåmacOS ÁöÑ‰ΩøÁî®Áéá‰∏∫ 53ÔºÖÔºåËøô‰∏§ËÄÖÈÉΩËøúËøúÈ´ò‰∫é StackOverflow ÁöÑÂèó‰ºóÔºåÂêéËÄÖÂàÜÂà´Êä•Âëä‰∫Ü 25ÔºÖ Âíå 30ÔºÖÔºàÁúãÊù• Gopher ËøòÊòØÂñúÊ¨¢ UNIX Â§ö‰∏Ä‰∫õÔºâ„ÄÇ ÂèóËÆøËÄÖ‰ΩøÁî®ÁöÑ IDE ‰ªäÂπ¥ÔºåIDE Êï¥ÂêàÁöÑË∂ãÂäø‰ªçÂú®ÁªßÁª≠„ÄÇ GoLand ‰ªäÂπ¥ÁöÑ‰ΩøÁî®ÈáèÂ¢ûÈïøÊúÄÂø´Ôºå‰ªé 24ÔºÖ ‚Üí 34ÔºÖ ‰∏äÂçá„ÄÇ VS CodeÁöÑÂ¢ûÈïøÈÄüÂ∫¶ÊúâÊâÄÊîæÁºìÔºå‰ΩÜ‰ªçÁÑ∂ÊòØÂèóËÆøËÄÖ‰∏≠ÊúÄÂèóÊ¨¢ËøéÁöÑÁºñËæëÂô®ÔºåÂç†41ÔºÖ„ÄÇ ÁªìÂêàËµ∑Êù•ÔºåËøô‰∏§‰∏™ IDE Áé∞Âú®ÁöÑÂç†ÊúâÁéáÊòØ 75%„ÄÇ ÂÖ≥‰∫éËá™Âª∫ Go document server ‰ªäÂπ¥ÔºåÊàë‰ª¨Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™ÊúâÂÖ≥ÂÜÖÈÉ® Go ÊñáÊ°£Â∑•ÂÖ∑Ôºà‰æãÂ¶Ç gddo ÔºâÁöÑÈóÆÈ¢ò„ÄÇ Â∞ëÊï∞ÂèóËÆøËÄÖÔºà 6ÔºÖ ÔºâË°®Á§∫‰ªñ‰ª¨ÁöÑÁªÑÁªáËøêË°åËá™Â∑±ÁöÑGoÊñáÊ°£ÊúçÂä°Âô®ÔºåÂ∞ΩÁÆ°ÂΩìÊàë‰ª¨Êü•ÁúãÂ§ßÂÖ¨Âè∏ÂèóËÆøËÄÖÔºàÊã•ÊúâËá≥Â∞ë5,000ÂêçÂëòÂ∑•ÔºâÊó∂ÔºåËøô‰∏ÄÊØî‰æãÂá†‰πéÁøª‰∫Ü‰∏ÄÁï™ÔºàËææÂà∞11ÔºÖÔºâÔºå‰ΩÜÂΩìÊàë‰ª¨‰∏éÂêéËÄÖ‰∫§ÊµÅÊó∂Ôºå‰ªñ‰ª¨ËØ¥Âü∫Êú¨Â∑≤ÁªèÂÅúÊ≠¢‰∫ÜËá™Âª∫ document serverÔºåÂéüÂõ†ÊòØÊî∂ÁõäÂ∞èÔºåÊàêÊú¨È´ò„ÄÇ ÂèóËÆøËÄÖÂØπ Go ÁöÑ‰ΩøÁî®ÊÑèÂêë Â§ßÈÉ®ÂàÜÂèóËÆøËÄÖÈÉΩËÆ§‰∏∫ Go Âú®‰ªñ‰ª¨ÁöÑÂõ¢Èòü‰∏≠Ë°®Áé∞ËâØÂ•ΩÔºà86ÔºÖÔºâÔºåÂπ∂‰∏î‰ªñ‰ª¨Â∏åÊúõÂ∞ÜÂÖ∂Áî®‰∫é‰∏ã‰∏Ä‰∏™È°πÁõÆÔºà89ÔºÖÔºâ„ÄÇ Êàë‰ª¨ËøòÂèëÁé∞ÔºåË∂ÖËøá‰∏ÄÂçäÁöÑÂèóËÆøËÄÖÔºà59ÔºÖÔºâËÆ§‰∏∫ Go ÂØπÂÖ∂ÂÖ¨Âè∏ÁöÑÊàêÂäüËá≥ÂÖ≥ÈáçË¶Å„ÄÇ Ëá™2016Âπ¥‰ª•Êù•ÔºåËøô‰∫õÊåáÊ†á‰∏ÄÁõ¥‰øùÊåÅÁ®≥ÂÆö„ÄÇ ÂèóËÆøËÄÖÂØπ Go ÁîüÊÄÅÁöÑÊª°ÊÑèÂ∫¶ Âú® Go ÁîüÊÄÅÁöÑÊª°ÊÑèÂ∫¶‰∏äÔºåÊàë‰ª¨ÁúãÂà∞ÂæàÂ§ßÊØî‰æãÁöÑÂèóËÆøËÄÖÂêåÊÑèÊØèÁßçËØ¥Ê≥ïÔºà82ÔºÖ‚Äì88ÔºÖÔºâÔºåÂπ∂‰∏îÂú®ËøáÂéªÂõõÂπ¥‰∏≠ÔºåËøô‰∫õÊØîÁéáÂú®ÂæàÂ§ßÁ®ãÂ∫¶‰∏ä‰øùÊåÅÁ®≥ÂÆö„ÄÇ ÂèóËÆøËÄÖÊâÄÂú®Ë°å‰∏öÂØπ Go ÁîüÊÄÅÁöÑÊª°ÊÑèÂ∫¶ ‰ªäÂπ¥ÔºåÊàë‰ª¨ÂØπÂêÑ‰∏™Ë°å‰∏öÁöÑÊª°ÊÑèÂ∫¶ËøõË°å‰∫ÜÊõ¥ÁªÜÂæÆÁöÑËÄÉÂØüÔºå‰ª•Âª∫Á´ãÂü∫ÂáÜ„ÄÇ ÊÄª‰ΩìËÄåË®ÄÔºåÊó†ËÆ∫Ë°å‰∏öÂ¶Ç‰ΩïÔºåÂèóËÆøËÄÖÈÉΩÂØπÂú®Â∑•‰Ωú‰∏≠‰ΩøÁî®GoË°®Á§∫Êª°ÊÑè„ÄÇ Êàë‰ª¨Á°ÆÂÆûÂú®Âá†‰∏™È¢ÜÂüüÔºàÂ∞§ÂÖ∂ÊòØÂà∂ÈÄ†‰∏öÔºâ‰∏≠ÁúãÂà∞‰∫Ü‰∏Ä‰∫õ‰∏çÊª°ÔºåÊàë‰ª¨ËÆ°ÂàíÈÄöËøáÂêéÁª≠Á†îÁ©∂ËøõË°åË∞ÉÊü•„ÄÇ ÂèóËÆøËÄÖÂØπ Go ÁâπÊÄßÁöÑÂÖ≥Ê≥®Â∫¶ ÂêåÊ†∑ÔºåÊàë‰ª¨Ë∞ÉÊü•‰∫ÜÂØπ Go ÂºÄÂèëÂêÑ‰∏™ÊñπÈù¢ÁöÑÊª°ÊÑèÂ∫¶‰ª•ÂèäÈáçË¶ÅÊÄß„ÄÇ Â∞ÜËøô‰∫õÁªìÊûúÁªìÂêàÂú®‰∏ÄËµ∑ÂèØ‰ª•Á™ÅÂá∫ÊòæÁ§∫‰∏â‰∏™ÁâπÂà´ÂÖ≥Ê≥®ÁöÑ‰∏ªÈ¢òÔºödebugÔºàÂåÖÊã¨Ë∞ÉËØïÂπ∂ÂèëÊÄßÔºâÔºågo modules Âíå cloud service„ÄÇ Â§ßÂ§öÊï∞‰∫∫ÈÉΩÂ∞ÜËøô‰∫õ‰∏ªÈ¢ò‰∏≠ÁöÑÊØè‰∏Ä‰∏™ËØÑ‰∏∫‚ÄúÈùûÂ∏∏‚ÄùÊàñ‚ÄúËá≥ÂÖ≥ÈáçË¶Å‚ÄùÔºå‰ΩÜ‰∏éÂÖ∂‰ªñ‰∏ªÈ¢òÁõ∏ÊØîÔºåËøô‰∫õÊñπÈù¢ÁöÑÊª°ÊÑèÂ∫¶ÂæóÂàÜÊòéÊòæËæÉ‰Ωé„ÄÇ ÂèóËÆøËÄÖÂØπ Go Á§æÂå∫ÁöÑÊª°ÊÑèÂ∫¶ ‰∏äÈù¢ÁöÑË∞ÉÊü•ÁªìÊûúÂèØËÉΩ‰∏çË∂≥‰∏∫Â•áÔºåÂõ†‰∏∫ÂèÇ‰∏é Go ÂºÄÂèëËÄÖË∞ÉÊü•ÁöÑ‰∫∫‰ª¨ÂñúÊ¨¢ Go ÁöÑÊ¶ÇÁéáÊõ¥Â§ßÔºàÊâãÂä®ÁãóÂ§¥Ôºâ„ÄÇ ‰ΩøÁî® Go ÂÆåÊàêÁöÑÂ∑•‰ΩúÂÜÖÂÆπÊûÑÂª∫API / RPCÊúçÂä°Ôºà71ÔºÖÔºâÂíåCLIÔºà62ÔºÖÔºâ‰ªçÁÑ∂ÊòØ Go ÁöÑÈáçÂ§¥Êàè„ÄÇ Êàë‰ª¨Ë∞ÉÊü•‰∫ÜÂèóËÆøËÄÖ‰ΩøÁî® Go ÁöÑÊõ¥Â§ßÈ¢ÜÂüü„ÄÇ Âà∞ÁõÆÂâç‰∏∫Ê≠¢ÔºåÊúÄÂ∏∏ËßÅÁöÑÈ¢ÜÂüüÊòØ Web ÂºÄÂèëÔºà66ÔºÖÔºâÔºå‰ΩÜÂÖ∂‰ªñÂ∏∏ËßÅÁöÑÈ¢ÜÂüüÂåÖÊã¨Êï∞ÊçÆÂ∫ìÔºà45ÔºÖÔºâÔºåÁΩëÁªúÁºñÁ®ãÔºà42ÔºÖÔºâÔºåÁ≥ªÁªüÁºñÁ®ãÔºà38ÔºÖÔºâÂíå DevOps Ôºà37ÔºÖÔºâ„ÄÇ Go ÂºÄÂèëËøáÁ®ãÁöÑÂ∏∏Áî®ÊäÄÊúØÈô§‰∫ÜÂèóËÆøËÄÖÊ≠£Âú®ÊûÑÂª∫ÁöÑÂÜÖÂÆπ‰πãÂ§ñÔºåÊàë‰ª¨ËøòËØ¢ÈóÆ‰∫Ü‰ªñ‰ª¨‰ΩøÁî®ÁöÑ‰∏Ä‰∫õÂºÄÂèëÊäÄÊúØ„ÄÇ ÁªùÂ§ßÂ§öÊï∞ÂèóËÆøËÄÖË°®Á§∫Ôºå‰ªñ‰ª¨‰æùÈù† log ËøõË°åË∞ÉËØïÔºà88ÔºÖÔºâÔºåËÄå‰ªñ‰ª¨ÁöÑÂõûÁ≠îË°®ÊòéÔºåËøôÊòØÂõ†‰∏∫Êèê‰æõÁöÑË∞ÉËØïÂ∑•ÂÖ∑Èöæ‰ª•ÊúâÊïà‰ΩøÁî®„ÄÇ ‰ΩÜÊòØÔºåÊú¨Âú∞ÈÄêÊ≠•Ë∞ÉËØïÔºà‰æãÂ¶ÇÔºå‰ΩøÁî®DelveÔºâÔºåÊÄßËÉΩÂàÜÊûêÂíå‰ΩøÁî®Á´û‰∫âÊ£ÄÊµãÂô®ËøõË°åÊµãËØïÁöÑÊÉÖÂÜµÂπ∂‰∏çÂ∞ëËßÅÔºåÁ∫¶Êúâ50ÔºÖÁöÑÂèóËÆøËÄÖÂÖ∂‰ΩøÁî®‰∏≠Ëá≥Â∞ë‰∏ÄÁßçÊäÄÊúØ„ÄÇ ÂÖ≥‰∫é Go Modules Âú®ÂåÖÁÆ°ÁêÜÊñπÈù¢ÔºåÊàë‰ª¨ÂèëÁé∞ÁªùÂ§ßÂ§öÊï∞ÂèóËÆøËÄÖ(89%)ÈááÁî®‰∫Ü Go Modules„ÄÇÂØπ‰∫éÂºÄÂèëËÄÖÊù•ËØ¥ÔºåËøôÊòØ‰∏Ä‰∏™Â∑®Â§ßÁöÑËΩ¨ÂèòÔºåÂá†‰πéÊï¥‰∏™Á§æÂå∫ÈÉΩÂú®ÂêåÊó∂ÁªèÂéÜËøô‰∏ÄËΩ¨Âèò„ÄÇ ‰∫ëÂéüÁîüÊó∂‰ª£ÁöÑ GoGoÂú®ËÆæËÆ°Êó∂ËÄÉËôëÂà∞‰∫ÜÁé∞‰ª£ÂàÜÂ∏ÉÂºèËÆ°ÁÆóÔºåÊàë‰ª¨Â∏åÊúõÁªßÁª≠ÊîπËøõ‰ΩøÁî®GoÊûÑÂª∫‰∫ëÊúçÂä°ÁöÑÂºÄÂèë‰∫∫Âëò‰ΩìÈ™å„ÄÇ‰ªäÂπ¥ÔºåÊàë‰ª¨Êâ©Â±ï‰∫ÜÂÖ≥‰∫é‰∫ëÂºÄÂèëÁöÑÈóÆÈ¢òÔºå‰ª•‰æøÊõ¥Â•ΩÂú∞‰∫ÜËß£ÂèóËÆøËÄÖÂ¶Ç‰Ωï‰∏é‰∫ëÊèê‰æõÂïÜÂêà‰ΩúÔºå‰ªñ‰ª¨ÂñúÊ¨¢ÂΩìÂâçÂºÄÂèëËÄÖ‰ΩìÈ™åÁöÑÂì™‰∫õÊñπÈù¢Ôºå‰ª•ÂèäÂì™‰∫õÊñπÈù¢ÂèØ‰ª•ÊîπËøõ„ÄÇ Êàë‰ª¨ÂèØ‰ª•Ê∏ÖÊô∞Âú∞ÊÑüÂèóÂà∞‰ª•‰∏ã‰∏§‰∏™Ë∂ãÂäøÔºö ÂÖ®ÁêÉ‰∏âÂ§ß‰∫ëÊèê‰æõÂïÜÔºàAmazon Web ServicesÔºåGoogle Cloud PlatformÂíåMicrosoft AzureÔºâÂú®ÂèóËÆøËÄÖ‰∏≠ÁöÑ‰ΩøÁî®ÁéáÂùáÂëà‰∏äÂçáË∂ãÂäøÔºåËÄåÂ§ßÂ§öÊï∞ÂÖ∂‰ªñÊèê‰æõÂïÜÊØèÂπ¥‰ΩøÁî®ÁöÑÂèóËÆøËÄÖÊØî‰æãÈÉΩËæÉÂ∞è„ÄÇ Âà∞Ëá™ÊúâÊàñÂÖ¨Âè∏Êã•ÊúâÁöÑÊúçÂä°Âô®ÁöÑÊú¨Âú∞ÈÉ®ÁΩ≤ÁªßÁª≠ÂáèÂ∞ëÔºåÂπ∂‰∏îÂú®ÁªüËÆ°‰∏äÂ∑≤‰∏éAWSÔºà44ÔºÖÊØî42ÔºÖÔºâÁªëÂÆö‰∏∫ÊúÄÂ∏∏ËßÅÁöÑÈÉ®ÁΩ≤Âπ≥Âè∞„ÄÇ Go project ÁöÑÈÉ®ÁΩ≤‰∫ëÂπ≥Âè∞ ÊÄª‰ΩìËÄåË®ÄÔºåÂ§ßÂ§öÊï∞ÂèóËÆøËÄÖÂØπÂú®ÊâÄÊúâ‰∏âÂ§ß‰∏ªË¶Å‰∫ëÊèê‰æõÂïÜ‰∏ä‰ΩøÁî® Go ÊÑüÂà∞Êª°ÊÑè„ÄÇ ÂèóËÆøËÄÖÂÖ∑ÊúâÂØπ GoÔºàAWSÔºâÔºà80ÔºÖÊª°ÊÑèÔºâÂíåGCPÔºà78ÔºÖÔºâÁöÑ Êª°ÊÑèÂ∫¶„ÄÇ Go project ÁöÑÈÉ®ÁΩ≤ÊúçÂä°Á±ªÂûã Â≠òÂú®ÁöÑÁóõÁÇπÂèóËÆøËÄÖË°®Á§∫Êó†Ê≥ï‰ΩøÁî®GoÁöÑ‰∏ªË¶ÅÂéüÂõ†Êúâ‰∏â‰∏™Ôºö Ôºà56ÔºÖÔºâÂΩìÂâçÁöÑÈ°πÁõÆÊ≠£Âú®‰ΩøÁî®ÂÖ∂‰ªñËØ≠Ë®ÄÔºõ Âõ¢ÈòüÊõ¥ÂÄæÂêë‰∫é‰ΩøÁî®ÂÖ∂‰ªñËØ≠Ë®ÄÔºà37ÔºÖÔºâÔºõ GoÊú¨Ë∫´Áº∫‰πè‰∏Ä‰∫õÂÖ≥ÈîÆÂäüËÉΩ Ôºà25ÔºÖÔºâ„ÄÇ ÂØπ‰∏Ä‰∫õ Go ÁâπÊÄßÁöÑÊúüÂæÖ Âú® 25% ÁöÑÂèóËÆøËÄÖ‰∏≠ÔºåËÆ§‰∏∫ Go Áº∫‰πè‰ªñ‰ª¨ÈúÄË¶ÅÁöÑËØ≠Ë®ÄÁâπÊÄß„ÄÇÂÖ∂‰∏≠ 79% ËÆ§‰∏∫Ê≥õÂûãÊòØ‰∏Ä‰∏™‰∏•ÈáçÁº∫Â§±ÁöÑÁâπÊÄß„ÄÇ22% ÁöÑ‰∫∫ÊèêÂà∞‰∫ÜÂØπÈîôËØØÂ§ÑÁêÜÁöÑÊåÅÁª≠ÊîπËøõ(Èô§‰∫Ü Go 1.13 ÁöÑÊõ¥Êîπ‰πãÂ§ñ)Ôºå13 %ÁöÑ‰∫∫Ë¶ÅÊ±ÇÊõ¥Â§öÁöÑÂáΩÊï∞ÂºèÁºñÁ®ãÁâπÊÄßÔºåÂ∞§ÂÖ∂ÊòØÂÜÖÁΩÆÁöÑmap/filter/reduce ÂäüËÉΩ„ÄÇÈúÄË¶ÅËØ¥ÊòéÁöÑÊòØÔºåËøô‰∫õÊï∞Â≠óÊù•Ëá™ÂèóËÆøËÄÖÁöÑÂ≠êÈõÜÔºå‰ªñ‰ª¨Ë°®Á§∫ÔºåÂ¶ÇÊûúÊèê‰æõ‰∫Ü‰ªñ‰ª¨ÈúÄË¶ÅÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÖ≥ÈîÆÂäüËÉΩÔºå‰ªñ‰ª¨Â∞ÜËÉΩÂ§üÊõ¥Â§öÂú∞‰ΩøÁî® Go„ÄÇ Ê≤°Êúâ‰ΩøÁî® Go ‰Ωú‰∏∫È°πÁõÆÁöÑËØ≠Ë®ÄÁöÑ‰∏Ä‰∫õÂéüÂõ† ÂØπ‰∫é‰ªñ‰ª¨ÊâÄ‰ªé‰∫ãÁöÑÂ∑•‰ΩúÊù•ËØ¥ÔºåGo ‚Äú‰∏çÊòØ‰∏ÄÁßçÂêàÈÄÇÁöÑËØ≠Ë®Ä‚ÄùÁöÑÂèóËÆøËÄÖÊúâÂêÑÁßçÂêÑÊ†∑ÁöÑÁêÜÁî±ÂíåÁî®‰æã„ÄÇÊúÄÂ∏∏ËßÅÁöÑÊòØ‰ªñ‰ª¨‰ªé‰∫ãÊüêÁßçÂΩ¢ÂºèÁöÑÂâçÁ´ØÂºÄÂèë(22%)Ôºå‰æãÂ¶ÇÁî®‰∫é web„ÄÅÊ°åÈù¢ÊàñÁßªÂä®ËÆæÂ§áÁöÑg ui„ÄÇÂè¶‰∏Ä‰∏™Â∏∏ËßÅÁöÑÂõûÁ≠îÊòØÔºåÂèóËÆøËÄÖËØ¥‰ªñ‰ª¨Â∑•‰ΩúÁöÑÈ¢ÜÂüü‰∏≠Â∑≤ÁªèÊúâÂç†‰∏ªÂØºÂú∞‰ΩçÁöÑËØ≠Ë®Ä(9%)ÔºåÂõ†Ê≠§ÂæàÈöæ‰ΩøÁî®‰∏çÂêåÁöÑËØ≠Ë®Ä„ÄÇ‰∏Ä‰∫õÂèóËÆøËÄÖËøòÂëäËØâÊàë‰ª¨‰ªñ‰ª¨ÊåáÁöÑÊòØÂì™‰∏™È¢ÜÂüü(ÊàñËÄÖÂè™ÊòØÊèêÂà∞‰∫Ü‰∏Ä‰∏™È¢ÜÂüüÔºåËÄåÊ≤°ÊúâÊèêÂà∞Âè¶‰∏ÄÁßçÊõ¥Â∏∏ËßÅÁöÑËØ≠Ë®Ä)ÔºåÊàë‰ª¨ÈÄöËøá‰∏ãÈù¢ÁöÑ‚ÄúI work on [domain]‚ÄùË°åÊù•ËØ¥ÊòéËøô‰∏ÄÁÇπ„ÄÇÂèóËÆøËÄÖÊèêÂà∞ÁöÑÂè¶‰∏Ä‰∏™‰∏ªË¶ÅÂéüÂõ†ÊòØÈúÄË¶ÅÊõ¥Â•ΩÁöÑÊÄßËÉΩ(9%)ÔºåÂ∞§ÂÖ∂ÊòØÂÆûÊó∂ËÆ°ÁÆó„ÄÇ ÂèóËÆøËÄÖËÆ§‰∏∫ÁõÆÂâçÂ≠òÂú®ÁöÑÊúÄÂ§ßÁöÑÈòªÁ¢ç ÂèóËÆøËÄÖÊä•ÂëäÁöÑÊúÄÂ§ßÈòªÁ¢ç‰∏éÂéªÂπ¥Âü∫Êú¨‰øùÊåÅ‰∏ÄËá¥„ÄÇ Go Áº∫‰πèÊ≥õÂûãÂíåÊ®°ÂùóÔºåÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑‰ªçÁÑ∂ÊòØÊúÄ‰∏ªË¶ÅÁöÑÈóÆÈ¢òÔºàÂàÜÂà´Âç†ÂèçÈ¶àÁöÑ15ÔºÖÂíå12ÔºÖÔºâÔºåÂπ∂‰∏îÂº∫Ë∞ÉÂ∑•ÂÖ∑ÈóÆÈ¢òÁöÑÂèóËÆøËÄÖÊØî‰æãÊúâÊâÄÂ¢ûÂä†„ÄÇ Ëøô‰∫õÊï∞Â≠ó‰∏é‰∏äÈù¢ÁöÑÂõæË°®‰∏çÂêåÔºåÂõ†‰∏∫Ëøô‰∏™ÈóÆÈ¢òÊòØÊâÄÊúâÂèóËÆøËÄÖÈÉΩÊèêÂá∫ÁöÑÔºåÊó†ËÆ∫‰ªñ‰ª¨ËØ¥ÊúÄÂ§ßÁöÑÈòªÁ¢ç‰ªÄ‰πà„ÄÇ Ëøô‰∏â‰∏™ÈóÆÈ¢òÈÉΩÊòØ‰ªäÂπ¥ Go Âõ¢ÈòüÂÖ≥Ê≥®ÁöÑÈ¢ÜÂüüÔºåÊàë‰ª¨Â∏åÊúõÂú®Êú™Êù•Âá†‰∏™ÊúàÂÜÖÊûÅÂ§ßÂú∞ÊîπÂñÑÂºÄÂèë‰∫∫ÂëòÁöÑ‰ΩìÈ™åÔºåÂ∞§ÂÖ∂ÊòØÂú®Ê®°ÂùóÔºåÂ∑•ÂÖ∑ÂíåÂÖ•Èó®ÁªèÈ™åÊñπÈù¢„ÄÇ Debug Go project ÁöÑÁóõÁÇπ ‰ªª‰Ωï‰∏ÄÁßçËØ≠Ë®ÄÁöÑ debug Âíå benchmark ÈÉΩÂÖ∑ÊúâÊåëÊàòÊÄß„ÄÇ ÂèóËÆøËÄÖÂëäËØâÊàë‰ª¨ÔºåËøô‰∏§‰∏™ÊñπÈù¢ÁöÑÊúÄÂ§ßÊåëÊàò‰∏çÊòØ Go ÁöÑÂ∑•ÂÖ∑ÊâÄÁâπÊúâÁöÑÔºåËÄåÊòØ‰∏Ä‰∏™Êõ¥Ê†πÊú¨ÁöÑÈóÆÈ¢òÔºöÁº∫‰πèÁü•ËØÜÔºåÁªèÈ™åÊàñÊúÄ‰Ω≥ÂÆûË∑µ„ÄÇ Êàë‰ª¨Â∏åÊúõÂú®‰ªäÂπ¥Êôö‰∫õÊó∂ÂÄôÈÄöËøáÊñáÊ°£ÂíåÂÖ∂‰ªñÊùêÊñôÊù•Â∏ÆÂä©Ëß£ÂÜ≥Ëøô‰∫õÈóÆÈ¢ò„ÄÇ ÂÖ∂‰ªñ‰∏ªË¶ÅÈóÆÈ¢òÊ∂âÂèäÂà∞Â∑•ÂÖ∑ÁöÑ‰ΩøÁî®ÔºåÂ∞§ÂÖ∂ÊòØÂú®Â≠¶‰π†/‰ΩøÁî® Go ÁöÑË∞ÉËØïÂíå profile ÂàÜÊûêÂ∑•ÂÖ∑Êó∂ÔºåÂú®ÊàêÊú¨/Êî∂ÁõäÊñπÈù¢Â≠òÂú®‰∏çÂà©ÁöÑÊùÉË°°Ôºå‰ª•Âèä‰ΩøÂ∑•ÂÖ∑Âú®ÂêÑÁßçÁéØÂ¢É‰∏≠Â∑•‰ΩúÁöÑÊåëÊàòÔºà‰æãÂ¶ÇÔºåÂú®ÂÆπÂô®‰∏≠ËøõË°åË∞ÉËØïÊàñ‰ªéÁîü‰∫ßÁéØÂ¢É‰∏≠Ëé∑ÂèñÊÄßËÉΩÂàÜÊûêÔºâ„ÄÇ Go communityÂ§ßÁ∫¶‰∏âÂàÜ‰πã‰∫åÁöÑÂèóËÆøËÄÖ‰ΩøÁî® Stack Overflow Êù•ÂõûÁ≠î‰∏é go Áõ∏ÂÖ≥ÁöÑÈóÆÈ¢ò(64%)„ÄÇÂÖ∂‰ªñÊéíÂêçÈù†ÂâçÁöÑÁ≠îÊ°àÊù•Ê∫êÊòØgodoc.org(47%)ÔºåÁõ¥Êé•ÈòÖËØªÊ∫ê‰ª£Á†Å(42%)Âíå golang.org (33%)„ÄÇ ÂÖ≥‰∫é MeetUp‰∏äË°®Á™ÅÂ±ïÁ§∫‰∫Ü‰∏çÂêåÁöÑÂØªÊ±ÇÂ∏ÆÂä©ÁöÑÊñπÂºè(Âá†‰πéÈÉΩÊòØÁ§æÂå∫È©±Âä®ÁöÑ)ÔºåÂèóËÆøËÄÖÂú®‰ΩøÁî®GoÂºÄÂèëËøáÁ®ã‰∏≠‰æùÈù†ÂÆÉ‰ª¨Êù•ÂÖãÊúçÊåëÊàò„ÄÇ‰∫ãÂÆû‰∏äÔºåÂØπ‰∫éËÆ∏Â§ö gopher Êù•ËØ¥ÔºåËøôÂèØËÉΩÊòØ‰ªñ‰ª¨‰∏éÊõ¥Â§ßÁöÑÁ§æÂå∫‰∫íÂä®ÁöÑ‰∏ªË¶ÅË¶ÅÁÇπ‰πã‰∏Ä: ÈöèÁùÄÊàë‰ª¨ÁöÑÁ§æÂå∫‰∏çÊñ≠Êâ©Â§ßÔºåÊàë‰ª¨ÁúãÂà∞Ë∂äÊù•Ë∂äÂ§öÁöÑÂèóËÆøËÄÖ‰∏çÁî®ÂèÇÂä†‰ªª‰Ωï‰∏é go Áõ∏ÂÖ≥ÁöÑÊ¥ªÂä®„ÄÇÂú®2019Âπ¥ÔºåËøô‰∏ÄÊØî‰æãÊé•Ëøë‰∏âÂàÜ‰πã‰∫åÁöÑÂèóËÆøËÄÖ(62%)„ÄÇ ÂèóËÆøËÄÖÁöÑËØ≠Ë®Ä Áî±‰∫éË∞∑Ê≠åÊõ¥Êñ∞‰∫ÜÂÖ®Ë∞∑Ê≠åËåÉÂõ¥ÂÜÖÁöÑÈöêÁßÅÊåáÂçóÔºåÊàë‰ª¨Êó†Ê≥ïÂÜçËØ¢ÈóÆÂèóËÆøËÄÖÁîüÊ¥ªÂú®Âì™‰∏™ÂõΩÂÆ∂„ÄÇÁõ∏ÂèçÔºåÊàë‰ª¨ËØ¢ÈóÆ‰∫ÜÈ¶ñÈÄâÁöÑÂè£ËØ≠/‰π¶Èù¢ËØ≠‰Ωú‰∏∫ Go Âú®ÂÖ®ÁêÉ‰ΩøÁî®ÁöÑÁ≤óÁï•Ë∞ÉÊü•ÔºåËøôÊúâÂä©‰∫é‰∏∫ÊΩúÂú®ÁöÑÊú¨Âú∞ÂåñÂ∑•‰ΩúÊèê‰æõÊï∞ÊçÆ„ÄÇ Áî±‰∫éÊú¨Ê¨°Ë∞ÉÊü•ÊòØÁî®Ëã±ËØ≠ËøõË°åÁöÑÔºåÂõ†Ê≠§ÂØπ‰∫éËÆ≤Ëã±ËØ≠ÁöÑ‰∫∫ÂíåËã±ËØ≠‰∏∫Á¨¨‰∫åÊàñÁ¨¨‰∏âÁßçÂ∏∏ËßÅËØ≠Ë®ÄÁöÑ‰∫∫Áæ§ÂèØËÉΩ‰ºöÊúâÂæàÂ§ßÁöÑËØØÂ∑Æ„ÄÇ Âõ†Ê≠§ÔºåÈùûËã±ËØ≠Êï∞Â≠óÂ∫îËß£Èáä‰∏∫ÂèØËÉΩÁöÑÊúÄÂ∞èÂÄºÔºåËÄå‰∏çÊòØGoÁöÑÂÖ®ÁêÉÂèó‰ºó‰∫∫Êï∞ÁöÑËøë‰ººÂÄº„ÄÇ ConclusionÊàë‰ª¨Â∏åÊúõ‰Ω†‰∫ÜËß£ËøôÊ¨° 2019 Âπ¥ÂºÄÂèëËÄÖË∞ÉÊü•ÁöÑÁªìÊûú„ÄÇ‰∫ÜËß£ÂºÄÂèë‰∫∫ÂëòÁöÑÁªèÈ™åÂíåÊåëÊàòÊúâÂä©‰∫éÊàë‰ª¨‰∏∫ 2020 Âπ¥Âà∂ÂÆöËÆ°ÂàíÂπ∂Á°ÆÂÆöÂ∑•‰ΩúÁöÑ‰ºòÂÖàÁ∫ß„ÄÇÂÜç‰∏ÄÊ¨°ÔºåÈùûÂ∏∏ÊÑüË∞¢ÊâÄÊúâÂèÇ‰∏éË∞ÉÊü•ÁöÑ‰∫∫Ôºå‰Ω†‰ª¨ÁöÑÂèçÈ¶àÂ∞ÜÊúâÂä©‰∫éÂú®Êú™Êù•‰∏ÄÂπ¥ÁîöËá≥Êõ¥ÈïøÁöÑÊó∂Èó¥ÂÜÖÂºïÂØº Go ÂâçËøõÁöÑÊñπÂêë„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊâãÊääÊâãÊïô‰Ω†ÂÆûÁé∞È´òÊÄßËÉΩ kubernetes web terminal]]></title>
    <url>%2F2020%2F04%2F24%2F%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%AE%9E%E7%8E%B0%E9%AB%98%E6%80%A7%E8%83%BD-kubernetes-web-terminal%2F</url>
    <content type="text"><![CDATA[## ## ##]]></content>
  </entry>
  <entry>
    <title><![CDATA[Âπ∂ÂèëËÆøÈóÆ slice Â¶Ç‰ΩïÂÅöÂà∞‰ºòÈõÖÂíåÂÆâÂÖ®Ôºü]]></title>
    <url>%2F2020%2F04%2F22%2F%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE-slice-%E5%A6%82%E4%BD%95%E5%81%9A%E5%88%B0%E4%BC%98%E9%9B%85%E5%92%8C%E5%AE%89%E5%85%A8%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[ÊäõÂá∫ÈóÆÈ¢òÁî±‰∫é slice/map ÊòØÂºïÁî®Á±ªÂûãÔºågolangÂáΩÊï∞ÊòØ‰º†ÂÄºË∞ÉÁî®ÔºåÊâÄÁî®ÂèÇÊï∞ÂâØÊú¨‰æùÁÑ∂ÊòØÂéüÊù•ÁöÑ sliceÔºå Âπ∂ÂèëËÆøÈóÆÂêå‰∏Ä‰∏™ËµÑÊ∫ê‰ºöÂØºËá¥Á´üÊÄÅÊù°‰ª∂„ÄÇ Áúã‰∏ãÈù¢ËøôÊÆµ‰ª£Á†ÅÔºö 123456789101112131415161718192021222324252627282930package mainimport ( "fmt" "sync")func main() &#123; var ( slc = []int&#123;&#125; n = 10000 wg sync.WaitGroup ) wg.Add(n) for i := 0; i &lt; n; i++ &#123; go func() &#123; slc = append(slc, i) wg.Done() &#125;() &#125; wg.Wait() fmt.Println("len:", len(slc)) fmt.Println("done")&#125;// Output:len: 8586done ÁúüÂÆûÁöÑËæìÂá∫Âπ∂Ê≤°ÊúâËææÂà∞Êàë‰ª¨ÁöÑÈ¢ÑÊúüÔºålen(slice) &lt; n„ÄÇ ÈóÆÈ¢òÂá∫Âú®Âì™ÔºüÊàë‰ª¨ÈÉΩÁü•ÈÅìsliceÊòØÂØπÊï∞ÁªÑ‰∏Ä‰∏™ËøûÁª≠ÁâáÊÆµÁöÑÂºïÁî®ÔºåÂΩìsliceÈïøÂ∫¶Â¢ûÂä†ÁöÑÊó∂ÂÄôÔºåÂèØËÉΩÂ∫ïÂ±ÇÁöÑÊï∞ÁªÑ‰ºöË¢´Êç¢Êéâ„ÄÇÂΩìÂá∫Âú®Êç¢Â∫ïÂ±ÇÊï∞ÁªÑ‰πãÂâçÔºåÂàáÁâáÂêåÊó∂Ë¢´Â§ö‰∏™goroutineÊãøÂà∞ÔºåÂπ∂ÊâßË°åappendÊìç‰Ωú„ÄÇÈÇ£‰πàÂæàÂ§ögoroutineÁöÑappendÁªìÊûú‰ºöË¢´Ë¶ÜÁõñÔºåÂØºËá¥n‰∏™gouroutine appendÂêéÔºåÈïøÂ∫¶Â∞è‰∫én„ÄÇ ÈÇ£‰πàÂ¶Ç‰ΩïËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÂë¢Ôºümap Âú® go 1.9 ‰ª•ÂêéÂÆòÊñπÂ∞±ÁªôÂá∫‰∫Ü sync.map ÁöÑËß£ÂÜ≥ÊñπÊ°àÔºå‰ΩÜÊòØÂ¶ÇÊûúË¶ÅÂπ∂ÂèëËÆøÈóÆ slice Â∞±Ë¶ÅËá™Â∑±Â•ΩÂ•ΩËÆæËÆ°‰∏Ä‰∏ã‰∫Ü„ÄÇ‰∏ãÈù¢Êèê‰æõ‰∏§ÁßçÊñπÂºèÔºåÂ∏ÆÂä©‰Ω†Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ ÊñπÊ°à 1: Âä†ÈîÅ üîê1234567891011121314151617181920func main() &#123; slc := make([]int, 0, 1000) var wg sync.WaitGroup var lock sync.Mutex for i := 0; i &lt; 1000; i++ &#123; wg.Add(1) go func(a int) &#123; defer wg.Done() // Âä†üîê lock.Lock() defer lock.Unlock() slc = append(slc, a) &#125;(i) wg.Wait() &#125; fmt.Println(len(slc))&#125; ‰ºòÁÇπÊòØÊØîËæÉÁÆÄÂçïÔºåÈÄÇÂêàÂØπÊÄßËÉΩË¶ÅÊ±Ç‰∏çÈ´òÁöÑÂú∫ÊôØ„ÄÇ ÊñπÊ°à 2Ôºö ‰ΩøÁî® channel ‰∏≤Ë°åÂåñÊìç‰Ωú12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061type ServiceData struct &#123; ch chan int // Áî®Êù• ÂêåÊ≠•ÁöÑchannel data []int // Â≠òÂÇ®Êï∞ÊçÆÁöÑslice&#125;func (s *ServiceData) Schedule() &#123; // ‰ªé channel Êé•Êî∂Êï∞ÊçÆ for i := range s.ch &#123; s.data = append(s.data, i) &#125;&#125;func (s *ServiceData) Close() &#123; // ÊúÄÂêéÂÖ≥Èó≠ channel close(s.ch)&#125;func (s *ServiceData) AddData(v int) &#123; s.ch &lt;- v // ÂèëÈÄÅÊï∞ÊçÆÂà∞ channel&#125;func NewScheduleJob(size int, done func()) *ServiceData &#123; s := &amp;ServiceData&#123; ch: make(chan int, size), data: make([]int, 0), &#125; go func() &#123; // Âπ∂ÂèëÂú∞ append Êï∞ÊçÆÂà∞ slice s.Schedule() done() &#125;() return s&#125;func main() &#123; var ( wg sync.WaitGroup n = 1000 ) c := make(chan struct&#123;&#125;) // new ‰∫ÜËøô‰∏™ job ÂêéÔºåËØ• job Â∞±ÂºÄÂßãÂáÜÂ§á‰ªé channel Êé•Êî∂Êï∞ÊçÆ‰∫Ü s := NewScheduleJob(n, func() &#123; c &lt;- struct&#123;&#125;&#123;&#125; &#125;) wg.Add(n) for i := 0; i &lt; n; i++ &#123; go func(v int) &#123; defer wg.Done() s.AddData(v) &#125;(i) &#125; wg.Wait() s.Close() &lt;-c fmt.Println(len(s.data))&#125; ÂÆûÁé∞Áõ∏ÂØπÂ§çÊùÇÔºå‰ºòÁÇπÊòØÊÄßËÉΩÂæàÂ•ΩÔºåÂà©Áî®‰∫ÜchannelÁöÑ‰ºòÂäø ‰ª•‰∏ä‰ª£Á†ÅÈÉΩÊúâÊØîËæÉËØ¶ÁªÜÁöÑÊ≥®ÈáäÔºåÂ∞±‰∏çÂ±ïÂºÄËÆ≤‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javaËΩ¨goÈÅáÂà∞Apollo?ËÆ©agolloÊù•Â∏Æ‰Ω†Âπ≥ÊªëËøÅÁßª]]></title>
    <url>%2F2020%2F04%2F17%2Fjava%E8%BD%ACgo%E9%81%87%E5%88%B0Apollo-%E8%AE%A9agollo%E6%9D%A5%E5%B8%AE%E4%BD%A0%E5%B9%B3%E6%BB%91%E8%BF%81%E7%A7%BB%2F</url>
    <content type="text"><![CDATA[Introductionagollo ÊòØApolloÁöÑ Golang ÂÆ¢Êà∑Á´Ø ApolloÔºàÈòøÊ≥¢ÁΩóÔºâÊòØÊê∫Á®ãÊ°ÜÊû∂ÈÉ®Èó®Á†îÂèëÁöÑÂàÜÂ∏ÉÂºèÈÖçÁΩÆ‰∏≠ÂøÉÔºåËÉΩÂ§üÈõÜ‰∏≠ÂåñÁÆ°ÁêÜÂ∫îÁî®‰∏çÂêåÁéØÂ¢É„ÄÅ‰∏çÂêåÈõÜÁæ§ÁöÑÈÖçÁΩÆÔºåÈÖçÁΩÆ‰øÆÊîπÂêéËÉΩÂ§üÂÆûÊó∂Êé®ÈÄÅÂà∞Â∫îÁî®Á´ØÔºåÂπ∂‰∏îÂÖ∑Â§áËßÑËåÉÁöÑÊùÉÈôê„ÄÅÊµÅÁ®ãÊ≤ªÁêÜÁ≠âÁâπÊÄßÔºåÈÄÇÁî®‰∫éÂæÆÊúçÂä°ÈÖçÁΩÆÁÆ°ÁêÜÂú∫ÊôØ„ÄÇ Â¶ÇÊûúÂú®‰ΩøÁî® golang ÈáçÊûÑ java ÁöÑËøáÁ®ã‰∏≠Ôºå‰ΩøÁî®Âà∞‰∫ÜÂàÜÂ∏ÉÂºèÈÖçÁΩÆ‰∏≠ÂøÉ ApolloÔºåÈÇ£‰πàÊúÄÂø´ÁöÑÊñπÂºèÂ∞±ÊòØ‰ΩøÁî®ÂéüÊù•ÁöÑÈÖçÁΩÆÔºå‰øùÊåÅÊúÄÂπ≥ÊªëÁöÑËøÅÁßªÔºåËøô‰∏™Êó∂ÂÄô‰Ω†Â∞±ÈúÄË¶Å‰∏Ä‰∏™ Apollo ÁöÑ golang ÂÆ¢Êà∑Á´ØÔºåagollo ÂèØ‰ª•ÊòØ‰Ω†ÁöÑ‰∏Ä‰∏™ÈÄâÊã©„ÄÇ ‰ΩøÁî®ÊåáÂçó1.1.ÁéØÂ¢ÉË¶ÅÊ±Ç Go 1.11+ (ÊúÄÂ•Ω‰ΩøÁî®Go 1.12) 1.2.‰æùËµñ1.2.1.‰ΩøÁî® go get ÊñπÂºè1go get -u github.com/zouyx/agollo/v3@latest 1.2.2.‰ΩøÁî® go mod ÊñπÂºègo.mod1require github.com/zouyx/agollo/v3 latest ÊâßË°å1go mod tidy import123import ( "github.com/zouyx/agollo/v3") FAQ ‰∏∫‰ªÄ‰πàË¶ÅÂä†+incompatible go.mod‰∏çËÉΩ‰∏ãËΩΩagolloÁöÑËß£ÂÜ≥ÊñπÊ≥ï 1.3.ÂøÖË¶ÅËÆæÁΩÆApollo ÂÆ¢Êà∑Á´Ø‰æùËµñ‰∫é AppIdÔºåEnvironment Á≠âÁéØÂ¢É‰ø°ÊÅØÊù•Â∑•‰ΩúÔºåÊâÄ‰ª•ËØ∑Á°Æ‰øùÈòÖËØª‰∏ãÈù¢ÁöÑËØ¥ÊòéÂπ∂‰∏îÂÅöÊ≠£Á°ÆÁöÑÈÖçÁΩÆÔºö main Ôºö your application app.properties (ÂøÖË¶Å) Ôºö ËøûÊé•ÊúçÂä°Á´ØÂøÖË¶ÅÈÖçÁΩÆ seelog.xmlÔºàÈùûÂøÖË¶ÅÔºâ 1.3.1.ÈÖçÁΩÆÂä†ËΩΩ‰ºòÂÖàÁ∫ßÔºö Á±ªÈÖçÁΩÆ ÁéØÂ¢ÉÂèòÈáèÊåáÂÆöÈÖçÁΩÆÊñá‰ª∂ ÈªòËÆ§Ôºàapp.propertiesÔºâÈÖçÁΩÆÊñá‰ª∂ 1.3.1.1.Á±ªÈÖçÁΩÆ‰ºöË¶ÜÁõñapp.properties‰∏≠ÈÖçÁΩÆÔºåÂú®Ë∞ÉÁî®StartÊñπÊ≥ï‰πãÂâçË∞ÉÁî® 12345678910readyConfig:=&amp;AppConfig&#123; AppId:"test1", Cluster:"dev1", NamespaceName:"application1", Ip:"localhost:8889", &#125; InitCustomConfig(func() (*AppConfig, error) &#123; return readyConfig,nil &#125;) Á±ªÈÖçÁΩÆ agollo ÁöÑ demo: 12345678910111213141516171819202122232425262728293031323334353637383940package mainimport ( "fmt" "github.com/zouyx/agollo/v3" "github.com/zouyx/agollo/v3/env/config")func InitAgolloConfig() error &#123; readyConfig := &amp;config.AppConfig&#123; AppID: "test", Cluster: "default", NamespaceName: "application", IP: "localhost:8080", &#125; agollo.InitCustomConfig(func() (*config.AppConfig, error) &#123; return readyConfig, nil &#125;) err := agollo.Start() if err != nil &#123; fmt.Errorf("%v", err) return err &#125; return nil&#125;func main()&#123; //Init Apollo err := config.InitAgolloConfig() if err != nil &#123; fmt.Errorf("ÂàùÂßãÂåñApolloÂ§±Ë¥•", err) panic(err) &#125; fmt.Println("ÂàùÂßãÂåñApolloÈÖçÁΩÆÊàêÂäü") //Use your apollo key to test value := agollo.GetStringValue("key", "") fmt.Println(value)&#125; 1.3.1.2.ÁéØÂ¢ÉÂèòÈáèÊåáÂÆöÈÖçÁΩÆÊñá‰ª∂Linux/Mac1export AGOLLO_CONF=/a/conf.properties Windows1set AGOLLO_CONF=c:/a/conf.properties ÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπ‰∏éapp.propertiesÂÜÖÂÆπ‰∏ÄÊ†∑ 1.3.1.3.Êñá‰ª∂ÈÖçÁΩÆ - app.properties1.ÂºÄÂèë:ËØ∑Á°Æ‰øù app.properties Êñá‰ª∂Â≠òÂú®‰∫éworkingdirÁõÆÂΩï‰∏ã 2.ÊâìÂåÖÂêé:ËØ∑Á°Æ‰øù app.properties Êñá‰ª∂Â≠òÂú®‰∫é‰∏éÊâìÂåÖÁ®ãÂ∫èÂêåÁ∫ßÁõÆÂΩï‰∏ãÔºåÂèÇËÄÉ1.3.ÂøÖË¶ÅÈÖçÁΩÆ„ÄÇ ÁõÆÂâçÂè™ÊîØÊåÅjsonÂΩ¢ÂºèÔºåÂÖ∂‰∏≠Â≠óÊÆµÂåÖÊã¨Ôºö appId ÔºöÂ∫îÁî®ÁöÑË∫´‰ªΩ‰ø°ÊÅØÔºåÊòØ‰ªéÊúçÂä°Á´ØËé∑ÂèñÈÖçÁΩÆÁöÑ‰∏Ä‰∏™ÈáçË¶Å‰ø°ÊÅØ„ÄÇ cluster ÔºöÈúÄË¶ÅËøûÊé•ÁöÑÈõÜÁæ§ÔºåÈªòËÆ§default namespaceName ÔºöÂëΩÂêçÁ©∫Èó¥ÔºåÈªòËÆ§ÔºöapplicationÔºàÂÖ∑‰ΩìÂÆö‰πâÂèÇËÄÉÔºönamespaceÔºâ,Â§önamespace‰ΩøÁî®Ëã±ÊñáÈÄóÂè∑ÂàÜÂâ≤ÔºåÈùûkey/valueÈÖçÁΩÆÔºàjson,properties,ymlÁ≠âÔºâÔºåÂàôÈÖçÁΩÆ‰∏∫Ôºönamespace.Êñá‰ª∂Á±ªÂûã„ÄÇÂ¶ÇÔºönamespace.json ip ÔºöApolloÁöÑCONFIG_SERVICEÁöÑipÔºåÈùûMETA_SERVICEÂú∞ÂùÄ ÈÖçÁΩÆ‰æãÂ≠êÂ¶Ç‰∏ãÔºö ‰∏ÄËà¨ÈÖçÁΩÆ123456&#123; "appId": "test", "cluster": "dev", "namespaceName": "application", "ip": "localhost:8888"&#125; Â§önamespaceÈÖçÁΩÆ123456&#123; "appId": "test", "cluster": "dev", "namespaceName": "application, applications1", "ip": "localhost:8888"&#125; Èùûkey/value namespaceÈÖçÁΩÆ123456&#123; "appId": "test", "cluster": "dev", "namespaceName": "application.json,a.yml", "ip": "localhost:8888"&#125; 1.4Êó•ÂøóÁªÑ‰ª∂ÂèÇËÄÉ: Ëá™ÂÆö‰πâÊó•ÂøóÁªÑ‰ª∂ ‰ΩøÁî®seelogÊó•ÂøóÁªÑ‰ª∂ ÂêØÂä®ÊñπÂºè ÂºÇÊ≠•ÂêØÂä® agollo Âú∫ÊôØÔºöÂêØÂä®Á®ãÂ∫è‰∏ç‰æùËµñÂä†ËΩΩApolloÁöÑÈÖçÁΩÆ„ÄÇ 123func main() &#123; go agollo.Start()&#125; ÂêåÊ≠•ÂêØÂä® agolloÔºàv1.2.0+Ôºâ Âú∫ÊôØÔºöÂêØÂä®Á®ãÂ∫è‰æùËµñÂä†ËΩΩ Apollo ÁöÑÈÖçÁΩÆ„ÄÇ‰æãÔºöÂàùÂßãÂåñÁ®ãÂ∫èÂü∫Á°ÄÈÖçÁΩÆ„ÄÇ 123func main() &#123; agollo.Start()&#125; ÂêØÂä® agollo - Ëá™ÂÆö‰πâ logger Êéß‰ª∂ 123func main() &#123; agollo.StartWithLogger(loggerInterface)&#125; ÂêØÂä® agollo - Ëá™ÂÆö‰πâ cache Êéß‰ª∂ (v1.7.0+) 123func main() &#123; agollo.StartWithCache(cacheInterface)&#125; ÂêØÂä® agollo - Ëá™ÂÆö‰πâÂêÑÁßçÊéß‰ª∂ (v1.8.0+) 12345func main() &#123; agollo.SetLogger(loggerInterface) agollo.SetCache(cacheInterface) agollo.Start()&#125; ÁõëÂê¨ÂèòÊõ¥‰∫ã‰ª∂ÔºàÈòªÂ°ûÔºâ 123456func main() &#123; event := agollo.ListenChangeEvent() changeEvent := &lt;-event bytes, _ := json.Marshal(changeEvent) fmt.Println("event:", string(bytes))&#125; Âü∫Êú¨ÊñπÊ≥ï String 1agollo.GetStringValue(Key,DefaultValue) Int 1agollo.GetIntValue(Key,DefaultValue) Float 1agollo.GetFloatValue(Key,DefaultValue) Bool 1agollo.GetBoolValue(Key,DefaultValue) ÂàáÊç¢namespaceËé∑ÂèñÈÖçÁΩÆ Ê†πÊçÆnamespaceËé∑ÂèñÈÖçÁΩÆ 1config := agollo.GetConfig(namespace) String 1config.GetStringValue(Key,DefaultValue) Int 1config.GetIntValue(Key,DefaultValue) Float 1config.GetFloatValue(Key,DefaultValue) Bool 1config.GetBoolValue(Key,DefaultValue) Ëá™ÂÆö‰πâÊó•ÂøóÁªÑ‰ª∂Â§çÂà∂‰ª•‰∏ã‰ª£Á†ÅËá≥È°πÁõÆ‰∏≠ÔºåÂπ∂Âú®ÂÖ∂‰∏≠ÂºïÁî®Êó•ÂøóÁªÑ‰ª∂ÁöÑÊñπÊ≥ïËøõË°åÊâìÂç∞ log 1234567891011121314151617181920212223242526272829303132333435type DefaultLogger struct &#123;&#125;func (this *DefaultLogger)Debugf(format string, params ...interface&#123;&#125;) &#123;&#125;func (this *DefaultLogger)Infof(format string, params ...interface&#123;&#125;) &#123;&#125;func (this *DefaultLogger)Warnf(format string, params ...interface&#123;&#125;) error &#123; return nil&#125;func (this *DefaultLogger)Errorf(format string, params ...interface&#123;&#125;) error &#123; return nil&#125;func (this *DefaultLogger)Debug(v ...interface&#123;&#125;) &#123;&#125;func (this *DefaultLogger)Info(v ...interface&#123;&#125;)&#123;&#125;func (this *DefaultLogger)Warn(v ...interface&#123;&#125;) error&#123; return nil&#125;func (this *DefaultLogger)Error(v ...interface&#123;&#125;) error&#123; return nil&#125; ÂêØÂä® 1234func main() &#123; agollo.SetLogger(&amp;DefaultLogger&#123;&#125;) agollo.Start()&#125; Ëá™ÂÆö‰πâÁºìÂ≠òÁªÑ‰ª∂Â£∞ÊòéËá™ÂÆö‰πâÁºìÂ≠òÁªÑ‰ª∂12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455//DefaultCache ÈªòËÆ§ÁºìÂ≠òtype DefaultCache struct &#123; defaultCache sync.Map&#125;//Set Ëé∑ÂèñÁºìÂ≠òfunc (d *DefaultCache)Set(key string, value []byte, expireSeconds int) (err error) &#123; d.defaultCache.Store(key,value) return nil&#125;//EntryCount Ëé∑ÂèñÂÆû‰ΩìÊï∞Èáèfunc (d *DefaultCache)EntryCount() (entryCount int64)&#123; count:=int64(0) d.defaultCache.Range(func(key, value interface&#123;&#125;) bool &#123; count++ return true &#125;) return count&#125;//Get Ëé∑ÂèñÁºìÂ≠òfunc (d *DefaultCache)Get(key string) (value []byte, err error)&#123; v, ok := d.defaultCache.Load(key) if !ok&#123; return nil,errors.New("load default cache fail") &#125; return v.([]byte),nil&#125;//Range ÈÅçÂéÜÁºìÂ≠òfunc (d *DefaultCache)Range(f func(key, value interface&#123;&#125;) bool)&#123; d.defaultCache.Range(f)&#125;//Del Âà†Èô§ÁºìÂ≠òfunc (d *DefaultCache)Del(key string) (affected bool) &#123; d.defaultCache.Delete(key) return true&#125;//Clear Ê∏ÖÈô§ÊâÄÊúâÁºìÂ≠òfunc (d *DefaultCache)Clear() &#123; d.defaultCache=sync.Map&#123;&#125;&#125;//DefaultCacheFactory ÊûÑÈÄ†ÈªòËÆ§ÁºìÂ≠òÁªÑ‰ª∂Â∑•ÂéÇÁ±ªtype DefaultCacheFactory struct &#123;&#125;//Create ÂàõÂª∫ÈªòËÆ§ÁºìÂ≠òÁªÑ‰ª∂func (d *DefaultCacheFactory) Create()CacheInterface &#123; return &amp;DefaultCache&#123;&#125;&#125; ‰ΩøÁî®Ëá™ÂÆö‰πâÁºìÂ≠ò12agollo.SetCache(&amp;DefaultCacheFactory&#123;&#125;)agollo.Start() È°πÁõÆÂú∞ÂùÄ: https://github.com/zouyx/agollo ‚Äã ÊñπËµÑËÆØ\ÊúÄÊñ∞ÊäÄÊúØ*Áã¨ÂÆ∂Ëß£ËØª*]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[fuckdb Lite, Â∏ÆÂä©‰Ω†Êõ¥Âø´Âú∞ÁîüÊàêgo struct‰ª£Á†Å]]></title>
    <url>%2F2020%2F04%2F06%2Ffuckdb-Lite-%E5%B8%AE%E5%8A%A9%E4%BD%A0%E6%9B%B4%E5%BF%AB%E5%9C%B0%E7%94%9F%E6%88%90go-struct%E4%BB%A3%E7%A0%81%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä&amp;ËÉåÊôØÂú®golangÁöÑÂºÄÂèëËøáÁ®ã‰∏≠ÔºåÂΩìÊàë‰ª¨‰ΩøÁî®ormÁöÑÊó∂ÂÄôÔºåÂ∏∏Â∏∏ÈúÄË¶ÅÂ∞ÜÊï∞ÊçÆÂ∫ìË°®ÂØπÂ∫îÂà∞golangÁöÑ‰∏Ä‰∏™structÔºåËøô‰∫õstruct‰ºöÊê∫Â∏¶ormÂØπÂ∫îÁöÑtagÔºåÂ∞±ÂÉè‰∏ãÈù¢ÁöÑstructÂÆö‰πâ‰∏ÄÊ†∑Ôºö12345678910111213141516type InsInfo struct &#123; Connections string `gorm:&quot;column:connections&quot;` CPU int `gorm:&quot;column:cpu&quot;` CreateTime time.Time `gorm:&quot;column:create_time&quot;` Env int `gorm:&quot;column:env&quot;` ID int64 `gorm:&quot;column:id;primary_key&quot;` IP string `gorm:&quot;column:ip&quot;` Organization string `gorm:&quot;column:organization&quot;` Pass string `gorm:&quot;column:pass&quot;` Port string `gorm:&quot;column:port&quot;` RegionId string `gorm:&quot;column:regionid&quot;` ServerIP string `gorm:&quot;column:server_ip&quot;` Status int `gorm:&quot;column:status&quot;` Type string `gorm:&quot;column:type&quot;` UUID string `gorm:&quot;column:uuid&quot;`&#125; ËøôÊòØgormÂØπÂ∫îÁöÑÊï∞ÊçÆÂ∫ìË°®ÁöÑstructÊò†Â∞ÑÔºåÂç≥‰ΩøÊï∞ÊçÆË°®ÁöÑÂ≠óÊÆµ‰∏çÂ§öÔºåÂ¶ÇÊûúÊòØÊâãÂä®ÂÜôËµ∑Êù•‰πüÊòØ‰∏Ä‰∫õÈáçÂ§çÊÄßÁöÑÂ∑•‰Ωú„ÄÇÂÉèMySQLËøôÁßçÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÔºåÊàë‰ª¨‰∏ÄËà¨‰ºöÁî®ormÂéªÊìç‰ΩúÊï∞ÊçÆÂ∫ìÔºå‰∫éÊòØÂ∞±ÊÉ≥mysqlÁöÑÊï∞ÊçÆË°®ËÉΩ‰∏çËÉΩÊù•Ëá™Âä®ÁîüÊàêgolang ÁöÑstructÂÆö‰πâ ÔºåÂáèÂ∞ëÈáçÂ§çÊÄßÁöÑÂºÄÂèëÂ∑•‰ΩúÔºàÊó©ÁÇπ‰∏ãÁè≠Ôºâ„ÄÇ Áé∞Áä∂Ë∞ÉÁ†î‰∫Ü‰∏Ä‰∏ãÁõÆÂâçÊúâ‰∏Ä‰∫õÂ∑•ÂÖ∑ÔºåÊØîÂ¶ÇchromeÊèí‰ª∂SQL2Struct(‰∏ÄÊ¨æÊ†πÊçÆsqlËØ≠Âè•Ëá™Âä®ÁîüÊàêgolangÁªìÊûÑ‰ΩìÁöÑchromeÊèí‰ª∂)ÔºåÊÑüËßâÁî®Ëµ∑Êù•ÊØîËæÉÁπÅÁêêÔºåÊØèÊ¨°ÈúÄË¶ÅËøõÂÖ•Êï∞ÊçÆÂ∫ìÔºåÊâßË°åSQLËØ≠Âè•ÊãøÂà∞Âª∫Ë°®ËØ≠Âè•copyÂà∞ÊµèËßàÂô®‰∏≠ÔºåÊâçËÉΩ‰ΩøÁî®„ÄÇÂú®ÊÉ≥ËÉΩ‰∏çËÉΩÊèê‰æõ‰∏Ä‰∏™ÂºÄÁÆ±Âç≥Áî®ÁöÑÁéØÂ¢ÉÔºåÊèê‰æõwebÁïåÈù¢ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÂ°´ÂÜôÊï∞ÊçÆÂ∫ì‰ø°ÊÅØÔºåÂ∞±ÂèØ‰ª•‰∏ÄÈîÆÁîüÊàêÂØπÂ∫îÁöÑORMÁöÑstructÔºå‰∫éÊòØÂ∞±ËØûÁîü‰∫ÜËøô‰∏™È°πÁõÆÔºöhttps://github.com/hantmac/fuckdb ÂéüÁêÜmysqlÊúâ‰∏™Ëá™Â∏¶ÁöÑÊï∞ÊçÆÂ∫ìinformation_schemaÔºåÊúâ‰∏ÄÂº†Ë°®COLUMNSÔºåÂÆÉÁöÑÂ≠óÊÆµÂåÖÂê´Êï∞ÊçÆÂ∫ìÂêç„ÄÅË°®Âêç„ÄÅÂ≠óÊÆµÂêç„ÄÅÂ≠óÊÆµÁ±ªÂûãÁ≠âÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏™Ë°®ÁöÑÊï∞ÊçÆÔºåÊääÂØπÂ∫îÁöÑË°®ÁöÑÂ≠óÊÆµ‰ø°ÊÅØËØªÂèñÂá∫Êù•ÔºåÁÑ∂ÂêéÂÜçÊ†πÊçÆgolangÁöÑËØ≠Ê≥ïËßÑÂàôÔºåÁîüÊàêÂØπÂ∫îÁöÑstruct„ÄÇÂÖ∑‰Ωì‰∏çËØ¶ÁªÜÂ±ïÂºÄ‰∫ÜÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•ÂéªÁúã‰∏ãÊ∫êÁ†Å„ÄÇ Web ÁâàËøûÊé•Êú¨Âú∞Êï∞ÊçÆÂ∫ìÂ¶ÇÊûú‰Ω†ÁöÑÊï∞ÊçÆÂ∫ìÂú®Êú¨Âú∞ÔºåÈÇ£‰πàÂè™ÈúÄË¶ÅÊâßË°å docker-compose up -dÔºåËÆøÈóÆlocalhost:8000Ôºå‰Ω†Â∞±‰ºöÂæóÂà∞‰∏ãÈù¢ÁöÑÁïåÈù¢Ôºö ÊúçÂä°Âô®‰∏äÁöÑÊï∞ÊçÆÂ∫ìÂ¶ÇÊûú‰Ω†ÁöÑÊï∞ÊçÆÂ∫ìÂú®ÂÜÖÁΩëÊúçÂä°Âô®‰∏äÔºå‰Ω†ÈúÄË¶ÅÂÖà‰øÆÊîπÂêéÁ´ØÊé•Âè£ÁöÑip:port,ÁÑ∂ÂêéÈáçÊñ∞build DockerÈïúÂÉèÔºåpushÂà∞Ëá™Â∑±ÁöÑÈïúÂÉè‰ªìÂ∫ìÔºåÁÑ∂Âêé‰øÆÊîπdocker-compose.yamlÔºåÂÜçÊâßË°ådocker-compose up -d„ÄÇ‰øÆÊîπÁöÑ‰ΩçÁΩÆÊòØÔºöfuckdb/frontend/src/config/index.js.1234567891011let APIdb2structif(process.env.NODE_ENV === &quot;development&quot;)&#123; APIdb2struct = &quot;http://0.0.0.0:8000&quot; //‰øÆÊîπ‰∏∫ÈÉ®ÁΩ≤ÊúçÂä°Âô®ÁöÑip&#125;else&#123; APIdb2struct = &quot;http://0.0.0.0:8000&quot; //‰øÆÊîπ‰∏∫ÈÉ®ÁΩ≤ÊúçÂä°Âô®ÁöÑip&#125;export default &#123; APIdb2struct&#125; Âè™ÈúÄË¶ÅÂ°´ÂÖ•Êï∞ÊçÆÂ∫ìÁõ∏ÂÖ≥‰ø°ÊÅØÔºå‰ª•Âèä‰Ω†ÊÉ≥ÂæóÂà∞ÁöÑgolang‰ª£Á†ÅÁöÑpackage name„ÄÅstruct name,ÁÑ∂ÂêéÁÇπÂáªÁîüÊàêÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞gormÂØπÂ∫îÁöÑÁªìÊûÑ‰ΩìÊò†Â∞Ñ„ÄÇ Âú®‰Ω†ÁöÑÈ°πÁõÆÈ°πÁõÆ‰∏≠Âè™Ë¶Å Ctrl+C&amp;Ctrl+V Âç≥ÂèØ„ÄÇÊàë‰ª¨Áü•ÈÅìgolangÁöÑstructÁöÑtagÊúâÂæàÂ§öÂäüËÉΩÔºåËøôÈáå‰πüÊèê‰æõ‰∫ÜÂæàÂ§ötagÁöÑÂèØÈÄâÈ°πÔºåÊØîÂ¶Çjson,xmlÁ≠âÔºåÂêéÈù¢‰ºöÂ¢ûÂä†Êõ¥Â§öÁöÑtagÂèØÈÄâÈ°πÊîØÊåÅ„ÄÇ webÁâàÁöÑÁâπËâ≤ÂäüËÉΩÊòØÊï∞ÊçÆÂ∫ì‰ø°ÊÅØÁºìÂ≠òÂäüËÉΩÔºåËÉΩÂ§üËÆ∞ÂøÜ‰Ω†‰πãÂâçÂ°´ÂÜôËøáÁöÑÊï∞ÊçÆÂ∫ì‰ø°ÊÅØÔºåÁúÅÂéª‰∫ÜÂ§ßÈáèÈáçÂ§çÁöÑÊìç‰ΩúÔºå‰Ω†‰∏çÁî®ÂÜçÂ°´ÂÜôÁπÅÁêêÁöÑÊï∞ÊçÆÂ∫ìÂêçÔºåË°®ÂêçÔºåÂè™ÈúÄ‰∏ÄÈîÆÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞ÂØπÂ∫îÁöÑ‰ª£Á†ÅÔºåÈÖçÂêàÈôÑÂ∏¶json-to-goÊèí‰ª∂(https://github.com/mholt/json-to-go)ÔºåÂºÄÂèëÊïàÁéáÂæóÂà∞ÊûÅÈÄüÊèêÂçá„ÄÇÁõÆÂâçËøô‰∏™Â∑•ÂÖ∑Âú®Êàë‰ª¨ÁªÑÂÜÖÂ∑≤ÁªèÂºÄÂßã‰ΩøÁî®ÔºåÂèçÈ¶àÊØîËæÉÂ•ΩÔºåËäÇÁúÅ‰∫ÜÂæàÂ§öÈáçÂ§çÁöÑÂ∑•‰ΩúÔºåÂ∞§ÂÖ∂ÊòØÂú®ÂºÄÂèëÁöÑÊó∂ÂÄôÁî®Âà∞Âêå‰∏Ä‰∏™Â∫ìÁöÑÂ§öÂº†Ë°®ÔºåÂæàÂø´Â∞±ÂèØ‰ª•ÂÆåÊàêÊï∞ÊçÆÂ∫ìË°®-&gt;strcutÁöÑÊò†Â∞Ñ„ÄÇ Êù•Áúã‰∏ÄÊÆµÊºîÁ§∫ËßÜÈ¢ë„ÄÇ ÊèíÊõ≤ÂâçÂá†Â§©ÊúâÂêåÂ≠¶Êâæ‰∏äÈó®ÔºåËØ¥fuckdbÁöÑwebÁâàÈÉ®ÁΩ≤ÂêéÊó†Ê≥ï‰ΩøÁî®ÔºåËß£ÂÜ≥‰∫ÜÂçäÂ§©‰πüÊ≤°ËÉΩËÆ©Áî®Êà∑ÈÉ®ÁΩ≤Ëµ∑Êù•ÔºåÂèçÈ¶àËøáÊù•ËøòÊòØÊÑüËßâÈÉ®ÁΩ≤Êúâ‰∫õÂ§çÊùÇ„ÄÇÂèçÊÄù‰∫Ü‰∏Ä‰∏ãÔºåÂØπ‰∫é‰∏Ä‰∏™Â∑•ÂÖ∑ÂåñÁöÑËΩØ‰ª∂ÔºåÊúâ‰∫õÁî®Êà∑Âπ∂‰∏çÊÉ≥ÂÅö‰∏Ä‰∫õÂ§çÊùÇÁöÑÈÉ®ÁΩ≤ÊµÅÁ®ãÊàñËÄÖ‰∏çÁÜüÊÇâÈÉ®ÁΩ≤Êìç‰ΩúÔºåÂèØËÉΩÂ∞±ÊòØÊÉ≥ÊöÇÊó∂‰ΩøÁî®‰∏Ä‰∏ãÔºåÊâÄ‰ª•Â∫îËØ•ËÆ©Â∑•ÂÖ∑Êõ¥Âä†ËΩªÈáèÂåñÔºåÊõ¥Âä†ÂºÄÁÆ±Âç≥Áî®Ôºå‰∫éÊòØËøûÂ§úÂÜô‰∫Ü‰∏Ä‰∏™fuckdb lite, Êõ¥ÂÆπÊòì‰∏äÊâã‰ΩøÁî®ÔºåÊõ¥Êñπ‰æøÁöÑÂÆâË£ÖÊµÅÁ®ãÔºå1ÂàÜÈíüÊãøÂà∞‰Ω†ÊÉ≥Ë¶ÅÁöÑ‰ª£Á†Å„ÄÇ fuckdb LiteÂéüÁêÜÂü∫‰∫é cobra(https://github.com/spf13/cobra)ÔºåÊ†∏ÂøÉ‰ª£Á†ÅÁªßÊâøwebÁâà„ÄÇ ÂÆâË£ÖÂê¨ÂèñÁî®Êà∑ÂèçÈ¶àÔºåÂÆâË£ÖÊµÅÁ®ãÊûÅÁÆÄÂåñÔºåMacÁî®Êà∑ÂèØ‰ª•Áõ¥Êé•brew install ÂÆâË£Ö 1brew tap hantmac/tap &amp;&amp; brew install fuckdb LinuxÁî®Êà∑:curl https://github.com/hantmac/fuckdb/releases/download/v0.2/fuckdb_linux.tar.gz ‰∏ãËΩΩ„ÄÅËß£Âéã„ÄÅÂÆâË£Ö windowsÁî®Êà∑emmm, Â∞±ÂéªGitHubÁöÑreleaseÊâãÂä®‰∏ãËΩΩÂêß ‰ΩøÁî®123456789101112131415fuckdb --helpFrom mysql schema generate golang struct with gorm, json tagUsage: fuckdb [command]Available Commands: generate use `fuckdb generate` to generate fuckdb.json go fuckdb go to generate golang struct with gorm and json tag help Help about any commandFlags: -h, --help help for fuckdbUse &quot;fuckdb [command] --help&quot; for more information about a command. ÁõÆÂâçÊèê‰æõ‰∫Ü‰∏§‰∏™‰∏ªË¶ÅÂëΩ‰ª§Ôºåfuckdb generate Âíå fuckdb goÔºåÊàë‰ª¨‰æùÊ¨°Êù•Áúã„ÄÇ 1fuckdb generate ÁîüÊàê‰∏Ä‰∏™Â≠òÂÇ®MySQL‰ø°ÊÅØÁöÑfuckdb.jsonÊñá‰ª∂,ÁºñËæë fuckdb.json ÔºåÂ°´ÂÜô‰Ω†ÁöÑMySQL‰ø°ÊÅØÔºåËØ•Êñá‰ª∂ÂèØÂ§çÁî®ÔºåÁÆÄÂçï‰øÆÊîπË°®ÂêçÂç≥ÂèØ„ÄÇ123456789101112131415&#123; &quot;db&quot;: &#123; &quot;host&quot;: &quot;localhost&quot;, &quot;port&quot;: 3306, &quot;password&quot;: &quot;password&quot;, &quot;user&quot;: &quot;root&quot;, &quot;table&quot;: &quot;tableName&quot;, &quot;database&quot;: &quot;example&quot;, &quot;packageName&quot;: &quot;packageName&quot;, &quot;structName&quot;: &quot;structName&quot;, &quot;jsonAnnotation&quot;: true, &quot;gormAnnotation&quot;: true &#125;&#125;‚Äã ‰øÆÊîπÂÆåÊñá‰ª∂ÂêéÔºåÂ∞±ÂÆåÊàê‰∫ÜÂáÜÂ§áÂ∑•‰ΩúÔºågo go go! ‚ÄãÊâßË°å1fuckdb go Enjoy Your CodeÔºÅ Êù•Áúã‰∏ÄÊÆµÊºîÁ§∫Êìç‰Ωú(ËØ¥Â•Ω‰∏ÄÂàÜÈíüÊãøÂà∞‰ª£Á†ÅÔºåÁªù‰∏çË∂Ö1Áßí) ÊØî‰πãÂâçÁöÑwebÁâàÁöÑÂÆâË£ÖÁÆÄÁõ¥Êñπ‰æø‰∫ÜÂ§™Â§öÔºåÂ¶àÂ¶àÂÜç‰πü‰∏çÁî®ÊãÖÂøÉÊàëÂä†Áè≠Âï¶„ÄÇ ps: fuckdb.jsonÊñá‰ª∂ÂøÖÈ°ªÂú®Êìç‰ΩúÁõÆÂΩï‰∏ã„ÄÇ Ê¨¢ËøéËØïÁî®&amp;ÂèçÈ¶à&amp;Contribute„ÄÇ‰ª£Á†ÅÂú∞ÂùÄÔºöhttps://github.com/hantmac/fuckdb ÂÆòÊñπËµÑËÆØ*ÊúÄÊñ∞ÊäÄÊúØ*Áã¨ÂÆ∂Ëß£ËØª]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Proposals for Go 1.15(ËØë)]]></title>
    <url>%2F2020%2F02%2F01%2FProposals-for-Go-1-15-%E8%AF%91%2F</url>
    <content type="text"><![CDATA[Proposals for Go 1.15(ËØë) Êú¨ÊñáÊòØGolangÂÆòÊñπÂØπ‰∫éGoËøëÊúüÁâàÊú¨ÁöÑÁé∞Áä∂ÊÄªÁªì‰ª•ÂèäGo 1.15ÁâàÊú¨ÁöÑ‰∏Ä‰∫õÊèêÊ°àÔºåÂéüÊñáÂèëÂ∏É‰∫é The Go Blog Robert Griesemer, for the Go team 28 January 2020 Áé∞Áä∂Go 1.14ÁöÑRC1ÁâàÊú¨Â∑≤ÁªèÂáÜÂ§áÂ∞±Áª™ÔºåÂ¶ÇÊûú‰∏ÄÂàáÈ°∫Âà©ÔºåGo 1.14ËÆ°ÂàíÂ∞Ü‰∫é‰ªäÂπ¥2Êúà‰ªΩÂèëÂ∏É„ÄÇÊåâÁÖßGo 2,here we come!ÁöÑËßÑÂàíÔºåÂú®Êàë‰ª¨ÁöÑÂºÄÂèëÂë®Êúü‰∏≠ÂèàÂà∞‰∫ÜËøôÊ†∑ÁöÑ‰∏Ä‰∏™Êó∂ÂàªÔºöËÄÉËôë‰∏ã‰∏Ä‰∏™ÁâàÊú¨‰∏≠ÔºàÊöÇÂÆö‰∫éÂá†Âπ¥8Êúà‰ªΩÂèëÂ∏ÉÁöÑGo 1.15ÔºâÔºåÂà∞Â∫ïË¶ÅÊèê‰æõÂì™‰∫õGolangÊú¨Ë∫´ÊàñËÄÖGo lib‰∏≠ÁöÑÊñ∞ÁâπÊÄß„ÄÇ ÂΩìÂâçÁâàÊú¨ÁöÑGoÁöÑ‰ºòÂåñÁõÆÊ†á‰ªçÁÑ∂Âõ¥ÁªïÁùÄËΩØ‰ª∂ÂåÖÂíåÁâàÊú¨ÁÆ°ÁêÜÔºåÊõ¥Â•ΩÁöÑÈîôËØØÂ§ÑÁêÜÊîØÊåÅ‰ª•ÂèäÊ≥õÂûãÁâπÊÄß„ÄÇGo Module ÁõÆÂâç‰ΩøÁî®Áä∂ÊÄÅÊØîËæÉÂ•ΩÔºåÂπ∂‰∏îÊØèÂ§©ÈÉΩÂú®‰∏çÊñ≠ÂÆåÂñÑÔºåÂØπÊ≥õÂûãÁöÑÊîØÊåÅ‰πüÊúâ‰∏Ä‰∫õÊé®ËøõÔºà‰ªäÂπ¥Êôö‰∫õÊó∂ÂÄô‰ºöÊúâÊõ¥Â§öËøõÂ±ïÔºâ„ÄÇ‰∏∫‰∫ÜÊèê‰æõÊõ¥Â•ΩÁöÑÈîôËØØÂ§ÑÁêÜÊú∫Âà∂ÔºåÂ§ßÁ∫¶Âú®7‰∏™ÊúàÂâçÊàë‰ª¨ÊèêÂá∫‰∫Ütry_proposalÁöÑÊèêÊ°àÔºåÊúâÂ∞ëÈÉ®ÂàÜ‰∫∫ÊîØÊåÅËØ•ÊèêÊ°àÔºå‰ΩÜÊòØÂ§ßÈÉ®ÂàÜËøòÊòØÊåÅÂº∫ÁÉàÁöÑÂèçÂØπÊÄÅÂ∫¶Ôºå‰∫éÊòØÊàë‰ª¨ÂÜ≥ÂÆöÊîæÂºÉËøô‰∏™ÊÉ≥Ê≥ï„ÄÇÂú®Ê≠§‰πãÂêéÔºå‰πüÊúâËÆ∏Â§öÂª∫ËÆÆÔºå‰ΩÜÂÆÉ‰ª¨Êúâ‰∫õÈÉΩÊ≤°ÊúâË∂≥Â§üÁöÑËØ¥ÊúçÂäõÔºåÊúâ‰∫õËøò‰∏çÂ¶Çtry_proposal„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÊöÇÊó∂Ê≤°ÊúâËøõ‰∏ÄÊ≠•ÁöÑËÆ°ÂàíÂéªÊîπÂñÑÈîôËØØÂ§ÑÁêÜÊú∫Âà∂Ôºå‰πüËÆ∏Êú™Êù•‰ºöÂá∫Áé∞‰∏Ä‰∫õÊØîËæÉÂ•ΩÁöÑÁÇπÂ≠êÂ∏ÆÂä©Êàë‰ª¨Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ ÊèêÊ°àÈâ¥‰∫éGo ModuleÂíåÊ≥õÂûãÊ≠£Âú®ÁßØÊûÅÁöÑÊé®Ëøõ‰∏≠Ôºå‰∏îÈîôËØØÂ§ÑÁêÜÊú∫Âà∂Ê≤°ÊúâËøõ‰∏ÄÊ≠•ÁöÑËÆ°ÂàíÔºåÈÇ£‰πàËøòÊúâÂì™‰∫õÁâπÊÄßÂÄºÂæóÊàë‰ª¨ÂéªÂÖ≥Ê≥®Âë¢ÔºüÂ¶ÇÊûúÈùûË¶ÅËØ¥ÊúâÁöÑËØùÔºåÊúâ‰∏Ä‰∫õÁºñÁ®ãËØ≠Ë®Ä‰∏≠Áªè‰πÖ‰∏çË°∞ÁöÑÁâπÊÄßÔºå‰æãÂ¶ÇÊûö‰∏æÁ±ªÂûãÂíå‰∏çÂèØÂèòÁ±ªÂûãÁöÑÈúÄÊ±ÇÔºå‰ΩÜÊòØËøô‰∫õideaËøòÊ≤°ÊúâË¢´GoÂõ¢ÈòüÊ∑±ÂÖ•Âú∞ÊÄùËÄÉÔºåÊâÄ‰ª•GoÂõ¢Èòü‰πüÊ≤°ÊúâÊäïÂÖ•ËøáÂ§öÁ≤æÂäõÂú®ÂÖ∂‰∏≠ÔºåÂ∞§ÂÖ∂ÊòØÊîπËøõËøô‰∫õËØ≠Ë®ÄÁâπÊÄßÈúÄË¶ÅÂæàÂ§ßÁöÑÊàêÊú¨„ÄÇ Go team‰∏çÂ∏åÊúõÂú®Ê≤°ÊúâÈïøÊúüËÆ°ÂàíÁöÑÊÉÖÂÜµ‰∏ãÂ¢ûÊ∑ªÂæàÂ§öÊñ∞ÁöÑÁâπÊÄßÔºåÂú®ÂÆ°Ê†∏‰∫ÜÂ§ßÈáèÂèØË°åÁöÑÊèêÊ°à‰πãÂêéÔºåGo Âõ¢ÈòüÂæóÂá∫ÁªìËÆ∫ÔºöËøô‰∏ÄÊ¨°‰∏çËøõË°åÈáçÂ§ßÊõ¥Êîπ„ÄÇÁõ∏ÂèçÔºåÊàë‰ª¨‰ºöÈõÜ‰∏≠Á≤æÂäõÂÅö‰∏Ä‰∫õÊñ∞ÁöÑ go vetÊîØÊåÅÂíåËØ≠Ë®ÄÂ±ÇÈù¢ÁöÑ‰∏Ä‰∏ãÂ∞èË∞ÉÊï¥„ÄÇÊàë‰ª¨ÈÄâÊã©‰∫Ü‰ª•‰∏ã‰∏â‰∏™ÊèêÊ°àÔºö #32479 go vet‰∏≠ÊîØÊåÅstring(int) ËΩ¨Êç¢ÁöÑÊ£ÄÊµã Êàë‰ª¨ÂéüËÆ°ÂàíÂú®Âç≥Â∞ÜÂèëÂ∏ÉÁöÑGo 1.14ÁâàÊú¨‰∏≠ÂÆûÁé∞ËØ•ÂäüËÉΩÔºå‰ΩÜÊàë‰ª¨Âπ∂Ê≤°ÊúâËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÊâÄ‰ª•ÊîæÂú®Go 1.15‰∏≠Ëß£ÂÜ≥„ÄÇstring(int) ËΩ¨Êç¢Âú®ÂæàÊó©ÁöÑGoÁâàÊú¨‰∏≠Â∞±Â∑≤ÁªèÂºïÂÖ•‰∫ÜÔºå‰ΩÜÊòØÊúâ‰∫õÁâπÊÄßÔºàstring(10)ÊòØ‚Äù\n‚ÄùÔºåÂπ∂‰∏çÊòØ‚Äù10‚ÄùÔºâ‰ºöËÆ©GoÊñ∞ÊâãËø∑ÊÉëÔºåÂπ∂‰∏îunicode/utf8ÂåÖ‰∏≠‰πüÂ∑≤ÁªèÊèê‰æõ‰∫ÜËØ•ÂäüËÉΩ„ÄÇËá™‰ªéremoving this coversionÁöÑÊèêÊ°à‰∏çÊòØ‰∏Ä‰∏™ÂêëÂêéÂÖºÂÆπÁöÑÊîπÂèòÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂú®go vet‰∏≠Êèê‰æõstring(int)ÁöÑÈîôËØØÊ£ÄÊµãËÉΩÂäõ„ÄÇ #4483 go vet‰∏≠ÊîØÊåÅÈîôËØØÁöÑx.(T)ÁöÑÁ±ªÂûãÊñ≠Ë®Ä ÂΩìÂâçÔºåGoÂÖÅËÆ∏‰ªª‰ΩïÁ±ªÂûãÊñ≠Ë®Äx.(T)Ôºà‰ª•ÂèäÁõ∏Â∫îÁöÑÁ±ªÂûãÂàáÊç¢ÊÉÖÂÜµÔºâÔºåÂÖ∂‰∏≠xÂíåT‰∏∫Êé•Âè£Á±ªÂûã„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûúxÂíåTÊúâÁõ∏ÂêåÂêçÂ≠óÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØÁ≠æÂêç‰∏çÂêåÔºåÂàôÂàÜÈÖçÁªôxÁöÑ‰ªª‰ΩïÂÄº‰πü‰∏çËÉΩÂÆûÁé∞TÔºàËøôÁßçÁ±ªÂûãÁöÑÊñ≠Ë®ÄÂú®ËøêË°åÊó∂ÊÄªÊòØÂ§±Ë¥•ÔºåpanicÊàñevaluate to falseÔºâ„ÄÇÂõ†‰∏∫Êàë‰ª¨Âú®ÁºñËØëÊó∂Â∞±Áü•ÈÅìËøô‰∏ÄÁÇπÔºåÊâÄ‰ª•ÁºñËØëÂô®‰ºöÊä•ÂëäÈîô„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÁºñËØëÊä•Èîô‰∏çÊòØÂêëÂêéÂÖºÂÆπÁöÑÔºåÂõ†Ê≠§Êàë‰ª¨‰πüÂ∞ÜÂú®go vet‰∏≠Ê∑ªÂä†ÂØπËØ•ÊÉÖÂÜµÁöÑÊ£ÄÊü•„ÄÇ #28591 ‰ΩøÁî®Â∏∏ÈáèÂ≠óÁ¨¶‰∏≤ÂíåÁ¥¢ÂºïËøõË°åÂ∏∏ÈáèÊ±ÇÂÄºÁöÑÁ¥¢ÂºïÂíåÂàáÁâáË°®ËææÂºè ÂΩìÂâçÔºåÁî®‰∏Ä‰∏™ÊàñÂ§ö‰∏™Â∏∏ÈáèÁ¥¢ÂºïÂØπÂ∏∏ÈáèÂ≠óÁ¨¶‰∏≤ËøõË°åÁ¥¢ÂºïÊàñÂàáÁâá‰ºöÂàÜÂà´‰∫ßÁîü‰∏Ä‰∏™ÈùûÂ∏∏ÈáèÂ≠óËäÇÊàñÂ≠óÁ¨¶‰∏≤ÂÄº„ÄÇ ‰ΩÜÊòØÔºåÂ¶ÇÊûúÊâÄÊúâÊìç‰ΩúÊï∞ÈÉΩÊòØÂ∏∏ÈáèÔºåÂàôÁºñËØëÂô®ÂèØ‰ª•ÂØπËøô‰∫õË°®ËææÂºèËøõË°åÂ∏∏ÈáèÊ±ÇÂÄºÔºåÂπ∂ÁîüÊàêÂ∏∏ÈáèÔºàÂèØËÉΩÊòØÊó†Á±ªÂûãÁöÑÔºâÁªìÊûú„ÄÇ ËøôÊòØÂÆåÂÖ®ÂêëÂêéÂÖºÂÆπÁöÑÊõ¥ÊîπÔºåÊàë‰ª¨Â∞ÜÂØπÂºÄÂèëËßÑËåÉÂíåÁºñËØëÂô®ËøõË°åÂøÖË¶ÅÁöÑË∞ÉÊï¥„ÄÇ Êó∂Èó¥Á∫øGo teamËÆ§‰∏∫Ëøô‰∏â‰∏™ÊèêÊ°àÂ∫îËØ•ÊòØÊ≤°Êúâ‰ªÄ‰πà‰∫âËÆÆÁöÑÔºå‰ΩÜÊòØ‰∫∫ÈùûÂú£Ë¥§Â≠∞ËÉΩÊó†ËøáÔºåÂõ†Ê≠§Êàë‰ª¨ËÆ°ÂàíÂú®Go 1.15ÁöÑÂèëÂ∏ÉÂë®ÊúüÂºÄÂèë(Go 1.14ÂèëÂ∏ÉÊó∂Êàñ‰πãÂêé)ÂºÄÂßãÈááÁ∫≥ÂºÄÂèëËÄÖÂØπËØ•‰∏â‰∏™ÊèêÊ°àÁöÑÂª∫ËÆÆÔºå‰ª•‰æøÊúâË∂≥Â§üÁöÑÊó∂Èó¥Êî∂ÈõÜÂèçÈ¶à„ÄÇÂú®proposal evalution processÔºåÊúÄÁªàÁöÑÊèêÊ°àÂ∞ÜÂú®2020Âπ¥5ÊúàÂàùÂÜ≥ÂÆö„ÄÇ One more thing‚Ä¶Êàë‰ª¨Êî∂Âà∞‰∫ÜÂ§ßÈáèÁöÑËØ≠Ë®ÄÁâπÊÄß‰øÆÊ≠£ÁöÑÊèêÊ°à(issue label LanguageChange)Ôºå‰ΩÜÊòØÊàë‰ª¨Ê≤°ÊúâÊó∂Èó¥Âéª‰ªîÁªÜÂú∞ÂΩªÂ∫ïÂú∞ËØÑ‰º∞„ÄÇ‰∏æ‰∏™Ê†óÂ≠êÔºåÂçïÊòØÂÖ≥‰∫éÈîôËØØÂ§ÑÁêÜÊú∫Âà∂ÁöÑÊèêÊ°àÔºåÂ∞±Êúâ57‰∏™issueÔºåÂà∞ÁõÆÂâç‰∏∫Ê≠¢ËøòÊúâ5‰∏™Â§Ñ‰∫éopenÁöÑÁä∂ÊÄÅ„ÄÇÁî±‰∫éËøõË°åËØ≠Ë®ÄÊõ¥ÊîπÁöÑÊàêÊú¨ÔºåÊó†ËÆ∫Â§ßÂ∞èÂ¶Ç‰ΩïÔºåÂØπ‰∫éÂºÄÂèëËÄÖÊù•ËØ¥ÂÖ∂ÂÆûÈÉΩÂæàÈ´òÔºåËÄå‰∏îÊî∂ÁõäÂæÄÂæÄÂæàÂ∞èÔºåÂõ†Ê≠§Êàë‰ª¨ÂøÖÈ°ªË∞®ÊÖéË°å‰∫ã„ÄÇÁî±‰∫éÂ§ßÂ§öÊï∞ÊèêÊ°àÂèçÈ¶àÁöÑ‰∫∫Êï∞ÂæàÂ∞ëÔºåËøô‰∫õÊèêÊ°àÈÉΩ‰ºöÈÅ≠Âà∞ÊãíÁªù„ÄÇ‰ΩÜÊòØÊúâ‰∫õÂºÄÂèëËÄÖËä±Ë¥π‰∫ÜÂ§ßÈáèÊó∂Èó¥ÂéªÂÜôÊèêÊ°àÁöÑÁªÜËäÇÔºåÂà∞Â§¥Êù•ËøòÊòØË¢´ÊãíÔºõÂè¶‰∏ÄÊñπÈù¢ÔºåÁî±‰∫éÊÄª‰ΩìÊèêÊ°àÊµÅÁ®ãÊØîËæÉÁÆÄÂçïÔºåÂõ†Ê≠§Êèê‰∫§‰∏Ä‰∫õÊó†ÂÖ≥Á¥ßË¶ÅÁöÑËØ≠Ë®ÄÂèòÊõ¥ÊèêÊ°àÈùûÂ∏∏ÂÆπÊòìÔºå‰ªéËÄåÁªôÂÆ°Ê†∏ÂßîÂëò‰ºöÂ∏¶Êù•Â§ßÈáè‰∏çÂøÖË¶ÅÁöÑÂ∑•‰ΩúÔºå‰πüÊúâÂèØËÉΩÂüãÊ≤°ÊØîËæÉÂ•ΩÁöÑÊèêÊ°à„ÄÇ‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÊàë‰ª¨Êñ∞Â¢û‰∫Ü‰∏Ä‰∏™ÂÖ≥‰∫éGoÊèêÊ°àÁöÑÈóÆÂç∑ÔºöÂ°´ÂÜôËØ•Ê®°ÊùøÂ∞ÜÊúâÂä©‰∫éÂÆ°Ê†∏ËÄÖÊõ¥ÊúâÊïàÂú∞ËØÑ‰º∞ÊèêÊ°àÔºåÂõ†‰∏∫‰ªñ‰ª¨Êó†ÈúÄÂ∞ùËØïËá™Â∑±ÂõûÁ≠îËøô‰∫õÈóÆÈ¢ò„ÄÇ ÂÆÉËÉΩ‰ªé‰∏ÄÂºÄÂßãÂ∞±ËÆæÂÆö‰∏Ä‰∫õÈôêÂà∂Ôºå‰ªéËÄå‰∏∫ÊèêËÆÆËÄÖÊèê‰æõÊõ¥Â•ΩÁöÑÊåáÂØº„ÄÇ ËøôÊòØ‰∏Ä‰∏™ÂÆûÈ™åÊÄßÁöÑÂ∞ùËØïÔºåÊàë‰ª¨‰ºöÊ†πÊçÆÈúÄË¶ÅÈöèÁùÄÊó∂Èó¥ÁöÑÊé®ÁßªËøõË°åÂÆåÂñÑ„ÄÇ ÊÑüË∞¢ÊÇ®Â∏ÆÂä©Êàë‰ª¨ÊîπÂñÑGoÁöÑ‰ΩìÈ™åÔºÅ ÂéüÊñáÂú∞ÂùÄÔºöhttps://blog.golang.org/go1.15-proposals]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Go GC 20ÈóÆ]]></title>
    <url>%2F2020%2F01%2F06%2FGo-GC-20%E9%97%AE%2F</url>
    <content type="text"><![CDATA[Go GC 20 ÈóÆÂéüÂàõÔºö Ê¨ßÈïøÂù§ Á†ÅÂÜúÊ°ÉËä±Ê∫ê https://mp.weixin.qq.com/s/o2oMMh0PF5ZSoYD0XOBY2Q Êú¨Êñá‰ΩúËÄÖÊ¨ßÈïøÂù§ÔºåÂæ∑ÂõΩÊÖïÂ∞ºÈªëÂ§ßÂ≠¶Âú®ËØªÂçöÂ£´ÔºåGo/etcd/Tensorflow contributorÔºåÂºÄÊ∫ê‰π¶Á±ç„ÄäGo ËØ≠Ë®ÄÂéüÊú¨„Äã‰ΩúËÄÖÔºå„ÄäGo Â§úËØª„ÄãSIG ÊàêÂëò/ËÆ≤Â∏àÔºåÂØπ Go ÊúâÂæàÊ∑±ÁöÑÁ†îÁ©∂„ÄÇGithubÔºö@changkunÔºåhttps://changkun.de„ÄÇ Êú¨ÊñáÈ¶ñÂèë‰∫é Github ÂºÄÊ∫êÈ°πÁõÆ „ÄäGo-Questions„ÄãÔºåÁÇπÂáªÈòÖËØªÂéüÊñáÁõ¥Ëææ„ÄÇÂÖ®Êñá‰∏çËÆ°‰ª£Á†ÅÔºåÂÖ± 1.7w+ Â≠óÔºåÂª∫ËÆÆÊî∂ËóèÂêéÁ≤æËØª„ÄÇÂè¶Â§ñÔºåÊú¨ÊñáÁªìÂ∞æÊúâÂΩ©Ëõã„ÄÇ ÊåâÊÉØ‰æãÔºåË¥¥‰∏äÊú¨ÊñáÁöÑÁõÆÂΩïÔºö Êú¨ÊñáÂÜô‰∫é Go 1.14 beta1ÔºåÂΩìÊñá‰∏≠ÊèêÂèäÁõÆÂâç„ÄÅÁõÆÂâçÁâàÊú¨Á≠âÂ≠óÁúºÊó∂ÂùáÊåá Go 1.14ÔºåÊ≠§Â§ñÔºåÊñá‰∏≠ÊâÄÊúâ go ÂëΩ‰ª§ÁâàÊú¨Âùá‰∏∫ Go 1.14„ÄÇ GC ÁöÑËÆ§ËØÜ1. ‰ªÄ‰πàÊòØ GCÔºåÊúâ‰ªÄ‰πà‰ΩúÁî®ÔºüGCÔºåÂÖ®Áß∞ Garbage CollectionÔºåÂç≥ÂûÉÂúæÂõûÊî∂ÔºåÊòØ‰∏ÄÁßçËá™Âä®ÂÜÖÂ≠òÁÆ°ÁêÜÁöÑÊú∫Âà∂„ÄÇ ÂΩìÁ®ãÂ∫èÂêëÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑ÁöÑÂÜÖÂ≠ò‰∏çÂÜçÈúÄË¶ÅÊó∂ÔºåÂûÉÂúæÂõûÊî∂‰∏ªÂä®Â∞ÜÂÖ∂ÂõûÊî∂Âπ∂‰æõÂÖ∂‰ªñ‰ª£Á†ÅËøõË°åÂÜÖÂ≠òÁî≥ËØ∑Êó∂ÂÄôÂ§çÁî®ÔºåÊàñËÄÖÂ∞ÜÂÖ∂ÂΩíËøòÁªôÊìç‰ΩúÁ≥ªÁªüÔºåËøôÁßçÈíàÂØπÂÜÖÂ≠òÁ∫ßÂà´ËµÑÊ∫êÁöÑËá™Âä®ÂõûÊî∂ËøáÁ®ãÔºåÂç≥‰∏∫ÂûÉÂúæÂõûÊî∂„ÄÇËÄåË¥üË¥£ÂûÉÂúæÂõûÊî∂ÁöÑÁ®ãÂ∫èÁªÑ‰ª∂ÔºåÂç≥‰∏∫ÂûÉÂúæÂõûÊî∂Âô®„ÄÇ ÂûÉÂúæÂõûÊî∂ÂÖ∂ÂÆû‰∏Ä‰∏™ÂÆåÁæéÁöÑ ‚ÄúSimplicity is Complicated‚Äù ÁöÑ‰æãÂ≠ê„ÄÇ‰∏ÄÊñπÈù¢ÔºåÁ®ãÂ∫èÂëòÂèóÁõä‰∫é GCÔºåÊó†ÈúÄÊìçÂøÉ„ÄÅ‰πü‰∏çÂÜçÈúÄË¶ÅÂØπÂÜÖÂ≠òËøõË°åÊâãÂä®ÁöÑÁî≥ËØ∑ÂíåÈáäÊîæÊìç‰ΩúÔºåGC Âú®Á®ãÂ∫èËøêË°åÊó∂Ëá™Âä®ÈáäÊîæÊÆãÁïôÁöÑÂÜÖÂ≠ò„ÄÇÂè¶‰∏ÄÊñπÈù¢ÔºåGC ÂØπÁ®ãÂ∫èÂëòÂá†‰πé‰∏çÂèØËßÅÔºå‰ªÖÂú®Á®ãÂ∫èÈúÄË¶ÅËøõË°åÁâπÊÆä‰ºòÂåñÊó∂ÔºåÈÄöËøáÊèê‰æõÂèØË∞ÉÊéßÁöÑ APIÔºåÂØπ GC ÁöÑËøêË°åÊó∂Êú∫„ÄÅËøêË°åÂºÄÈîÄËøõË°åÊääÊéßÁöÑÊó∂ÂÄôÊâçÂæó‰ª•Áé∞Ë∫´„ÄÇ ÈÄöÂ∏∏ÔºåÂûÉÂúæÂõûÊî∂Âô®ÁöÑÊâßË°åËøáÁ®ãË¢´ÂàíÂàÜ‰∏∫‰∏§‰∏™ÂçäÁã¨Á´ãÁöÑÁªÑ‰ª∂Ôºö ËµãÂÄºÂô®ÔºàMutatorÔºâÔºöËøô‰∏ÄÂêçÁß∞Êú¨Ë¥®‰∏äÊòØÂú®Êåá‰ª£Áî®Êà∑ÊÄÅÁöÑ‰ª£Á†Å„ÄÇÂõ†‰∏∫ÂØπÂûÉÂúæÂõûÊî∂Âô®ËÄåË®ÄÔºåÁî®Êà∑ÊÄÅÁöÑ‰ª£Á†Å‰ªÖ‰ªÖÂè™ÊòØÂú®‰øÆÊîπÂØπË±°‰πãÈó¥ÁöÑÂºïÁî®ÂÖ≥Á≥ªÔºå‰πüÂ∞±ÊòØÂú®ÂØπË±°ÂõæÔºàÂØπË±°‰πãÈó¥ÂºïÁî®ÂÖ≥Á≥ªÁöÑ‰∏Ä‰∏™ÊúâÂêëÂõæÔºâ‰∏äËøõË°åÊìç‰Ωú„ÄÇ ÂõûÊî∂Âô®ÔºàCollectorÔºâÔºöË¥üË¥£ÊâßË°åÂûÉÂúæÂõûÊî∂ÁöÑ‰ª£Á†Å„ÄÇ 2. Ê†πÂØπË±°Âà∞Â∫ïÊòØ‰ªÄ‰πàÔºüÊ†πÂØπË±°Âú®ÂûÉÂúæÂõûÊî∂ÁöÑÊúØËØ≠‰∏≠ÂèàÂè´ÂÅöÊ†πÈõÜÂêàÔºåÂÆÉÊòØÂûÉÂúæÂõûÊî∂Âô®Âú®Ê†áËÆ∞ËøáÁ®ãÊó∂ÊúÄÂÖàÊ£ÄÊü•ÁöÑÂØπË±°ÔºåÂåÖÊã¨Ôºö ÂÖ®Â±ÄÂèòÈáèÔºöÁ®ãÂ∫èÂú®ÁºñËØëÊúüÂ∞±ËÉΩÁ°ÆÂÆöÁöÑÈÇ£‰∫õÂ≠òÂú®‰∫éÁ®ãÂ∫èÊï¥‰∏™ÁîüÂëΩÂë®ÊúüÁöÑÂèòÈáè„ÄÇ ÊâßË°åÊ†àÔºöÊØè‰∏™ goroutine ÈÉΩÂåÖÂê´Ëá™Â∑±ÁöÑÊâßË°åÊ†àÔºåËøô‰∫õÊâßË°åÊ†à‰∏äÂåÖÂê´Ê†à‰∏äÁöÑÂèòÈáèÂèäÊåáÂêëÂàÜÈÖçÁöÑÂ†ÜÂÜÖÂ≠òÂå∫ÂùóÁöÑÊåáÈíà„ÄÇ ÂØÑÂ≠òÂô®ÔºöÂØÑÂ≠òÂô®ÁöÑÂÄºÂèØËÉΩË°®Á§∫‰∏Ä‰∏™ÊåáÈíàÔºåÂèÇ‰∏éËÆ°ÁÆóÁöÑËøô‰∫õÊåáÈíàÂèØËÉΩÊåáÂêëÊüê‰∫õËµãÂÄºÂô®ÂàÜÈÖçÁöÑÂ†ÜÂÜÖÂ≠òÂå∫Âùó„ÄÇ 3. Â∏∏ËßÅÁöÑ GC ÂÆûÁé∞ÊñπÂºèÊúâÂì™‰∫õÔºüGo ËØ≠Ë®ÄÁöÑ GC ‰ΩøÁî®ÁöÑÊòØ‰ªÄ‰πàÔºüÊâÄÊúâÁöÑ GC ÁÆóÊ≥ïÂÖ∂Â≠òÂú®ÂΩ¢ÂºèÂèØ‰ª•ÂΩíÁªì‰∏∫ËøΩË∏™ÔºàTracingÔºâÂíåÂºïÁî®ËÆ°Êï∞ÔºàReference CountingÔºâËøô‰∏§ÁßçÂΩ¢ÂºèÁöÑÊ∑∑ÂêàËøêÁî®„ÄÇ ËøΩË∏™Âºè GC ‰ªéÊ†πÂØπË±°Âá∫ÂèëÔºåÊ†πÊçÆÂØπË±°‰πãÈó¥ÁöÑÂºïÁî®‰ø°ÊÅØÔºå‰∏ÄÊ≠•Ê≠•Êé®ËøõÁõ¥Âà∞Êâ´ÊèèÂÆåÊØïÊï¥‰∏™Â†ÜÂπ∂Á°ÆÂÆöÈúÄË¶Å‰øùÁïôÁöÑÂØπË±°Ôºå‰ªéËÄåÂõûÊî∂ÊâÄÊúâÂèØÂõûÊî∂ÁöÑÂØπË±°„ÄÇGo„ÄÅ Java„ÄÅV8 ÂØπ JavaScript ÁöÑÂÆûÁé∞Á≠âÂùá‰∏∫ËøΩË∏™Âºè GC„ÄÇ ÂºïÁî®ËÆ°Êï∞Âºè GC ÊØè‰∏™ÂØπË±°Ëá™Ë∫´ÂåÖÂê´‰∏Ä‰∏™Ë¢´ÂºïÁî®ÁöÑËÆ°Êï∞Âô®ÔºåÂΩìËÆ°Êï∞Âô®ÂΩíÈõ∂Êó∂Ëá™Âä®ÂæóÂà∞ÂõûÊî∂„ÄÇÂõ†‰∏∫Ê≠§ÊñπÊ≥ïÁº∫Èô∑ËæÉÂ§öÔºåÂú®ËøΩÊ±ÇÈ´òÊÄßËÉΩÊó∂ÈÄöÂ∏∏‰∏çË¢´Â∫îÁî®„ÄÇPython„ÄÅObjective-C Á≠âÂùá‰∏∫ÂºïÁî®ËÆ°Êï∞Âºè GC„ÄÇ ÁõÆÂâçÊØîËæÉÂ∏∏ËßÅÁöÑ GC ÂÆûÁé∞ÊñπÂºèÂåÖÊã¨Ôºö ËøΩË∏™ÂºèÔºåÂàÜ‰∏∫Â§öÁßç‰∏çÂêåÁ±ªÂûãÔºå‰æãÂ¶ÇÔºö Ê†áËÆ∞Ê∏ÖÊâ´Ôºö‰ªéÊ†πÂØπË±°Âá∫ÂèëÔºåÂ∞ÜÁ°ÆÂÆöÂ≠òÊ¥ªÁöÑÂØπË±°ËøõË°åÊ†áËÆ∞ÔºåÂπ∂Ê∏ÖÊâ´ÂèØ‰ª•ÂõûÊî∂ÁöÑÂØπË±°„ÄÇ Ê†áËÆ∞Êï¥ÁêÜÔºö‰∏∫‰∫ÜËß£ÂÜ≥ÂÜÖÂ≠òÁ¢éÁâáÈóÆÈ¢òËÄåÊèêÂá∫ÔºåÂú®Ê†áËÆ∞ËøáÁ®ã‰∏≠ÔºåÂ∞ÜÂØπË±°Â∞ΩÂèØËÉΩÊï¥ÁêÜÂà∞‰∏ÄÂùóËøûÁª≠ÁöÑÂÜÖÂ≠ò‰∏ä„ÄÇ Â¢ûÈáèÂºèÔºöÂ∞ÜÊ†áËÆ∞‰∏éÊ∏ÖÊâ´ÁöÑËøáÁ®ãÂàÜÊâπÊâßË°åÔºåÊØèÊ¨°ÊâßË°åÂæàÂ∞èÁöÑÈÉ®ÂàÜÔºå‰ªéËÄåÂ¢ûÈáèÁöÑÊé®ËøõÂûÉÂúæÂõûÊî∂ÔºåËææÂà∞Ëøë‰ººÂÆûÊó∂„ÄÅÂá†‰πéÊó†ÂÅúÈ°øÁöÑÁõÆÁöÑ„ÄÇ Â¢ûÈáèÊï¥ÁêÜÔºöÂú®Â¢ûÈáèÂºèÁöÑÂü∫Á°Ä‰∏äÔºåÂ¢ûÂä†ÂØπÂØπË±°ÁöÑÊï¥ÁêÜËøáÁ®ã„ÄÇ ÂàÜ‰ª£ÂºèÔºöÂ∞ÜÂØπË±°Ê†πÊçÆÂ≠òÊ¥ªÊó∂Èó¥ÁöÑÈïøÁü≠ËøõË°åÂàÜÁ±ªÔºåÂ≠òÊ¥ªÊó∂Èó¥Â∞è‰∫éÊüê‰∏™ÂÄºÁöÑ‰∏∫Âπ¥ËΩª‰ª£ÔºåÂ≠òÊ¥ªÊó∂Èó¥Â§ß‰∫éÊüê‰∏™ÂÄºÁöÑ‰∏∫ËÄÅÂπ¥‰ª£ÔºåÊ∞∏Ëøú‰∏ç‰ºöÂèÇ‰∏éÂõûÊî∂ÁöÑÂØπË±°‰∏∫Ê∞∏‰πÖ‰ª£„ÄÇÂπ∂Ê†πÊçÆÂàÜ‰ª£ÂÅáËÆæÔºàÂ¶ÇÊûú‰∏Ä‰∏™ÂØπË±°Â≠òÊ¥ªÊó∂Èó¥‰∏çÈïøÂàôÂÄæÂêë‰∫éË¢´ÂõûÊî∂ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÂØπË±°Â∑≤ÁªèÂ≠òÊ¥ªÂæàÈïøÊó∂Èó¥ÂàôÂÄæÂêë‰∫éÂ≠òÊ¥ªÊõ¥ÈïøÊó∂Èó¥ÔºâÂØπÂØπË±°ËøõË°åÂõûÊî∂„ÄÇ ÂºïÁî®ËÆ°Êï∞ÔºöÊ†πÊçÆÂØπË±°Ëá™Ë∫´ÁöÑÂºïÁî®ËÆ°Êï∞Êù•ÂõûÊî∂ÔºåÂΩìÂºïÁî®ËÆ°Êï∞ÂΩíÈõ∂Êó∂Á´ãÂç≥ÂõûÊî∂„ÄÇ ÂÖ≥‰∫éÂêÑÁ±ªÊñπÊ≥ïÁöÑËØ¶ÁªÜ‰ªãÁªçÂèäÂÖ∂ÂÆûÁé∞‰∏çÂú®Êú¨Êñá‰∏≠ËØ¶ÁªÜËÆ®ËÆ∫„ÄÇÂØπ‰∫é Go ËÄåË®ÄÔºåGo ÁöÑ GC ÁõÆÂâç‰ΩøÁî®ÁöÑÊòØÊó†ÂàÜ‰ª£ÔºàÂØπË±°Ê≤°Êúâ‰ª£ÈôÖ‰πãÂàÜÔºâ„ÄÅ‰∏çÊï¥ÁêÜÔºàÂõûÊî∂ËøáÁ®ã‰∏≠‰∏çÂØπÂØπË±°ËøõË°åÁßªÂä®‰∏éÊï¥ÁêÜÔºâ„ÄÅÂπ∂ÂèëÔºà‰∏éÁî®Êà∑‰ª£Á†ÅÂπ∂ÂèëÊâßË°åÔºâÁöÑ‰∏âËâ≤Ê†áËÆ∞Ê∏ÖÊâ´ÁÆóÊ≥ï„ÄÇÂéüÂõ†Âú®‰∫éÔºö ÂØπË±°Êï¥ÁêÜÁöÑ‰ºòÂäøÊòØËß£ÂÜ≥ÂÜÖÂ≠òÁ¢éÁâáÈóÆÈ¢ò‰ª•Âèä‚ÄúÂÖÅËÆ∏‚Äù‰ΩøÁî®È°∫Â∫èÂÜÖÂ≠òÂàÜÈÖçÂô®„ÄÇ‰ΩÜ Go ËøêË°åÊó∂ÁöÑÂàÜÈÖçÁÆóÊ≥ïÂü∫‰∫é tcmallocÔºåÂü∫Êú¨‰∏äÊ≤°ÊúâÁ¢éÁâáÈóÆÈ¢ò„ÄÇ Âπ∂‰∏îÈ°∫Â∫èÂÜÖÂ≠òÂàÜÈÖçÂô®Âú®Â§öÁ∫øÁ®ãÁöÑÂú∫ÊôØ‰∏ãÂπ∂‰∏çÈÄÇÁî®„ÄÇGo ‰ΩøÁî®ÁöÑÊòØÂü∫‰∫é tcmalloc ÁöÑÁé∞‰ª£ÂÜÖÂ≠òÂàÜÈÖçÁÆóÊ≥ïÔºåÂØπÂØπË±°ËøõË°åÊï¥ÁêÜ‰∏ç‰ºöÂ∏¶Êù•ÂÆûË¥®ÊÄßÁöÑÊÄßËÉΩÊèêÂçá„ÄÇ ÂàÜ‰ª£ GC ‰æùËµñÂàÜ‰ª£ÂÅáËÆæÔºåÂç≥ GC Â∞Ü‰∏ªË¶ÅÁöÑÂõûÊî∂ÁõÆÊ†áÊîæÂú®Êñ∞ÂàõÂª∫ÁöÑÂØπË±°‰∏äÔºàÂ≠òÊ¥ªÊó∂Èó¥Áü≠ÔºåÊõ¥ÂÄæÂêë‰∫éË¢´ÂõûÊî∂ÔºâÔºåËÄåÈùûÈ¢ëÁπÅÊ£ÄÊü•ÊâÄÊúâÂØπË±°„ÄÇ‰ΩÜ Go ÁöÑÁºñËØëÂô®‰ºöÈÄöËøáÈÄÉÈÄ∏ÂàÜÊûêÂ∞ÜÂ§ßÈÉ®ÂàÜÊñ∞ÁîüÂØπË±°Â≠òÂÇ®Âú®Ê†à‰∏äÔºàÊ†àÁõ¥Êé•Ë¢´ÂõûÊî∂ÔºâÔºåÂè™ÊúâÈÇ£‰∫õÈúÄË¶ÅÈïøÊúüÂ≠òÂú®ÁöÑÂØπË±°Êâç‰ºöË¢´ÂàÜÈÖçÂà∞ÈúÄË¶ÅËøõË°åÂûÉÂúæÂõûÊî∂ÁöÑÂ†Ü‰∏≠„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂàÜ‰ª£ GC ÂõûÊî∂ÁöÑÈÇ£‰∫õÂ≠òÊ¥ªÊó∂Èó¥Áü≠ÁöÑÂØπË±°Âú® Go ‰∏≠ÊòØÁõ¥Êé•Ë¢´ÂàÜÈÖçÂà∞Ê†à‰∏äÔºåÂΩì goroutine Ê≠ª‰∫°ÂêéÊ†à‰πü‰ºöË¢´Áõ¥Êé•ÂõûÊî∂Ôºå‰∏çÈúÄË¶Å GC ÁöÑÂèÇ‰∏éÔºåËøõËÄåÂàÜ‰ª£ÂÅáËÆæÂπ∂Ê≤°ÊúâÂ∏¶Êù•Áõ¥Êé•‰ºòÂäø„ÄÇÂπ∂‰∏î Go ÁöÑÂûÉÂúæÂõûÊî∂Âô®‰∏éÁî®Êà∑‰ª£Á†ÅÂπ∂ÂèëÊâßË°åÔºå‰ΩøÂæó STW ÁöÑÊó∂Èó¥‰∏éÂØπË±°ÁöÑ‰ª£ÈôÖ„ÄÅÂØπË±°ÁöÑ size Ê≤°ÊúâÂÖ≥Á≥ª„ÄÇGo Âõ¢ÈòüÊõ¥ÂÖ≥Ê≥®‰∫éÂ¶Ç‰ΩïÊõ¥Â•ΩÂú∞ËÆ© GC ‰∏éÁî®Êà∑‰ª£Á†ÅÂπ∂ÂèëÊâßË°åÔºà‰ΩøÁî®ÈÄÇÂΩìÁöÑ CPU Êù•ÊâßË°åÂûÉÂúæÂõûÊî∂ÔºâÔºåËÄåÈùûÂáèÂ∞ëÂÅúÈ°øÊó∂Èó¥Ëøô‰∏ÄÂçï‰∏ÄÁõÆÊ†á‰∏ä„ÄÇ 4. ‰∏âËâ≤Ê†áËÆ∞Ê≥ïÊòØ‰ªÄ‰πàÔºüÁêÜËß£‰∏âËâ≤Ê†áËÆ∞Ê≥ïÁöÑÂÖ≥ÈîÆÊòØÁêÜËß£ÂØπË±°ÁöÑ‰∏âËâ≤ÊäΩË±°‰ª•ÂèäÊ≥¢Èù¢ÔºàwavefrontÔºâÊé®ËøõËøô‰∏§‰∏™Ê¶ÇÂøµ„ÄÇ‰∏âËâ≤ÊäΩË±°Âè™ÊòØ‰∏ÄÁßçÊèèËø∞ËøΩË∏™ÂºèÂõûÊî∂Âô®ÁöÑÊñπÊ≥ïÔºåÂú®ÂÆûË∑µ‰∏≠Âπ∂Ê≤°ÊúâÂÆûÈôÖÂê´‰πâÔºåÂÆÉÁöÑÈáçË¶Å‰ΩúÁî®Âú®‰∫é‰ªéÈÄªËæë‰∏ä‰∏•ÂØÜÊé®ÂØºÊ†áËÆ∞Ê∏ÖÁêÜËøôÁßçÂûÉÂúæÂõûÊî∂ÊñπÊ≥ïÁöÑÊ≠£Á°ÆÊÄß„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂΩìÊàë‰ª¨Ë∞àÂèä‰∏âËâ≤Ê†áËÆ∞Ê≥ïÊó∂ÔºåÈÄöÂ∏∏ÊåáÊ†áËÆ∞Ê∏ÖÊâ´ÁöÑÂûÉÂúæÂõûÊî∂„ÄÇ ‰ªéÂûÉÂúæÂõûÊî∂Âô®ÁöÑËßÜËßíÊù•ÁúãÔºå‰∏âËâ≤ÊäΩË±°ËßÑÂÆö‰∫Ü‰∏âÁßç‰∏çÂêåÁ±ªÂûãÁöÑÂØπË±°ÔºåÂπ∂Áî®‰∏çÂêåÁöÑÈ¢úËâ≤Áõ∏Áß∞Ôºö ÁôΩËâ≤ÂØπË±°ÔºàÂèØËÉΩÊ≠ª‰∫°ÔºâÔºöÊú™Ë¢´ÂõûÊî∂Âô®ËÆøÈóÆÂà∞ÁöÑÂØπË±°„ÄÇÂú®ÂõûÊî∂ÂºÄÂßãÈò∂ÊÆµÔºåÊâÄÊúâÂØπË±°Âùá‰∏∫ÁôΩËâ≤ÔºåÂΩìÂõûÊî∂ÁªìÊùüÂêéÔºåÁôΩËâ≤ÂØπË±°Âùá‰∏çÂèØËææ„ÄÇ ÁÅ∞Ëâ≤ÂØπË±°ÔºàÊ≥¢Èù¢ÔºâÔºöÂ∑≤Ë¢´ÂõûÊî∂Âô®ËÆøÈóÆÂà∞ÁöÑÂØπË±°Ôºå‰ΩÜÂõûÊî∂Âô®ÈúÄË¶ÅÂØπÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊåáÈíàËøõË°åÊâ´ÊèèÔºåÂõ†‰∏∫‰ªñ‰ª¨ÂèØËÉΩËøòÊåáÂêëÁôΩËâ≤ÂØπË±°„ÄÇ ÈªëËâ≤ÂØπË±°ÔºàÁ°ÆÂÆöÂ≠òÊ¥ªÔºâÔºöÂ∑≤Ë¢´ÂõûÊî∂Âô®ËÆøÈóÆÂà∞ÁöÑÂØπË±°ÔºåÂÖ∂‰∏≠ÊâÄÊúâÂ≠óÊÆµÈÉΩÂ∑≤Ë¢´Êâ´ÊèèÔºåÈªëËâ≤ÂØπË±°‰∏≠‰ªª‰Ωï‰∏Ä‰∏™ÊåáÈíàÈÉΩ‰∏çÂèØËÉΩÁõ¥Êé•ÊåáÂêëÁôΩËâ≤ÂØπË±°„ÄÇ ËøôÊ†∑‰∏âÁßç‰∏çÂèòÊÄßÊâÄÂÆö‰πâÁöÑÂõûÊî∂ËøáÁ®ãÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™Ê≥¢Èù¢‰∏çÊñ≠ÂâçËøõÁöÑËøáÁ®ãÔºåËøô‰∏™Ê≥¢Èù¢ÂêåÊó∂‰πüÊòØÈªëËâ≤ÂØπË±°ÂíåÁôΩËâ≤ÂØπË±°ÁöÑËæπÁïåÔºåÁÅ∞Ëâ≤ÂØπË±°Â∞±ÊòØËøô‰∏™Ê≥¢Èù¢„ÄÇ ÂΩìÂûÉÂúæÂõûÊî∂ÂºÄÂßãÊó∂ÔºåÂè™ÊúâÁôΩËâ≤ÂØπË±°„ÄÇÈöèÁùÄÊ†áËÆ∞ËøáÁ®ãÂºÄÂßãËøõË°åÊó∂ÔºåÁÅ∞Ëâ≤ÂØπË±°ÂºÄÂßãÂá∫Áé∞ÔºàÁùÄËâ≤ÔºâÔºåËøôÊó∂ÂÄôÊ≥¢Èù¢‰æøÂºÄÂßãÊâ©Â§ß„ÄÇÂΩì‰∏Ä‰∏™ÂØπË±°ÁöÑÊâÄÊúâÂ≠êËäÇÁÇπÂùáÂÆåÊàêÊâ´ÊèèÊó∂Ôºå‰ºöË¢´ÁùÄËâ≤‰∏∫ÈªëËâ≤„ÄÇÂΩìÊï¥‰∏™Â†ÜÈÅçÂéÜÂÆåÊàêÊó∂ÔºåÂè™Ââ©‰∏ãÈªëËâ≤ÂíåÁôΩËâ≤ÂØπË±°ÔºåËøôÊó∂ÁöÑÈªëËâ≤ÂØπË±°‰∏∫ÂèØËææÂØπË±°ÔºåÂç≥Â≠òÊ¥ªÔºõËÄåÁôΩËâ≤ÂØπË±°‰∏∫‰∏çÂèØËææÂØπË±°ÔºåÂç≥Ê≠ª‰∫°„ÄÇËøô‰∏™ËøáÁ®ãÂèØ‰ª•ËßÜ‰∏∫‰ª•ÁÅ∞Ëâ≤ÂØπË±°‰∏∫Ê≥¢Èù¢ÔºåÂ∞ÜÈªëËâ≤ÂØπË±°ÂíåÁôΩËâ≤ÂØπË±°ÂàÜÁ¶ªÔºå‰ΩøÊ≥¢Èù¢‰∏çÊñ≠ÂêëÂâçÊé®ËøõÔºåÁõ¥Âà∞ÊâÄÊúâÂèØËææÁöÑÁÅ∞Ëâ≤ÂØπË±°ÈÉΩÂèò‰∏∫ÈªëËâ≤ÂØπË±°‰∏∫Ê≠¢ÁöÑËøáÁ®ã„ÄÇÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Âõæ‰∏≠Â±ïÁ§∫‰∫ÜÊ†πÂØπË±°„ÄÅÂèØËææÂØπË±°„ÄÅ‰∏çÂèØËææÂØπË±°ÔºåÈªë„ÄÅÁÅ∞„ÄÅÁôΩÂØπË±°‰ª•ÂèäÊ≥¢Èù¢‰πãÈó¥ÁöÑÂÖ≥Á≥ª„ÄÇ 5. STW ÊòØ‰ªÄ‰πàÊÑèÊÄùÔºüSTW ÊòØ Stop the World ÁöÑÁº©ÂÜôÔºåÂç≥‰∏áÁâ©ÈùôÊ≠¢ÔºåÊòØÊåáÂú®ÂûÉÂúæÂõûÊî∂ËøáÁ®ã‰∏≠‰∏∫‰∫Ü‰øùËØÅÂÆûÁé∞ÁöÑÊ≠£Á°ÆÊÄß„ÄÅÈò≤Ê≠¢Êó†Ê≠¢Â¢ÉÁöÑÂÜÖÂ≠òÂ¢ûÈïøÁ≠âÈóÆÈ¢òËÄå‰∏çÂèØÈÅøÂÖçÁöÑÈúÄË¶ÅÂÅúÊ≠¢ËµãÂÄºÂô®Ëøõ‰∏ÄÊ≠•Êìç‰ΩúÂØπË±°ÂõæÁöÑ‰∏ÄÊÆµËøáÁ®ã„ÄÇ Âú®Ëøô‰∏™ËøáÁ®ã‰∏≠Êï¥‰∏™Áî®Êà∑‰ª£Á†ÅË¢´ÂÅúÊ≠¢ÊàñËÄÖÊîæÁºìÊâßË°åÔºå STW Ë∂äÈïøÔºåÂØπÁî®Êà∑‰ª£Á†ÅÈÄ†ÊàêÁöÑÂΩ±ÂìçÔºà‰æãÂ¶ÇÂª∂ËøüÔºâÂ∞±Ë∂äÂ§ßÔºåÊó©Êúü Go ÂØπÂûÉÂúæÂõûÊî∂Âô®ÁöÑÂÆûÁé∞‰∏≠ STW ÈïøËææÂá†ÁôæÊØ´ÁßíÔºåÂØπÊó∂Èó¥ÊïèÊÑüÁöÑÂÆûÊó∂ÈÄö‰ø°Á≠âÂ∫îÁî®Á®ãÂ∫è‰ºöÈÄ†ÊàêÂ∑®Â§ßÁöÑÂΩ±Âìç„ÄÇÊàë‰ª¨Êù•Áúã‰∏Ä‰∏™‰æãÂ≠êÔºö 1234567891011121314151617package mainimport ( "runtime" "time")func main() &#123; go func() &#123; for &#123; &#125; &#125;() time.Sleep(time.Millisecond) runtime.GC() println("OK")&#125; ‰∏äÈù¢ÁöÑËøô‰∏™Á®ãÂ∫èÂú® Go 1.14 ‰ª•ÂâçÊ∞∏ËøúÈÉΩ‰∏ç‰ºöËæìÂá∫ OKÔºåÂÖ∂ÁΩ™È≠ÅÁ•∏È¶ñÊòØ STW Êó†ÈôêÂà∂ÁöÑË¢´Âª∂Èïø„ÄÇ Â∞ΩÁÆ° STW Â¶Ç‰ªäÂ∑≤Áªè‰ºòÂåñÂà∞‰∫ÜÂçäÊØ´ÁßíÁ∫ßÂà´‰ª•‰∏ãÔºå‰ΩÜËøô‰∏™Á®ãÂ∫èË¢´Âç°Ê≠ªÂéüÂõ†Âú®‰∫é‰ªçÁÑ∂ÊòØ STW ÂØºËá¥ÁöÑ„ÄÇÂéüÂõ†Âú®‰∫éÔºåGC Âú®ËøõÂÖ• STW Êó∂ÔºåÈúÄË¶ÅÁ≠âÂæÖËÆ©ÊâÄÊúâÁöÑÁî®Êà∑ÊÄÅ‰ª£Á†ÅÂÅúÊ≠¢Ôºå‰ΩÜÊòØ for {} ÊâÄÂú®ÁöÑ goroutine Ê∞∏ËøúÈÉΩ‰∏ç‰ºöË¢´‰∏≠Êñ≠Ôºå‰ªéËÄåÂÅúÁïôÂú® STW Èò∂ÊÆµ„ÄÇÂÆûÈôÖÂÆûË∑µ‰∏≠‰πüÊòØÂ¶ÇÊ≠§ÔºåÂΩìÁ®ãÂ∫èÁöÑÊüê‰∏™ goroutine ÈïøÊó∂Èó¥Âæó‰∏çÂà∞ÂÅúÊ≠¢ÔºåÂº∫Ë°åÊãñÊÖ¢ STWÔºåËøôÁßçÊÉÖÂÜµ‰∏ãÈÄ†ÊàêÁöÑÂΩ±ÂìçÔºàÂç°Ê≠ªÔºâÊòØÈùûÂ∏∏ÂèØÊÄïÁöÑ„ÄÇÂ•ΩÂú®Ëá™ Go 1.14 ‰πãÂêéÔºåËøôÁ±ª goroutine ËÉΩÂ§üË¢´ÂºÇÊ≠•Âú∞Êä¢Âç†Ôºå‰ªéËÄå‰ΩøÂæó STW ÁöÑÊó∂Èó¥Â¶ÇÂêåÊôÆÈÄöÁ®ãÂ∫èÈÇ£Ê†∑Ôºå‰∏ç‰ºöË∂ÖËøáÂçä‰∏™ÊØ´ÁßíÔºåÁ®ãÂ∫è‰πü‰∏ç‰ºöÂõ†‰∏∫‰ªÖ‰ªÖÁ≠âÂæÖ‰∏Ä‰∏™ goroutine ÁöÑÂÅúÊ≠¢ËÄåÂÅúÈ°øÂú® STW Èò∂ÊÆµ„ÄÇ 6. Â¶Ç‰ΩïËßÇÂØü Go GCÔºüÊàë‰ª¨‰ª•‰∏ãÈù¢ÁöÑÁ®ãÂ∫è‰∏∫‰æãÔºåÂÖà‰ΩøÁî®ÂõõÁßç‰∏çÂêåÁöÑÊñπÂºèÊù•‰ªãÁªçÂ¶Ç‰ΩïËßÇÂØü GCÔºåÂπ∂Âú®ÂêéÈù¢ÁöÑÈóÆÈ¢ò‰∏≠ÈÄöËøáÂá†‰∏™ËØ¶ÁªÜÁöÑ‰æãÂ≠êÂÜçÊù•ËÆ®ËÆ∫Â¶Ç‰Ωï‰ºòÂåñ GC„ÄÇ 1234567891011package mainfunc allocate() &#123; _ = make([]byte, 1&lt;&lt;20)&#125;func main() &#123; for n := 1; n &lt; 100000; n++ &#123; allocate() &#125;&#125; ÊñπÂºè1ÔºöGODEBUG=gctrace=1Êàë‰ª¨È¶ñÂÖàÂèØ‰ª•ÈÄöËøá 123456789101112131415161718192021$ go build -o main$ GODEBUG=gctrace=1 ./maingc 1 @0.000s 2%: 0.009+0.23+0.004 ms clock, 0.11+0.083/0.019/0.14+0.049 ms cpu, 4-&gt;6-&gt;2 MB, 5 MB goal, 12 Pscvg: 8 KB releasedscvg: inuse: 3, idle: 60, sys: 63, released: 57, consumed: 6 (MB)gc 2 @0.001s 2%: 0.018+1.1+0.029 ms clock, 0.22+0.047/0.074/0.048+0.34 ms cpu, 4-&gt;7-&gt;3 MB, 5 MB goal, 12 Pscvg: inuse: 3, idle: 60, sys: 63, released: 56, consumed: 7 (MB)gc 3 @0.003s 2%: 0.018+0.59+0.011 ms clock, 0.22+0.073/0.008/0.042+0.13 ms cpu, 5-&gt;6-&gt;1 MB, 6 MB goal, 12 Pscvg: 8 KB releasedscvg: inuse: 2, idle: 61, sys: 63, released: 56, consumed: 7 (MB)gc 4 @0.003s 4%: 0.019+0.70+0.054 ms clock, 0.23+0.051/0.047/0.085+0.65 ms cpu, 4-&gt;6-&gt;2 MB, 5 MB goal, 12 Pscvg: 8 KB releasedscvg: inuse: 3, idle: 60, sys: 63, released: 56, consumed: 7 (MB)scvg: 8 KB releasedscvg: inuse: 4, idle: 59, sys: 63, released: 56, consumed: 7 (MB)gc 5 @0.004s 12%: 0.021+0.26+0.49 ms clock, 0.26+0.046/0.037/0.11+5.8 ms cpu, 4-&gt;7-&gt;3 MB, 5 MB goal, 12 Pscvg: inuse: 5, idle: 58, sys: 63, released: 56, consumed: 7 (MB)gc 6 @0.005s 12%: 0.020+0.17+0.004 ms clock, 0.25+0.080/0.070/0.053+0.051 ms cpu, 5-&gt;6-&gt;1 MB, 6 MB goal, 12 Pscvg: 8 KB releasedscvg: inuse: 1, idle: 62, sys: 63, released: 56, consumed: 7 (MB) Âú®Ëøô‰∏™Êó•Âøó‰∏≠ÂèØ‰ª•ËßÇÂØüÂà∞‰∏§Á±ª‰∏çÂêåÁöÑ‰ø°ÊÅØÔºö 123gc 1 @0.000s 2%: 0.009+0.23+0.004 ms clock, 0.11+0.083/0.019/0.14+0.049 ms cpu, 4-&gt;6-&gt;2 MB, 5 MB goal, 12 Pgc 2 @0.001s 2%: 0.018+1.1+0.029 ms clock, 0.22+0.047/0.074/0.048+0.34 ms cpu, 4-&gt;7-&gt;3 MB, 5 MB goal, 12 P... ‰ª•ÂèäÔºö 1234scvg: 8 KB releasedscvg: inuse: 3, idle: 60, sys: 63, released: 57, consumed: 6 (MB)scvg: inuse: 3, idle: 60, sys: 63, released: 56, consumed: 7 (MB)... ÂØπ‰∫éÁî®Êà∑‰ª£Á†ÅÂêëËøêË°åÊó∂Áî≥ËØ∑ÂÜÖÂ≠ò‰∫ßÁîüÁöÑÂûÉÂúæÂõûÊî∂Ôºö 1gc 2 @0.001s 2%: 0.018+1.1+0.029 ms clock, 0.22+0.047/0.074/0.048+0.34 ms cpu, 4-&gt;7-&gt;3 MB, 5 MB goal, 12 P Âê´‰πâÁî±‰∏ãË°®ÊâÄÁ§∫Ôºö Â≠óÊÆµ Âê´‰πâ gc 2 Á¨¨‰∫å‰∏™ GC Âë®Êúü 0.001 Á®ãÂ∫èÂºÄÂßãÂêéÁöÑ 0.001 Áßí 2% ËØ• GC Âë®Êúü‰∏≠ CPU ÁöÑ‰ΩøÁî®Áéá 0.018 Ê†áËÆ∞ÂºÄÂßãÊó∂Ôºå STW ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥Ôºàwall clockÔºâ 1.1 Ê†áËÆ∞ËøáÁ®ã‰∏≠ÔºåÂπ∂ÂèëÊ†áËÆ∞ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥Ôºàwall clockÔºâ 0.029 Ê†áËÆ∞ÁªàÊ≠¢Êó∂Ôºå STW ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥Ôºàwall clockÔºâ 0.22 Ê†áËÆ∞ÂºÄÂßãÊó∂Ôºå STW ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥Ôºàcpu timeÔºâ 0.047 Ê†áËÆ∞ËøáÁ®ã‰∏≠ÔºåÊ†áËÆ∞ËæÖÂä©ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥Ôºàcpu timeÔºâ 0.074 Ê†áËÆ∞ËøáÁ®ã‰∏≠ÔºåÂπ∂ÂèëÊ†áËÆ∞ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥Ôºàcpu timeÔºâ 0.048 Ê†áËÆ∞ËøáÁ®ã‰∏≠ÔºåGC Á©∫Èó≤ÁöÑÊó∂Èó¥Ôºàcpu timeÔºâ 0.34 Ê†áËÆ∞ÁªàÊ≠¢Êó∂Ôºå STW ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥Ôºàcpu timeÔºâ 4 Ê†áËÆ∞ÂºÄÂßãÊó∂ÔºåÂ†ÜÁöÑÂ§ßÂ∞èÁöÑÂÆûÈôÖÂÄº 7 Ê†áËÆ∞ÁªìÊùüÊó∂ÔºåÂ†ÜÁöÑÂ§ßÂ∞èÁöÑÂÆûÈôÖÂÄº 3 Ê†áËÆ∞ÁªìÊùüÊó∂ÔºåÊ†áËÆ∞‰∏∫Â≠òÊ¥ªÁöÑÂØπË±°Â§ßÂ∞è 5 Ê†áËÆ∞ÁªìÊùüÊó∂ÔºåÂ†ÜÁöÑÂ§ßÂ∞èÁöÑÈ¢ÑÊµãÂÄº 12 P ÁöÑÊï∞Èáè wall clock ÊòØÊåáÂºÄÂßãÊâßË°åÂà∞ÂÆåÊàêÊâÄÁªèÂéÜÁöÑÂÆûÈôÖÊó∂Èó¥ÔºåÂåÖÊã¨ÂÖ∂‰ªñÁ®ãÂ∫èÂíåÊú¨Á®ãÂ∫èÊâÄÊ∂àËÄóÁöÑÊó∂Èó¥Ôºõcpu time ÊòØÊåáÁâπÂÆöÁ®ãÂ∫è‰ΩøÁî® CPU ÁöÑÊó∂Èó¥Ôºõ‰ªñ‰ª¨Â≠òÂú®‰ª•‰∏ãÂÖ≥Á≥ªÔºö wall clock &lt; cpu time: ÂÖÖÂàÜÂà©Áî®Â§öÊ†∏ wall clock ‚âà cpu time: Êú™Âπ∂Ë°åÊâßË°å wall clock &gt; cpu time: Â§öÊ†∏‰ºòÂäø‰∏çÊòéÊòæ ÂØπ‰∫éËøêË°åÊó∂ÂêëÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑ÂÜÖÂ≠ò‰∫ßÁîüÁöÑÂûÉÂúæÂõûÊî∂ÔºàÂêëÊìç‰ΩúÁ≥ªÁªüÂΩíËøòÂ§ö‰ΩôÁöÑÂÜÖÂ≠òÔºâÔºö 12scvg: 8 KB releasedscvg: inuse: 3, idle: 60, sys: 63, released: 57, consumed: 6 (MB) Âê´‰πâÁî±‰∏ãË°®ÊâÄÁ§∫Ôºö Â≠óÊÆµ Âê´‰πâ 8 KB released ÂêëÊìç‰ΩúÁ≥ªÁªüÂΩíËøò‰∫Ü 8 KB ÂÜÖÂ≠ò 3 Â∑≤ÁªèÂàÜÈÖçÁªôÁî®Êà∑‰ª£Á†Å„ÄÅÊ≠£Âú®‰ΩøÁî®ÁöÑÊÄªÂÜÖÂ≠òÂ§ßÂ∞è (MB)„ÄÇMB used or partially used spans 60 Á©∫Èó≤‰ª•ÂèäÁ≠âÂæÖÂΩíËøòÁªôÊìç‰ΩúÁ≥ªÁªüÁöÑÊÄªÂÜÖÂ≠òÂ§ßÂ∞èÔºàMBÔºâ„ÄÇMB spans pending scavenging 63 ÈÄöÁü•Êìç‰ΩúÁ≥ªÁªü‰∏≠‰øùÁïôÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÔºàMBÔºâMB mapped from the system 57 Â∑≤ÁªèÂΩíËøòÁªôÊìç‰ΩúÁ≥ªÁªüÁöÑÔºàÊàñËÄÖËØ¥ËøòÊú™Ê≠£ÂºèÁî≥ËØ∑ÔºâÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÔºàMBÔºâ„ÄÇMB released to the system 6 Â∑≤Áªè‰ªéÊìç‰ΩúÁ≥ªÁªü‰∏≠Áî≥ËØ∑ÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÔºàMBÔºâ„ÄÇMB allocated from the system ÊñπÂºè2Ôºögo tool tracego tool trace ÁöÑ‰∏ªË¶ÅÂäüËÉΩÊòØÂ∞ÜÁªüËÆ°ËÄåÊù•ÁöÑ‰ø°ÊÅØ‰ª•‰∏ÄÁßçÂèØËßÜÂåñÁöÑÊñπÂºèÂ±ïÁ§∫ÁªôÁî®Êà∑„ÄÇË¶Å‰ΩøÁî®Ê≠§Â∑•ÂÖ∑ÔºåÂèØ‰ª•ÈÄöËøáË∞ÉÁî® trace APIÔºö 123456789package mainfunc main() &#123; f, _ := os.Create("trace.out") defer f.Close() trace.Start(f) defer trace.Stop() (...)&#125; Âπ∂ÈÄöËøá 1234$ go tool trace trace.out2019/12/30 15:50:33 Parsing trace...2019/12/30 15:50:38 Splitting trace...2019/12/30 15:50:45 Opening browser. Trace viewer is listening on http://127.0.0.1:51839 ÂëΩ‰ª§Êù•ÂêØÂä®ÂèØËßÜÂåñÁïåÈù¢Ôºö ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÈìæÊé•ÂèØ‰ª•Ëé∑ÂæóÂ¶Ç‰∏ãÂõæÁ§∫Ôºö Âè≥‰∏äËßíÁöÑÈóÆÂè∑ÂèØ‰ª•ÊâìÂºÄÂ∏ÆÂä©ËèúÂçïÔºå‰∏ªË¶Å‰ΩøÁî®ÊñπÂºèÂåÖÊã¨Ôºö w/s ÈîÆÂèØ‰ª•Áî®‰∫éÊîæÂ§ßÊàñËÄÖÁº©Â∞èËßÜÂõæ a/d ÈîÆÂèØ‰ª•Áî®‰∫éÂ∑¶Âè≥ÁßªÂä® ÊñπÂºè3Ôºödebug.ReadGCStatsÊ≠§ÊñπÂºèÂèØ‰ª•ÈÄöËøá‰ª£Á†ÅÁöÑÊñπÂºèÊù•Áõ¥Êé•ÂÆûÁé∞ÂØπÊÑüÂÖ¥Ë∂£ÊåáÊ†áÁöÑÁõëÊéßÔºå‰æãÂ¶ÇÊàë‰ª¨Â∏åÊúõÊØèÈöî‰∏ÄÁßíÈíüÁõëÊéß‰∏ÄÊ¨° GC ÁöÑÁä∂ÊÄÅÔºö 123456789101112131415func printGCStats() &#123; t := time.NewTicker(time.Second) s := debug.GCStats&#123;&#125; for &#123; select &#123; case &lt;-t.C: debug.ReadGCStats(&amp;s) fmt.Printf("gc %d last@%v, PauseTotal %v\n", s.NumGC, s.LastGC, s.PauseTotal) &#125; &#125;&#125;func main() &#123; go printGCStats() (...)&#125; Êàë‰ª¨ËÉΩÂ§üÁúãÂà∞Â¶Ç‰∏ãËæìÂá∫Ôºö 1234567$ go run main.gogc 4954 last@2019-12-30 15:19:37.505575 +0100 CET, PauseTotal 29.901171msgc 9195 last@2019-12-30 15:19:38.50565 +0100 CET, PauseTotal 77.579622msgc 13502 last@2019-12-30 15:19:39.505714 +0100 CET, PauseTotal 128.022307msgc 17555 last@2019-12-30 15:19:40.505579 +0100 CET, PauseTotal 182.816528msgc 21838 last@2019-12-30 15:19:41.505595 +0100 CET, PauseTotal 246.618502ms ÊñπÂºè4Ôºöruntime.ReadMemStatsÈô§‰∫Ü‰ΩøÁî® debug ÂåÖÊèê‰æõÁöÑÊñπÊ≥ïÂ§ñÔºåËøòÂèØ‰ª•Áõ¥Êé•ÈÄöËøáËøêË°åÊó∂ÁöÑÂÜÖÂ≠òÁõ∏ÂÖ≥ÁöÑ API ËøõË°åÁõëÊéßÔºö 12345678910111213141516func printMemStats() &#123; t := time.NewTicker(time.Second) s := runtime.MemStats&#123;&#125; for &#123; select &#123; case &lt;-t.C: runtime.ReadMemStats(&amp;s) fmt.Printf("gc %d last@%v, next_heap_size@%vMB\n", s.NumGC, time.Unix(int64(time.Duration(s.LastGC).Seconds()), 0), s.NextGC/(1&lt;&lt;20)) &#125; &#125;&#125;func main() &#123; go printMemStats() (...)&#125; 123456$ go run main.gogc 4887 last@2019-12-30 15:44:56 +0100 CET, next_heap_size@4MBgc 10049 last@2019-12-30 15:44:57 +0100 CET, next_heap_size@4MBgc 15231 last@2019-12-30 15:44:58 +0100 CET, next_heap_size@4MBgc 20378 last@2019-12-30 15:44:59 +0100 CET, next_heap_size@6MB ÂΩìÁÑ∂ÔºåÂêé‰∏§ÁßçÊñπÂºèËÉΩÂ§üÁõëÊéßÁöÑÊåáÊ†áÂæàÂ§öÔºåËØªËÄÖÂèØ‰ª•Ëá™Ë°åÊü•Áúã debug.GCStats Âíåruntime.MemStats ÁöÑÂ≠óÊÆµÔºåËøôÈáå‰∏çÂÜçËµòËø∞„ÄÇ 7. Êúâ‰∫Ü GCÔºå‰∏∫‰ªÄ‰πàËøò‰ºöÂèëÁîüÂÜÖÂ≠òÊ≥ÑÈú≤ÔºüÂú®‰∏Ä‰∏™ÂÖ∑Êúâ GC ÁöÑËØ≠Ë®Ä‰∏≠ÔºåÊàë‰ª¨Â∏∏ËØ¥ÁöÑÂÜÖÂ≠òÊ≥ÑÊºèÔºåÁî®‰∏•Ë∞®ÁöÑËØùÊù•ËØ¥Â∫îËØ•ÊòØÔºöÈ¢ÑÊúüÁöÑËÉΩÂæàÂø´Ë¢´ÈáäÊîæÁöÑÂÜÖÂ≠òÁî±‰∫éÈôÑÁùÄÂú®‰∫ÜÈïøÊúüÂ≠òÊ¥ªÁöÑÂÜÖÂ≠ò‰∏ä„ÄÅÊàñÁîüÂëΩÊúüÊÑèÂ§ñÂú∞Ë¢´Âª∂ÈïøÔºåÂØºËá¥È¢ÑËÆ°ËÉΩÂ§üÁ´ãÂç≥ÂõûÊî∂ÁöÑÂÜÖÂ≠òËÄåÈïøÊó∂Èó¥Âæó‰∏çÂà∞ÂõûÊî∂„ÄÇ Âú® Go ‰∏≠ÔºåÁî±‰∫é goroutine ÁöÑÂ≠òÂú®ÔºåÊâÄË∞ìÁöÑÂÜÖÂ≠òÊ≥ÑÊºèÈô§‰∫ÜÈôÑÁùÄÂú®ÈïøÊúüÂØπË±°‰∏ä‰πãÂ§ñÔºåËøòÂ≠òÂú®Â§öÁßç‰∏çÂêåÁöÑÂΩ¢Âºè„ÄÇ ÂΩ¢Âºè1ÔºöÈ¢ÑÊúüËÉΩË¢´Âø´ÈÄüÈáäÊîæÁöÑÂÜÖÂ≠òÂõ†Ë¢´Ê†πÂØπË±°ÂºïÁî®ËÄåÊ≤°ÊúâÂæóÂà∞ËøÖÈÄüÈáäÊîæÂΩìÊúâ‰∏Ä‰∏™ÂÖ®Â±ÄÂØπË±°Êó∂ÔºåÂèØËÉΩ‰∏çÁªèÊÑèÈó¥Â∞ÜÊüê‰∏™ÂèòÈáèÈôÑÁùÄÂú®ÂÖ∂‰∏äÔºå‰∏îÂøΩÁï•ÁöÑÂ∞ÜÂÖ∂ËøõË°åÈáäÊîæÔºåÂàôËØ•ÂÜÖÂ≠òÊ∞∏Ëøú‰∏ç‰ºöÂæóÂà∞ÈáäÊîæ„ÄÇ‰æãÂ¶ÇÔºö 12345678var cache = map[interface&#123;&#125;]interface&#123;&#125;&#123;&#125;func keepalloc() &#123; for i := 0; i &lt; 10000; i++ &#123; m := make([]byte, 1&lt;&lt;10) cache[i] = m &#125;&#125; ÂΩ¢Âºè2Ôºögoroutine Ê≥ÑÊºèGoroutine ‰Ωú‰∏∫‰∏ÄÁßçÈÄªËæë‰∏äÁêÜËß£ÁöÑËΩªÈáèÁ∫ßÁ∫øÁ®ãÔºåÈúÄË¶ÅÁª¥Êä§ÊâßË°åÁî®Êà∑‰ª£Á†ÅÁöÑ‰∏ä‰∏ãÊñá‰ø°ÊÅØ„ÄÇÂú®ËøêË°åËøáÁ®ã‰∏≠‰πüÈúÄË¶ÅÊ∂àËÄó‰∏ÄÂÆöÁöÑÂÜÖÂ≠òÊù•‰øùÂ≠òËøôÁ±ª‰ø°ÊÅØÔºåËÄåËøô‰∫õÂÜÖÂ≠òÂú®ÁõÆÂâçÁâàÊú¨ÁöÑ Go ‰∏≠ÊòØ‰∏ç‰ºöË¢´ÈáäÊîæÁöÑ„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûú‰∏Ä‰∏™Á®ãÂ∫èÊåÅÁª≠‰∏çÊñ≠Âú∞‰∫ßÁîüÊñ∞ÁöÑ goroutine„ÄÅ‰∏î‰∏çÁªìÊùüÂ∑≤ÁªèÂàõÂª∫ÁöÑ goroutine Âπ∂Â§çÁî®ËøôÈÉ®ÂàÜÂÜÖÂ≠òÔºåÂ∞±‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÊºèÁöÑÁé∞Ë±°Ôºå‰æãÂ¶ÇÔºö 1234567func keepalloc2() &#123; for i := 0; i &lt; 100000; i++ &#123; go func() &#123; select &#123;&#125; &#125;() &#125;&#125; È™åËØÅÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂ¶Ç‰∏ãÂΩ¢ÂºèÊù•Ë∞ÉÁî®‰∏äËø∞‰∏§‰∏™ÂáΩÊï∞Ôºö 123456789101112131415package mainimport ( "os" "runtime/trace")func main() &#123; f, _ := os.Create("trace.out") defer f.Close() trace.Start(f) defer trace.Stop() keepalloc() keepalloc2()&#125; ËøêË°åÁ®ãÂ∫èÔºö 1go run main.go ‰ºöÁúãÂà∞Á®ãÂ∫è‰∏≠ÁîüÊàê‰∫Ü trace.out Êñá‰ª∂ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® go tool trace trace.out ÂëΩ‰ª§ÂæóÂà∞‰∏ãÂõæÔºö ÂèØ‰ª•ÁúãÂà∞ÔºåÈÄî‰∏≠ÁöÑ Heap Âú®ÊåÅÁª≠Â¢ûÈïøÔºåÊ≤°ÊúâÂÜÖÂ≠òË¢´ÂõûÊî∂Ôºå‰∫ßÁîü‰∫ÜÂÜÖÂ≠òÊ≥ÑÊºèÁöÑÁé∞Ë±°„ÄÇ ÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÔºåËøôÁßçÂΩ¢ÂºèÁöÑ goroutine Ê≥ÑÊºèËøòÂèØËÉΩÁî± channel Ê≥ÑÊºèÂØºËá¥„ÄÇËÄå channel ÁöÑÊ≥ÑÊºèÊú¨Ë¥®‰∏ä‰∏é goroutine Ê≥ÑÊºèÂ≠òÂú®Áõ¥Êé•ËÅîÁ≥ª„ÄÇChannel ‰Ωú‰∏∫‰∏ÄÁßçÂêåÊ≠•ÂéüËØ≠Ôºå‰ºöËøûÊé•‰∏§‰∏™‰∏çÂêåÁöÑ goroutineÔºåÂ¶ÇÊûú‰∏Ä‰∏™ goroutine Â∞ùËØïÂêë‰∏Ä‰∏™Ê≤°ÊúâÊé•Êî∂ÊñπÁöÑÊó†ÁºìÂÜ≤ channel ÂèëÈÄÅÊ∂àÊÅØÔºåÂàôËØ• goroutine ‰ºöË¢´Ê∞∏‰πÖÁöÑ‰ºëÁú†ÔºåÊï¥‰∏™ goroutine ÂèäÂÖ∂ÊâßË°åÊ†àÈÉΩÂæó‰∏çÂà∞ÈáäÊîæÔºå‰æãÂ¶ÇÔºö 12345678var ch = make(chan struct&#123;&#125;)func keepalloc3() &#123; for i := 0; i &lt; 100000; i++ &#123; // Ê≤°ÊúâÊé•Êî∂ÊñπÔºågoroutine ‰ºö‰∏ÄÁõ¥ÈòªÂ°û go func() &#123; ch &lt;- struct&#123;&#125;&#123;&#125; &#125;() &#125;&#125; 8. Âπ∂ÂèëÊ†áËÆ∞Ê∏ÖÈô§Ê≥ïÁöÑÈöæÁÇπÊòØ‰ªÄ‰πàÔºüÂú®Ê≤°ÊúâÁî®Êà∑ÊÄÅ‰ª£Á†ÅÂπ∂Âèë‰øÆÊîπ‰∏âËâ≤ÊäΩË±°ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂõûÊî∂ÂèØ‰ª•Ê≠£Â∏∏ÁªìÊùü„ÄÇ‰ΩÜÊòØÂπ∂ÂèëÂõûÊî∂ÁöÑÊ†πÊú¨ÈóÆÈ¢òÂú®‰∫éÔºåÁî®Êà∑ÊÄÅ‰ª£Á†ÅÂú®ÂõûÊî∂ËøáÁ®ã‰∏≠‰ºöÂπ∂ÂèëÂú∞Êõ¥Êñ∞ÂØπË±°ÂõæÔºå‰ªéËÄåÈÄ†ÊàêËµãÂÄºÂô®ÂíåÂõûÊî∂Âô®ÂèØËÉΩÂØπÂØπË±°ÂõæÁöÑÁªìÊûÑ‰∫ßÁîü‰∏çÂêåÁöÑËÆ§Áü•„ÄÇËøôÊó∂‰ª•‰∏Ä‰∏™Âõ∫ÂÆöÁöÑ‰∏âËâ≤Ê≥¢Èù¢‰Ωú‰∏∫ÂõûÊî∂ËøáÁ®ãÂâçËøõÁöÑËæπÁïåÂàô‰∏çÂÜçÂêàÁêÜ„ÄÇ Êàë‰ª¨‰∏çÂ¶®ËÄÉËôëËµãÂÄºÂô®ÂÜôÊìç‰ΩúÁöÑ‰æãÂ≠êÔºö Êó∂Â∫è ÂõûÊî∂Âô® ËµãÂÄºÂô® ËØ¥Êòé 1 shade(A, gray) ÂõûÊî∂Âô®ÔºöÊ†πÂØπË±°ÁöÑÂ≠êËäÇÁÇπÁùÄËâ≤‰∏∫ÁÅ∞Ëâ≤ÂØπË±° 2 shade(C, black) ÂõûÊî∂Âô®ÔºöÂΩìÊâÄÊúâÂ≠êËäÇÁÇπÁùÄËâ≤‰∏∫ÁÅ∞Ëâ≤ÂêéÔºåÂ∞ÜËäÇÁÇπÁùÄ‰∏∫ÈªëËâ≤ 3 C.ref3 = C.ref2.ref1 ËµãÂÄºÂô®ÔºöÂπ∂ÂèëÁöÑ‰øÆÊîπ‰∫Ü C ÁöÑÂ≠êËäÇÁÇπ 4 A.ref1 = nil ËµãÂÄºÂô®ÔºöÂπ∂ÂèëÁöÑ‰øÆÊîπ‰∫Ü A ÁöÑÂ≠êËäÇÁÇπ 5 shade(A.ref1, gray) ÂõûÊî∂Âô®ÔºöËøõ‰∏ÄÊ≠•ÁÅ∞Ëâ≤ÂØπË±°ÁöÑÂ≠êËäÇÁÇπÂπ∂ÁùÄËâ≤‰∏∫ÁÅ∞Ëâ≤ÂØπË±°ÔºåËøôÊó∂Áî±‰∫é A.ref1 ‰∏∫ nilÔºå‰ªÄ‰πà‰∫ãÊÉÖ‰πüÊ≤°ÊúâÂèëÁîü 6 shade(A, black) ÂõûÊî∂Âô®ÔºöÁî±‰∫éÊâÄÊúâÂ≠êËäÇÁÇπÂùáÂ∑≤Ê†áËÆ∞ÔºåÂõûÊî∂Âô®‰πü‰∏ç‰ºöÈáçÊñ∞Êâ´ÊèèÂ∑≤ÁªèË¢´Ê†áËÆ∞‰∏∫ÈªëËâ≤ÁöÑÂØπË±°ÔºåÊ≠§Êó∂ A Ë¢´ÁùÄËâ≤‰∏∫ÈªëËâ≤Ôºåscan(A) ‰ªÄ‰πà‰πü‰∏ç‰ºöÂèëÁîüÔºåËøõËÄå B Âú®Ê≠§Ê¨°ÂõûÊî∂ËøáÁ®ã‰∏≠Ê∞∏Ëøú‰∏ç‰ºöË¢´Ê†áËÆ∞‰∏∫ÈªëËâ≤ÔºåËøõËÄåÈîôËØØÂú∞Ë¢´ÂõûÊî∂„ÄÇ ÂàùÂßãÁä∂ÊÄÅÔºöÂÅáËÆæÊüê‰∏™ÈªëËâ≤ÂØπË±° C ÊåáÂêëÊüê‰∏™ÁÅ∞Ëâ≤ÂØπË±° A ÔºåËÄå A ÊåáÂêëÁôΩËâ≤ÂØπË±° BÔºõ C.ref3 = C.ref2.ref1ÔºöËµãÂÄºÂô®Âπ∂ÂèëÂú∞Â∞ÜÈªëËâ≤ÂØπË±° C ÊåáÂêëÔºàref3Ôºâ‰∫ÜÁôΩËâ≤ÂØπË±° BÔºõ A.ref1 = nilÔºöÁßªÈô§ÁÅ∞Ëâ≤ÂØπË±° A ÂØπÁôΩËâ≤ÂØπË±° B ÁöÑÂºïÁî®Ôºàref2ÔºâÔºõ ÊúÄÁªàÁä∂ÊÄÅÔºöÂú®ÁªßÁª≠Êâ´ÊèèÁöÑËøáÁ®ã‰∏≠ÔºåÁôΩËâ≤ÂØπË±° B Ê∞∏Ëøú‰∏ç‰ºöË¢´Ê†áËÆ∞‰∏∫ÈªëËâ≤ÂØπË±°‰∫ÜÔºàÂõûÊî∂Âô®‰∏ç‰ºöÈáçÊñ∞Êâ´ÊèèÈªëËâ≤ÂØπË±°ÔºâÔºåËøõËÄåÂØπË±° B Ë¢´ÈîôËØØÂú∞ÂõûÊî∂„ÄÇ ÊÄªËÄåË®Ä‰πãÔºåÂπ∂ÂèëÊ†áËÆ∞Ê∏ÖÈô§‰∏≠Èù¢‰∏¥ÁöÑ‰∏Ä‰∏™Ê†πÊú¨ÈóÆÈ¢òÂ∞±ÊòØÂ¶Ç‰Ωï‰øùËØÅÊ†áËÆ∞‰∏éÊ∏ÖÈô§ËøáÁ®ãÁöÑÊ≠£Á°ÆÊÄß„ÄÇ 9. ‰ªÄ‰πàÊòØÂÜôÂ±èÈöú„ÄÅÊ∑∑ÂêàÂÜôÂ±èÈöúÔºåÂ¶Ç‰ΩïÂÆûÁé∞ÔºüË¶ÅËÆ≤Ê∏ÖÊ•öÂÜôÂ±èÈöúÔºåÂ∞±ÈúÄË¶ÅÁêÜËß£‰∏âËâ≤Ê†áËÆ∞Ê∏ÖÈô§ÁÆóÊ≥ï‰∏≠ÁöÑÂº∫Âº±‰∏çÂèòÊÄß‰ª•ÂèäËµãÂÄºÂô®ÁöÑÈ¢úËâ≤ÔºåÁêÜËß£‰ªñ‰ª¨ÈúÄË¶Å‰∏ÄÂÆöÁöÑÊäΩË±°ÊÄùÁª¥„ÄÇÂÜôÂ±èÈöúÊòØ‰∏Ä‰∏™Âú®Âπ∂ÂèëÂûÉÂúæÂõûÊî∂Âô®‰∏≠Êâç‰ºöÂá∫Áé∞ÁöÑÊ¶ÇÂøµÔºåÂûÉÂúæÂõûÊî∂Âô®ÁöÑÊ≠£Á°ÆÊÄß‰ΩìÁé∞Âú®Ôºö‰∏çÂ∫îÂá∫Áé∞ÂØπË±°ÁöÑ‰∏¢Â§±Ôºå‰πü‰∏çÂ∫îÈîôËØØÁöÑÂõûÊî∂Ëøò‰∏çÈúÄË¶ÅÂõûÊî∂ÁöÑÂØπË±°„ÄÇ ÂèØ‰ª•ËØÅÊòéÔºåÂΩì‰ª•‰∏ã‰∏§‰∏™Êù°‰ª∂ÂêåÊó∂Êª°Ë∂≥Êó∂‰ºöÁ†¥ÂùèÂûÉÂúæÂõûÊî∂Âô®ÁöÑÊ≠£Á°ÆÊÄßÔºö Êù°‰ª∂ 1: ËµãÂÄºÂô®‰øÆÊîπÂØπË±°ÂõæÔºåÂØºËá¥Êüê‰∏ÄÈªëËâ≤ÂØπË±°ÂºïÁî®ÁôΩËâ≤ÂØπË±°Ôºõ Êù°‰ª∂ 2: ‰ªéÁÅ∞Ëâ≤ÂØπË±°Âá∫ÂèëÔºåÂà∞ËææÁôΩËâ≤ÂØπË±°ÁöÑ„ÄÅÊú™ÁªèËÆøÈóÆËøáÁöÑË∑ØÂæÑË¢´ËµãÂÄºÂô®Á†¥Âùè„ÄÇ Âè™Ë¶ÅËÉΩÂ§üÈÅøÂÖçÂÖ∂‰∏≠‰ªª‰Ωï‰∏Ä‰∏™Êù°‰ª∂ÔºåÂàô‰∏ç‰ºöÂá∫Áé∞ÂØπË±°‰∏¢Â§±ÁöÑÊÉÖÂÜµÔºåÂõ†‰∏∫Ôºö Â¶ÇÊûúÊù°‰ª∂ 1 Ë¢´ÈÅøÂÖçÔºåÂàôÊâÄÊúâÁôΩËâ≤ÂØπË±°ÂùáË¢´ÁÅ∞Ëâ≤ÂØπË±°ÂºïÁî®ÔºåÊ≤°ÊúâÁôΩËâ≤ÂØπË±°‰ºöË¢´ÈÅóÊºèÔºõ Â¶ÇÊûúÊù°‰ª∂ 2 Ë¢´ÈÅøÂÖçÔºåÂç≥‰æøÁôΩËâ≤ÂØπË±°ÁöÑÊåáÈíàË¢´ÂÜôÂÖ•Âà∞ÈªëËâ≤ÂØπË±°‰∏≠Ôºå‰ΩÜ‰ªéÁÅ∞Ëâ≤ÂØπË±°Âá∫ÂèëÔºåÊÄªÂ≠òÂú®‰∏ÄÊù°Ê≤°ÊúâËÆøÈóÆËøáÁöÑË∑ØÂæÑÔºå‰ªéËÄåÊâæÂà∞Âà∞ËææÁôΩËâ≤ÂØπË±°ÁöÑË∑ØÂæÑÔºåÁôΩËâ≤ÂØπË±°ÊúÄÁªà‰∏ç‰ºöË¢´ÈÅóÊºè„ÄÇ Êàë‰ª¨‰∏çÂ¶®Â∞Ü‰∏âËâ≤‰∏çÂèòÊÄßÊâÄÂÆö‰πâÁöÑÊ≥¢Èù¢Ê†πÊçÆËøô‰∏§‰∏™Êù°‰ª∂ËøõË°åÂâäÂº±Ôºö ÂΩìÊª°Ë∂≥ÂéüÊúâÁöÑ‰∏âËâ≤‰∏çÂèòÊÄßÂÆö‰πâÔºàÊàñ‰∏äÈù¢ÁöÑ‰∏§‰∏™Êù°‰ª∂ÈÉΩ‰∏çÊª°Ë∂≥Êó∂ÔºâÁöÑÊÉÖÂÜµÁß∞‰∏∫Âº∫‰∏âËâ≤‰∏çÂèòÊÄßÔºàstrong tricolor invariantÔºâ ÂΩìËµãÂÄºÂô®‰ª§ÈªëËâ≤ÂØπË±°ÂºïÁî®ÁôΩËâ≤ÂØπË±°Êó∂ÔºàÊª°Ë∂≥Êù°‰ª∂ 1 Êó∂ÔºâÁöÑÊÉÖÂÜµÁß∞‰∏∫Âº±‰∏âËâ≤‰∏çÂèòÊÄßÔºàweak tricolor invariantÔºâ ÂΩìËµãÂÄºÂô®Ëøõ‰∏ÄÊ≠•Á†¥ÂùèÁÅ∞Ëâ≤ÂØπË±°Âà∞ËææÁôΩËâ≤ÂØπË±°ÁöÑË∑ØÂæÑÊó∂ÔºàËøõ‰∏ÄÊ≠•Êª°Ë∂≥Êù°‰ª∂ 2 Êó∂ÔºâÔºåÂç≥ÊâìÁ†¥Âº±‰∏âËâ≤‰∏çÂèòÊÄßÔºå‰πüÂ∞±Á†¥Âùè‰∫ÜÂõûÊî∂Âô®ÁöÑÊ≠£Á°ÆÊÄßÔºõÊàñËÄÖËØ¥ÔºåÂú®Á†¥ÂùèÂº∫Âº±‰∏âËâ≤‰∏çÂèòÊÄßÊó∂ÂøÖÈ°ªÂºïÂÖ•È¢ùÂ§ñÁöÑËæÖÂä©Êìç‰Ωú„ÄÇÂº±‰∏âËâ≤‰∏çÂèòÂΩ¢ÁöÑÂ•ΩÂ§ÑÂú®‰∫éÔºöÂè™Ë¶ÅÂ≠òÂú®Êú™ËÆøÈóÆÁöÑËÉΩÂ§üÂà∞ËææÁôΩËâ≤ÂØπË±°ÁöÑË∑ØÂæÑÔºåÂ∞±ÂèØ‰ª•Â∞ÜÈªëËâ≤ÂØπË±°ÊåáÂêëÁôΩËâ≤ÂØπË±°„ÄÇ Â¶ÇÊûúÊàë‰ª¨ËÄÉËôëÂπ∂ÂèëÁöÑÁî®Êà∑ÊÄÅ‰ª£Á†ÅÔºåÂõûÊî∂Âô®‰∏çÂÖÅËÆ∏ÂêåÊó∂ÂÅúÊ≠¢ÊâÄÊúâËµãÂÄºÂô®ÔºåÂ∞±ÊòØÊ∂âÂèä‰∫ÜÂ≠òÂú®ÁöÑÂ§ö‰∏™‰∏çÂêåÁä∂ÊÄÅÁöÑËµãÂÄºÂô®„ÄÇ‰∏∫‰∫ÜÂØπÊ¶ÇÂøµÂä†‰ª•ÊòéÁ°ÆÔºåËøòÈúÄË¶ÅÊç¢‰∏Ä‰∏™ËßíÂ∫¶ÔºåÊääÂõûÊî∂Âô®ËßÜ‰∏∫ÂØπË±°ÔºåÊääËµãÂÄºÂô®ËßÜ‰∏∫ÂΩ±ÂìçÂõûÊî∂Âô®Ëøô‰∏ÄÂØπË±°ÁöÑÂÆûÈôÖË°å‰∏∫ÔºàÂç≥ÂΩ±Âìç GC Âë®ÊúüÁöÑÈïøÁü≠ÔºâÔºå‰ªéËÄåÂºïÂÖ•ËµãÂÄºÂô®ÁöÑÈ¢úËâ≤Ôºö ÈªëËâ≤ËµãÂÄºÂô®ÔºöÂ∑≤ÁªèÁî±ÂõûÊî∂Âô®Êâ´ÊèèËøáÔºå‰∏ç‰ºöÂÜçÊ¨°ÂØπÂÖ∂ËøõË°åÊâ´Êèè„ÄÇ ÁÅ∞Ëâ≤ËµãÂÄºÂô®ÔºöÂ∞öÊú™Ë¢´ÂõûÊî∂Âô®Êâ´ÊèèËøáÔºåÊàñÂ∞ΩÁÆ°Â∑≤ÁªèÊâ´ÊèèËøá‰ΩÜ‰ªçÈúÄË¶ÅÈáçÊñ∞Êâ´Êèè„ÄÇ ËµãÂÄºÂô®ÁöÑÈ¢úËâ≤ÂØπÂõûÊî∂Âë®ÊúüÁöÑÁªìÊùü‰∫ßÁîüÂΩ±ÂìçÔºö Â¶ÇÊûúÊüêÁßçÂπ∂ÂèëÂõûÊî∂Âô®ÂÖÅËÆ∏ÁÅ∞Ëâ≤ËµãÂÄºÂô®ÁöÑÂ≠òÂú®ÔºåÂàôÂøÖÈ°ªÂú®ÂõûÊî∂ÁªìÊùü‰πãÂâçÈáçÊñ∞Êâ´ÊèèÂØπË±°Âõæ„ÄÇ Â¶ÇÊûúÈáçÊñ∞Êâ´ÊèèËøáÁ®ã‰∏≠ÂèëÁé∞‰∫ÜÊñ∞ÁöÑÁÅ∞Ëâ≤ÊàñÁôΩËâ≤ÂØπË±°ÔºåÂõûÊî∂Âô®ËøòÈúÄË¶ÅÂØπÊñ∞ÂèëÁé∞ÁöÑÂØπË±°ËøõË°åËøΩË∏™Ôºå‰ΩÜÊòØÂú®Êñ∞ËøΩË∏™ÁöÑËøáÁ®ã‰∏≠ÔºåËµãÂÄºÂô®‰ªçÁÑ∂ÂèØËÉΩÂú®ÂÖ∂Ê†π‰∏≠ÊèíÂÖ•Êñ∞ÁöÑÈùûÈªëËâ≤ÁöÑÂºïÁî®ÔºåÂ¶ÇÊ≠§ÂæÄÂ§çÔºåÁõ¥Âà∞ÈáçÊñ∞Êâ´ÊèèËøáÁ®ã‰∏≠Ê≤°ÊúâÂèëÁé∞Êñ∞ÁöÑÁôΩËâ≤ÊàñÁÅ∞Ëâ≤ÂØπË±°„ÄÇ ‰∫éÊòØÔºåÂú®ÂÖÅËÆ∏ÁÅ∞Ëâ≤ËµãÂÄºÂô®Â≠òÂú®ÁöÑÁÆóÊ≥ïÔºåÊúÄÂùèÁöÑÊÉÖÂÜµ‰∏ãÔºåÂõûÊî∂Âô®Âè™ËÉΩÂ∞ÜÊâÄÊúâËµãÂÄºÂô®Á∫øÁ®ãÂÅúÊ≠¢ÊâçËÉΩÂÆåÊàêÂÖ∂Ë∑üÂØπË±°ÁöÑÂÆåÊï¥Êâ´ÊèèÔºå‰πüÂ∞±ÊòØÊàë‰ª¨ÊâÄËØ¥ÁöÑ STW„ÄÇ ‰∏∫‰∫ÜÁ°Æ‰øùÂº∫Âº±‰∏âËâ≤‰∏çÂèòÊÄßÁöÑÂπ∂ÂèëÊåáÈíàÊõ¥Êñ∞Êìç‰ΩúÔºåÈúÄË¶ÅÈÄöËøáËµãÂÄºÂô®Â±èÈöúÊäÄÊúØÊù•‰øùËØÅÊåáÈíàÁöÑËØªÂÜôÊìç‰Ωú‰∏ÄËá¥„ÄÇÂõ†Ê≠§Êàë‰ª¨ÊâÄËØ¥ÁöÑ Go ‰∏≠ÁöÑÂÜôÂ±èÈöú„ÄÅÊ∑∑ÂêàÂÜôÂ±èÈöúÔºåÂÖ∂ÂÆûÊòØÊåáËµãÂÄºÂô®ÁöÑÂÜôÂ±èÈöúÔºåËµãÂÄºÂô®ÁöÑÂÜôÂ±èÈöúÁî®Êù•‰øùËØÅËµãÂÄºÂô®Âú®ËøõË°åÊåáÈíàÂÜôÊìç‰ΩúÊó∂Ôºå‰∏ç‰ºöÁ†¥ÂùèÂº±‰∏âËâ≤‰∏çÂèòÊÄß„ÄÇ Êúâ‰∏§ÁßçÈùûÂ∏∏ÁªèÂÖ∏ÁöÑÂÜôÂ±èÈöúÔºöDijkstra ÊèíÂÖ•Â±èÈöúÂíå Yuasa Âà†Èô§Â±èÈöú„ÄÇ ÁÅ∞Ëâ≤ËµãÂÄºÂô®ÁöÑ Dijkstra ÊèíÂÖ•Â±èÈöúÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÊòØÈÅøÂÖçÊª°Ë∂≥Êù°‰ª∂ 1Ôºö 12345// ÁÅ∞Ëâ≤ËµãÂÄºÂô® Dijkstra ÊèíÂÖ•Â±èÈöúfunc DijkstraWritePointer(slot *unsafe.Pointer, ptr unsafe.Pointer) &#123; shade(ptr) *slot = ptr&#125; ‰∏∫‰∫ÜÈò≤Ê≠¢ÈªëËâ≤ÂØπË±°ÊåáÂêëÁôΩËâ≤ÂØπË±°ÔºåÂ∫îËØ•ÂÅáËÆæ *slot ÂèØËÉΩ‰ºöÂèò‰∏∫ÈªëËâ≤Ôºå‰∏∫‰∫ÜÁ°Æ‰øù ptr ‰∏ç‰ºöÂú®Ë¢´ËµãÂÄºÂà∞ *slot ÂâçÂèò‰∏∫ÁôΩËâ≤Ôºåshade(ptr) ‰ºöÂÖàÂ∞ÜÊåáÈíà ptr Ê†áËÆ∞‰∏∫ÁÅ∞Ëâ≤ÔºåËøõËÄåÈÅøÂÖç‰∫ÜÊù°‰ª∂ 1„ÄÇ‰ΩÜÊòØÔºåÁî±‰∫éÂπ∂‰∏çÊ∏ÖÊ•öËµãÂÄºÂô®‰ª•Âêé‰ºö‰∏ç‰ºöÂ∞ÜËøô‰∏™ÂºïÁî®Âà†Èô§ÔºåÂõ†Ê≠§ËøòÈúÄË¶ÅÈáçÊñ∞Êâ´ÊèèÊù•ÈáçÊñ∞Á°ÆÂÆöÂÖ≥Á≥ªÂõæÔºåËøôÊó∂ÈúÄË¶Å STWÔºåÂ¶ÇÂõæÊâÄÁ§∫Ôºö Dijkstra ÊèíÂÖ•Â±èÈöúÁöÑÂ•ΩÂ§ÑÂú®‰∫éÂèØ‰ª•Á´ãÂàªÂºÄÂßãÂπ∂ÂèëÊ†áËÆ∞Ôºå‰ΩÜÁî±‰∫é‰∫ßÁîü‰∫ÜÁÅ∞Ëâ≤ËµãÂÄºÂô®ÔºåÁº∫Èô∑ÊòØÈúÄË¶ÅÊ†áËÆ∞ÁªàÊ≠¢Èò∂ÊÆµ STW Êó∂ËøõË°åÈáçÊñ∞Êâ´Êèè„ÄÇ ÈªëËâ≤ËµãÂÄºÂô®ÁöÑ Yuasa Âà†Èô§Â±èÈöúÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÊòØÈÅøÂÖçÊª°Ë∂≥Êù°‰ª∂ 2Ôºö 12345// ÈªëËâ≤ËµãÂÄºÂô® Yuasa Â±èÈöúfunc YuasaWritePointer(slot *unsafe.Pointer, ptr unsafe.Pointer) &#123; shade(*slot) *slot = ptr&#125; ‰∏∫‰∫ÜÈò≤Ê≠¢‰∏¢Â§±‰ªéÁÅ∞Ëâ≤ÂØπË±°Âà∞ÁôΩËâ≤ÂØπË±°ÁöÑË∑ØÂæÑÔºåÂ∫îËØ•ÂÅáËÆæ *slot ÂèØËÉΩ‰ºöÂèò‰∏∫ÈªëËâ≤Ôºå‰∏∫‰∫ÜÁ°Æ‰øù ptr ‰∏ç‰ºöÂú®Ë¢´ËµãÂÄºÂà∞ *slot ÂâçÂèò‰∏∫ÁôΩËâ≤Ôºåshade(*slot) ‰ºöÂÖàÂ∞Ü *slot Ê†áËÆ∞‰∏∫ÁÅ∞Ëâ≤ÔºåËøõËÄåËØ•ÂÜôÊìç‰ΩúÊÄªÊòØÂàõÈÄ†‰∫Ü‰∏ÄÊù°ÁÅ∞Ëâ≤Âà∞ÁÅ∞Ëâ≤ÊàñËÄÖÁÅ∞Ëâ≤Âà∞ÁôΩËâ≤ÂØπË±°ÁöÑË∑ØÂæÑÔºåËøõËÄåÈÅøÂÖç‰∫ÜÊù°‰ª∂ 2„ÄÇ Yuasa Âà†Èô§Â±èÈöúÁöÑ‰ºòÂäøÂàôÂú®‰∫é‰∏çÈúÄË¶ÅÊ†áËÆ∞ÁªìÊùüÈò∂ÊÆµÁöÑÈáçÊñ∞Êâ´ÊèèÔºåÁº∫Èô∑ÊòØ‰æùÁÑ∂‰ºö‰∫ßÁîü‰∏¢Â§±ÁöÑÂØπË±°ÔºåÈúÄË¶ÅÂú®Ê†áËÆ∞ÂºÄÂßãÂâçÂØπÊï¥‰∏™ÂØπË±°ÂõæËøõË°åÂø´ÁÖß„ÄÇ Go Âú® 1.8 ÁöÑÊó∂ÂÄô‰∏∫‰∫ÜÁÆÄÂåñ GC ÁöÑÊµÅÁ®ãÔºåÂêåÊó∂ÂáèÂ∞ëÊ†áËÆ∞ÁªàÊ≠¢Èò∂ÊÆµÁöÑÈáçÊâ´ÊàêÊú¨ÔºåÂ∞Ü Dijkstra ÊèíÂÖ•Â±èÈöúÂíå Yuasa Âà†Èô§Â±èÈöúËøõË°åÊ∑∑ÂêàÔºåÂΩ¢ÊàêÊ∑∑ÂêàÂÜôÂ±èÈöú„ÄÇËØ•Â±èÈöúÊèêÂá∫Êó∂ÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÊòØÔºöÂØπÊ≠£Âú®Ë¢´Ë¶ÜÁõñÁöÑÂØπË±°ËøõË°åÁùÄËâ≤Ôºå‰∏îÂ¶ÇÊûúÂΩìÂâçÊ†àÊú™Êâ´ÊèèÂÆåÊàêÔºåÂàôÂêåÊ†∑ÂØπÊåáÈíàËøõË°åÁùÄËâ≤„ÄÇ ‰ΩÜÂú®ÊúÄÁªàÂÆûÁé∞Êó∂ÂéüÊèêÊ°à‰∏≠ÂØπ ptr ÁöÑÁùÄËâ≤ËøòÈ¢ùÂ§ñÂåÖÂê´ÂØπÊâßË°åÊ†àÁöÑÁùÄËâ≤Ê£ÄÊü•Ôºå‰ΩÜÁî±‰∫éÊó∂Èó¥ÊúâÈôêÔºåÂπ∂Êú™ÂÆåÊï¥ÂÆûÁé∞ËøáÔºåÊâÄ‰ª•Ê∑∑ÂêàÂÜôÂ±èÈöúÂú®ÁõÆÂâçÁöÑÂÆûÁé∞‰º™‰ª£Á†ÅÊòØÔºö 123456// Ê∑∑ÂêàÂÜôÂ±èÈöúfunc HybridWritePointerSimple(slot *unsafe.Pointer, ptr unsafe.Pointer) &#123; shade(*slot) shade(ptr) *slot = ptr&#125; Âú®Ëøô‰∏™ÂÆûÁé∞‰∏≠ÔºåÂ¶ÇÊûúÊó†Êù°‰ª∂ÂØπÂºïÁî®ÂèåÊñπËøõË°åÁùÄËâ≤ÔºåËá™ÁÑ∂ÁªìÂêà‰∫Ü Dijkstra Âíå Yuasa ÂÜôÂ±èÈöúÁöÑ‰ºòÂäøÔºå‰ΩÜÁº∫ÁÇπ‰πüÈùûÂ∏∏ÊòéÊòæÔºåÂõ†‰∏∫ÁùÄËâ≤ÊàêÊú¨ÊòØÂèåÂÄçÁöÑÔºåËÄå‰∏îÁºñËØëÂô®ÈúÄË¶ÅÊèíÂÖ•ÁöÑ‰ª£Á†Å‰πüÊàêÂÄçÂ¢ûÂä†ÔºåÈöè‰πãÂ∏¶Êù•ÁöÑÁªìÊûúÂ∞±ÊòØÁºñËØëÂêéÁöÑ‰∫åËøõÂà∂Êñá‰ª∂Â§ßÂ∞è‰πüËøõ‰∏ÄÊ≠•Â¢ûÂä†„ÄÇ‰∏∫‰∫ÜÈíàÂØπÂÜôÂ±èÈöúÁöÑÊÄßËÉΩËøõË°å‰ºòÂåñÔºåGo 1.10 ÂâçÂêéÔºåGo Âõ¢ÈòüÈöèÂêéÂÆûÁé∞‰∫ÜÊâπÈáèÂÜôÂ±èÈöúÊú∫Âà∂„ÄÇÂÖ∂Âü∫Êú¨ÊÉ≥Ê≥ïÊòØÂ∞ÜÈúÄË¶ÅÁùÄËâ≤ÁöÑÊåáÈíàÂêå‰∏ÄÂÜôÂÖ•‰∏Ä‰∏™ÁºìÂ≠òÔºåÊØèÂΩìÁºìÂ≠òÊª°Êó∂Áªü‰∏ÄÂØπÁºìÂ≠ò‰∏≠ÁöÑÊâÄÊúâ ptr ÊåáÈíàËøõË°åÁùÄËâ≤„ÄÇ GC ÁöÑÂÆûÁé∞ÁªÜËäÇ10. Go ËØ≠Ë®Ä‰∏≠ GC ÁöÑÊµÅÁ®ãÊòØ‰ªÄ‰πàÔºüÂΩìÂâçÁâàÊú¨ÁöÑ Go ‰ª• STW ‰∏∫ÁïåÈôêÔºåÂèØ‰ª•Â∞Ü GC ÂàíÂàÜ‰∏∫‰∫î‰∏™Èò∂ÊÆµÔºö Èò∂ÊÆµ ËØ¥Êòé ËµãÂÄºÂô®Áä∂ÊÄÅ GCMark Ê†áËÆ∞ÂáÜÂ§áÈò∂ÊÆµÔºå‰∏∫Âπ∂ÂèëÊ†áËÆ∞ÂÅöÂáÜÂ§áÂ∑•‰ΩúÔºåÂêØÂä®ÂÜôÂ±èÈöú STW GCMark Êâ´ÊèèÊ†áËÆ∞Èò∂ÊÆµÔºå‰∏éËµãÂÄºÂô®Âπ∂ÂèëÊâßË°åÔºåÂÜôÂ±èÈöúÂºÄÂêØ Âπ∂Âèë GCMarkTermination Ê†áËÆ∞ÁªàÊ≠¢Èò∂ÊÆµÔºå‰øùËØÅ‰∏Ä‰∏™Âë®ÊúüÂÜÖÊ†áËÆ∞‰ªªÂä°ÂÆåÊàêÔºåÂÅúÊ≠¢ÂÜôÂ±èÈöú STW GCoff ÂÜÖÂ≠òÊ∏ÖÊâ´Èò∂ÊÆµÔºåÂ∞ÜÈúÄË¶ÅÂõûÊî∂ÁöÑÂÜÖÂ≠òÂΩíËøòÂà∞Â†Ü‰∏≠ÔºåÂÜôÂ±èÈöúÂÖ≥Èó≠ Âπ∂Âèë GCoff ÂÜÖÂ≠òÂΩíËøòÈò∂ÊÆµÔºåÂ∞ÜËøáÂ§öÁöÑÂÜÖÂ≠òÂΩíËøòÁªôÊìç‰ΩúÁ≥ªÁªüÔºåÂÜôÂ±èÈöúÂÖ≥Èó≠ Âπ∂Âèë ÂÖ∑‰ΩìËÄåË®ÄÔºåÂêÑ‰∏™Èò∂ÊÆµÁöÑËß¶ÂèëÂáΩÊï∞ÂàÜÂà´‰∏∫Ôºö 11. Ëß¶Âèë GC ÁöÑÊó∂Êú∫ÊòØ‰ªÄ‰πàÔºüGo ËØ≠Ë®Ä‰∏≠ÂØπ GC ÁöÑËß¶ÂèëÊó∂Êú∫Â≠òÂú®‰∏§ÁßçÂΩ¢ÂºèÔºö ‰∏ªÂä®Ëß¶ÂèëÔºåÈÄöËøáË∞ÉÁî® runtime.GC Êù•Ëß¶Âèë GCÔºåÊ≠§Ë∞ÉÁî®ÈòªÂ°ûÂºèÂú∞Á≠âÂæÖÂΩìÂâç GC ËøêË°åÂÆåÊØï„ÄÇ Ë¢´Âä®Ëß¶ÂèëÔºåÂàÜ‰∏∫‰∏§ÁßçÊñπÂºèÔºö ‰ΩøÁî®Á≥ªÁªüÁõëÊéßÔºåÂΩìË∂ÖËøá‰∏§ÂàÜÈíüÊ≤°Êúâ‰∫ßÁîü‰ªª‰Ωï GC Êó∂ÔºåÂº∫Âà∂Ëß¶Âèë GC„ÄÇ ‰ΩøÁî®Ê≠•Ë∞ÉÔºàPacingÔºâÁÆóÊ≥ïÔºåÂÖ∂Ê†∏ÂøÉÊÄùÊÉ≥ÊòØÊéßÂà∂ÂÜÖÂ≠òÂ¢ûÈïøÁöÑÊØî‰æã„ÄÇ ÈÄöËøá GOGC ÊàñËÄÖ debug.SetGCPercent ËøõË°åÊéßÂà∂Ôºà‰ªñ‰ª¨ÊéßÂà∂ÁöÑÊòØÂêå‰∏Ä‰∏™ÂèòÈáèÔºåÂç≥Â†ÜÁöÑÂ¢ûÈïøÁéá $\rho$Ôºâ„ÄÇÊï¥‰∏™ÁÆóÊ≥ïÁöÑËÆæËÆ°ËÄÉËôëÁöÑÊòØ‰ºòÂåñÈóÆÈ¢òÔºöÂ¶ÇÊûúËÆæ‰∏ä‰∏ÄÊ¨° GC ÂÆåÊàêÊó∂ÔºåÂÜÖÂ≠òÁöÑÊï∞Èáè‰∏∫ $H_m$Ôºàheap markedÔºâÔºå‰º∞ËÆ°ÈúÄË¶ÅËß¶Âèë GC Êó∂ÁöÑÂ†ÜÂ§ßÂ∞è $H_T$Ôºàheap triggerÔºâÔºå‰ΩøÂæóÂÆåÊàê GC Êó∂ÂÄôÁöÑÁõÆÊ†áÂ†ÜÂ§ßÂ∞è $H_g$Ôºàheap goalÔºâ ‰∏éÂÆûÈôÖÂÆåÊàêÊó∂ÂÄôÁöÑÂ†ÜÂ§ßÂ∞è $H_a$Ôºàheap actualÔºâÊúÄ‰∏∫Êé•ËøëÔºåÂç≥Ôºö $\min |H_g - H_a| = \min|(1+\rho)H_m - H_a|$„ÄÇ Èô§Ê≠§‰πãÂ§ñÔºåÊ≠•Ë∞ÉÁÆóÊ≥ïËøòÈúÄË¶ÅËÄÉËôë CPU Âà©Áî®ÁéáÁöÑÈóÆÈ¢òÔºåÊòæÁÑ∂Êàë‰ª¨‰∏çÂ∫îËØ•ËÆ©ÂûÉÂúæÂõûÊî∂Âô®Âç†Áî®ËøáÂ§öÁöÑ CPUÔºåÂç≥‰∏çÂ∫îËØ•ËÆ©ÊØè‰∏™Ë¥üË¥£ÊâßË°åÁî®Êà∑ goroutine ÁöÑÁ∫øÁ®ãÈÉΩÂú®ÊâßË°åÊ†áËÆ∞ËøáÁ®ã„ÄÇÁêÜÊÉ≥ÊÉÖÂÜµ‰∏ãÔºåÂú®Áî®Êà∑‰ª£Á†ÅÊª°ËΩΩÁöÑÊó∂ÂÄôÔºåGC ÁöÑ CPU ‰ΩøÁî®Áéá‰∏çÂ∫îËØ•Ë∂ÖËøá 25%ÔºåÂç≥Âè¶‰∏Ä‰∏™‰ºòÂåñÈóÆÈ¢òÔºöÂ¶ÇÊûúËÆæ $u_g$‰∏∫ÁõÆÊ†á CPU ‰ΩøÁî®ÁéáÔºàgoal utilizationÔºâÔºåËÄå $u_a$‰∏∫ÂÆûÈôÖ CPU ‰ΩøÁî®ÁéáÔºàactual utilizationÔºâÔºåÂàô $\min|u_g - u_a|$„ÄÇ Ê±ÇËß£Ëøô‰∏§‰∏™‰ºòÂåñÈóÆÈ¢òÁöÑÂÖ∑‰ΩìÊï∞Â≠¶Âª∫Ê®°ËøáÁ®ãÊàë‰ª¨‰∏çÂú®Ê≠§ÂÅöÊ∑±ÂÖ•ËÆ®ËÆ∫ÔºåÊúâÂÖ¥Ë∂£ÁöÑËØªËÄÖÂèØ‰ª•ÂèÇËÄÉ‰∏§‰∏™ËÆæËÆ°ÊñáÊ°£ÔºöGo 1.5 concurrent garbage collector pacing Âíå Separate soft and hard heap size goal„ÄÇ ËÆ°ÁÆó $H_T$ ÁöÑÊúÄÁªàÁªìËÆ∫Ôºà‰ªé Go 1.10 Êó∂ÂºÄÂßã $h_t$ Â¢ûÂä†‰∫Ü‰∏äÁïå $0.95 \rho$Ôºå‰ªé Go 1.14 ÂºÄÂßãÊó∂ $h_t$ Â¢ûÂä†‰∫Ü‰∏ãÁïå 0.6ÔºâÊòØÔºö ËÆæÁ¨¨ n Ê¨°Ëß¶Âèë GC Êó∂ (n &gt; 1)Ôºå‰º∞ËÆ°ÂæóÂà∞ÁöÑÂ†ÜÂ¢ûÈïøÁéá‰∏∫ $h_t^{(n)}$„ÄÅËøêË°åËøáÁ®ã‰∏≠ÁöÑÂÆûÈôÖÂ†ÜÂ¢ûÈïøÁéá‰∏∫ $h_a^{(n)}$ÔºåÁî®Êà∑ËÆæÁΩÆÁöÑÂ¢ûÈïøÁéá‰∏∫ $\rho = \text{GOGC}/100$Ôºà $\rho &gt; 0$ÔºâÂàôÁ¨¨ $n+1$ Ê¨°Âá∫Ëß¶Âèë GC Êó∂ÂÄôÔºå‰º∞ËÆ°ÁöÑÂ†ÜÂ¢ûÈïøÁéá‰∏∫Ôºö $$h_t^{(n+1)} = h_t^{(n)} + 0.5 \left[ \frac{H_g^{(n)} - H_a^{(n)}}{H_a^{(n)}} - h_t^{(n)} - \frac{u_a^{(n)}}{u_g^{(n)}} \left( h_a^{(n)} - h_t^{(n)} \right) \right]$$ ÁâπÂà´ÁöÑÔºå$h_t^{(1)} = 7 / 8$Ôºå$u_a^{(1)} = 0.25$Ôºå$u_g^{(1)} = 0.3$„ÄÇÁ¨¨‰∏ÄÊ¨°Ëß¶Âèë GC Êó∂ÔºåÂ¶ÇÊûúÂΩìÂâçÁöÑÂ†ÜÂ∞è‰∫é $4\rho$ MBÔºåÂàôÂº∫Âà∂Ë∞ÉÊï¥Âà∞ $4\rho$ MB Êó∂Ëß¶Âèë GC ÁâπÂà´ÁöÑÔºåÂΩì $h_t^{(n)}&lt;0.6$Êó∂ÔºåÂ∞ÜÂÖ∂Ë∞ÉÊï¥‰∏∫ $0.6$ÔºåÂΩì $h_t^{(n)} &gt; 0.95 \rho$ Êó∂ÔºåÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ $0.95 \rho$ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå$\rho = 1$ÔºàÂç≥ GOGC = 100ÔºâÔºåÁ¨¨‰∏ÄÊ¨°Ëß¶Âèë GC Êó∂Âº∫Âà∂ËÆæÁΩÆËß¶ÂèëÁ¨¨‰∏ÄÊ¨° GC ‰∏∫ 4MBÔºåÂèØ‰ª•ÂÜôÂ¶Ç‰∏ãÁ®ãÂ∫èËøõË°åÈ™åËØÅÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041package mainimport ( "os" "runtime" "runtime/trace" "sync/atomic")var stop uint64// ÈÄöËøáÂØπË±° P ÁöÑÈáäÊîæÁä∂ÊÄÅÔºåÊù•Á°ÆÂÆö GC ÊòØÂê¶Â∑≤ÁªèÂÆåÊàêfunc gcfinished() *int &#123; p := 1 runtime.SetFinalizer(&amp;p, func(_ *int) &#123; println("gc finished") atomic.StoreUint64(&amp;stop, 1) // ÈÄöÁü•ÂÅúÊ≠¢ÂàÜÈÖç &#125;) return &amp;p&#125;func allocate() &#123; // ÊØèÊ¨°Ë∞ÉÁî®ÂàÜÈÖç 0.25MB _ = make([]byte, int((1&lt;&lt;20)*0.25))&#125;func main() &#123; f, _ := os.Create("trace.out") defer f.Close() trace.Start(f) defer trace.Stop() gcfinished() // ÂΩìÂÆåÊàê GC Êó∂ÂÅúÊ≠¢ÂàÜÈÖç for n := 1; atomic.LoadUint64(&amp;stop) != 1; n++ &#123; println("#allocate: ", n) allocate() &#125; println("terminate")&#125; Êàë‰ª¨ÂÖàÊù•È™åËØÅÊúÄÁÆÄÂçïÁöÑ‰∏ÄÁßçÊÉÖÂÜµÔºåÂç≥Á¨¨‰∏ÄÊ¨°Ëß¶Âèë GC Êó∂ÁöÑÂ†ÜÂ§ßÂ∞èÔºö 12345678910$ go build -o main$ GODEBUG=gctrace=1 ./main#allocate: 1(...)#allocate: 20gc finishedgc 1 @0.001s 3%: 0.016+0.23+0.019 ms clock, 0.20+0.11/0.060/0.13+0.22 ms cpu, 4-&gt;5-&gt;1 MB, 5 MB goal, 12 Pscvg: 8 KB releasedscvg: inuse: 1, idle: 62, sys: 63, released: 58, consumed: 5 (MB)terminate ÈÄöËøáËøô‰∏ÄË°åÊï∞ÊçÆÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºö 1gc 1 @0.001s 3%: 0.016+0.23+0.019 ms clock, 0.20+0.11/0.060/0.13+0.22 ms cpu, 4-&gt;5-&gt;1 MB, 5 MB goal, 12 P Á®ãÂ∫èÂú®ÂÆåÊàêÁ¨¨‰∏ÄÊ¨° GC Âêé‰æøÁªàÊ≠¢‰∫ÜÁ®ãÂ∫èÔºåÁ¨¶ÂêàÊàë‰ª¨ÁöÑËÆæÊÉ≥ Á¨¨‰∏ÄÊ¨° GC ÂºÄÂßãÊó∂ÁöÑÂ†ÜÂ§ßÂ∞è‰∏∫ 4MBÔºåÁ¨¶ÂêàÊàë‰ª¨ÁöÑËÆæÊÉ≥ ÂΩìÊ†áËÆ∞ÁªàÊ≠¢Êó∂ÔºåÂ†ÜÂ§ßÂ∞è‰∏∫ 5MBÔºåÊ≠§ÂêéÂºÄÂßãÊâßË°åÊ∏ÖÊâ´ÔºåËøôÊó∂ÂàÜÈÖçÊâßË°åÂà∞Á¨¨ 20 Ê¨°ÔºåÂç≥ 20*0.25 = 5MBÔºåÁ¨¶ÂêàÊàë‰ª¨ÁöÑËÆæÊÉ≥ Êàë‰ª¨Â∞ÜÂàÜÈÖçÊ¨°Êï∞Ë∞ÉÊï¥Âà∞ 50 Ê¨° 1234for n := 1; n &lt; 50; n++ &#123; println("#allocate: ", n) allocate()&#125; Êù•È™åËØÅÁ¨¨‰∫åÊ¨° GC Ëß¶ÂèëÊó∂ÊòØÂê¶Êª°Ë∂≥ÂÖ¨ÂºèÊâÄËÆ°ÁÆóÂæóÂà∞ÁöÑÂÄºÔºà‰∏∫ GODEBUG Ëøõ‰∏ÄÊ≠•ËÆæÁΩÆ gcpacertrace=1ÔºâÔºö 1234567891011121314$ go build -o main$ GODEBUG=gctrace=1,gcpacertrace=1 ./main#allocate: 1(...)pacer: H_m_prev=2236962 h_t=+8.750000e-001 H_T=4194304 h_a=+2.387451e+000 H_a=7577600 h_g=+1.442627e+000 H_g=5464064 u_a=+2.652227e-001 u_g=+3.000000e-001 W_a=152832 goalŒî=+5.676271e-001 actualŒî=+1.512451e+000 u_a/u_g=+8.840755e-001#allocate: 28gc 1 @0.001s 5%: 0.032+0.32+0.055 ms clock, 0.38+0.068/0.053/0.11+0.67 ms cpu, 4-&gt;7-&gt;3 MB, 5 MB goal, 12 P(...)#allocate: 37pacer: H_m_prev=3307736 h_t=+6.000000e-001 H_T=5292377 h_a=+7.949171e-001 H_a=5937112 h_g=+1.000000e+000 H_g=6615472 u_a=+2.658428e-001 u_g=+3.000000e-001 W_a=154240 goalŒî=+4.000000e-001 actualŒî=+1.949171e-001 u_a/u_g=+8.861428e-001#allocate: 38gc 2 @0.002s 9%: 0.017+0.26+0.16 ms clock, 0.20+0.079/0.058/0.12+1.9 ms cpu, 5-&gt;5-&gt;0 MB, 6 MB goal, 12 P Êàë‰ª¨ÂèØ‰ª•ÂæóÂà∞Êï∞ÊçÆÔºö Á¨¨‰∏ÄÊ¨°‰º∞ËÆ°ÂæóÂà∞ÁöÑÂ†ÜÂ¢ûÈïøÁéá‰∏∫ $h_t^{(1)} = 0.875$ Á¨¨‰∏ÄÊ¨°ÁöÑËøêË°åËøáÁ®ã‰∏≠ÁöÑÂÆûÈôÖÂ†ÜÂ¢ûÈïøÁéá‰∏∫ $h_a^{(1)} = 0.2387451$ Á¨¨‰∏ÄÊ¨°ÂÆûÈôÖÁöÑÂ†ÜÂ§ßÂ∞è‰∏∫ $H_a^{(1)}=7577600$ Á¨¨‰∏ÄÊ¨°ÁõÆÊ†áÁöÑÂ†ÜÂ§ßÂ∞è‰∏∫ $H_g^{(1)}=5464064$ Á¨¨‰∏ÄÊ¨°ÁöÑ CPU ÂÆûÈôÖ‰ΩøÁî®Áéá‰∏∫ $u_a^{(1)} = 0.2652227$ Á¨¨‰∏ÄÊ¨°ÁöÑ CPU ÁõÆÊ†á‰ΩøÁî®Áéá‰∏∫ $u_g^{(1)} = 0.3$ Êàë‰ª¨ÊçÆÊ≠§ËÆ°ÁÆóÁ¨¨‰∫åÊ¨°‰º∞ËÆ°ÁöÑÂ†ÜÂ¢ûÈïøÁéáÔºö $$\begin{align}h_t^{(2)} &amp;= h_t^{(1)} + 0.5 \left[ \frac{H_g^{(1)} - H_a^{(1)}}{H_a^{(1)}} - h_t^{(1)} - \frac{u_a^{(1)}}{u_g^{(1)}} \left( h_a^{(1)} - h_t^{(1)} \right) \right] \&amp;= 0.875 + 0.5 \left[ \frac{5464064 - 7577600}{5464064} - 0.875 - \frac{0.2652227}{0.3} \left( 0.2387451 - 0.875 \right) \right] \&amp; \approx 0.52534543909 \\end{align}$$ Âõ†‰∏∫ $0.52534543909 &lt; 0.6\rho = 0.6$ÔºåÂõ†Ê≠§‰∏ã‰∏ÄÊ¨°ÁöÑËß¶ÂèëÁéá‰∏∫ $h_t^{2} = 0.6$Ôºå‰∏éÊàë‰ª¨ÂÆûÈôÖËßÇÂØüÂà∞ÁöÑÁ¨¨‰∫åÊ¨° GC ÁöÑËß¶ÂèëÁéá 0.6 ÂêªÂêà„ÄÇ 12. Â¶ÇÊûúÂÜÖÂ≠òÂàÜÈÖçÈÄüÂ∫¶Ë∂ÖËøá‰∫ÜÊ†áËÆ∞Ê∏ÖÈô§ÁöÑÈÄüÂ∫¶ÊÄé‰πàÂäûÔºüÁõÆÂâçÁöÑ Go ÂÆûÁé∞‰∏≠ÔºåÂΩì GC Ëß¶ÂèëÂêéÔºå‰ºöÈ¶ñÂÖàËøõÂÖ•Âπ∂ÂèëÊ†áËÆ∞ÁöÑÈò∂ÊÆµ„ÄÇÂπ∂ÂèëÊ†áËÆ∞‰ºöËÆæÁΩÆ‰∏Ä‰∏™Ê†áÂøóÔºåÂπ∂Âú® mallocgc Ë∞ÉÁî®Êó∂ËøõË°åÊ£ÄÊü•„ÄÇÂΩìÂ≠òÂú®Êñ∞ÁöÑÂÜÖÂ≠òÂàÜÈÖçÊó∂Ôºå‰ºöÊöÇÂÅúÂàÜÈÖçÂÜÖÂ≠òËøáÂø´ÁöÑÈÇ£‰∫õ goroutineÔºåÂπ∂Â∞ÜÂÖ∂ËΩ¨ÂéªÊâßË°å‰∏Ä‰∫õËæÖÂä©Ê†áËÆ∞ÔºàMark AssistÔºâÁöÑÂ∑•‰ΩúÔºå‰ªéËÄåËææÂà∞ÊîæÁºìÁªßÁª≠ÂàÜÈÖç„ÄÅËæÖÂä© GC ÁöÑÊ†áËÆ∞Â∑•‰ΩúÁöÑÁõÆÁöÑ„ÄÇ ÁºñËØëÂô®‰ºöÂàÜÊûêÁî®Êà∑‰ª£Á†ÅÔºåÂπ∂Âú®ÈúÄË¶ÅÂàÜÈÖçÂÜÖÂ≠òÁöÑ‰ΩçÁΩÆÔºåÂ∞ÜÁî≥ËØ∑ÂÜÖÂ≠òÁöÑÊìç‰ΩúÁøªËØë‰∏∫ mallocgc Ë∞ÉÁî®ÔºåËÄå mallocgc ÁöÑÂÆûÁé∞ÂÜ≥ÂÆö‰∫ÜÊ†áËÆ∞ËæÖÂä©ÁöÑÂÆûÁé∞ÔºåÂÖ∂‰º™‰ª£Á†ÅÊÄùË∑ØÂ¶Ç‰∏ãÔºö 12345678func mallocgc(t typ.Type, size uint64) &#123; if enableMarkAssist &#123; // ËøõË°åÊ†áËÆ∞ËæÖÂä©ÔºåÊ≠§Êó∂Áî®Êà∑‰ª£Á†ÅÊ≤°ÊúâÂæóÂà∞ÊâßË°å (...) &#125; // ÊâßË°åÂÜÖÂ≠òÂàÜÈÖç (...)&#125; GC ÁöÑ‰ºòÂåñÈóÆÈ¢ò13. GC ÂÖ≥Ê≥®ÁöÑÊåáÊ†áÊúâÂì™‰∫õÔºüGo ÁöÑ GC Ë¢´ËÆæËÆ°‰∏∫ÊàêÊØî‰æãËß¶Âèë„ÄÅÂ§ßÈÉ®ÂàÜÂ∑•‰Ωú‰∏éËµãÂÄºÂô®Âπ∂Âèë„ÄÅ‰∏çÂàÜ‰ª£„ÄÅÊó†ÂÜÖÂ≠òÁßªÂä®‰∏î‰ºö‰∏ªÂä®ÂêëÊìç‰ΩúÁ≥ªÁªüÂΩíËøòÁî≥ËØ∑ÁöÑÂÜÖÂ≠ò„ÄÇÂõ†Ê≠§ÊúÄ‰∏ªË¶ÅÂÖ≥Ê≥®ÁöÑ„ÄÅËÉΩÂ§üÂΩ±ÂìçËµãÂÄºÂô®ÁöÑÊÄßËÉΩÊåáÊ†áÊúâÔºö CPU Âà©Áî®ÁéáÔºöÂõûÊî∂ÁÆóÊ≥ï‰ºöÂú®Â§öÂ§ßÁ®ãÂ∫¶‰∏äÊãñÊÖ¢Á®ãÂ∫èÔºüÊúâÊó∂ÂÄôÔºåËøô‰∏™ÊòØÈÄöËøáÂõûÊî∂Âç†Áî®ÁöÑ CPU Êó∂Èó¥‰∏éÂÖ∂ÂÆÉ CPU Êó∂Èó¥ÁöÑÁôæÂàÜÊØîÊù•ÊèèËø∞ÁöÑ„ÄÇ GC ÂÅúÈ°øÊó∂Èó¥ÔºöÂõûÊî∂Âô®‰ºöÈÄ†ÊàêÂ§öÈïøÊó∂Èó¥ÁöÑÂÅúÈ°øÔºüÁõÆÂâçÁöÑ GC ‰∏≠ÈúÄË¶ÅËÄÉËôë STW Âíå Mark Assist ‰∏§‰∏™ÈÉ®ÂàÜÂèØËÉΩÈÄ†ÊàêÁöÑÂÅúÈ°ø„ÄÇ GC ÂÅúÈ°øÈ¢ëÁéáÔºöÂõûÊî∂Âô®ÈÄ†ÊàêÁöÑÂÅúÈ°øÈ¢ëÁéáÊòØÊÄéÊ†∑ÁöÑÔºüÁõÆÂâçÁöÑ GC ‰∏≠ÈúÄË¶ÅËÄÉËôë STW Âíå Mark Assist ‰∏§‰∏™ÈÉ®ÂàÜÂèØËÉΩÈÄ†ÊàêÁöÑÂÅúÈ°ø„ÄÇ GC ÂèØÊâ©Â±ïÊÄßÔºöÂΩìÂ†ÜÂÜÖÂ≠òÂèòÂ§ßÊó∂ÔºåÂûÉÂúæÂõûÊî∂Âô®ÁöÑÊÄßËÉΩÂ¶Ç‰ΩïÔºü‰ΩÜÂ§ßÈÉ®ÂàÜÁöÑÁ®ãÂ∫èÂèØËÉΩÂπ∂‰∏ç‰∏ÄÂÆöÂÖ≥ÂøÉËøô‰∏™ÈóÆÈ¢ò„ÄÇ 14. Go ÁöÑ GC Â¶Ç‰ΩïË∞É‰ºòÔºüGo ÁöÑ GC Ë¢´ËÆæËÆ°‰∏∫ÊûÅËá¥ÁÆÄÊ¥ÅÔºå‰∏éËæÉ‰∏∫ÊàêÁÜüÁöÑ Java GC ÁöÑÊï∞ÂçÅ‰∏™ÂèØÊéßÂèÇÊï∞Áõ∏ÊØîÔºå‰∏•Ê†ºÊÑè‰πâ‰∏äÊù•ËÆ≤ÔºåGo ÂèØ‰æõÁî®Êà∑Ë∞ÉÊï¥ÁöÑÂèÇÊï∞Âè™Êúâ GOGC ÁéØÂ¢ÉÂèòÈáè„ÄÇÂΩìÊàë‰ª¨Ë∞àËÆ∫ GC Ë∞É‰ºòÊó∂ÔºåÈÄöÂ∏∏ÊòØÊåáÂáèÂ∞ëÁî®Êà∑‰ª£Á†ÅÂØπ GC ‰∫ßÁîüÁöÑÂéãÂäõÔºåËøô‰∏ÄÊñπÈù¢ÂåÖÂê´‰∫ÜÂáèÂ∞ëÁî®Êà∑‰ª£Á†ÅÂàÜÈÖçÂÜÖÂ≠òÁöÑÊï∞ÈáèÔºàÂç≥ÂØπÁ®ãÂ∫èÁöÑ‰ª£Á†ÅË°å‰∏∫ËøõË°åË∞É‰ºòÔºâÔºåÂè¶‰∏ÄÊñπÈù¢ÂåÖÂê´‰∫ÜÊúÄÂ∞èÂåñ Go ÁöÑ GC ÂØπ CPU ÁöÑ‰ΩøÁî®ÁéáÔºàÂç≥Ë∞ÉÊï¥ GOGCÔºâ„ÄÇ GC ÁöÑË∞É‰ºòÊòØÂú®ÁâπÂÆöÂú∫ÊôØ‰∏ã‰∫ßÁîüÁöÑÔºåÂπ∂ÈùûÊâÄÊúâÁ®ãÂ∫èÈÉΩÈúÄË¶ÅÈíàÂØπ GC ËøõË°åË∞É‰ºò„ÄÇÂè™ÊúâÈÇ£‰∫õÂØπÊâßË°åÂª∂ËøüÈùûÂ∏∏ÊïèÊÑü„ÄÅÂΩì GC ÁöÑÂºÄÈîÄÊàê‰∏∫Á®ãÂ∫èÊÄßËÉΩÁì∂È¢àÁöÑÁ®ãÂ∫èÔºåÊâçÈúÄË¶ÅÈíàÂØπ GC ËøõË°åÊÄßËÉΩË∞É‰ºòÔºåÂá†‰πé‰∏çÂ≠òÂú®‰∫éÂÆûÈôÖÂºÄÂèë‰∏≠ 99% ÁöÑÊÉÖÂÜµ„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåGo ÁöÑ GC ‰πü‰ªçÁÑ∂Êúâ‰∏ÄÂÆöÁöÑÂèØÊîπËøõÁöÑÁ©∫Èó¥Ôºå‰πüÊúâÈÉ®ÂàÜ GC ÈÄ†ÊàêÁöÑÈóÆÈ¢òÔºåÁõÆÂâç‰ªçÂ±û‰∫é Open Problem„ÄÇ ÊÄªÁöÑÊù•ËØ¥ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®Áé∞Âú®ÁöÑÂºÄÂèë‰∏≠Â§ÑÁêÜÁöÑÊúâ‰ª•‰∏ãÂá†ÁßçÊÉÖÂÜµÔºö ÂØπÂÅúÈ°øÊïèÊÑüÔºöGC ËøáÁ®ã‰∏≠‰∫ßÁîüÁöÑÈïøÊó∂Èó¥ÂÅúÈ°ø„ÄÅÊàñÁî±‰∫éÈúÄË¶ÅÊâßË°å GC ËÄåÊ≤°ÊúâÊâßË°åÁî®Êà∑‰ª£Á†ÅÔºåÂØºËá¥ÈúÄË¶ÅÁ´ãÂç≥ÊâßË°åÁöÑÁî®Êà∑‰ª£Á†ÅÊâßË°åÊªûÂêé„ÄÇ ÂØπËµÑÊ∫êÊ∂àËÄóÊïèÊÑüÔºöÂØπ‰∫éÈ¢ëÁπÅÂàÜÈÖçÂÜÖÂ≠òÁöÑÂ∫îÁî®ËÄåË®ÄÔºåÈ¢ëÁπÅÂàÜÈÖçÂÜÖÂ≠òÂ¢ûÂä† GC ÁöÑÂ∑•‰ΩúÈáèÔºåÂéüÊú¨ÂèØ‰ª•ÂÖÖÂàÜÂà©Áî® CPU ÁöÑÂ∫îÁî®‰∏çÂæó‰∏çÈ¢ëÁπÅÂú∞ÊâßË°åÂûÉÂúæÂõûÊî∂ÔºåÂΩ±ÂìçÁî®Êà∑‰ª£Á†ÅÂØπ CPU ÁöÑÂà©Áî®ÁéáÔºåËøõËÄåÂΩ±ÂìçÁî®Êà∑‰ª£Á†ÅÁöÑÊâßË°åÊïàÁéá„ÄÇ ‰ªéËøô‰∏§ÁÇπÊù•ÁúãÔºåÊâÄË∞ì GC Ë∞É‰ºòÁöÑÊ†∏ÂøÉÊÄùÊÉ≥‰πüÂ∞±ÊòØÂÖÖÂàÜÁöÑÂõ¥Áªï‰∏äÈù¢ÁöÑ‰∏§ÁÇπÊù•Â±ïÂºÄÔºö‰ºòÂåñÂÜÖÂ≠òÁöÑÁî≥ËØ∑ÈÄüÂ∫¶ÔºåÂ∞ΩÂèØËÉΩÁöÑÂ∞ëÁî≥ËØ∑ÂÜÖÂ≠òÔºåÂ§çÁî®Â∑≤Áî≥ËØ∑ÁöÑÂÜÖÂ≠ò„ÄÇÊàñËÄÖÁÆÄÂçïÊù•ËØ¥Ôºå‰∏çÂ§ñ‰πéËøô‰∏â‰∏™ÂÖ≥ÈîÆÂ≠óÔºöÊéßÂà∂„ÄÅÂáèÂ∞ë„ÄÅÂ§çÁî®„ÄÇ Êàë‰ª¨Â∞ÜÈÄöËøá‰∏â‰∏™ÂÆûÈôÖ‰æãÂ≠ê‰ªãÁªçÂ¶Ç‰ΩïÂÆö‰Ωç GC ÁöÑÂ≠òÂú®ÁöÑÈóÆÈ¢òÔºåÂπ∂‰∏ÄÊ≠•‰∏ÄÊ≠•ËøõË°åÊÄßËÉΩË∞É‰ºò„ÄÇÂΩìÁÑ∂ÔºåÂú®ÂÆûÈôÖÊÉÖÂÜµ‰∏≠ÈóÆÈ¢òËøúÊØîËøô‰∫õ‰æãÂ≠êË¶ÅÂ§çÊùÇÔºåËøôÈáå‰πüÂè™ÊòØËÆ®ËÆ∫Ë∞É‰ºòÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÔºåÊõ¥Â§öÁöÑÊó∂ÂÄô‰πüÂè™ËÉΩÂÖ∑‰ΩìÈóÆÈ¢òÂÖ∑‰ΩìÂàÜÊûê„ÄÇ ‰æã1ÔºöÂêàÁêÜÂåñÂÜÖÂ≠òÂàÜÈÖçÁöÑÈÄüÂ∫¶„ÄÅÊèêÈ´òËµãÂÄºÂô®ÁöÑ CPU Âà©Áî®ÁéáÊàë‰ª¨Êù•ÁúãËøôÊ†∑‰∏Ä‰∏™‰æãÂ≠ê„ÄÇÂú®Ëøô‰∏™‰æãÂ≠ê‰∏≠Ôºåconcat ÂáΩÊï∞Ë¥üË¥£ÊãºÊé•‰∏Ä‰∫õÈïøÂ∫¶‰∏çÁ°ÆÂÆöÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇÂπ∂‰∏î‰∏∫‰∫ÜÂø´ÈÄüÂÆåÊàê‰ªªÂä°ÔºåÂá∫‰∫éÊüêÁßçÂéüÂõ†ÔºåÂú®‰∏§‰∏™ÂµåÂ•óÁöÑ for Âæ™ÁéØ‰∏≠‰∏ÄÂè£Ê∞îÂàõÂª∫‰∫Ü 800 ‰∏™ goroutine„ÄÇÂú® main ÂáΩÊï∞‰∏≠ÔºåÂêØÂä®‰∫Ü‰∏Ä‰∏™ goroutine Âπ∂Âú®Á®ãÂ∫èÁªìÊùüÂâç‰∏çÊñ≠ÁöÑËß¶Âèë GCÔºåÂπ∂Â∞ùËØïËæìÂá∫ GC ÁöÑÂπ≥ÂùáÊâßË°åÊó∂Èó¥Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950package mainimport ( "fmt" "os" "runtime" "runtime/trace" "sync/atomic" "time")var ( stop int32 count int64 sum time.Duration)func concat() &#123; for n := 0; n &lt; 100; n++ &#123; for i := 0; i &lt; 8; i++ &#123; go func() &#123; s := "Go GC" s += " " + "Hello" s += " " + "World" _ = s &#125;() &#125; &#125;&#125;func main() &#123; f, _ := os.Create("trace.out") defer f.Close() trace.Start(f) defer trace.Stop() go func() &#123; var t time.Time for atomic.LoadInt32(&amp;stop) == 0 &#123; t = time.Now() runtime.GC() sum += time.Since(t) count++ &#125; fmt.Printf("GC spend avg: %v\n", time.Duration(int64(sum)/count)) &#125;() concat() atomic.StoreInt32(&amp;stop, 1)&#125; Ëøô‰∏™Á®ãÂ∫èÁöÑÊâßË°åÁªìÊûúÊòØÔºö 123$ go build -o main$ ./mainGC spend avg: 2.583421ms GC Âπ≥ÂùáÊâßË°å‰∏ÄÊ¨°ÈúÄË¶ÅÈïøËææ 2ms ÁöÑÊó∂Èó¥ÔºåÊàë‰ª¨ÂÜçËøõ‰∏ÄÊ≠•ËßÇÂØü trace ÁöÑÁªìÊûúÔºö Á®ãÂ∫èÁöÑÊï¥‰∏™ÊâßË°åËøáÁ®ã‰∏≠‰ªÖÊâßË°å‰∫Ü‰∏ÄÊ¨° GCÔºåËÄå‰∏î‰ªÖ Sweep STW Â∞±ËÄóË¥π‰∫ÜË∂ÖËøá 1 msÔºåÈùûÂ∏∏ÂèçÂ∏∏„ÄÇÁîöËá≥Êü•ÁúãËµãÂÄºÂô® mutator ÁöÑ CPU Âà©Áî®ÁéáÔºåÂú®Êï¥‰∏™ trace Â∞∫Â∫¶‰∏ãËøû 40% ÈÉΩ‰∏çÂà∞Ôºö ‰∏ªË¶ÅÂéüÂõ†ÊòØ‰ªÄ‰πàÂë¢ÔºüÊàë‰ª¨‰∏çÂ¶®Êü•Áúã goroutine ÁöÑÂàÜÊûêÔºö Âú®Ëøô‰∏™Ê¶úÂçï‰∏≠Êàë‰ª¨‰∏çÈöæÂèëÁé∞Ôºågoroutine ÁöÑÊâßË°åÊó∂Èó¥Âç†ÂÖ∂ÁîüÂëΩÂë®ÊúüÊÄªÊó∂Èó¥ÈùûÂ∏∏Áü≠ÁöÑ‰∏ÄÈÉ®ÂàÜÔºå‰ΩÜÂ§ßÈÉ®ÂàÜÊó∂Èó¥ÈÉΩËä±Ë¥πÂú®Ë∞ÉÂ∫¶Âô®ÁöÑÁ≠âÂæÖ‰∏ä‰∫ÜÔºàËìùËâ≤ÁöÑÈÉ®ÂàÜÔºâÔºåËØ¥ÊòéÂêåÊó∂ÂàõÂª∫Â§ßÈáè goroutine ÂØπË∞ÉÂ∫¶Âô®‰∫ßÁîüÁöÑÂéãÂäõÁ°ÆÂÆû‰∏çÂ∞èÔºåÊàë‰ª¨‰∏çÂ¶®Â∞ÜËøô‰∏Ä‰∫ßÁîüÈÄüÁéáÂáèÊÖ¢Ôºå‰∏ÄÊâπ‰∏ÄÊâπÂú∞ÂàõÂª∫ goroutineÔºö 12345678910111213141516func concat() &#123; wg := sync.WaitGroup&#123;&#125; for n := 0; n &lt; 100; n++ &#123; wg.Add(8) for i := 0; i &lt; 8; i++ &#123; go func() &#123; s := "Go GC" s += " " + "Hello" s += " " + "World" _ = s wg.Done() &#125;() &#125; wg.Wait() &#125;&#125; ËøôÊó∂ÂÄôÊàë‰ª¨ÂÜçÊù•ÁúãÔºö 123$ go build -o main$ ./mainGC spend avg: 328.54¬µs GC ÁöÑÂπ≥ÂùáÊó∂Èó¥Â∞±ÈôçÂà∞ 300 ÂæÆÁßí‰∫Ü„ÄÇËøôÊó∂ÁöÑËµãÂÄºÂô® CPU ‰ΩøÁî®Áéá‰πüÊèêÈ´òÂà∞‰∫Ü 60%ÔºåÁõ∏ÂØπÊù•ËØ¥Â∞±ÂæàÂèØËßÇ‰∫ÜÔºö ÂΩìÁÑ∂ÔºåËøô‰∏™Á®ãÂ∫è‰ªçÁÑ∂Êúâ‰ºòÂåñÁ©∫Èó¥Ôºå‰æãÂ¶ÇÊàë‰ª¨ÂÖ∂ÂÆûÊ≤°ÊúâÂøÖË¶ÅÁ≠âÂæÖÂæàÂ§ö goroutine ÂêåÊó∂ÊâßË°åÂÆåÊØïÊâçÂéªÊâßË°å‰∏ã‰∏ÄÁªÑ goroutine„ÄÇËÄåÂèØ‰ª•ÂΩì‰∏Ä‰∏™ goroutine ÊâßË°åÂÆåÊØïÊó∂ÔºåÁõ¥Êé•ÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑ goroutineÔºå‰πüÂ∞±ÊòØ goroutine Ê±†ÁöÑ‰ΩøÁî®„ÄÇÊúâÂÖ¥Ë∂£ÁöÑËØªËÄÖÂèØ‰ª•Ê≤øÁùÄËøô‰∏™ÊÄùË∑ØËøõ‰∏ÄÊ≠•‰ºòÂåñËøô‰∏™Á®ãÂ∫è‰∏≠ËµãÂÄºÂô®ÂØπ CPU ÁöÑ‰ΩøÁî®Áéá„ÄÇ ‰æã2ÔºöÈôç‰ΩéÂπ∂Â§çÁî®Â∑≤ÁªèÁî≥ËØ∑ÁöÑÂÜÖÂ≠òÊàë‰ª¨ÈÄöËøá‰∏Ä‰∏™ÈùûÂ∏∏ÁÆÄÂçïÁöÑ Web Á®ãÂ∫èÊù•ËØ¥ÊòéÂ§çÁî®ÂÜÖÂ≠òÁöÑÈáçË¶ÅÊÄß„ÄÇÂú®Ëøô‰∏™Á®ãÂ∫è‰∏≠ÔºåÊØèÂΩì‰∫ßÁîü‰∏Ä‰∏™ /example2ÁöÑËØ∑Ê±ÇÊó∂ÔºåÈÉΩ‰ºöÂàõÂª∫‰∏ÄÊÆµÂÜÖÂ≠òÔºåÂπ∂Áî®‰∫éËøõË°å‰∏Ä‰∫õÂêéÁª≠ÁöÑÂ∑•‰Ωú„ÄÇ 1234567891011121314151617181920212223242526272829package mainimport ( "fmt" "net/http" _ "net/http/pprof")func newBuf() []byte &#123; return make([]byte, 10&lt;&lt;20)&#125;func main() &#123; go func() &#123; http.ListenAndServe("localhost:6060", nil) &#125;() http.HandleFunc("/example2", func(w http.ResponseWriter, r *http.Request) &#123; b := newBuf() // Ê®°ÊãüÊâßË°å‰∏Ä‰∫õÂ∑•‰Ωú for idx := range b &#123; b[idx] = 1 &#125; fmt.Fprintf(w, "done, %v", r.URL.Path[1:]) &#125;) http.ListenAndServe(":8080", nil)&#125; ‰∏∫‰∫ÜËøõË°åÊÄßËÉΩÂàÜÊûêÔºåÊàë‰ª¨ËøòÈ¢ùÂ§ñÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÁõëÂê¨ 6060 Á´ØÂè£ÁöÑ goroutineÔºåÁî®‰∫é‰ΩøÁî® pprof ËøõË°åÂàÜÊûê„ÄÇÊàë‰ª¨ÂÖàËÆ©ÊúçÂä°Âô®Ë∑ëËµ∑Êù•Ôºö 12$ go build -o main$ ./main Êàë‰ª¨ËøôÊ¨°‰ΩøÁî® pprof ÁöÑ trace Êù•Êü•Áúã GC Âú®Ê≠§ÊúçÂä°Âô®‰∏≠Èù¢ÂØπÂ§ßÈáèËØ∑Ê±ÇÊó∂ÂÄôÁöÑÁä∂ÊÄÅÔºåË¶Å‰ΩøÁî® trace ÂèØ‰ª•ÈÄöËøáËÆøÈóÆ /debug/pprof/trace Ë∑ØÁî±Êù•ËøõË°åÔºåÂÖ∂‰∏≠ seconds ÂèÇÊï∞ËÆæÁΩÆ‰∏∫ 20sÔºåÂπ∂Â∞Ü trace ÁöÑÁªìÊûú‰øùÂ≠ò‰∏∫ trace.out: 1234$ wget http://127.0.0.1:6060/debug/pprof/trace\?seconds\=20 -O trace.out--2020-01-01 22:13:34-- http://127.0.0.1:6060/debug/pprof/trace?seconds=20Connecting to 127.0.0.1:6060... connected.HTTP request sent, awaiting response... ËøôÊó∂ÂÄôÊàë‰ª¨‰ΩøÁî®‰∏Ä‰∏™ÂéãÊµãÂ∑•ÂÖ∑ abÔºåÊù•ÂêåÊó∂‰∫ßÁîü 500 ‰∏™ËØ∑Ê±ÇÔºà-n ‰∏ÄÂÖ± 500 ‰∏™ËØ∑Ê±ÇÔºå-c ‰∏Ä‰∏™Êó∂ÂàªÊâßË°åËØ∑Ê±ÇÁöÑÊï∞ÈáèÔºåÊØèÊ¨° 100 ‰∏™Âπ∂ÂèëËØ∑Ê±ÇÔºâÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849$ ab -n 500 -c 100 http://127.0.0.1:8080/example2This is ApacheBench, Version 2.3 &lt;$Revision: 1843412 $&gt;Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/Licensed to The Apache Software Foundation, http://www.apache.org/Benchmarking 127.0.0.1 (be patient)Completed 100 requestsCompleted 200 requestsCompleted 300 requestsCompleted 400 requestsCompleted 500 requestsFinished 500 requestsServer Software: Server Hostname: 127.0.0.1Server Port: 8080Document Path: /example2Document Length: 14 bytesConcurrency Level: 100Time taken for tests: 0.987 secondsComplete requests: 500Failed requests: 0Total transferred: 65500 bytesHTML transferred: 7000 bytesRequests per second: 506.63 [#/sec] (mean)Time per request: 197.382 [ms] (mean)Time per request: 1.974 [ms] (mean, across all concurrent requests)Transfer rate: 64.81 [Kbytes/sec] receivedConnection Times (ms) min mean[+/-sd] median maxConnect: 0 1 1.1 0 7Processing: 13 179 77.5 170 456Waiting: 10 168 78.8 162 455Total: 14 180 77.3 171 458Percentage of the requests served within a certain time (ms) 50% 171 66% 203 75% 222 80% 239 90% 281 95% 335 98% 365 99% 400 100% 458 (longest request) GC ÂèçÂ§çË¢´Ëß¶ÂèëÔºå‰∏Ä‰∏™ÊòæËÄåÊòìËßÅÁöÑÂéüÂõ†Â∞±ÊòØÂÜÖÂ≠òÂàÜÈÖçËøáÂ§ö„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá go tool pprof Êù•Êü•ÁúãÁ©∂Á´üÊòØË∞ÅÂàÜÈÖç‰∫ÜÂ§ßÈáèÂÜÖÂ≠òÔºà‰ΩøÁî® web Êåá‰ª§Êù•‰ΩøÁî®ÊµèËßàÂô®ÊâìÂºÄÁªüËÆ°‰ø°ÊÅØÁöÑÂèØËßÜÂåñÂõæÂΩ¢ÔºâÔºö 123456789$ go tool pprof http://127.0.0.1:6060/debug/pprof/heapFetching profile over HTTP from http://localhost:6060/debug/pprof/heapSaved profile in /Users/changkun/pprof/pprof.alloc_objects.alloc_space.inuse_objects.inuse_space.003.pb.gzType: inuse_spaceTime: Jan 1, 2020 at 11:15pm (CET)Entering interactive mode (type "help" for commands, "o" for options)(pprof) web(pprof) ÂèØËßÅ newBuf ‰∫ßÁîüÁöÑÁî≥ËØ∑ÁöÑÂÜÖÂ≠òËøáÂ§öÔºåÁé∞Âú®Êàë‰ª¨‰ΩøÁî® sync.Pool Êù•Â§çÁî® newBuf ÊâÄ‰∫ßÁîüÁöÑÂØπË±°Ôºö 123456789101112131415161718192021222324252627282930package mainimport ( "fmt" "net/http" _ "net/http/pprof" "sync")// ‰ΩøÁî® sync.Pool Â§çÁî®ÈúÄË¶ÅÁöÑ bufvar bufPool = sync.Pool&#123; New: func() interface&#123;&#125; &#123; return make([]byte, 10&lt;&lt;20) &#125;,&#125;func main() &#123; go func() &#123; http.ListenAndServe("localhost:6060", nil) &#125;() http.HandleFunc("/example2", func(w http.ResponseWriter, r *http.Request) &#123; b := bufPool.Get().([]byte) for idx := range b &#123; b[idx] = 0 &#125; fmt.Fprintf(w, "done, %v", r.URL.Path[1:]) bufPool.Put(b) &#125;) http.ListenAndServe(":8080", nil)&#125; ÂÖ∂‰∏≠ ab ËæìÂá∫ÁöÑÁªüËÆ°ÁªìÊûú‰∏∫Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849$ ab -n 500 -c 100 http://127.0.0.1:8080/example2This is ApacheBench, Version 2.3 &lt;$Revision: 1843412 $&gt;Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/Licensed to The Apache Software Foundation, http://www.apache.org/Benchmarking 127.0.0.1 (be patient)Completed 100 requestsCompleted 200 requestsCompleted 300 requestsCompleted 400 requestsCompleted 500 requestsFinished 500 requestsServer Software: Server Hostname: 127.0.0.1Server Port: 8080Document Path: /example2Document Length: 14 bytesConcurrency Level: 100Time taken for tests: 0.427 secondsComplete requests: 500Failed requests: 0Total transferred: 65500 bytesHTML transferred: 7000 bytesRequests per second: 1171.32 [#/sec] (mean)Time per request: 85.374 [ms] (mean)Time per request: 0.854 [ms] (mean, across all concurrent requests)Transfer rate: 149.85 [Kbytes/sec] receivedConnection Times (ms) min mean[+/-sd] median maxConnect: 0 1 1.4 1 9Processing: 5 75 48.2 66 211Waiting: 5 72 46.8 63 207Total: 5 77 48.2 67 211Percentage of the requests served within a certain time (ms) 50% 67 66% 89 75% 107 80% 122 90% 148 95% 167 98% 196 99% 204 100% 211 (longest request) ‰ΩÜ‰ªé Requests per second ÊØèÁßíËØ∑Ê±ÇÊï∞Êù•ÁúãÔºå‰ªéÂéüÊù•ÁöÑ 506.63 Âèò‰∏∫ 1171.32 ÂæóÂà∞‰∫ÜËøë‰πé‰∏ÄÂÄçÁöÑÊèêÂçá„ÄÇ‰ªé trace ÁöÑÁªìÊûúÊù•ÁúãÔºåGC ‰πüÊ≤°ÊúâÈ¢ëÁπÅÁöÑË¢´Ëß¶Âèë‰ªéËÄåÈïøÊúüÊ∂àËÄó CPU ‰ΩøÁî®ÁéáÔºö sync.Pool ÊòØÂÜÖÂ≠òÂ§çÁî®ÁöÑ‰∏Ä‰∏™ÊúÄ‰∏∫ÊòæËëóÁöÑ‰æãÂ≠êÔºå‰ªéËØ≠Ë®ÄÂ±ÇÈù¢‰∏äËøòÊúâÂæàÂ§öÁ±ª‰ººÁöÑ‰æãÂ≠êÔºå‰æãÂ¶ÇÂú®‰æã 1 ‰∏≠Ôºåconcat ÂáΩÊï∞ÂèØ‰ª•È¢ÑÂÖàÂàÜÈÖç‰∏ÄÂÆöÈïøÂ∫¶ÁöÑÁºìÂ≠òÔºåËÄåÂêéÂÜçÈÄöËøá append ÁöÑÊñπÂºèÂ∞ÜÂ≠óÁ¨¶‰∏≤Â≠òÂÇ®Âà∞ÁºìÂ≠ò‰∏≠Ôºö 12345678910111213141516171819func concat() &#123; wg := sync.WaitGroup&#123;&#125; for n := 0; n &lt; 100; n++ &#123; wg.Add(8) for i := 0; i &lt; 8; i++ &#123; go func() &#123; s := make([]byte, 0, 20) s = append(s, "Go GC"...) s = append(s, ' ') s = append(s, "Hello"...) s = append(s, ' ') s = append(s, "World"...) _ = string(s) wg.Done() &#125;() &#125; wg.Wait() &#125;&#125; ÂéüÂõ†Âú®‰∫é + ËøêÁÆóÁ¨¶‰ºöÈöèÁùÄÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÁöÑÂ¢ûÂä†ËÄåÁî≥ËØ∑Êõ¥Â§öÁöÑÂÜÖÂ≠òÔºåÂπ∂Â∞ÜÂÜÖÂÆπ‰ªéÂéüÊù•ÁöÑÂÜÖÂ≠ò‰ΩçÁΩÆÊã∑Ë¥ùÂà∞Êñ∞ÁöÑÂÜÖÂ≠ò‰ΩçÁΩÆÔºåÈÄ†ÊàêÂ§ßÈáè‰∏çÂøÖË¶ÅÁöÑÂÜÖÂ≠òÂàÜÈÖçÔºåÂÖàÊèêÂâçÂàÜÈÖçÂ•ΩË∂≥Â§üÁöÑÂÜÖÂ≠òÔºåÂÜçÊÖ¢ÊÖ¢Âú∞Â°´ÂÖÖÔºå‰πüÊòØ‰∏ÄÁßçÂáèÂ∞ëÂÜÖÂ≠òÂàÜÈÖç„ÄÅÂ§çÁî®ÂÜÖÂ≠òÂΩ¢ÂºèÁöÑ‰∏ÄÁßçË°®Áé∞„ÄÇ ‰æã3ÔºöË∞ÉÊï¥ GOGCÊàë‰ª¨Â∑≤ÁªèÁü•ÈÅì‰∫Ü GC ÁöÑËß¶ÂèëÂéüÂàôÊòØÁî±Ê≠•Ë∞ÉÁÆóÊ≥ïÊù•ÊéßÂà∂ÁöÑÔºåÂÖ∂ÂÖ≥ÈîÆÂú®‰∫é‰º∞ËÆ°‰∏ã‰∏ÄÊ¨°ÈúÄË¶ÅËß¶Âèë GC Êó∂ÔºåÂ†ÜÁöÑÂ§ßÂ∞è„ÄÇÂèØÊÉ≥ËÄåÁü•ÔºåÂ¶ÇÊûúÊàë‰ª¨Âú®ÈÅáÂà∞Êµ∑ÈáèËØ∑Ê±ÇÁöÑÊó∂Ôºå‰∏∫‰∫ÜÈÅøÂÖç GC È¢ëÁπÅËß¶ÂèëÔºåÊòØÂê¶ÂèØ‰ª•ÈÄöËøáÂ∞Ü GOGC ÁöÑÂÄºËÆæÁΩÆÂæóÊõ¥Â§ßÔºåËÆ© GC Ëß¶ÂèëÁöÑÊó∂Èó¥ÂèòÂæóÊõ¥ÊôöÔºå‰ªéËÄåÂáèÂ∞ëÂÖ∂Ëß¶ÂèëÈ¢ëÁéáÔºåËøõËÄåÂ¢ûÂä†Áî®Êà∑‰ª£Á†ÅÂØπÊú∫Âô®ÁöÑ‰ΩøÁî®ÁéáÂë¢ÔºüÁ≠îÊ°àÊòØËÇØÂÆöÁöÑ„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÈùûÂ∏∏ÁÆÄÂçïÁ≤óÊö¥ÁöÑÂ∞Ü GOGC Ë∞ÉÊï¥‰∏∫ 1000ÔºåÊù•ÊâßË°å‰∏ä‰∏Ä‰∏™‰æãÂ≠ê‰∏≠Êú™Â§çÁî®ÂØπË±°‰πãÂâçÁöÑÁ®ãÂ∫èÔºö 1$ GOGC=1000 ./main ËøôÊó∂Êàë‰ª¨ÂÜçÈáçÊñ∞ÊâßË°åÂéãÊµãÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849$ ab -n 500 -c 100 http://127.0.0.1:8080/example2This is ApacheBench, Version 2.3 &lt;$Revision: 1843412 $&gt;Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/Licensed to The Apache Software Foundation, http://www.apache.org/Benchmarking 127.0.0.1 (be patient)Completed 100 requestsCompleted 200 requestsCompleted 300 requestsCompleted 400 requestsCompleted 500 requestsFinished 500 requestsServer Software: Server Hostname: 127.0.0.1Server Port: 8080Document Path: /example2Document Length: 14 bytesConcurrency Level: 100Time taken for tests: 0.923 secondsComplete requests: 500Failed requests: 0Total transferred: 65500 bytesHTML transferred: 7000 bytesRequests per second: 541.61 [#/sec] (mean)Time per request: 184.636 [ms] (mean)Time per request: 1.846 [ms] (mean, across all concurrent requests)Transfer rate: 69.29 [Kbytes/sec] receivedConnection Times (ms) min mean[+/-sd] median maxConnect: 0 1 1.8 0 20Processing: 9 171 210.4 66 859Waiting: 5 158 199.6 62 813Total: 9 173 210.6 68 860Percentage of the requests served within a certain time (ms) 50% 68 66% 133 75% 198 80% 292 90% 566 95% 696 98% 723 99% 743 100% 860 (longest request) ÂèØ‰ª•ÁúãÂà∞ÔºåÂéãÊµãÁöÑÁªìÊûúÂæóÂà∞‰∫Ü‰∏ÄÂÆöÂπÖÂ∫¶ÁöÑÊîπÂñÑÔºàRequests per second ‰ªéÂéüÊù•ÁöÑ 506.63 ÊèêÈ´ò‰∏∫‰∫Ü 541.61ÔºâÔºåÂπ∂‰∏î GC ÁöÑÊâßË°åÈ¢ëÁéáÊòéÊòæÈôç‰ΩéÔºö Âú®ÂÆûÈôÖÂÆûË∑µ‰∏≠ÂèØË°®Áé∞‰∏∫ÈúÄË¶ÅÁ¥ßÊÄ•Â§ÑÁêÜ‰∏Ä‰∫õÁî± GC Â∏¶Êù•ÁöÑÁì∂È¢àÊó∂Ôºå‰∫∫‰∏∫Â∞Ü GOGC Ë∞ÉÂ§ßÔºåÂä†Èí±Âä†ÂÜÖÂ≠òÔºåÊâõËøáËøô‰∏ÄÊÆµÂ≥∞ÂÄºÊµÅÈáèÊó∂Êúü„ÄÇ ÂΩìÁÑ∂ÔºåËøôÁßçÂÅöÊ≥ïÂÖ∂ÂÆûÊòØÊ≤ªÊ†á‰∏çÊ≤ªÊú¨ÔºåÂπ∂Ê≤°Êúâ‰ªéÊ†πÊú¨‰∏äËß£ÂÜ≥ÂÜÖÂ≠òÂàÜÈÖçËøá‰∫éÈ¢ëÁπÅÁöÑÈóÆÈ¢òÔºåÊûÅÁ´ØÊÉÖÂÜµ‰∏ãÔºåÂèçËÄå‰ºöÁî±‰∫é GOGC Â§™Â§ßËÄåÂØºËá¥ÂõûÊî∂‰∏çÂèäÊó∂ËÄåËÄóË¥πÊõ¥Â§öÁöÑÊó∂Èó¥Êù•Ê∏ÖÁêÜ‰∫ßÁîüÁöÑÂûÉÂúæÔºåËøôÂØπÊó∂Èó¥‰∏çÁÆóÊïèÊÑüÁöÑÂ∫îÁî®ËøòÂ•ΩÔºå‰ΩÜÂØπÂÆûÊó∂ÊÄßË¶ÅÊ±ÇËæÉÈ´òÁöÑÁ®ãÂ∫èÊù•ËØ¥Â∞±ÊòØËá¥ÂëΩÁöÑÊâìÂáª‰∫Ü„ÄÇ Âõ†Ê≠§ËøôÊó∂Êõ¥Â¶•ÂΩìÁöÑÂÅöÊ≥ï‰ªçÁÑ∂ÊòØÔºåÂÆö‰ΩçÈóÆÈ¢òÁöÑÊâÄÂú®ÔºåÂπ∂‰ªé‰ª£Á†ÅÂ±ÇÈù¢‰∏äËøõË°å‰ºòÂåñ„ÄÇ Â∞èÁªìÈÄöËøá‰∏äÈù¢ÁöÑ‰∏â‰∏™‰æãÂ≠êÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Âú® GC Ë∞É‰ºòËøáÁ®ã‰∏≠ go tool pprof Âíå go tool trace ÁöÑÂº∫Â§ß‰ΩúÁî®ÊòØÂ∏ÆÂä©Êàë‰ª¨Âø´ÈÄüÂÆö‰Ωç GC ÂØºËá¥Áì∂È¢àÁöÑÂÖ∑‰Ωì‰ΩçÁΩÆÔºå‰ΩÜËøô‰∫õ‰æãÂ≠ê‰∏≠‰ªÖ‰ªÖË¶ÜÁõñ‰∫ÜÂÖ∂ÂäüËÉΩÁöÑÂæàÂ∞è‰∏ÄÈÉ®ÂàÜÔºåÊàë‰ª¨‰πüÊ≤°ÊúâÂøÖË¶ÅÂÆåÊï¥Ë¶ÜÁõñÊâÄÊúâÁöÑÂäüËÉΩÔºåÂõ†‰∏∫ÊÄªÊòØÂèØ‰ª•ÈÄöËøáhttp pprof ÂÆòÊñπÊñáÊ°£„ÄÅruntime pprofÂÆòÊñπÊñáÊ°£‰ª•Âèätrace ÂÆòÊñπÊñáÊ°£Êù•‰∏æ‰∏ÄÂèç‰∏â„ÄÇ Áé∞Âú®Êàë‰ª¨Êù•ÊÄªÁªì‰∏Ä‰∏ãÂâçÈù¢‰∏â‰∏™‰æãÂ≠ê‰∏≠ÁöÑ‰ºòÂåñÊÉÖÂÜµÔºö ÊéßÂà∂ÂÜÖÂ≠òÂàÜÈÖçÁöÑÈÄüÂ∫¶ÔºåÈôêÂà∂ goroutine ÁöÑÊï∞ÈáèÔºå‰ªéËÄåÊèêÈ´òËµãÂÄºÂô®ÂØπ CPU ÁöÑÂà©Áî®Áéá„ÄÇ ÂáèÂ∞ëÂπ∂Â§çÁî®ÂÜÖÂ≠òÔºå‰æãÂ¶Ç‰ΩøÁî® sync.Pool Êù•Â§çÁî®ÈúÄË¶ÅÈ¢ëÁπÅÂàõÂª∫‰∏¥Êó∂ÂØπË±°Ôºå‰æãÂ¶ÇÊèêÂâçÂàÜÈÖçË∂≥Â§üÁöÑÂÜÖÂ≠òÊù•Èôç‰ΩéÂ§ö‰ΩôÁöÑÊã∑Ë¥ù„ÄÇ ÈúÄË¶ÅÊó∂ÔºåÂ¢ûÂ§ß GOGC ÁöÑÂÄºÔºåÈôç‰Ωé GC ÁöÑËøêË°åÈ¢ëÁéá„ÄÇ Ëøô‰∏âÁßçÊÉÖÂÜµÂá†‰πéÊ∂µÁõñ‰∫Ü GC Ë∞É‰ºò‰∏≠ÁöÑÊ†∏ÂøÉÊÄùË∑ØÔºåËôΩÁÑ∂‰ªéËØ≠Ë®Ä‰∏äËøòÊúâÂæàÂ§öÂ∞èÊäÄÂ∑ßÂèØËØ¥Ôºå‰ΩÜÊàë‰ª¨Âπ∂‰∏ç‰ºöÂú®ËøôÈáå‰∫ãÊó†Â∑®ÁªÜÁöÑËøõË°åÊÄªÁªì„ÄÇÂÆûÈôÖÊÉÖÂÜµ‰πüÊòØÂçÉÂèò‰∏áÂåñÔºåÊàë‰ª¨Êõ¥Â∫îËØ•ÁùÄÈáç‰∫éÂüπÂÖªÂÖ∑‰ΩìÈóÆÈ¢òÂÖ∑‰ΩìÂàÜÊûêÁöÑËÉΩÂäõ„ÄÇ ÂΩìÁÑ∂ÔºåÊàë‰ª¨ËøòÂ∫îËØ•Ë∞®ËÆ∞ ËøáÊó©‰ºòÂåñÊòØ‰∏áÊÅ∂‰πãÊ∫êËøô‰∏ÄË≠¶ËØ≠ÔºåÂú®Ê≤°ÊúâÈÅáÂà∞Â∫îÁî®ÁöÑÁúüÊ≠£Áì∂È¢àÊó∂ÔºåÂ∞ÜÂÆùË¥µÁöÑÊó∂Èó¥ÂàÜÈÖçÂú®ÂºÄÂèë‰∏≠ÂÖ∂‰ªñ‰ºòÂÖàÁ∫ßÊõ¥È´òÁöÑ‰ªªÂä°‰∏ä„ÄÇ 15. Go ÁöÑÂûÉÂúæÂõûÊî∂Âô®ÊúâÂì™‰∫õÁõ∏ÂÖ≥ÁöÑ APIÔºüÂÖ∂‰ΩúÁî®ÂàÜÂà´ÊòØ‰ªÄ‰πàÔºüÂú® Go ‰∏≠Â≠òÂú®Êï∞ÈáèÊûÅÂ∞ëÁöÑ‰∏é GC Áõ∏ÂÖ≥ÁöÑ APIÔºåÂÆÉ‰ª¨ÊòØ runtime.GCÔºöÊâãÂä®Ëß¶Âèë GC runtime.ReadMemStatsÔºöËØªÂèñÂÜÖÂ≠òÁõ∏ÂÖ≥ÁöÑÁªüËÆ°‰ø°ÊÅØÔºåÂÖ∂‰∏≠ÂåÖÂê´ÈÉ®ÂàÜ GC Áõ∏ÂÖ≥ÁöÑÁªüËÆ°‰ø°ÊÅØ debug.FreeOSMemoryÔºöÊâãÂä®Â∞ÜÂÜÖÂ≠òÂΩíËøòÁªôÊìç‰ΩúÁ≥ªÁªü debug.ReadGCStatsÔºöËØªÂèñÂÖ≥‰∫é GC ÁöÑÁõ∏ÂÖ≥ÁªüËÆ°‰ø°ÊÅØ debug.SetGCPercentÔºöËÆæÁΩÆ GOGC Ë∞ÉÊ≠•ÂèòÈáè debug.SetMaxHeapÔºàÂ∞öÊú™ÂèëÂ∏ÉÔºâÔºöËÆæÁΩÆ Go Á®ãÂ∫èÂ†ÜÁöÑ‰∏äÈôêÂÄº GC ÁöÑÂéÜÂè≤ÂèäÊºîËøõ16. Go ÂéÜÂè≤ÂêÑ‰∏™ÁâàÊú¨Âú® GC ÊñπÈù¢ÁöÑÊîπËøõÔºü Go 1Ôºö‰∏≤Ë°å‰∏âËâ≤Ê†áËÆ∞Ê∏ÖÊâ´ Go 1.3ÔºöÂπ∂Ë°åÊ∏ÖÊâ´ÔºåÊ†áËÆ∞ËøáÁ®ãÈúÄË¶Å STWÔºåÂÅúÈ°øÊó∂Èó¥Âú®Á∫¶Âá†ÁôæÊØ´Áßí Go 1.5ÔºöÂπ∂ÂèëÊ†áËÆ∞Ê∏ÖÊâ´ÔºåÂÅúÈ°øÊó∂Èó¥Âú®‰∏ÄÁôæÊØ´Áßí‰ª•ÂÜÖ Go 1.6Ôºö‰ΩøÁî® bitmap Êù•ËÆ∞ÂΩïÂõûÊî∂ÂÜÖÂ≠òÁöÑ‰ΩçÁΩÆÔºåÂ§ßÂπÖ‰ºòÂåñÂûÉÂúæÂõûÊî∂Âô®Ëá™Ë∫´Ê∂àËÄóÁöÑÂÜÖÂ≠òÔºåÂÅúÈ°øÊó∂Èó¥Âú®ÂçÅÊØ´Áßí‰ª•ÂÜÖ Go 1.7ÔºöÂÅúÈ°øÊó∂Èó¥ÊéßÂà∂Âú®‰∏§ÊØ´Áßí‰ª•ÂÜÖ Go 1.8ÔºöÊ∑∑ÂêàÂÜôÂ±èÈöúÔºåÂÅúÈ°øÊó∂Èó¥Âú®Âçä‰∏™ÊØ´ÁßíÂ∑¶Âè≥ Go 1.9ÔºöÂΩªÂ∫ïÁßªÈô§‰∫ÜÊ†àÁöÑÈáçÊâ´ÊèèËøáÁ®ã Go 1.12ÔºöÊï¥Âêà‰∫Ü‰∏§‰∏™Èò∂ÊÆµÁöÑ Mark TerminationÔºå‰ΩÜÂºïÂÖ•‰∫Ü‰∏Ä‰∏™‰∏•ÈáçÁöÑ GC Bug Ëá≥‰ªäÊú™‰øÆÔºàËßÅÈóÆÈ¢ò 20ÔºâÔºåÂ∞öÊó†ËØ• Bug ÂØπ GC ÊÄßËÉΩÂΩ±ÂìçÁöÑÊä•Âëä Go 1.13ÔºöÁùÄÊâãËß£ÂÜ≥ÂêëÊìç‰ΩúÁ≥ªÁªüÂΩíËøòÂÜÖÂ≠òÁöÑÔºåÊèêÂá∫‰∫ÜÊñ∞ÁöÑ Scavenger Go 1.14ÔºöÊõø‰ª£‰∫Ü‰ªÖÂ≠òÊ¥ª‰∫Ü‰∏Ä‰∏™ÁâàÊú¨ÁöÑ scavengerÔºåÂÖ®Êñ∞ÁöÑÈ°µÂàÜÈÖçÂô®Ôºå‰ºòÂåñÂàÜÈÖçÂÜÖÂ≠òËøáÁ®ãÁöÑÈÄüÁéá‰∏éÁé∞ÊúâÁöÑÊâ©Â±ïÊÄßÈóÆÈ¢òÔºåÂπ∂ÂºïÂÖ•‰∫ÜÂºÇÊ≠•Êä¢Âç†ÔºåËß£ÂÜ≥‰∫ÜÁî±‰∫éÂØÜÈõÜÂæ™ÁéØÂØºËá¥ÁöÑ STW Êó∂Èó¥ËøáÈïøÁöÑÈóÆÈ¢ò ÂèØ‰ª•Áî®‰∏ãÂõæÁõ¥ËßÇÂú∞ËØ¥Êòé GC ÁöÑÊºîËøõÂéÜÂè≤Ôºö Âú® Go 1 ÂàöÂèëÂ∏ÉÊó∂ÁöÑÁâàÊú¨‰∏≠ÔºåÁîöËá≥Ê≤°ÊúâÂ∞Ü Mark-Sweep ÁöÑËøáÁ®ãÂπ∂Ë°åÂåñÔºåÂΩìÈúÄË¶ÅËøõË°åÂûÉÂúæÂõûÊî∂Êó∂ÔºåÊâÄÊúâÁöÑ‰ª£Á†ÅÈÉΩÂøÖÈ°ªËøõÂÖ• STW ÁöÑÁä∂ÊÄÅ„ÄÇËÄåÂà∞‰∫Ü Go 1.1 Êó∂ÔºåÂÆòÊñπËøÖÈÄüÂú∞Â∞ÜÊ∏ÖÊâ´ËøáÁ®ãËøõË°å‰∫ÜÂπ∂Ë°åÂåñÁöÑÂ§ÑÁêÜÔºåÂç≥‰ªÖÂú®Ê†áËÆ∞Èò∂ÊÆµËøõÂÖ• STW„ÄÇ Ëøô‰∏ÄÊÉ≥Ê≥ïÂæàËá™ÁÑ∂ÔºåÂõ†‰∏∫Âπ∂Ë°åÂåñÂØºËá¥ÁÆóÊ≥ïÁªìÊûú‰∏ç‰∏ÄËá¥ÁöÑÊÉÖÂÜµ‰ªÖ‰ªÖÂèëÁîüÂú®Ê†áËÆ∞Èò∂ÊÆµÔºåËÄåÂΩìÊó∂ÁöÑÂûÉÂúæÂõûÊî∂Âô®Ê≤°ÊúâÈíàÂØπÂπ∂Ë°åÁªìÊûúÁöÑ‰∏ÄËá¥ÊÄßËøõË°å‰ªª‰Ωï‰ºòÂåñÔºåÂõ†Ê≠§ÊâçÈúÄË¶ÅÂú®Ê†áËÆ∞Èò∂ÊÆµËøõÂÖ• STW„ÄÇÂØπ‰∫é Scavenger ËÄåË®ÄÔºåÊó©ÊúüÁöÑÁâàÊú¨‰∏≠‰ºöÊúâ‰∏Ä‰∏™ÂçïÁã¨ÁöÑÁ∫øÁ®ãÊù•ÂÆöÊúüÂ∞ÜÂ§ö‰ΩôÁöÑÂÜÖÂ≠òÂΩíËøòÁªôÊìç‰ΩúÁ≥ªÁªü„ÄÇ ËÄåÂà∞‰∫Ü Go 1.5 ÂêéÔºåGo Âõ¢ÈòüËä±Ë¥π‰∫ÜÁõ∏ÂΩìÂ§ßÁöÑÂäõÊ∞îÔºåÈÄöËøáÂºïÂÖ•ÂÜôÂ±èÈöúÁöÑÊú∫Âà∂Êù•‰øùËØÅÁÆóÊ≥ïÁöÑ‰∏ÄËá¥ÊÄßÔºåÊâçÂæó‰ª•Â∞ÜÊï¥‰∏™ GC ÊéßÂà∂Âú®ÂæàÂ∞èÁöÑ STW ÂÜÖÔºåËÄåÂà∞‰∫Ü 1.8 Êó∂ÔºåÁî±‰∫éÊñ∞ÁöÑÊ∑∑ÂêàÂ±èÈöúÁöÑÂá∫Áé∞ÔºåÊ∂àÈô§‰∫ÜÂØπÊ†àÊú¨Ë∫´ÁöÑÈáçÊñ∞Êâ´ÊèèÔºåSTW ÁöÑÊó∂Èó¥Ëøõ‰∏ÄÊ≠•Áº©Âáè„ÄÇ ‰ªéËøô‰∏™Êó∂ÂÄôÂºÄÂßãÔºåScavenger Â∑≤Áªè‰ªéÁã¨Á´ãÁ∫øÁ®ã‰∏≠ÁßªÈô§ÔºåÂπ∂ÂêàÂπ∂Ëá≥Á≥ªÁªüÁõëÊéßËøô‰∏™Áã¨Á´ãÁöÑÁ∫øÁ®ã‰∏≠ÔºåÂπ∂Âë®ÊúüÊÄßÂú∞ÂêëÊìç‰ΩúÁ≥ªÁªüÂΩíËøòÂÜÖÂ≠òÔºå‰ΩÜ‰ªçÁÑ∂‰ºöÊúâÂÜÖÂ≠òÊ∫¢Âá∫ËøôÁßçÊØîËæÉÊûÅÁ´ØÁöÑÊÉÖÂÜµÂá∫Áé∞ÔºåÂõ†‰∏∫Á®ãÂ∫èÂèØËÉΩÂú®Áü≠Êó∂Èó¥ÂÜÖÂ∫îÂØπÁ™ÅÂèëÊÄßÁöÑÂÜÖÂ≠òÁî≥ËØ∑ÈúÄÊ±ÇÊó∂ÔºåÂÜÖÂ≠òËøòÊ≤°Êù•ÂæóÂèäÂΩíËøòÊìç‰ΩúÁ≥ªÁªüÔºåÂØºËá¥Â†Ü‰∏çÊñ≠ÂêëÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑ÂÜÖÂ≠òÔºå‰ªéËÄåÂá∫Áé∞ÂÜÖÂ≠òÊ∫¢Âá∫„ÄÇ Âà∞‰∫Ü Go 1.13ÔºåÂÆöÊúüÂΩíËøòÊìç‰ΩúÁ≥ªÁªüÁöÑÈóÆÈ¢òÂæó‰ª•Ëß£ÂÜ≥ÔºåGo Âõ¢ÈòüÂºÄÂßãÂ∞ÜÂë®ÊúüÊÄßÁöÑ Scavenger ËΩ¨Âåñ‰∏∫ÂèØË¢´Ë∞ÉÂ∫¶ÁöÑ goroutineÔºåÂπ∂Â∞ÜÂÖ∂‰∏éÁî®Êà∑‰ª£Á†ÅÂπ∂ÂèëÊâßË°å„ÄÇËÄåÂà∞‰∫Ü Go 1.14ÔºåËøô‰∏ÄÂêëÊìç‰ΩúÁ≥ªÁªüÂΩíËøòÂÜÖÂ≠òÁöÑÊìç‰ΩúÊó∂Èó¥Ëøõ‰∏ÄÊ≠•ÂæóÂà∞Áº©Âáè„ÄÇ 17. Go GC Âú®ÊºîÂåñËøáÁ®ã‰∏≠ËøòÂ≠òÂú®Âì™‰∫õÂÖ∂‰ªñËÆæËÆ°Ôºü‰∏∫‰ªÄ‰πàÊ≤°ÊúâË¢´ÈááÁî®ÔºüÂπ∂ÂèëÊ†àÈáçÊâ´Ê≠£Â¶ÇÊàë‰ª¨ÂâçÈù¢ÊâÄËØ¥ÔºåÂÖÅËÆ∏ÁÅ∞Ëâ≤ËµãÂÄºÂô®Â≠òÂú®ÁöÑÂûÉÂúæÂõûÊî∂Âô®ÈúÄË¶ÅÂºïÂÖ•ÈáçÊâ´ËøáÁ®ãÊù•‰øùËØÅÁÆóÊ≥ïÁöÑÊ≠£Á°ÆÊÄßÔºåÈô§‰∫ÜÂºïÂÖ•Ê∑∑ÂêàÂ±èÈöúÊù•Ê∂àÈô§ÈáçÊâ´Ëøô‰∏ÄËøáÁ®ãÂ§ñÔºåÊúâÂè¶‰∏ÄÁßçÂÅöÊ≥ïÂèØ‰ª•ÊèêÈ´òÈáçÊâ´ËøáÁ®ãÁöÑÊÄßËÉΩÔºåÈÇ£Â∞±ÊòØÂ∞ÜÈáçÊâ´ÁöÑËøáÁ®ãÂπ∂ÂèëÊâßË°å„ÄÇÁÑ∂ËÄåËøô‰∏ÄÊñπÊ°àÂπ∂Ê≤°ÊúâÂæó‰ª•ÂÆûÁé∞ÔºåÂéüÂõ†ÂæàÁÆÄÂçïÔºöÂÆûÁé∞ËøáÁ®ãÁõ∏ÊØîÂºïÂÖ•Ê∑∑ÂêàÂ±èÈöúËÄåË®ÄÂçÅÂàÜÂ§çÊùÇÔºåËÄå‰∏îÂºïÂÖ•Ê∑∑ÂêàÂ±èÈöúËÉΩÂ§üÊ∂àÈô§ÈáçÊâ´Ëøô‰∏ÄËøáÁ®ãÔºåÂ∞ÜÁÆÄÂåñÂûÉÂúæÂõûÊî∂ÁöÑÊ≠•È™§„ÄÇ ROCROC ÁöÑÂÖ®Áß∞ÊòØÈù¢ÂêëËØ∑Ê±ÇÁöÑÂõûÊî∂Âô®ÔºàRequest Oriented CollectorÔºâÔºåÂÆÉÂÖ∂ÂÆû‰πüÊòØÂàÜ‰ª£ GC ÁöÑ‰∏ÄÁßçÈáçÊñ∞ÂèôËø∞„ÄÇÂÆÉÊèêÂá∫‰∫Ü‰∏Ä‰∏™ËØ∑Ê±ÇÂÅáËÆæÔºàRequest HypothesisÔºâÔºö‰∏é‰∏Ä‰∏™ÂÆåÊï¥ËØ∑Ê±Ç„ÄÅ‰ºëÁú† goroutine ÊâÄÂÖ≥ËÅîÁöÑÂØπË±°ÊØîÂÖ∂‰ªñÂØπË±°Êõ¥ÂÆπÊòìÊ≠ª‰∫°„ÄÇËøô‰∏™ÂÅáËÆæÂê¨Ëµ∑Êù•ÈùûÂ∏∏Á¨¶ÂêàÁõ¥ËßâÔºå‰ΩÜÂú®ÂÆûÁé∞‰∏äÔºåÁî±‰∫éÂûÉÂúæÂõûÊî∂Âô®ÂøÖÈ°ªÁ°Æ‰øùÊòØÂê¶Êúâ goroutine ÁßÅÊúâÊåáÈíàË¢´ÂÜôÂÖ•ÂÖ¨ÂÖ±ÂØπË±°ÔºåÂõ†Ê≠§ÂÜôÂ±èÈöúÂøÖÈ°ª‰∏ÄÁõ¥ÊâìÂºÄÔºåËøô‰πüÂ∞±‰∫ßÁîü‰∫ÜËØ•ÊñπÊ≥ïÁöÑËá¥ÂëΩÁº∫ÁÇπÔºöÊòÇË¥µÁöÑÂÜôÂ±èÈöúÂèäÂÖ∂Â∏¶Êù•ÁöÑÁºìÂ≠òÊú™ÂëΩ‰∏≠ÔºåËøô‰πüÊòØËøô‰∏ÄËÆæËÆ°ÊúÄÁªàÊ≤°ÊúâË¢´ÈááÁî®ÁöÑ‰∏ªË¶ÅÂéüÂõ†„ÄÇ ‰º†ÁªüÂàÜ‰ª£ GCÂú®ÂèëÁé∞ ROC ÊÄßËÉΩ‰∏çË°å‰πãÂêéÔºå‰Ωú‰∏∫Â§áÈÄâÊñπÊ°àÔºåGo Âõ¢ÈòüËøòÂ∞ùËØï‰∫ÜÂÆûÁé∞‰º†ÁªüÁöÑÂàÜ‰ª£Âºè GC„ÄÇ‰ΩÜÊúÄÁªàÂêåÊ†∑ÂèëÁé∞ÂàÜ‰ª£ÂÅáËÆæÂπ∂‰∏çÈÄÇÁî®‰∫é Go ÁöÑËøêË°åÊ†àÊú∫Âà∂ÔºåÂπ¥ËΩª‰ª£ÂØπË±°Âú®Ê†à‰∏äÂ∞±Â∑≤ÁªèÊ≠ª‰∫°ÔºåÊâ´ÊèèÊú¨Â∞±ËØ•ÂõûÊî∂ÁöÑÊâßË°åÊ†àÂπ∂Ê≤°Êúâ‰∏∫Áî±‰∫éÂàÜ‰ª£ÂÅáËÆæÂ∏¶Êù•ÊòéÊòæÁöÑÊÄßËÉΩÊèêÂçá„ÄÇËøô‰πüÊòØËøô‰∏ÄËÆæËÆ°ÊúÄÁªàÊ≤°ÊúâË¢´ÈááÁî®ÁöÑ‰∏ªË¶ÅÂéüÂõ†„ÄÇ 18. ÁõÆÂâçÊèê‰æõ GC ÁöÑËØ≠Ë®Ä‰ª•Âèä‰∏çÊèê‰æõ GC ÁöÑËØ≠Ë®ÄÊúâÂì™‰∫õÔºüGC Âíå No GC ÂêÑËá™ÁöÑ‰ºòÁº∫ÁÇπÊòØ‰ªÄ‰πàÔºü‰ªéÂéüÁêÜ‰∏äËÄåË®ÄÔºåÊâÄÊúâÁöÑËØ≠Ë®ÄÈÉΩËÉΩÂ§üËá™Ë°åÂÆûÁé∞ GC„ÄÇ‰ªéËØ≠Ë®ÄËØûÁîü‰πãÂàùÂ∞±Êèê‰æõ GC ÁöÑËØ≠Ë®ÄÔºå‰æãÂ¶ÇÔºö Python JavaScript Java Objective-C Swift ËÄå‰∏ç‰ª• GC ‰∏∫ÁõÆÊ†áÔºåË¢´Áõ¥Êé•ËÆæËÆ°‰∏∫ÊâãÂä®ÁÆ°ÁêÜÂÜÖÂ≠ò„ÄÅ‰ΩÜÂèØ‰ª•Ëá™Ë°åÂÆûÁé∞ GC ÁöÑËØ≠Ë®ÄÊúâÔºö C C++ ‰πüÊúâ‰∏Ä‰∫õËØ≠Ë®ÄÂèØ‰ª•Âú®ÁºñËØëÊúüÔºå‰æùÈù†ÁºñËØëÂô®ÊèíÂÖ•Ê∏ÖÁêÜ‰ª£Á†ÅÁöÑÊñπÂºèÔºåÂÆûÁé∞Á≤æÂáÜÁöÑÊ∏ÖÁêÜÔºå‰æãÂ¶ÇÔºö Rust ÂûÉÂúæÂõûÊî∂‰ΩøÁ®ãÂ∫èÂëòÊó†ÈúÄÊâãÂä®Â§ÑÁêÜÂÜÖÂ≠òÈáäÊîæÔºå‰ªéËÄåËÉΩÂ§üÊ∂àÈô§‰∏Ä‰∫õÈúÄË¶ÅÊâãÂä®ÁÆ°ÁêÜÂÜÖÂ≠òÊâç‰ºöÂá∫Áé∞ÁöÑËøêË°åÊó∂ÈîôËØØÔºö Âú®‰ªçÁÑ∂ÊúâÊåáÂêëÂÜÖÂ≠òÂå∫ÂùóÁöÑÊåáÈíàÁöÑÊÉÖÂÜµ‰∏ãÈáäÊîæËøôÂùóÂÜÖÂ≠òÊó∂Ôºå‰ºö‰∫ßÁîüÊÇ¨ÊåÇÊåáÈíàÔºå‰ªéËÄåÂêéÁª≠ÂèØËÉΩÈîôËØØÁöÑËÆøÈóÆÂ∑≤ÁªèÁî®‰∫é‰ªñÁî®ÁöÑÂÜÖÂ≠òÂå∫Âüü„ÄÇ Â§öÈáçÈáäÊîæÂêå‰∏ÄÂùóÁî≥ËØ∑ÁöÑÂÜÖÂ≠òÂå∫ÂüüÂèØËÉΩÂØºËá¥‰∏çÂèØÁü•ÁöÑÂÜÖÂ≠òÊçüÂùè„ÄÇ ÂΩìÁÑ∂ÔºåÂûÉÂúæÂõûÊî∂‰πü‰ºö‰º¥Èöè‰∏Ä‰∫õÁº∫Èô∑ÔºåËøô‰πüÂ∞±ÈÄ†Â∞±‰∫ÜÊ≤°Êúâ GC ÁöÑ‰∏Ä‰∫õ‰ºòÂäøÔºö Ê≤°ÊúâÈ¢ùÂ§ñÁöÑÊÄßËÉΩÂºÄÈîÄ Á≤æÂáÜÁöÑÊâãÂä®ÂÜÖÂ≠òÁÆ°ÁêÜÔºåÊûÅËá¥ÁöÑÂà©Áî®Êú∫Âô®ÁöÑÊÄßËÉΩ 19. Go ÂØπÊØî Java„ÄÅV8 ‰∏≠ JavaScript ÁöÑ GC ÊÄßËÉΩÂ¶Ç‰ΩïÔºüÊó†ËÆ∫ÊòØ Java ËøòÊòØ JavaScript ‰∏≠ÁöÑ GC Âùá‰∏∫ÂàÜ‰ª£Âºè GC„ÄÇÂàÜ‰ª£Âºè GC ÁöÑ‰∏Ä‰∏™Ê†∏ÂøÉÂÅáËÆæÂ∞±ÊòØÂàÜ‰ª£ÂÅáËØ¥ÔºöÂ∞ÜÂØπË±°‰æùÊçÆÂ≠òÊ¥ªÊó∂Èó¥ÂàÜÈÖçÂà∞‰∏çÂêåÁöÑÂå∫ÂüüÔºåÊØèÊ¨°ÂõûÊî∂Âè™ÂõûÊî∂ÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™Âå∫Âüü„ÄÇ V8 ÁöÑ GCÂú® V8 ‰∏≠‰∏ªË¶ÅÂ∞ÜÂÜÖÂ≠òÂàÜ‰∏∫Êñ∞Áîü‰ª£ÂíåËÄÅÁîü‰ª£„ÄÇÊñ∞Áîü‰ª£‰∏≠ÁöÑÂØπË±°‰∏∫Â≠òÊ¥ªÊó∂Èó¥ËæÉÁü≠ÁöÑÂØπË±°ÔºåËÄÅÁîü‰ª£‰∏≠ÁöÑÂØπË±°‰∏∫Â≠òÊ¥ªÊó∂Èó¥ËæÉÈïø„ÄÅÂ∏∏È©ªÂÜÖÂ≠ò„ÄÅÂç†Áî®ÂÜÖÂ≠òËæÉÂ§ßÁöÑÂØπË±°Ôºö Êñ∞Áîü‰ª£‰∏≠ÁöÑÂØπË±°‰∏ªË¶ÅÈÄöËøáÂâØÂûÉÂúæÂõûÊî∂Âô®ËøõË°åÂõûÊî∂„ÄÇËØ•ÂõûÊî∂ËøáÁ®ãÊòØ‰∏ÄÁßçÈááÁî®Â§çÂà∂ÁöÑÊñπÂºèÂÆûÁé∞ÁöÑÂûÉÂúæÂõûÊî∂ÁÆóÊ≥ïÔºåÂÆÉÂ∞ÜÂ†ÜÂÜÖÂ≠ò‰∏ÄÂàÜ‰∏∫‰∫åÔºåËøô‰∏§‰∏™Á©∫Èó¥‰∏≠Âè™Êúâ‰∏Ä‰∏™Â§Ñ‰∫é‰ΩøÁî®‰∏≠ÔºåÂè¶‰∏Ä‰∏™ÂàôÂ§Ñ‰∫éÈó≤ÁΩÆÁä∂ÊÄÅ„ÄÇÂ§Ñ‰∫é‰ΩøÁî®Áä∂ÊÄÅÁöÑÁ©∫Èó¥Áß∞‰∏∫ From Á©∫Èó¥ÔºåÂ§Ñ‰∫éÈó≤ÁΩÆÁöÑÁ©∫Èó¥Áß∞‰∏∫ To Á©∫Èó¥„ÄÇÂàÜÈÖçÂØπË±°Êó∂ÔºåÂÖàÊòØÂú® From Á©∫Èó¥‰∏≠ËøõË°åÂàÜÈÖçÔºåÂΩìÂºÄÂßãÂûÉÂúæÂõûÊî∂Êó∂Ôºå‰ºöÊ£ÄÊü• From Á©∫Èó¥‰∏≠ÁöÑÂ≠òÊ¥ªÂØπË±°ÔºåÂπ∂Â∞ÜËøô‰∫õÂ≠òÊ¥ªÂØπË±°Â§çÂà∂Âà∞ To Á©∫Èó¥‰∏≠ÔºåËÄåÈùûÂ≠òÊ¥ªÂØπË±°Âç†Áî®ÁöÑÁ©∫Èó¥Ë¢´ÈáäÊîæ„ÄÇÂÆåÊàêÂ§çÂà∂ÂêéÔºåFrom Á©∫Èó¥Âíå To Á©∫Èó¥ÁöÑËßíËâ≤‰∫íÊç¢„ÄÇ‰πüÂ∞±ÊòØÈÄöËøáÂ∞ÜÂ≠òÊ¥ªÂØπË±°Âú®‰∏§‰∏™Á©∫Èó¥‰∏≠ËøõË°åÂ§çÂà∂„ÄÇ ËÄÅÁîü‰ª£ÂàôÁî±‰∏ªÂûÉÂúæÂõûÊî∂Âô®Ë¥üË¥£„ÄÇÂÆÉÂÆûÁé∞ÁöÑÊòØÊ†áËÆ∞Ê∏ÖÊâ´ËøáÁ®ãÔºå‰ΩÜÁï•Êúâ‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÂÆÉËøò‰ºöÂú®Ê∏ÖÊâ´ÂÆåÊàêÂêéÂØπÂÜÖÂ≠òÁ¢éÁâáËøõË°åÊï¥ÁêÜÔºåËøõËÄåÊòØ‰∏ÄÁßçÊ†áËÆ∞Êï¥ÁêÜÁöÑÂõûÊî∂Âô®„ÄÇ Java ÁöÑ GCJava ÁöÑ GC Áß∞‰πã‰∏∫ G1ÔºåÂπ∂Â∞ÜÊï¥‰∏™Â†ÜÂàÜ‰∏∫Âπ¥ËΩª‰ª£„ÄÅËÄÅÂπ¥‰ª£ÂíåÊ∞∏‰πÖ‰ª£„ÄÇÂåÖÊã¨ÂõõÁßç‰∏çÂêåÁöÑÊî∂ÈõÜÊìç‰ΩúÔºå‰ªé‰∏äÂæÄ‰∏ãÁöÑËøôÂá†‰∏™Èò∂ÊÆµ‰ºöÈÄâÊã©ÊÄßÂú∞ÊâßË°åÔºåËß¶ÂèëÊù°‰ª∂ÊòØÁî®Êà∑ÁöÑÈÖçÁΩÆÂíåÂÆûÈôÖ‰ª£Á†ÅË°å‰∏∫ÁöÑÈ¢ÑÊµã„ÄÇ Âπ¥ËΩª‰ª£Êî∂ÈõÜÂë®ÊúüÔºöÂè™ÂØπÂπ¥ËΩª‰ª£ÂØπË±°ËøõË°åÊî∂ÈõÜ‰∏éÊ∏ÖÁêÜ ËÄÅÂπ¥‰ª£Êî∂ÈõÜÂë®ÊúüÔºöÂè™ÂØπËÄÅÂπ¥‰ª£ÂØπË±°ËøõË°åÊî∂ÈõÜ‰∏éÊ∏ÖÁêÜ Ê∑∑ÂêàÂºèÊî∂ÈõÜÂë®ÊúüÔºöÂêåÊó∂ÂØπÂπ¥ËΩª‰ª£ÂíåËÄÅÂπ¥‰ª£ËøõË°åÊî∂ÈõÜ‰∏éÊ∏ÖÁêÜ ÂÆåÊï¥ GC Âë®ÊúüÔºöÂÆåÊï¥ÁöÑÂØπÊï¥‰∏™Â†ÜËøõË°åÊî∂ÈõÜ‰∏éÊ∏ÖÁêÜ Âú®ÂõûÊî∂ËøáÁ®ã‰∏≠ÔºåG1 ‰ºöÂØπÂÅúÈ°øÊó∂Èó¥ËøõË°åÈ¢ÑÊµãÔºåÁ´≠Â∞ΩÊâÄËÉΩÂú∞Ë∞ÉÊï¥ GC ÁöÑÁ≠ñÁï•‰ªéËÄåËææÂà∞Áî®Êà∑‰ª£Á†ÅÈÄöËøáÁ≥ªÁªüÂèÇÊï∞Ôºà-XX:MaxGCPauseMillisÔºâÊâÄÈÖçÁΩÆÁöÑÂØπÂÅúÈ°øÊó∂Èó¥ÁöÑË¶ÅÊ±Ç„ÄÇ ËøôÂõõ‰∏™Âë®ÊúüÁöÑÊâßË°åÊàêÊú¨ÈÄêÊ∏ê‰∏äÂçáÔºå‰ºòÂåñÂæóÂΩìÁöÑÁ®ãÂ∫èÂèØ‰ª•ÂÆåÂÖ®ÈÅøÂÖçÂÆåÊï¥ GC Âë®Êúü„ÄÇ ÊÄßËÉΩÊØîËæÉÂú® Go„ÄÅJava Âíå V8 JavaScript ‰πãÈó¥ÊØîËæÉ GC ÁöÑÊÄßËÉΩÊú¨Ë¥®‰∏äÊòØ‰∏Ä‰∏™‰∏çÂàáÂÆûÈôÖÁöÑÈóÆÈ¢ò„ÄÇÂ¶ÇÂâçÈù¢ÊâÄËØ¥ÔºåÂûÉÂúæÂõûÊî∂Âô®ÁöÑËÆæËÆ°ÊùÉË°°‰∫ÜÂæàÂ§öÊñπÈù¢ÁöÑÂõ†Á¥†ÔºåÂêåÊó∂ËøòÂèóËØ≠Ë®ÄËá™Ë∫´ËÆæËÆ°ÁöÑÂΩ±ÂìçÔºåÂõ†‰∏∫ËØ≠Ë®ÄÁöÑËÆæËÆ°‰πüÁõ¥Êé•ÂΩ±Âìç‰∫ÜÁ®ãÂ∫èÂëòÁºñÂÜô‰ª£Á†ÅÁöÑÂΩ¢ÂºèÔºå‰πüÂ∞±Ëá™ÁÑ∂ÂΩ±Âìç‰∫Ü‰∫ßÁîüÂûÉÂúæÁöÑÊñπÂºè„ÄÇ ‰ΩÜÊÄªÁöÑÊù•ËØ¥Ôºå‰ªñ‰ª¨‰∏âËÄÖÂØπÂûÉÂúæÂõûÊî∂ÁöÑÂÆûÁé∞ÈÉΩÈúÄË¶Å STWÔºåÂπ∂ÂùáÂ∑≤ËææÂà∞‰∫ÜÁî®Êà∑‰ª£Á†ÅÂá†‰πéÊó†Ê≥ïÊÑüÁü•Âà∞ÁöÑÁä∂ÊÄÅÔºàÊçÆ Go GC ‰ΩúËÄÖ Austin ÂÆ£Áß∞ STW Â∞è‰∫é 100 ÂæÆÁßíÔºâ„ÄÇÂΩìÁÑ∂ÔºåÈöèÁùÄ STW ÁöÑÂáèÂ∞ëÔºåÂûÉÂúæÂõûÊî∂Âô®‰ºöÂ¢ûÂä† CPU ÁöÑ‰ΩøÁî®ÁéáÔºåËøô‰πüÊòØÁ®ãÂ∫èÂëòÂú®ÁºñÂÜô‰ª£Á†ÅÊó∂ÈúÄË¶ÅÊâãÂä®ËøõË°å‰ºòÂåñÁöÑÈÉ®ÂàÜÔºåÂç≥ÂÖÖÂàÜËÄÉËôëÂÜÖÂ≠òÂàÜÈÖçÁöÑÂøÖË¶ÅÊÄßÔºåÂáèÂ∞ëËøáÂ§öÁî≥ËØ∑ÂÜÖÂ≠òÂ∏¶ÁªôÂûÉÂúæÂõûÊî∂Âô®ÁöÑÂéãÂäõ„ÄÇ 20. ÁõÆÂâç Go ËØ≠Ë®ÄÁöÑ GC ËøòÂ≠òÂú®Âì™‰∫õÈóÆÈ¢òÔºüÂ∞ΩÁÆ° Go Âõ¢ÈòüÂÆ£Áß∞ STW ÂÅúÈ°øÊó∂Èó¥Âæó‰ª•‰ºòÂåñÂà∞ 100 ÂæÆÁßíÁ∫ßÂà´Ôºå‰ΩÜËøôÊú¨Ë¥®‰∏äÊòØ‰∏ÄÁßçÂèñËàç„ÄÇÂéüÊú¨ÁöÑ STW ÊüêÁßçÊÑè‰πâ‰∏äÊù•ËØ¥ÂÖ∂ÂÆûËΩ¨ÁßªÂà∞‰∫ÜÂèØËÉΩÂØºËá¥Áî®Êà∑‰ª£Á†ÅÂÅúÈ°øÁöÑÂá†‰∏™‰ΩçÁΩÆÔºõÈô§Ê≠§‰πãÂ§ñÔºåÁî±‰∫éËøêË°åÊó∂Ë∞ÉÂ∫¶Âô®ÁöÑÂÆûÁé∞ÊñπÂºèÔºåÂêåÊ†∑ÂØπ GC Â≠òÂú®‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑÂΩ±Âìç„ÄÇ ÁõÆÂâç Go ‰∏≠ÁöÑ GC ‰ªçÁÑ∂Â≠òÂú®‰ª•‰∏ãÈóÆÈ¢òÔºö 1. Mark Assist ÂÅúÈ°øÊó∂Èó¥ËøáÈïø12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273package mainimport ( "fmt" "os" "runtime" "runtime/trace" "time")const ( windowSize = 200000 msgCount = 1000000)var ( best time.Duration = time.Second bestAt time.Time worst time.Duration worstAt time.Time start = time.Now())func main() &#123; f, _ := os.Create("trace.out") defer f.Close() trace.Start(f) defer trace.Stop() for i := 0; i &lt; 5; i++ &#123; measure() worst = 0 best = time.Second runtime.GC() &#125;&#125;func measure() &#123; var c channel for i := 0; i &lt; msgCount; i++ &#123; c.sendMsg(i) &#125; fmt.Printf("Best send delay %v at %v, worst send delay: %v at %v. Wall clock: %v \n", best, bestAt.Sub(start), worst, worstAt.Sub(start), time.Since(start))&#125;type channel [windowSize][]bytefunc (c *channel) sendMsg(id int) &#123; start := time.Now() // Ê®°ÊãüÂèëÈÄÅ (*c)[id%windowSize] = newMsg(id) end := time.Now() elapsed := end.Sub(start) if elapsed &gt; worst &#123; worst = elapsed worstAt = end &#125; if elapsed &lt; best &#123; best = elapsed bestAt = end &#125;&#125;func newMsg(n int) []byte &#123; m := make([]byte, 1024) for i := range m &#123; m[i] = byte(n) &#125; return m&#125; ËøêË°åÊ≠§Á®ãÂ∫èÊàë‰ª¨ÂèØ‰ª•ÂæóÂà∞Á±ª‰ºº‰∏ãÈù¢ÁöÑÁªìÊûúÔºö 1234567$ go run main.goBest send delay 330ns at 773.037956ms, worst send delay: 7.127915ms at 579.835487ms. Wall clock: 831.066632ms Best send delay 331ns at 873.672966ms, worst send delay: 6.731947ms at 1.023969626s. Wall clock: 1.515295559s Best send delay 330ns at 1.812141567s, worst send delay: 5.34028ms at 2.193858359s. Wall clock: 2.199921749s Best send delay 338ns at 2.722161771s, worst send delay: 7.479482ms at 2.665355216s. Wall clock: 2.920174197s Best send delay 337ns at 3.173649445s, worst send delay: 6.989577ms at 3.361716121s. Wall clock: 3.615079348s Âú®Ëøô‰∏™ÁªìÊûú‰∏≠ÔºåÁ¨¨‰∏ÄÊ¨°ÁöÑÊúÄÂùèÂª∂ËøüÊó∂Èó¥È´òËææ 7.12 ÊØ´ÁßíÔºåÂèëÁîüÂú®Á®ãÂ∫èËøêË°å 578 ÊØ´ÁßíÂ∑¶Âè≥„ÄÇÈÄöËøá go tool trace ÂèØ‰ª•ÂèëÁé∞ÔºåËøô‰∏™Êó∂Èó¥ÊÆµ‰∏≠ÔºåMark Assist ÊâßË°å‰∫Ü 7112312nsÔºåÁ∫¶‰∏∫ 7.127915msÔºõÂèØËßÅÔºåÊ≠§Êó∂ÊúÄÂùèÊÉÖÂÜµ‰∏ãÔºåÊ†áËÆ∞ËæÖÂä©ÊãñÊÖ¢‰∫ÜÁî®Êà∑‰ª£Á†ÅÁöÑÊâßË°åÔºåÊòØÈÄ†Êàê 7 ÊØ´ÁßíÂª∂ËøüÁöÑÂéüÂõ†„ÄÇ 2. Sweep ÂÅúÈ°øÊó∂Èó¥ËøáÈïøÂêåÊ†∑ËøòÊòØÂàöÊâçÁöÑ‰æãÂ≠êÔºåÂ¶ÇÊûúÊàë‰ª¨‰ªîÁªÜËßÇÂØü Mark Assist ÂêéÂèëÁîüÁöÑ Sweep Èò∂ÊÆµÔºåÁ´üÁÑ∂ÂØπÁî®Êà∑‰ª£Á†ÅÁöÑÂΩ±ÂìçÈïøËææÁ∫¶ 30msÔºåÊ†πÊçÆË∞ÉÁî®Ê†à‰ø°ÊÅØÂèØ‰ª•ÁúãÂà∞ÔºåËØ• Sweep ËøáÁ®ãÂèëÁîüÂú®ÂÜÖÂ≠òÂàÜÈÖçÈò∂ÊÆµÔºö 3. Áî±‰∫é GC ÁÆóÊ≥ïÁöÑ‰∏çÊ≠£Á°ÆÊÄßÂØºËá¥ GC Âë®ÊúüË¢´Ëø´ÈáçÊñ∞ÊâßË°åÊ≠§ÈóÆÈ¢òÂæàÈöæÂ§çÁé∞Ôºå‰ΩÜÊòØ‰∏Ä‰∏™Â∑≤Áü•ÁöÑÈóÆÈ¢òÔºåÊ†πÊçÆ Go Âõ¢ÈòüÁöÑÊèèËø∞ÔºåËÉΩÂ§üÂú® 1334 Ê¨°ÊûÑÂª∫‰∏≠ÂèëÁîü‰∏ÄÊ¨°ÔºåÊàë‰ª¨ÂèØ‰ª•ËÆ°ÁÆóÂá∫ÂÖ∂Ëß¶ÂèëÊ¶ÇÁéáÁ∫¶‰∏∫ 0.0007496251874„ÄÇËôΩÁÑ∂ÂèëÁîüÊ¶ÇÁéáÂæà‰ΩéÔºå‰ΩÜ‰∏ÄÊó¶ÂèëÁîüÔºåGC ÈúÄË¶ÅË¢´ÈáçÊñ∞ÊâßË°åÔºåÈùûÂ∏∏‰∏çÂπ∏„ÄÇ 4. ÂàõÂª∫Â§ßÈáè Goroutine ÂêéÂØºËá¥ GC Ê∂àËÄóÊõ¥Â§öÁöÑ CPUËøô‰∏™ÈóÆÈ¢òÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÁ®ãÂ∫èËøõË°åÈ™åËØÅÔºö 12345678910111213141516171819202122232425262728func BenchmarkGCLargeGs(b *testing.B) &#123; wg := sync.WaitGroup&#123;&#125; for ng := 100; ng &lt;= 1000000; ng *= 10 &#123; b.Run(fmt.Sprintf("#g-%d", ng), func(b *testing.B) &#123; // ÂàõÂª∫Â§ßÈáè goroutineÔºåÁî±‰∫éÊØèÊ¨°ÂàõÂª∫ÁöÑ goroutine ‰ºö‰ºëÁú† // ‰ªéËÄåËøêË°åÊó∂‰∏ç‰ºöÂ§çÁî®Ê≠£Âú®‰ºëÁú†ÁöÑ goroutineÔºåËøõËÄå‰∏çÊñ≠ÂàõÂª∫Êñ∞ÁöÑ g wg.Add(ng) for i := 0; i &lt; ng; i++ &#123; go func() &#123; time.Sleep(100 * time.Millisecond) wg.Done() &#125;() &#125; wg.Wait() // Áé∞ËøêË°å‰∏ÄÊ¨° GC Êù•Êèê‰æõ‰∏ÄËá¥ÁöÑÂÜÖÂ≠òÁéØÂ¢É runtime.GC() // ËÆ∞ÂΩïËøêË°å b.N Ê¨° GC ÈúÄË¶ÅÁöÑÊó∂Èó¥ b.ResetTimer() for i := 0; i &lt; b.N; i++ &#123; runtime.GC() &#125; &#125;) &#125;&#125; ÂÖ∂ÁªìÊûúÂèØ‰ª•ÈÄöËøáÂ¶Ç‰∏ãÊåá‰ª§Êù•Ëé∑ÂæóÔºö 12345678$ go test -bench=BenchmarkGCLargeGs -run=^$ -count=5 -v . | tee 4.txt$ benchstat 4.txtname time/opGCLargeGs/#g-100-12 192¬µs ¬± 5%GCLargeGs/#g-1000-12 331¬µs ¬± 1%GCLargeGs/#g-10000-12 1.22ms ¬± 1%GCLargeGs/#g-100000-12 10.9ms ¬± 3%GCLargeGs/#g-1000000-12 32.5ms ¬± 4% ËøôÁßçÊÉÖÂÜµÈÄöÂ∏∏ÂèëÁîü‰∫éÂ≥∞ÂÄºÊµÅÈáèÂêéÔºåÂ§ßÈáè goroutine Áî±‰∫é‰ªªÂä°Á≠âÂæÖË¢´‰ºëÁú†Ôºå‰ªéËÄåËøêË°åÊó∂‰∏çÊñ≠ÂàõÂª∫Êñ∞ÁöÑ goroutineÔºåÊóßÁöÑ goroutine Áî±‰∫é‰ºëÁú†Êú™Ë¢´ÈîÄÊØÅ‰∏îÂæó‰∏çÂà∞Â§çÁî®ÔºåÂØºËá¥ GC ÈúÄË¶ÅÊâ´ÊèèÁöÑÊâßË°åÊ†àË∂äÊù•Ë∂äÂ§öÔºåËøõËÄåÂÆåÊàê GC ÊâÄÈúÄÁöÑÊó∂Èó¥Ë∂äÊù•Ë∂äÈïø„ÄÇ‰∏Ä‰∏™Ëß£ÂÜ≥ÂäûÊ≥ïÊòØ‰ΩøÁî® goroutine Ê±†Êù•ÈôêÂà∂ÂàõÂª∫ÁöÑ goroutine Êï∞Èáè„ÄÇ ÊÄªÁªìGC ÊòØ‰∏Ä‰∏™Â§çÊùÇÁöÑÁ≥ªÁªüÂ∑•Á®ãÔºåÊú¨ÊñáËÆ®ËÆ∫ÁöÑ‰∫åÂçÅ‰∏™ÈóÆÈ¢òÂ∞ΩÁÆ°Â∑≤ÁªèÂ±ïÁé∞‰∫Ü‰∏Ä‰∏™Áõ∏ÂØπÂÖ®Èù¢ÁöÑ Go GC„ÄÇ‰ΩÜÂÆÉ‰ª¨‰ªçÁÑ∂Âè™ÊòØ GC Ëøô‰∏ÄÂÆèËßÇÈóÆÈ¢òÁöÑ‰∏Ä‰∫õËæÉ‰∏∫ÈáçË¶ÅÁöÑÈÉ®ÂàÜÔºåËøòÊúâÈùûÂ∏∏Â§öÁöÑÁªÜÊûùÊú´ËäÇ„ÄÅÁ†îÁ©∂ËøõÂ±ïÊó†Ê≥ïÂú®ÊúâÈôêÁöÑÁØáÂπÖÂÜÖÂÆåÊï¥ËÆ®ËÆ∫„ÄÇ ‰ªé Go ËØûÁîü‰πãÂàùÔºåGo Âõ¢ÈòüÂ∞±‰∏ÄÁõ¥Âú®ÂØπ GC ÁöÑË°®Áé∞ËøõË°åÂÆûÈ™å‰∏é‰ºòÂåñÔºå‰ΩÜ‰ªçÁÑ∂ÊúâËØ∏Â§öÊú™Ëß£ÂÜ≥ÁöÑÈóÆÈ¢òÔºåÊàë‰ª¨‰∏çÂ¶®ÂØπ GC Êú™Êù•ÁöÑÊîπËøõÊã≠ÁõÆ‰ª•ÂæÖ„ÄÇ Êé®ËçêÈòÖËØª„ÄêWhy golang garbage-collector not implement Generational and Compact gc?„Äëhttps://groups.google.com/forum/#!msg/golang-nuts/KJiyv2mV2pU/wdBUH1mHCAAJ „ÄêÂÜô‰∏Ä‰∏™ÂÜÖÂ≠òÂàÜÈÖçÂô®„Äëhttp://dmitrysoshnikov.com/compilers/writing-a-memory-allocator/#more-3590 „ÄêËßÇÂØü GC„Äëhttps://www.ardanlabs.com/blog/2019/05/garbage-collection-in-go-part2-gctraces.html „ÄêÁÖéÈ±º Go debug„Äëhttps://segmentfault.com/a/1190000020255157 „ÄêÁÖéÈ±º go tool trace„Äëhttps://eddycjy.gitbook.io/golang/di-9-ke-gong-ju/go-tool-trace „Äêtrace ËÆ≤Ëß£„Äëhttps://www.itcodemonkey.com/article/5419.html „ÄêAn Introduction to go tool trace„Äëhttps://about.sourcegraph.com/go/an-introduction-to-go-tool-trace-rhys-hiltner „Äêhttp pprof ÂÆòÊñπÊñáÊ°£„Äëhttps://golang.org/pkg/net/http/pprof/ „Äêruntime pprof ÂÆòÊñπÊñáÊ°£„Äëhttps://golang.org/pkg/runtime/pprof/ „Äêtrace ÂÆòÊñπÊñáÊ°£„Äëhttps://golang.org/pkg/runtime/trace/ Êé®ËçêÈòÖËØª„ÄêWhy golang garbage-collector not implement Generational and Compact gc?„Äëhttps://groups.google.com/forum/#!msg/golang-nuts/KJiyv2mV2pU/wdBUH1mHCAAJ „ÄêÂÜô‰∏Ä‰∏™ÂÜÖÂ≠òÂàÜÈÖçÂô®„Äëhttp://dmitrysoshnikov.com/compilers/writing-a-memory-allocator/#more-3590 „ÄêËßÇÂØü GC„Äëhttps://www.ardanlabs.com/blog/2019/05/garbage-collection-in-go-part2-gctraces.html „ÄêÁÖéÈ±º Go debug„Äëhttps://segmentfault.com/a/1190000020255157 „ÄêÁÖéÈ±º go tool trace„Äëhttps://eddycjy.gitbook.io/golang/di-9-ke-gong-ju/go-tool-trace „Äêtrace ËÆ≤Ëß£„Äëhttps://www.itcodemonkey.com/article/5419.html „ÄêAn Introduction to go tool trace„Äëhttps://about.sourcegraph.com/go/an-introduction-to-go-tool-trace-rhys-hiltner „Äêhttp pprof ÂÆòÊñπÊñáÊ°£„Äëhttps://golang.org/pkg/net/http/pprof/ „Äêruntime pprof ÂÆòÊñπÊñáÊ°£„Äëhttps://golang.org/pkg/runtime/pprof/ „Äêtrace ÂÆòÊñπÊñáÊ°£„Äëhttps://golang.org/pkg/runtime/trace/]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golangËá™Âä®ÁîüÊàêÂØπÂ∫îMySQLÊï∞ÊçÆÂ∫ìË°®ÁöÑstructÂÆö‰πâ]]></title>
    <url>%2F2020%2F01%2F01%2Fgolang%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E5%AF%B9%E5%BA%94MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%9A%84struct%E5%AE%9A%E4%B9%89%2F</url>
    <content type="text"><![CDATA[Âú®golangÁöÑÂºÄÂèëËøáÁ®ã‰∏≠ÔºåÂΩìÊàë‰ª¨‰ΩøÁî®ormÁöÑÊó∂ÂÄôÔºåÂ∏∏Â∏∏ÈúÄË¶ÅÂ∞ÜÊï∞ÊçÆÂ∫ìË°®ÂØπÂ∫îÂà∞golangÁöÑ‰∏Ä‰∏™structÔºåËøô‰∫õstruct‰ºöÊê∫Â∏¶ormÂØπÂ∫îÁöÑtag,Â∞±ÂÉè‰∏ãÈù¢ÁöÑstructÂÆö‰πâ‰∏ÄÊ†∑Ôºö 12345678910111213141516type InsInfo struct &#123; Connections string `gorm:"column:connections"` CPU int `gorm:"column:cpu"` CreateTime time.Time `gorm:"column:create_time"` Env int `gorm:"column:env"` ID int64 `gorm:"column:id;primary_key"` IP string `gorm:"column:ip"` Organization string `gorm:"column:organization"` Pass string `gorm:"column:pass"` Port string `gorm:"column:port"` RegionId string `gorm:"column:regionid"` ServerIP string `gorm:"column:server_ip"` Status int `gorm:"column:status"` Type string `gorm:"column:type"` UUID string `gorm:"column:uuid"`&#125; ËøôÊòØgormÂØπÂ∫îÁöÑÊï∞ÊçÆÂ∫ìË°®ÁöÑstructÊò†Â∞ÑÔºåÂç≥‰ΩøÊï∞ÊçÆË°®ÁöÑÂ≠óÊÆµ‰∏çÂ§öÔºåÂ¶ÇÊûúÊòØÊâãÂä®ÂÜôËµ∑Êù•‰πüÊòØ‰∏Ä‰∫õÈáçÂ§çÊÄßÁöÑÂ∑•‰Ωú„ÄÇÂÉèMySQLËøôÁßçÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÔºåÊàë‰ª¨‰∏ÄËà¨‰ºöÁî®ormÂéªÊìç‰ΩúÊï∞ÊçÆÂ∫ìÔºå‰∫éÊòØÂ∞±ÊÉ≥ÔºåmysqlÁöÑÊï∞ÊçÆË°®ËÉΩ‰∏çËÉΩÊù•Ëá™Âä®ÁîüÊàêgolang ÁöÑstructÂÆö‰πâ„ÄÇÊàë‰ª¨Áü•ÈÅìmysqlÊúâ‰∏™Ëá™Â∏¶ÁöÑÊï∞ÊçÆÂ∫ìinformation_schemaÔºåÊúâ‰∏ÄÂº†Ë°®COLUMNSÔºåÂÆÉÁöÑÂ≠óÊÆµÂåÖÂê´Êï∞ÊçÆÂ∫ìÂêç„ÄÅË°®Âêç„ÄÅÂ≠óÊÆµÂêç„ÄÅÂ≠óÊÆµÁ±ªÂûãÁ≠âÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏™Ë°®ÁöÑÊï∞ÊçÆÔºåÊääÂØπÂ∫îÁöÑË°®ÁöÑÂ≠óÊÆµ‰ø°ÊÅØËØªÂèñÂá∫Êù•ÔºåÁÑ∂ÂêéÂÜçÊ†πÊçÆgolangÁöÑËØ≠Ê≥ïËßÑÂàôÔºåÁîüÊàêÂØπÂ∫îÁöÑstruct„ÄÇ Ë∞ÉÁ†î‰∫Ü‰∏Ä‰∏ãÁõÆÂâçÊúâ‰∏Ä‰∫õÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÂÉè db2structÁ≠âÔºåÊÑüËßâÁî®Ëµ∑Êù•ÊØîËæÉÁπÅÁêêÔºåÂú®ÊÉ≥ËÉΩ‰∏çËÉΩÊèê‰æõ‰∏Ä‰∏™ÂºÄÁÆ±Âç≥Áî®ÁöÑÁéØÂ¢ÉÔºåÊèê‰æõwebÁïåÈù¢ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÂ°´ÂÜôÊï∞ÊçÆÂ∫ì‰ø°ÊÅØÔºåÂ∞±ÂèØ‰ª•‰∏ÄÈîÆÁîüÊàêÂØπÂ∫îÁöÑORMÁöÑstructÔºå‰∫éÊòØÂ∞±ËØûÁîü‰∫ÜËøô‰∏™È°πÁõÆÔºöhttps://github.com/hantmac/fuckdb Â¶ÇÊûú‰Ω†ÁöÑÊï∞ÊçÆÂ∫ìÂú®Êú¨Âú∞ÔºåÈÇ£‰πàÂè™ÈúÄË¶ÅÊâßË°å docker-compose up -dÔºåËÆøÈóÆlocalhost:8088Ôºå‰Ω†Â∞±‰ºöÂæóÂà∞‰∏ãÈù¢ÁöÑÁïåÈù¢Ôºö Â¶ÇÊûú‰Ω†ÁöÑÊï∞ÊçÆÂ∫ìÂú®ÂÜÖÁΩëÊúçÂä°Âô®‰∏äÔºå‰Ω†ÈúÄË¶ÅÂÖà‰øÆÊîπÂêéÁ´ØÊé•Âè£ÁöÑip:port,ÁÑ∂ÂêéÈáçÊñ∞build DockerÈïúÂÉèÔºåpushÂà∞Ëá™Â∑±ÁöÑÈïúÂÉè‰ªìÂ∫ìÔºåÁÑ∂Âêé‰øÆÊîπdocker-compose.yamlÔºåÂÜçÊâßË°ådocker-compose up -d„ÄÇ‰øÆÊîπÁöÑ‰ΩçÁΩÆÊòØÔºöfuckdb/frontend/src/config/index.js. Âè™ÈúÄË¶ÅÂ°´ÂÖ•Êï∞ÊçÆÂ∫ìÁõ∏ÂÖ≥‰ø°ÊÅØÔºå‰ª•Âèä‰Ω†ÊÉ≥ÂæóÂà∞ÁöÑgolang‰ª£Á†ÅÁöÑpackage name„ÄÅstruct name,ÁÑ∂ÂêéÁÇπÂáªÁîüÊàêÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞gormÂØπÂ∫îÁöÑÁªìÊûÑ‰ΩìÊò†Â∞ÑÔºö ‰Ω†Âè™ÈúÄË¶ÅÊã∑Ë¥ù‰Ω†ÁöÑ‰ª£Á†ÅÂà∞È°πÁõÆ‰∏≠Âç≥ÂèØ„ÄÇÊàë‰ª¨ÈÉΩÁü•ÈÅìgolangÁöÑstructÁöÑtagÊúâÂæàÂ§öÂäüËÉΩÔºåËøôÈáå‰πüÊèê‰æõ‰∫ÜÂæàÂ§ötagÁöÑÂèØÈÄâÈ°πÔºåÊØîÂ¶Çjson,xmlÁ≠âÔºåÂêéÈù¢‰ºöÊõæÂä†Êõ¥Â§öÁöÑtagÂèØÈÄâÈ°πÊîØÊåÅ„ÄÇ ‰∏äÈù¢ÁöÑGIFÂ±ïÁ§∫‰∫ÜÂ¢ûÂä†‰∫ÜÁºìÂ≠òÂäüËÉΩÁöÑÁâàÊú¨ÔºåËÆ∞ÂøÜ‰Ω†‰πãÂâçÂ°´ÂÜôËøáÁöÑÊï∞ÊçÆÂ∫ì‰ø°ÊÅØÔºåÁúÅÂéª‰∫ÜÂ§ßÈáèÈáçÂ§çÁöÑÊìç‰ΩúÔºå‰Ω†‰∏çÁî®ÂÜçÂ°´ÂÜôÁπÅÁêêÁöÑÊï∞ÊçÆÂ∫ìÂêçÔºåË°®ÂêçÔºåÁ≠âÁ≠âÔºåÂè™ÈúÄ‰∏ÄÈîÆÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞ÂØπÂ∫îÁöÑ‰ª£Á†ÅÔºåÊòØ‰∏çÊòØÂæàÊñπ‰æøÂïä„ÄÇps:ÁõÆÂâçÊï∞ÊçÆÂ∫ì‰ø°ÊÅØÊ≤°ÊúâÂÅöÂä†ÂØÜÔºåÊâÄ‰ª•‰∏çÊñπ‰æøÊîæÂà∞ÂÖ¨ÁΩë‰∏ä‰ΩøÁî®Ôºå‰ªÖÈôê‰∫éÂÜÖÁΩëÔºåÂêéÈù¢‰ºöËøõË°åÁõ∏Â∫îÁöÑÂºÄÂèëÊîØÊåÅ„ÄÇÁõÆÂâçËøô‰∏™Â∑•ÂÖ∑Âú®Êàë‰ª¨ÁªÑÂÜÖÂ∑≤ÁªèÂºÄÂßã‰ΩøÁî®ÔºåÂèçÈ¶àÊØîËæÉÂ•ΩÔºåËäÇÁúÅ‰∫ÜÂæàÂ§öÈáçÂ§çÁöÑÂ∑•‰ΩúÔºåÂ∞§ÂÖ∂ÊòØÂú®ÂºÄÂèëÁöÑÊó∂ÂÄôÁî®Âà∞Âêå‰∏Ä‰∏™Â∫ìÁöÑÂ§öÂº†Ë°®ÔºåÂæàÂø´Â∞±ÂèØ‰ª•ÂÆåÊàêÊï∞ÊçÆÂ∫ìË°®-&gt;strcutÁöÑÊò†Â∞Ñ„ÄÇ Ê¨¢ËøéËØïÁî®&amp;ÂèçÈ¶à&amp;Contribute„ÄÇ‰ª£Á†ÅÂú∞ÂùÄÔºöhttps://github.com/hantmac/fuckdb]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[viperÈÖçÁΩÆËØ¶Ëß£]]></title>
    <url>%2F2019%2F12%2F23%2Fviper%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[viper ËØªÂèñÈÖçÁΩÆÊñá‰ª∂ viper È°πÁõÆÂú∞ÂùÄ Ôºögithub.com/spf13/viper viper ÊòØ‰ªÄ‰πà go ÂºÄÂèëÂ∑•ÂÖ∑Ôºå‰∏ªË¶ÅÊòØÁî®‰∫éÂ§ÑÁêÜÂêÑÁßçÊ†ºÂºèÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÁÆÄÂåñÁ®ãÂ∫èÈÖçÁΩÆÁöÑËØªÂèñÈóÆÈ¢ò viper ÊîØÊåÅÔºö ËÆæÁΩÆÈªòËÆ§ÈÖçÁΩÆ ÊîØÊåÅËØªÂèñ JSON TOML YAML HCL Âíå Java Â±ûÊÄßÈÖçÁΩÆÊñá‰ª∂ ÁõëÂê¨ÈÖçÁΩÆÊñá‰ª∂ÂèòÂåñÔºåÂÆûÊó∂ËØªÂèñËØªÂèñÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπ ËØªÂèñÁéØÂ¢ÉÂèòÈáèÂÄº ËØªÂèñËøúÁ®ãÈÖçÁΩÆÁ≥ªÁªü (etcd Consul) ÂíåÁõëÊéßÈÖçÁΩÆÂèòÂåñ ËØªÂèñÂëΩ‰ª§ Flag ÂÄº ËØªÂèñ buffer ÂÄº ËØªÂèñÁ°ÆÂàáÂÄº ÂÆâË£Ö12go get github.com/fsnotify/fsnotifygo get github.com/spf13/viper viper ÁöÑÂü∫Êú¨Áî®Ê≥ïÈÖçÁΩÆÊñá‰ª∂ json ÈÖçÁΩÆÊñá‰ª∂ (config.json) 12345678910111213141516&#123;"port": 10666,"mysql": &#123; "url": "(127.0.0.1:3306)/biezhi", "username": "root", "password": "123456"&#125;,"redis": ["127.0.0.1:6377", "127.0.0.1:6378", "127.0.0.1:6379"],"smtp": &#123; "enable": true, "addr": "mail_addr", "username": "mail_user", "password": "mail_password", "to": ["xxx@gmail.com", "xxx@163.com"]&#125;&#125; yaml ÈÖçÁΩÆÊñá‰ª∂ (config1.yaml) 1234567891011121314151617port: 10666mysql:url: "(127.0.0.1:3306)/biezhi"username: rootpassword: 123456redis:- 127.0.0.1:6377- 127.0.0.1:6378- 127.0.0.1:6379smtp:enable: trueaddr: mail_addrusername: mail_userpassword: mail_passwordto: - xxx@gmail.com- xxx@163.com Êú¨Âú∞ÈÖçÁΩÆÊñá‰ª∂ËØªÂèñÊñπÂºè Â∞Ü‰∏äËø∞‰∏§‰∏™ÈÖçÁΩÆÊñá‰ª∂Âíå‰∏ãÈù¢ÁöÑ main.go ÊîæÂú®Áªü‰∏ÄÁõÆÂΩï‰πã‰∏ãÔºåÂç≥ÂèØÂÆûÁé∞ËØªÂèñÈÖçÁΩÆÊñá‰ª∂ 1234567891011121314151617181920212223242526272829303132333435package mainimport ( "fmt" "log" "github.com/spf13/viper")func init() &#123; // viper.SetConfigName("config1") // ËØªÂèñyamlÈÖçÁΩÆÊñá‰ª∂ viper.SetConfigName("config") // ËØªÂèñjsonÈÖçÁΩÆÊñá‰ª∂ //viper.AddConfigPath("/etc/appname/") //ËÆæÁΩÆÈÖçÁΩÆÊñá‰ª∂ÁöÑÊêúÁ¥¢ÁõÆÂΩï //viper.AddConfigPath("$HOME/.appname") // ËÆæÁΩÆÈÖçÁΩÆÊñá‰ª∂ÁöÑÊêúÁ¥¢ÁõÆÂΩï viper.AddConfigPath(".") // ËÆæÁΩÆÈÖçÁΩÆÊñá‰ª∂ÂíåÂèØÊâßË°å‰∫åËøõÂà∂Êñá‰ª∂Âú®Áî®‰∏Ä‰∏™ÁõÆÂΩï if err := viper.ReadInConfig(); err != nil &#123; if _, ok := err.(viper.ConfigFileNotFoundError); ok &#123; // Config file not found; ignore error if desired log.Println("no such config file") &#125; else &#123; // Config file was found but another error was produced log.Println("read config error") &#125; log.Fatal(err) // ËØªÂèñÈÖçÁΩÆÊñá‰ª∂Â§±Ë¥•Ëá¥ÂëΩÈîôËØØ &#125;&#125;func main() &#123; fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑport", viper.GetInt("port")) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.url", viper.GetString(`mysql.url`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.username", viper.GetString(`mysql.username`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.password", viper.GetString(`mysql.password`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑredis", viper.GetStringSlice("redis")) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑsmtp", viper.GetStringMap("smtp"))&#125; ‰ª£Á†ÅËØ¶Ëß£ viper.SetConfigName (‚Äúconfig‚Äù) ËÆæÁΩÆÈÖçÁΩÆÊñá‰ª∂Âêç‰∏∫ config, ‰∏çÈúÄË¶ÅÈÖçÁΩÆÊñá‰ª∂Êâ©Â±ïÂêçÔºåÈÖçÁΩÆÊñá‰ª∂ÁöÑÁ±ªÂûã viper ‰ºöËá™Âä®Ê†πÊçÆÊâ©Â±ïÂêçËá™Âä®ÂåπÈÖç. viper.AddConfigPath (‚Äú.‚Äù) ËÆæÁΩÆÈÖçÁΩÆÊñá‰ª∂ÊêúÁ¥¢ÁöÑÁõÆÂΩïÔºå. Ë°®Á§∫ÂíåÂΩìÂâçÁºñËØëÂ•ΩÁöÑ‰∫åËøõÂà∂Êñá‰ª∂Âú®Âêå‰∏Ä‰∏™ÁõÆÂΩï„ÄÇÂèØ‰ª•Ê∑ªÂä†Â§ö‰∏™ÈÖçÁΩÆÊñá‰ª∂ÁõÆÂΩïÔºåÂ¶ÇÂú®Á¨¨‰∏Ä‰∏™ÁõÆÂΩï‰∏≠ÊâæÂà∞Â∞±‰∏ç‰∏çÁªßÁª≠Âà∞ÂÖ∂‰ªñÁõÆÂΩï‰∏≠Êü•Êâæ. viper.ReadInConfig () Âä†ËΩΩÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπ viper.Get*** Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂‰∏≠ÈÖçÁΩÆÈ°πÁöÑ‰ø°ÊÅØ viper ÁöÑ‰∏Ä‰∫õÈ´òÁ∫ßÁî®Ê≥ï viper ËÆæÁΩÆÈÖçÁΩÆÈ°πÁöÑÈªòËÆ§ÂÄº 12345678// set default configviper.SetDefault("ContentDir", "content")viper.SetDefault("LayoutDir", "layouts")viper.SetDefault("Taxonomies", map[string]string&#123;"tag": "tags", "category": "categories"&#125;)fmt.Println(viper.GetBool("ContentDir"))fmt.Println(viper.GetString("LayoutDir"))fmt.Println(viper.GetStringMapString("Taxonomies")) ÁõëÂê¨ÂíåÈáçÊñ∞ËØªÂèñÈÖçÁΩÆÊñá‰ª∂ import ‚Äúgithub.com/fsnotify/fsnotify‚Äù 12345viper.WatchConfig()viper.OnConfigChange(func(e fsnotify.Event) &#123; //viperÈÖçÁΩÆÂèëÁîüÂèòÂåñ‰∫Ü ÊâßË°åÂìçÂ∫îÁöÑÊìç‰Ωú fmt.Println("Config file changed:", e.Name)&#125;) ‰ªéÁéØÂ¢ÉÂèòÈáèÂèòÈáè‰∏≠ËØªÂèñ ‰∏ªË¶ÅÁî®Âà∞ÁöÑÊòØ‰∏ãÈù¢‰∏â‰∏™‰∏™ÊñπÊ≥ï 1234567891011121314// AutomaticEnv has Viper check ENV variables for all.// keys set in config, default &amp; flagsAutomaticEnv()// BindEnv binds a Viper key to a ENV variable.// ENV variables are case sensitive.// If only a key is provided, it will use the env key matching the key, uppercased.// EnvPrefix will be used when set when env name is not provided.BindEnv(string‚Ä¶) : error// SetEnvPrefix defines a prefix that ENVIRONMENT variables will use.// E.g. if your prefix is "spf", the env registry will look for env// variables that start with "SPF_".SetEnvPrefix(string) ÁÆÄÂçïÁöÑ‰ΩøÁî® demo Â¶Ç‰∏ãÊâÄÁ§∫ 1234567891011121314151617181920212223242526272829package main import ( "fmt" "os" "github.com/spf13/viper")func main() &#123; prefix := "PROJECTNAME" envs := map[string]string&#123; "LOG_LEVEL": "INFO", "MODE": "DEV", "MYSQL_USERNAME": "root", "MYSQL_PASSWORD": "xxxx", &#125; for k, v := range envs &#123; os.Setenv(fmt.Sprintf("%s_%s", prefix, k), v) &#125; v := viper.New() v.SetEnvPrefix(prefix) v.AutomaticEnv() for k, _ := range envs &#123; fmt.Printf("env `%s` = %s\n", k, v.GetString(k)) &#125;&#125; Ëé∑ÂèñËøúÁ®ãÈÖçÁΩÆ ‰ΩøÁî® github.com/spf13/viper/remote ÂåÖ import _ ‚Äúgithub.com/spf13/viper/remote‚Äù Viper ÂèØ‰ª•‰ªé‰æãÂ¶Ç etcd„ÄÅConsul ÁöÑËøúÁ®ã Key/Value Â≠òÂÇ®Á≥ªÁªüÁöÑ‰∏Ä‰∏™Ë∑ØÂæÑ‰∏äÔºåËØªÂèñ‰∏Ä‰∏™ÈÖçÁΩÆÂ≠óÁ¨¶‰∏≤ÔºàJSON, TOML, YAML Êàñ HCL Ê†ºÂºèÔºâ. Ëøô‰∫õÂÄº‰ºòÂÖà‰∫éÈªòËÆ§ÂÄºÔºå‰ΩÜ‰ºöË¢´‰ªéÁ£ÅÁõòÊñá‰ª∂„ÄÅÂëΩ‰ª§Ë°å flag„ÄÅÁéØÂ¢ÉÂèòÈáèÁöÑÈÖçÁΩÆÊâÄË¶ÜÁõñ. Êú¨‰∫∫ÂØπ consul ÊØîËæÉÁÜüÊÇâÔºåÁî®ÂÆÉÊù•ÂÅö‰æãÂ≠ê È¶ñÂÖàÂú®Êú¨Âú∞ÂêØÂä® consul 1consul agent -dev Âπ∂Âú® consul ‰∏äËÆæÁΩÆÂêç‰∏∫ config ÁöÑ json ÈÖçÁΩÆÊñá‰ª∂ ‰ª£Á†ÅÂ¶Ç‰∏ã 1234567891011121314151617181920212223242526package mainimport ( "fmt" "log" "github.com/spf13/viper" _ "github.com/spf13/viper/remote")func main() &#123; v := viper.New() v.AddRemoteProvider("consul", "localhost:8500", "config") v.SetConfigType("json") // Need to explicitly set this to json if err := v.ReadRemoteConfig(); err != nil &#123; log.Println(err) return &#125; fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑport", v.GetInt("port")) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.url", v.GetString(`mysql.url`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.username", v.GetString(`mysql.username`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.password", v.GetString(`mysql.password`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑredis", v.GetStringSlice("redis")) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑsmtp", v.GetStringMap("smtp"))&#125; ‰ªé io.Reader ‰∏≠ËØªÂèñÈÖçÁΩÆ‰ø°ÊÅØ È¶ñÂÖàÁªôÂ§ßÂÆ∂Êù•ÊÆµ‰æãÂ≠ê 123456789101112131415161718192021222324252627282930313233343536373839404142package mainimport ( "bytes" "fmt" "github.com/spf13/viper")func main() &#123; v := viper.New() v.SetConfigType("json") // ËÆæÁΩÆÈÖçÁΩÆÊñá‰ª∂ÁöÑÁ±ªÂûã // ÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπ var jsonExample = []byte(`&#123; "port": 10666, "mysql": &#123; "url": "(127.0.0.1:3306)/biezhi", "username": "root", "password": "123456" &#125;, "redis": ["127.0.0.1:6377", "127.0.0.1:6378", "127.0.0.1:6379"], "smtp": &#123; "enable": true, "addr": "mail_addr", "username": "mail_user", "password": "mail_password", "to": ["xxx@gmail.com", "xxx@163.com"] &#125;&#125;`) //ÂàõÂª∫io.Reader v.ReadConfig(bytes.NewBuffer(jsonExample)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑport", v.GetInt("port")) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.url", v.GetString(`mysql.url`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.username", v.GetString(`mysql.username`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑmysql.password", v.GetString(`mysql.password`)) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑredis", v.GetStringSlice("redis")) fmt.Println("Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑsmtp", v.GetStringMap("smtp"))&#125; Ëøô‰∏™ÂäüËÉΩÊó•Â∏∏ÁöÑ‰ΩøÁî®ÊÉÖÂÜµËæÉÂ∞ëÔºå‰æãÂ¶ÇËøôÊ†∑ÁöÑ‰∏Ä‰∏™ÊÉÖÊôØÔºö ÈÖçÁΩÆÊñá‰ª∂ÊîæÂú® oss ‰∏äÊàñËÄÖ github Êüê‰∏™ÁßÅÊúâ‰ªìÂ∫ì‰∏äÔºåviper Âπ∂Ê≤°ÊúâÊèê‰æõÁõ¥Êé•ÁöÑÊé•Âè£ÂéªËé∑ÂèñÔºåËøôÊ†∑Êàë‰ª¨ÂèØ‰ª•Âü∫‰∫éÁ¨¨‰∏âÊñπÊâòÁÆ°Âπ≥Âè∞ÁöÑ sdk ÂÜô‰∏ÄÂ•óËé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ bytes ÁöÑÂ∑•ÂÖ∑ÔºåÂ∞ÜÁªìÊûúÊîæÂÖ• io.Reader ‰∏≠ÔºåÂÜçËøõË°åÈÖçÁΩÆÊñá‰ª∂ÁöÑËß£Êûê„ÄÇ ‰∏äËø∞ÊµÅÁ®ãÊÑüËßâÂ•ΩÂÉèÊØîËæÉÈ∏°ËÇãÔºåÂ§çÊùÇ‰∫ÜÊï¥‰∏™ÊµÅÁ®ãÔºöÊàëÊó¢ÁÑ∂ÂèØ‰ª•ÈÄöËøáÁ¨¨‰∏âÊñπÁöÑ sdk Áõ¥Êé•ÊãøÂà∞ bytesÔºå‰∏∫‰Ωï‰∏çËá™Â∑±Áõ¥Êé•ËøõË°åËß£ÊûêÂë¢ÔºüËÄåË¶ÅÂÄüÂä© viper Êù•Ëß£Êûê„ÄÇÂèØËÉΩÊúâ‰∫∫‰ºöËØ¥ÔºåÈÖçÁΩÆÊñá‰ª∂Â¶ÇÊûúÊ†ºÂºè‰∏çÂêåÂë¢ÔºüÁ°ÆÂÆûÔºåviper ÁöÑÂá∫Áé∞Â∞±ÊòØ‰∏∫‰∫ÜÈíàÂØπÂ§öÁßçÊ†ºÂºèÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇ‰ΩÜÊòØÂú®Ê≠£ÂºèÁöÑÈ°πÁõÆ‰∏≠ÔºåÈÖçÁΩÆÊñá‰ª∂ÁöÑÊ†ºÂºè‰∏ÄËà¨‰∏ç‰ºöÂèòÔºåÂèØ‰ª•Ëá™Â∑±ÂÜô‰∏ÄÂ•óËß£ÊûêÁöÑÂ∑•ÂÖ∑Ôºå‰πüÂ∞±Ê≤°Êúâ‰ΩøÁî® viper ÁöÑÈúÄÊ±Ç‰∫Ü„ÄÇËÄå‰∏îÂØπ‰∫éÊüê‰∏ÄÁßçÁâπÂÆöÊ†ºÂºèÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºàJSONÔºåYAML‚Ä¶ÔºâÔºåGolang Â∑≤ÁªèÊúâË∂≥Â§üÂº∫Â§ßÁöÑÂåÖÊù•ËøõË°åËß£Êûê‰∫Ü„ÄÇ ‰ΩÜÊòØ‰∏çÂæó‰∏çÊâøËÆ§ viper ÁöÑÂÆûÁé∞Á°ÆÂÆûÊòØÂæàÊµÅÂºäÁöÑ„ÄÇÂú®‰∏ÄËà¨ÁöÑÂø´ÈÄüÂºÄÂèëËøáÁ®ã‰∏≠ÔºåÁõ¥Êé•‰ΩøÁî® viper Á°ÆÂÆûÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨ÁúÅÂéªÂæàÂ§öÁöÑÈ∫ªÁÉ¶ÔºåËÆ©Êàë‰ª¨ÈõÜ‰∏≠Á≤æÂäõÈíàÂØπ‰∫é‰∏öÂä°ÈÄªËæëÁöÑÂÆûÁé∞„ÄÇ ‰∏™‰∫∫ËßâÂæóÂèØ‰ª•Ê†πÊçÆÂÆûÈôÖÈúÄÊ±ÇÂú® viper ÂÜçËøõË°å‰∏ÄÂ±ÇÂ∞ÅË£ÖÔºåÊé•ÂÖ•‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÁ¨¨‰∏âÊñπÂπ≥Âè∞ÁöÑ sdkÔºàgithubÔºåaliyun oss‚Ä¶Ôºâ, ËøôÊ†∑Âç≥ÂèØ‰ª•ËØªÂèñÊú¨Âú∞ÈÖçÁΩÆÊñá‰ª∂Ôºå‰πüÂèØ‰ª•ËØªÂèñËøúÁ´ØÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÂèØ‰ª•ÈÄöËøáÂëΩ‰ª§Ë°åÂèÇÊï∞Êù•ÂÆûÁé∞ dev Ê®°ÂºèÂíå deploy Ê®°ÂºèÁöÑÂàáÊç¢„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî®swaggoËá™Âä®ÁîüÊàêAPIÊñáÊ°£]]></title>
    <url>%2F2019%2F12%2F10%2F%E4%BD%BF%E7%94%A8swaggo%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90API%E6%96%87%E6%A1%A3%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáËΩ¨ËΩΩËá™Ôºö https://razeencheng.com/post/go-swagger.html Áõ∏‰ø°ÂæàÂ§öÁ®ãÂ∫èÁåøÂíåÊàë‰∏ÄÊ†∑‰∏çÂñúÊ¨¢ÂÜôAPIÊñáÊ°£„ÄÇÂÜô‰ª£Á†ÅÂ§öËàíÊúçÔºåÂÜôÊñáÊ°£‰∏ç‰ªÖË¶ÅËä±Ë¥πÂ§ßÈáèÁöÑÊó∂Èó¥ÔºåÊúâÊó∂ÂÄôËøò‰∏çËÉΩÂÅöÂà∞Èù¢Èù¢ÂÖ∑ÂÖ®„ÄÇ‰ΩÜAPIÊñáÊ°£ÊòØÂøÖ‰∏çÂèØÂ∞ëÁöÑÔºåÁõ∏‰ø°ÂÖ∂ÈáçË¶ÅÊÄßÂ∞±‰∏çÁî®ÊàëËØ¥‰∫ÜÔºå‰∏Ä‰ªΩÂê´Á≥äÁöÑÊñáÊ°£ÁîöËá≥ËÉΩËÆ©ÂâçÂêéÁ´Ø‰∫∫ÂëòÊâìËµ∑Êù•„ÄÇ ËÄå‰ªäÂ§©ËøôÁØáÂçöÂÆ¢‰ªãÁªçÁöÑswaggoÂ∞±ÊòØËÆ©‰Ω†Âè™ÈúÄË¶Å‰∏ìÊ≥®‰∫é‰ª£Á†ÅÂ∞±ÂèØ‰ª•ÁîüÊàêÂÆåÁæéAPIÊñáÊ°£ÁöÑÂ∑•ÂÖ∑„ÄÇÂ∫üËØùËØ¥ÁöÑÊúâÁÇπÂ§öÔºåÊàë‰ª¨Áõ¥Êé•ÁúãÊñáÁ´†„ÄÇ Â§ßÊ¶ÇÊúÄÂêéÊñáÊ°£ÊïàÊûúÊòØËøôÊ†∑ÁöÑÔºö ÂÖ≥‰∫éSwaggoÊàñËÆ∏‰Ω†‰ΩøÁî®ËøáSwagger, ËÄå swaggoÂ∞±ÊòØ‰ª£Êõø‰∫Ü‰Ω†ÊâãÂä®ÁºñÂÜôyamlÁöÑÈÉ®ÂàÜ„ÄÇÂè™Ë¶ÅÈÄöËøá‰∏Ä‰∏™ÂëΩ‰ª§Â∞±ÂèØ‰ª•Â∞ÜÊ≥®ÈáäËΩ¨Êç¢ÊàêÊñáÊ°£ÔºåËøôËÆ©Êàë‰ª¨ÂèØ‰ª•Êõ¥Âä†‰∏ìÊ≥®‰∫é‰ª£Á†Å„ÄÇ ÁõÆÂâçswaggo‰∏ªË¶ÅÂÆûÁé∞‰∫Üswagger 2.0 ÁöÑ‰ª•‰∏ãÈÉ®ÂàÜÂäüËÉΩÔºö Âü∫Êú¨ÁªìÊûÑÔºàBasic StructureÔºâ API Âú∞ÂùÄ‰∏éÂü∫Êú¨Ë∑ØÂæÑÔºàAPI Host and Base PathÔºâ Ë∑ØÂæÑ‰∏éÊìç‰Ωú ÔºàPaths and OperationsÔºâ ÂèÇÊï∞ÊèèËø∞ÔºàDescribing ParametersÔºâ ËØ∑Ê±ÇÂèÇÊï∞ÊèèËø∞ÔºàDescribing Request BodyÔºâ ËøîÂõûÊèèËø∞ÔºàDescribing ResponsesÔºâ MIME Á±ªÂûãÔºàMIME TypesÔºâ ËÆ§ËØÅÔºàAuthenticationÔºâ Basic Authentication API Keys Ê∑ªÂä†ÂÆû‰æãÔºàAdding ExamplesÔºâ Êñá‰ª∂‰∏ä‰º†ÔºàFile UploadÔºâ Êûö‰∏æÔºàEnumsÔºâ ÊåâÊ†áÁ≠æÂàÜÁªÑÔºàGrouping Operations With TagsÔºâ Êâ©Â±ïÔºàSwagger ExtensionsÔºâ ‰∏ãÊñáÂÜÖÂÆπÂùá‰ª•gin-swaggo‰∏∫‰æã ËøôÈáåÊòØdemoÂú∞ÂùÄ ‰ΩøÁî®ÂÆâË£Öswag cli Âèä‰∏ãËΩΩÁõ∏ÂÖ≥ÂåÖË¶Å‰ΩøÁî®swaggo,È¶ñÂÖàÈúÄË¶ÅÂÆâË£Öswag cli„ÄÇ Â§çÂà∂ 1go get -u github.com/swaggo/swag/cmd/swag ÁÑ∂ÂêéÊàë‰ª¨ËøòÈúÄË¶Å‰∏§‰∏™ÂåÖ„ÄÇ Â§çÂà∂ 1234# gin-swagger ‰∏≠Èó¥‰ª∂go get github.com/swaggo/gin-swagger# swagger ÂÜÖÁΩÆÊñá‰ª∂go get github.com/swaggo/gin-swagger/swaggerFiles Âú®main.goÂÜÖÊ∑ªÂä†Ê≥®ÈáäÂ§çÂà∂ 1234567891011121314151617181920212223242526272829303132333435363738394041424344package mainimport ( &quot;github.com/gin-gonic/gin&quot; ginSwagger &quot;github.com/swaggo/gin-swagger&quot; &quot;github.com/swaggo/gin-swagger/swaggerFiles&quot;)// @title Swagger Example API// @version 1.0// @description This is a sample server celler server.// @termsOfService https://razeen.me// @contact.name Razeen// @contact.url https://razeen.me// @contact.email me@razeen.me// @license.name Apache 2.0// @license.url http://www.apache.org/licenses/LICENSE-2.0.html// @host 127.0.0.1:8080// @BasePath /api/v1func main() &#123; r := gin.Default() store := sessions.NewCookieStore([]byte(&quot;secret&quot;)) r.Use(sessions.Sessions(&quot;mysession&quot;, store)) r.GET(&quot;/swagger/*any&quot;, ginSwagger.WrapHandler(swaggerFiles.Handler)) v1 := r.Group(&quot;/api/v1&quot;) &#123; v1.GET(&quot;/hello&quot;, HandleHello) v1.POST(&quot;/login&quot;, HandleLogin) v1Auth := r.Use(HandleAuth) &#123; v1Auth.POST(&quot;/upload&quot;, HandleUpload) v1Auth.GET(&quot;/list&quot;, HandleList) &#125; &#125; r.Run(&quot;:8080&quot;)&#125; Â¶Ç‰∏äÊâÄÁ§∫ÔºåÊàë‰ª¨ÈúÄË¶ÅÂØºÂÖ• Â§çÂà∂ 12ginSwagger &quot;github.com/swaggo/gin-swagger&quot;&quot;github.com/swaggo/gin-swagger/swaggerFiles&quot; ÂêåÊó∂ÔºåÊ∑ªÂä†Ê≥®Èáä„ÄÇÂÖ∂‰∏≠Ôºö titile: ÊñáÊ°£Ê†áÈ¢ò version: ÁâàÊú¨ description,termsOfService,contact ... Ëøô‰∫õÈÉΩÊòØ‰∏Ä‰∫õÂ£∞ÊòéÔºåÂèØ‰∏çÂÜô„ÄÇ license.name È¢ùÔºåËøô‰∏™ÊòØÂøÖÈ°ªÁöÑ„ÄÇ host,BasePath: Â¶ÇÊûú‰Ω†ÊÉ≥Áõ¥Êé•swaggerË∞ÉËØïAPIÔºåËøô‰∏§È°πÈúÄË¶ÅÂ°´ÂÜôÊ≠£Á°Æ„ÄÇÂâçËÄÖ‰∏∫ÊúçÂä°ÊñáÊ°£ÁöÑÁ´ØÂè£Ôºåip„ÄÇÂêéËÄÖ‰∏∫Âü∫Á°ÄË∑ØÂæÑÔºåÂÉèÊàëËøôÈáåÂ∞±ÊòØ‚Äú/api/v1‚Äù„ÄÇ Âú®ÂéüÊñáÊ°£‰∏≠ËøòÊúâsecurityDefinitions.basic,securityDefinitions.apikeyÁ≠âÔºåËøô‰∫õÈÉΩÊòØÁî®Êù•ÂÅöËÆ§ËØÅÁöÑÔºåÊàëËøôÈáåÊöÇ‰∏çÂ±ïÂºÄ„ÄÇ Âà∞ËøôÈáåÔºåÊàë‰ª¨Âú®mian.goÂêåÁõÆÂΩï‰∏ãÊâßË°åswag initÂ∞±ÂèØ‰ª•Ëá™Âä®ÁîüÊàêÊñáÊ°£ÔºåÂ¶Ç‰∏ãÔºö Â§çÂà∂ 1234‚ûú swaggo-gin git:(master) ‚úó swag init2019/01/12 21:29:14 Generate swagger docs....2019/01/12 21:29:14 Generate general API Info2019/01/12 21:29:14 create docs.go at docs/docs.go ÁÑ∂ÂêéÊàë‰ª¨ÂØºÂÖ•Ëøô‰∏™Ëá™Âä®ÁîüÊàêÁöÑdocsÂåÖÔºåËøêË°åÔºö Â§çÂà∂ 12345678910111213package mainimport ( &quot;github.com/gin-gonic/gin&quot; ginSwagger &quot;github.com/swaggo/gin-swagger&quot; &quot;github.com/swaggo/gin-swagger/swaggerFiles&quot; _ &quot;github.com/razeencheng/demo-go/swaggo-gin/docs&quot;)// @title Swagger Example API// @version 1.0// ... Â§çÂà∂ 1234567891011121314‚ûú swaggo-gin git:(master) ‚úó go build‚ûú swaggo-gin git:(master) ‚úó ./swaggo-gin[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.[GIN-debug] [WARNING] Running in &quot;debug&quot; mode. Switch to &quot;release&quot; mode in production. - using env: export GIN_MODE=release - using code: gin.SetMode(gin.ReleaseMode)[GIN-debug] GET /api/v1/hello --&gt; main.HandleHello (3 handlers)[GIN-debug] POST /api/v1/login --&gt; main.HandleLogin (3 handlers)[GIN-debug] POST /upload --&gt; main.HandleUpload (4 handlers)[GIN-debug] GET /list --&gt; main.HandleList (4 handlers)[GIN-debug] GET /swagger/*any --&gt; github.com/swaggo/gin-swagger.WrapHandler.func1 (4 handlers)[GIN-debug] Listening and serving HTTP on :8080 ÊµèËßàÂô®ÊâìÂºÄhttp://127.0.0.1:8080/swagger/index.html, Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Â¶Ç‰∏ãÊñáÊ°£Ê†áÈ¢òÂ∑≤ÁªèÁîüÊàê„ÄÇ Âú®HandleÂáΩÊï∞‰∏äÊ∑ªÂä†Ê≥®ÈáäÊé•‰∏ãÊù•ÔºåÊàë‰ª¨ÈúÄË¶ÅÂú®ÊØè‰∏™Ë∑ØÁî±Â§ÑÁêÜÂáΩÊï∞‰∏äÂä†‰∏äÊ≥®ÈáäÔºåÂ¶ÇÔºö Â§çÂà∂ 12345678910111213141516171819// @Summary ÊµãËØïSayHello// @Description Âêë‰Ω†ËØ¥Hello// @Tags ÊµãËØï// @Accept mpfd// @Produce json// @Param who query string true &quot;‰∫∫Âêç&quot;// @Success 200 &#123;string&#125; json &quot;&#123;&quot;msg&quot;: &quot;hello Razeen&quot;&#125;&quot;// @Failure 400 &#123;string&#125; json &quot;&#123;&quot;msg&quot;: &quot;who are you&quot;&#125;&quot;// @Router /hello [get]func HandleHello(c *gin.Context) &#123; who := c.Query(&quot;who&quot;) if who == &quot;&quot; &#123; c.JSON(http.StatusBadRequest, gin.H&#123;&quot;msg&quot;: &quot;who are u?&quot;&#125;) return &#125; c.JSON(http.StatusOK, gin.H&#123;&quot;msg&quot;: &quot;hello &quot; + who&#125;)&#125; Êàë‰ª¨ÂÜçÊ¨°swag init, ËøêË°å‰∏Ä‰∏ã„ÄÇ Ê≠§Êó∂ÔºåËØ•APIÁöÑÁõ∏ÂÖ≥ÊèèËø∞Â∑≤ÁªèÁîüÊàê‰∫ÜÔºåÊàë‰ª¨ÁÇπÂáªTry it outËøòÂèØ‰ª•Áõ¥Êé•ÊµãËØïËØ•API„ÄÇ ÊòØ‰∏çÊòØÂæàÂ•ΩÁî®ÔºåÂΩìÁÑ∂ËøôÂπ∂Ê≤°ÊúâÁªìÊùüÔºåËøô‰∫õÊ≥®ÈáäÂ≠óÊÆµÔºåÊàë‰ª¨‰∏Ä‰∏™‰∏™Ëß£Èáä„ÄÇ Ëøô‰∫õÊ≥®ÈáäÂØπÂ∫îÂá∫Áé∞Âú®APIÊñáÊ°£ÁöÑ‰ΩçÁΩÆÔºåÊàëÂú®‰∏äÂõæ‰∏≠Â∑≤ÁªèÊ†áÂá∫ÔºåËøôÈáåÊàë‰ª¨‰∏ªË¶ÅËØ¶ÁªÜËØ¥ËØ¥‰∏ãÈù¢ÂèÇÊï∞Ôºö TagsTags ÊòØÁî®Êù•ÁªôAPIÂàÜÁªÑÁöÑ„ÄÇ AcceptÊé•Êî∂ÁöÑÂèÇÊï∞Á±ªÂûãÔºåÊîØÊåÅË°®Âçï(mpfd) Âíå JSON(json) ProduceËøîÂõûÁöÑÊï∞ÊçÆÁªìÊûÑÔºå‰∏ÄËà¨ÈÉΩÊòØjson, ÂÖ∂‰ªñÊîØÊåÅÂ¶Ç‰∏ãË°®Ôºö Mime Type Â£∞Êòé application/json json text/xml xml text/plain plain html html multipart/form-data mpfd application/x-www-form-urlencoded x-www-form-urlencoded application/vnd.api+json json-api application/x-json-stream json-stream application/octet-stream octet-stream image/png png image/jpeg jpeg image/gif gif ParamÂèÇÊï∞Ôºå‰ªéÂâçÂæÄÂêéÂàÜÂà´ÊòØÔºö @Param 1.ÂèÇÊï∞Âêç 2.ÂèÇÊï∞Á±ªÂûã 3.ÂèÇÊï∞Êï∞ÊçÆÁ±ªÂûã 4.ÊòØÂê¶ÂøÖÈ°ª 5.ÂèÇÊï∞ÊèèËø∞ 6.ÂÖ∂‰ªñÂ±ûÊÄß 1.ÂèÇÊï∞Âêç ÂèÇÊï∞ÂêçÂ∞±ÊòØÊàë‰ª¨Ëß£ÈáäÂèÇÊï∞ÁöÑÂêçÂ≠ó„ÄÇ 2.ÂèÇÊï∞Á±ªÂûã ÂèÇÊï∞Á±ªÂûã‰∏ªË¶ÅÊúâÂõõÁßçÔºö path ËØ•Á±ªÂûãÂèÇÊï∞Áõ¥Êé•ÊãºÊé•Âú®URL‰∏≠ÔºåÂ¶ÇDemo‰∏≠HandleGetFileÔºö Â§çÂà∂ 1// @Param id path integer true &quot;Êñá‰ª∂ID&quot; query ËØ•Á±ªÂûãÂèÇÊï∞‰∏ÄËà¨ÊòØÁªÑÂêàÂú®URL‰∏≠ÁöÑÔºåÂ¶ÇDemo‰∏≠HandleHello Â§çÂà∂ 1// @Param who query string true &quot;‰∫∫Âêç&quot; formData ËØ•Á±ªÂûãÂèÇÊï∞‰∏ÄËà¨ÊòØPOST,PUTÊñπÊ≥ïÊâÄÁî®ÔºåÂ¶ÇDemo‰∏≠HandleLogin Â§çÂà∂ 1// @Param user formData string true &quot;Áî®Êà∑Âêç&quot; default(admin) body ÂΩìAcceptÊòØJSONÊ†ºÂºèÊó∂ÔºåÊàë‰ª¨‰ΩøÁî®ËØ•Â≠óÊÆµÊåáÂÆöÊé•Êî∂ÁöÑJSONÁ±ªÂûã Â§çÂà∂ 1// @Param param body main.JSONParams true &quot;ÈúÄË¶Å‰∏ä‰º†ÁöÑJSON&quot; 3.ÂèÇÊï∞Êï∞ÊçÆÁ±ªÂûã Êï∞ÊçÆÁ±ªÂûã‰∏ªË¶ÅÊîØÊåÅ‰∏Ä‰∏ãÂá†ÁßçÔºö string (string) integer (int, uint, uint32, uint64) number (float32) boolean (bool) Ê≥®ÊÑèÔºåÂ¶ÇÊûú‰Ω†ÊòØ‰∏ä‰º†Êñá‰ª∂ÂèØ‰ª•‰ΩøÁî®file, ‰ΩÜÂèÇÊï∞Á±ªÂûã‰∏ÄÂÆöÊòØformData, Â¶Ç‰∏ãÔºö Â§çÂà∂ 1// @Param file formData file true &quot;Êñá‰ª∂&quot; 4.ÊòØÂê¶ÊòØÂøÖÈ°ª Ë°®ÊòéËØ•ÂèÇÊï∞ÊòØÂê¶ÊòØÂøÖÈ°ªÈúÄË¶ÅÁöÑÔºåÂøÖÈ°ªÁöÑÂú®ÊñáÊ°£‰∏≠‰ºöÈªë‰ΩìÊ†áÂá∫ÔºåÊµãËØïÊó∂ÂøÖÈ°ªÂ°´ÂÜô„ÄÇ 5.ÂèÇÊï∞ÊèèËø∞ Â∞±ÊòØÂèÇÊï∞ÁöÑ‰∏Ä‰∫õËØ¥Êòé 6.ÂÖ∂‰ªñÂ±ûÊÄß Èô§‰∫Ü‰∏äÈù¢Ëøô‰∫õÂ±ûÊÄßÂ§ñÔºåÊàë‰ª¨ËøòÂèØ‰ª•‰∏∫ËØ•ÂèÇÊï∞Â°´ÂÜô‰∏Ä‰∫õÈ¢ùÂ§ñÁöÑÂ±ûÊÄßÔºåÂ¶ÇÊûö‰∏æÔºåÈªòËÆ§ÂÄºÔºåÂÄºËåÉÂõ¥Á≠â„ÄÇÂ¶Ç‰∏ãÔºö Â§çÂà∂ 1234567891011Êûö‰∏æ// @Param enumstring query string false &quot;string enums&quot; Enums(A, B, C)// @Param enumint query int false &quot;int enums&quot; Enums(1, 2, 3)// @Param enumnumber query number false &quot;int enums&quot; Enums(1.1, 1.2, 1.3)ÂÄºÊ∑ªÂä†ËåÉÂõ¥// @Param string query string false &quot;string valid&quot; minlength(5) maxlength(10)// @Param int query int false &quot;int valid&quot; mininum(1) maxinum(10)ËÆæÁΩÆÈªòËÆ§ÂÄº// @Param default query string false &quot;string default&quot; default(A) ËÄå‰∏îËøô‰∫õÂèÇÊï∞ÊòØÂèØ‰ª•ÁªÑÂêà‰ΩøÁî®ÁöÑÔºåÂ¶ÇÔºö Â§çÂà∂ 1// @Param enumstring query string false &quot;string enums&quot; Enums(A, B, C) default(A) SuccessÊåáÂÆöÊàêÂäüÂìçÂ∫îÁöÑÊï∞ÊçÆ„ÄÇÊ†ºÂºè‰∏∫Ôºö // @Success 1.HTTPÂìçÂ∫îÁ†Å {2.ÂìçÂ∫îÂèÇÊï∞Á±ªÂûã} 3.ÂìçÂ∫îÊï∞ÊçÆÁ±ªÂûã 4.ÂÖ∂‰ªñÊèèËø∞ 1.HTTPÂìçÂ∫îÁ†Å ‰πüÂ∞±ÊòØ200Ôºå400Ôºå500ÈÇ£‰∫õ„ÄÇ 2.ÂìçÂ∫îÂèÇÊï∞Á±ªÂûã / 3.ÂìçÂ∫îÊï∞ÊçÆÁ±ªÂûã ËøîÂõûÁöÑÊï∞ÊçÆÁ±ªÂûãÔºåÂèØ‰ª•ÊòØËá™ÂÆö‰πâÁ±ªÂûãÔºåÂèØ‰ª•ÊòØjson„ÄÇ Ëá™ÂÆö‰πâÁ±ªÂûã Âú®Âπ≥Â∏∏ÁöÑ‰ΩøÁî®‰∏≠ÔºåÊàëÈÉΩ‰ºöËøîÂõû‰∏Ä‰∫õÊåáÂÆöÁöÑÊ®°ÂûãÂ∫èÂàóÂåñJSONÁöÑÊï∞ÊçÆÔºåËøôÊó∂ÔºåÂ∞±ÂèØ‰ª•Ëøô‰πàÂÜôÔºö Â§çÂà∂ 1// @Success 200 &#123;object&#125; main.File ÂÖ∂‰∏≠ÔºåÊ®°ÂûãÁõ¥Êé•Áî®ÂåÖÂêç.Ê®°ÂûãÂç≥ÂèØ„ÄÇ‰Ω†‰ºöËØ¥ÔºåÂÅáÂ¶ÇÊàëËøîÂõûÊ®°ÂûãÊï∞ÁªÑÊÄé‰πàÂäûÔºüËøôÊó∂‰Ω†ÂèØ‰ª•Ëøô‰πàÂÜôÔºö Â§çÂà∂ 1// @Success 200 &#123;anrry&#125; main.File json Â∞ÜÂ¶Ç‰Ω†Âè™ÊòØËøîÂõûÂÖ∂‰ªñÁöÑjsonÊï∞ÊçÆÂèØÂ¶Ç‰∏ãÂÜôÔºö Â§çÂà∂ 1// @Success 200 &#123;string&#125; json &quot;&quot; 4.ÂÖ∂‰ªñÊèèËø∞ ÂèØ‰ª•Ê∑ªÂä†‰∏Ä‰∫õËØ¥Êòé„ÄÇ Failure ÂêåSuccess„ÄÇ Router ÊåáÂÆöË∑ØÁî±‰∏éHTTPÊñπÊ≥ï„ÄÇÊ†ºÂºè‰∏∫Ôºö // @Router /path/to/handle [HTTPÊñπÊ≥ï] ‰∏çÁî®Âä†Âü∫Á°ÄË∑ØÂæÑÂì¶„ÄÇ ÁîüÊàêÊñáÊ°£‰∏éÊµãËØïÂÖ∂ÂÆû‰∏äÈù¢Â∑≤ÁªèÁ©øÊèíÁöÑ‰ªãÁªç‰∫Ü„ÄÇ Âú®main.go‰∏ãËøêË°åswag initÂç≥ÂèØÁîüÊàêÂíåÊõ¥Êñ∞ÊñáÊ°£„ÄÇ ÁÇπÂáªÊñáÊ°£‰∏≠ÁöÑTry it outÂç≥ÂèØÊµãËØï„ÄÇ Â¶ÇÊûúÈÉ®ÂàÜAPIÈúÄË¶ÅÁôªÈôÜÔºåÂèØ‰ª•TryÁôªÈôÜÊé•Âè£Âç≥ÂèØ„ÄÇ ‰ºòÂåñÁúãÂà∞ËøôÈáåÔºåÂü∫Êú¨ÂèØ‰ª•‰ΩøÁî®‰∫Ü„ÄÇ‰ΩÜÊñáÊ°£‰∏ÄËà¨Âè™ÊòØÊàë‰ª¨ÊµãËØïÁöÑÊó∂ÂÄôÈúÄË¶ÅÔºåÂΩìÊàëÁöÑ‰∫ßÂìÅ‰∏äÁ∫øÂêéÔºåÊé•Âè£ÊñáÊ°£ÊòØ‰∏çÂ∫îËØ•ÁªôÁî®Êà∑ÁöÑÔºåËÄå‰∏îÂ∏¶ÊúâÊé•Âè£ÊñáÊ°£ÁöÑÂåÖ‰πü‰ºöÂ§ßÂæàÂ§öÔºàswaggoÊòØÁõ¥Êé•buildÂà∞‰∫åËøõÂà∂ÈáåÁöÑÔºâ„ÄÇ ÊÉ≥Ë¶ÅÂ§ÑÁêÜËøôÁßçÊÉÖÂÜµÔºåÊàë‰ª¨ÂèØ‰ª•Âú®ÁºñËØëÁöÑÊó∂ÂÄô‰ºòÂåñ‰∏Ä‰∏ãÔºåÂ¶ÇÂà©Áî®build tagÊù•ÊéßÂà∂ÊòØÂê¶ÁºñËØëÊñáÊ°£„ÄÇ Âú®main.goÂ£∞ÊòéswagHandler,Âπ∂Âú®ËØ•ÂèÇÊï∞‰∏ç‰∏∫Á©∫Êó∂ÊâçÂä†ÂÖ•Ë∑ØÁî±Ôºö Â§çÂà∂ 123456789101112131415package main//...var swagHandler gin.HandlerFuncfunc main()&#123; // ... if swagHandler != nil &#123; r.GET(&quot;/swagger/*any&quot;, swagHandler) &#125; //...&#125; ÂêåÊó∂,Êàë‰ª¨Â∞ÜËØ•ÂèÇÊï∞Âú®Âè¶Â§ñÂä†‰∫Übuild tagÁöÑÂåÖ‰∏≠ÂàùÂßãÂåñ„ÄÇ Â§çÂà∂ 1234567891011121314// +build docpackage mainimport ( _ &quot;github.com/razeencheng/demo-go/swaggo-gin/docs&quot; ginSwagger &quot;github.com/swaggo/gin-swagger&quot; &quot;github.com/swaggo/gin-swagger/swaggerFiles&quot;)func init() &#123; swagHandler = ginSwagger.WrapHandler(swaggerFiles.Handler)&#125; ‰πãÂêéÊàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøÁî®go build -tags &quot;doc&quot;Êù•ÊâìÂåÖÂ∏¶ÊñáÊ°£ÁöÑÂåÖÔºåÁõ¥Êé•go buildÊù•ÊâìÂåÖ‰∏çÂ∏¶ÊñáÊ°£ÁöÑÂåÖ„ÄÇ ‰Ω†‰ºöÂèëÁé∞ÔºåÂç≥‰ΩøÊàëËøô‰πàÂ∞èÁöÑDemo,ÁºñËØëÂêéÁöÑÂ§ßÂ∞è‰πüË¶ÅÁõ∏Â∑Æ19M ! Â§çÂà∂ 123456‚ûú swaggo-gin git:(master) ‚úó go build‚ûú swaggo-gin git:(master) ‚úó ll swaggo-gin-rwxr-xr-x 1 xxx staff 15M Jan 13 00:23 swaggo-gin‚ûú swaggo-gin git:(master) ‚úó go build -tags &quot;doc&quot;‚ûú swaggo-gin git:(master) ‚úó ll swaggo-gin-rwxr-xr-x 1 xxx staff 34M Jan 13 00:24 swaggo-gin ÊñáÁ´†Âà∞ËøôÈáå‰πüÂ∞±ÁªìÊùü‰∫ÜÔºåÂÆåÊï¥ÁöÑDemoÂú∞ÂùÄÂú®ËøôÈáå„ÄÇ Áõ∏ÂÖ≥ÈìæÊé• Swaggo Github Swagger]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>go</tag>
        <tag>swagger</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golangÂºÄÂèëÊïàÁéáÁ•ûÂ•áÊ±áÊÄª]]></title>
    <url>%2F2019%2F12%2F06%2Fgolang%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87%E7%A5%9E%E5%A5%87%E6%B1%87%E6%80%BB%2F</url>
    <content type="text"><![CDATA[‰∏Ä. ÂºÄÂèëÂ∑•ÂÖ∑1)sql2goÁî®‰∫éÂ∞Ü sql ËØ≠Âè•ËΩ¨Êç¢‰∏∫ golang ÁöÑ struct. ‰ΩøÁî® ddl ËØ≠Âè•Âç≥ÂèØ„ÄÇ‰æãÂ¶ÇÂØπ‰∫éÂàõÂª∫Ë°®ÁöÑËØ≠Âè•: show create table xxx. Â∞ÜËæìÂá∫ÁöÑËØ≠Âè•ÔºåÁõ¥Êé•Á≤òË¥¥ËøõÂéªÂ∞±Ë°å„ÄÇhttp://stming.cn/tool/sql2go.html 2)toml2goÁî®‰∫éÂ∞ÜÁºñÁ†ÅÂêéÁöÑ toml ÊñáÊú¨ËΩ¨Êç¢ÈóÆ golang ÁöÑ struct.https://xuri.me/toml-to-go/ 3)curl2goÁî®Êù•Â∞Ü curl ÂëΩ‰ª§ËΩ¨Âåñ‰∏∫ÂÖ∑‰ΩìÁöÑ golang ‰ª£Á†Å.https://mholt.github.io/curl-to-go/ 4)json2goÁî®‰∫éÂ∞Ü json ÊñáÊú¨ËΩ¨Êç¢‰∏∫ struct.https://mholt.github.io/json-to-go/ 5)mysql ËΩ¨ ES Â∑•ÂÖ∑http://www.ischoolbar.com/EsParser/ 6)golangÊ®°ÊãüÊ®°ÊùøÁöÑÂ∑•ÂÖ∑ÔºåÂú®ÊîØÊåÅÊ≥õÂûã‰πãÂâçÔºåÂèØ‰ª•ËÄÉËôë‰ΩøÁî®„ÄÇhttps://github.com/cheekybits/genny 7)Êü•ÁúãÊüê‰∏Ä‰∏™Â∫ìÁöÑ‰æùËµñÊÉÖÂÜµÔºåÁ±ª‰ºº‰∫é go list ÂäüËÉΩhttps://github.com/KyleBanks/depth 8)‰∏Ä‰∏™Â•ΩÁî®ÁöÑÊñá‰ª∂ÂéãÁº©ÂíåËß£ÂéãÂ∑•ÂÖ∑ÔºåÈõÜÊàê‰∫Ü zipÔºåtar Á≠âÂ§öÁßçÂäüËÉΩÔºå‰∏ªË¶ÅËøòÊúâË∑®Âπ≥Âè∞„ÄÇhttps://github.com/mholt/archiver 9)go ÂÜÖÁΩÆÂëΩ‰ª§go list ÂèØ‰ª•Êü•ÁúãÊüê‰∏Ä‰∏™ÂåÖÁöÑ‰æùËµñÂÖ≥Á≥ª.go vet ÂèØ‰ª•Ê£ÄÊü•‰ª£Á†Å‰∏çÁ¨¶Âêà golang ËßÑËåÉÁöÑÂú∞Êñπ„ÄÇ 10)ÁÉ≠ÁºñËØëÂ∑•ÂÖ∑https://github.com/silenceper/gowatch 11)revivegolang ‰ª£Á†ÅË¥®ÈáèÊ£ÄÊµãÂ∑•ÂÖ∑https://github.com/mgechev/revive 12)Go Callvisgolang ÁöÑ‰ª£Á†ÅË∞ÉÁî®ÈìæÂõæÂ∑•ÂÖ∑https://github.com/TrueFurby/go-callvis 13)RealizeÂºÄÂèëÊµÅÁ®ãÊîπËøõÂ∑•ÂÖ∑https://github.com/oxequa/realize 14)GotestsËá™Âä®ÁîüÊàêÊµãËØïÁî®‰æãÂ∑•ÂÖ∑https://github.com/cweill/gotests ‰∫å.Ë∞ÉËØïÂ∑•ÂÖ∑1)perf‰ª£ÁêÜÂ∑•ÂÖ∑ÔºåÊîØÊåÅÂÜÖÂ≠òÔºåcpuÔºåÂ†ÜÊ†àÊü•ÁúãÔºåÂπ∂ÊîØÊåÅÁÅ´ÁÑ∞Âõæ.perf Â∑•ÂÖ∑Âíå go-torch Â∑•ÂÖ∑ÔºåÂø´Êç∑ÂÆö‰ΩçÁ®ãÂ∫èÈóÆÈ¢ò.https://github.com/uber-archive/go-torchhttps://github.com/google/gops 2)dlv ËøúÁ®ãË∞ÉËØïÂü∫‰∫é goland+dlv ÂèØ‰ª•ÂÆûÁé∞ËøúÁ®ãË∞ÉÂºèÁöÑËÉΩÂäõ.https://github.com/go-delve/delveÊèê‰æõ‰∫ÜÂØπ golang ÂéüÁîüÁöÑÊîØÊåÅÔºåÁõ∏ÊØî gdb Ë∞ÉËØïÔºåÁÆÄÂçïÂ§™Â§ö„ÄÇ 3)ÁΩëÁªú‰ª£ÁêÜÂ∑•ÂÖ∑goproxy ‰ª£ÁêÜÔºåÊîØÊåÅÂ§öÁßçÂçèËÆÆÔºåÊîØÊåÅ ssh Á©øÈÄèÂíå kcp ÂçèËÆÆ.https://github.com/snail007/goproxy 4)ÊäìÂåÖÂ∑•ÂÖ∑go-sniffer Â∑•ÂÖ∑ÔºåÂèØÊâ©Â±ïÁöÑÊäìÂåÖÂ∑•ÂÖ∑ÔºåÂèØ‰ª•ÂºÄÂèëËá™ÂÆö‰πâÂçèËÆÆÁöÑÂ∑•ÂÖ∑ÂåÖ. Áé∞Âú®Âè™ÊîØÊåÅ‰∫Ü httpÔºåmysqlÔºåredisÔºåmongodb.Âü∫‰∫éËøô‰∏™Â∑•ÂÖ∑ÔºåÊàë‰ª¨ÂºÄÂèë‰∫Ü qapp ÂçèËÆÆÁöÑÊäìÂåÖ„ÄÇhttps://github.com/40t/go-sniffer 5)ÂèçÂêë‰ª£ÁêÜÂ∑•ÂÖ∑ÔºåÂø´Êç∑ÂºÄÊîæÂÜÖÁΩëÁ´ØÂè£‰æõÂ§ñÈÉ®‰ΩøÁî®„ÄÇngrok ÂèØ‰ª•ËÆ©ÂÜÖÁΩëÊúçÂä°Â§ñÈÉ®Ë∞ÉÁî®https://ngrok.com/https://github.com/inconshreveable/ngrok 6)ÈÖçÁΩÆÂåñÁîüÊàêËØÅ‰π¶‰ªéÊ†πËØÅ‰π¶ÔºåÂà∞‰∏öÂä°‰æßËØÅ‰π¶‰∏ÄÈîÆÁîüÊàê.https://github.com/cloudflare/cfssl 7)ÂÖçË¥πÁöÑËØÅ‰π¶Ëé∑ÂèñÂ∑•ÂÖ∑Âü∫‰∫é acme ÂçèËÆÆÔºå‰ªé letsencrypt ÁîüÊàêÂÖçË¥πÁöÑËØÅ‰π¶ÔºåÊúâÊïàÊúü 1 Âπ¥ÔºåÂèØËá™Âä®Áª≠Êúü„ÄÇhttps://github.com/Neilpang/acme.sh 8)ÂºÄÂèëÁéØÂ¢ÉÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÂçïÊú∫Êê≠Âª∫ÂèØÁßªÊ§çÂ∑•ÂÖ∑ÁöÑÂà©Âô®„ÄÇÊîØÊåÅÂ§öÁßçËôöÊãüÊú∫ÂêéÁ´Ø„ÄÇvagrantÂ∏∏Ë¢´ÊãøÊù•Âêå docker Áõ∏ÊØîÔºåÂÄºÂæóÊã•Êúâ„ÄÇhttps://github.com/hashicorp/vagrant 9)ËΩªÈáèÁ∫ßÂÆπÂô®Ë∞ÉÂ∫¶Â∑•ÂÖ∑nomad ÂèØ‰ª•ÈùûÂ∏∏Êñπ‰æøÁöÑÁÆ°ÁêÜÂÆπÂô®Âíå‰º†ÁªüÂ∫îÁî®ÔºåÁõ∏ÊØî k8s Êù•ËØ¥ÔºåÁÆÄÂçï‰∏çË¶ÅÂ§™Â§ö.https://github.com/hashicorp/nomad 10)ÊïèÊÑü‰ø°ÊÅØÂíåÂØÜÈí•ÁÆ°ÁêÜÂ∑•ÂÖ∑https://github.com/hashicorp/vault 11)È´òÂ∫¶ÂèØÈÖçÁΩÆÂåñÁöÑ http ËΩ¨ÂèëÂ∑•ÂÖ∑ÔºåÂü∫‰∫é etcd ÈÖçÁΩÆ„ÄÇhttps://github.com/gojek/weaver 12)ËøõÁ®ãÁõëÊéßÂ∑•ÂÖ∑ supervisorhttps://www.jianshu.com/p/39b476e808d8 13)Âü∫‰∫éprocFileËøõÁ®ãÁÆ°ÁêÜÂ∑•ÂÖ∑. Áõ∏ÊØî supervisor Êõ¥Âä†ÁÆÄÂçï„ÄÇhttps://github.com/ddollar/foreman 14)Âü∫‰∫é httpÔºåhttpsÔºåwebsocket ÁöÑË∞ÉËØï‰ª£ÁêÜÂ∑•ÂÖ∑ÔºåÈÖçÁΩÆÂäüËÉΩ‰∏∞ÂØå„ÄÇÂú®Á∫øÊïôËÇ≤ÁöÑ nohost web Ë∞ÉËØïÂ∑•ÂÖ∑ÔºåÂü∫‰∫éÊ≠§ÂºÄÂèë.https://github.com/avwo/whistle 15)ÂàÜÂ∏ÉÂºèË∞ÉÂ∫¶Â∑•ÂÖ∑https://github.com/shunfei/cronsun/blob/master/README_ZH.mdhttps://github.com/ouqiang/gocron 16)Ëá™Âä®ÂåñËøêÁª¥Âπ≥Âè∞ Gaiahttps://github.com/gaia-pipeline/gaia ‰∏â. ÁΩëÁªúÂ∑•ÂÖ∑ Âõõ. Â∏∏Áî®ÁΩëÁ´ôgo ÁôæÁßëÂÖ®‰π¶: https://awesome-go.com/ json Ëß£Êûê: https://www.json.cn/ Âá∫Âè£ IP: https://ipinfo.io/ redis ÂëΩ‰ª§: http://doc.redisfans.com/ ES ÂëΩ‰ª§È¶ñÈ°µ: https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html UrlEncode: http://tool.chinaz.com/Tools/urlencode.aspx Base64: https://tool.oschina.net/encrypt?type=3 Guid: https://www.guidgen.com/ Â∏∏Áî®Â∑•ÂÖ∑: http://www.ofmonkey.com/ ‰∫î. golang Â∏∏Áî®Â∫ìÊó•Âøóhttps://github.com/Sirupsen/logrushttps://github.com/uber-go/zap ÈÖçÁΩÆÂÖºÂÆπ jsonÔºåtomlÔºåyamlÔºåhcl Á≠âÊ†ºÂºèÁöÑÊó•ÂøóÂ∫ì.https://github.com/spf13/viper Â≠òÂÇ®mysql: https://github.com/go-xorm/xormes: https://github.com/elastic/elasticsearchredis: https://github.com/gomodule/redigomongo: https://github.com/mongodb/mongo-go-driverkafka: https://github.com/Shopify/sarama Êï∞ÊçÆÁªìÊûÑhttps://github.com/emirpasic/gods ÂëΩ‰ª§Ë°åhttps://github.com/spf13/cobra Ê°ÜÊû∂https://github.com/grpc/grpc-gohttps://github.com/gin-gonic/gin Âπ∂Âèëhttps://github.com/Jeffail/tunnyhttps://github.com/benmanns/goworkerÁé∞Âú®Êàë‰ª¨Ê°ÜÊû∂Âú®Áî®ÁöÑÔºåËôΩÁÑ∂ star ‰∏çÂ§öÔºå‰ΩÜÊòØÁ°ÆÂÆûÂ•ΩÁî®ÔºåÂΩìÁÑ∂ËøòÂèØ‰ª•Êõ¥Â•ΩÁî®.https://github.com/rafaeldias/async Â∑•ÂÖ∑ÂÆö‰πâ‰∫ÜÂÆûÁî®ÁöÑÂà§ÂÆöÁ±ªÔºå‰ª•ÂèäÈíàÂØπÁªìÊûÑ‰ΩìÁöÑÊ†°È™åÈÄªËæëÔºåÈÅøÂÖç‰∏öÂä°‰æßÂÜôÂ§çÊùÇÁöÑ‰ª£Á†Å.https://github.com/asaskevich/govalidatorhttps://github.com/bytedance/go-tagexpr protobuf Êñá‰ª∂Âä®ÊÄÅËß£ÊûêÁöÑÊé•Âè£ÔºåÂèØ‰ª•ÂÆûÁé∞ÂèçÂ∞ÑÁõ∏ÂÖ≥ÁöÑËÉΩÂäõ„ÄÇhttps://github.com/jhump/protoreflect Ë°®ËææÂºèÂºïÊìéÂ∑•ÂÖ∑https://github.com/Knetic/govaluatehttps://github.com/google/cel-go Â≠óÁ¨¶‰∏≤Â§ÑÁêÜhttps://github.com/huandu/xstrings ratelimit Â∑•ÂÖ∑https://github.com/uber-go/ratelimithttps://blog.csdn.net/chenchongg/article/details/85342086https://github.com/juju/ratelimit golang ÁÜîÊñ≠ÁöÑÂ∫ìÁÜîÊñ≠Èô§‰∫ÜËÄÉËôëÈ¢ëÁéáÈôêÂà∂ÔºåËøòË¶ÅËÄÉËôë qpsÔºåÂá∫ÈîôÁéáÁ≠âÂÖ∂‰ªñ‰∏úË•ø.https://github.com/afex/hystrix-gohttps://github.com/sony/gobreaker Ë°®Ê†ºhttps://github.com/chenjiandongx/go-echarts tail Â∑•ÂÖ∑Â∫ìhttps://github.com/hpcloud/taglshi]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golangËÆæËÆ°Ê®°Âºè‰πãË£ÖÈ•∞Âô®Ê®°Âºè]]></title>
    <url>%2F2019%2F11%2F30%2Fgolang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[Ë£ÖÈ•∞Âô®Ë£ÖÈ•∞Âô®ÁªìÊûÑÊ®°ÂºèÂÖÅËÆ∏Âä®ÊÄÅÂú∞Êâ©Â±ïÁé∞ÊúâÂØπË±°ÁöÑÂäüËÉΩÔºåËÄå‰∏çÊîπÂèòÂÖ∂ÂÜÖÈÉ®ÁªìÊûÑ„ÄÇ Ë£ÖÈ•∞Âô®Êèê‰æõ‰∫Ü‰∏ÄÁßçÁÅµÊ¥ªÁöÑÊñπÊ≥ïÊù•Êâ©Â±ïÂØπË±°ÁöÑÂäüËÉΩ„ÄÇ golang ÂÆûÁé∞‰∏ãÈù¢ÁöÑLogDecorateÁî®signature funcÔºàintÔºâint‰øÆÈ•∞ÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞Êìç‰ΩúÊï¥Êï∞Âπ∂Ê∑ªÂä†ËæìÂÖ•/ËæìÂá∫Êó•ÂøóËÆ∞ÂΩïÂäüËÉΩ„ÄÇ 12345678910111213type Object func(int) intfunc LogDecorate(fn Object) Object &#123; return func(n int) int &#123; log.Println("Starting the execution with the integer", n) result := fn(n) log.Println("Execution is completed with the result", result) return result &#125;&#125; Â¶Ç‰Ωï‰ΩøÁî®1234567func Double(n int) int &#123; return n*2&#125;f := LogDecorate(Double)f(5)//ÂèÇÊï∞‰∏∫5ÔºåÂºÄÂßãÊâßË°å//ÊâßË°åÁöÑÁªìÊûúÊòØ10 ÁªèÈ™å ‰∏éÈÄÇÈÖçÂô®Ê®°Âºè‰∏çÂêåÔºåË¶Å‰øÆÈ•∞ÁöÑÂØπË±°ÊòØÈÄöËøáÊ≥®ÂÖ•Ëé∑ÂæóÁöÑ„ÄÇ Ë£ÖÈ•∞Âô®‰∏çÂ∫îÊõ¥ÊîπÂØπË±°ÁöÑÊé•Âè£„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>ËÆæËÆ°Ê®°Âºè</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[github&DaocloudÊºîËÆ≤Á®øÊï¥ÁêÜ‰∏éÊÄªÁªì]]></title>
    <url>%2F2019%2F11%2F23%2FgithubXDaocloud%E6%BC%94%E8%AE%B2%E7%A8%BF%E6%95%B4%E7%90%86%E4%B8%8E%E6%80%BB%E7%BB%93-md%2F</url>
    <content type="text"><![CDATA[Â§ßÂÆ∂‰∏ãÂçàÂ•ΩÔºå‰ªäÂ§©ÁªôÂ§ßÂÆ∂Â∏¶Êù•ÁöÑÂàÜ‰∫´‰∏ªÈ¢òÊòØ golang ÁöÑÂÜÖÂ≠òÂàÜÊûê‰ª•Âèä‰ºòÂåñÔºå‰∏ªË¶ÅÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜÂÜÖÂÆπÔºå‰∏ÄÊòØ ‰ª•ÂºÄÊ∫êÈ°πÁõÆcrawlabÁöÑÂÜÖÂ≠òÂàÜÊûê‰∏é‰ºòÂåñ‰∏∫‰æãÔºåËÆ≤Ëß£golangÂÜÖÂ≠òË∞É‰ºòÁöÑ‰∏Ä‰∫õÂ∑•ÂÖ∑ÂíåÂàÜÊûêÁöÑËøáÁ®ãÔºõ Á¨¨‰∫åÈÉ®ÂàÜÊòØ‰ªãÁªçÂπ≥Êó∂ÂºÄÂèë‰∏≠ÂÆπÊòìÂøΩÁï•ÁöÑÂíåÂÆπÊòìÂ∏¶Êù•ÊÄßËÉΩÈóÆÈ¢òÁöÑÁÇπÔºå‰ª•ÂèäÂ¶Ç‰ΩïÂéª‰ºòÂåñ„ÄÇ ÂΩìÊó∂Ëøô‰∏™ËØùÈ¢òÁöÑÁÅµÊÑüÊù•Ëá™‰∏Ä‰∏™ÂºÄÊ∫êÈ°πÁõÆ crawlab, crawlabÊòØ‰∏Ä‰∏™ÂàÜÂ∏ÉÂºè‰ªªÂä°Ë∞ÉÂ∫¶Âπ≥Âè∞ÔºåËøôÈáå‰∏çÂ±ïÂºÄËØ¶ÁªÜËß£Èáä‰∫ÜÔºåÂ§ßÂÆ∂ÊúâÂÖ¥Ë∂£ÂèØ‰ª•Âà∞GitHub‰∏ªÈ°µÁúã‰∏Ä‰∏ãÔºåhttps://github.com/crawlab-team/crawlab ÂΩìÊó∂ÊòØÊúâÁî®Êà∑Êä•Âá∫crawlabÂêØÂä®‰∏ÄÊÆµÊó∂Èó¥ÂêéÔºå‰∏ªËäÇÁÇπÊú∫Âô®‰ºöÂá∫Áé∞ÂÜÖÂ≠òÂç†Áî®ËøáÈ´òÁöÑÈóÆÈ¢òÔºå‰∏ÄÂè∞4GÂÜÖÂ≠òÁöÑÊúçÂä°Âô®Âú®ËøêË°åcrawlabÂêéÁ´üÁÑ∂ËÉΩÂç†Áî®3G‰ª•ÁöÑÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊï¥‰∏™masterÂ∞±‰ºödownÊéâÔºå‰∫éÊòØÊàëÂºÄÂßãÂØπcrawlabÁöÑÂêéÁ´ØÊúçÂä°ËøõË°åÊÄßËÉΩÁöÑÂàÜÊûêÔºå‰∏ãÈù¢Â∞ÜÂ∏¶Â§ßÂÆ∂ÂõûÈ°æËøô‰∏ÄËøáÁ®ã„ÄÇ È¶ñÂÖà‰ªãÁªçÔºåGolangÁöÑÊÄßËÉΩÂàÜÊûê‰∏ªË¶ÅÂàÜ‰∏∫‰∏§ÁßçÊñπÂºèÔºå ‰∏ÄÁßçÊòØÈÄöËøáÊñá‰ª∂ÊñπÂºèËæìÂá∫profileÔºåÁâπÁÇπÊòØÁÅµÊ¥ªÊÄßÈ´òÔºåÈÄÇÁî®‰∫éÁâπÂÆö‰ª£Á†ÅÁâáÊÆµÁöÑÂàÜÊûêÔºåÊàë‰ª¨ÈÄöËøáË∞ÉÁî®/runtimeÂåÖ‰∏≠ÁöÑ/pprofÁöÑAPIÁîüÊàêÁõ∏Â∫îÁöÑpprofÊñá‰ª∂ÔºåÁÑ∂Âêé‰ΩøÁî® pprofÂ∞±ÂèØ‰ª•ËøõÂÖ•Á±ª‰ººGDBÁöÑÁ™óÂè£„ÄÇÂú®Ëøô‰∏™Á™óÂè£‰∏≠‰Ω†Â∞±ÂèØ‰ª•Áî®top,list functionÁ≠âÂëΩ‰ª§ÂéªÊü•Áúãcpu,memoryÁöÑÁä∂ÂÜµ‰ª•ÂèägoroutineËøêË°åÊÉÖÂÜµ„ÄÇ Á¨¨‰∫åÁßçÊñπÂºèÂ∞±ÊòØÈÄöËøáHTTPËæìÂá∫profileÔºå ËøôÁßçÊñπÂºèÂ∞±ÈÄÇÂêà‰∫é‰Ω†Ëøò‰∏çÊ∏ÖÊ•öÂà∞Â∫ïÂì™‰∏ÄÊÆµ‰ª£Á†ÅÂá∫Áé∞ÈóÆÈ¢òÔºåËÄå‰∏î‰Ω†ÁöÑÂ∫îÁî®Ë¶ÅÊåÅÁª≠ËøêË°åÁöÑÊÉÖÂÜµ„ÄÇÂú®ÂàÜÊûêcrawlabÁöÑÊó∂ÂÄôÔºåÈááÁî®ÁöÑÊòØËøôÁßçÊñπÂºè„ÄÇÈ¶ñÂÖàÔºåÊàë‰ª¨Âú®crawlabÈ°πÁõÆ‰∏≠ÂµåÂÖ•Â¶Ç‰∏ãÂá†Ë°å‰ª£Á†ÅÔºåÂ∞ÜcrawlabÂêéÁ´ØÊúçÂä°ÂêØÂä®ÂêéÔºåÊµèËßàÂô®‰∏≠ËæìÂÖ•http://ip:8899/debug/pprof/Â∞±ÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™Ê±áÊÄªÂàÜÊûêÈ°µÈù¢ÔºåÊòæÁ§∫Â¶Ç‰∏ã‰ø°ÊÅØÔºåÁÇπÂáªheapÔºåÂú®Ê±áÊÄªÂàÜÊûêÈ°µÈù¢ÁöÑÊúÄ‰∏äÊñπÂèØ‰ª•ÁúãÂà∞Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºå Á∫¢Ëâ≤ÁÆ≠Â§¥ÊâÄÊåáÁöÑÂ∞±ÊòØÂΩìÂâçÂ∑≤Áªè‰ΩøÁî®ÁöÑÂ†ÜÂÜÖÂ≠òÊòØ25M,ÔºÅÂú®ÊàëÂè™‰∏ä‰º†‰∏Ä‰∏™Áà¨Ëô´Êñá‰ª∂ÔºåËÄå‰∏îËøô‰∏™Êñá‰ª∂Ëøò‰∏çÊòØÁâπÂà´ÊâìÂ§ßÁöÑÊÉÖÂÜµ‰∏ãÔºå‰∏Ä‰∏™ÂêéÁ´ØÊúçÂä°ÊâÄÁî®ÁöÑÂÜÖÂ≠ò‰ΩøÁî®Á´üÁÑ∂ËÉΩËææÂà∞25M„ÄÇ Êàë‰ª¨ÂÜçÁî®Ëøô‰∏™ÂëΩ‰ª§ËøõÂÖ•ÂëΩ‰ª§Ë°åËØ¶ÁªÜÁúã‰∏Ä‰∏ãÔºåËøô‰∏™ÂëΩ‰ª§ËøõÂÖ•ÂêéÔºåËæìÂÖ•topÂëΩ‰ª§ÂèØ‰ª•ÊòæÁ§∫Ââç10ÁöÑÂÜÖÂ≠òÂàÜÈÖçÔºåflatÊòØÂ†ÜÊ†à‰∏≠ÂΩìÂâçÂ±ÇÁöÑinuseÂÜÖÂ≠òÂÄºÔºåcumÊòØÂ†ÜÊ†à‰∏≠Êú¨Â±ÇÁ∫ßÁöÑÁ¥ØËÆ°inuseÂÜÖÂ≠òÂÄº„ÄÇ ÂèØ‰ª•ÁúãÂà∞Ôºåbytes.makeSliceËøô‰∏™ÂÜÖÁΩÆÊñπÊ≥ïÁ´üÁÑ∂‰ΩøÁî®‰∫Ü24MÂÜÖÂ≠òÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ËÄÉËôëË∞Å‰ºöÁî®Âà∞makesliceÂë¢Ôºå ÁªßÁª≠ÂæÄ‰∏ãÁúãÔºåÂèØ‰ª•ÁúãÂà∞ReadFromËøô‰∏™ÊñπÊ≥ïÔºåÁúã‰∏ãÊ∫êÁ†ÅÔºåÂèëÁé∞ ioutil.ReadAll() Èáå‰ºöË∞ÉÁî® bytes.Buffer.ReadFrom, ËÄå ReadFrom ‰ºöËøõË°å makeSlice„ÄÇËÆ©Êàë‰ª¨ÂÜçÂõûÂ§¥Áúã‰∏Ä‰∏ãreadAllÁöÑ‰ª£Á†ÅÂÆûÁé∞Ôºö Ëøô‰∏™ÂáΩÊï∞‰∏ªË¶Å‰ΩúÁî®Â∞±ÊòØ‰ªé io.Reader ÈáåËØªÂèñÁöÑÊï∞ÊçÆÊîæÂÖ• buffer ‰∏≠ÔºåÂ¶ÇÊûú buffer Á©∫Èó¥‰∏çÂ§üÔºåÂ∞±ÊåâÁÖßÊØèÊ¨° 2x ÊâÄËØªÂèñÂÜÖÂÆπÁöÑÂ§ßÂ∞è+ MinRead ÁöÑÁÆóÊ≥ïÈÄíÂ¢ûÔºåËøôÈáå MinRead ÁöÑÂ§ßÂ∞èÊòØ 512 ‰∏™Â≠óËäÇÔºå‰πüÂ∞±ÊòØËØ¥Â¶ÇÊûúÊàë‰ª¨‰∏ÄÊ¨°ÊÄßËØªÂèñÁöÑÂÜÖÂÆπËøáÂ§ßÔºåÂ∞±‰ºöÂØºËá¥ÊâÄ‰ΩøÁî®ÁöÑÂÜÖÂ≠òÂÄçÂ¢ûÔºåÂÅáËÆæÊàë‰ª¨ÁöÑÊâÄÊúâ‰ªªÂä°Êñá‰ª∂ÊÄªÂÖ±Êúâ500M,ÈÇ£‰πàÊâÄÁî®ÁöÑÂÜÖÂ≠òÂ∞±Êúâ500M * 2 + 512BÔºåÊâÄ‰ª•Êàë‰ª¨ÂàÜÊûêÂæàÂèØËÉΩÊòØËøô‰∏™ÂéüÂõ†ÂØºËá¥ÁöÑÔºåÈÇ£ÁúãÁúãcrawlabÊ∫êÁ†Å‰∏≠ÊòØÂì™‰∏ÄÊÆµ‰ΩøÁî®ReadAllËØª‰∫ÜÊñá‰ª∂ÔºåÂÆö‰ΩçÂà∞‰∫ÜËøôÈáå ËøôÊÆµ‰ª£Á†ÅÁõ¥Êé•Â∞ÜÂÖ®ÈÉ®ÁöÑÊñá‰ª∂ÂÜÖÂÆπÔºå‰ª•‰∫åËøõÂà∂ÁöÑÂΩ¢ÂºèËØª‰∫ÜËøõÊù•ÔºåÂØºËá¥ÂÜÖÂ≠òÂÄçÂ¢ûÔºå‰ª§‰∫∫Á™íÊÅØÁöÑÊìç‰Ωú„ÄÇËá≥Ê≠§ÔºåÈóÆÈ¢òÂ∑≤ÁªèÂèëÁé∞ÔºåÈÇ£‰πàÂ¶Ç‰ΩïÂéª‰ºòÂåñÂë¢ÔºåÂÖ∂ÂÆûÂú®ËØªÂ§ßÊñá‰ª∂ÁöÑÊó∂ÂÄôÔºåÊääÊñá‰ª∂ÂÜÖÂÆπÂÖ®ÈÉ®ËØªÂà∞ÂÜÖÂ≠òÔºåÁõ¥Êé•Â∞±ÁøªËΩ¶‰∫ÜÔºåÊ≠£Á°ÆÊòØÂ§ÑÁêÜÊñπÊ≥ïÊúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØÊµÅÂºèÂ§ÑÁêÜ ÔºåÂ¶Ç‰ª£Á†ÅÊâÄÁ§∫ Á¨¨‰∫åÁßçÊñπÊ°àÂ∞±ÊòØÂàÜÁâáÂ§ÑÁêÜÔºåÂΩìËØªÂèñÁöÑÊòØ‰∫åËøõÂà∂Êñá‰ª∂ÔºåÊ≤°ÊúâÊç¢Ë°åÁ¨¶ÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®ËøôÁßçÊñπÊ°àÊØîËæÉÂêàÈÄÇ„ÄÇ Êàë‰ª¨ËøôÈáåÈááÁî®ÁöÑÁ¨¨‰∫åÁßçÊñπÂºèÊù•‰ºòÂåñÔºå‰ºòÂåñÂêéÂÜçÊù•Áúã‰∏ãÂÜÖÂ≠òÂç†Áî®ÊÉÖÂÜµ Êàë‰ª¨ÈááÊ†∑Á®ãÂ∫èËøêË°å30sÁöÑÂπ≥ÂùáÂÜÖÂ≠òÔºåÂπ∂‰∏îÂú®Ê≠§ÊúüÈó¥ËÆøÈóÆ‰∏ä‰º†Êñá‰ª∂ÁöÑÊé•Âè£ÂêéÔºåÁúãÂà∞ÂÜÖÂ≠òÂç†Áî®Â∑≤ÁªèÈôçÂà∞Ê≠£Â∏∏ÁöÑÊ∞¥Âπ≥‰∫Ü„ÄÇ v ÂàöÂàöÊàëÁî®‰∏Ä‰∏™ÂÆûÈôÖÊ°à‰æã‰ªãÁªç‰∫ÜÂ¶Ç‰ΩïÂéª‰∏ÄÊ≠•‰∏ÄÊ≠•ÁöÑÂàÜÊûêÂèä‰ºòÂåñgoÁ®ãÂ∫èÁöÑÂÜÖÂ≠òÈóÆÈ¢òÔºåÂ§ßÂÆ∂ÂèØ‰ª•Âú®Âπ≥Êó∂ÂºÄÂèë‰∏≠Â§öÂéªÊé¢Á¥¢ÔºåÂ§ö‰ΩøÁî®„ÄÇ Êé•‰∏ãÊù•‰ªãÁªç‰∏Ä‰∫õgo ÂºÄÂèë‰∏≠ÁöÑÂ∞èÊäÄÂ∑ßÔºå‰ªéÁªÜËäÇ‰∏äÊèêÈ´ò‰Ω†ÁöÑgolangÂ∫îÁî®Á®ãÂ∫èÁöÑÊÄßËÉΩ„ÄÇ ‰ºóÊâÄÂë®Áü•Json ‰Ωú‰∏∫‰∏ÄÁßçÈáçË¶ÅÁöÑÊï∞ÊçÆÊ†ºÂºèÔºåÂ§ßÂÆ∂ÂºÄÂèëËÄÖÁªèÂ∏∏Áî®Âà∞„ÄÇGo ËØ≠Ë®ÄÈáåÈù¢ÂéüÁîüÊîØÊåÅ‰∫ÜjsonÁöÑÂ∫èÂàóÂåñ‰ª•ÂèäÂèçÂ∫èÂàóÂåñÔºåÂÜÖÈÉ®‰ΩøÁî®ÂèçÂ∞ÑÊú∫Âà∂ÂÆûÁé∞ÔºåÊàë‰ª¨ÈÉΩÁü•ÈÅìÔºåÂèçÂ∞ÑÁöÑÊÄßËÉΩÊúâÁÇπÂ∑ÆÔºåÂú®È´òÂ∫¶‰æùËµñ json Ëß£ÊûêÁöÑÊé•Âè£ÈáåÔºåËøôÂæÄÂæÄ‰ºöÊàê‰∏∫ÊÄßËÉΩÁì∂È¢àÔºåÂ•ΩÂú®Â∑≤ÊúâÂæàÂ§öÁ¨¨‰∏âÊñπÂ∫ìÂ∏ÆÊàë‰ª¨Ëß£ÂÜ≥‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºå‰ΩÜÊòØËøô‰πàÂ§öÂ∫ìÔºåÂà∞Â∫ïË¶ÅÊÄé‰πàÈÄâÊã©Âë¢Ôºå‰∏ãÈù¢Â∞±ÁªôÂ§ßÂÆ∂Êù•‰∏Ä‰∏ÄÂàÜÊûê‰∏Ä‰∏ãÔºåËøôÈáå‰ªãÁªç4‰∏™jsonÂ∫èÂàóÂåñÂèçÂ∫èÂàóÂåñÁöÑÂ∫ì, ÁúãÂÆåËøô‰∫õ‰Ω†ÂèØËÉΩ‰∏çÁü•ÈÅìÂà∞Â∫ïËØ•Áî®Âì™‰∏Ä‰∏™ÔºåËÆ©Êàë‰ª¨Êù•Áúã‰∏ãbenchmark. ‚Äã ‚Ä¢easyjson Êó†ËÆ∫ÊòØÂ∫èÂàóÂåñËøòÊòØÂèçÂ∫èÂàóÂåñÈÉΩÊòØÊúÄ‰ºòÁöÑÔºåÂ∫èÂàóÂåñÊèêÂçá‰∫Ü1ÂÄçÔºåÂèçÂ∫èÂàóÂåñÊèêÂçá‰∫Ü3ÂÄç ‚Äã ‚Ä¢jsoniter ÊÄßËÉΩ‰πüÂæàÂ•ΩÔºåÊé•Ëøë‰∫éeasyjsonÔºåÂÖ≥ÈîÆÊòØÊ≤°ÊúâÈ¢ÑÁºñËØëËøáÁ®ãÔºå100%ÂÖºÂÆπÂéüÁîüÂ∫ì ‚Äã ‚Ä¢ffjson ÁöÑÂ∫èÂàóÂåñÊèêÂçáÂπ∂‰∏çÊòéÊòæÔºåÂèçÂ∫èÂàóÂåñÊèêÂçá‰∫Ü1ÂÄç ÊâÄ‰ª•ÁªºÂêàËÄÉËôëÔºåÂª∫ËÆÆÂ§ßÂÆ∂‰ΩøÁî® jsoniterÔºåÂ¶ÇÊûúËøΩÊ±ÇÊûÅËá¥ÁöÑÊÄßËÉΩÔºåËÄÉËôë easyjson Â≠óÁ¨¶‰∏≤ÊãºÊé•Âú®ÂºÄÂèë‰∏≠ËÇØÂÆöÊòØÁªèÂ∏∏Áî®Âà∞ÁöÑÔºåÂΩì‰Ω†ÁöÑÂ∫îÁî®‰∏≠ÁöÑÊüê‰∏ÄÈÉ®ÂàÜÂ§ßÈáèÁî®Âà∞Â≠óÁ¨¶‰∏≤ÊãºÊé•Ôºå‰Ω†ÊúÄÂ•ΩÁïôÊÑè‰∏Ä‰∏ã‰∏ãÈù¢ÁöÑÂÜÖÂÆπ„ÄÇÊàë‰ª¨Âàó‰∏æ4‰∏≠Â≠óÁ¨¶‰∏≤ÊãºÊé•ÁöÑÊñπÂºèÔºåÁúãÁúã‰Ω†ÁªèÂ∏∏Áî®ÁöÑÊòØÂì™‰∏™Ôºü Á¨¨‰∏ÄÁßç + Âè∑ËøêÁÆóÁ¨¶ÔºåÁ¨¨‰∫åÁßçÊòØgolangÁâπÊúâÁöÑ‰∏ÄÁßçÊñπÂºèÔºåÁ¨¨‰∏â‰∏≠ÊòØ strings.builder, ÊúÄÂêé‰∏ÄÁßçÊòØstrings.buffer„ÄÇ Áúã‰∏ãbenchmark‰Ω†Â∞±‰ºöÂÅöÂá∫‰Ω†ÊúÄÁªàÁöÑÈÄâÊã©„ÄÇÊÄßËÉΩÊúÄÂ•ΩÁöÑÊòØstrings.builder,ËÄåsprintfÊÄßËÉΩÊúÄÂ∑ÆÔºå+ Âè∑ËøêÁÆóÁ¨¶‰πüÊ≤°Â•ΩÂà∞Âì™ÈáåÂéª„ÄÇ ‰ª•‰∏äÂ∞±ÊòØÊàë‰ªäÂ§©ÂàÜ‰∫´ÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπÔºåÂ∏åÊúõËÉΩÂ∏ÆÂä©Âà∞Â§ßÂÆ∂Ôºå‰∏ãÈù¢ÊòØÊàëÁöÑËÅîÁ≥ªÊñπÂºèÔºåÊúâÈóÆÈ¢òÁöÑÂèØ‰ª•Á∫ø‰∏ãÁªßÁª≠‰∫§ÊµÅ„ÄÇË∞¢Ë∞¢ÔºÅ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>ÁîüÊ¥ª</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golang cron‰ΩøÁî®]]></title>
    <url>%2F2019%2F10%2F29%2Fgolang-cron%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[GoÂÆöÊó∂Âô®cronÁöÑ‰ΩøÁî®ËØ¶Ëß£ Êõ¥Êñ∞Êó∂Èó¥Ôºö2018Âπ¥01Êúà11Êó• 10:51:02 ‰ΩúËÄÖÔºöÈ™ëÂ§¥Áå™ÈÄõË°ó ÊàëË¶ÅËØÑËÆ∫ Êú¨ÁØáÊñáÁ´†‰∏ªË¶Å‰ªãÁªç‰∫ÜGoÂÆöÊó∂Âô®cronÁöÑ‰ΩøÁî®ËØ¶Ëß£ÔºåÂ∞èÁºñËßâÂæóÊå∫‰∏çÈîôÁöÑÔºåÁé∞Âú®ÂàÜ‰∫´ÁªôÂ§ßÂÆ∂Ôºå‰πüÁªôÂ§ßÂÆ∂ÂÅö‰∏™ÂèÇËÄÉ„ÄÇ‰∏ÄËµ∑Ë∑üÈöèÂ∞èÁºñËøáÊù•ÁúãÁúãÂêß cronÊòØ‰ªÄ‰πà cronÁöÑÊÑèÊÄùÂ∞±ÊòØÔºöËÆ°Âàí‰ªªÂä°ÔºåËØ¥ÁôΩ‰∫ÜÂ∞±ÊòØÂÆöÊó∂‰ªªÂä°„ÄÇÊàëÂíåÁ≥ªÁªüÁ∫¶‰∏™Êó∂Èó¥Ôºå‰Ω†Âú®Âá†ÁÇπÂá†ÂàÜÂá†ÁßíÊàñËÄÖÊØèÈöîÂá†ÂàÜÈíüË∑ë‰∏Ä‰∏™‰ªªÂä°(job)ÔºåÂ∞±ÈÇ£‰πàÁÆÄÂçï„ÄÇ cronË°®ËææÂºè cronË°®ËææÂºèÊòØ‰∏Ä‰∏™Â•Ω‰∏úË•øÔºåËøô‰∏™‰∏úË•ø‰∏ç‰ªÖJavaÁöÑquartZËÉΩÁî®Âà∞ÔºåGoËØ≠Ë®Ä‰∏≠‰πüÂèØ‰ª•Áî®Âà∞„ÄÇÊàëÊ≤°ÊúâÁî®ËøáLinuxÁöÑcronÔºå‰ΩÜÁΩë‰∏äËØ¥Linux‰πüÊòØÂèØ‰ª•Áî®crontab -e ÂëΩ‰ª§Êù•ÈÖçÁΩÆÂÆöÊó∂‰ªªÂä°„ÄÇGoËØ≠Ë®ÄÂíåJava‰∏≠ÈÉΩÊòØÂèØ‰ª•Á≤æÁ°ÆÂà∞ÁßíÁöÑÔºå‰ΩÜÊòØLinux‰∏≠‰∏çË°å„ÄÇ cronË°®ËææÂºè‰ª£Ë°®‰∏Ä‰∏™Êó∂Èó¥ÁöÑÈõÜÂêàÔºå‰ΩøÁî®6‰∏™Á©∫Ê†ºÂàÜÈöîÁöÑÂ≠óÊÆµË°®Á§∫Ôºö Â≠óÊÆµÂêç ÊòØÂê¶ÂøÖÈ°ª ÂÖÅËÆ∏ÁöÑÂÄº ÂÖÅËÆ∏ÁöÑÁâπÂÆöÂ≠óÁ¨¶ Áßí(Seconds) ÊòØ 0-59 * / , - ÂàÜ(Minute) ÊòØ 0-59 * / , - Êó∂(Hours) ÊòØ 0-23 * / , - Êó•(Day of month) ÊòØ 1-31 * / , - ? Êúà(Month) ÊòØ 1-12 Êàñ JAN-DEC * / , - ÊòüÊúü(Day of week) Âê¶ 0-6 Êàñ SUM-SAT * / , - ? 1.Êúà(Month)ÂíåÊòüÊúü(Day of week)Â≠óÊÆµÁöÑÂÄº‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºåÂ¶ÇÔºöSUN„ÄÅSun Âíå sun ÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ 2.ÊòüÊúü(Day of week)Â≠óÊÆµÂ¶ÇÊûúÊ≤°Êèê‰æõÔºåÁõ∏ÂΩì‰∫éÊòØ * ? 1`# ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ min (0 - 59)``# ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ hour (0 - 23)``# ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ day of month (1 - 31)``# ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ month (1 - 12)``# ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ day of week (0 - 6) (0 to 6 are Sunday to``# ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ Saturday, or use names; 7 is also Sunday)``# ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ``# ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ``# * * * * * command to execute` cronÁâπÂÆöÂ≠óÁ¨¶ËØ¥Êòé 1ÔºâÊòüÂè∑(*) Ë°®Á§∫ cron Ë°®ËææÂºèËÉΩÂåπÈÖçËØ•Â≠óÊÆµÁöÑÊâÄÊúâÂÄº„ÄÇÂ¶ÇÂú®Á¨¨5‰∏™Â≠óÊÆµ‰ΩøÁî®ÊòüÂè∑(month)ÔºåË°®Á§∫ÊØè‰∏™Êúà 2ÔºâÊñúÁ∫ø(/) Ë°®Á§∫Â¢ûÈïøÈó¥ÈöîÔºåÂ¶ÇÁ¨¨1‰∏™Â≠óÊÆµ(minutes) ÂÄºÊòØ 3-59/15ÔºåË°®Á§∫ÊØèÂ∞èÊó∂ÁöÑÁ¨¨3ÂàÜÈíüÂºÄÂßãÊâßË°å‰∏ÄÊ¨°Ôºå‰πãÂêéÊØèÈöî 15 ÂàÜÈíüÊâßË°å‰∏ÄÊ¨°ÔºàÂç≥ 3„ÄÅ18„ÄÅ33„ÄÅ48 Ëøô‰∫õÊó∂Èó¥ÁÇπÊâßË°åÔºâÔºåËøôÈáå‰πüÂèØ‰ª•Ë°®Á§∫‰∏∫Ôºö3/15 3ÔºâÈÄóÂè∑(,) Áî®‰∫éÊûö‰∏æÂÄºÔºåÂ¶ÇÁ¨¨6‰∏™Â≠óÊÆµÂÄºÊòØ MON,WED,FRIÔºåË°®Á§∫ ÊòüÊúü‰∏Ä„ÄÅ‰∏â„ÄÅ‰∫î ÊâßË°å 4ÔºâËøûÂ≠óÂè∑(-) Ë°®Á§∫‰∏Ä‰∏™ËåÉÂõ¥ÔºåÂ¶ÇÁ¨¨3‰∏™Â≠óÊÆµÁöÑÂÄº‰∏∫ 9-17 Ë°®Á§∫ 9am Âà∞ 5pm Áõ¥Êé•ÊØè‰∏™Â∞èÊó∂ÔºàÂåÖÊã¨9Âíå17Ôºâ 5ÔºâÈóÆÂè∑(?) Âè™Áî®‰∫é Êó•(Day of month) Âíå ÊòüÊúü(Day of week)ÔºåË°®Á§∫‰∏çÊåáÂÆöÂÄºÔºåÂèØ‰ª•Áî®‰∫é‰ª£Êõø * 6ÔºâLÔºåWÔºå# Go‰∏≠Ê≤°ÊúâLÔºåWÔºå#ÁöÑÁî®Ê≥ïÔºå‰∏ãÊñá‰ΩúËß£Èáä„ÄÇ cron‰∏æ‰æãËØ¥Êòé ÊØèÈöî5ÁßíÊâßË°å‰∏ÄÊ¨°Ôºö/5 * ? ÊØèÈöî1ÂàÜÈíüÊâßË°å‰∏ÄÊ¨°Ôºö0 /1 ? ÊØèÂ§©23ÁÇπÊâßË°å‰∏ÄÊ¨°Ôºö0 0 23 ? ÊØèÂ§©ÂáåÊô®1ÁÇπÊâßË°å‰∏ÄÊ¨°Ôºö0 0 1 ? ÊØèÊúà1Âè∑ÂáåÊô®1ÁÇπÊâßË°å‰∏ÄÊ¨°Ôºö0 0 1 1 * ? Âú®26ÂàÜ„ÄÅ29ÂàÜ„ÄÅ33ÂàÜÊâßË°å‰∏ÄÊ¨°Ôºö0 26,29,33 * ? ÊØèÂ§©ÁöÑ0ÁÇπ„ÄÅ13ÁÇπ„ÄÅ18ÁÇπ„ÄÅ21ÁÇπÈÉΩÊâßË°å‰∏ÄÊ¨°Ôºö0 0 0,13,18,21 ? ‰∏ãËΩΩÂÆâË£Ö ÊéßÂà∂Âè∞ËæìÂÖ• go get github.com/robfig/cronÂéª‰∏ãËΩΩÂÆöÊó∂‰ªªÂä°ÁöÑGoÂåÖÔºåÂâçÊèêÊòØ‰Ω†ÁöÑ$GOPATHÂ∑≤ÁªèÈÖçÁΩÆÂ•Ω Ê∫êÁ†ÅËß£Êûê Êñá‰ª∂ÁõÆÂΩïËÆ≤Ëß£ ? 1`constantdelay.go #‰∏Ä‰∏™ÊúÄÁÆÄÂçïÁöÑÁßíÁ∫ßÂà´ÂÆöÊó∂Á≥ªÁªü„ÄÇ‰∏écronÊó†ÂÖ≥``constantdelay_test.go #ÊµãËØï``cron.go #CronÁ≥ªÁªü„ÄÇÁÆ°ÁêÜ‰∏ÄÁ≥ªÂàóÁöÑcronÂÆöÊó∂‰ªªÂä°ÔºàSchedule JobÔºâ``cron_test.go #ÊµãËØï``doc.go #ËØ¥ÊòéÊñáÊ°£``LICENSE #ÊéàÊùÉ‰π¶ ``parser.go #Ëß£ÊûêÂô®ÔºåËß£ÊûêcronÊ†ºÂºèÂ≠óÁ¨¶‰∏≤Âüé‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÂÆöÊó∂Âô®ÔºàScheduleÔºâ``parser_test.go #ÊµãËØï``README.md #README``spec.go #Âçï‰∏™ÂÆöÊó∂Âô®ÔºàScheduleÔºâÁªìÊûÑ‰Ωì„ÄÇÂ¶Ç‰ΩïËÆ°ÁÆóËá™Â∑±ÁöÑ‰∏ã‰∏ÄÊ¨°Ëß¶ÂèëÊó∂Èó¥``spec_test.go #ÊµãËØï` cron.go ÁªìÊûÑ‰ΩìÔºö ? 1`// Cron keeps track of any number of entries, invoking the associated func as``// specified by the schedule. It may be started, stopped, and the entries may``// be inspected while running. ``// Cron‰øùÊåÅ‰ªªÊÑèÊï∞ÈáèÁöÑÊù°ÁõÆÁöÑËΩ®ÈÅìÔºåË∞ÉÁî®Áõ∏ÂÖ≥ÁöÑfuncÊó∂Èó¥Ë°®ÊåáÂÆö„ÄÇÂÆÉÂèØ‰ª•Ë¢´ÂêØÂä®ÔºåÂÅúÊ≠¢ÂíåÊù°ÁõÆÔºåÂèØËøêË°åÁöÑÂêåÊó∂ËøõË°åÊ£ÄÊü•„ÄÇ``type Cron struct &#123;`` ``entries []*Entry // ‰ªªÂä°`` ``stop chan struct&#123;&#125; // Âè´ÂÅúÊ≠¢ÁöÑÈÄîÂæÑ`` ``add chan *Entry // Ê∑ªÂä†Êñ∞‰ªªÂä°ÁöÑÊñπÂºè`` ``snapshot chan []*Entry // ËØ∑Ê±ÇËé∑Âèñ‰ªªÂä°Âø´ÁÖßÁöÑÊñπÂºè`` ``running bool // ÊòØÂê¶Âú®ËøêË°å`` ``ErrorLog *log.Logger // Âá∫ÈîôÊó•Âøó(Êñ∞Â¢ûÂ±ûÊÄß)`` ``location *time.Location // ÊâÄÂú®Âú∞Âå∫(Êñ∞Â¢ûÂ±ûÊÄß) ``&#125;` ? 1`// Entry consists of a schedule and the func to execute on that schedule.``// ÂÖ•Âè£ÂåÖÊã¨Êó∂Èó¥Ë°®ÂíåÂèØÂú®Êó∂Èó¥Ë°®‰∏äÊâßË°åÁöÑfunc``type Entry struct &#123;`` ``// ËÆ°Êó∂Âô®`` ``Schedule Schedule`` ``// ‰∏ãÊ¨°ÊâßË°åÊó∂Èó¥`` ``Next time.Time`` ``// ‰∏äÊ¨°ÊâßË°åÊó∂Èó¥`` ``Prev time.Time`` ``// ‰ªªÂä°`` ``Job Job``&#125;` ÂÖ≥ÈîÆÊñπÊ≥ïÔºö ? 1`// ÂºÄÂßã‰ªªÂä°``// Start the cron scheduler in its own go-routine, or no-op if already started.``func (c *Cron) Start() &#123;`` ``if c.running &#123;`` ``return`` ``&#125;`` ``c.running = true`` ``go c.run()``&#125;``// ÁªìÊùü‰ªªÂä°``// Stop stops the cron scheduler if it is running; otherwise it does nothing.``func (c *Cron) Stop() &#123;`` ``if !c.running &#123;`` ``return`` ``&#125;`` ``c.stop &lt;- struct&#123;&#125;&#123;&#125;`` ``c.running = false``&#125;` `// ÊâßË°åÂÆöÊó∂‰ªªÂä°``// Run the scheduler.. this is private just due to the need to synchronize``// access to the &apos;running&apos; state variable.``func (c *Cron) run() &#123;`` ``// Figure out the next activation times for each entry.`` ``now := time.Now().In(c.location)`` ``for _, entry := range c.entries &#123;`` ``entry.Next = entry.Schedule.Next(now)`` ``&#125;`` ``// Êó†ÈôêÂæ™ÁéØ`` ``for &#123;`` ``//ÈÄöËøáÂØπ‰∏ã‰∏Ä‰∏™ÊâßË°åÊó∂Èó¥ËøõË°åÊéíÂ∫èÔºåÂà§Êñ≠ÈÇ£‰∫õ‰ªªÂä°ÊòØ‰∏ã‰∏ÄÊ¨°Ë¢´ÊâßË°åÁöÑÔºåÈò≤Âú®ÈòüÂàóÁöÑÂâçÈù¢.sortÊòØÁî®Êù•ÂÅöÊéíÂ∫èÁöÑ`` ``sort.Sort(byTime(c.entries))` ` ``var effective time.Time`` ``if len(c.entries) == 0 || c.entries[0].Next.IsZero() &#123;`` ``// If there are no entries yet, just sleep - it still handles new entries`` ``// and stop requests.`` ``effective = now.AddDate(10, 0, 0)`` ``&#125; else &#123;`` ``effective = c.entries[0].Next`` ``&#125;` ` ``timer := time.NewTimer(effective.Sub(now))`` ``select &#123;`` ``case now = &lt;-timer.C: // ÊâßË°åÂΩìÂâç‰ªªÂä°`` ``now = now.In(c.location)`` ``// Run every entry whose next time was this effective time.`` ``for _, e := range c.entries &#123;`` ``if e.Next != effective &#123;`` ``break`` ``&#125;`` ``go c.runWithRecovery(e.Job)`` ``e.Prev = e.Next`` ``e.Next = e.Schedule.Next(now)`` ``&#125;`` ``continue` ` ``case newEntry := &lt;-c.add: // Ê∑ªÂä†Êñ∞ÁöÑ‰ªªÂä°`` ``c.entries = append(c.entries, newEntry)`` ``newEntry.Next = newEntry.Schedule.Next(time.Now().In(c.location))` ` ``case &lt;-c.snapshot: // Ëé∑ÂèñÂø´ÁÖß`` ``c.snapshot &lt;- c.entrySnapshot()` ` ``case &lt;-c.stop: // ÂÅúÊ≠¢‰ªªÂä°`` ``timer.Stop()`` ``return`` ``&#125;` ` ``// &apos;now&apos; should be updated after newEntry and snapshot cases.`` ``now = time.Now().In(c.location)`` ``timer.Stop()`` ``&#125;``&#125;` spec.go ÁªìÊûÑ‰ΩìÂèäÂÖ≥ÈîÆÊñπÊ≥ïÔºö ? 1`// SpecSchedule specifies a duty cycle (to the second granularity), based on a``// traditional crontab specification. It is computed initially and stored as bit sets.``type SpecSchedule struct &#123;`` ``// Ë°®ËææÂºè‰∏≠ÈîÅË°®ÊòéÁöÑÔºåÁßíÔºåÂàÜÔºåÊó∂ÔºåÊó•ÔºåÊúàÔºåÂë®ÔºåÊØè‰∏™ÈÉΩÊòØuint64`` ``// Dom:Day of Month,Dow:Day of week`` ``Second, Minute, Hour, Dom, Month, Dow uint64``&#125;` `// bounds provides a range of acceptable values (plus a map of name to value).``// ÂÆö‰πâ‰∫ÜË°®ËææÂºèÁöÑÁªìÊûÑ‰Ωì``type bounds struct &#123;`` ``min, max uint`` ``names map[string]uint``&#125;` `// The bounds for each field.``// ËøôÊ†∑Â∞±ËÉΩÁúãÂá∫ÂêÑ‰∏™Ë°®ËææÂºèÁöÑËåÉÂõ¥``var (`` ``seconds = bounds&#123;0, 59, nil&#125;`` ``minutes = bounds&#123;0, 59, nil&#125;`` ``hours = bounds&#123;0, 23, nil&#125;`` ``dom = bounds&#123;1, 31, nil&#125;`` ``months = bounds&#123;1, 12, map[string]uint&#123;`` ``&quot;jan&quot;: 1,`` ``&quot;feb&quot;: 2,`` ``&quot;mar&quot;: 3,`` ``&quot;apr&quot;: 4,`` ``&quot;may&quot;: 5,`` ``&quot;jun&quot;: 6,`` ``&quot;jul&quot;: 7,`` ``&quot;aug&quot;: 8,`` ``&quot;sep&quot;: 9,`` ``&quot;oct&quot;: 10,`` ``&quot;nov&quot;: 11,`` ``&quot;dec&quot;: 12,`` ``&#125;&#125;`` ``dow = bounds&#123;0, 6, map[string]uint&#123;`` ``&quot;sun&quot;: 0,`` ``&quot;mon&quot;: 1,`` ``&quot;tue&quot;: 2,`` ``&quot;wed&quot;: 3,`` ``&quot;thu&quot;: 4,`` ``&quot;fri&quot;: 5,`` ``&quot;sat&quot;: 6,`` ``&#125;&#125;``)` `const (`` ``// Set the top bit if a star was included in the expression.`` ``starBit = 1 &lt;&lt; 63``)` Áúã‰∫Ü‰∏äÈù¢ÁöÑ‰∏úË•øËÇØÂÆöÊúâ‰∫∫ÁñëÊÉë‰∏∫‰ªÄ‰πàÁßíÂàÜÊó∂Ëøô‰∫õÈÉΩÊòØÂÆö‰πâ‰∫Üunit64,‰ª•ÂèäÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Â∏∏ÈáèstarBit = 1 &lt;&lt; 63ËøôÁßçÂÜôÊ≥ïÔºåËøôÊòØÈÄªËæëËøêÁÆóÁ¨¶„ÄÇË°®Á§∫‰∫åËøõÂà∂1ÂêëÂ∑¶ÁßªÂä®63‰Ωç„ÄÇÂéüÂõ†Â¶Ç‰∏ãÔºö cronË°®ËææÂºèÊòØÁî®Êù•Ë°®Á§∫‰∏ÄÁ≥ªÂàóÊó∂Èó¥ÁöÑÔºåËÄåÊó∂Èó¥ÊòØÊó†Ê≥ïÈÄÉËÑ±Ëá™Â∑±ÁöÑÂå∫Èó¥ÁöÑ Ôºå ÂàÜÔºåÁßí 0 - 59 Ôºå Êó∂ 0 - 23 Ôºå Â§©/Êúà 0 - 31 Ôºå Â§©/Âë® 0 - 6 Ôºå Êúà0 - 11 „ÄÇ Ëøô‰∫õÊú¨Ë¥®‰∏äÈÉΩÊòØ‰∏Ä‰∏™ÁÇπÈõÜÂêàÔºåÊàñËÄÖËØ¥ÊòØ‰∏Ä‰∏™Êï¥Êï∞Âå∫Èó¥„ÄÇ ÈÇ£‰πàÂØπ‰∫é‰ªªÊÑèÁöÑÊï¥Êï∞Âå∫Èó¥ Ôºå ÂèØ‰ª•ÊèèËø∞cronÁöÑÂ¶Ç‰∏ãÈÉ®ÂàÜËßÑÂàô„ÄÇ * | ? ‰ªªÊÑè Ôºå ÂØπÂ∫îÂå∫Èó¥‰∏äÁöÑÊâÄÊúâÁÇπ„ÄÇ Ôºà È¢ùÂ§ñÊ≥®ÊÑè Êó•/Âë® Ôºå Êó• / Êúà ÁöÑÁõ∏‰∫íÂπ≤Êâ∞„ÄÇÔºâ Á∫ØÊï∞Â≠ó Ôºå ÂØπÂ∫î‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÁÇπ„ÄÇ / ÂàÜÂâ≤ÁöÑ‰∏§‰∏™Êï∞Â≠ó a , bÔºå Âå∫Èó¥‰∏äÁ¨¶Âêà a + n * b ÁöÑÊâÄÊúâÁÇπ Ôºà n &gt;= 0 )„ÄÇ - ÂàÜÂâ≤ÁöÑ‰∏§‰∏™Êï∞Â≠óÔºå ÂØπÂ∫îËøô‰∏§‰∏™Êï∞Â≠óÂÜ≥ÂÆöÁöÑÂå∫Èó¥ÂÜÖÁöÑÊâÄÊúâÁÇπ„ÄÇ L | W ÈúÄË¶ÅÂØπ‰∫éÁâπÂÆöÁöÑÊó∂Èó¥ÁâπÊÆäÂà§Êñ≠Ôºå Êó†Ê≥ïÈÄöÁî®ÁöÑÂØπÂ∫îÂà∞Âå∫Èó¥‰∏äÁöÑÁÇπ„ÄÇ Ëá≥Ê≠§Ôºå robfig/cron‰∏∫‰ªÄ‰πà‰∏çÊîØÊåÅ L | WÁöÑÂéüÂõ†Â∑≤ÁªèÊòé‰∫Ü‰∫Ü„ÄÇÂéªÈô§Ëøô‰∏§Êù°ËßÑÂàôÂêéÔºå ÂÖ∂‰ΩôÁöÑËßÑÂàôÂÖ∂ÂÆûÂÆåÂÖ®ÂèØ‰ª•‰ΩøÁî®ÁÇπÁöÑÁ©∑‰∏æÊù•ÈÄöÁî®Ë°®Á§∫„ÄÇ ËÄÉËôëÂà∞ÊúÄÂ§ßÁöÑÂå∫Èó¥‰πü‰∏çËøáÊòØ60‰∏™ÁÇπÔºåÈÇ£‰πà‰ΩøÁî®‰∏Ä‰∏™uint64ÁöÑÊï¥Êï∞ÁöÑÊØè‰∏Ä‰ΩçÊù•Ë°®Á§∫‰∏Ä‰∏™ÁÇπ‰æøÂæàÂêàÈÄÇ‰∫Ü„ÄÇÊâÄ‰ª•ÂÆö‰πâunit64‰∏ç‰∏∫Ëøá ‰∏ãÈù¢ÊòØgo‰∏≠cronË°®ËææÂºèÁöÑÊñπÊ≥ïÔºö ? 1`/* `` ``------------------------------------------------------------`` ``Á¨¨64‰ΩçÊ†áËÆ∞‰ªªÊÑè Ôºå Áî®‰∫é Êó•/Âë® Ôºå Êó• / Êúà ÁöÑÁõ∏‰∫íÂπ≤Êâ∞„ÄÇ`` ``63 - 0 ‰∏∫ Ë°®Á§∫Âå∫Èó¥ [63 , 0] ÁöÑ ÊØè‰∏Ä‰∏™ÁÇπ„ÄÇ`` ``------------------------------------------------------------` ` ``ÂÅáËÆæÂå∫Èó¥ÊòØ 0 - 63 Ôºå ÂàôÊúâÂ¶Ç‰∏ãÁöÑ‰æãÂ≠ê Ôºö` ` ``ÊØîÂ¶Ç 0/3 ÁöÑË°®Á§∫Â¶Ç‰∏ã Ôºö (Ë°®Á§∫ÊØèÈöî‰∏§‰Ωç‰∏∫1)`` ``* / ? `` ``+---+--------------------------------------------------------+`` ``| 0 | 1 0 0 1 0 0 1 ~~ ~~ 1 0 0 1 0 0 1 |`` ``+---+--------------------------------------------------------+ `` ``63 ~ ~ ~~ 0` ` ``ÊØîÂ¶Ç 2-5 ÁöÑË°®Á§∫Â¶Ç‰∏ã Ôºö (Ë°®Á§∫‰ªéÂè≥ÂæÄÂ∑¶2-5‰Ωç‰∏äÈÉΩÊòØ1)`` ``* / ? `` ``+---+--------------------------------------------------------+`` ``| 0 | 0 0 0 0 ~ ~ ~~ ~ 0 0 0 1 1 1 1 0 0 |`` ``+---+--------------------------------------------------------+ `` ``63 ~ ~ ~~ 0` ` ``ÊØîÂ¶Ç * ÁöÑË°®Á§∫Â¶Ç‰∏ã Ôºö (Ë°®Á§∫ÊâÄÊúâ‰ΩçÁΩÆ‰∏äÈÉΩ‰∏∫1)`` ``* / ? `` ``+---+--------------------------------------------------------+`` ``| 1 | 1 1 1 1 1 ~ ~ ~ 1 1 1 1 1 1 1 1 1 |`` ``+---+--------------------------------------------------------+ `` ``63 ~ ~ ~~ 0 ``*/` parser.go Â∞ÜÂ≠óÁ¨¶‰∏≤Ëß£Êûê‰∏∫SpecScheduleÁöÑÁ±ª„ÄÇ ? 1`package cron` `import (`` ``&quot;fmt&quot;`` ``&quot;math&quot;`` ``&quot;strconv&quot;`` ``&quot;strings&quot;`` ``&quot;time&quot;``)` `// Configuration options for creating a parser. Most options specify which``// fields should be included, while others enable features. If a field is not``// included the parser will assume a default value. These options do not change``// the order fields are parse in.``type ParseOption int` `const (`` ``Second ParseOption = 1 &lt;&lt; iota // Seconds field, default 0`` ``Minute // Minutes field, default 0`` ``Hour // Hours field, default 0`` ``Dom // Day of month field, default *`` ``Month // Month field, default *`` ``Dow // Day of week field, default *`` ``DowOptional // Optional day of week field, default *`` ``Descriptor // Allow descriptors such as @monthly, @weekly, etc.``)` `var places = []ParseOption&#123;`` ``Second,`` ``Minute,`` ``Hour,`` ``Dom,`` ``Month,`` ``Dow,``&#125;` `var defaults = []string&#123;`` ``&quot;0&quot;,`` ``&quot;0&quot;,`` ``&quot;0&quot;,`` ``&quot;*&quot;,`` ``&quot;*&quot;,`` ``&quot;*&quot;,``&#125;` `// A custom Parser that can be configured.``type Parser struct &#123;`` ``options ParseOption`` ``optionals int``&#125;` `// Creates a custom Parser with custom options.``//``// // Standard parser without descriptors``// specParser := NewParser(Minute | Hour | Dom | Month | Dow)``// sched, err := specParser.Parse(&quot;0 0 15 */3 *&quot;)``//``// // Same as above, just excludes time fields``// subsParser := NewParser(Dom | Month | Dow)``// sched, err := specParser.Parse(&quot;15 */3 *&quot;)``//``// // Same as above, just makes Dow optional``// subsParser := NewParser(Dom | Month | DowOptional)``// sched, err := specParser.Parse(&quot;15 */3&quot;)``//``func NewParser(options ParseOption) Parser &#123;`` ``optionals := 0`` ``if options&amp;DowOptional &gt; 0 &#123;`` ``options |= Dow`` ``optionals++`` ``&#125;`` ``return Parser&#123;options, optionals&#125;``&#125;` `// Parse returns a new crontab schedule representing the given spec.``// It returns a descriptive error if the spec is not valid.``// It accepts crontab specs and features configured by NewParser.``// Â∞ÜÂ≠óÁ¨¶‰∏≤Ëß£ÊûêÊàê‰∏∫SpecSchedule „ÄÇ SpecScheduleÁ¨¶ÂêàScheduleÊé•Âè£` `func (p Parser) Parse(spec string) (Schedule, error) &#123;`` // Áõ¥Êé•Â§ÑÁêÜÁâπÊÆäÁöÑÁâπÊÆäÁöÑÂ≠óÁ¨¶‰∏≤`` ``if spec[0] == &apos;@&apos; &amp;&amp; p.options&amp;Descriptor &gt; 0 &#123;`` ``return parseDescriptor(spec)`` ``&#125;` ` ``// Figure out how many fields we need`` ``max := 0`` ``for _, place := range places &#123;`` ``if p.options&amp;place &gt; 0 &#123;`` ``max++`` ``&#125;`` ``&#125;`` ``min := max - p.optionals` ` ``// cronÂà©Áî®Á©∫ÁôΩÊãÜËß£Âá∫Áã¨Á´ãÁöÑitems„ÄÇ`` ``fields := strings.Fields(spec)` ` ``// È™åËØÅË°®ËææÂºèÂèñÂÄºËåÉÂõ¥`` ``if count := len(fields); count &lt; min || count &gt; max &#123;`` ``if min == max &#123;`` ``return nil, fmt.Errorf(&quot;Expected exactly %d fields, found %d: %s&quot;, min, count, spec)`` ``&#125;`` ``return nil, fmt.Errorf(&quot;Expected %d to %d fields, found %d: %s&quot;, min, max, count, spec)`` ``&#125;` ` ``// Fill in missing fields`` ``fields = expandFields(fields, p.options)` ` ``var err error`` ``field := func(field string, r bounds) uint64 &#123;`` ``if err != nil &#123;`` ``return 0`` ``&#125;`` ``var bits uint64`` ``bits, err = getField(field, r)`` ``return bits`` ``&#125;` ` ``var (`` ``second = field(fields[0], seconds)`` ``minute = field(fields[1], minutes)`` ``hour = field(fields[2], hours)`` ``dayofmonth = field(fields[3], dom)`` ``month = field(fields[4], months)`` ``dayofweek = field(fields[5], dow)`` ``)`` ``if err != nil &#123;`` ``return nil, err`` ``&#125;`` ``// ËøîÂõûÊâÄÈúÄË¶ÅÁöÑSpecSchedule`` ``return &amp;SpecSchedule&#123;`` ``Second: second,`` ``Minute: minute,`` ``Hour: hour,`` ``Dom: dayofmonth,`` ``Month: month,`` ``Dow: dayofweek,`` ``&#125;, nil``&#125;` `func expandFields(fields []string, options ParseOption) []string &#123;`` ``n := 0`` ``count := len(fields)`` ``expFields := make([]string, len(places))`` ``copy(expFields, defaults)`` ``for i, place := range places &#123;`` ``if options&amp;place &gt; 0 &#123;`` ``expFields[i] = fields[n]`` ``n++`` ``&#125;`` ``if n == count &#123;`` ``break`` ``&#125;`` ``&#125;`` ``return expFields``&#125;` `var standardParser = NewParser(`` ``Minute | Hour | Dom | Month | Dow | Descriptor,``)` `// ParseStandard returns a new crontab schedule representing the given standardSpec``// (https://en.wikipedia.org/wiki/Cron). It differs from Parse requiring to always``// pass 5 entries representing: minute, hour, day of month, month and day of week,``// in that order. It returns a descriptive error if the spec is not valid.``//``// It accepts``// - Standard crontab specs, e.g. &quot;* * * * ?&quot;``// - Descriptors, e.g. &quot;@midnight&quot;, &quot;@every 1h30m&quot;``// ËøôÈáåË°®Á§∫‰∏ç‰ªÖÂèØ‰ª•‰ΩøÁî®cronË°®ËææÂºèÔºå‰πüÂèØ‰ª•‰ΩøÁî®@midnight @everyÁ≠âÊñπÊ≥ï` `func ParseStandard(standardSpec string) (Schedule, error) &#123;`` ``return standardParser.Parse(standardSpec)``&#125;` `var defaultParser = NewParser(`` ``Second | Minute | Hour | Dom | Month | DowOptional | Descriptor,``)` `// Parse returns a new crontab schedule representing the given spec.``// It returns a descriptive error if the spec is not valid.``//``// It accepts``// - Full crontab specs, e.g. &quot;* * * * * ?&quot;``// - Descriptors, e.g. &quot;@midnight&quot;, &quot;@every 1h30m&quot;``func Parse(spec string) (Schedule, error) &#123;`` ``return defaultParser.Parse(spec)``&#125;` `// getField returns an Int with the bits set representing all of the times that``// the field represents or error parsing field value. A &quot;field&quot; is a comma-separated``// list of &quot;ranges&quot;.``func getField(field string, r bounds) (uint64, error) &#123;`` ``var bits uint64`` ``ranges := strings.FieldsFunc(field, func(r rune) bool &#123; return r == &apos;,&apos; &#125;)`` ``for _, expr := range ranges &#123;`` ``bit, err := getRange(expr, r)`` ``if err != nil &#123;`` ``return bits, err`` ``&#125;`` ``bits |= bit`` ``&#125;`` ``return bits, nil``&#125;` `// getRange returns the bits indicated by the given expression:``// number | number &quot;-&quot; number [ &quot;/&quot; number ]``// or error parsing range.``func getRange(expr string, r bounds) (uint64, error) &#123;`` ``var (`` ``start, end, step uint`` ``rangeAndStep = strings.Split(expr, &quot;/&quot;)`` ``lowAndHigh = strings.Split(rangeAndStep[0], &quot;-&quot;)`` ``singleDigit = len(lowAndHigh) == 1`` ``err error`` ``)` ` ``var extra uint64`` ``if lowAndHigh[0] == &quot;*&quot; || lowAndHigh[0] == &quot;?&quot; &#123;`` ``start = r.min`` ``end = r.max`` ``extra = starBit`` ``&#125; else &#123;`` ``start, err = parseIntOrName(lowAndHigh[0], r.names)`` ``if err != nil &#123;`` ``return 0, err`` ``&#125;`` ``switch len(lowAndHigh) &#123;`` ``case 1:`` ``end = start`` ``case 2:`` ``end, err = parseIntOrName(lowAndHigh[1], r.names)`` ``if err != nil &#123;`` ``return 0, err`` ``&#125;`` ``default:`` ``return 0, fmt.Errorf(&quot;Too many hyphens: %s&quot;, expr)`` ``&#125;`` ``&#125;` ` ``switch len(rangeAndStep) &#123;`` ``case 1:`` ``step = 1`` ``case 2:`` ``step, err = mustParseInt(rangeAndStep[1])`` ``if err != nil &#123;`` ``return 0, err`` ``&#125;` ` ``// Special handling: &quot;N/step&quot; means &quot;N-max/step&quot;.`` ``if singleDigit &#123;`` ``end = r.max`` ``&#125;`` ``default:`` ``return 0, fmt.Errorf(&quot;Too many slashes: %s&quot;, expr)`` ``&#125;` ` ``if start &lt; r.min &#123;`` ``return 0, fmt.Errorf(&quot;Beginning of range (%d) below minimum (%d): %s&quot;, start, r.min, expr)`` ``&#125;`` ``if end &gt; r.max &#123;`` ``return 0, fmt.Errorf(&quot;End of range (%d) above maximum (%d): %s&quot;, end, r.max, expr)`` ``&#125;`` ``if start &gt; end &#123;`` ``return 0, fmt.Errorf(&quot;Beginning of range (%d) beyond end of range (%d): %s&quot;, start, end, expr)`` ``&#125;`` ``if step == 0 &#123;`` ``return 0, fmt.Errorf(&quot;Step of range should be a positive number: %s&quot;, expr)`` ``&#125;` ` ``return getBits(start, end, step) | extra, nil``&#125;` `// parseIntOrName returns the (possibly-named) integer contained in expr.``func parseIntOrName(expr string, names map[string]uint) (uint, error) &#123;`` ``if names != nil &#123;`` ``if namedInt, ok := names[strings.ToLower(expr)]; ok &#123;`` ``return namedInt, nil`` ``&#125;`` ``&#125;`` ``return mustParseInt(expr)``&#125;` `// mustParseInt parses the given expression as an int or returns an error.``func mustParseInt(expr string) (uint, error) &#123;`` ``num, err := strconv.Atoi(expr)`` ``if err != nil &#123;`` ``return 0, fmt.Errorf(&quot;Failed to parse int from %s: %s&quot;, expr, err)`` ``&#125;`` ``if num &lt; 0 &#123;`` ``return 0, fmt.Errorf(&quot;Negative number (%d) not allowed: %s&quot;, num, expr)`` ``&#125;` ` ``return uint(num), nil``&#125;` `// getBits sets all bits in the range [min, max], modulo the given step size.``func getBits(min, max, step uint) uint64 &#123;`` ``var bits uint64` ` ``// If step is 1, use shifts.`` ``if step == 1 &#123;`` ``return ^(math.MaxUint64 &lt;&lt; (max + 1)) &amp; (math.MaxUint64 &lt;&lt; min)`` ``&#125;` ` ``// Else, use a simple loop.`` ``for i := min; i &lt;= max; i += step &#123;`` ``bits |= 1 &lt;&lt; i`` ``&#125;`` ``return bits``&#125;` `// all returns all bits within the given bounds. (plus the star bit)``func all(r bounds) uint64 &#123;`` ``return getBits(r.min, r.max, 1) | starBit``&#125;` `// parseDescriptor returns a predefined schedule for the expression, or error if none matches.``func parseDescriptor(descriptor string) (Schedule, error) &#123;`` ``switch descriptor &#123;`` ``case &quot;@yearly&quot;, &quot;@annually&quot;:`` ``return &amp;SpecSchedule&#123;`` ``Second: 1 &lt;&lt; seconds.min,`` ``Minute: 1 &lt;&lt; minutes.min,`` ``Hour: 1 &lt;&lt; hours.min,`` ``Dom: 1 &lt;&lt; dom.min,`` ``Month: 1 &lt;&lt; months.min,`` ``Dow: all(dow),`` ``&#125;, nil` ` ``case &quot;@monthly&quot;:`` ``return &amp;SpecSchedule&#123;`` ``Second: 1 &lt;&lt; seconds.min,`` ``Minute: 1 &lt;&lt; minutes.min,`` ``Hour: 1 &lt;&lt; hours.min,`` ``Dom: 1 &lt;&lt; dom.min,`` ``Month: all(months),`` ``Dow: all(dow),`` ``&#125;, nil` ` ``case &quot;@weekly&quot;:`` ``return &amp;SpecSchedule&#123;`` ``Second: 1 &lt;&lt; seconds.min,`` ``Minute: 1 &lt;&lt; minutes.min,`` ``Hour: 1 &lt;&lt; hours.min,`` ``Dom: all(dom),`` ``Month: all(months),`` ``Dow: 1 &lt;&lt; dow.min,`` ``&#125;, nil` ` ``case &quot;@daily&quot;, &quot;@midnight&quot;:`` ``return &amp;SpecSchedule&#123;`` ``Second: 1 &lt;&lt; seconds.min,`` ``Minute: 1 &lt;&lt; minutes.min,`` ``Hour: 1 &lt;&lt; hours.min,`` ``Dom: all(dom),`` ``Month: all(months),`` ``Dow: all(dow),`` ``&#125;, nil` ` ``case &quot;@hourly&quot;:`` ``return &amp;SpecSchedule&#123;`` ``Second: 1 &lt;&lt; seconds.min,`` ``Minute: 1 &lt;&lt; minutes.min,`` ``Hour: all(hours),`` ``Dom: all(dom),`` ``Month: all(months),`` ``Dow: all(dow),`` ``&#125;, nil`` ``&#125;` ` ``const every = &quot;@every &quot;`` ``if strings.HasPrefix(descriptor, every) &#123;`` ``duration, err := time.ParseDuration(descriptor[len(every):])`` ``if err != nil &#123;`` ``return nil, fmt.Errorf(&quot;Failed to parse duration %s: %s&quot;, descriptor, err)`` ``&#125;`` ``return Every(duration), nil`` ``&#125;` ` ``return nil, fmt.Errorf(&quot;Unrecognized descriptor: %s&quot;, descriptor)``&#125;` È°πÁõÆ‰∏≠Â∫îÁî® 1`package main``import (`` ``&quot;github.com/robfig/cron&quot;`` ``&quot;log&quot;``)` `func main() &#123;`` ``i := 0`` ``c := cron.New()`` ``spec := &quot;*/5 * * * * ?&quot;`` ``c.AddFunc(spec, func() &#123;`` ``i++`` ``log.Println(&quot;cron running:&quot;, i)`` ``&#125;)`` ``c.AddFunc(&quot;@every 1h1m&quot;, func() &#123;`` ``i++`` ``log.Println(&quot;cron running:&quot;, i)`` ``&#125;)`` ``c.Start()``&#125;` Ê≥®Ôºö @every Áî®Ê≥ïÊØîËæÉÁâπÊÆäÔºåËøôÊòØGoÈáåÈù¢ÊØîËæÉÁâπËâ≤ÁöÑÁî®Ê≥ï„ÄÇÂêåÊ†∑ÁöÑËøòÊúâ @yearly @annually @monthly @weekly @daily @midnight @hourly ËøôÈáåÈù¢Â∞±‰∏ç‰∏Ä‰∏ÄËµòËø∞‰∫Ü„ÄÇÂ∏åÊúõÂ§ßÂÆ∂ËÉΩÂ§üËá™Â∑±Êé¢Á¥¢„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker compose ÁΩëÁªúËÆæÁΩÆ]]></title>
    <url>%2F2019%2F10%2F27%2FDocker-compose-%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[Docker Compose ÁΩëÁªúËÆæÁΩÆÂü∫Êú¨Ê¶ÇÂøµÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåCompose‰ºö‰∏∫Êàë‰ª¨ÁöÑÂ∫îÁî®ÂàõÂª∫‰∏Ä‰∏™ÁΩëÁªúÔºåÊúçÂä°ÁöÑÊØè‰∏™ÂÆπÂô®ÈÉΩ‰ºöÂä†ÂÖ•ËØ•ÁΩëÁªú‰∏≠„ÄÇËøôÊ†∑ÔºåÂÆπÂô®Â∞±ÂèØË¢´ËØ•ÁΩëÁªú‰∏≠ÁöÑÂÖ∂‰ªñÂÆπÂô®ËÆøÈóÆÔºå‰∏ç‰ªÖÂ¶ÇÊ≠§ÔºåËØ•ÂÆπÂô®ËøòËÉΩ‰ª•ÊúçÂä°ÂêçÁß∞‰Ωú‰∏∫hostnameË¢´ÂÖ∂‰ªñÂÆπÂô®ËÆøÈóÆ„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂ∫îÁî®Á®ãÂ∫èÁöÑÁΩëÁªúÂêçÁß∞Âü∫‰∫éComposeÁöÑÂ∑•Á®ãÂêçÁß∞ÔºåËÄåÈ°πÁõÆÂêçÁß∞Âü∫‰∫édocker-compose.ymlÊâÄÂú®ÁõÆÂΩïÁöÑÂêçÁß∞„ÄÇÂ¶ÇÈúÄ‰øÆÊîπÂ∑•Á®ãÂêçÁß∞ÔºåÂèØ‰ΩøÁî®‚Äìproject-nameÊ†áËØÜÊàñCOMPOSE_PORJECT_NAMEÁéØÂ¢ÉÂèòÈáè„ÄÇ ‰∏æ‰∏™‰æãÂ≠êÔºåÂÅáÂ¶Ç‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÂú®Âêç‰∏∫myappÁöÑÁõÆÂΩï‰∏≠ÔºåÂπ∂‰∏îdocker-compose.ymlÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö 12345678version: &apos;2&apos;services: web: build: . ports: - &quot;8000:8000&quot; db: image: postgres ÂΩìÊàë‰ª¨ËøêË°ådocker-compose upÊó∂ÔºåÂ∞Ü‰ºöÊâßË°å‰ª•‰∏ãÂá†Ê≠•Ôºö ÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫myapp_defaultÁöÑÁΩëÁªúÔºõ ‰ΩøÁî®webÊúçÂä°ÁöÑÈÖçÁΩÆÂàõÂª∫ÂÆπÂô®ÔºåÂÆÉ‰ª•‚Äúweb‚ÄùËøô‰∏™ÂêçÁß∞Âä†ÂÖ•ÁΩëÁªúmyapp_defaultÔºõ ‰ΩøÁî®dbÊúçÂä°ÁöÑÈÖçÁΩÆÂàõÂª∫ÂÆπÂô®ÔºåÂÆÉ‰ª•‚Äúdb‚ÄùËøô‰∏™ÂêçÁß∞Âä†ÂÖ•ÁΩëÁªúmyapp_default„ÄÇ ÂÆπÂô®Èó¥ÂèØ‰ΩøÁî®ÊúçÂä°ÂêçÁß∞ÔºàwebÊàñdbÔºâ‰Ωú‰∏∫hostnameÁõ∏‰∫íËÆøÈóÆ„ÄÇ‰æãÂ¶ÇÔºåwebËøô‰∏™ÊúçÂä°ÂèØ‰ΩøÁî®postgres://db:5432 ËÆøÈóÆdbÂÆπÂô®„ÄÇ Êõ¥Êñ∞ÂÆπÂô®ÂΩìÊúçÂä°ÁöÑÈÖçÁΩÆÂèëÁîüÊõ¥ÊîπÊó∂ÔºåÂèØ‰ΩøÁî®docker-compose upÂëΩ‰ª§Êõ¥Êñ∞ÈÖçÁΩÆ„ÄÇ Ê≠§Êó∂ÔºåCompose‰ºöÂà†Èô§ÊóßÂÆπÂô®Âπ∂ÂàõÂª∫Êñ∞ÂÆπÂô®„ÄÇÊñ∞ÂÆπÂô®‰ºö‰ª•‰∏çÂêåÁöÑIPÂú∞ÂùÄÂä†ÂÖ•ÁΩëÁªúÔºåÂêçÁß∞‰øùÊåÅ‰∏çÂèò„ÄÇ‰ªª‰ΩïÊåáÂêëÊóßÂÆπÂô®ÁöÑËøûÊé•ÈÉΩ‰ºöË¢´ÂÖ≥Èó≠ÔºåÂÆπÂô®‰ºöÈáçÊñ∞ÊâæÂà∞Êñ∞ÂÆπÂô®Âπ∂ËøûÊé•‰∏äÂéª„ÄÇ linksÂâçÊñáËÆ≤ËøáÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊúçÂä°‰πãÈó¥ÂèØ‰ΩøÁî®ÊúçÂä°ÂêçÁß∞Áõ∏‰∫íËÆøÈóÆ„ÄÇlinksÂÖÅËÆ∏Êàë‰ª¨ÂÆö‰πâ‰∏Ä‰∏™Âà´ÂêçÔºå‰ªéËÄå‰ΩøÁî®ËØ•Âà´ÂêçËÆøÈóÆÂÖ∂‰ªñÊúçÂä°„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºö 12345678version: &apos;2&apos;services: web: build: . links: - &quot;db:database&quot; db: image: postgres ËøôÊ†∑webÊúçÂä°Â∞±ÂèØ‰ΩøÁî®dbÊàñdatabase‰Ωú‰∏∫hostnameËÆøÈóÆdbÊúçÂä°‰∫Ü„ÄÇ ÊåáÂÆöËá™ÂÆö‰πâÁΩëÁªú‰∏Ä‰∫õÂú∫ÊôØ‰∏ãÔºåÈªòËÆ§ÁöÑÁΩëÁªúÈÖçÁΩÆÊª°Ë∂≥‰∏ç‰∫ÜÊàë‰ª¨ÁöÑÈúÄÊ±ÇÔºåÊ≠§Êó∂Êàë‰ª¨ÂèØ‰ΩøÁî®networksÂëΩ‰ª§Ëá™ÂÆö‰πâÁΩëÁªú„ÄÇnetworksÂëΩ‰ª§ÂÖÅËÆ∏Êàë‰ª¨ÂàõÂª∫Êõ¥Âä†Â§çÊùÇÁöÑÁΩëÁªúÊãìÊâëÂπ∂ÊåáÂÆöËá™ÂÆö‰πâÁΩëÁªúÈ©±Âä®ÂíåÈÄâÈ°π„ÄÇ‰∏ç‰ªÖÂ¶ÇÊ≠§ÔºåÊàë‰ª¨ËøòÂèØ‰ΩøÁî®networksÂ∞ÜÊúçÂä°ËøûÊé•Âà∞‰∏çÊòØÁî±ComposeÁÆ°ÁêÜÁöÑ„ÄÅÂ§ñÈÉ®ÂàõÂª∫ÁöÑÁΩëÁªú„ÄÇ Â¶Ç‰∏ãÔºåÊàë‰ª¨Âú®ÂÖ∂‰∏≠ÂÆö‰πâ‰∫Ü‰∏§‰∏™Ëá™ÂÆö‰πâÁΩëÁªú„ÄÇ 123456789101112131415161718192021222324252627version: &apos;2&apos;services: proxy: build: ./proxy networks: - front app: build: ./app networks: - front - back db: image: postgres networks: - backnetworks: front: # Use a custom driver driver: custom-driver-1 back: # Use a custom driver which takes special options driver: custom-driver-2 driver_opts: foo: &quot;1&quot; bar: &quot;2&quot; ÂÖ∂‰∏≠ÔºåproxyÊúçÂä°‰∏édbÊúçÂä°ÈöîÁ¶ªÔºå‰∏§ËÄÖÂàÜÂà´‰ΩøÁî®Ëá™Â∑±ÁöÑÁΩëÁªúÔºõappÊúçÂä°ÂèØ‰∏é‰∏§ËÄÖÈÄö‰ø°„ÄÇ Áî±Êú¨‰æã‰∏çÈöæÂèëÁé∞Ôºå‰ΩøÁî®networksÂëΩ‰ª§ÔºåÂç≥ÂèØÊñπ‰æøÂÆûÁé∞ÊúçÂä°Èó¥ÁöÑÁΩëÁªúÈöîÁ¶ª‰∏éËøûÊé•„ÄÇ ÈÖçÁΩÆÈªòËÆ§ÁΩëÁªúÈô§Ëá™ÂÆö‰πâÁΩëÁªúÂ§ñÔºåÊàë‰ª¨‰πüÂèØ‰∏∫ÈªòËÆ§ÁΩëÁªúËá™ÂÆö‰πâÈÖçÁΩÆ„ÄÇ 1234567891011121314version: &apos;2&apos;services: web: build: . ports: - &quot;8000:8000&quot; db: image: postgresnetworks: default: # Use a custom driver driver: custom-driver-1 ËøôÊ†∑ÔºåÂ∞±ÂèØ‰∏∫ËØ•Â∫îÁî®ÊåáÂÆöËá™ÂÆö‰πâÁöÑÁΩëÁªúÈ©±Âä®„ÄÇ ‰ΩøÁî®Â∑≤Â≠òÂú®ÁöÑÁΩëÁªú‰∏Ä‰∫õÂú∫ÊôØ‰∏ãÔºåÊàë‰ª¨Âπ∂‰∏çÈúÄË¶ÅÂàõÂª∫Êñ∞ÁöÑÁΩëÁªúÔºåËÄåÂè™ÈúÄÂä†ÂÖ•Â∑≤Â≠òÂú®ÁöÑÁΩëÁªúÔºåÊ≠§Êó∂ÂèØ‰ΩøÁî®externalÈÄâÈ°π„ÄÇÁ§∫‰æãÔºö 1234networks: default: external: name: my-pre-existing-network Docker Compose ÈìæÊé•Â§ñÈÉ®ÂÆπÂô®ÁöÑÂá†ÁßçÊñπÂºèÂú®Docker‰∏≠ÔºåÂÆπÂô®‰πãÈó¥ÁöÑÈìæÊé•ÊòØ‰∏ÄÁßçÂæàÂ∏∏ËßÅÁöÑÊìç‰ΩúÔºöÂÆÉÊèê‰æõ‰∫ÜËÆøÈóÆÂÖ∂‰∏≠ÁöÑÊüê‰∏™ÂÆπÂô®ÁöÑÁΩëÁªúÊúçÂä°ËÄå‰∏çÈúÄË¶ÅÂ∞ÜÊâÄÈúÄÁöÑÁ´ØÂè£Êö¥Èú≤ÁªôDocker Host‰∏ªÊú∫ÁöÑÂäüËÉΩ„ÄÇDocker Compose‰∏≠ÂØπËØ•ÁâπÊÄßÁöÑÊîØÊåÅÂêåÊ†∑ÊòØÂæàÊñπ‰æøÁöÑ„ÄÇÁÑ∂ËÄåÔºåÂ¶ÇÊûúÈúÄË¶ÅÈìæÊé•ÁöÑÂÆπÂô®Ê≤°ÊúâÂÆö‰πâÂú®Âêå‰∏Ä‰∏™docker-compose.yml‰∏≠ÁöÑÊó∂ÂÄôÔºåËøô‰∏™Êó∂ÂÄôÂ∞±Á®çÂæÆÈ∫ªÁÉ¶Â§çÊùÇ‰∫ÜÁÇπ„ÄÇ Âú®‰∏ç‰ΩøÁî®Docker ComposeÁöÑÊó∂ÂÄôÔºåÂ∞Ü‰∏§‰∏™ÂÆπÂô®ÈìæÊé•Ëµ∑Êù•‰ΩøÁî®‚ÄîlinkÂèÇÊï∞ÔºåÁõ∏ÂØπÊù•ËØ¥ÊØîËæÉÁÆÄÂçïÔºå‰ª•nginxÈïúÂÉè‰∏∫‰æãÂ≠êÔºö 12docker run --rm --name test1 -d nginx #ÂºÄÂêØ‰∏Ä‰∏™ÂÆû‰æãtest1docker run --rm --name test2 --link test1 -d nginx #ÂºÄÂêØ‰∏Ä‰∏™ÂÆû‰æãtest2Âπ∂‰∏étest1Âª∫Á´ãÈìæÊé• ËøôÊ†∑Ôºåtest2‰∏étest1‰æøÂª∫Á´ã‰∫ÜÈìæÊé•ÔºåÂ∞±ÂèØ‰ª•Âú®test2‰∏≠‰ΩøÁî®ËÆøÈóÆtest1‰∏≠ÁöÑÊúçÂä°‰∫Ü„ÄÇ Â¶ÇÊûú‰ΩøÁî®Docker ComposeÔºåÈÇ£‰πàËøô‰∏™‰∫ãÊÉÖÂ∞±Êõ¥ÁÆÄÂçï‰∫ÜÔºåËøòÊòØ‰ª•‰∏äÈù¢ÁöÑnginxÈïúÂÉè‰∏∫‰æãÂ≠êÔºåÁºñËæëdocker-compose.ymlÊñá‰ª∂‰∏∫Ôºö 12345678910version: &quot;3&quot;services: test2: image: nginx depends_on: - test1 links: - test1 test1: image: nginx ÊúÄÁªàÊïàÊûú‰∏é‰ΩøÁî®ÊôÆÈÄöÁöÑDockerÂëΩ‰ª§docker run xxxxÂª∫Á´ãÁöÑÈìæÊé•Âπ∂Êó†Âå∫Âà´„ÄÇËøôÂè™ÊòØ‰∏ÄÁßçÊúÄ‰∏∫ÁêÜÊÉ≥ÁöÑÊÉÖÂÜµ„ÄÇ Â¶ÇÊûúÂÆπÂô®Ê≤°ÊúâÂÆö‰πâÂú®Âêå‰∏Ä‰∏™docker-compose.ymlÊñá‰ª∂‰∏≠ÔºåÂ∫îËØ•Â¶Ç‰ΩïÈìæÊé•ÂÆÉ‰ª¨Âë¢Ôºü ÂèàÂ¶ÇÊûúÂÆö‰πâÂú®docker-compose.ymlÊñá‰ª∂‰∏≠ÁöÑÂÆπÂô®ÈúÄË¶Å‰∏édocker run xxxÂêØÂä®ÁöÑÂÆπÂô®ÈìæÊé•ÔºåÈúÄË¶ÅÂ¶Ç‰ΩïÂ§ÑÁêÜÔºü ÈíàÂØπËøô‰∏§ÁßçÂÖ∏ÂûãÁöÑÊÉÖÂÜµÔºå‰∏ãÈù¢ÁªôÂá∫Êàë‰∏™‰∫∫ÊµãËØïÂèØË°åÁöÑÂäûÊ≥ïÔºö ÊñπÂºè‰∏ÄÔºöËÆ©ÈúÄË¶ÅÈìæÊé•ÁöÑÂÆπÂô®ÂêåÂ±û‰∏Ä‰∏™Â§ñÈÉ®ÁΩëÁªúÊàë‰ª¨ËøòÊòØ‰ΩøÁî®nginxÈïúÂÉèÊù•Ê®°ÊãüËøôÊ†∑ÁöÑ‰∏Ä‰∏™ÊÉÖÊôØÔºöÂÅáËÆæÊàë‰ª¨ÈúÄË¶ÅÂ∞Ü‰∏§‰∏™‰ΩøÁî®Docker ComposeÁÆ°ÁêÜÁöÑnignxÂÆπÂô®Ôºàtest1Âíåtest2ÔºâÈìæÊé•Ëµ∑Êù•Ôºå‰ΩøÂæótest2ËÉΩÂ§üËÆøÈóÆtest1‰∏≠Êèê‰æõÁöÑÊúçÂä°ÔºåËøôÈáåÊàë‰ª¨‰ª•ËÉΩpingÈÄö‰∏∫ÂáÜ„ÄÇ È¶ñÂÖàÔºåÊàë‰ª¨ÂÆö‰πâÂÆπÂô®test1ÁöÑdocker-compose.ymlÊñá‰ª∂ÂÜÖÂÆπ‰∏∫Ôºö 1234567891011version: &quot;3&quot;services: test2: image: nginx container_name: test1 networks: - default - app_netnetworks: app_net: external: true ÂÆπÂô®test2ÂÜÖÂÆπ‰∏étest1Âü∫Êú¨‰∏ÄÊ†∑ÔºåÂè™ÊòØÂ§ö‰∫Ü‰∏Ä‰∏™external_links,ÈúÄË¶ÅÁâπÂà´ËØ¥ÊòéÁöÑÊòØÔºöÊúÄËøëÂèëÂ∏ÉÁöÑDockerÁâàÊú¨Â∑≤Áªè‰∏çÈúÄË¶Å‰ΩøÁî®external_linksÊù•ÈìæÊé•ÂÆπÂô®ÔºåÂÆπÂô®ÁöÑDNSÊúçÂä°ÂèØ‰ª•Ê≠£Á°ÆÁöÑ‰ΩúÂá∫Âà§Êñ≠ÔºåÂõ†Ê≠§Â¶ÇÊûú‰Ω†‰Ω†ÈúÄË¶ÅÂÖºÂÆπËæÉËÄÅÁâàÊú¨ÁöÑDockerÁöÑËØùÔºåÈÇ£‰πàÂÆπÂô®test2ÁöÑdocker-compose.ymlÊñá‰ª∂ÂÜÖÂÆπ‰∏∫Ôºö 12345678910111213version: &quot;3&quot;services: test2: image: nginx networks: - default - app_net external_links: - test1 container_name: test2networks: app_net: external: true Âê¶ÂàôÁöÑËØùÔºåtest2ÁöÑdocker-compose.ymlÂíåtest1ÁöÑÂÆö‰πâÂÆåÂÖ®‰∏ÄËá¥Ôºå‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÂ§öÊåáÂÆö‰∏Ä‰∏™external_links„ÄÇÁõ∏ÂÖ≥ÁöÑÈóÆÈ¢òËØ∑ÂèÇËßÅstackoverflow‰∏äÁöÑÁõ∏ÂÖ≥ÈóÆÈ¢òÔºödocker-compose + external container Ê≠£Â¶Ç‰Ω†ÁúãÂà∞ÁöÑÈÇ£Ê†∑ÔºåËøôÈáå‰∏§‰∏™ÂÆπÂô®ÁöÑÂÆö‰πâÈáåÈÉΩ‰ΩøÁî®‰∫ÜÂêå‰∏Ä‰∏™Â§ñÈÉ®ÁΩëÁªúapp_net,Âõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶ÅÂú®ÂêØÂä®Ëøô‰∏§‰∏™ÂÆπÂô®‰πãÂâçÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§ÂÜçÂàõÂª∫Â§ñÈÉ®ÁΩëÁªúÔºö 1docker network create app_net ‰πãÂêéÔºåÈÄöËøádocker-compose up -dÂëΩ‰ª§ÂêØÂä®Ëøô‰∏§‰∏™ÂÆπÂô®ÔºåÁÑ∂ÂêéÊâßË°ådocker exec -it test2 ping test1,‰Ω†Â∞Ü‰ºöÁúãÂà∞Â¶Ç‰∏ãÁöÑËæìÂá∫Ôºö 12345678docker exec -it test2 ping test1PING test1 (172.18.0.2): 56 data bytes64 bytes from 172.18.0.2: icmp_seq=0 ttl=64 time=0.091 ms64 bytes from 172.18.0.2: icmp_seq=1 ttl=64 time=0.146 ms64 bytes from 172.18.0.2: icmp_seq=2 ttl=64 time=0.150 ms64 bytes from 172.18.0.2: icmp_seq=3 ttl=64 time=0.145 ms64 bytes from 172.18.0.2: icmp_seq=4 ttl=64 time=0.126 ms64 bytes from 172.18.0.2: icmp_seq=5 ttl=64 time=0.147 ms ËØÅÊòéËøô‰∏§‰∏™ÂÆπÂô®ÊòØÊàêÂäüÈìæÊé•‰∫ÜÔºåÂèçËøáÊù•Âú®test1‰∏≠pingtest2‰πüÊòØËÉΩÂ§üÊ≠£Â∏∏pingÈÄöÁöÑ„ÄÇ Â¶ÇÊûúÊàë‰ª¨ÈÄöËøádocker run --rm --name test3 -d nginxËøôÁßçÊñπÂºèÊù•ÂÖàÂêØÂä®‰∫Ü‰∏Ä‰∏™ÂÆπÂô®(test3)Âπ∂‰∏îÊ≤°ÊúâÊåáÂÆöÂÆÉÊâÄÂ±ûÁöÑÂ§ñÈÉ®ÁΩëÁªúÔºåËÄåÈúÄË¶ÅÂ∞ÜÂÖ∂‰∏étest1ÊàñËÄÖtest2ÈìæÊé•ÁöÑËØùÔºåËøô‰∏™Êó∂ÂÄôÊâãÂä®ÈìæÊé•Â§ñÈÉ®ÁΩëÁªúÂç≥ÂèØÔºö 1docker network connect app_net test3 ËøôÊ†∑Ôºå‰∏â‰∏™ÂÆπÂô®ÈÉΩÂèØ‰ª•Áõ∏‰∫íËÆøÈóÆ‰∫Ü„ÄÇ ÊñπÂºè‰∫åÔºöÊõ¥ÊîπÈúÄË¶ÅÈìæÊé•ÁöÑÂÆπÂô®ÁöÑÁΩëÁªúÊ®°ÂºèÈÄöËøáÊõ¥Êîπ‰Ω†ÊÉ≥Ë¶ÅÁõ∏‰∫íÈìæÊé•ÁöÑÂÆπÂô®ÁöÑÁΩëÁªúÊ®°Âºè‰∏∫bridge,Âπ∂ÊåáÂÆöÈúÄË¶ÅÈìæÊé•ÁöÑÂ§ñÈÉ®ÂÆπÂô®Ôºàexternal_links)Âç≥ÂèØ„ÄÇ‰∏éÂêåÂ±ûÂ§ñÈÉ®ÁΩëÁªúÁöÑÂÆπÂô®ÂèØ‰ª•Áõ∏‰∫íËÆøÈóÆÁöÑÈìæÊé•ÊñπÂºè‰∏Ä‰∏çÂêåÔºåËøôÁßçÊñπÂºèÁöÑËÆøÈóÆÊòØÂçïÂêëÁöÑ„ÄÇ ËøòÊòØ‰ª•nginxÂÆπÂô®ÈïúÂÉè‰∏∫‰æãÂ≠êÔºåÂ¶ÇÊûúÂÆπÂô®ÂÆû‰æãnginx1ÈúÄË¶ÅËÆøÈóÆÂÆπÂô®ÂÆû‰æãnginx2ÔºåÈÇ£‰πànginx2ÁöÑdoker-compose.ymlÂÆö‰πâ‰∏∫Ôºö 123456version: &quot;3&quot;services: nginx2: image: nginx container_name: nginx2 network_mode: bridge ‰∏éÂÖ∂ÂØπÂ∫îÁöÑÔºånginx1ÁöÑdocker-compose.ymlÂÆö‰πâ‰∏∫Ôºö 12345678version: &quot;3&quot;services: nginx1: image: nginx external_links: - nginx2 container_name: nginx1 network_mode: bridge ÈúÄË¶ÅÁâπÂà´ËØ¥ÊòéÁöÑÊòØÔºåËøôÈáåÁöÑexternal_linksÊòØ‰∏çËÉΩÁúÅÁï•ÁöÑÔºåËÄå‰∏înginx1ÁöÑÂêØÂä®ÂøÖÈ°ªË¶ÅÂú®nginx2‰πãÂêéÔºåÂê¶ÂàôÂèØËÉΩ‰ºöÊä•Êâæ‰∏çÂà∞ÂÆπÂô®nginx2ÁöÑÈîôËØØ„ÄÇ Êé•ÁùÄÊàë‰ª¨‰ΩøÁî®pingÊù•ÊµãËØï‰∏ãËøûÈÄöÊÄßÔºö 12345678$ docker exec -it nginx1 ping nginx2 # nginx1 to nginx2PING nginx2 (172.17.0.4): 56 data bytes64 bytes from 172.17.0.4: icmp_seq=0 ttl=64 time=0.141 ms64 bytes from 172.17.0.4: icmp_seq=1 ttl=64 time=0.139 ms64 bytes from 172.17.0.4: icmp_seq=2 ttl=64 time=0.145 ms$ docker exec -it nginx2 ping nginx1 #nginx2 to nginx1ping: unknown host ‰ª•‰∏ä‰πüËÉΩÂÖÖÂàÜËØÅÊòéËøôÁßçÊñπÂºèÊòØÂ±û‰∫éÂçïÂêëËÅîÈÄöÁöÑ„ÄÇ Âú®ÂÆûÈôÖÂ∫îÁî®‰∏≠Ê†πÊçÆËá™Â∑±ÁöÑÈúÄË¶ÅÁÅµÊ¥ªÁöÑÈÄâÊã©Ëøô‰∏§ÁßçÈìæÊé•ÊñπÂºèÔºåÂ¶ÇÊûúÊÉ≥ÂÅ∑ÊáíÁöÑËØùÔºåÂ§ßÂèØÈÄâÊã©Á¨¨‰∫åÁßç„ÄÇ‰∏çËøáÊàëÊõ¥Êé®ËçêÁ¨¨‰∏ÄÁßçÔºå‰∏çÈöæÁúãÂá∫Êó†ËÆ∫ÊòØËÅîÈÄöÊÄßËøòÊòØÁÅµÊ¥ªÊÄßÔºåÁ¨¨‰∏ÄÁßçÈÉΩÊØîËæÉÂ•Ω„ÄÇ ÈôÑdocker-compose.ymlÊñá‰ª∂ËØ¶Ëß£ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294ComposeÂíåDockerÂÖºÂÆπÊÄßÔºö Compose Êñá‰ª∂Ê†ºÂºèÊúâ3‰∏™ÁâàÊú¨,ÂàÜÂà´‰∏∫1, 2.x Âíå 3.x ÁõÆÂâç‰∏ªÊµÅÁöÑ‰∏∫ 3.x ÂÖ∂ÊîØÊåÅ docker 1.13.0 ÂèäÂÖ∂‰ª•‰∏äÁöÑÁâàÊú¨Â∏∏Áî®ÂèÇÊï∞Ôºö version # ÊåáÂÆö compose Êñá‰ª∂ÁöÑÁâàÊú¨ services # ÂÆö‰πâÊâÄÊúâÁöÑ service ‰ø°ÊÅØ, services ‰∏ãÈù¢ÁöÑÁ¨¨‰∏ÄÁ∫ßÂà´ÁöÑ key ÊòØ‰∏Ä‰∏™ service ÁöÑÂêçÁß∞ build # ÊåáÂÆöÂåÖÂê´ÊûÑÂª∫‰∏ä‰∏ãÊñáÁöÑË∑ØÂæÑ, Êàñ‰Ωú‰∏∫‰∏Ä‰∏™ÂØπË±°ÔºåËØ•ÂØπË±°ÂÖ∑Êúâ context ÂíåÊåáÂÆöÁöÑ dockerfile Êñá‰ª∂‰ª•Âèä args ÂèÇÊï∞ÂÄº context # context: ÊåáÂÆö Dockerfile Êñá‰ª∂ÊâÄÂú®ÁöÑË∑ØÂæÑ dockerfile # dockerfile: ÊåáÂÆö context ÊåáÂÆöÁöÑÁõÆÂΩï‰∏ãÈù¢ÁöÑ Dockerfile ÁöÑÂêçÁß∞(ÈªòËÆ§‰∏∫ Dockerfile) args # args: Dockerfile Âú® build ËøáÁ®ã‰∏≠ÈúÄË¶ÅÁöÑÂèÇÊï∞ (Á≠âÂêå‰∫é docker container build --build-arg ÁöÑ‰ΩúÁî®) cache_from # v3.2‰∏≠Êñ∞Â¢ûÁöÑÂèÇÊï∞, ÊåáÂÆöÁºìÂ≠òÁöÑÈïúÂÉèÂàóË°® (Á≠âÂêå‰∫é docker container build --cache_from ÁöÑ‰ΩúÁî®) labels # v3.3‰∏≠Êñ∞Â¢ûÁöÑÂèÇÊï∞, ËÆæÁΩÆÈïúÂÉèÁöÑÂÖÉÊï∞ÊçÆ (Á≠âÂêå‰∫é docker container build --labels ÁöÑ‰ΩúÁî®) shm_size # v3.5‰∏≠Êñ∞Â¢ûÁöÑÂèÇÊï∞, ËÆæÁΩÆÂÆπÂô® /dev/shm ÂàÜÂå∫ÁöÑÂ§ßÂ∞è (Á≠âÂêå‰∫é docker container build --shm-size ÁöÑ‰ΩúÁî®) command # Ë¶ÜÁõñÂÆπÂô®ÂêØÂä®ÂêéÈªòËÆ§ÊâßË°åÁöÑÂëΩ‰ª§, ÊîØÊåÅ shell Ê†ºÂºèÂíå [] Ê†ºÂºè configs # ‰∏çÁü•ÈÅìÊÄé‰πàÁî® cgroup_parent # ‰∏çÁü•ÈÅìÊÄé‰πàÁî® container_name # ÊåáÂÆöÂÆπÂô®ÁöÑÂêçÁß∞ (Á≠âÂêå‰∫é docker run --name ÁöÑ‰ΩúÁî®) credential_spec # ‰∏çÁü•ÈÅìÊÄé‰πàÁî® deploy # v3 ÁâàÊú¨‰ª•‰∏ä, ÊåáÂÆö‰∏éÈÉ®ÁΩ≤ÂíåËøêË°åÊúçÂä°Áõ∏ÂÖ≥ÁöÑÈÖçÁΩÆ, deploy ÈÉ®ÂàÜÊòØ docker stack ‰ΩøÁî®ÁöÑ, docker stack ‰æùËµñ docker swarm endpoint_mode # v3.3 ÁâàÊú¨‰∏≠Êñ∞Â¢ûÁöÑÂäüËÉΩ, ÊåáÂÆöÊúçÂä°Êö¥Èú≤ÁöÑÊñπÂºè vip # Docker ‰∏∫ËØ•ÊúçÂä°ÂàÜÈÖç‰∫Ü‰∏Ä‰∏™ËôöÊãü IP(VIP), ‰Ωú‰∏∫ÂÆ¢Êà∑Á´ØÁöÑËÆøÈóÆÊúçÂä°ÁöÑÂú∞ÂùÄ dnsrr # DNSËΩÆËØ¢, Docker ‰∏∫ËØ•ÊúçÂä°ËÆæÁΩÆ DNS Êù°ÁõÆ, ‰ΩøÂæóÊúçÂä°ÂêçÁß∞ÁöÑ DNS Êü•ËØ¢ËøîÂõû‰∏Ä‰∏™ IP Âú∞ÂùÄÂàóË°®, ÂÆ¢Êà∑Á´ØÁõ¥Êé•ËÆøÈóÆÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™Âú∞ÂùÄ labels # ÊåáÂÆöÊúçÂä°ÁöÑÊ†áÁ≠æÔºåËøô‰∫õÊ†áÁ≠æ‰ªÖÂú®ÊúçÂä°‰∏äËÆæÁΩÆ mode # ÊåáÂÆö deploy ÁöÑÊ®°Âºè global # ÊØè‰∏™ÈõÜÁæ§ËäÇÁÇπÈÉΩÂè™Êúâ‰∏Ä‰∏™ÂÆπÂô® replicated # Áî®Êà∑ÂèØ‰ª•ÊåáÂÆöÈõÜÁæ§‰∏≠ÂÆπÂô®ÁöÑÊï∞Èáè(ÈªòËÆ§) placement # ‰∏çÁü•ÈÅìÊÄé‰πàÁî® replicas # deploy ÁöÑ mode ‰∏∫ replicated Êó∂, ÊåáÂÆöÂÆπÂô®ÂâØÊú¨ÁöÑÊï∞Èáè resources # ËµÑÊ∫êÈôêÂà∂ limits # ËÆæÁΩÆÂÆπÂô®ÁöÑËµÑÊ∫êÈôêÂà∂ cpus: &quot;0.5&quot; # ËÆæÁΩÆËØ•ÂÆπÂô®ÊúÄÂ§öÂè™ËÉΩ‰ΩøÁî® 50% ÁöÑ CPU memory: 50M # ËÆæÁΩÆËØ•ÂÆπÂô®ÊúÄÂ§öÂè™ËÉΩ‰ΩøÁî® 50M ÁöÑÂÜÖÂ≠òÁ©∫Èó¥ reservations # ËÆæÁΩÆ‰∏∫ÂÆπÂô®È¢ÑÁïôÁöÑÁ≥ªÁªüËµÑÊ∫ê(ÈöèÊó∂ÂèØÁî®) cpus: &quot;0.2&quot; # ‰∏∫ËØ•ÂÆπÂô®‰øùÁïô 20% ÁöÑ CPU memory: 20M # ‰∏∫ËØ•ÂÆπÂô®‰øùÁïô 20M ÁöÑÂÜÖÂ≠òÁ©∫Èó¥ restart_policy # ÂÆö‰πâÂÆπÂô®ÈáçÂêØÁ≠ñÁï•, Áî®‰∫é‰ª£Êõø restart ÂèÇÊï∞ condition # ÂÆö‰πâÂÆπÂô®ÈáçÂêØÁ≠ñÁï•(Êé•Âèó‰∏â‰∏™ÂèÇÊï∞) none # ‰∏çÂ∞ùËØïÈáçÂêØ on-failure # Âè™ÊúâÂΩìÂÆπÂô®ÂÜÖÈÉ®Â∫îÁî®Á®ãÂ∫èÂá∫Áé∞ÈóÆÈ¢òÊâç‰ºöÈáçÂêØ any # Êó†ËÆ∫Â¶Ç‰ΩïÈÉΩ‰ºöÂ∞ùËØïÈáçÂêØ(ÈªòËÆ§) delay # Â∞ùËØïÈáçÂêØÁöÑÈó¥ÈöîÊó∂Èó¥(ÈªòËÆ§‰∏∫ 0s) max_attempts # Â∞ùËØïÈáçÂêØÊ¨°Êï∞(ÈªòËÆ§‰∏ÄÁõ¥Â∞ùËØïÈáçÂêØ) window # Ê£ÄÊü•ÈáçÂêØÊòØÂê¶ÊàêÂäü‰πãÂâçÁöÑÁ≠âÂæÖÊó∂Èó¥(Âç≥Â¶ÇÊûúÂÆπÂô®ÂêØÂä®‰∫Ü, ÈöîÂ§öÂ∞ëÁßí‰πãÂêéÂéªÊ£ÄÊµãÂÆπÂô®ÊòØÂê¶Ê≠£Â∏∏, ÈªòËÆ§ 0s) update_config # Áî®‰∫éÈÖçÁΩÆÊªöÂä®Êõ¥Êñ∞ÈÖçÁΩÆ parallelism # ‰∏ÄÊ¨°ÊÄßÊõ¥Êñ∞ÁöÑÂÆπÂô®Êï∞Èáè delay # Êõ¥Êñ∞‰∏ÄÁªÑÂÆπÂô®‰πãÈó¥ÁöÑÈó¥ÈöîÊó∂Èó¥ failure_action # ÂÆö‰πâÊõ¥Êñ∞Â§±Ë¥•ÁöÑÁ≠ñÁï• continue # ÁªßÁª≠Êõ¥Êñ∞ rollback # ÂõûÊªöÊõ¥Êñ∞ pause # ÊöÇÂÅúÊõ¥Êñ∞(ÈªòËÆ§) monitor # ÊØèÊ¨°Êõ¥Êñ∞ÂêéÁöÑÊåÅÁª≠Êó∂Èó¥‰ª•ÁõëËßÜÊõ¥Êñ∞ÊòØÂê¶Â§±Ë¥•(Âçï‰Ωç: ns|us|ms|s|m|h) (ÈªòËÆ§‰∏∫0) max_failure_ratio # ÂõûÊªöÊúüÈó¥ÂÆπÂøçÁöÑÂ§±Ë¥•Áéá(ÈªòËÆ§ÂÄº‰∏∫0) order # v3.4 ÁâàÊú¨‰∏≠Êñ∞Â¢ûÁöÑÂèÇÊï∞, ÂõûÊªöÊúüÈó¥ÁöÑÊìç‰ΩúÈ°∫Â∫è stop-first #Êóß‰ªªÂä°Âú®ÂêØÂä®Êñ∞‰ªªÂä°‰πãÂâçÂÅúÊ≠¢(ÈªòËÆ§) start-first #È¶ñÂÖàÂêØÂä®Êñ∞‰ªªÂä°, Âπ∂‰∏îÊ≠£Âú®ËøêË°åÁöÑ‰ªªÂä°ÊöÇÊó∂ÈáçÂè† rollback_config # v3.7 ÁâàÊú¨‰∏≠Êñ∞Â¢ûÁöÑÂèÇÊï∞, Áî®‰∫éÂÆö‰πâÂú® update_config Êõ¥Êñ∞Â§±Ë¥•ÁöÑÂõûÊªöÁ≠ñÁï• parallelism # ‰∏ÄÊ¨°ÂõûÊªöÁöÑÂÆπÂô®Êï∞, Â¶ÇÊûúËÆæÁΩÆ‰∏∫0, ÂàôÊâÄÊúâÂÆπÂô®ÂêåÊó∂ÂõûÊªö delay # ÊØè‰∏™ÁªÑÂõûÊªö‰πãÈó¥ÁöÑÊó∂Èó¥Èó¥Èöî(ÈªòËÆ§‰∏∫0) failure_action # ÂÆö‰πâÂõûÊªöÂ§±Ë¥•ÁöÑÁ≠ñÁï• continue # ÁªßÁª≠ÂõûÊªö pause # ÊöÇÂÅúÂõûÊªö monitor # ÊØèÊ¨°ÂõûÊªö‰ªªÂä°ÂêéÁöÑÊåÅÁª≠Êó∂Èó¥‰ª•ÁõëËßÜÂ§±Ë¥•(Âçï‰Ωç: ns|us|ms|s|m|h) (ÈªòËÆ§‰∏∫0) max_failure_ratio # ÂõûÊªöÊúüÈó¥ÂÆπÂøçÁöÑÂ§±Ë¥•Áéá(ÈªòËÆ§ÂÄº0) order # ÂõûÊªöÊúüÈó¥ÁöÑÊìç‰ΩúÈ°∫Â∫è stop-first # Êóß‰ªªÂä°Âú®ÂêØÂä®Êñ∞‰ªªÂä°‰πãÂâçÂÅúÊ≠¢(ÈªòËÆ§) start-first # È¶ñÂÖàÂêØÂä®Êñ∞‰ªªÂä°, Âπ∂‰∏îÊ≠£Âú®ËøêË°åÁöÑ‰ªªÂä°ÊöÇÊó∂ÈáçÂè† Ê≥®ÊÑèÔºö ÊîØÊåÅ docker-compose up Âíå docker-compose run ‰ΩÜ‰∏çÊîØÊåÅ docker stack deploy ÁöÑÂ≠êÈÄâÈ°π security_opt container_name devices tmpfs stop_signal links cgroup_parent network_mode external_links restart build userns_mode sysctls devices # ÊåáÂÆöËÆæÂ§áÊò†Â∞ÑÂàóË°® (Á≠âÂêå‰∫é docker run --device ÁöÑ‰ΩúÁî®) depends_on # ÂÆö‰πâÂÆπÂô®ÂêØÂä®È°∫Â∫è (Ê≠§ÈÄâÈ°πËß£ÂÜ≥‰∫ÜÂÆπÂô®‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ªÔºå Ê≠§ÈÄâÈ°πÂú® v3 ÁâàÊú¨‰∏≠ ‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) Á§∫‰æãÔºö docker-compose up ‰ª•‰æùËµñÈ°∫Â∫èÂêØÂä®ÊúçÂä°Ôºå‰∏ãÈù¢‰æãÂ≠ê‰∏≠ redis Âíå db ÊúçÂä°Âú® web ÂêØÂä®ÂâçÂêØÂä® ÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰ΩøÁî® docker-compose up web ËøôÊ†∑ÁöÑÊñπÂºèÂêØÂä® web ÊúçÂä°Êó∂Ôºå‰πü‰ºöÂêØÂä® redis Âíå db ‰∏§‰∏™ÊúçÂä°ÔºåÂõ†‰∏∫Âú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÂÆö‰πâ‰∫Ü‰æùËµñÂÖ≥Á≥ª version: &apos;3&apos; services: web: build: . depends_on: - db - redis redis: image: redis db: image: postgres dns # ËÆæÁΩÆ DNS Âú∞ÂùÄ(Á≠âÂêå‰∫é docker run --dns ÁöÑ‰ΩúÁî®) dns_search # ËÆæÁΩÆ DNS ÊêúÁ¥¢Âüü(Á≠âÂêå‰∫é docker run --dns-search ÁöÑ‰ΩúÁî®) tmpfs # v2 ÁâàÊú¨‰ª•‰∏ä, ÊåÇËΩΩÁõÆÂΩïÂà∞ÂÆπÂô®‰∏≠, ‰Ωú‰∏∫ÂÆπÂô®ÁöÑ‰∏¥Êó∂Êñá‰ª∂Á≥ªÁªü(Á≠âÂêå‰∫é docker run --tmpfs ÁöÑ‰ΩúÁî®, Âú®‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) entrypoint # Ë¶ÜÁõñÂÆπÂô®ÁöÑÈªòËÆ§ entrypoint Êåá‰ª§ (Á≠âÂêå‰∫é docker run --entrypoint ÁöÑ‰ΩúÁî®) env_file # ‰ªéÊåáÂÆöÊñá‰ª∂‰∏≠ËØªÂèñÂèòÈáèËÆæÁΩÆ‰∏∫ÂÆπÂô®‰∏≠ÁöÑÁéØÂ¢ÉÂèòÈáè, ÂèØ‰ª•ÊòØÂçï‰∏™ÂÄºÊàñËÄÖ‰∏Ä‰∏™Êñá‰ª∂ÂàóË°®, Â¶ÇÊûúÂ§ö‰∏™Êñá‰ª∂‰∏≠ÁöÑÂèòÈáèÈáçÂêçÂàôÂêéÈù¢ÁöÑÂèòÈáèË¶ÜÁõñÂâçÈù¢ÁöÑÂèòÈáè, environment ÁöÑÂÄºË¶ÜÁõñ env_file ÁöÑÂÄº Êñá‰ª∂Ê†ºÂºèÔºö RACK_ENV=development environment # ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÔºå environment ÁöÑÂÄºÂèØ‰ª•Ë¶ÜÁõñ env_file ÁöÑÂÄº (Á≠âÂêå‰∫é docker run --env ÁöÑ‰ΩúÁî®) expose # Êö¥Èú≤Á´ØÂè£, ‰ΩÜÊòØ‰∏çËÉΩÂíåÂÆø‰∏ªÊú∫Âª∫Á´ãÊò†Â∞ÑÂÖ≥Á≥ª, Á±ª‰ºº‰∫é Dockerfile ÁöÑ EXPOSE Êåá‰ª§ external_links # ËøûÊé•‰∏çÂú® docker-compose.yml ‰∏≠ÂÆö‰πâÁöÑÂÆπÂô®ÊàñËÄÖ‰∏çÂú® compose ÁÆ°ÁêÜÁöÑÂÆπÂô®(docker run ÂêØÂä®ÁöÑÂÆπÂô®, Âú® v3 ÁâàÊú¨‰∏≠‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) extra_hosts # Ê∑ªÂä† host ËÆ∞ÂΩïÂà∞ÂÆπÂô®‰∏≠ÁöÑ /etc/hosts ‰∏≠ (Á≠âÂêå‰∫é docker run --add-host ÁöÑ‰ΩúÁî®) healthcheck # v2.1 ‰ª•‰∏äÁâàÊú¨, ÂÆö‰πâÂÆπÂô®ÂÅ•Â∫∑Áä∂ÊÄÅÊ£ÄÊü•, Á±ª‰ºº‰∫é Dockerfile ÁöÑ HEALTHCHECK Êåá‰ª§ test # Ê£ÄÊü•ÂÆπÂô®Ê£ÄÊü•Áä∂ÊÄÅÁöÑÂëΩ‰ª§, ËØ•ÈÄâÈ°πÂøÖÈ°ªÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÊàñËÄÖÂàóË°®, Á¨¨‰∏ÄÈ°πÂøÖÈ°ªÊòØ NONE, CMD Êàñ CMD-SHELL, Â¶ÇÊûúÂÖ∂ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂàôÁõ∏ÂΩì‰∫é CMD-SHELL Âä†ËØ•Â≠óÁ¨¶‰∏≤ NONE # Á¶ÅÁî®ÂÆπÂô®ÁöÑÂÅ•Â∫∑Áä∂ÊÄÅÊ£ÄÊµã CMD # test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost&quot;] CMD-SHELL # test: [&quot;CMD-SHELL&quot;, &quot;curl -f http://localhost || exit 1&quot;] ÊàñËÄÖ test: curl -f https://localhost || exit 1 interval: 1m30s # ÊØèÊ¨°Ê£ÄÊü•‰πãÈó¥ÁöÑÈó¥ÈöîÊó∂Èó¥ timeout: 10s # ËøêË°åÂëΩ‰ª§ÁöÑË∂ÖÊó∂Êó∂Èó¥ retries: 3 # ÈáçËØïÊ¨°Êï∞ start_period: 40s # v3.4 ‰ª•‰∏äÊñ∞Â¢ûÁöÑÈÄâÈ°π, ÂÆö‰πâÂÆπÂô®ÂêØÂä®Êó∂Èó¥Èó¥Èöî disable: true # true Êàñ false, Ë°®Á§∫ÊòØÂê¶Á¶ÅÁî®ÂÅ•Â∫∑Áä∂ÊÄÅÊ£ÄÊµãÂíå test: NONE Áõ∏Âêå image # ÊåáÂÆö docker ÈïúÂÉè, ÂèØ‰ª•ÊòØËøúÁ®ã‰ªìÂ∫ìÈïúÂÉè„ÄÅÊú¨Âú∞ÈïúÂÉè init # v3.7 ‰∏≠Êñ∞Â¢ûÁöÑÂèÇÊï∞, true Êàñ false Ë°®Á§∫ÊòØÂê¶Âú®ÂÆπÂô®‰∏≠ËøêË°å‰∏Ä‰∏™ init, ÂÆÉÊé•Êî∂‰ø°Âè∑Âπ∂‰º†ÈÄíÁªôËøõÁ®ã isolation # ÈöîÁ¶ªÂÆπÂô®ÊäÄÊúØ, Âú® Linux ‰∏≠‰ªÖÊîØÊåÅ default ÂÄº labels # ‰ΩøÁî® Docker Ê†áÁ≠æÂ∞ÜÂÖÉÊï∞ÊçÆÊ∑ªÂä†Âà∞ÂÆπÂô®, ‰∏é Dockerfile ‰∏≠ÁöÑ LABELS Á±ª‰ºº links # ÈìæÊé•Âà∞ÂÖ∂ÂÆÉÊúçÂä°‰∏≠ÁöÑÂÆπÂô®, ËØ•ÈÄâÈ°πÊòØ docker ÂéÜÂè≤ÈÅóÁïôÁöÑÈÄâÈ°π, ÁõÆÂâçÂ∑≤Ë¢´Áî®Êà∑Ëá™ÂÆö‰πâÁΩëÁªúÂêçÁß∞Á©∫Èó¥Âèñ‰ª£, ÊúÄÁªàÊúâÂèØËÉΩË¢´Â∫üÂºÉ (Âú®‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) logging # ËÆæÁΩÆÂÆπÂô®Êó•ÂøóÊúçÂä° driver # ÊåáÂÆöÊó•ÂøóËÆ∞ÂΩïÈ©±Âä®Á®ãÂ∫è, ÈªòËÆ§ json-file (Á≠âÂêå‰∫é docker run --log-driver ÁöÑ‰ΩúÁî®) options # ÊåáÂÆöÊó•ÂøóÁöÑÁõ∏ÂÖ≥ÂèÇÊï∞ (Á≠âÂêå‰∫é docker run --log-opt ÁöÑ‰ΩúÁî®) max-size # ËÆæÁΩÆÂçï‰∏™Êó•ÂøóÊñá‰ª∂ÁöÑÂ§ßÂ∞è, ÂΩìÂà∞ËææËøô‰∏™ÂÄºÂêé‰ºöËøõË°åÊó•ÂøóÊªöÂä®Êìç‰Ωú max-file # Êó•ÂøóÊñá‰ª∂‰øùÁïôÁöÑÊï∞Èáè network_mode # ÊåáÂÆöÁΩëÁªúÊ®°Âºè (Á≠âÂêå‰∫é docker run --net ÁöÑ‰ΩúÁî®, Âú®‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) networks # Â∞ÜÂÆπÂô®Âä†ÂÖ•ÊåáÂÆöÁΩëÁªú (Á≠âÂêå‰∫é docker network connect ÁöÑ‰ΩúÁî®), networks ÂèØ‰ª•‰Ωç‰∫é compose Êñá‰ª∂È°∂Á∫ßÈîÆÂíå services ÈîÆÁöÑ‰∫åÁ∫ßÈîÆ aliases # Âêå‰∏ÄÁΩëÁªú‰∏äÁöÑÂÆπÂô®ÂèØ‰ª•‰ΩøÁî®ÊúçÂä°ÂêçÁß∞ÊàñÂà´ÂêçËøûÊé•Âà∞ÂÖ∂‰∏≠‰∏Ä‰∏™ÊúçÂä°ÁöÑÂÆπÂô® ipv4_address # IP V4 Ê†ºÂºè ipv6_address # IP V6 Ê†ºÂºè Á§∫‰æã: version: &apos;3.7&apos; services: test: image: nginx:1.14-alpine container_name: mynginx command: ifconfig networks: app_net: # Ë∞ÉÁî®‰∏ãÈù¢ networks ÂÆö‰πâÁöÑ app_net ÁΩëÁªú ipv4_address: 172.16.238.10 networks: app_net: driver: bridge ipam: driver: default config: - subnet: 172.16.238.0/24 pid: &apos;host&apos; # ÂÖ±‰∫´ÂÆø‰∏ªÊú∫ÁöÑ ËøõÁ®ãÁ©∫Èó¥(PID) ports # Âª∫Á´ãÂÆø‰∏ªÊú∫ÂíåÂÆπÂô®‰πãÈó¥ÁöÑÁ´ØÂè£Êò†Â∞ÑÂÖ≥Á≥ª, ports ÊîØÊåÅ‰∏§ÁßçËØ≠Ê≥ïÊ†ºÂºè SHORT ËØ≠Ê≥ïÊ†ºÂºèÁ§∫‰æã: - &quot;3000&quot; # Êö¥Èú≤ÂÆπÂô®ÁöÑ 3000 Á´ØÂè£, ÂÆø‰∏ªÊú∫ÁöÑÁ´ØÂè£Áî± docker ÈöèÊú∫Êò†Â∞Ñ‰∏Ä‰∏™Ê≤°ÊúâË¢´Âç†Áî®ÁöÑÁ´ØÂè£ - &quot;3000-3005&quot; # Êö¥Èú≤ÂÆπÂô®ÁöÑ 3000 Âà∞ 3005 Á´ØÂè£, ÂÆø‰∏ªÊú∫ÁöÑÁ´ØÂè£Áî± docker ÈöèÊú∫Êò†Â∞ÑÊ≤°ÊúâË¢´Âç†Áî®ÁöÑÁ´ØÂè£ - &quot;8000:8000&quot; # ÂÆπÂô®ÁöÑ 8000 Á´ØÂè£ÂíåÂÆø‰∏ªÊú∫ÁöÑ 8000 Á´ØÂè£Âª∫Á´ãÊò†Â∞ÑÂÖ≥Á≥ª - &quot;9090-9091:8080-8081&quot; - &quot;127.0.0.1:8001:8001&quot; # ÊåáÂÆöÊò†Â∞ÑÂÆø‰∏ªÊú∫ÁöÑÊåáÂÆöÂú∞ÂùÄÁöÑ - &quot;127.0.0.1:5000-5010:5000-5010&quot; - &quot;6060:6060/udp&quot; # ÊåáÂÆöÂçèËÆÆ LONG ËØ≠Ê≥ïÊ†ºÂºèÁ§∫‰æã:(v3.2 Êñ∞Â¢ûÁöÑËØ≠Ê≥ïÊ†ºÂºè) ports: - target: 80 # ÂÆπÂô®Á´ØÂè£ published: 8080 # ÂÆø‰∏ªÊú∫Á´ØÂè£ protocol: tcp # ÂçèËÆÆÁ±ªÂûã mode: host # host Âú®ÊØè‰∏™ËäÇÁÇπ‰∏äÂèëÂ∏É‰∏ªÊú∫Á´ØÂè£, ingress ÂØπ‰∫éÁæ§Ê®°ÂºèÁ´ØÂè£ËøõË°åË¥üËΩΩÂùáË°° secrets # ‰∏çÁü•ÈÅìÊÄé‰πàÁî® security_opt # ‰∏∫ÊØè‰∏™ÂÆπÂô®Ë¶ÜÁõñÈªòËÆ§ÁöÑÊ†áÁ≠æ (Âú®‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) stop_grace_period # ÊåáÂÆöÂú®ÂèëÈÄÅ‰∫Ü SIGTERM ‰ø°Âè∑‰πãÂêé, ÂÆπÂô®Á≠âÂæÖÂ§öÂ∞ëÁßí‰πãÂêéÈÄÄÂá∫(ÈªòËÆ§ 10s) stop_signal # ÊåáÂÆöÂÅúÊ≠¢ÂÆπÂô®ÂèëÈÄÅÁöÑ‰ø°Âè∑ (ÈªòËÆ§‰∏∫ SIGTERM Áõ∏ÂΩì‰∫é kill PID; SIGKILL Áõ∏ÂΩì‰∫é kill -9 PID; Âú®‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) sysctls # ËÆæÁΩÆÂÆπÂô®‰∏≠ÁöÑÂÜÖÊ†∏ÂèÇÊï∞ (Âú®‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) ulimits # ËÆæÁΩÆÂÆπÂô®ÁöÑ limit userns_mode # Â¶ÇÊûúDockerÂÆàÊä§Á®ãÂ∫èÈÖçÁΩÆ‰∫ÜÁî®Êà∑ÂêçÁß∞Á©∫Èó¥, ÂàôÁ¶ÅÁî®Ê≠§ÊúçÂä°ÁöÑÁî®Êà∑ÂêçÁß∞Á©∫Èó¥ (Âú®‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π) volumes # ÂÆö‰πâÂÆπÂô®ÂíåÂÆø‰∏ªÊú∫ÁöÑÂç∑Êò†Â∞ÑÂÖ≥Á≥ª, ÂÖ∂Âíå networks ‰∏ÄÊ†∑ÂèØ‰ª•‰Ωç‰∫é services ÈîÆÁöÑ‰∫åÁ∫ßÈîÆÂíå compose È°∂Á∫ßÈîÆ, Â¶ÇÊûúÈúÄË¶ÅË∑®ÊúçÂä°Èó¥‰ΩøÁî®ÂàôÂú®È°∂Á∫ßÈîÆÂÆö‰πâ, Âú® services ‰∏≠ÂºïÁî® SHORT ËØ≠Ê≥ïÊ†ºÂºèÁ§∫‰æã: volumes: - /var/lib/mysql # Êò†Â∞ÑÂÆπÂô®ÂÜÖÁöÑ /var/lib/mysql Âà∞ÂÆø‰∏ªÊú∫ÁöÑ‰∏Ä‰∏™ÈöèÊú∫ÁõÆÂΩï‰∏≠ - /opt/data:/var/lib/mysql # Êò†Â∞ÑÂÆπÂô®ÂÜÖÁöÑ /var/lib/mysql Âà∞ÂÆø‰∏ªÊú∫ÁöÑ /opt/data - ./cache:/tmp/cache # Êò†Â∞ÑÂÆπÂô®ÂÜÖÁöÑ /var/lib/mysql Âà∞ÂÆø‰∏ªÊú∫ compose Êñá‰ª∂ÊâÄÂú®ÁöÑ‰ΩçÁΩÆ - ~/configs:/etc/configs/:ro # Êò†Â∞ÑÂÆπÂô®ÂÆø‰∏ªÊú∫ÁöÑÁõÆÂΩïÂà∞ÂÆπÂô®‰∏≠Âéª, ÊùÉÈôêÂè™ËØª - datavolume:/var/lib/mysql # datavolume ‰∏∫ volumes È°∂Á∫ßÈîÆÂÆö‰πâÁöÑÁõÆÂΩï, Âú®Ê≠§Â§ÑÁõ¥Êé•Ë∞ÉÁî® LONG ËØ≠Ê≥ïÊ†ºÂºèÁ§∫‰æã:(v3.2 Êñ∞Â¢ûÁöÑËØ≠Ê≥ïÊ†ºÂºè) version: &quot;3.2&quot; services: web: image: nginx:alpine ports: - &quot;80:80&quot; volumes: - type: volume # mount ÁöÑÁ±ªÂûã, ÂøÖÈ°ªÊòØ bind„ÄÅvolume Êàñ tmpfs source: mydata # ÂÆø‰∏ªÊú∫ÁõÆÂΩï target: /data # ÂÆπÂô®ÁõÆÂΩï volume: # ÈÖçÁΩÆÈ¢ùÂ§ñÁöÑÈÄâÈ°π, ÂÖ∂ key ÂøÖÈ°ªÂíå type ÁöÑÂÄºÁõ∏Âêå nocopy: true # volume È¢ùÂ§ñÁöÑÈÄâÈ°π, Âú®ÂàõÂª∫Âç∑Êó∂Á¶ÅÁî®‰ªéÂÆπÂô®Â§çÂà∂Êï∞ÊçÆ - type: bind # volume Ê®°ÂºèÂè™ÊåáÂÆöÂÆπÂô®Ë∑ØÂæÑÂç≥ÂèØ, ÂÆø‰∏ªÊú∫Ë∑ØÂæÑÈöèÊú∫ÁîüÊàê; bind ÈúÄË¶ÅÊåáÂÆöÂÆπÂô®ÂíåÊï∞ÊçÆÊú∫ÁöÑÊò†Â∞ÑË∑ØÂæÑ source: ./static target: /opt/app/static read_only: true # ËÆæÁΩÆÊñá‰ª∂Á≥ªÁªü‰∏∫Âè™ËØªÊñá‰ª∂Á≥ªÁªü volumes: mydata: # ÂÆö‰πâÂú® volume, ÂèØÂú®ÊâÄÊúâÊúçÂä°‰∏≠Ë∞ÉÁî® restart # ÂÆö‰πâÂÆπÂô®ÈáçÂêØÁ≠ñÁï•(Âú®‰ΩøÁî® swarm ÈÉ®ÁΩ≤Êó∂Â∞ÜÂøΩÁï•ËØ•ÈÄâÈ°π, Âú® swarm ‰ΩøÁî® restart_policy ‰ª£Êõø restart) no # Á¶ÅÊ≠¢Ëá™Âä®ÈáçÂêØÂÆπÂô®(ÈªòËÆ§) always # Êó†ËÆ∫Â¶Ç‰ΩïÂÆπÂô®ÈÉΩ‰ºöÈáçÂêØ on-failure # ÂΩìÂá∫Áé∞ on-failure Êä•ÈîôÊó∂, ÂÆπÂô®ÈáçÊñ∞ÂêØÂä® ÂÖ∂‰ªñÈÄâÈ°πÔºö domainname, hostname, ipc, mac_address, privileged, read_only, shm_size, stdin_open, tty, user, working_dir ‰∏äÈù¢Ëøô‰∫õÈÄâÈ°πÈÉΩÂè™Êé•ÂèóÂçï‰∏™ÂÄºÂíå docker run ÁöÑÂØπÂ∫îÂèÇÊï∞Á±ª‰ºº ÂØπ‰∫éÂÄº‰∏∫Êó∂Èó¥ÁöÑÂèØÊé•ÂèóÁöÑÂÄºÔºö 2.5s 10s 1m30s 2h32m 5h34m56s Êó∂Èó¥Âçï‰Ωç: us, ms, s, mÔºå h ÂØπ‰∫éÂÄº‰∏∫Â§ßÂ∞èÁöÑÂèØÊé•ÂèóÁöÑÂÄºÔºö 2b 1024kb 2048k 300m 1gb Âçï‰Ωç: b, k, m, g ÊàñËÄÖ kb, mb, gb networks # ÂÆö‰πâ networks ‰ø°ÊÅØ driver # ÊåáÂÆöÁΩëÁªúÊ®°Âºè, Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ã, ÂÆÉ bridge ‰∫éÂçï‰∏™‰∏ªÊú∫Âíå overlay Swarm ‰∏ä bridge # Docker ÈªòËÆ§‰ΩøÁî® bridge ËøûÊé•Âçï‰∏™‰∏ªÊú∫‰∏äÁöÑÁΩëÁªú overlay # overlay È©±Âä®Á®ãÂ∫èÂàõÂª∫‰∏Ä‰∏™Ë∑®Â§ö‰∏™ËäÇÁÇπÂëΩÂêçÁöÑÁΩëÁªú host # ÂÖ±‰∫´‰∏ªÊú∫ÁΩëÁªúÂêçÁß∞Á©∫Èó¥(Á≠âÂêå‰∫é docker run --net=host) none # Á≠âÂêå‰∫é docker run --net=none driver_opts # v3.2‰ª•‰∏äÁâàÊú¨, ‰º†ÈÄíÁªôÈ©±Âä®Á®ãÂ∫èÁöÑÂèÇÊï∞, Ëøô‰∫õÂèÇÊï∞ÂèñÂÜ≥‰∫éÈ©±Âä®Á®ãÂ∫è attachable # driver ‰∏∫ overlay Êó∂‰ΩøÁî®, Â¶ÇÊûúËÆæÁΩÆ‰∏∫ true ÂàôÈô§‰∫ÜÊúçÂä°‰πãÂ§ñÔºåÁã¨Á´ãÂÆπÂô®‰πüÂèØ‰ª•ÈôÑÂä†Âà∞ËØ•ÁΩëÁªú; Â¶ÇÊûúÁã¨Á´ãÂÆπÂô®ËøûÊé•Âà∞ËØ•ÁΩëÁªúÔºåÂàôÂÆÉÂèØ‰ª•‰∏éÂÖ∂‰ªñ Docker ÂÆàÊä§ËøõÁ®ãËøûÊé•Âà∞ÁöÑËØ•ÁΩëÁªúÁöÑÊúçÂä°ÂíåÁã¨Á´ãÂÆπÂô®ËøõË°åÈÄö‰ø° ipam # Ëá™ÂÆö‰πâ IPAM ÈÖçÁΩÆ. ËøôÊòØ‰∏Ä‰∏™ÂÖ∑ÊúâÂ§ö‰∏™Â±ûÊÄßÁöÑÂØπË±°, ÊØè‰∏™Â±ûÊÄßÈÉΩÊòØÂèØÈÄâÁöÑ driver # IPAM È©±Âä®Á®ãÂ∫è, bridge ÊàñËÄÖ default config # ÈÖçÁΩÆÈ°π subnet # CIDRÊ†ºÂºèÁöÑÂ≠êÁΩëÔºåË°®Á§∫ËØ•ÁΩëÁªúÁöÑÁΩëÊÆµ external # Â§ñÈÉ®ÁΩëÁªú, Â¶ÇÊûúËÆæÁΩÆ‰∏∫ true Âàô docker-compose up ‰∏ç‰ºöÂ∞ùËØïÂàõÂª∫ÂÆÉ, Â¶ÇÊûúÂÆÉ‰∏çÂ≠òÂú®ÂàôÂºïÂèëÈîôËØØ name # v3.5 ‰ª•‰∏äÁâàÊú¨, ‰∏∫Ê≠§ÁΩëÁªúËÆæÁΩÆÂêçÁß∞Êñá‰ª∂Ê†ºÂºèÁ§∫‰æãÔºö version: &quot;3&quot; services: redis: image: redis:alpine ports: - &quot;6379&quot; networks: - frontend deploy: replicas: 2 update_config: parallelism: 2 delay: 10s restart_policy: condition: on-failure db: image: postgres:9.4 volumes: - db-data:/var/lib/postgresql/data networks: - backend deploy: placement: constraints: [node.role == manager]]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python withÁöÑÂéüÁêÜÂèäÂú®ÂºÇÂ∏∏Â§ÑÁêÜ‰∏≠ÁöÑÂ∫îÁî®]]></title>
    <url>%2F2019%2F09%2F11%2Fpython-with%E7%9A%84%E5%8E%9F%E7%90%86%E5%8F%8A%E5%9C%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Âè™Ë¶ÅÂØπË±°ÂÜÖÂÆûÁé∞ enter() Âíå exit() ÊñπÊ≥ïÔºåÂ∞±ËÉΩÂÖºÂÆπ with ËØ≠Âè•ÔºåËß¶Âèë‰∏ä‰∏ãÊñáÁÆ°ÁêÜ„ÄÇ ‰∏Ä„ÄÅ‰∏ä‰∏ãÊñáÁÆ°ÁêÜÁöÑÁÆÄÂçïÊâßË°åÊµÅÁ®ãwith Â∑•‰ΩúÂéüÁêÜ ÔºàÔºëÔºâÁ¥ßË∑üwithÂêéÈù¢ÁöÑËØ≠Âè•Ë¢´Ê±ÇÂÄºÂêéÔºåËøîÂõûÂØπË±°ÁöÑ‚Äúenter()‚ÄùÊñπÊ≥ïË¢´Ë∞ÉÁî®ÔºåËøô‰∏™ÊñπÊ≥ïÁöÑËøîÂõûÂÄºÂ∞ÜË¢´ËµãÂÄºÁªôasÂêéÈù¢ÁöÑÂèòÈáèÔºõ ÔºàÔºíÔºâÂΩìwithÂêéÈù¢ÁöÑ‰ª£Á†ÅÂùóÂÖ®ÈÉ®Ë¢´ÊâßË°åÂÆå‰πãÂêéÔºåÂ∞ÜË∞ÉÁî®ÂâçÈù¢ËøîÂõûÂØπË±°ÁöÑ‚Äúexit()‚ÄùÊñπÊ≥ï„ÄÇ class Sample: def enter(self): print ‚Äúin enter‚Äú return ‚ÄúFoo‚Äù def exit(self, exc_type, exc_val, exc_tb): ‚Äò‚Äô‚Äô Ëã•Âú®ÊâßË°åÊµÅÁ®ã‰∏≠Âõ†‰∏∫ÈîôËØØËÄåÈÄÄÂá∫ÔºåË∞ÉÁî®exitÊó∂Ôºå‰ºöËá™Âä®ÊçïËé∑ÈîôËØØ‰ø°ÊÅØ exc_typeÔºö ÈîôËØØÁöÑÁ±ªÂûã(ÂºÇÂ∏∏Á±ªÂûã) exc_valÔºö ÈîôËØØÁ±ªÂûãÂØπÂ∫îÁöÑÂÄº (ÂºÇÂ∏∏ÂÄº) exc_tbÔºö ‰ª£Á†Å‰∏≠ÈîôËØØÂèëÁîüÁöÑ‰ΩçÁΩÆ (ÈîôËØØÊ†à) ‚Äò‚Äô‚Äô print ‚Äúin exit‚Äú def get_sample(): return Sample() with get_sample() as sample: print ‚ÄúSample: ‚Äú, sample‚Äò‚Äô‚ÄôÊµÅÁ®ãÊÄªÁªìÔºö1- ÊâßË°åget_sample()ÂáΩÊï∞2- ÂáΩÊï∞ÂÜÖÂÆû‰æãÂåñSampleÂØπË±°ÔºåÊâßË°åenterËøîÂõûÂ≠óÁ¨¶‰∏≤Ëµã‰∫àsampleÂèòÈáè3- ÊâßË°åwithÂÜÖÁöÑ‰ª£Á†ÅÂùóÔºåËæìÂá∫sampleÂèòÈáèÂÄº4- ÊâßË°åSampleÂØπË±°ÂÜÖÁöÑexitÊñπÊ≥ï‚Äò‚Äô‚Äô‰∫å„ÄÅÈîôËØØÊâßË°åÊµÅÁ®ãclass Sample(): def enter(self): print(‚Äòin enter‚Äô) return self def __exit__(self, exc_type, exc_val, exc_tb): print &quot;type: &quot;, exc_type print &quot;val: &quot;, exc_val print &quot;tb: &quot;, exc_tb def do_something(self): bar = 1 / 0 return bar + 10 with Sample() as sample: sample.do_something() ‚Äò‚Äô‚Äôin enterTraceback (most recent call last):type: val: integer division or modulo by zero File ‚Äú/home/user/cltdevelop/Code/TF_Practice_2017_06_06/with_test.py‚Äù, line 36, in tb: sample.do_something() File ‚Äú/home/user/cltdevelop/Code/TF_Practice_2017_06_06/with_test.py‚Äù, line 32, in do_something bar = 1 / 0ZeroDivisionError: integer division or modulo by zero Process finished with exit code 1 ‚Äò‚Äô‚Äô‰∏â„ÄÅÂºÇÂ∏∏Â§ÑÁêÜ with Â∫îÁî®ÂºÇÂ∏∏Â§ÑÁêÜÈÄªËæëÂ§™Â§öÔºå‰ª•Ëá≥‰∫éÊâ∞‰π±‰∫Ü‰ª£Á†ÅÊ†∏ÂøÉÈÄªËæë„ÄÇÂÖ∑‰ΩìË°®Áé∞Â∞±ÊòØÔºå‰ª£Á†ÅÈáåÂÖÖÊñ•ÁùÄÂ§ßÈáèÁöÑ try„ÄÅexcept„ÄÅraise ËØ≠Âè•ÔºåËÆ©Ê†∏ÂøÉÈÄªËæëÂèòÂæóÈöæ‰ª•Ëæ®ËØÜ„ÄÇ def upload_avatar(request): ‚Äú‚Äù‚ÄùÁî®Êà∑‰∏ä‰º†Êñ∞Â§¥ÂÉè‚Äù‚Äù‚Äù try: avatar_file = request.FILES[‚Äòavatar‚Äô] except KeyError: raise error_codes.AVATAR_FILE_NOT_PROVIDED try: resized_avatar_file = resize_avatar(avatar_file) except FileTooLargeError as e: raise error_codes.AVATAR_FILE_TOO_LARGE except ResizeAvatarError as e: raise error_codes.AVATAR_FILE_INVALID try: request.user.avatar = resized_avatar_file request.user.save() except Exception: raise error_codes.INTERNAL_SERVER_ERROR return HttpResponse({}) ËøôÊòØ‰∏Ä‰∏™Â§ÑÁêÜÁî®Êà∑‰∏ä‰º†Â§¥ÂÉèÁöÑËßÜÂõæÂáΩÊï∞„ÄÇËøô‰∏™ÂáΩÊï∞ÂÜÖÂÅö‰∫Ü‰∏â‰ª∂‰∫ãÊÉÖÔºåÂπ∂‰∏îÈíàÂØπÊØè‰ª∂‰∫ãÈÉΩÂÅö‰∫ÜÂºÇÂ∏∏ÊçïËé∑„ÄÇÂ¶ÇÊûúÂÅöÊüê‰ª∂‰∫ãÊó∂ÂèëÁîü‰∫ÜÂºÇÂ∏∏ÔºåÂ∞±ËøîÂõûÂØπÁî®Êà∑ÂèãÂ•ΩÁöÑÈîôËØØÂà∞ÂâçÁ´Ø„ÄÇ ËøôÊ†∑ÁöÑÂ§ÑÁêÜÊµÅÁ®ãÁ∫µÁÑ∂ÂêàÁêÜÔºå‰ΩÜÊòØÊòæÁÑ∂‰ª£Á†ÅÈáåÁöÑÂºÇÂ∏∏Â§ÑÁêÜÈÄªËæëÊúâÁÇπ‚ÄúÂñßÂÆæÂ§∫‰∏ª‚Äù‰∫Ü„ÄÇ‰∏ÄÁúºÁúãËøáÂéªÂÖ®ÊòØ‰ª£Á†ÅÁº©ËøõÔºåÂæàÈöæÊèêÁÇºÂá∫‰ª£Á†ÅÁöÑÊ†∏ÂøÉÈÄªËæë„ÄÇ Êó©Âú® 2.5 ÁâàÊú¨Êó∂ÔºåPython ËØ≠Ë®ÄÂ∞±Â∑≤ÁªèÊèê‰æõ‰∫ÜÂØπ‰ªòËøôÁ±ªÂú∫ÊôØÁöÑÂ∑•ÂÖ∑Ôºö‚Äú‰∏ä‰∏ãÊñáÁÆ°ÁêÜÂô®Ôºàcontext managerÔºâ‚Äù„ÄÇ‰∏ä‰∏ãÊñáÁÆ°ÁêÜÂô®ÊòØ‰∏ÄÁßçÈÖçÂêà with ËØ≠Âè•‰ΩøÁî®ÁöÑÁâπÊÆä Python ÂØπË±°ÔºåÈÄöËøáÂÆÉÔºåÂèØ‰ª•ËÆ©ÂºÇÂ∏∏Â§ÑÁêÜÂ∑•‰ΩúÂèòÂæóÊõ¥Êñπ‰æø„ÄÇ class raise_api_error: ‚Äú‚Äù‚Äù captures specified exception and raise ApiErrorCode instead ÊçïËé∑ÊåáÂÆöÁöÑÂºÇÂ∏∏Âπ∂Êîπ‰∏∫ÂºïÂèëApiErrorCode :raises: AttributeError if code_name is not valid ‚Äú‚Äù‚Äù def init(self, captures, code_name): self.captures = captures self.code = getattr(error_codes, code_name) def __enter__(self): # ÂàöÊñπÊ≥ïÂ∞ÜÂú®ËøõÂÖ•‰∏ä‰∏ãÊñáÊó∂Ë∞ÉÁî® return self def __exit__(self, exc_type, exc_val, exc_tb): # ËØ•ÊñπÊ≥ïÂ∞ÜÂú®ÈÄÄÂá∫‰∏ä‰∏ãÊñáÊó∂Ë∞ÉÁî® # exc_type, exc_val, exc_tb ÂàÜÂà´Ë°®Á§∫ËØ•‰∏ä‰∏ãÊñáÂÜÖÊäõÂá∫ÁöÑ # ÂºÇÂ∏∏Á±ªÂûã„ÄÅÂºÇÂ∏∏ÂÄº„ÄÅÈîôËØØÊ†à if exc_type is None: return False if exc_type == self.captures: raise self.code from exc_val return False Âú®‰∏äÈù¢ÁöÑ‰ª£Á†ÅÈáåÔºåÊàë‰ª¨ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ raise_api_error ÁöÑ‰∏ä‰∏ãÊñáÁÆ°ÁêÜÂô®ÔºåÂÆÉÂú®ËøõÂÖ•‰∏ä‰∏ãÊñáÊó∂‰ªÄ‰πà‰πü‰∏çÂÅö„ÄÇ‰ΩÜÊòØÂú®ÈÄÄÂá∫‰∏ä‰∏ãÊñáÊó∂Ôºå‰ºöÂà§Êñ≠ÂΩìÂâç‰∏ä‰∏ãÊñá‰∏≠ÊòØÂê¶ÊäõÂá∫‰∫ÜÁ±ªÂûã‰∏∫ self.captures ÁöÑÂºÇÂ∏∏ÔºåÂ¶ÇÊûúÊúâÔºåÂ∞±Áî® APIErrorCode ÂºÇÂ∏∏Á±ªÊõø‰ª£ÂÆÉ„ÄÇ ‰ΩøÁî®ËØ•‰∏ä‰∏ãÊñáÁÆ°ÁêÜÂô®ÂêéÔºåÊï¥‰∏™ÂáΩÊï∞ÂèØ‰ª•ÂèòÂæóÊõ¥Ê∏ÖÊô∞ÁÆÄÊ¥ÅÔºö def upload_avatar(request): ‚Äú‚Äù‚ÄùÁî®Êà∑‰∏ä‰º†Êñ∞Â§¥ÂÉè‚Äù‚Äù‚Äù with raise_api_error(KeyError, ‚ÄòAVATAR_FILE_NOT_PROVIDED‚Äô): avatar_file = request.FILES[‚Äòavatar‚Äô] with raise_api_error(ResizeAvatarError, &apos;AVATAR_FILE_INVALID&apos;),\ raise_api_error(FileTooLargeError, &apos;AVATAR_FILE_TOO_LARGE&apos;): resized_avatar_file = resize_avatar(avatar_file) with raise_api_error(Exception, &apos;INTERNAL_SERVER_ERROR&apos;): request.user.avatar = resized_avatar_file request.user.save() return HttpResponse({}) Âõõ„ÄÅraies Âíå raise‚Ä¶‚Ä¶from ÁöÑÂå∫Âà´ try:‚Ä¶ print(1 / 0)‚Ä¶ except:‚Ä¶ raise RuntimeError(‚ÄúSomething bad happened‚Äù)‚Ä¶ Traceback (most recent call last): File ‚Äú‚Äú, line 2, in ZeroDivisionError: division by zero Âú®Â§ÑÁêÜ‰∏äËø∞ÂºÇÂ∏∏ÊúüÈó¥ÔºåÂèëÁîü‰∫ÜÂè¶‰∏Ä‰∏™ÂºÇÂ∏∏ÔºöDuring handling of the above exception, another exception occurred: Traceback (most recent call last): File ‚Äú‚Äú, line 4, in RuntimeError: Something bad happened try:‚Ä¶ print(1 / 0)‚Ä¶ except Exception as exc:‚Ä¶ raise RuntimeError(‚ÄúSomething bad happened‚Äù) from exc‚Ä¶ Traceback (most recent call last): File ‚Äú‚Äú, line 2, in ZeroDivisionError: division by zero ‰∏äËø∞ÂºÇÂ∏∏ÊòØ‰ª•‰∏ãÂºÇÂ∏∏ÁöÑÁõ¥Êé•ÂéüÂõ†ÔºöThe above exception was the direct cause of the following exception: Traceback (most recent call last): File ‚Äú‚Äú, line 4, in RuntimeError: Something bad happened‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÔºåfrom ‰ºö‰∏∫ÂºÇÂ∏∏ÂØπË±°ËÆæÁΩÆ cause Â±ûÊÄßË°®ÊòéÂºÇÂ∏∏ÁöÑÊòØÁî±Ë∞ÅÁõ¥Êé•ÂºïËµ∑ÁöÑ„ÄÇ Â§ÑÁêÜÂºÇÂ∏∏Êó∂ÂèëÁîü‰∫ÜÊñ∞ÁöÑÂºÇÂ∏∏ÔºåÂú®‰∏ç‰ΩøÁî® from Êó∂Êõ¥ÂÄæÂêë‰∫éÊñ∞ÂºÇÂ∏∏‰∏éÊ≠£Âú®Â§ÑÁêÜÁöÑÂºÇÂ∏∏Ê≤°ÊúâÂÖ≥ËÅî„ÄÇËÄå from ÂàôÊòØËÉΩÊåáÂá∫Êñ∞ÂºÇÂ∏∏ÊòØÂõ†ÊóßÂºÇÂ∏∏Áõ¥Êé•ÂºïËµ∑ÁöÑ„ÄÇËøôÊ†∑ÁöÑÂºÇÂ∏∏‰πãÈó¥ÁöÑÂÖ≥ËÅîÊúâÂä©‰∫éÂêéÁª≠ÂØπÂºÇÂ∏∏ÁöÑÂàÜÊûêÂíåÊéíÊü•„ÄÇfrom ËØ≠Ê≥ï‰ºöÊúâ‰∏™ÈôêÂà∂ÔºåÂ∞±ÊòØÁ¨¨‰∫å‰∏™Ë°®ËææÂºèÂøÖÈ°ªÊòØÂè¶‰∏Ä‰∏™ÂºÇÂ∏∏Á±ªÊàñÂÆû‰æã„ÄÇ Â¶ÇÊûúÂú®ÂºÇÂ∏∏Â§ÑÁêÜÁ®ãÂ∫èÊàñ finally Âùó‰∏≠ÂºïÂèëÂºÇÂ∏∏ÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂºÇÂ∏∏Êú∫Âà∂‰ºöÈöêÂºèÂ∑•‰Ωú‰ºöÂ∞ÜÂÖàÂâçÁöÑÂºÇÂ∏∏ÈôÑÂä†‰∏∫Êñ∞ÂºÇÂ∏∏ÁöÑ _context _Â±ûÊÄß„ÄÇ ÂΩìÁÑ∂Ôºå‰πüÂèØ‰ª•ÈÄöËøá with_traceback() ÊñπÊ≥ï‰∏∫ÂºÇÂ∏∏ËÆæÁΩÆ‰∏ä‰∏ãÊñá context Â±ûÊÄßÔºåËøô‰πüËÉΩÂú® traceback Êõ¥Â•ΩÁöÑÊòæÁ§∫ÂºÇÂ∏∏‰ø°ÊÅØ„ÄÇ]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TCP/IPËØ¶Ëß£--TCPËøûÊé•‰∏≠time_waitÁä∂ÊÄÅËøáÂ§ö]]></title>
    <url>%2F2019%2F09%2F10%2FTCP-IP%E8%AF%A6%E8%A7%A3-TCP%E8%BF%9E%E6%8E%A5%E4%B8%ADtime-wait%E7%8A%B6%E6%80%81%E8%BF%87%E5%A4%9A%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáÈìæÊé•Ôºöhttps://blog.csdn.net/yusiguyuan/article/details/21445883TIMEWAITÁä∂ÊÄÅÊú¨Ë∫´ÂíåÂ∫îÁî®Â±ÇÁöÑÂÆ¢Êà∑Á´ØÊàñËÄÖÊúçÂä°Âô®ÊòØÊ≤°ÊúâÂÖ≥Á≥ªÁöÑ„ÄÇ‰ªÖ‰ªÖÊòØ‰∏ªÂä®ÂÖ≥Èó≠ÁöÑ‰∏ÄÊñπÔºåÂú®‰ΩøÁî®FIN|ACK|FIN|ACKÂõõÂàÜÁªÑÊ≠£Â∏∏ÂÖ≥Èó≠TCPËøûÊé•ÁöÑÊó∂ÂÄô‰ºöÂá∫Áé∞Ëøô‰∏™TIMEWAIT„ÄÇÊúçÂä°Âô®Âú®Â§ÑÁêÜÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûú‰Ω†ÁöÑÁ®ãÂ∫èËÆæËÆ°‰∏∫ÊúçÂä°Âô®‰∏ªÂä®ÂÖ≥Èó≠ÔºåÈÇ£‰πà‰Ω†ÊâçÊúâÂèØËÉΩÈúÄË¶ÅÂÖ≥Ê≥®Ëøô‰∏™TIMEWAITÁä∂ÊÄÅËøáÂ§öÁöÑÈóÆÈ¢ò„ÄÇÂ¶ÇÊûú‰Ω†ÁöÑÊúçÂä°Âô®ËÆæËÆ°‰∏∫Ë¢´Âä®ÂÖ≥Èó≠ÔºåÈÇ£‰πà‰Ω†È¶ñÂÖàË¶ÅÂÖ≥Ê≥®ÁöÑÊòØCLOSE_WAIT„ÄÇ ÂéüÂàôTIMEWAITÂπ∂‰∏çÊòØÂ§ö‰ΩôÁöÑ„ÄÇÂú®TCPÂçèËÆÆË¢´ÂàõÈÄ†ÔºåÁªèÂéÜ‰∫ÜÂ§ßÈáèÁöÑÂÆûÈôÖÂú∫ÊôØÂÆûË∑µ‰πãÂêéÔºåTIMEWAITÂá∫Áé∞‰∫ÜÔºåÂõ†‰∏∫TCP‰∏ªÂä®ÂÖ≥Èó≠ËøûÊé•ÁöÑ‰∏ÄÊñπÈúÄË¶ÅTIMEWAITÁä∂ÊÄÅÔºåÂÆÉÊòØÊàë‰ª¨ÁöÑÊúãÂèã„ÄÇËøôÊòØ„ÄäUNIXÁΩëÁªúÁºñÁ®ã„ÄãÁöÑ‰ΩúËÄÖ‚Äî-StevenÂØπTIMEWAITÁöÑÊÄÅÂ∫¶„ÄÇ TIMEWAITÊòØÂèãÂ•ΩÁöÑ TCPË¶Å‰øùËØÅÂú®ÊâÄÊúâÂèØËÉΩÁöÑÊÉÖÂÜµ‰∏ã‰ΩøÂæóÊâÄÊúâÁöÑÊï∞ÊçÆÈÉΩËÉΩÂ§üË¢´Ê≠£Á°ÆÈÄÅËææ„ÄÇÂΩì‰Ω†ÂÖ≥Èó≠‰∏Ä‰∏™socketÊó∂Ôºå‰∏ªÂä®ÂÖ≥Èó≠‰∏ÄÁ´ØÁöÑsocketÂ∞ÜËøõÂÖ•TIME_WAITÁä∂ÊÄÅÔºåËÄåË¢´Âä®ÂÖ≥Èó≠‰∏ÄÊñπÂàôËΩ¨ÂÖ•CLOSEDÁä∂ÊÄÅÔºåËøôÁöÑÁ°ÆËÉΩÂ§ü‰øùËØÅÊâÄÊúâÁöÑÊï∞ÊçÆÈÉΩË¢´‰º†Ëæì„ÄÇÂΩì‰∏Ä‰∏™socketÂÖ≥Èó≠ÁöÑÊó∂ÂÄôÔºåÊòØÈÄöËøá‰∏§Á´ØÂõõÊ¨°Êè°ÊâãÂÆåÊàêÁöÑÔºåÂΩì‰∏ÄÁ´ØË∞ÉÁî®close()Êó∂ÔºåÂ∞±ËØ¥ÊòéÊú¨Á´ØÊ≤°ÊúâÊï∞ÊçÆË¶ÅÂèëÈÄÅ‰∫Ü„ÄÇËøôÂ•Ω‰ººÁúãÊù•Âú®Êè°ÊâãÂÆåÊàê‰ª•ÂêéÔºåsocketÂ∞±ÈÉΩÂèØ‰ª•Â§Ñ‰∫éÂàùÂßãÁöÑCLOSEDÁä∂ÊÄÅ‰∫ÜÔºåÂÖ∂ÂÆû‰∏çÁÑ∂„ÄÇÂéüÂõ†ÊòØËøôÊ†∑ÂÆâÊéíÁä∂ÊÄÅÊúâ‰∏§‰∏™ÈóÆÈ¢òÔºå È¶ñÂÖàÔºåÊàë‰ª¨Ê≤°Êúâ‰ªª‰ΩïÊú∫Âà∂‰øùËØÅÊúÄÂêéÁöÑ‰∏Ä‰∏™ACKËÉΩÂ§üÊ≠£Â∏∏‰º†ËæìÔºåÁ¨¨‰∫åÔºåÁΩëÁªú‰∏ä‰ªçÁÑ∂ÊúâÂèØËÉΩÊúâÊÆã‰ΩôÁöÑÊï∞ÊçÆÂåÖ(wandering duplicates)ÔºåÊàë‰ª¨‰πüÂøÖÈ°ªËÉΩÂ§üÊ≠£Â∏∏Â§ÑÁêÜ„ÄÇTIMEWAITÂ∞±ÊòØ‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏§‰∏™ÈóÆÈ¢òËÄåÁîüÁöÑ„ÄÇ1.ÂÅáËÆæÊúÄÂêé‰∏Ä‰∏™ACK‰∏¢Â§±‰∫ÜÔºåË¢´Âä®ÂÖ≥Èó≠‰∏ÄÊñπ‰ºöÈáçÂèëÂÆÉÁöÑFIN„ÄÇ‰∏ªÂä®ÂÖ≥Èó≠‰∏ÄÊñπÂøÖÈ°ªÁª¥ÊåÅ‰∏Ä‰∏™ÊúâÊïàÁä∂ÊÄÅ‰ø°ÊÅØÔºàTIMEWAITÁä∂ÊÄÅ‰∏ãÁª¥ÊåÅÔºâÔºå‰ª•‰æøËÉΩÂ§üÈáçÂèëACK„ÄÇÂ¶ÇÊûú‰∏ªÂä®ÂÖ≥Èó≠ÁöÑsocket‰∏çÁª¥ÊåÅËøôÁßçÁä∂ÊÄÅËÄåËøõÂÖ•CLOSEDÁä∂ÊÄÅÔºåÈÇ£‰πà‰∏ªÂä®ÂÖ≥Èó≠ÁöÑsocketÂú®Â§Ñ‰∫éCLOSEDÁä∂ÊÄÅÊó∂ÔºåÊé•Êî∂Âà∞FINÂêéÂ∞Ü‰ºöÂìçÂ∫î‰∏Ä‰∏™RST„ÄÇË¢´Âä®ÂÖ≥Èó≠‰∏ÄÊñπÊé•Êî∂Âà∞RSTÂêé‰ºöËÆ§‰∏∫Âá∫Èîô‰∫Ü„ÄÇÂ¶ÇÊûúTCPÂçèËÆÆÊÉ≥Ë¶ÅÊ≠£Â∏∏ÂÆåÊàêÂøÖË¶ÅÁöÑÊìç‰ΩúËÄåÁªàÊ≠¢ÂèåÊñπÁöÑÊï∞ÊçÆÊµÅ‰º†ËæìÔºåÂ∞±ÂøÖÈ°ªÂÆåÂÖ®Ê≠£Á°ÆÁöÑ‰º†ËæìÂõõÊ¨°Êè°ÊâãÁöÑÂõõ‰∏™ËäÇÔºå‰∏çËÉΩÊúâ‰ªª‰ΩïÁöÑ‰∏¢Â§±„ÄÇËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàsocketÂú®ÂÖ≥Èó≠ÂêéÔºå‰ªçÁÑ∂Â§Ñ‰∫éTIME_WAITÁä∂ÊÄÅÁöÑÁ¨¨‰∏Ä‰∏™ÂéüÂõ†ÔºåÂõ†‰∏∫‰ªñË¶ÅÁ≠âÂæÖ‰ª•‰æøÈáçÂèëACK„ÄÇ 2.ÂÅáËÆæÁõÆÂâçËøûÊé•ÁöÑÈÄö‰ø°ÂèåÊñπÈÉΩÂ∑≤ÁªèË∞ÉÁî®‰∫Üclose()ÔºåÂèåÊñπÂêåÊó∂ËøõÂÖ•CLOSEDÁöÑÁªàÁªìÁä∂ÊÄÅÔºåËÄåÊ≤°ÊúâËµ∞TIME_WAITÁä∂ÊÄÅ„ÄÇ‰ºöÂá∫Áé∞Â¶Ç‰∏ãÈóÆÈ¢òÔºåÁé∞Âú®Êúâ‰∏Ä‰∏™Êñ∞ÁöÑËøûÊé•Ë¢´Âª∫Á´ãËµ∑Êù•Ôºå‰ΩøÁî®ÁöÑIPÂú∞ÂùÄ‰∏éÁ´ØÂè£‰∏éÂÖàÂâçÁöÑÂÆåÂÖ®Áõ∏ÂêåÔºåÂêéÂª∫Á´ãÁöÑËøûÊé•ÊòØÂéüÂÖàËøûÊé•ÁöÑ‰∏Ä‰∏™ÂÆåÂÖ®Â§çÁî®„ÄÇËøòÂÅáÂÆöÂéüÂÖàÁöÑËøûÊé•‰∏≠ÊúâÊï∞ÊçÆÊä•ÊÆãÂ≠ò‰∫éÁΩëÁªú‰πã‰∏≠ÔºåËøôÊ†∑Êñ∞ÁöÑËøûÊé•Êî∂Âà∞ÁöÑÊï∞ÊçÆÊä•‰∏≠ÊúâÂèØËÉΩÊòØÂÖàÂâçËøûÊé•ÁöÑÊï∞ÊçÆÊä•„ÄÇ‰∏∫‰∫ÜÈò≤Ê≠¢Ëøô‰∏ÄÁÇπÔºåTCP‰∏çÂÖÅËÆ∏Êñ∞ËøûÊé•Â§çÁî®TIME_WAITÁä∂ÊÄÅ‰∏ãÁöÑsocket„ÄÇÂ§Ñ‰∫éTIME_WAITÁä∂ÊÄÅÁöÑsocketÂú®Á≠âÂæÖ‰∏§ÂÄçÁöÑMSLÊó∂Èó¥‰ª•ÂêéÔºà‰πãÊâÄ‰ª•ÊòØ‰∏§ÂÄçÁöÑMSLÔºåÊòØÁî±‰∫éMSLÊòØ‰∏Ä‰∏™Êï∞ÊçÆÊä•Âú®ÁΩëÁªú‰∏≠ÂçïÂêëÂèëÂá∫Âà∞ËÆ§ÂÆö‰∏¢Â§±ÁöÑÊó∂Èó¥Ôºå‰∏Ä‰∏™Êï∞ÊçÆÊä•ÊúâÂèØËÉΩÂú®ÂèëÈÄÅÈÄî‰∏≠ÊàñÊòØÂÖ∂ÂìçÂ∫îËøáÁ®ã‰∏≠Êàê‰∏∫ÊÆã‰ΩôÊï∞ÊçÆÊä•ÔºåÁ°ÆËÆ§‰∏Ä‰∏™Êï∞ÊçÆÊä•ÂèäÂÖ∂ÂìçÂ∫îÁöÑ‰∏¢ÂºÉÁöÑÈúÄË¶Å‰∏§ÂÄçÁöÑMSLÔºâÔºåÂ∞Ü‰ºöËΩ¨Âèò‰∏∫CLOSEDÁä∂ÊÄÅ„ÄÇËøôÂ∞±ÊÑèÂë≥ÁùÄÔºå‰∏Ä‰∏™ÊàêÂäüÂª∫Á´ãÁöÑËøûÊé•ÔºåÂøÖÁÑ∂‰ΩøÂæóÂÖàÂâçÁΩëÁªú‰∏≠ÊÆã‰ΩôÁöÑÊï∞ÊçÆÊä•ÈÉΩ‰∏¢Â§±‰∫Ü„ÄÇ Â§ßÈáèTIMEWAITÂú®Êüê‰∫õÂú∫ÊôØ‰∏≠ÂØºËá¥ÁöÑ‰ª§‰∫∫Â§¥ÁñºÁöÑ‰∏öÂä°ÈóÆÈ¢òÂ§ßÈáèTIMEWAITÂá∫Áé∞ÔºåÂπ∂‰∏îÈúÄË¶ÅËß£ÂÜ≥ÁöÑÂú∫ÊôØ Âú®È´òÂπ∂ÂèëÁü≠ËøûÊé•ÁöÑTCPÊúçÂä°Âô®‰∏äÔºåÂΩìÊúçÂä°Âô®Â§ÑÁêÜÂÆåËØ∑Ê±ÇÂêéÁ´ãÂàªÊåâÁÖß‰∏ªÂä®Ê≠£Â∏∏ÂÖ≥Èó≠ËøûÊé•„ÄÇ„ÄÇ„ÄÇËøô‰∏™Âú∫ÊôØ‰∏ãÔºå‰ºöÂá∫Áé∞Â§ßÈáèsocketÂ§Ñ‰∫éTIMEWAITÁä∂ÊÄÅ„ÄÇÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÁöÑÂπ∂ÂèëÈáèÊåÅÁª≠ÂæàÈ´òÔºåÊ≠§Êó∂ÈÉ®ÂàÜÂÆ¢Êà∑Á´ØÂ∞±‰ºöÊòæÁ§∫ËøûÊé•‰∏ç‰∏ä„ÄÇÊàëÊù•Ëß£Èáä‰∏ãËøô‰∏™Âú∫ÊôØ„ÄÇ‰∏ªÂä®Ê≠£Â∏∏ÂÖ≥Èó≠TCPËøûÊé•ÔºåÈÉΩ‰ºöÂá∫Áé∞TIMEWAIT„ÄÇ‰∏∫‰ªÄ‰πàÊàë‰ª¨Ë¶ÅÂÖ≥Ê≥®Ëøô‰∏™È´òÂπ∂ÂèëÁü≠ËøûÊé•Âë¢ÔºüÊúâ‰∏§‰∏™ÊñπÈù¢ÈúÄË¶ÅÊ≥®ÊÑèÔºö È´òÂπ∂ÂèëÂèØ‰ª•ËÆ©ÊúçÂä°Âô®Âú®Áü≠Êó∂Èó¥ËåÉÂõ¥ÂÜÖÂêåÊó∂Âç†Áî®Â§ßÈáèÁ´ØÂè£ÔºåËÄåÁ´ØÂè£Êúâ‰∏™0~65535ÁöÑËåÉÂõ¥ÔºåÂπ∂‰∏çÊòØÂæàÂ§öÔºåÂà®Èô§Á≥ªÁªüÂíåÂÖ∂‰ªñÊúçÂä°Ë¶ÅÁî®ÁöÑÔºåÂâ©‰∏ãÁöÑÂ∞±Êõ¥Â∞ë‰∫Ü„ÄÇ Âú®Ëøô‰∏™Âú∫ÊôØ‰∏≠ÔºåÁü≠ËøûÊé•Ë°®Á§∫‚Äú‰∏öÂä°Â§ÑÁêÜ+‰º†ËæìÊï∞ÊçÆÁöÑÊó∂Èó¥ ËøúËøúÂ∞è‰∫é TIMEWAITË∂ÖÊó∂ÁöÑÊó∂Èó¥‚ÄùÁöÑËøûÊé•„ÄÇËøôÈáåÊúâ‰∏™Áõ∏ÂØπÈïøÁü≠ÁöÑÊ¶ÇÂøµÔºåÊØîÂ¶ÇÔºåÂèñ‰∏Ä‰∏™webÈ°µÈù¢Ôºå1ÁßíÈíüÁöÑhttpÁü≠ËøûÊé•Â§ÑÁêÜÂÆå‰∏öÂä°ÔºåÂú®ÂÖ≥Èó≠ËøûÊé•‰πãÂêéÔºåËøô‰∏™‰∏öÂä°Áî®ËøáÁöÑÁ´ØÂè£‰ºöÂÅúÁïôÂú®TIMEWAITÁä∂ÊÄÅÂá†ÂàÜÈíüÔºåËÄåËøôÂá†ÂàÜÈíüÔºåÂÖ∂‰ªñHTTPËØ∑Ê±ÇÊù•‰∏¥ÁöÑÊó∂ÂÄôÊòØÊó†Ê≥ïÂç†Áî®Ê≠§Á´ØÂè£ÁöÑ„ÄÇÂçïÁî®Ëøô‰∏™‰∏öÂä°ËÆ°ÁÆóÊúçÂä°Âô®ÁöÑÂà©Áî®Áéá‰ºöÂèëÁé∞ÔºåÊúçÂä°Âô®Âπ≤Ê≠£Áªè‰∫ãÁöÑÊó∂Èó¥ÂíåÁ´ØÂè£ÔºàËµÑÊ∫êÔºâË¢´ÊåÇÁùÄÊó†Ê≥ïË¢´‰ΩøÁî®ÁöÑÊó∂Èó¥ÁöÑÊØî‰æãÊòØ 1ÔºöÂá†ÁôæÔºåÊúçÂä°Âô®ËµÑÊ∫ê‰∏•ÈáçÊµ™Ë¥π„ÄÇÔºàËØ¥‰∏™È¢òÂ§ñËØùÔºå‰ªéËøô‰∏™ÊÑè‰πâÂá∫ÂèëÊù•ËÄÉËôëÊúçÂä°Âô®ÊÄßËÉΩË∞É‰ºòÁöÑËØùÔºåÈïøËøûÊé•‰∏öÂä°ÁöÑÊúçÂä°Â∞±‰∏çÈúÄË¶ÅËÄÉËôëTIMEWAITÁä∂ÊÄÅ„ÄÇÂêåÊó∂ÔºåÂÅáÂ¶Ç‰Ω†ÂØπÊúçÂä°Âô®‰∏öÂä°Âú∫ÊôØÈùûÂ∏∏ÁÜüÊÇâÔºå‰Ω†‰ºöÂèëÁé∞ÔºåÂú®ÂÆûÈôÖ‰∏öÂä°Âú∫ÊôØ‰∏≠Ôºå‰∏ÄËà¨ÈïøËøûÊé•ÂØπÂ∫îÁöÑ‰∏öÂä°ÁöÑÂπ∂ÂèëÈáèÂπ∂‰∏ç‰ºöÂæàÈ´òÔºâÁªºÂêàËøô‰∏§‰∏™ÊñπÈù¢ÔºåÊåÅÁª≠ÁöÑÂà∞Ëææ‰∏ÄÂÆöÈáèÁöÑÈ´òÂπ∂ÂèëÁü≠ËøûÊé•Ôºå‰ºö‰ΩøÊúçÂä°Âô®Âõ†Á´ØÂè£ËµÑÊ∫ê‰∏çË∂≥ËÄåÊãíÁªù‰∏∫‰∏ÄÈÉ®ÂàÜÂÆ¢Êà∑ÊúçÂä°„ÄÇÂêåÊó∂ÔºåËøô‰∫õÁ´ØÂè£ÈÉΩÊòØÊúçÂä°Âô®‰∏¥Êó∂ÂàÜÈÖçÔºåÊó†Ê≥ïÁî®SO_REUSEADDRÈÄâÈ°πËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò:( ‰∏ÄÂØπÁüõÁõæTIMEWAITÊó¢ÂèãÂ•ΩÔºåÂèà‰ª§‰∫∫Â§¥Áñº„ÄÇ‰ΩÜÊòØÊàë‰ª¨ËøòÊòØË¶ÅÊä±ÁùÄ‰∏Ä‰∏™ÂèãÂ•ΩÁöÑÊÄÅÂ∫¶Êù•ÁúãÂæÖÂÆÉÔºåÂõ†‰∏∫ÂÆÉÂ∞ΩÂÆÉÁöÑËÉΩÂäõ‰øùËØÅ‰∫ÜÊúçÂä°Âô®ÁöÑÂÅ•Â£ÆÊÄß„ÄÇ ÂèØË°åËÄå‰∏îÂøÖÈ°ªÂ≠òÂú®Ôºå‰ΩÜÊòØ‰∏çÁ¨¶ÂêàÂéüÂàôÁöÑËß£ÂÜ≥ÊñπÂºè linuxÊ≤°ÊúâÂú®sysctlÊàñËÄÖprocÊñá‰ª∂Á≥ªÁªüÊö¥Èú≤‰øÆÊîπËøô‰∏™TIMEWAITË∂ÖÊó∂Êó∂Èó¥ÁöÑÊé•Âè£ÔºåÂèØ‰ª•‰øÆÊîπÂÜÖÊ†∏ÂçèËÆÆÊ†à‰ª£Á†Å‰∏≠ÂÖ≥‰∫éËøô‰∏™TIMEWAITÁöÑË∂ÖÊó∂Êó∂Èó¥ÂèÇÊï∞ÔºåÈáçÁºñÂÜÖÊ†∏ÔºåËÆ©ÂÆÉÁº©Áü≠Ë∂ÖÊó∂Êó∂Èó¥ÔºåÂä†Âø´ÂõûÊî∂Ôºõ Âà©Áî®SO_LINGERÈÄâÈ°πÁöÑÂº∫Âà∂ÂÖ≥Èó≠ÊñπÂºèÔºåÂèëRSTËÄå‰∏çÊòØFINÔºåÊù•Ë∂äËøáTIMEWAITÁä∂ÊÄÅÔºåÁõ¥Êé•ËøõÂÖ•CLOSEDÁä∂ÊÄÅ„ÄÇËØ¶ËßÅÊàëÁöÑÂçöÊñá„ÄäTCP‰πãÈÄâÈ°πSO_LINGER„Äã„ÄÇ ÊàëÂ¶Ç‰ΩïÁúãÂæÖËøô‰∏™ÈóÆÈ¢ò‰∏∫‰ªÄ‰πàËØ¥‰∏äËø∞‰∏§ÁßçËß£ÂÜ≥ÊñπÂºèÊàëËßâÂæóÂèØË°åÔºå‰ΩÜÊòØ‰∏çÁ¨¶ÂêàÂéüÂàôÔºüÊàëÈ¶ñÂÖàËÆ§‰∏∫ÔºåÊàëË¶Å‰æùÈù†TIMEWAITÁä∂ÊÄÅÊù•‰øùËØÅÊàëÁöÑÊúçÂä°Âô®Á®ãÂ∫èÂÅ•Â£ÆÔºåÁΩëÁªú‰∏äÂèëÁîüÁöÑ‰π±‰∏ÉÂÖ´Á≥üÁöÑÈóÆÈ¢òÂ§™Â§ö‰∫ÜÔºåÊàëÂÖàË¶ÅÊúçÂä°ÂäüËÉΩÊ≠£Â∏∏„ÄÇÈÇ£ÊòØ‰∏çÊòØÂ∞±‰∏çË¶ÅÊÄßËÉΩ‰∫ÜÂë¢ÔºüÂπ∂‰∏çÊòØ„ÄÇÂ¶ÇÊûúÊúçÂä°Âô®‰∏äË∑ëÁöÑÁü≠ËøûÊé•‰∏öÂä°ÈáèÂà∞‰∫ÜÊàëÁúüÁöÑÂøÖÈ°ªÂ§ÑÁêÜËøô‰∏™TIMEWAITÁä∂ÊÄÅËøáÂ§öÁöÑÈóÆÈ¢òÁöÑÊó∂ÂÄôÔºåÊàëÁöÑÂéüÂàôÊòØÂ∞ΩÈáèÂ§ÑÁêÜÔºåËÄå‰∏çÊòØË∑üTIMEWAITÂπ≤‰∏äÔºåÈùûÂÖàÈô§‰πãËÄåÂêéÂø´ÔºöÔºâÂ¶ÇÊûúÂ∞ΩÈáèÂ§ÑÁêÜ‰∫ÜÔºåËøòÊòØËß£ÂÜ≥‰∏ç‰∫ÜÈóÆÈ¢òÔºå‰ªçÁÑ∂ÊãíÁªùÊúçÂä°ÈÉ®ÂàÜËØ∑Ê±ÇÔºåÈÇ£Êàë‰ºöÈááÂèñÂàÜÊú∫Âô®ÁöÑÊñπÊ≥ïÔºåËÆ©Â§öÂè∞Êú∫Âô®Êù•ÊäóËøô‰∫õÈ´òÂπ∂ÂèëÁöÑÁü≠ËØ∑Ê±Ç„ÄÇÊåÅÁª≠ÂçÅ‰∏áÂπ∂ÂèëÁöÑÁü≠ËøûÊé•ËØ∑Ê±ÇÔºå‰∏§Âè∞Êú∫Âô®ÔºåÊØèÂè∞5‰∏á‰∏™ÔºåÂ∫îËØ•Â§üÁî®‰∫ÜÂêß„ÄÇ‰∏ÄËà¨ÁöÑ‰∏öÂä°Èáè‰ª•ÂèäÂõΩÂÜÖÂ§ßÈÉ®ÂàÜÁΩëÁ´ôÂÖ∂ÂÆûÂπ∂‰∏çÈúÄË¶ÅÂÖ≥Ê≥®Ëøô‰∏™ÈóÆÈ¢òÔºå‰∏ÄÂè•ËØùÔºåËææ‰∏çÂà∞ÈúÄË¶ÅÂÖ≥Ê≥®Ëøô‰∏™ÈóÆÈ¢òÁöÑËÆøÈóÆÈáè„ÄÇÁúüÊ≠£Âú∞ÂøÖÈ°ª‰ΩøÁî®‰∏äËø∞ÊàëËÆ§‰∏∫‰∏çÂêàÁêÜÁöÑÊñπÂºèÊù•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÁöÑÂú∫ÊôØÊúâÊ≤°ÊúâÂë¢ÔºüÁ≠îÊ°àÊòØÊúâ„ÄÇÂÉèÊ∑òÂÆù„ÄÅÁôæÂ∫¶„ÄÅÊñ∞Êµ™„ÄÅ‰∫¨‰∏úÂïÜÂüéËøôÊ†∑ÁöÑÁ´ôÁÇπÔºåÁî±‰∫éÊúâÂæàÂ§öÈùôÊÄÅÂ∞èÂõæÁâá‰∏öÂä°ÔºåÂ¶ÇÊûúËøáÂ∫¶ÂàÜÊúç‰ºöÂØºËá¥ÈúÄË¶Å‰∏äÁ∫øÂ§ßÈáèÊú∫Âô®ÔºåÂ§ö‰π∞Êú∫Âô®Â§öËä±Èí±ÔºåÂæóÂ§öÈÖçÊú∫ÊàøÔºåÂ§öÈÖçÂ§áËøêÁª¥Â∑•Á®ãÂ∏àÊù•ÂÆàÊä§Ëøô‰∫õÊú∫Âô®ÔºåÊàêÊú¨Â¢ûÈïøÈùûÂ∏∏‰∏•Èáç„ÄÇ„ÄÇ„ÄÇËøô‰∏™Êó∂ÂÄôÂ∞±Ë¶ÅÂ∞Ω‰∏ÄÂàáÂèØËÉΩÂéª‰ºòÂåñ„ÄÇÈ¢òÂ§ñËØùÔºåÊúçÂä°Âô®‰∏äÁöÑÊäÄÊúØÈóÆÈ¢òÊ≤°ÊúâÁªùÂØπÔºå‰∏ÄÂàáÈÉΩÊòØ‰∏∫‰∏öÂä°ÈúÄÊ±ÇÊúçÂä°ÁöÑ„ÄÇ Â¶Ç‰ΩïÂ∞ΩÈáèÂ§ÑÁêÜTIMEWAITËøáÂ§ösysctlÊîπ‰∏§‰∏™ÂÜÖÊ†∏ÂèÇÊï∞Â∞±Ë°å‰∫ÜÔºåÂ¶Ç‰∏ãÔºönet.ipv4.tcp_tw_reuse = 1net.ipv4.tcp_tw_recycle = 1ÁÆÄÂçïÊù•ËØ¥ÔºåÂ∞±ÊòØÊâìÂºÄÁ≥ªÁªüÁöÑTIMEWAITÈáçÁî®ÂíåÂø´ÈÄüÂõûÊî∂ÔºåËá≥‰∫éÊÄé‰πàÈáçÁî®ÂíåÂø´ÈÄüÂõûÊî∂ÔºåËøô‰∏™ÈóÆÈ¢òÊàëÊ≤°ÊúâÊ∑±Á©∂ÔºåÂÆûÈôÖÂú∫ÊôØ‰∏≠Ëøô‰πàÂÅöÁ°ÆÂÆûÊúâÊïàÊûú„ÄÇÁî®netstatÊàñËÄÖssËßÇÂØüÂ∞±ËÉΩÂæóÂá∫ÁªìËÆ∫„ÄÇËøòÊúâ‰∫õÊúãÂèãÂêåÊó∂‰πü‰ºöÊâìÂºÄsyncookiesËøô‰∏™ÂäüËÉΩÔºåÂ¶Ç‰∏ãÔºönet.ipv4.tcp_syncookies = 1ÊâìÂºÄËøô‰∏™syncookiesÁöÑÁõÆÁöÑÂÆûÈôÖ‰∏äÊòØÔºö‚ÄúÂú®ÊúçÂä°Âô®ËµÑÊ∫êÔºàÂπ∂ÈùûÂçïÊåáÁ´ØÂè£ËµÑÊ∫êÔºåÊãíÁªùÊúçÂä°ÊúâÂæàÂ§öÁßçËµÑÊ∫ê‰∏çË∂≥ÁöÑÊÉÖÂÜµÔºâ‰∏çË∂≥ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ∞ΩÈáè‰∏çË¶ÅÊãíÁªùTCPÁöÑsynÔºàËøûÊé•ÔºâËØ∑Ê±ÇÔºåÂ∞ΩÈáèÊääsynËØ∑Ê±ÇÁºìÂ≠òËµ∑Êù•ÔºåÁïôÁùÄËøá‰ºöÂÑøÊúâËÉΩÂäõÁöÑÊó∂ÂÄôÂ§ÑÁêÜËøô‰∫õTCPÁöÑËøûÊé•ËØ∑Ê±Ç‚Äù„ÄÇÂ¶ÇÊûúÂπ∂ÂèëÈáèÁúüÁöÑÈùûÂ∏∏ÈùûÂ∏∏È´òÔºåÊâìÂºÄËøô‰∏™ÂÖ∂ÂÆûÁî®Â§Ñ‰∏çÂ§ß„ÄÇ]]></content>
      <categories>
        <category>ÁΩëÁªú</category>
      </categories>
      <tags>
        <tag>ÁΩëÁªú</tag>
        <tag>TCP/IP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[crawlabÁöÑgolangÂêéÁ´ØÂÜÖÂ≠òÂàÜÊûêÂèä‰ºòÂåñ-Âü∫‰∫égo pprof]]></title>
    <url>%2F2019%2F08%2F20%2Fcrawlab%E7%9A%84%E5%86%85%E5%AD%98%E5%88%86%E6%9E%90%E5%8F%8A%E4%BC%98%E5%8C%96-%E5%9F%BA%E4%BA%8Ego-pprof%2F</url>
    <content type="text"><![CDATA[ËÉåÊôØCrawlabÂèëÂ∏ÉÂá†‰∏™Êúà‰ª•Êù•ÔºåÂÖ∂‰∏≠ÁªèÂéÜËøáÂ§öÊ¨°Ëø≠‰ª£ÔºåÂú®‰ΩøÁî®ËÄÖ‰ª¨ÁöÑÁßØÊûÅÂèçÈ¶à‰∏ãÔºåcrawlabÁà¨Ëô´Âπ≥Âè∞ÈÄêÊ∏êÁ®≥ÂÆöÔºå‰ΩÜÊòØÊúÄËøëÊúâÁî®Êà∑Êä•Âá∫crawlabÂêØÂä®‰∏ÄÊÆµÊó∂Èó¥ÂêéÔºå‰∏ªËäÇÁÇπÊú∫Âô®‰ºöÂá∫Áé∞ÂÜÖÂ≠òÂç†Áî®ËøáÈ´òÁöÑÈóÆÈ¢òÔºå‰∏ÄÂè∞4GÂÜÖÂ≠òÁöÑÊú∫Âô®Âú®ËøêË°åcrawlabÂêéÁ´üÁÑ∂ËÉΩÂç†Áî®3.5G‰ª•‰∏äÔºåÂá†‰πéÂèØ‰ª•ËÇØÂÆöÂêéÁ´ØÊúçÂä°ÁöÑÊüê‰∏™Êé•Âè£Áî±‰∫é‰ª£Á†Å‰∏çËßÑËåÉÂØºËá¥ÂÜÖÂ≠òÂç†Áî®Ôºå‰∫éÊòØÂÜ≥ÂÆöÂØπcrawlabËøõË°å‰∏ÄÊ¨°ÂÜÖÂ≠òÂàÜÊûê„ÄÇ 2. ÂàÜÊûêÂàÜÊûêÂÜÖÂ≠òÂÖâÈù†ÊâãÊíï‰ª£Á†ÅÊòØÊØîËæÉÂõ∞ÈöæÁöÑÔºåÊÄªË¶ÅÂÄüÂä©‰∏Ä‰∫õÂ∑•ÂÖ∑„ÄÇGolang pprofÊòØGoÂÆòÊñπÁöÑprofilingÂ∑•ÂÖ∑ÔºåÈùûÂ∏∏Âº∫Â§ßÔºå‰ΩøÁî®Ëµ∑Êù•‰πüÂæàÊñπ‰æø„ÄÇ È¶ñÂÖàÔºåÊàë‰ª¨Âú®crawlabÈ°πÁõÆ‰∏≠ÂµåÂÖ•Â¶Ç‰∏ãÂá†Ë°å‰ª£Á†ÅÔºö 1234_ "net/http/pprof"go func() &#123; http.ListenAndServe("0.0.0.0:8888", nil) &#125;() Â∞ÜcrawlabÂêéÁ´ØÊúçÂä°ÂêØÂä®ÂêéÔºåÊµèËßàÂô®‰∏≠ËæìÂÖ•http://ip:8899/debug/pprof/Â∞±ÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™Ê±áÊÄªÂàÜÊûêÈ°µÈù¢ÔºåÊòæÁ§∫Â¶Ç‰∏ã‰ø°ÊÅØÔºö 12345678910/debug/pprof/profiles:0 block32 goroutine552 heap0 mutex51 threadcreatefull goroutine stack dump ÁÇπÂáªheapÔºåÂú®Ê±áÊÄªÂàÜÊûêÈ°µÈù¢ÁöÑÊúÄ‰∏äÊñπÂèØ‰ª•ÁúãÂà∞Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÁ∫¢Ëâ≤ÁÆ≠Â§¥ÊâÄÊåáÁöÑÂ∞±ÊòØÂΩìÂâçÂ∑≤Áªè‰ΩøÁî®ÁöÑÂ†ÜÂÜÖÂ≠òÊòØ25M,amazingÔºÅÂú®ÊàëÂè™‰∏ä‰º†‰∏Ä‰∏™Áà¨Ëô´Êñá‰ª∂ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰∏Ä‰∏™ÂêéÁ´ØÊúçÂä°ÊâÄÁî®ÁöÑÂÜÖÂ≠òÁ´üÁÑ∂ËÉΩËææÂà∞25M Êé•‰∏ãÊù•Êàë‰ª¨ÈúÄË¶ÅÂÄüÂä©go tool pprofÊù•ÂàÜÊûêÔºö 1go tool pprof -inuse_space http://Êú¨Êú∫Ip:8888/debug/pprof/heap Ëøô‰∏™ÂëΩ‰ª§ËøõÂÖ•ÂêéÔºåÊòØ‰∏Ä‰∏™Á±ª‰ººgdbÁöÑ‰∫§‰∫íÂºèÁïåÈù¢ÔºåËæìÂÖ•topÂëΩ‰ª§ÂèØ‰ª•Ââç10Â§ßÁöÑÂÜÖÂ≠òÂàÜÈÖçÔºåflatÊòØÂ†ÜÊ†à‰∏≠ÂΩìÂâçÂ±ÇÁöÑinuseÂÜÖÂ≠òÂÄºÔºåcumÊòØÂ†ÜÊ†à‰∏≠Êú¨Â±ÇÁ∫ßÁöÑÁ¥ØËÆ°inuseÂÜÖÂ≠òÂÄºÔºàÂåÖÊã¨Ë∞ÉÁî®ÁöÑÂáΩÊï∞ÁöÑinuseÂÜÖÂ≠òÂÄºÔºå‰∏äÈù¢ÁöÑÂ±ÇÁ∫ßÔºâ ÂèØ‰ª•ÁúãÂà∞Ôºåbytes.makeSliceËøô‰∏™ÂÜÖÁΩÆÊñπÊ≥ïÁ´üÁÑ∂‰ΩøÁî®‰∫Ü24MÂÜÖÂ≠òÔºåÁªßÁª≠ÂæÄ‰∏ãÁúãÔºåÂèØ‰ª•ÁúãÂà∞ReadFromËøô‰∏™ÊñπÊ≥ïÔºåÊêú‰∫Ü‰∏Ä‰∏ãÔºåÂèëÁé∞ ioutil.ReadAll() Èáå‰ºöË∞ÉÁî® bytes.Buffer.ReadFrom, ËÄå bytes.Buffer.ReadFrom ‰ºöËøõË°å makeSlice„ÄÇÂÜçÂõûÂ§¥Áúã‰∏Ä‰∏ãio/ioutil.readAllÁöÑ‰ª£Á†ÅÂÆûÁé∞Ôºå 123456789101112131415161718192021func readAll(r io.Reader, capacity int64) (b []byte, err error) &#123; buf := bytes.NewBuffer(make([]byte, 0, capacity)) defer func() &#123; e := recover() if e == nil &#123; return &#125; if panicErr, ok := e.(error); ok &amp;&amp; panicErr == bytes.ErrTooLarge &#123; err = panicErr &#125; else &#123; panic(e) &#125; &#125;() _, err = buf.ReadFrom(r) return buf.Bytes(), err&#125;// bytes.MinRead = 512func ReadAll(r io.Reader) ([]byte, error) &#123; return readAll(r, bytes.MinRead)&#125; ÂèØ‰ª•ÁúãÂà∞Ôºåioutil.ReadAll ÊØèÊ¨°ÈÉΩ‰ºöÂàÜÈÖçÂàùÂßãÂåñ‰∏Ä‰∏™Â§ßÂ∞è‰∏∫ bytes.MinRead ÁöÑ buffer Ôºåbytes.MinRead Âú® Golang ÈáåÊòØ‰∏Ä‰∏™Â∏∏ÈáèÔºåÂÄº‰∏∫ 512 „ÄÇÂ∞±ÊòØËØ¥ÊØèÊ¨°Ë∞ÉÁî® ioutil.ReadAll ÈÉΩ‰ºöÂàÜÈÖç‰∏ÄÂùóÂ§ßÂ∞è‰∏∫ 512 Â≠óËäÇÁöÑÂÜÖÂ≠òÔºåÁúãËµ∑Êù•ÊòØÊ≠£Â∏∏ÁöÑÔºå‰ΩÜÊàë‰ª¨ÂÜçÁúã‰∏Ä‰∏ãReadFromÁöÑÂÆûÁé∞Ôºå 1234567891011121314151617181920212223242526272829303132333435// ReadFrom reads data from r until EOF and appends it to the buffer, growing// the buffer as needed. The return value n is the number of bytes read. Any// error except io.EOF encountered during the read is also returned. If the// buffer becomes too large, ReadFrom will panic with ErrTooLarge.func (b *Buffer) ReadFrom(r io.Reader) (n int64, err error) &#123; b.lastRead = opInvalid // If buffer is empty, reset to recover space. if b.off &gt;= len(b.buf) &#123; b.Truncate(0) &#125; for &#123; if free := cap(b.buf) - len(b.buf); free &lt; MinRead &#123; // not enough space at end newBuf := b.buf if b.off+free &lt; MinRead &#123; // not enough space using beginning of buffer; // double buffer capacity newBuf = makeSlice(2*cap(b.buf) + MinRead) &#125; copy(newBuf, b.buf[b.off:]) b.buf = newBuf[:len(b.buf)-b.off] b.off = 0 &#125; m, e := r.Read(b.buf[len(b.buf):cap(b.buf)]) b.buf = b.buf[0 : len(b.buf)+m] n += int64(m) if e == io.EOF &#123; break &#125; if e != nil &#123; return n, e &#125; &#125; return n, nil // err is EOF, so return nil explicitly&#125; Ëøô‰∏™ÂáΩÊï∞‰∏ªË¶Å‰ΩúÁî®Â∞±ÊòØ‰ªé io.Reader ÈáåËØªÂèñÁöÑÊï∞ÊçÆÊîæÂÖ• buffer ‰∏≠ÔºåÂ¶ÇÊûú buffer Á©∫Èó¥‰∏çÂ§üÔºåÂ∞±ÊåâÁÖßÊØèÊ¨° 2x + MinRead ÁöÑÁÆóÊ≥ïÈÄíÂ¢ûÔºåËøôÈáå MinRead ÁöÑÂ§ßÂ∞è‰πüÊòØ 512 Bytes Ôºå‰πüÂ∞±ÊòØËØ¥Â¶ÇÊûúÊàë‰ª¨‰∏ÄÊ¨°ÊÄßËØªÂèñÁöÑÊñá‰ª∂ËøáÂ§ßÔºåÂ∞±‰ºöÂØºËá¥ÊâÄ‰ΩøÁî®ÁöÑÂÜÖÂ≠òÂÄçÂ¢ûÔºåÂÅáËÆæÊàë‰ª¨ÁöÑÁà¨Ëô´Êñá‰ª∂ÊÄªÂÖ±Êúâ500M,ÈÇ£‰πàÊâÄÁî®ÁöÑÂÜÖÂ≠òÂ∞±Êúâ500M * 2 + 512BÔºåÂÜµ‰∏îÁà¨Ëô´Êñá‰ª∂‰∏≠ËøòÂ∏¶‰∫ÜÈÇ£‰πàÂ§ölogÊñá‰ª∂ÔºåÈÇ£ÁúãÁúãcrawlabÊ∫êÁ†Å‰∏≠ÊòØÂì™‰∏ÄÊÆµ‰ΩøÁî®ioutil.ReadAllËØª‰∫ÜÁà¨Ëô´Êñá‰ª∂ÔºåÂÆö‰ΩçÂà∞‰∫ÜËøôÈáåÔºö ËøôÈáåÁõ¥Êé•Â∞ÜÂÖ®ÈÉ®ÁöÑÊñá‰ª∂ÂÜÖÂÆπÔºå‰ª•‰∫åËøõÂà∂ÁöÑÂΩ¢ÂºèËØª‰∫ÜËøõÊù•ÔºåÂØºËá¥ÂÜÖÂ≠òÂÄçÂ¢ûÔºå‰ª§‰∫∫Á™íÊÅØÁöÑÊìç‰Ωú„ÄÇ ÂÖ∂ÂÆûÂú®ËØªÂ§ßÊñá‰ª∂ÁöÑÊó∂ÂÄôÔºåÊääÊñá‰ª∂ÂÜÖÂÆπÂÖ®ÈÉ®ËØªÂà∞ÂÜÖÂ≠òÔºåÁõ¥Êé•Â∞±ÁøªËΩ¶‰∫ÜÔºåÊ≠£Á°ÆÊòØÂ§ÑÁêÜÊñπÊ≥ïÊúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØÊµÅÂºèÂ§ÑÁêÜÔºö 123456789101112131415161718192021func ReadFile(filePath string, handle func(string)) error &#123; f, err := os.Open(filePath) defer f.Close() if err != nil &#123; return err &#125; buf := bufio.NewReader(f) for &#123; line, err := buf.ReadLine("\n") line = strings.TrimSpace(line) handle(line) if err != nil &#123; if err == io.EOF&#123; return nil &#125; return err &#125; return nil &#125;&#125; Á¨¨‰∫åÁßçÊñπÊ°àÂ∞±ÊòØÂàÜÁâáÂ§ÑÁêÜÔºåÂΩìËØªÂèñÁöÑÊòØ‰∫åËøõÂà∂Êñá‰ª∂ÔºåÊ≤°ÊúâÊç¢Ë°åÁ¨¶ÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®ËøôÁßçÊñπÊ°àÊØîËæÉÂêàÈÄÇÔºö 123456789101112131415161718192021func ReadBigFile(fileName string, handle func([]byte)) error &#123; f, err := os.Open(fileName) if err != nil &#123; fmt.Println("can't opened this file") return err &#125; defer f.Close() s := make([]byte, 4096) for &#123; switch nr, err := f.Read(s[:]); true &#123; case nr &lt; 0: fmt.Fprintf(os.Stderr, "cat: error reading: %s\n", err.Error()) os.Exit(1) case nr == 0: // EOF return nil case nr &gt; 0: handle(s[0:nr]) &#125; &#125; return nil&#125; Êàë‰ª¨ËøôÁ±ªÈááÁî®ÁöÑÁ¨¨‰∫åÁßçÊñπÂºèÊù•‰ºòÂåñÔºå‰ºòÂåñÂêéÂÜçÊù•Áúã‰∏ãÂÜÖÂ≠òÂàÜÊûêÔºö Âç†Áî®1MÂÜÖÂ≠òÔºåËøôÊâçÊòØ‰∏Ä‰∏™Ê≠£Â∏∏ÂêéÁ´ØÊúçÂä°ËØ•ÊúâÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÔºåÊ∫êÁ†ÅÂ∑≤pushÂà∞crawlabÔºåÂèØ‰ª•Âú®GitHubÈ°πÁõÆÊ∫êÁ†Å‰∏≠ÈòÖËØª„ÄÇ ÊúÄÂêéÈôÑ‰∏äÈ°πÁõÆÈìæÊé•Ôºåhttps://github.com/tikazyq/crawlabÔºå‰∏∫crawlabÊâìÁîµËØùÔºåÊ¨¢ËøéÂ§ßÂÆ∂‰∏ÄËµ∑Ë¥°ÁåÆÔºåËÆ©crawlabÂèòÂæóÊõ¥Â•ΩÁî®ÔºÅ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python‰∏≠‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºèÁöÑÁéØËßÜÂäüËÉΩ]]></title>
    <url>%2F2019%2F08%2F16%2FPython%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E7%8E%AF%E8%A7%86%E5%8A%9F%E8%83%BD%2F</url>
    <content type="text"><![CDATA[‰ªÄ‰πàÊòØÁéØËßÜÁéØËßÜÂè™ÊòØËøõË°åÂ≠êË°®ËææÂºèÁöÑÂåπÈÖçÔºåÂπ∂‰∏çÂç†Â≠óÁ¨¶ÔºåÂåπÈÖçÂà∞ÁöÑÂÜÖÂÆπ‰∏ç‰øùÂ≠òÔºåÂõ†Ê≠§‰πüÂè´ÂÅöÈõ∂ÂÆΩÊñ≠Ë®ÄÔºåÁéØËßÜÊúÄÁªàÁöÑÂåπÈÖçÁªìÊûúÂ∞±ÊòØ‰∏Ä‰∏™‰ΩçÁΩÆ„ÄÇ ÁéØËßÜÊåâÁÖßÊñπÂêëÂèØ‰ª•ÂàÜ‰∏∫È°∫Â∫èÁéØËßÜÂíåÈÄÜÂ∫èÁéØËßÜ‰∏§ÁßçÔºåÊåâÊòØÂê¶ËøõË°åÂåπÈÖçÂàÜ‰∏∫ËÇØÂÆöÂíåÂê¶ÂÆö‰∏§ÁßçÔºåÁªÑÂêàËµ∑Êù•Â∞±ÊòØÂõõÁßçÊ®°Âºè„ÄÇ ÁéØËßÜË°®ËææÂºè Ëß£Èáä (?=expression) È°∫Â∫èËÇØÂÆöÁéØËßÜÔºåË°®Á§∫ÊâÄÂú®‰ΩçÁΩÆÂè≥‰æßËÉΩÂåπÈÖçexpression (?!rexpression) È°∫Â∫èÂê¶ÂÆöÁéØËßÜÔºåË°®Á§∫ÊâÄÂú®‰ΩçÁΩÆÂè≥‰æß‰∏çÂåπÈÖçexpression (?&lt;=expression) ÈÄÜÂ∫èËÇØÂÆöÁéØËßÜÔºåË°®Á§∫ÊâÄÂú®‰ΩçÁΩÆÂ∑¶‰æßËÉΩÂåπÈÖçexpression (?&lt;!expression) ÈÄÜÂ∫èÂê¶ÂÆöÁéØËßÜÔºåË°®Á§∫ÊâÄÂú®‰ΩçÁΩÆÂ∑¶‰æß‰∏çÂåπÈÖçexpression Âè™ËØ¥Ê¶ÇÂøµÂèØËÉΩÊúâ‰∫õÊäΩË±°ÔºåÂàÜÂà´‰∏æ‰æãÂ≠êÊù•ÊºîÁ§∫‰∏Ä‰∏ãÂÖ∑‰ΩìÁöÑ‰ΩøÁî®Âú∫ÊôØ„ÄÇ ‰∏Ä‰∫õÁ§∫‰æã È°∫Â∫èËÇØÂÆöÁéØËßÜ 1234# s = 'xiaomi9iphone8iphone7',ÈúÄË¶ÅÂú®ÊØè‰∏™ÊâãÊú∫ÂûãÂè∑ÂêéÈù¢Âä†‰∏äÈÄóÂè∑ÔºåÂèòÊàê s= 'xiaomi9,iphone8,iphone7'import reprint(re.sub(r'(?=iphone)',',',s))# È°∫Â∫èËÇØÂÆöÁéØËßÜÔºåÊâÄÁ°ÆÂÆöÁöÑ‰ΩçÁΩÆÂè≥ËæπÊòØÂ≠óÁ¨¶‰∏≤iPhoneÔºåÂú®Ê≠§‰ΩçÁΩÆÂç≥ÂèØÊ∑ªÂä†ÈÄóÂè∑ ÈÄÜÂ∫èËÇØÂÆöÁéØËßÜ 123456# s = 'Takes Reservations:No Delivery:No Take-out:Yes Accepts Credit Cards:Yes Good for Groups:No'# ÈúÄÊ±ÇÊòØË¶ÅÂú®YesÔºåÂíåNoÁöÑÂêéÈù¢Âä†‰∏äÈÄóÂè∑Ôºå‰Ωø‰πãÂèòÊàê# s = 'Takes Reservations:No, Delivery:No, Take-out:Yes, Accepts Credit Cards:Yes, Good for Groups:No'import rere.sub(r"(?&lt;=(No))(?=(\s+))|(?&lt;=(Yes))(?=(\s+))",',',s)# ÈÄÜÂ∫èËÇØÂÆöÁéØËßÜÔºåÊâÄË¶ÅÁ°ÆÂÆöÁöÑ‰ΩçÂ∑¶ËæπÂøÖÈ°ªËÉΩÂåπÈÖç‰∏äNo,ÊàñËÄÖYes È°∫Â∫èÂê¶ÂÆöÁéØËßÜ 1234# s = '123aaa',Â∞ÜsÂ≠óÁ¨¶‰∏≤ÂèòÊàê s='123,a,a,a,'# ÂàÜÊûê‰∏Ä‰∏ãÔºåÂ∞±ÊòØÂú®Â≠óÁ¨¶‰∏≤Âè≥‰æßÈùûÊï∞Â≠óÁöÑ‰ΩçÁΩÆÔºåÊ∑ªÂä†ÈÄóÂè∑ÔºåÂç≥‰ΩøÁî®È°∫Â∫èÂê¶ÂÆöÁéØËßÜÔºåÂåπÈÖçÂè≥‰æßÈùûÊï∞Â≠ó‰ΩçÁΩÆs = '123aaa're.sub(r'(?!\d+)',',',s) ÈÄÜÂ∫èÂê¶ÂÆöÁéØËßÜ 1234# Â∞Ü s= 'aaa123'ÂèòÊàê s= ',a,a,a,123'# ÂàÜÊûê‰∏Ä‰∏ãÔºåÂ∞±ÊòØÂú®ÈùûÊï∞Â≠óÂ∑¶‰æßÁöÑ‰ΩçÁΩÆÂä†ÈÄóÂè∑Ôºå‰ΩøÁî®ÈÄÜÂ∫èÂê¶ÂÆöÁéØËßÜÔºåÂåπÈÖçÂ∑¶‰æßÈùûÊï∞Â≠óÁöÑ‰ΩçÁΩÆs= 'aaa123're.sub(r'(?&lt;!\d)',',',b) Êúâ‰∫õ‰æãÂ≠ê‰∏çÊòØÂæàÂêàÁêÜÔºåÂ∞ΩÈáèËÉΩË°®ËææÊ∏ÖÊ•öÁéØËßÜÁöÑÂê´‰πâÂç≥ÂèØ„ÄÇ ÊÄªÁªìÔºö 1ÁéØËßÜÁöÑÂäüËÉΩÈùûÂ∏∏Âº∫Â§ßÔºå‰πüÊòØÊ≠£Âàô‰∏≠ÁöÑ‰∏Ä‰∏™ÈöæÁÇπÔºåÂØπ‰∫éÁéØËßÜÁöÑÁêÜËß£ÔºåÂèØ‰ª•‰ªéÂ∫îÁî®ÂíåÂéüÁêÜ‰∏§‰∏™ËßíÂ∫¶ÁêÜËß£ÔºåÂ¶ÇÊûúÊÉ≥ÁêÜËß£ÂæóÊõ¥Ê∏ÖÊô∞„ÄÅÊ∑±ÂÖ•‰∏Ä‰∫õÔºåËøòÊòØ‰ªéÂéüÁêÜÁöÑËßíÂ∫¶ÁêÜËß£Â•Ω‰∏Ä‰∫õÔºåÊ≠£ÂàôÂåπÈÖçÂü∫Êú¨ÂéüÁêÜÂèÇËÄÉ NFAÂºïÊìéÂåπÈÖçÂéüÁêÜ]]></content>
      <categories>
        <category>Ê≠£ÂàôË°®ËææÂºè</category>
      </categories>
      <tags>
        <tag>Ê≠£ÂàôË°®ËææÂºè</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[centos7 ÁºñËØë„ÄÅÂÆâË£Ö„ÄÅÈÖçÁΩÆ„ÄÅÂêØÂä®redis]]></title>
    <url>%2F2019%2F08%2F02%2Fcentos7-%E7%BC%96%E8%AF%91%E3%80%81%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E3%80%81%E5%90%AF%E5%8A%A8reds%2F</url>
    <content type="text"><![CDATA[‰∏ãËΩΩRedisÁöÑÂÆâË£ÖÂåÖ wget http://download.redis.io/releases/redis-4.0.6.tar.gz Ëß£Âéã tar -zxvf redis-4.0.6.tar.gz cd redis-4.0.6 ÁºñËØë make MALLOC=libc ÁéØÂ¢ÉÈÖçÁΩÆÔºåÂ∞ÜÈÖçÁΩÆÊñá‰ª∂‰ª•‰Ω†ÊÉ≥Êö¥Èú≤ÁöÑRedis‰∏∫ÂêçÔºåÂ§çÂà∂Âà∞/etc/redis mkdir /etc/redis(ÈúÄË¶ÅrootÊùÉÈôê) cp redis.conf /etc/redis/6379.conf cd utils &amp; vim redis_init_script ‰øÆÊîπ redis_init_script‰∏≠Â¶ÇÂõæÊâÄÁ§∫ÁöÑÈÉ®ÂàÜ ÈÖçÁΩÆchkconfigÊòØ‰∏∫‰∫ÜÂºÄÊú∫ÈÖçÁΩÆÂºÄÊú∫Ëá™ÂêØRedisÔºå‰∏ãÈù¢ÁöÑÊ®™Á∫øÈÉ®ÂàÜÊç¢Êàê‰Ω†Ëá™Â∑±ÁöÑRedisÂÆâË£ÖË∑ØÂæÑÔºåÂèØÈÄâÊã©Ëá™Â∑±ÊÉ≥Ë¶ÅÊö¥Èú≤ÁöÑÁ´ØÂè£ Â∞Ü‰øÆÊîπÂêéÁöÑredis_init_scriptÊã∑Ë¥ùËá≥ÂºÄÊú∫ÂêØÂä®ÁõÆÂΩïÔºåÂπ∂‰øÆÊîπÊñá‰ª∂Âêç‰∏∫redisd, ‰∏ÄËà¨ÂêéÂè∞ÊúçÂä°ÈÉΩÂ∑≤dÁªìÂ∞æ cp redis_init_script /etc/init.d/redisd ËÆæÁΩÆÂºÄÊú∫ÂêØÂä® chkconfig redisd on Â¶ÇÊûú‰πãÂâçÊ≤°ÊúâÂú®redis_init_script‰∏≠Ê∑ªÂä†chkconfig,Â∞±‰ºöÊèêÁ§∫‰∏çÊîØÊåÅËØ•ÂëΩ‰ª§ service redisd start ÂêØÂä®Redis ÂêéÂè∞ÂêØÂä®ÁöÑËØùÔºåservice redis start &amp;]]></content>
      <categories>
        <category>redis</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlÊï∞ÊçÆÂéªÈáç]]></title>
    <url>%2F2019%2F07%2F01%2Fmysql%E6%95%B0%E6%8D%AE%E5%8E%BB%E9%87%8D%2F</url>
    <content type="text"><![CDATA[‰ªéexcel‰∏≠ÂØºÂÖ•‰∫Ü‰∏ÄÈÉ®ÂàÜÊï∞ÊçÆÂà∞mysql‰∏≠ÔºåÊúâÂæàÂ§öÊï∞ÊçÆÊòØÈáçÂ§çÁöÑÔºåËÄå‰∏îÊ≤°Êúâ‰∏ªÈîÆÔºåÈúÄË¶ÅÊåâÁÖßÂÖ∂‰∏≠Â∑≤ÁªèÂ≠òÂú®Êüê‰∏ÄÂàóÂØπÊï∞ÊçÆËøõË°åÂéªÈáç„ÄÇ Ê∑ªÂä†‰∏ªÈîÆÁî±‰∫é‰πãÂâçÁöÑÂ≠óÊÆµ‰∏≠Ê≤°Êúâ‰∏ªÈîÆÔºåÊâÄ‰ª•ÈúÄË¶ÅÊñ∞Â¢û‰∏Ä‰∏™Â≠óÊÆµÔºåÂπ∂‰∏îÂ∞ÜÂÖ∂‰Ωú‰∏∫‰∏ªÈîÆ„ÄÇ Ê∑ªÂä†‰∏Ä‰∏™Êñ∞ÁöÑÂ≠óÊÆµidÔºåÂØπid‰∏≠ÁöÑÂÄºËøõË°åÈÄíÂ¢ûÊìç‰ΩúÔºåÁÑ∂ÂêéÂÜçËÆæÁΩÆ‰∏∫‰∏ªÈîÆ„ÄÇ ÂØπidÂ≠óÊÆµËøõË°åÈÄíÂ¢ûÁöÑËµãÂÄºÊìç‰ΩúÂ¶Ç‰∏ãÔºö 12SET @r:=0;UPDATE table SET id=(@r:=@r+1); ÁÑ∂ÂêéËÆæÁΩÆ‰∏∫‰∏ªÈîÆÂç≥ÂèØ„ÄÇ ÂéªÈáçÊ∑ªÂä†ÈÄíÂ¢ûÁöÑidÂ≠óÊÆµÂêéÔºåÂ∞±ÂèØ‰ª•ÂØπÊï∞ÊçÆÊ†πÊçÆÊüê‰∏™Â≠óÊÆµËøõË°åÂéªÈáçÊìç‰ΩúÔºåÁ≠ñÁï•Â∞±ÊòØ‰øùÂ≠òidÊúÄÂ∞èÁöÑÈÇ£Êù°Êï∞ÊçÆ„ÄÇ 123456789101112131415161718192021DELETE FROM `table`WHERE`ÂéªÈáçÂ≠óÊÆµÂêç` IN ( SELECT x FROM ( SELECT `ÂéªÈáçÂ≠óÊÆµÂêç` AS x FROM `table` GROUP BY `ÂéªÈáçÂ≠óÊÆµÂêç` HAVING COUNT(`ÂéªÈáçÂ≠óÊÆµÂêç`) &gt; 1 ) tmp0)AND `ÈÄíÂ¢û‰∏ªÈîÆÂêç` NOT IN ( SELECT y FROM ( SELECT min(`ÈÄíÂ¢û‰∏ªÈîÆÂêç`) AS y FROM `table` GROUP BY `ÂéªÈáçÂ≠óÊÆµÂêç` HAVING COUNT(`ÂéªÈáçÂ≠óÊÆµÂêç`) &gt; 1 ) tmp1)]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dokcer.service ÊèêÁ§∫Áº∫Â§±bridgeÁΩëÁªúÔºåÂØºËá¥Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?]]></title>
    <url>%2F2019%2F06%2F04%2Fdokcer-service-%E6%8F%90%E7%A4%BA%E7%BC%BA%E5%A4%B1bridge%E7%BD%91%E7%BB%9C%EF%BC%8C%E5%AF%BC%E8%87%B4Cannot-connect-to-the-Docker-daemon-at-unix-var-run-docker-sock-Is-the-docker-daemon-running%2F</url>
    <content type="text"><![CDATA[Êìç‰ΩúËøáÁ®ãÔºö ‰∏∫CentOS7ÂÆâË£ÖDockerÔºåÂÆâË£ÖÊàêÂäüÂêéÔºåÂèØ‰ª•ÊâßË°ådockerÔºå‰ΩÜÊòØdocker psÁ≠âÂëΩ‰ª§‰ºöÊä•ÈîôÔºö 1Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running? ÂàÜÊûêÔºö ‰∏ÄËà¨ËøôÁßçÈîôËØØÈÉΩÊòØÁî±‰∫éÊìç‰ΩúËÄÖÊ≤°ÊúârootÊùÉÈôêÔºå‰ΩÜÊòØ‰ΩøÁî®sudoÊâßË°å‰πüÊòØÂêåÊ†∑ÁöÑÈóÆÈ¢òÔºåËøôÂ∞±Á∫≥Èó∑‰∫ÜÔºåÊ≤°ÂÖ≥Á≥ªÔºåÁúã‰∏Ä‰∏ãdocker.serviceÁöÑÊâßË°åÊó•ÂøóÔºö 1systemctl status docker.service ÂèëÁé∞Êúâ‰∏ÄÂè•ÂæàÈáçË¶ÅÁöÑËØùÔºö 1Error starting daemon: Error initializing network controller: list bridge addresses failed: no available network ËøôÊòØÁî±‰∫éÂêØÂä®DockerÁöÑÊó∂ÂÄôÔºåÈªòËÆ§ÁöÑÁΩëÁªúÊ®°ÂºèÊòØÊ°•Êé•Ê®°ÂºèÔºåËøôÂ∞±ÈúÄË¶ÅÂêëÊìç‰ΩúÁ≥ªÁªüÂèëÈÄÅ‰ø°Âè∑ÔºåËÆ©ÂÆÉÂ∏ÆÊàë‰ª¨Âª∫Á´ã‰∏Ä‰∏™bridgeÁΩëÁªúÂëΩÂêç‰∏∫docker0, Âπ∂‰∏îÂàÜÈÖç172.17.0.1/16„ÄÇ‰ΩÜÊòØÂá∫‰∫éÊüêÁßçÂéüÂõ†ÔºåËØ•ÁΩëÁªúÊ≤°ÊúâÂª∫Á´ãËµ∑Êù•ÔºåÊàë‰ª¨Âè™Ë¶ÅÊâãÂä®ÊâßË°åËøô‰∏ÄÁ≥ªÂàóÊìç‰ΩúÂ∞±ÂèØ‰ª•Ôºö 123ip link add name docker0 type bridgeip addr add dev docker0 172.17.0.1/16 ÊúÄÂêéÈáçÂêØdocker: 1systemclt restart docker]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python Ê≠£ÂàôË°®ËææÂºèÂèäreËØ¶Ëß£]]></title>
    <url>%2F2019%2F04%2F28%2Fpython-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8F%8Are%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[Python Ê≠£ÂàôË°®ËææÂºè re Ê®°ÂùóÁÆÄ‰ªãÊ≠£ÂàôË°®ËææÂºèÔºàregular expressionÔºâÊòØÂèØ‰ª•ÂåπÈÖçÊñáÊú¨ÁâáÊÆµÁöÑÊ®°Âºè„ÄÇÊúÄÁÆÄÂçïÁöÑÊ≠£ÂàôË°®ËææÂºèÂ∞±ÊòØÊôÆÈÄöÂ≠óÁ¨¶‰∏≤ÔºåÂèØ‰ª•ÂåπÈÖçÂÖ∂Ëá™Ë∫´„ÄÇÊØîÂ¶ÇÔºåÊ≠£ÂàôË°®ËææÂºè ‚Äòhello‚Äô ÂèØ‰ª•ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ ‚Äòhello‚Äô„ÄÇ Ë¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÊ≠£ÂàôË°®ËææÂºèÂπ∂‰∏çÊòØ‰∏Ä‰∏™Á®ãÂ∫èÔºåËÄåÊòØÁî®‰∫éÂ§ÑÁêÜÂ≠óÁ¨¶‰∏≤ÁöÑ‰∏ÄÁßçÊ®°ÂºèÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥Áî®ÂÆÉÊù•Â§ÑÁêÜÂ≠óÁ¨¶‰∏≤ÔºåÂ∞±ÂøÖÈ°ª‰ΩøÁî®ÊîØÊåÅÊ≠£ÂàôË°®ËææÂºèÁöÑÂ∑•ÂÖ∑ÔºåÊØîÂ¶Ç Linux ‰∏≠ÁöÑ awk, sed, grepÔºåÊàñËÄÖÁºñÁ®ãËØ≠Ë®Ä Perl, Python, Java Á≠âÁ≠â„ÄÇ Ê≠£ÂàôË°®ËææÂºèÊúâÂ§öÁßç‰∏çÂêåÁöÑÈ£éÊ†ºÔºå‰∏ãË°®ÂàóÂá∫‰∫ÜÈÄÇÁî®‰∫é Python Êàñ Perl Á≠âÁºñÁ®ãËØ≠Ë®ÄÁöÑÈÉ®ÂàÜÂÖÉÂ≠óÁ¨¶‰ª•ÂèäËØ¥ÊòéÔºö re Ê®°ÂùóÂú® Python ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂÜÖÁΩÆÁöÑ re Ê®°ÂùóÊù•‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºè„ÄÇ Êúâ‰∏ÄÁÇπÈúÄË¶ÅÁâπÂà´Ê≥®ÊÑèÁöÑÊòØÔºåÊ≠£ÂàôË°®ËææÂºè‰ΩøÁî® \ ÂØπÁâπÊÆäÂ≠óÁ¨¶ËøõË°åËΩ¨‰πâÔºåÊØîÂ¶ÇÔºå‰∏∫‰∫ÜÂåπÈÖçÂ≠óÁ¨¶‰∏≤ ‚Äòpython.org‚ÄôÔºåÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºè &#39;python\.org&#39;ÔºåËÄå Python ÁöÑÂ≠óÁ¨¶‰∏≤Êú¨Ë∫´‰πüÁî® \ ËΩ¨‰πâÔºåÊâÄ‰ª•‰∏äÈù¢ÁöÑÊ≠£ÂàôË°®ËææÂºèÂú® Python ‰∏≠Â∫îËØ•ÂÜôÊàê &#39;python\\.org&#39;ÔºåËøô‰ºöÂæàÂÆπÊòìÈô∑ÂÖ• \ ÁöÑÂõ∞Êâ∞‰∏≠ÔºåÂõ†Ê≠§ÔºåÊàë‰ª¨Âª∫ËÆÆ‰ΩøÁî® Python ÁöÑÂéüÂßãÂ≠óÁ¨¶‰∏≤ÔºåÂè™ÈúÄÂä†‰∏Ä‰∏™ r ÂâçÁºÄÔºå‰∏äÈù¢ÁöÑÊ≠£ÂàôË°®ËææÂºèÂèØ‰ª•ÂÜôÊàêÔºö 1r&apos;python\.org&apos; re Ê®°ÂùóÊèê‰æõ‰∫Ü‰∏çÂ∞ëÊúâÁî®ÁöÑÂáΩÊï∞ÔºåÁî®‰ª•ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ÔºåÊØîÂ¶ÇÔºö compile ÂáΩÊï∞ match ÂáΩÊï∞ search ÂáΩÊï∞ findall ÂáΩÊï∞ finditer ÂáΩÊï∞ split ÂáΩÊï∞ sub ÂáΩÊï∞ subn ÂáΩÊï∞ re Ê®°ÂùóÁöÑ‰∏ÄËà¨‰ΩøÁî®Ê≠•È™§Â¶Ç‰∏ãÔºö ‰ΩøÁî® compile ÂáΩÊï∞Â∞ÜÊ≠£ÂàôË°®ËææÂºèÁöÑÂ≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÁºñËØë‰∏∫‰∏Ä‰∏™ Pattern ÂØπË±° ÈÄöËøá Pattern ÂØπË±°Êèê‰æõÁöÑ‰∏ÄÁ≥ªÂàóÊñπÊ≥ïÂØπÊñáÊú¨ËøõË°åÂåπÈÖçÊü•ÊâæÔºåËé∑ÂæóÂåπÈÖçÁªìÊûúÔºà‰∏Ä‰∏™ Match ÂØπË±°Ôºâ ÊúÄÂêé‰ΩøÁî® Match ÂØπË±°Êèê‰æõÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïËé∑Âæó‰ø°ÊÅØÔºåÊ†πÊçÆÈúÄË¶ÅËøõË°åÂÖ∂‰ªñÁöÑÊìç‰Ωú compile ÂáΩÊï∞compile ÂáΩÊï∞Áî®‰∫éÁºñËØëÊ≠£ÂàôË°®ËææÂºèÔºåÁîüÊàê‰∏Ä‰∏™ Pattern ÂØπË±°ÔºåÂÆÉÁöÑ‰∏ÄËà¨‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1re.compile(pattern[, flag]) ÂÖ∂‰∏≠Ôºåpattern ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÁöÑÊ≠£ÂàôË°®ËææÂºèÔºåflag ÊòØ‰∏Ä‰∏™ÂèØÈÄâÂèÇÊï∞ÔºåË°®Á§∫ÂåπÈÖçÊ®°ÂºèÔºåÊØîÂ¶ÇÂøΩÁï•Â§ßÂ∞èÂÜôÔºåÂ§öË°åÊ®°ÂºèÁ≠â„ÄÇ ‰∏ãÈù¢ÔºåËÆ©Êàë‰ª¨ÁúãÁúã‰æãÂ≠ê„ÄÇ 1234import re# Â∞ÜÊ≠£ÂàôË°®ËææÂºèÁºñËØëÊàê Pattern ÂØπË±° pattern = re.compile(r&apos;\d+&apos;) Âú®‰∏äÈù¢ÔºåÊàë‰ª¨Â∑≤Â∞Ü‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèÁºñËØëÊàê Pattern ÂØπË±°ÔºåÊé•‰∏ãÊù•ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî® pattern ÁöÑ‰∏ÄÁ≥ªÂàóÊñπÊ≥ïÂØπÊñáÊú¨ËøõË°åÂåπÈÖçÊü•Êâæ‰∫Ü„ÄÇPattern ÂØπË±°ÁöÑ‰∏Ä‰∫õÂ∏∏Áî®ÊñπÊ≥ï‰∏ªË¶ÅÊúâÔºö match ÊñπÊ≥ï search ÊñπÊ≥ï findall ÊñπÊ≥ï finditer ÊñπÊ≥ï split ÊñπÊ≥ï sub ÊñπÊ≥ï subn ÊñπÊ≥ï match ÊñπÊ≥ïmatch ÊñπÊ≥ïÁî®‰∫éÊü•ÊâæÂ≠óÁ¨¶‰∏≤ÁöÑÂ§¥ÈÉ®Ôºà‰πüÂèØ‰ª•ÊåáÂÆöËµ∑Âßã‰ΩçÁΩÆÔºâÔºåÂÆÉÊòØ‰∏ÄÊ¨°ÂåπÈÖçÔºåÂè™Ë¶ÅÊâæÂà∞‰∫Ü‰∏Ä‰∏™ÂåπÈÖçÁöÑÁªìÊûúÂ∞±ËøîÂõûÔºåËÄå‰∏çÊòØÊü•ÊâæÊâÄÊúâÂåπÈÖçÁöÑÁªìÊûú„ÄÇÂÆÉÁöÑ‰∏ÄËà¨‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1match(string[, pos[, endpos]]) ÂÖ∂‰∏≠Ôºåstring ÊòØÂæÖÂåπÈÖçÁöÑÂ≠óÁ¨¶‰∏≤Ôºåpos Âíå endpos ÊòØÂèØÈÄâÂèÇÊï∞ÔºåÊåáÂÆöÂ≠óÁ¨¶‰∏≤ÁöÑËµ∑ÂßãÂíåÁªàÁÇπ‰ΩçÁΩÆÔºåÈªòËÆ§ÂÄºÂàÜÂà´ÊòØ 0 Âíå len (Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶)„ÄÇÂõ†Ê≠§ÔºåÂΩì‰Ω†‰∏çÊåáÂÆö pos Âíå endpos Êó∂Ôºåmatch ÊñπÊ≥ïÈªòËÆ§ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ÁöÑÂ§¥ÈÉ®„ÄÇ ÂΩìÂåπÈÖçÊàêÂäüÊó∂ÔºåËøîÂõû‰∏Ä‰∏™ Match ÂØπË±°ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂåπÈÖç‰∏äÔºåÂàôËøîÂõû None„ÄÇ ÁúãÁúã‰æãÂ≠ê„ÄÇ 12345678910111213141516171819&gt;&gt;&gt; import re&gt;&gt;&gt; pattern = re.compile(r&apos;\d+&apos;) # Áî®‰∫éÂåπÈÖçËá≥Â∞ë‰∏Ä‰∏™Êï∞Â≠ó&gt;&gt;&gt; m = pattern.match(&apos;one12twothree34four&apos;) # Êü•ÊâæÂ§¥ÈÉ®ÔºåÊ≤°ÊúâÂåπÈÖç&gt;&gt;&gt; print mNone&gt;&gt;&gt; m = pattern.match(&apos;one12twothree34four&apos;, 2, 10) # ‰ªé&apos;e&apos;ÁöÑ‰ΩçÁΩÆÂºÄÂßãÂåπÈÖçÔºåÊ≤°ÊúâÂåπÈÖç&gt;&gt;&gt; print mNone&gt;&gt;&gt; m = pattern.match(&apos;one12twothree34four&apos;, 3, 10) # ‰ªé&apos;1&apos;ÁöÑ‰ΩçÁΩÆÂºÄÂßãÂåπÈÖçÔºåÊ≠£Â•ΩÂåπÈÖç&gt;&gt;&gt; print m # ËøîÂõû‰∏Ä‰∏™ Match ÂØπË±°&lt;_sre.SRE_Match object at 0x10a42aac0&gt;&gt;&gt;&gt; m.group(0) # ÂèØÁúÅÁï• 0&apos;12&apos;&gt;&gt;&gt; m.start(0) # ÂèØÁúÅÁï• 03&gt;&gt;&gt; m.end(0) # ÂèØÁúÅÁï• 05&gt;&gt;&gt; m.span(0) # ÂèØÁúÅÁï• 0(3, 5) Âú®‰∏äÈù¢ÔºåÂΩìÂåπÈÖçÊàêÂäüÊó∂ËøîÂõû‰∏Ä‰∏™ Match ÂØπË±°ÔºåÂÖ∂‰∏≠Ôºö group([group1, ‚Ä¶]) ÊñπÊ≥ïÁî®‰∫éËé∑Âæó‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂàÜÁªÑÂåπÈÖçÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂΩìË¶ÅËé∑ÂæóÊï¥‰∏™ÂåπÈÖçÁöÑÂ≠ê‰∏≤Êó∂ÔºåÂèØÁõ¥Êé•‰ΩøÁî® group() Êàñ group(0)Ôºõ start([group]) ÊñπÊ≥ïÁî®‰∫éËé∑ÂèñÂàÜÁªÑÂåπÈÖçÁöÑÂ≠ê‰∏≤Âú®Êï¥‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑËµ∑Âßã‰ΩçÁΩÆÔºàÂ≠ê‰∏≤Á¨¨‰∏Ä‰∏™Â≠óÁ¨¶ÁöÑÁ¥¢ÂºïÔºâÔºåÂèÇÊï∞ÈªòËÆ§ÂÄº‰∏∫ 0Ôºõ end([group]) ÊñπÊ≥ïÁî®‰∫éËé∑ÂèñÂàÜÁªÑÂåπÈÖçÁöÑÂ≠ê‰∏≤Âú®Êï¥‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÁªìÊùü‰ΩçÁΩÆÔºàÂ≠ê‰∏≤ÊúÄÂêé‰∏Ä‰∏™Â≠óÁ¨¶ÁöÑÁ¥¢Âºï+1ÔºâÔºåÂèÇÊï∞ÈªòËÆ§ÂÄº‰∏∫ 0Ôºõ span([group]) ÊñπÊ≥ïËøîÂõû (start(group), end(group))„ÄÇ ÂÜçÁúãÁúã‰∏Ä‰∏™‰æãÂ≠êÔºö 1234567891011121314151617181920212223&gt;&gt;&gt; import re&gt;&gt;&gt; pattern = re.compile(r&apos;([a-z]+) ([a-z]+)&apos;, re.I) # re.I Ë°®Á§∫ÂøΩÁï•Â§ßÂ∞èÂÜô&gt;&gt;&gt; m = pattern.match(&apos;Hello World Wide Web&apos;)&gt;&gt;&gt; print m # ÂåπÈÖçÊàêÂäüÔºåËøîÂõû‰∏Ä‰∏™ Match ÂØπË±°&lt;_sre.SRE_Match object at 0x10bea83e8&gt;&gt;&gt;&gt; m.group(0) # ËøîÂõûÂåπÈÖçÊàêÂäüÁöÑÊï¥‰∏™Â≠ê‰∏≤&apos;Hello World&apos;&gt;&gt;&gt; m.span(0) # ËøîÂõûÂåπÈÖçÊàêÂäüÁöÑÊï¥‰∏™Â≠ê‰∏≤ÁöÑÁ¥¢Âºï(0, 11)&gt;&gt;&gt; m.group(1) # ËøîÂõûÁ¨¨‰∏Ä‰∏™ÂàÜÁªÑÂåπÈÖçÊàêÂäüÁöÑÂ≠ê‰∏≤&apos;Hello&apos;&gt;&gt;&gt; m.span(1) # ËøîÂõûÁ¨¨‰∏Ä‰∏™ÂàÜÁªÑÂåπÈÖçÊàêÂäüÁöÑÂ≠ê‰∏≤ÁöÑÁ¥¢Âºï(0, 5)&gt;&gt;&gt; m.group(2) # ËøîÂõûÁ¨¨‰∫å‰∏™ÂàÜÁªÑÂåπÈÖçÊàêÂäüÁöÑÂ≠ê‰∏≤&apos;World&apos;&gt;&gt;&gt; m.span(2) # ËøîÂõûÁ¨¨‰∫å‰∏™ÂàÜÁªÑÂåπÈÖçÊàêÂäüÁöÑÂ≠ê‰∏≤(6, 11)&gt;&gt;&gt; m.groups() # Á≠â‰ª∑‰∫é (m.group(1), m.group(2), ...)(&apos;Hello&apos;, &apos;World&apos;)&gt;&gt;&gt; m.group(3) # ‰∏çÂ≠òÂú®Á¨¨‰∏â‰∏™ÂàÜÁªÑTraceback (most recent call last): File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;IndexError: no such group search ÊñπÊ≥ïsearch ÊñπÊ≥ïÁî®‰∫éÊü•ÊâæÂ≠óÁ¨¶‰∏≤ÁöÑ‰ªª‰Ωï‰ΩçÁΩÆÔºåÂÆÉ‰πüÊòØ‰∏ÄÊ¨°ÂåπÈÖçÔºåÂè™Ë¶ÅÊâæÂà∞‰∫Ü‰∏Ä‰∏™ÂåπÈÖçÁöÑÁªìÊûúÂ∞±ËøîÂõûÔºåËÄå‰∏çÊòØÊü•ÊâæÊâÄÊúâÂåπÈÖçÁöÑÁªìÊûúÔºåÂÆÉÁöÑ‰∏ÄËà¨‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1search(string[, pos[, endpos]]) ÂÖ∂‰∏≠Ôºåstring ÊòØÂæÖÂåπÈÖçÁöÑÂ≠óÁ¨¶‰∏≤Ôºåpos Âíå endpos ÊòØÂèØÈÄâÂèÇÊï∞ÔºåÊåáÂÆöÂ≠óÁ¨¶‰∏≤ÁöÑËµ∑ÂßãÂíåÁªàÁÇπ‰ΩçÁΩÆÔºåÈªòËÆ§ÂÄºÂàÜÂà´ÊòØ 0 Âíå len (Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶)„ÄÇ ÂΩìÂåπÈÖçÊàêÂäüÊó∂ÔºåËøîÂõû‰∏Ä‰∏™ Match ÂØπË±°ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂåπÈÖç‰∏äÔºåÂàôËøîÂõû None„ÄÇ ËÆ©Êàë‰ª¨ÁúãÁúã‰æãÂ≠êÔºö 1234567891011121314&gt;&gt;&gt; import re&gt;&gt;&gt; pattern = re.compile(&apos;\d+&apos;)&gt;&gt;&gt; m = pattern.search(&apos;one12twothree34four&apos;) # ËøôÈáåÂ¶ÇÊûú‰ΩøÁî® match ÊñπÊ≥ïÂàô‰∏çÂåπÈÖç&gt;&gt;&gt; m&lt;_sre.SRE_Match object at 0x10cc03ac0&gt;&gt;&gt;&gt; m.group()&apos;12&apos;&gt;&gt;&gt; m = pattern.search(&apos;one12twothree34four&apos;, 10, 30) # ÊåáÂÆöÂ≠óÁ¨¶‰∏≤Âå∫Èó¥&gt;&gt;&gt; m&lt;_sre.SRE_Match object at 0x10cc03b28&gt;&gt;&gt;&gt; m.group()&apos;34&apos;&gt;&gt;&gt; m.span()(13, 15) ÂÜçÊù•Áúã‰∏Ä‰∏™‰æãÂ≠êÔºö 123456789101112131415# -*- coding: utf-8 -*-import re # Â∞ÜÊ≠£ÂàôË°®ËææÂºèÁºñËØëÊàê Pattern ÂØπË±°pattern = re.compile(r&apos;\d+&apos;) # ‰ΩøÁî® search() Êü•ÊâæÂåπÈÖçÁöÑÂ≠ê‰∏≤Ôºå‰∏çÂ≠òÂú®ÂåπÈÖçÁöÑÂ≠ê‰∏≤Êó∂Â∞ÜËøîÂõû None # ËøôÈáå‰ΩøÁî® match() Êó†Ê≥ïÊàêÂäüÂåπÈÖç m = pattern.search(&apos;hello 123456 789&apos;) if m: # ‰ΩøÁî® Match Ëé∑ÂæóÂàÜÁªÑ‰ø°ÊÅØ print &apos;matching string:&apos;,m.group() print &apos;position:&apos;,m.span() ÊâßË°åÁªìÊûúÔºö 12matching string: 123456position: (6, 12) findall ÊñπÊ≥ï‰∏äÈù¢ÁöÑ match Âíå search ÊñπÊ≥ïÈÉΩÊòØ‰∏ÄÊ¨°ÂåπÈÖçÔºåÂè™Ë¶ÅÊâæÂà∞‰∫Ü‰∏Ä‰∏™ÂåπÈÖçÁöÑÁªìÊûúÂ∞±ËøîÂõû„ÄÇÁÑ∂ËÄåÔºåÂú®Â§ßÂ§öÊï∞Êó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶ÅÊêúÁ¥¢Êï¥‰∏™Â≠óÁ¨¶‰∏≤ÔºåËé∑ÂæóÊâÄÊúâÂåπÈÖçÁöÑÁªìÊûú„ÄÇ findall ÊñπÊ≥ïÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1findall(string[, pos[, endpos]]) ÂÖ∂‰∏≠Ôºåstring ÊòØÂæÖÂåπÈÖçÁöÑÂ≠óÁ¨¶‰∏≤Ôºåpos Âíå endpos ÊòØÂèØÈÄâÂèÇÊï∞ÔºåÊåáÂÆöÂ≠óÁ¨¶‰∏≤ÁöÑËµ∑ÂßãÂíåÁªàÁÇπ‰ΩçÁΩÆÔºåÈªòËÆ§ÂÄºÂàÜÂà´ÊòØ 0 Âíå len (Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶)„ÄÇ findall ‰ª•ÂàóË°®ÂΩ¢ÂºèËøîÂõûÂÖ®ÈÉ®ËÉΩÂåπÈÖçÁöÑÂ≠ê‰∏≤ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂåπÈÖçÔºåÂàôËøîÂõû‰∏Ä‰∏™Á©∫ÂàóË°®„ÄÇ ÁúãÁúã‰æãÂ≠êÔºö 12345678import re pattern = re.compile(r&apos;\d+&apos;) # Êü•ÊâæÊï∞Â≠óresult1 = pattern.findall(&apos;hello 123456 789&apos;)result2 = pattern.findall(&apos;one1two2three3four4&apos;, 0, 10) print result1print result2 ÊâßË°åÁªìÊûúÔºö 12[&apos;123456&apos;, &apos;789&apos;][&apos;1&apos;, &apos;2&apos;] finditer ÊñπÊ≥ïfinditer ÊñπÊ≥ïÁöÑË°å‰∏∫Ë∑ü findall ÁöÑË°å‰∏∫Á±ª‰ººÔºå‰πüÊòØÊêúÁ¥¢Êï¥‰∏™Â≠óÁ¨¶‰∏≤ÔºåËé∑ÂæóÊâÄÊúâÂåπÈÖçÁöÑÁªìÊûú„ÄÇ‰ΩÜÂÆÉËøîÂõû‰∏Ä‰∏™È°∫Â∫èËÆøÈóÆÊØè‰∏Ä‰∏™ÂåπÈÖçÁªìÊûúÔºàMatch ÂØπË±°ÔºâÁöÑËø≠‰ª£Âô®„ÄÇ ÁúãÁúã‰æãÂ≠êÔºö 12345678910111213141516171819# -*- coding: utf-8 -*-import re pattern = re.compile(r&apos;\d+&apos;)result_iter1 = pattern.finditer(&apos;hello 123456 789&apos;)result_iter2 = pattern.finditer(&apos;one1two2three3four4&apos;, 0, 10)print type(result_iter1)print type(result_iter2)print &apos;result1...&apos;for m1 in result_iter1: # m1 ÊòØ Match ÂØπË±° print &apos;matching string: &#123;&#125;, position: &#123;&#125;&apos;.format(m1.group(), m1.span())print &apos;result2...&apos;for m2 in result_iter2: print &apos;matching string: &#123;&#125;, position: &#123;&#125;&apos;.format(m2.group(), m2.span()) ÊâßË°åÁªìÊûúÔºö 12345678&lt;type &apos;callable-iterator&apos;&gt;&lt;type &apos;callable-iterator&apos;&gt;result1...matching string: 123456, position: (6, 12)matching string: 789, position: (13, 16)result2...matching string: 1, position: (3, 4)matching string: 2, position: (7, 8) split ÊñπÊ≥ïsplit ÊñπÊ≥ïÊåâÁÖßËÉΩÂ§üÂåπÈÖçÁöÑÂ≠ê‰∏≤Â∞ÜÂ≠óÁ¨¶‰∏≤ÂàÜÂâ≤ÂêéËøîÂõûÂàóË°®ÔºåÂÆÉÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1split(string[, maxsplit]) ÂÖ∂‰∏≠Ôºåmaxsplit Áî®‰∫éÊåáÂÆöÊúÄÂ§ßÂàÜÂâ≤Ê¨°Êï∞Ôºå‰∏çÊåáÂÆöÂ∞ÜÂÖ®ÈÉ®ÂàÜÂâ≤„ÄÇ ÁúãÁúã‰æãÂ≠êÔºö 1234import re p = re.compile(r&apos;[\s\,\;]+&apos;)print p.split(&apos;a,b;; c d&apos;) ÊâßË°åÁªìÊûúÔºö 1[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;] sub ÊñπÊ≥ïsub ÊñπÊ≥ïÁî®‰∫éÊõøÊç¢„ÄÇÂÆÉÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1sub(repl, string[, count]) ÂÖ∂‰∏≠Ôºårepl ÂèØ‰ª•ÊòØÂ≠óÁ¨¶‰∏≤‰πüÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÂáΩÊï∞Ôºö Â¶ÇÊûú repl ÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂàô‰ºö‰ΩøÁî® repl ÂéªÊõøÊç¢Â≠óÁ¨¶‰∏≤ÊØè‰∏Ä‰∏™ÂåπÈÖçÁöÑÂ≠ê‰∏≤ÔºåÂπ∂ËøîÂõûÊõøÊç¢ÂêéÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂè¶Â§ñÔºårepl ËøòÂèØ‰ª•‰ΩøÁî® \id ÁöÑÂΩ¢ÂºèÊù•ÂºïÁî®ÂàÜÁªÑÔºå‰ΩÜ‰∏çËÉΩ‰ΩøÁî®ÁºñÂè∑ 0Ôºõ Â¶ÇÊûú repl ÊòØÂáΩÊï∞ÔºåËøô‰∏™ÊñπÊ≥ïÂ∫îÂΩìÂè™Êé•Âèó‰∏Ä‰∏™ÂèÇÊï∞ÔºàMatch ÂØπË±°ÔºâÔºåÂπ∂ËøîÂõû‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Áî®‰∫éÊõøÊç¢ÔºàËøîÂõûÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠‰∏çËÉΩÂÜçÂºïÁî®ÂàÜÁªÑÔºâ„ÄÇ count Áî®‰∫éÊåáÂÆöÊúÄÂ§öÊõøÊç¢Ê¨°Êï∞Ôºå‰∏çÊåáÂÆöÊó∂ÂÖ®ÈÉ®ÊõøÊç¢„ÄÇ ÁúãÁúã‰æãÂ≠êÔºö 123456789101112import re p = re.compile(r&apos;(\w+) (\w+)&apos;)s = &apos;hello 123, hello 456&apos;def func(m): return &apos;hi&apos; + &apos; &apos; + m.group(2)print p.sub(r&apos;hello world&apos;, s) # ‰ΩøÁî® &apos;hello world&apos; ÊõøÊç¢ &apos;hello 123&apos; Âíå &apos;hello 456&apos;print p.sub(r&apos;\2 \1&apos;, s) # ÂºïÁî®ÂàÜÁªÑprint p.sub(func, s)print p.sub(func, s, 1) # ÊúÄÂ§öÊõøÊç¢‰∏ÄÊ¨° ÊâßË°åÁªìÊûúÔºö 1234hello world, hello world123 hello, 456 hellohi 123, hi 456hi 123, hello 456 subn ÊñπÊ≥ïsubn ÊñπÊ≥ïË∑ü sub ÊñπÊ≥ïÁöÑË°å‰∏∫Á±ª‰ººÔºå‰πüÁî®‰∫éÊõøÊç¢„ÄÇÂÆÉÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1subn(repl, string[, count]) ÂÆÉËøîÂõû‰∏Ä‰∏™ÂÖÉÁªÑÔºö 1(sub(repl, string[, count]), ÊõøÊç¢Ê¨°Êï∞) ÂÖÉÁªÑÊúâ‰∏§‰∏™ÂÖÉÁ¥†ÔºåÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØ‰ΩøÁî® sub ÊñπÊ≥ïÁöÑÁªìÊûúÔºåÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†ËøîÂõûÂéüÂ≠óÁ¨¶‰∏≤Ë¢´ÊõøÊç¢ÁöÑÊ¨°Êï∞„ÄÇ ÁúãÁúã‰æãÂ≠êÔºö 123456789101112import re p = re.compile(r&apos;(\w+) (\w+)&apos;)s = &apos;hello 123, hello 456&apos;def func(m): return &apos;hi&apos; + &apos; &apos; + m.group(2)print p.subn(r&apos;hello world&apos;, s)print p.subn(r&apos;\2 \1&apos;, s)print p.subn(func, s)print p.subn(func, s, 1) ÊâßË°åÁªìÊûúÔºö 1234(&apos;hello world, hello world&apos;, 2)(&apos;123 hello, 456 hello&apos;, 2)(&apos;hi 123, hi 456&apos;, 2)(&apos;hi 123, hello 456&apos;, 1) ÂÖ∂‰ªñÂáΩÊï∞‰∫ãÂÆû‰∏äÔºå‰ΩøÁî® compile ÂáΩÊï∞ÁîüÊàêÁöÑ Pattern ÂØπË±°ÁöÑ‰∏ÄÁ≥ªÂàóÊñπÊ≥ïË∑ü re Ê®°ÂùóÁöÑÂ§öÊï∞ÂáΩÊï∞ÊòØÂØπÂ∫îÁöÑÔºå‰ΩÜÂú®‰ΩøÁî®‰∏äÊúâÁªÜÂæÆÂ∑ÆÂà´„ÄÇ match ÂáΩÊï∞match ÂáΩÊï∞ÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1re.match(pattern, string[, flags]): ÂÖ∂‰∏≠Ôºåpattern ÊòØÊ≠£ÂàôË°®ËææÂºèÁöÑÂ≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÔºåÊØîÂ¶Ç \d+, [a-z]+„ÄÇ ËÄå Pattern ÂØπË±°ÁöÑ match ÊñπÊ≥ï‰ΩøÁî®ÂΩ¢ÂºèÊòØÔºö 1match(string[, pos[, endpos]]) ÂèØ‰ª•ÁúãÂà∞Ôºåmatch ÂáΩÊï∞‰∏çËÉΩÊåáÂÆöÂ≠óÁ¨¶‰∏≤ÁöÑÂå∫Èó¥ÔºåÂÆÉÂè™ËÉΩÊêúÁ¥¢Â§¥ÈÉ®ÔºåÁúãÁúã‰æãÂ≠êÔºö 12345678910111213import rem1 = re.match(r&apos;\d+&apos;, &apos;One12twothree34four&apos;)if m1: print &apos;matching string:&apos;,m1.group()else: print &apos;m1 is:&apos;,m1 m2 = re.match(r&apos;\d+&apos;, &apos;12twothree34four&apos;)if m2: print &apos;matching string:&apos;, m2.group()else: print &apos;m2 is:&apos;,m2 ÊâßË°åÁªìÊûúÔºö 12m1 is: Nonematching string: 12 search ÂáΩÊï∞search ÂáΩÊï∞ÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1re.search(pattern, string[, flags]) search ÂáΩÊï∞‰∏çËÉΩÊåáÂÆöÂ≠óÁ¨¶‰∏≤ÁöÑÊêúÁ¥¢Âå∫Èó¥ÔºåÁî®Ê≥ïË∑ü Pattern ÂØπË±°ÁöÑ search ÊñπÊ≥ïÁ±ª‰ºº„ÄÇ findall ÂáΩÊï∞findall ÂáΩÊï∞ÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1re.findall(pattern, string[, flags]) findall ÂáΩÊï∞‰∏çËÉΩÊåáÂÆöÂ≠óÁ¨¶‰∏≤ÁöÑÊêúÁ¥¢Âå∫Èó¥ÔºåÁî®Ê≥ïË∑ü Pattern ÂØπË±°ÁöÑ findall ÊñπÊ≥ïÁ±ª‰ºº„ÄÇ ÁúãÁúã‰æãÂ≠êÔºö 123456import reprint re.findall(r&apos;\d+&apos;, &apos;hello 12345 789&apos;)# ËæìÂá∫[&apos;12345&apos;, &apos;789&apos;] finditer ÂáΩÊï∞finditer ÂáΩÊï∞ÁöÑ‰ΩøÁî®ÊñπÊ≥ïË∑ü Pattern ÁöÑ finditer ÊñπÊ≥ïÁ±ª‰ººÔºåÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1re.finditer(pattern, string[, flags]) split ÂáΩÊï∞split ÂáΩÊï∞ÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1re.split(pattern, string[, maxsplit]) sub ÂáΩÊï∞sub ÂáΩÊï∞ÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1re.sub(pattern, repl, string[, count]) subn ÂáΩÊï∞subn ÂáΩÊï∞ÁöÑ‰ΩøÁî®ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºö 1re.subn(pattern, repl, string[, count]) Âà∞Â∫ïÁî®Âì™ÁßçÊñπÂºè‰ªé‰∏äÊñáÂèØ‰ª•ÁúãÂà∞Ôºå‰ΩøÁî® re Ê®°ÂùóÊúâ‰∏§ÁßçÊñπÂºèÔºö ‰ΩøÁî® re.compile ÂáΩÊï∞ÁîüÊàê‰∏Ä‰∏™ Pattern ÂØπË±°ÔºåÁÑ∂Âêé‰ΩøÁî® Pattern ÂØπË±°ÁöÑ‰∏ÄÁ≥ªÂàóÊñπÊ≥ïÂØπÊñáÊú¨ËøõË°åÂåπÈÖçÊü•ÊâæÔºõ Áõ¥Êé•‰ΩøÁî® re.match, re.search Âíå re.findall Á≠âÂáΩÊï∞Áõ¥Êé•ÂØπÊñáÊú¨ÂåπÈÖçÊü•ÊâæÔºõ ‰∏ãÈù¢ÔºåÊàë‰ª¨Áî®‰∏Ä‰∏™‰æãÂ≠êÂ±ïÁ§∫Ëøô‰∏§ÁßçÊñπÊ≥ï„ÄÇ ÂÖàÁúãÁ¨¨ 1 ÁßçÁî®Ê≥ïÔºö 12345678import re# Â∞ÜÊ≠£ÂàôË°®ËææÂºèÂÖàÁºñËØëÊàê Pattern ÂØπË±°pattern = re.compile(r&apos;\d+&apos;)print pattern.match(&apos;123, 123&apos;)print pattern.search(&apos;234, 234&apos;)print pattern.findall(&apos;345, 345&apos;) ÂÜçÁúãÁ¨¨ 2 ÁßçÁî®Ê≥ïÔºö 12345import reprint re.match(r&apos;\d+&apos;, &apos;123, 123&apos;)print re.search(r&apos;\d+&apos;, &apos;234, 234&apos;)print re.findall(r&apos;\d+&apos;, &apos;345, 345&apos;) Â¶ÇÊûú‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèÈúÄË¶ÅÁî®Âà∞Â§öÊ¨°ÔºàÊØîÂ¶Ç‰∏äÈù¢ÁöÑ \d+ÔºâÔºåÂú®Â§öÁßçÂú∫ÂêàÁªèÂ∏∏ÈúÄË¶ÅË¢´Áî®Âà∞ÔºåÂá∫‰∫éÊïàÁéáÁöÑËÄÉËôëÔºåÊàë‰ª¨Â∫îËØ•È¢ÑÂÖàÁºñËØëËØ•Ê≠£ÂàôË°®ËææÂºèÔºåÁîüÊàê‰∏Ä‰∏™ Pattern ÂØπË±°ÔºåÂÜç‰ΩøÁî®ËØ•ÂØπË±°ÁöÑ‰∏ÄÁ≥ªÂàóÊñπÊ≥ïÂØπÈúÄË¶ÅÂåπÈÖçÁöÑÊñá‰ª∂ËøõË°åÂåπÈÖçÔºõËÄåÂ¶ÇÊûúÁõ¥Êé•‰ΩøÁî® re.match, re.search Á≠âÂáΩÊï∞ÔºåÊØèÊ¨°‰º†ÂÖ•‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèÔºåÂÆÉÈÉΩ‰ºöË¢´ÁºñËØë‰∏ÄÊ¨°ÔºåÊïàÁéáÂ∞±‰ºöÂ§ßÊâìÊäòÊâ£„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨Êé®Ëçê‰ΩøÁî®Á¨¨ 1 ÁßçÁî®Ê≥ï„ÄÇ ÂåπÈÖç‰∏≠ÊñáÂú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÊÉ≥ÂåπÈÖçÊñáÊú¨‰∏≠ÁöÑÊ±âÂ≠óÔºåÊúâ‰∏ÄÁÇπÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå‰∏≠ÊñáÁöÑ unicode ÁºñÁ†ÅËåÉÂõ¥ ‰∏ªË¶ÅÂú® [\u4e00-\u9fa5]ÔºåËøôÈáåËØ¥‰∏ªË¶ÅÊòØÂõ†‰∏∫Ëøô‰∏™ËåÉÂõ¥Âπ∂‰∏çÂÆåÊï¥ÔºåÊØîÂ¶ÇÊ≤°ÊúâÂåÖÊã¨ÂÖ®ËßíÔºà‰∏≠ÊñáÔºâÊ†áÁÇπÔºå‰∏çËøáÔºåÂú®Â§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÔºåÂ∫îËØ•ÊòØÂ§üÁî®ÁöÑ„ÄÇ ÂÅáËÆæÁé∞Âú®ÊÉ≥ÊääÂ≠óÁ¨¶‰∏≤ title = u&#39;‰Ω†Â•ΩÔºåhelloÔºå‰∏ñÁïå&#39; ‰∏≠ÁöÑ‰∏≠ÊñáÊèêÂèñÂá∫Êù•ÔºåÂèØ‰ª•Ëøô‰πàÂÅöÔºö 123456789# -*- coding: utf-8 -*-import retitle = u&apos;‰Ω†Â•ΩÔºåhelloÔºå‰∏ñÁïå&apos;pattern = re.compile(ur&apos;[\u4e00-\u9fa5]+&apos;)result = pattern.findall(title)print result Ê≥®ÊÑèÂà∞ÔºåÊàë‰ª¨Âú®Ê≠£ÂàôË°®ËææÂºèÂâçÈù¢Âä†‰∏ä‰∫Ü‰∏§‰∏™ÂâçÁºÄ urÔºåÂÖ∂‰∏≠ r Ë°®Á§∫‰ΩøÁî®ÂéüÂßãÂ≠óÁ¨¶‰∏≤Ôºåu Ë°®Á§∫ÊòØ unicode Â≠óÁ¨¶‰∏≤„ÄÇ ÊâßË°åÁªìÊûú: 1[u&apos;\u4f60\u597d&apos;, u&apos;\u4e16\u754c&apos;] Ë¥™Â©™ÂåπÈÖçÂú® Python ‰∏≠ÔºåÊ≠£ÂàôÂåπÈÖçÈªòËÆ§ÊòØË¥™Â©™ÂåπÈÖçÔºàÂú®Â∞ëÊï∞ËØ≠Ë®Ä‰∏≠ÂèØËÉΩÊòØÈùûË¥™Â©™ÔºâÔºå‰πüÂ∞±ÊòØÂåπÈÖçÂ∞ΩÂèØËÉΩÂ§öÁöÑÂ≠óÁ¨¶„ÄÇ ÊØîÂ¶ÇÔºåÊàë‰ª¨ÊÉ≥ÊâæÂá∫Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÊâÄÊúâ div ÂùóÔºö 1234567import recontent = &apos;aa&lt;div&gt;test1&lt;/div&gt;bb&lt;div&gt;test2&lt;/div&gt;cc&apos;pattern = re.compile(r&apos;&lt;div&gt;.*&lt;/div&gt;&apos;)result = pattern.findall(content)print result ÊâßË°åÁªìÊûúÔºö 1[&apos;&lt;div&gt;test1&lt;/div&gt;bb&lt;div&gt;test2&lt;/div&gt;&apos;] Áî±‰∫éÊ≠£ÂàôÂåπÈÖçÊòØË¥™Â©™ÂåπÈÖçÔºå‰πüÂ∞±ÊòØÂ∞ΩÂèØËÉΩÂ§öÁöÑÂåπÈÖçÔºåÂõ†Ê≠§ÔºåÂú®ÊàêÂäüÂåπÈÖçÂà∞Á¨¨‰∏Ä‰∏™ &lt;/div&gt; Êó∂ÔºåÂÆÉËøò‰ºöÂêëÂè≥Â∞ùËØïÂåπÈÖçÔºåÊü•ÁúãÊòØÂê¶ËøòÊúâÊõ¥ÈïøÁöÑÂèØ‰ª•ÊàêÂäüÂåπÈÖçÁöÑÂ≠ê‰∏≤„ÄÇ Â¶ÇÊûúÊàë‰ª¨ÊÉ≥ÈùûË¥™Â©™ÂåπÈÖçÔºåÂèØ‰ª•Âä†‰∏Ä‰∏™ ?ÔºåÂ¶Ç‰∏ãÔºö 1234567import recontent = &apos;aa&lt;div&gt;test1&lt;/div&gt;bb&lt;div&gt;test2&lt;/div&gt;cc&apos;pattern = re.compile(r&apos;&lt;div&gt;.*?&lt;/div&gt;&apos;) # Âä†‰∏ä ?result = pattern.findall(content)print result ÁªìÊûúÔºö 1[&apos;&lt;div&gt;test1&lt;/div&gt;&apos;, &apos;&lt;div&gt;test2&lt;/div&gt;&apos;] Â∞èÁªì re Ê®°ÂùóÁöÑ‰∏ÄËà¨‰ΩøÁî®Ê≠•È™§Â¶Ç‰∏ãÔºö ‰ΩøÁî® compile ÂáΩÊï∞Â∞ÜÊ≠£ÂàôË°®ËææÂºèÁöÑÂ≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÁºñËØë‰∏∫‰∏Ä‰∏™ Pattern ÂØπË±°Ôºõ ÈÄöËøá Pattern ÂØπË±°Êèê‰æõÁöÑ‰∏ÄÁ≥ªÂàóÊñπÊ≥ïÂØπÊñáÊú¨ËøõË°åÂåπÈÖçÊü•ÊâæÔºåËé∑ÂæóÂåπÈÖçÁªìÊûúÔºà‰∏Ä‰∏™ Match ÂØπË±°ÔºâÔºõ ÊúÄÂêé‰ΩøÁî® Match ÂØπË±°Êèê‰æõÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïËé∑Âæó‰ø°ÊÅØÔºåÊ†πÊçÆÈúÄË¶ÅËøõË°åÂÖ∂‰ªñÁöÑÊìç‰ΩúÔºõ Python ÁöÑÊ≠£ÂàôÂåπÈÖçÈªòËÆ§ÊòØË¥™Â©™ÂåπÈÖç„ÄÇ]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vimÂ∏∏Áî®ÂëΩ‰ª§‰∏éÊäÄÂ∑ß(‰∏çÂÆöÊúüÊõ¥Êñ∞).md]]></title>
    <url>%2F2019%2F04%2F21%2Fvim%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8A%80%E5%B7%A7-md%2F</url>
    <content type="text"><![CDATA[VimÂ∏∏Áî®ÁöÑÂëΩ‰ª§‰∏éÊäÄÂ∑ßÊÄªÁªìÔºö Âú®ÊØèË°åË°åÈ¶ñÊ∑ªÂä†Áõ∏ÂêåÁöÑÂÜÖÂÆπÔºö 1:%s/^/Ë¶ÅÊ∑ªÂä†ÁöÑÂÜÖÂÆπ Âú®ÊØèË°åË°åÂ∞æÊ∑ªÂä†Áõ∏ÂêåÁöÑÂÜÖÂÆπÔºö 1:%s/$/Ë¶ÅÊ∑ªÂä†ÁöÑÂÜÖÂÆπ Âà©Áî®Ê≠£ÂàôË°®ËææÂºèÂà†Èô§‰ª£Á†ÅÊÆµÊØèË°åÁöÑË°åÂè∑ 123:%s/^\s*[0-9]*\s*//gcÂÖ∂‰∏≠Ôºå^Ë°®Á§∫Ë°åÈ¶ñÔºå$Ë°®Á§∫Ë°åÂ∞æÔºå\sË°®Á§∫Á©∫Ê†ºÔºå[0-9]Ë°®Á§∫0~9ÁöÑÊï∞Â≠óÔºå*Ë°®Á§∫0ÊàñÂ§ö‰∏™Ôºå%s/^\s*[0-9]*\s*//gcÁöÑÊÑèÊÄùÊòØÂ∞ÜÊØèË°å‰ª•0ÊàñÂ§ö‰∏™Á©∫Ê†ºÂºÄÂßã‰∏≠Èó¥ÂåÖÂê´0ÊàñÂ§ö‰∏™Êï∞Â≠óÂπ∂‰ª•0ÊàñÂ§ö‰∏™Á©∫Ê†ºÁªìÊùüÁöÑÂ≠óÁ¨¶‰∏≤ÊõøÊç¢‰∏∫Á©∫„ÄÇ ÊåáÂÆöË°åÈ¶ñÊ∑ªÂä†‚Äù#‚Äù 12:447,945 s/^/#447-945Ë°åÁöÑË°åÈ¶ñÊ∑ªÂä† # Âà†Èô§ÊØèË°åÂâçÈù¢ÁöÑÂÜÖÂÆπ 1:10,15 s/^/#//gc ÁªüËÆ°mÂà∞nË°å‰∏≠‚ÄùÂ≠óÁ¨¶‰∏≤‚ÄùÂá∫Áé∞ÁöÑÊ¨°Êï∞ 1:m,n s/Â≠óÁ¨¶‰∏≤//gn ÁªüËÆ°‚ÄùÂ≠óÁ¨¶‰∏≤‚ÄùÂú®ÂΩìÂâçÁºñËæëÊñá‰ª∂Âá∫Áé∞ÁöÑÊ¨°Êï∞ 1: %s/Â≠óÁ¨¶‰∏≤/ng ÁªüËÆ°ËØçËØ≠Âú®Êñá‰ª∂‰∏≠Âá∫Áé∞ÁöÑË°åÊï∞: 1cat file|grep -i Â≠óÁ¨¶‰∏≤ |wc -l pycharm‰∏≠vimÊèí‰ª∂ÊâπÈáèÁº©ËøõÔºö 12345:m,n &gt;//ÂêëÂè≥Áº©Ëøõ4Á©∫Ê†º:m,n &lt; //ÂêëÂ∑¶Áº©Ëøõ4Á©∫Ê†º Ë∑≥ËΩ¨Âà∞Ë°åÈ¶ñ: ^ Ë∑≥ËΩ¨Âà∞Ë°åÂ∞æ:$ Ë∑≥ËΩ¨Âà∞Êñá‰ª∂ÂºÄÂ§¥: gg Ë∑≥ËΩ¨Âà∞Ë°åÂ∞æÔºöG]]></content>
      <categories>
        <category>vim</category>
      </categories>
      <tags>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IRCÂ∏∏Áî®ÂëΩ‰ª§]]></title>
    <url>%2F2019%2F04%2F19%2FIRC%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[‰∏ãÈù¢ÊòØÂ∏∏Áî®ÂëΩ‰ª§ /Âú®‰∏çÂºïËµ∑Ê∑∑Ê∑ÜÁöÑÊÉÖÂÜµ‰∏ãÔºåIRCÂëΩ‰ª§ÂÖÅËÆ∏ÁÆÄÂÜô„ÄÇ‰æãÂ¶ÇÔºå/join ÂëΩ‰ª§ÂèØ‰ª•ÁÆÄÂÜô‰∏∫/jÔºå/joÊàñËÄÖ/joi„ÄÇ /nick Êõ¥ÊîπÊòµÁß∞ÁöÑÂü∫Êú¨ÊñπÊ≥ïÊòØÔºö/n(ick) Êñ∞ÁöÑÊòµÁß∞ ÊÇ®ÁöÑÊòµÁß∞ÂèØ‰ª•ÂåÖÂê´Ëã±ÊñáÂ≠óÊØçÔºåÊï∞Â≠óÔºåÊ±âÂ≠óÂèä‰∏ãÂàíÁ∫øÁ≠â„ÄÇ‰ΩÜÊòØÔºåÊòµÁß∞‰∏çËÉΩË∂ÖËøá50‰∏™ÔºàÊØè‰∏™Â≠óÁ¨¶ÂíåÊ±âÂ≠óÈÉΩÁÆó‰∏Ä‰∏™Â≠óÔºâÔºåËÄå‰∏î‰∏çËÉΩÂåÖÂê´$Ôºå+ÔºåÔºÅÂíåÁ©∫Ê†º„ÄÇ /nick ÂëΩ‰ª§Á≠â‰ª∑‰∫éÂ∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúÊîπÂèòÂà´Âêç‚Äù„ÄÇ /join /joinÂëΩ‰ª§ÁöÑÊ†ºÂºèÊòØÔºö/j(oin) ËÅäÂ§©ÂÆ§Âêç Â¶ÇÊûúËÅäÂ§©ÂÆ§Â∑≤ÁªèÂ≠òÂú®ÔºåÊÇ®Â∞±ËøõÂÖ•ËØ•ËÅäÂ§©ÂÆ§„ÄÇÊ≠§Êó∂Ôºå/join ÂëΩ‰ª§Á≠â‰ª∑‰∫éËÅäÂ§©ÂÆ§ÂàóË°®Â∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúËøõÂÖ•‚Äù„ÄÇ Â¶ÇÊûúËÅäÂ§©ÂÆ§‰∏çÂ≠òÂú®ÔºåÊÇ®Â∞±Âª∫Á´ã‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑËÅäÂ§©ÂÆ§Âπ∂ËøõÂÖ•„ÄÇÊ≠§Êó∂Ôºå/join ÂëΩ‰ª§Á≠â‰ª∑‰∫éÂ∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúÂª∫ËÅäÂ§©ÂÆ§‚Äù„ÄÇ ËÅäÂ§©ÂÆ§ÁöÑÂêçÂ≠óÂèØ‰ª•ÂåÖÂê´Ëã±ÊñáÂ≠óÊØçÔºåÊï∞Â≠óÔºåÊ±âÂ≠óÂèä‰∏ãÂàíÁ∫øÁ≠â„ÄÇ‰ΩÜÊòØÔºå‰∏çËÉΩË∂ÖËøá50‰∏™Â≠óÔºàÊØè‰∏™Â≠óÁ¨¶ÂíåÊ±âÂ≠óÈÉΩÁÆó‰∏Ä‰∏™Â≠óÔºâÔºåËÄå‰∏î‰∏çËÉΩÂåÖÂê´$Ôºå+ÔºåÔºÅÂíåÁ©∫Ê†º„ÄÇ /mode +(-)i /mode +(-)i ÂëΩ‰ª§ÂèØ‰ª•Áî®Êù•ÈîÅ‰ΩèÔºàËß£ÈîÅÔºâÁî®Êà∑Ëá™Âª∫ÁöÑËÅäÂ§©ÂÆ§ÔºàÁßÅ‰∫∫ËÅäÂ§©ÂÆ§Ôºâ„ÄÇÂÖ∂ÂëΩ‰ª§Ê†ºÂºèÊòØ:/m(ode) +i Êàñ /m(ode) -i Âè™ÊúâÁî®Êà∑Ëá™Âª∫ÁöÑËÅäÂ§©ÂÆ§ÊâçËÉΩÂä†ÈîÅ„ÄÇ Êú™ÁªèÁÆ°ÁêÜÂëòÈÇÄËØ∑ÔºåÂÖ∂‰ªñÁî®Êà∑‰∏çËÉΩËøõÂÖ•ÁßÅ‰∫∫ËÅäÂ§©ÂÆ§„ÄÇ /mode +(-)o /mode +(-)o ÂëΩ‰ª§ÂèØ‰ª•ËÆ©ËÅäÂ§©ÂÆ§ÁÆ°ÁêÜÂëòËµã‰∫àÊàñËÄÖÂâ•Â§∫ÂÖ∂‰ªñÁî®Êà∑ÁöÑÁÆ°ÁêÜÂëòË∫´‰ªΩ„ÄÇÂÖ∂ÂëΩ‰ª§Ê†ºÂºèÊòØÔºö/m(ode) +o Áî®Êà∑ÊòµÁß∞Êàñ/m(ode)-oÁî®Êà∑ÊòµÁß∞Âè™ÊúâËÅäÂ§©ÂÆ§ÁÆ°ÁêÜÂëòÊâçËÉΩ‰ΩøÁî®Ëøô‰∏™ÂëΩ‰ª§„ÄÇ /knock /knock ÂëΩ‰ª§ÂèØ‰ª•ËÆ©ÊÇ®ËØ¢ÈóÆÁßÅ‰∫∫ËÅäÂ§©ÂÆ§ÁÆ°ÁêÜÂëòÊòØÂê¶ÂèØ‰ª•ËøõÂÖ•ËØ•ÁßÅ‰∫∫ËÅäÂ§©ÂÆ§„ÄÇÂÖ∂ÂëΩ‰ª§Ê†ºÂºèÊòØÔºö/k(nock) ÊàøÈó¥Âêç Ê∂àÊÅØ] /invite /invite ÂëΩ‰ª§ÂèØ‰ª•ËÆ©ËÅäÂ§©ÂÆ§ÁÆ°ÁêÜÂëòÈÇÄËØ∑ÂÖ∂‰ªñÁî®Êà∑ËøõÂÖ•ÁßÅ‰∫∫ËÅäÂ§©ÂÆ§„ÄÇÂÖ∂ÂëΩ‰ª§Ê†ºÂºèÊòØ:/i(nvite) Áî®Êà∑ÊòµÁß∞ Âè™ÊúâÁßÅ‰∫∫ËÅäÂ§©ÂÆ§ÁöÑÁÆ°ÁêÜÂëòÊâçËÉΩ‰ΩøÁî®Ëøô‰∏™ÂëΩ‰ª§„ÄÇ /privmsg /privmsg ÂëΩ‰ª§Áî®Êù•ÂêëÂú®Âêå‰∏ÄÈó¥ËÅäÂ§©ÂÆ§ÁöÑÊüê‰∏™Áî®Êà∑ÂèëÈÄÅÁßÅ‰∫∫Ê∂àÊÅØÔºàÊÇÑÊÇÑËØùÔºâ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÊÇ®ÁöÑÊ∂àÊÅØÂè™ÈÄÅÁªôÊåáÂÆöÁöÑ‰∫∫ÔºåËÄå‰∏ç‰ºöÊòæÁ§∫ÁªôÂÖ∂‰ªñÁî®Êà∑„ÄÇ /privmsg ÂëΩ‰ª§ÁöÑÂü∫Êú¨Ê†ºÂºèÊòØÔºö /p(rivmsg) Áî®Êà∑ÊòµÁß∞ Ê∂àÊÅØ Êé•ÂèóÊÇ®ÁöÑÁßÅ‰∫∫Ê∂àÊÅØÁöÑÁî®Êà∑ÂøÖÈ°ªÂíåÊÇ®Âú®Âêå‰∏ÄÈó¥ËÅäÂ§©ÂÆ§„ÄÇ ‚ÄúÁî®Êà∑ÊòµÁß∞‚ÄùÂíå‚ÄúÊ∂àÊÅØ‚ÄùËøô‰∏§‰∏™ÂèÇÊï∞ÊòØ‰∏çËÉΩÁúÅÁï•ÁöÑ„ÄÇ Â¶ÇÊûúÊüê‰∏™Áî®Êà∑ÁöÑÊòµÁß∞Â§™ÈïøÔºåÂú®‰∏ç‰ºö‰∫ßÁîüÊ∑∑Ê∑ÜÁöÑÊÉÖÂÜµ‰∏ãÔºåÊÇ®ÂèØ‰ª•Âè™ËæìÂÖ•Áî®Êà∑ÊòµÁß∞ÁöÑÂ§¥Âá†‰∏™Â≠óÊØçÔºåÁ≥ªÁªü‰ºöËøõË°åËá™Âä®ÂåπÈÖç„ÄÇ ‰æãÂ¶ÇÔºöËÅäÂ§©ÂÆ§ÈáåÈô§‰∫ÜÊÇ®‰πãÂ§ñËøòÊúâ‰∏§‰∏™Áî®Êà∑Ôºå‰ªñ‰ª¨ÁöÑÊòµÁß∞ÂàÜÂà´ÊòØxiaobaoÂíåsoftman„ÄÇÊÇ®Ëã•ÊÉ≥ÁªôsoftmanÂèëÈÄÅÊÇÑÊÇÑËØùÔºåÂèØ‰ª•Âú®ËæìÂÖ•Ê°ÜÈáåËæìÂÖ•‰∏ãÈù¢ÁöÑÂëΩ‰ª§Ôºö /p s Have you etanged today? Áî±‰∫éxiaobaoÂíåsoftmanÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÊØçÂ∞±‰∏ç‰∏ÄÊ†∑ÔºåÊâÄ‰ª•Á≥ªÁªü‰ºöÊääÊÇ®ËæìÂÖ•ÁöÑÊòµÁß∞‚Äús‚ÄùËá™Âä®ÂåπÈÖç‰∏∫‚Äúsoftman‚Äù„ÄÇÂè¶Â§ñÔºå‚Äú/p‚ÄùÊòØ‚Äú/privmsg‚ÄùÁöÑÁº©ÂÜô„ÄÇ /ignore /ignore ÂëΩ‰ª§Áî®Êù•ÊääÊüê‰∏™Áî®Êà∑Âä†ÂÖ•ÊÇ®ÁöÑ‚ÄúÂùè‰∫∫ÈªëÂêçÂçï‚Äù„ÄÇ‰∏ÄÊó¶Êüê‰∏™Áî®Êà∑ËøõÂÖ•‰∫ÜÊÇ®ÁöÑÈªëÂêçÂçïÔºå‰ªñËØ¥ÁöÑ‰ªª‰ΩïËØùÈÉΩÂ∞Ü‰∏ç‰ºöÊòæÁ§∫Âú®ÊÇ®ÁöÑÁªàÁ´Ø‰∏ä„ÄÇ /ignore ÂëΩ‰ª§ÁöÑÂü∫Êú¨Ê†ºÂºèÊòØÔºö/ig(nore) Áî®Êà∑ÊòµÁß∞ Áî®Êà∑ÊòµÁß∞ÊâÄ‰ª£Ë°®ÁöÑÁî®Êà∑ÂøÖÈ°ªÂíåÊÇ®Âú®Âêå‰∏Ä‰∏™ËÅäÂ§©ÂÆ§„ÄÇ /ignore ÂëΩ‰ª§Á≠â‰ª∑‰∫éÁî®Êà∑ÂàóË°®Â∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúÂøΩÁï•‚Äù„ÄÇ Â¶ÇÊûúÊüê‰∏™Áî®Êà∑ÁöÑÊòµÁß∞Â§™ÈïøÔºåÂú®‰∏ç‰ºö‰∫ßÁîüÊ∑∑Ê∑ÜÁöÑÊÉÖÂÜµ‰∏ãÔºåÊÇ®ÂèØ‰ª•Âè™ËæìÂÖ•Áî®Êà∑ÊòµÁß∞ÁöÑÂ§¥Âá†‰∏™Â≠óÊØçÔºåÁ≥ªÁªü‰ºöËøõË°åËá™Âä®ÂåπÈÖç„ÄÇ Âú®ÊÇ®ÁöÑÁî®Êà∑ÂàóË°®‰∏≠ÔºåÂ¶ÇÊûúÊüê‰∏™Áî®Êà∑ÊòµÁß∞ÂâçÊúâ‰∏Ä‰∏™#ÔºåË°®Á§∫ËØ•Áî®Êà∑Â∑≤ÁªèË¢´ÊÇ®ÂàóÂÖ•ÈªëÂêçÂçï„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™Áî®Êà∑Â∑≤ÁªèÂú®ÊÇ®ÁöÑÈªëÂêçÂçï‰∏≠ÔºåÊÇ®ÂèØ‰ª•Áî® /ignore Áî®Êà∑ÊòµÁß∞ Êää‰ªñ‰ªéÈªëÂêçÂçï‰∏≠ÂéªÊéâ„ÄÇ /away /away ÂëΩ‰ª§Áî®Êù•ÊääËá™Â∑±ËÆæ‰∏∫‚ÄúÊöÇÊó∂Á¶ªÂºÄ‚ÄùÁä∂ÊÄÅÔºåÂπ∂ÂèØ‰ª•ÁïôË®ÄÁªôÂÖ∂‰ªñÁî®Êà∑„ÄÇÂΩìÂÖ∂‰ªñÁî®Êà∑ÂíåÊÇ®ËØ¥ÊÇÑÊÇÑËØùÊó∂ÔºåÊÇ®È¢ÑÂÖàËÆæÁΩÆÁöÑÁïôË®Ä‰ºöËá™Âä®ÂõûÂ§çÁªôÂÖ∂‰ªñÁî®Êà∑„ÄÇ /away ÂëΩ‰ª§ÁöÑÂü∫Êú¨Ê†ºÂºèÊòØÔºö/a(way) [ÁïôË®Ä] ‚ÄúÁïôË®Ä‚ÄùËøô‰∏™ÂèÇÊï∞ÊòØÂèØÈÄâÁöÑ„ÄÇÂ¶ÇÊûúÊúâËøô‰∏™ÂèÇÊï∞ÔºåÊÇ®ÁöÑÁä∂ÊÄÅ‰ºöË¢´ËÆæÁΩÆ‰∏∫‚ÄúÊöÇÊó∂Á¶ªÂºÄ‚Äù„ÄÇÂê¶ÂàôÔºåÊÇ®ÁöÑÁä∂ÊÄÅ‰ºöË¢´ËÆæÁΩÆ‰∏∫‚ÄúÊàëÂõûÊù•‰∫Ü‚Äù„ÄÇ ÂΩìÊÇ®ÊöÇÊó∂Á¶ªÂºÄËÅäÂ§©ÂÆ§Êó∂ÔºåÁî®Êà∑ÂàóË°®‰∏≠ÊÇ®ÁöÑÊòµÁß∞Ââç‰ºöÂá∫Áé∞‰∏Ä‰∏™?ÔºåË°®Á§∫ÊÇ®Â§Ñ‰∫é‚ÄúÁ¶ªÂºÄ‚ÄùÁä∂ÊÄÅ„ÄÇÂ∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúÊöÇÊó∂Á¶ªÂºÄ‚Äù‰πü‰ºöÂèò‰∏∫‚ÄúÊàëÂõûÊù•‰∫Ü‚Äù„ÄÇ ÂΩìÊÇ®ÂõûÊù•ÁªßÁª≠ËÅäÂ§©Êó∂ÔºåÊÇ®ÂèØ‰ª•ÁÇπÂáªÂ∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúÊàëÂõûÊù•‰∫Ü‚ÄùÔºåÊàñËÄÖÂú®ËæìÂÖ•Ê°ÜÈáåËæìÂÖ• /away ÂëΩ‰ª§ÔºåÂ∞ÜËá™Â∑±ËÆæÁΩÆ‰∏∫Ê≠£Â∏∏Áä∂ÊÄÅ„ÄÇ /away ÂëΩ‰ª§Á≠â‰ª∑‰∫éÂ∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúÊöÇÊó∂Á¶ªÂºÄ‚Äù /whois /whois ÂëΩ‰ª§Áî®Êù•Êü•ËØ¢Êüê‰∏™Áî®Êà∑ÁöÑ‰ø°ÊÅØÔºåÂåÖÊã¨Áî®Êà∑ÁöÑ‰∫øÂîêIDÔºåIPÂú∞ÂùÄÔºåÁõÆÂâçÊâÄÂú®ÁöÑËÅäÂ§©ÂÆ§ÂíåÂèëÂëÜÊó∂Èó¥„ÄÇ /whois ÂëΩ‰ª§ÁöÑÂü∫Êú¨Ê†ºÂºèÊòØÔºö/w(hois) Áî®Êà∑ÊòµÁß∞ /whoisÂëΩ‰ª§Á≠â‰ª∑‰∫éÁî®Êà∑ÂàóË°®Â∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúÊü•ËØ¢‚Äù„ÄÇ /names /names ÂëΩ‰ª§Áî®Êù•Êü•ÁúãÂΩìÂâçÊâÄÊúâÔºàÊàñÊüê‰∏™ËÅäÂ§©ÂÆ§ÂÜÖÔºâÁöÑÂú®Á∫øËÅäÂ§©Áî®Êà∑„ÄÇÂÖ∂ÂëΩ‰ª§Ê†ºÂºèÊòØÔºö/na(mes) [ËÅäÂ§©ÂÆ§] /topic /topic ÂëΩ‰ª§Áî®Êù•ËÆæÂÆöÂΩìÂâçËÅäÂ§©ÂÆ§ÁöÑ‰∏ªÈ¢ò„ÄÇ /topic ÂëΩ‰ª§ÁöÑÂü∫Êú¨Ê†ºÂºèÊòØÔºö/t(opic) ËÅäÂ§©ÂÆ§‰∏ªÈ¢ò Âè™ÊúâÂΩìÂâçËÅäÂ§©ÂÆ§ÁöÑÁÆ°ÁêÜÂëòÔºàopÔºâÊâçÊúâÊùÉÂà©ËÆæÂÆöËÅäÂ§©ÂÆ§‰∏ªÈ¢ò„ÄÇ ËÅäÂ§©ÂÆ§ÁöÑÂàõÂª∫ËÄÖÂ∞±ÊòØËØ•ËÅäÂ§©ÂÆ§ÁöÑÁÆ°ÁêÜÂëò„ÄÇ ÁÆ°ÁêÜÂëòÊùÉÈôêÂèØ‰ª•ÈÄöËøá /mode +o ÂëΩ‰ª§ËΩ¨‰∫§„ÄÇ /kick /kick ÂëΩ‰ª§Áî®Êù•ÊääÊüê‰∏™Áî®Êà∑Ë∏¢Âá∫ÂΩìÂâçËÅäÂ§©ÂÆ§„ÄÇ /kick ÂëΩ‰ª§ÁöÑÂü∫Êú¨Ê†ºÂºèÊòØÔºö/ki(ck) Áî®Êà∑ÊòµÁß∞ [Ê∂àÊÅØ] Âè™ÊúâÂΩìÂâçËÅäÂ§©ÂÆ§ÁöÑÁÆ°ÁêÜÂëòÔºàopÔºâÊâçÊúâÊùÉÂà©ÊääÂÖ∂‰ªñÁî®Êà∑Ë∏¢Âá∫ÂΩìÂâçËÅäÂ§©ÂÆ§„ÄÇ ËÅäÂ§©ÂÆ§ÁöÑÂàõÂª∫ËÄÖÂ∞±ÊòØËØ•ËÅäÂ§©ÂÆ§ÁöÑÁÆ°ÁêÜÂëò„ÄÇ ÁÆ°ÁêÜÂëòÊùÉÈôêÂèØ‰ª•ÈÄöËøá/mode +oÂëΩ‰ª§ËΩ¨‰∫§„ÄÇ ËØ∑ËØ∏‰ΩçÁΩëÂèãÊÖéÁî®Ëøô‰∏™ÂëΩ‰ª§„ÄÇ‚ÄúÂêõÂ≠êÂä®Âè£‰∏çÂä®Êâã‚ÄùÂòõÔºÅ /quit /quit ÂëΩ‰ª§Áî®Êù•ÈÄÄÂá∫ËÅäÂ§©ÂÆ§„ÄÇ /quit ÂëΩ‰ª§ÁöÑÂü∫Êú¨Ê†ºÂºèÊòØÔºö/q(uit) [Ê∂àÊÅØ] ‚ÄúÊ∂àÊÅØ‚ÄùËøô‰∏™ÂèÇÊï∞ÊòØÂèØÈÄâÁöÑ„ÄÇÂ¶ÇÊûúÊÇ®ÊåáÂÆöÈÄÄÂá∫Êó∂ÁöÑÊ∂àÊÅØÔºåËØ•Ê∂àÊÅØ‰ºöÂèëÈÄÅÁªôÂΩìÂâçËÅäÂ§©ÂÆ§‰∏≠ÁöÑÂÖ∂‰ªñÁî®Êà∑„ÄÇÊÇ®ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™Ê∂àÊÅØÂêëÂÖ∂‰ªñÁî®Êà∑ÈÅìÂà´„ÄÇ /quit ÂëΩ‰ª§Á≠â‰ª∑‰∫éÂ∑•ÂÖ∑ÊåâÈíÆ‰∏≠ÁöÑ‚ÄúÁªìÊùüËÅäÂ§©‚Äù ËØ¶ÊÉÖÂèØÂèÇËÄÉÔºöhttps://www.cnblogs.com/z-books/p/5197840.html]]></content>
      <categories>
        <category>IRC</category>
      </categories>
      <tags>
        <tag>IRC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golangÈù¢ËØïÈóÆÈ¢òÊ±áÊÄª]]></title>
    <url>%2F2019%2F04%2F12%2Fgolang%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáËΩ¨ËΩΩËá™Ôºöhttps://github.com/KeKe-Li/golang-interview-questions GolangÈù¢ËØïÈóÆÈ¢òÊ±áÊÄªÈÄöÂ∏∏Êàë‰ª¨ÂéªÈù¢ËØïËÇØÂÆö‰ºöÊúâ‰∫õ‰∏çÈîôÁöÑGolangÁöÑÈù¢ËØïÈ¢òÁõÆÁöÑÔºåÊâÄ‰ª•ÊÄªÁªì‰∏ãÔºåËÆ©ÂÖ∂‰ªñGolangÂºÄÂèëËÄÖ‰πüÂèØ‰ª•Êü•ÁúãÂà∞ÔºåÂêåÊó∂‰πüÁî®Êù•Ê£ÄÊµãËá™Â∑±ÁöÑËÉΩÂäõÂíåÊèêÈÜíËá™Â∑±ÁöÑ‰∏çË∂≥‰πãÂ§Ñ,Ê¨¢ËøéÂ§ßÂÆ∂Ë°•ÂÖÖÂíåÊèê‰∫§Êñ∞ÁöÑÈù¢ËØïÈ¢òÁõÆ. GolangÈù¢ËØïÈóÆÈ¢òÊ±áÊÄª: 1. Golang‰∏≠Èô§‰∫ÜÂä†MutexÈîÅ‰ª•Â§ñËøòÊúâÂì™‰∫õÊñπÂºèÂÆâÂÖ®ËØªÂÜôÂÖ±‰∫´ÂèòÈáèÔºüGolang‰∏≠Goroutine ÂèØ‰ª•ÈÄöËøá Channel ËøõË°åÂÆâÂÖ®ËØªÂÜôÂÖ±‰∫´ÂèòÈáè„ÄÇ 2. Êó†ÁºìÂÜ≤ Chan ÁöÑÂèëÈÄÅÂíåÊé•Êî∂ÊòØÂê¶ÂêåÊ≠•?12ch := make(chan int) Êó†ÁºìÂÜ≤ÁöÑchannelÁî±‰∫éÊ≤°ÊúâÁºìÂÜ≤ÂèëÈÄÅÂíåÊé•Êî∂ÈúÄË¶ÅÂêåÊ≠•.ch := make(chan int, 2) ÊúâÁºìÂÜ≤channel‰∏çË¶ÅÊ±ÇÂèëÈÄÅÂíåÊé•Êî∂Êìç‰ΩúÂêåÊ≠•. channelÊó†ÁºìÂÜ≤Êó∂ÔºåÂèëÈÄÅÈòªÂ°ûÁõ¥Âà∞Êï∞ÊçÆË¢´Êé•Êî∂ÔºåÊé•Êî∂ÈòªÂ°ûÁõ¥Âà∞ËØªÂà∞Êï∞ÊçÆ„ÄÇ channelÊúâÁºìÂÜ≤Êó∂ÔºåÂΩìÁºìÂÜ≤Êª°Êó∂ÂèëÈÄÅÈòªÂ°ûÔºåÂΩìÁºìÂÜ≤Á©∫Êó∂Êé•Êî∂ÈòªÂ°û„ÄÇ 3. goËØ≠Ë®ÄÁöÑÂπ∂ÂèëÊú∫Âà∂‰ª•ÂèäÂÆÉÊâÄ‰ΩøÁî®ÁöÑCSPÂπ∂ÂèëÊ®°ÂûãÔºéCSPÊ®°ÂûãÊòØ‰∏ä‰∏™‰∏ñÁ∫™‰∏ÉÂçÅÂπ¥‰ª£ÊèêÂá∫ÁöÑ,‰∏çÂêå‰∫é‰º†ÁªüÁöÑÂ§öÁ∫øÁ®ãÈÄöËøáÂÖ±‰∫´ÂÜÖÂ≠òÊù•ÈÄö‰ø°ÔºåCSPËÆ≤Á©∂ÁöÑÊòØ‚Äú‰ª•ÈÄö‰ø°ÁöÑÊñπÂºèÊù•ÂÖ±‰∫´ÂÜÖÂ≠ò‚Äù„ÄÇÁî®‰∫éÊèèËø∞‰∏§‰∏™Áã¨Á´ãÁöÑÂπ∂ÂèëÂÆû‰ΩìÈÄöËøáÂÖ±‰∫´ÁöÑÈÄöËÆØ channel(ÁÆ°ÈÅì)ËøõË°åÈÄö‰ø°ÁöÑÂπ∂ÂèëÊ®°Âûã„ÄÇ CSP‰∏≠channelÊòØÁ¨¨‰∏ÄÁ±ªÂØπË±°ÔºåÂÆÉ‰∏çÂÖ≥Ê≥®ÂèëÈÄÅÊ∂àÊÅØÁöÑÂÆû‰ΩìÔºåËÄåÂÖ≥Ê≥®‰∏éÂèëÈÄÅÊ∂àÊÅØÊó∂‰ΩøÁî®ÁöÑchannel„ÄÇ Golang‰∏≠channel ÊòØË¢´ÂçïÁã¨ÂàõÂª∫Âπ∂‰∏îÂèØ‰ª•Âú®ËøõÁ®ã‰πãÈó¥‰º†ÈÄíÔºåÂÆÉÁöÑÈÄö‰ø°Ê®°ÂºèÁ±ª‰ºº‰∫é boss-worker Ê®°ÂºèÁöÑÔºå‰∏Ä‰∏™ÂÆû‰ΩìÈÄöËøáÂ∞ÜÊ∂àÊÅØÂèëÈÄÅÂà∞channel ‰∏≠ÔºåÁÑ∂ÂêéÂèàÁõëÂê¨Ëøô‰∏™ channel ÁöÑÂÆû‰ΩìÂ§ÑÁêÜÔºå‰∏§‰∏™ÂÆû‰Ωì‰πãÈó¥ÊòØÂåøÂêçÁöÑÔºåËøô‰∏™Â∞±ÂÆûÁé∞ÂÆû‰Ωì‰∏≠Èó¥ÁöÑËß£ËÄ¶ÔºåÂÖ∂‰∏≠ channel ÊòØÂêåÊ≠•ÁöÑ‰∏Ä‰∏™Ê∂àÊÅØË¢´ÂèëÈÄÅÂà∞ channel ‰∏≠ÔºåÊúÄÁªàÊòØ‰∏ÄÂÆöË¶ÅË¢´Âè¶Â§ñÁöÑÂÆû‰ΩìÊ∂àË¥πÊéâÁöÑÔºåÂú®ÂÆûÁé∞ÂéüÁêÜ‰∏äÂÖ∂ÂÆûÁ±ª‰ºº‰∏Ä‰∏™ÈòªÂ°ûÁöÑÊ∂àÊÅØÈòüÂàó„ÄÇ Goroutine ÊòØGolangÂÆûÈôÖÂπ∂ÂèëÊâßË°åÁöÑÂÆû‰ΩìÔºåÂÆÉÂ∫ïÂ±ÇÊòØ‰ΩøÁî®ÂçèÁ®ã(coroutine)ÂÆûÁé∞Âπ∂ÂèëÔºåcoroutineÊòØ‰∏ÄÁßçËøêË°åÂú®Áî®Êà∑ÊÄÅÁöÑÁî®Êà∑Á∫øÁ®ãÔºåÁ±ª‰ºº‰∫é greenthreadÔºågoÂ∫ïÂ±ÇÈÄâÊã©‰ΩøÁî®coroutineÁöÑÂá∫ÂèëÁÇπÊòØÂõ†‰∏∫ÔºåÂÆÉÂÖ∑Êúâ‰ª•‰∏ãÁâπÁÇπÔºö Áî®Êà∑Á©∫Èó¥ ÈÅøÂÖç‰∫ÜÂÜÖÊ†∏ÊÄÅÂíåÁî®Êà∑ÊÄÅÁöÑÂàáÊç¢ÂØºËá¥ÁöÑÊàêÊú¨„ÄÇ ÂèØ‰ª•Áî±ËØ≠Ë®ÄÂíåÊ°ÜÊû∂Â±ÇËøõË°åË∞ÉÂ∫¶„ÄÇ Êõ¥Â∞èÁöÑÊ†àÁ©∫Èó¥ÂÖÅËÆ∏ÂàõÂª∫Â§ßÈáèÁöÑÂÆû‰æã„ÄÇ Golang‰∏≠ÁöÑGoroutineÁöÑÁâπÊÄß: GolangÂÜÖÈÉ®Êúâ‰∏â‰∏™ÂØπË±°Ôºö PÂØπË±°(processor) ‰ª£Ë°®‰∏ä‰∏ãÊñáÔºàÊàñËÄÖÂèØ‰ª•ËÆ§‰∏∫ÊòØcpuÔºâÔºåM(work thread)‰ª£Ë°®Â∑•‰ΩúÁ∫øÁ®ãÔºåGÂØπË±°ÔºàgoroutineÔºâ. Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ã‰∏Ä‰∏™cpuÂØπË±°ÂêØ‰∏Ä‰∏™Â∑•‰ΩúÁ∫øÁ®ãÂØπË±°ÔºåÁ∫øÁ®ãÂéªÊ£ÄÊü•Âπ∂ÊâßË°ågoroutineÂØπË±°„ÄÇÁ¢∞Âà∞goroutineÂØπË±°ÈòªÂ°ûÁöÑÊó∂ÂÄôÔºå‰ºöÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑÂ∑•‰ΩúÁ∫øÁ®ãÔºå‰ª•ÂÖÖÂàÜÂà©Áî®cpuËµÑÊ∫ê„ÄÇ ÊâÄÊúâÊúâÊó∂ÂÄôÁ∫øÁ®ãÂØπË±°‰ºöÊØîÂ§ÑÁêÜÂô®ÂØπË±°Â§öÂæàÂ§ö. Êàë‰ª¨Áî®Â¶Ç‰∏ãÂõæÂàÜÂà´Ë°®Á§∫P„ÄÅM„ÄÅG: GÔºàGoroutineÔºâ ÔºöÊàë‰ª¨ÊâÄËØ¥ÁöÑÂçèÁ®ãÔºå‰∏∫Áî®Êà∑Á∫ßÁöÑËΩªÈáèÁ∫ßÁ∫øÁ®ãÔºåÊØè‰∏™GoroutineÂØπË±°‰∏≠ÁöÑsched‰øùÂ≠òÁùÄÂÖ∂‰∏ä‰∏ãÊñá‰ø°ÊÅØ. MÔºàMachineÔºâ ÔºöÂØπÂÜÖÊ†∏Á∫ßÁ∫øÁ®ãÁöÑÂ∞ÅË£ÖÔºåÊï∞ÈáèÂØπÂ∫îÁúüÂÆûÁöÑCPUÊï∞ÔºàÁúüÊ≠£Âπ≤Ê¥ªÁöÑÂØπË±°Ôºâ. PÔºàProcessorÔºâ ÔºöÂç≥‰∏∫GÂíåMÁöÑË∞ÉÂ∫¶ÂØπË±°ÔºåÁî®Êù•Ë∞ÉÂ∫¶GÂíåM‰πãÈó¥ÁöÑÂÖ≥ËÅîÂÖ≥Á≥ªÔºåÂÖ∂Êï∞ÈáèÂèØÈÄöËøáGOMAXPROCS()Êù•ËÆæÁΩÆÔºåÈªòËÆ§‰∏∫Ê†∏ÂøÉÊï∞. Âú®ÂçïÊ†∏ÊÉÖÂÜµ‰∏ãÔºåÊâÄÊúâGoroutineËøêË°åÂú®Âêå‰∏Ä‰∏™Á∫øÁ®ãÔºàM0Ôºâ‰∏≠ÔºåÊØè‰∏Ä‰∏™Á∫øÁ®ãÁª¥Êä§‰∏Ä‰∏™‰∏ä‰∏ãÊñáÔºàPÔºâÔºå‰ªª‰ΩïÊó∂ÂàªÔºå‰∏Ä‰∏™‰∏ä‰∏ãÊñá‰∏≠Âè™Êúâ‰∏Ä‰∏™GoroutineÔºåÂÖ∂‰ªñGoroutineÂú®runqueue‰∏≠Á≠âÂæÖ„ÄÇ ‰∏Ä‰∏™GoroutineËøêË°åÂÆåËá™Â∑±ÁöÑÊó∂Èó¥ÁâáÂêéÔºåËÆ©Âá∫‰∏ä‰∏ãÊñáÔºåËá™Â∑±ÂõûÂà∞runqueue‰∏≠ÔºàÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºâ„ÄÇ ÂΩìÊ≠£Âú®ËøêË°åÁöÑG0ÈòªÂ°ûÁöÑÊó∂ÂÄôÔºàÂèØ‰ª•ÈúÄË¶ÅIOÔºâÔºå‰ºöÂÜçÂàõÂª∫‰∏Ä‰∏™Á∫øÁ®ãÔºàM1ÔºâÔºåPËΩ¨Âà∞Êñ∞ÁöÑÁ∫øÁ®ã‰∏≠ÂéªËøêË°å„ÄÇ ÂΩìM0ËøîÂõûÊó∂ÔºåÂÆÉ‰ºöÂ∞ùËØï‰ªéÂÖ∂‰ªñÁ∫øÁ®ã‰∏≠‚ÄúÂÅ∑‚Äù‰∏Ä‰∏™‰∏ä‰∏ãÊñáËøáÊù•ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÅ∑Âà∞Ôºå‰ºöÊääGoroutineÊîæÂà∞Global runqueue‰∏≠ÂéªÔºåÁÑ∂ÂêéÊääËá™Â∑±ÊîæÂÖ•Á∫øÁ®ãÁºìÂ≠ò‰∏≠„ÄÇ ‰∏ä‰∏ãÊñá‰ºöÂÆöÊó∂Ê£ÄÊü•Global runqueue„ÄÇ GolangÊòØ‰∏∫Âπ∂ÂèëËÄåÁîüÁöÑËØ≠Ë®ÄÔºåGoËØ≠Ë®ÄÊòØ‰∏∫Êï∞‰∏çÂ§öÁöÑÂú®ËØ≠Ë®ÄÂ±ÇÈù¢ÂÆûÁé∞Âπ∂ÂèëÁöÑËØ≠Ë®ÄÔºõ‰πüÊ≠£ÊòØGoËØ≠Ë®ÄÁöÑÂπ∂ÂèëÁâπÊÄßÔºåÂê∏Âºï‰∫ÜÂÖ®ÁêÉÊó†Êï∞ÁöÑÂºÄÂèëËÄÖ„ÄÇ GolangÁöÑCSPÂπ∂ÂèëÊ®°ÂûãÔºåÊòØÈÄöËøáGoroutineÂíåChannelÊù•ÂÆûÁé∞ÁöÑ„ÄÇ Goroutine ÊòØGoËØ≠Ë®Ä‰∏≠Âπ∂ÂèëÁöÑÊâßË°åÂçï‰Ωç„ÄÇÊúâÁÇπÊäΩË±°ÔºåÂÖ∂ÂÆûÂ∞±ÊòØÂíå‰º†ÁªüÊ¶ÇÂøµ‰∏äÁöÑ‚ÄùÁ∫øÁ®ã‚ÄúÁ±ª‰ººÔºåÂèØ‰ª•ÁêÜËß£‰∏∫‚ÄùÁ∫øÁ®ã‚Äú„ÄÇ ChannelÊòØGoËØ≠Ë®Ä‰∏≠ÂêÑ‰∏™Âπ∂ÂèëÁªìÊûÑ‰Ωì(Goroutine)‰πãÂâçÁöÑÈÄö‰ø°Êú∫Âà∂„ÄÇÈÄöÂ∏∏ChannelÔºåÊòØÂêÑ‰∏™Goroutine‰πãÈó¥ÈÄö‰ø°ÁöÑ‚ÄùÁÆ°ÈÅì‚ÄúÔºåÊúâÁÇπÁ±ª‰ºº‰∫éLinux‰∏≠ÁöÑÁÆ°ÈÅì„ÄÇ ÈÄö‰ø°Êú∫Âà∂channel‰πüÂæàÊñπ‰æøÔºå‰º†Êï∞ÊçÆÁî®channel &lt;- dataÔºåÂèñÊï∞ÊçÆÁî®&lt;-channel„ÄÇ Âú®ÈÄö‰ø°ËøáÁ®ã‰∏≠Ôºå‰º†Êï∞ÊçÆchannel &lt;- dataÂíåÂèñÊï∞ÊçÆ&lt;-channelÂøÖÁÑ∂‰ºöÊàêÂØπÂá∫Áé∞ÔºåÂõ†‰∏∫ËøôËæπ‰º†ÔºåÈÇ£ËæπÂèñÔºå‰∏§‰∏™goroutine‰πãÈó¥Êâç‰ºöÂÆûÁé∞ÈÄö‰ø°„ÄÇ ËÄå‰∏î‰∏çÁÆ°‰º†ËøòÊòØÂèñÔºåÂøÖÈòªÂ°ûÔºåÁõ¥Âà∞Âè¶Â§ñÁöÑgoroutine‰º†ÊàñËÄÖÂèñ‰∏∫Ê≠¢„ÄÇ 4. Golang ‰∏≠Â∏∏Áî®ÁöÑÂπ∂ÂèëÊ®°ÂûãÔºüGolang ‰∏≠Â∏∏Áî®ÁöÑÂπ∂ÂèëÊ®°ÂûãÊúâ‰∏âÁßç: ÈÄöËøáchannelÈÄöÁü•ÂÆûÁé∞Âπ∂ÂèëÊéßÂà∂ Êó†ÁºìÂÜ≤ÁöÑÈÄöÈÅìÊåáÁöÑÊòØÈÄöÈÅìÁöÑÂ§ßÂ∞è‰∏∫0Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåËøôÁßçÁ±ªÂûãÁöÑÈÄöÈÅìÂú®Êé•Êî∂ÂâçÊ≤°ÊúâËÉΩÂäõ‰øùÂ≠ò‰ªª‰ΩïÂÄºÔºåÂÆÉË¶ÅÊ±ÇÂèëÈÄÅ goroutine ÂíåÊé•Êî∂ goroutine ÂêåÊó∂ÂáÜÂ§áÂ•ΩÔºåÊâçÂèØ‰ª•ÂÆåÊàêÂèëÈÄÅÂíåÊé•Êî∂Êìç‰Ωú„ÄÇ ‰ªé‰∏äÈù¢Êó†ÁºìÂÜ≤ÁöÑÈÄöÈÅìÂÆö‰πâÊù•ÁúãÔºåÂèëÈÄÅ goroutine ÂíåÊé•Êî∂ gouroutine ÂøÖÈ°ªÊòØÂêåÊ≠•ÁöÑÔºåÂêåÊó∂ÂáÜÂ§áÂêéÔºåÂ¶ÇÊûúÊ≤°ÊúâÂêåÊó∂ÂáÜÂ§áÂ•ΩÁöÑËØùÔºåÂÖàÊâßË°åÁöÑÊìç‰ΩúÂ∞±‰ºöÈòªÂ°ûÁ≠âÂæÖÔºåÁõ¥Âà∞Âè¶‰∏Ä‰∏™Áõ∏ÂØπÂ∫îÁöÑÊìç‰ΩúÂáÜÂ§áÂ•Ω‰∏∫Ê≠¢„ÄÇËøôÁßçÊó†ÁºìÂÜ≤ÁöÑÈÄöÈÅìÊàë‰ª¨‰πüÁß∞‰πã‰∏∫ÂêåÊ≠•ÈÄöÈÅì„ÄÇ 123456789101112func main() &#123; ch := make(chan struct&#123;&#125;) go func() &#123; fmt.Println(&quot;start working&quot;) time.Sleep(time.Second * 1) ch &lt;- struct&#123;&#125;&#123;&#125; &#125;() &lt;-ch fmt.Println(&quot;finished&quot;)&#125; ÂΩì‰∏ª goroutine ËøêË°åÂà∞ &lt;-ch Êé•Âèó channel ÁöÑÂÄºÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúËØ• channel ‰∏≠Ê≤°ÊúâÊï∞ÊçÆÔºåÂ∞±‰ºö‰∏ÄÁõ¥ÈòªÂ°ûÁ≠âÂæÖÔºåÁõ¥Âà∞ÊúâÂÄº„ÄÇ ËøôÊ†∑Â∞±ÂèØ‰ª•ÁÆÄÂçïÂÆûÁé∞Âπ∂ÂèëÊéßÂà∂ ÈÄöËøásyncÂåÖ‰∏≠ÁöÑWaitGroupÂÆûÁé∞Âπ∂ÂèëÊéßÂà∂ GoroutineÊòØÂºÇÊ≠•ÊâßË°åÁöÑÔºåÊúâÁöÑÊó∂ÂÄô‰∏∫‰∫ÜÈò≤Ê≠¢Âú®ÁªìÊùümianÂáΩÊï∞ÁöÑÊó∂ÂÄôÁªìÊùüÊéâGoroutineÔºåÊâÄ‰ª•ÈúÄË¶ÅÂêåÊ≠•Á≠âÂæÖÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÈúÄË¶ÅÁî® WaitGroup‰∫ÜÔºåÂú® sync ÂåÖ‰∏≠ÔºåÊèê‰æõ‰∫Ü WaitGroup ÔºåÂÆÉ‰ºöÁ≠âÂæÖÂÆÉÊî∂ÈõÜÁöÑÊâÄÊúâ goroutine ‰ªªÂä°ÂÖ®ÈÉ®ÂÆåÊàê„ÄÇÂú®WaitGroupÈáå‰∏ªË¶ÅÊúâ‰∏â‰∏™ÊñπÊ≥ï: Add, ÂèØ‰ª•Ê∑ªÂä†ÊàñÂáèÂ∞ë goroutineÁöÑÊï∞Èáè. Done, Áõ∏ÂΩì‰∫éAdd(-1). Wait, ÊâßË°åÂêé‰ºöÂ†µÂ°û‰∏ªÁ∫øÁ®ãÔºåÁõ¥Âà∞WaitGroup ÈáåÁöÑÂÄºÂáèËá≥0. Âú®‰∏ª goroutine ‰∏≠ Add(delta int) Á¥¢Ë¶ÅÁ≠âÂæÖgoroutine ÁöÑÊï∞Èáè„ÄÇ Âú®ÊØè‰∏Ä‰∏™ goroutine ÂÆåÊàêÂêé Done() Ë°®Á§∫Ëøô‰∏Ä‰∏™goroutine Â∑≤ÁªèÂÆåÊàêÔºåÂΩìÊâÄÊúâÁöÑ goroutine ÈÉΩÂÆåÊàêÂêéÔºåÂú®‰∏ª goroutine ‰∏≠ WaitGroup ËøîÂõûËøîÂõû„ÄÇ 123456789101112131415func main()&#123; var wg sync.WaitGroup var urls = []string&#123; &quot;http://www.golang.org/&quot;, &quot;http://www.google.com/&quot;, &#125; for _, url := range urls &#123; wg.Add(1) go func(url string) &#123; defer wg.Done() http.Get(url) &#125;(url) &#125; wg.Wait()&#125; Âú®GolangÂÆòÁΩë‰∏≠ÂØπ‰∫éWaitGroup‰ªãÁªçÊòØA WaitGroup must not be copied after first use,Âú® WaitGroup Á¨¨‰∏ÄÊ¨°‰ΩøÁî®ÂêéÔºå‰∏çËÉΩË¢´Êã∑Ë¥ù Â∫îÁî®Á§∫‰æã: 123456789101112func main()&#123; wg := sync.WaitGroup&#123;&#125; for i := 0; i &lt; 5; i++ &#123; wg.Add(1) go func(wg sync.WaitGroup, i int) &#123; fmt.Printf(&quot;i:%d&quot;, i) wg.Done() &#125;(wg, i) &#125; wg.Wait() fmt.Println(&quot;exit&quot;)&#125; ËøêË°å: 12345678910i:1i:3i:2i:0i:4fatal error: all goroutines are asleep - deadlock!goroutine 1 [semacquire]:sync.runtime_Semacquire(0xc000094018) /home/keke/soft/go/src/runtime/sema.go:56 +0x39sync.(*WaitGroup).Wait(0xc000094010) /home/keke/soft/go/src/sync/waitgroup.go:130 +0x64main.main() /home/keke/go/Test/wait.go:17 +0xabexit status 2 ÂÆÉÊèêÁ§∫ÊâÄÊúâÁöÑ goroutine ÈÉΩÂ∑≤ÁªèÁù°Áú†‰∫ÜÔºåÂá∫Áé∞‰∫ÜÊ≠ªÈîÅ„ÄÇËøôÊòØÂõ†‰∏∫ wg ÁªôÊã∑Ë¥ù‰º†ÈÄíÂà∞‰∫Ü goroutine ‰∏≠ÔºåÂØºËá¥Âè™Êúâ Add Êìç‰ΩúÔºåÂÖ∂ÂÆû DoneÊìç‰ΩúÊòØÂú® wg ÁöÑÂâØÊú¨ÊâßË°åÁöÑ„ÄÇ Âõ†Ê≠§ Wait Â∞±Ê≠ªÈîÅ‰∫Ü„ÄÇ Ëøô‰∏™Á¨¨‰∏Ä‰∏™‰øÆÊîπÊñπÂºè:Â∞ÜÂåøÂêçÂáΩÊï∞‰∏≠ wg ÁöÑ‰º†ÂÖ•Á±ªÂûãÊîπ‰∏∫ *sync.WaitGrou,ËøôÊ†∑Â∞±ËÉΩÂºïÁî®Âà∞Ê≠£Á°ÆÁöÑWaitGroup‰∫Ü„ÄÇ Ëøô‰∏™Á¨¨‰∫å‰∏™‰øÆÊîπÊñπÂºè:Â∞ÜÂåøÂêçÂáΩÊï∞‰∏≠ÁöÑ wg ÁöÑ‰º†ÂÖ•ÂèÇÊï∞ÂéªÊéâÔºåÂõ†‰∏∫GoÊîØÊåÅÈó≠ÂåÖÁ±ªÂûãÔºåÂú®ÂåøÂêçÂáΩÊï∞‰∏≠ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®Â§ñÈù¢ÁöÑ wg ÂèòÈáè Âú®Go 1.7 ‰ª•ÂêéÂºïËøõÁöÑÂº∫Â§ßÁöÑContext‰∏ä‰∏ãÊñáÔºåÂÆûÁé∞Âπ∂ÂèëÊéßÂà∂ ÈÄöÂ∏∏,Âú®‰∏Ä‰∫õÁÆÄÂçïÂú∫ÊôØ‰∏ã‰ΩøÁî® channel Âíå WaitGroup Â∑≤ÁªèË∂≥Â§ü‰∫ÜÔºå‰ΩÜÊòØÂΩìÈù¢‰∏¥‰∏Ä‰∫õÂ§çÊùÇÂ§öÂèòÁöÑÁΩëÁªúÂπ∂ÂèëÂú∫ÊôØ‰∏ã channel Âíå WaitGroup ÊòæÂæóÊúâ‰∫õÂäõ‰∏ç‰ªéÂøÉ‰∫Ü„ÄÇ ÊØîÂ¶Ç‰∏Ä‰∏™ÁΩëÁªúËØ∑Ê±Ç RequestÔºåÊØè‰∏™ Request ÈÉΩÈúÄË¶ÅÂºÄÂêØ‰∏Ä‰∏™ goroutine ÂÅö‰∏Ä‰∫õ‰∫ãÊÉÖÔºåËøô‰∫õ goroutine ÂèàÂèØËÉΩ‰ºöÂºÄÂêØÂÖ∂‰ªñÁöÑ goroutineÔºåÊØîÂ¶ÇÊï∞ÊçÆÂ∫ìÂíåRPCÊúçÂä°„ÄÇ ÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶Å‰∏ÄÁßçÂèØ‰ª•Ë∑üË∏™ goroutine ÁöÑÊñπÊ°àÔºåÊâçÂèØ‰ª•ËææÂà∞ÊéßÂà∂‰ªñ‰ª¨ÁöÑÁõÆÁöÑÔºåËøôÂ∞±ÊòØGoËØ≠Ë®Ä‰∏∫Êàë‰ª¨Êèê‰æõÁöÑ ContextÔºåÁß∞‰πã‰∏∫‰∏ä‰∏ãÊñáÈùûÂ∏∏Ë¥¥ÂàáÔºåÂÆÉÂ∞±ÊòØgoroutine ÁöÑ‰∏ä‰∏ãÊñá„ÄÇ ÂÆÉÊòØÂåÖÊã¨‰∏Ä‰∏™Á®ãÂ∫èÁöÑËøêË°åÁéØÂ¢É„ÄÅÁé∞Âú∫ÂíåÂø´ÁÖßÁ≠â„ÄÇÊØè‰∏™Á®ãÂ∫èË¶ÅËøêË°åÊó∂ÔºåÈÉΩÈúÄË¶ÅÁü•ÈÅìÂΩìÂâçÁ®ãÂ∫èÁöÑËøêË°åÁä∂ÊÄÅÔºåÈÄöÂ∏∏Go Â∞ÜËøô‰∫õÂ∞ÅË£ÖÂú®‰∏Ä‰∏™ Context ÈáåÔºåÂÜçÂ∞ÜÂÆÉ‰º†ÁªôË¶ÅÊâßË°åÁöÑ goroutine „ÄÇ context ÂåÖ‰∏ªË¶ÅÊòØÁî®Êù•Â§ÑÁêÜÂ§ö‰∏™ goroutine ‰πãÈó¥ÂÖ±‰∫´Êï∞ÊçÆÔºåÂèäÂ§ö‰∏™ goroutine ÁöÑÁÆ°ÁêÜ„ÄÇ context ÂåÖÁöÑÊ†∏ÂøÉÊòØ struct ContextÔºåÊé•Âè£Â£∞ÊòéÂ¶Ç‰∏ãÔºö 123456789101112131415161718// A Context carries a deadline, cancelation signal, and request-scoped values// across API boundaries. Its methods are safe for simultaneous use by multiple// goroutines.type Context interface &#123; // Done returns a channel that is closed when this `Context` is canceled // or times out. Done() &lt;-chan struct&#123;&#125; // Err indicates why this Context was canceled, after the Done channel // is closed. Err() error // Deadline returns the time when this Context will be canceled, if any. Deadline() (deadline time.Time, ok bool) // Value returns the value associated with key or nil if none. Value(key interface&#123;&#125;) interface&#123;&#125;&#125; Done() ËøîÂõû‰∏Ä‰∏™Âè™ËÉΩÊé•ÂèóÊï∞ÊçÆÁöÑchannelÁ±ªÂûãÔºåÂΩìËØ•contextÂÖ≥Èó≠ÊàñËÄÖË∂ÖÊó∂Êó∂Èó¥Âà∞‰∫ÜÁöÑÊó∂ÂÄôÔºåËØ•channelÂ∞±‰ºöÊúâ‰∏Ä‰∏™ÂèñÊ∂à‰ø°Âè∑ Err() Âú®Done() ‰πãÂêéÔºåËøîÂõûcontext ÂèñÊ∂àÁöÑÂéüÂõ†„ÄÇ Deadline() ËÆæÁΩÆËØ•context cancelÁöÑÊó∂Èó¥ÁÇπ Value() ÊñπÊ≥ïÂÖÅËÆ∏ Context ÂØπË±°Êê∫Â∏¶request‰ΩúÁî®ÂüüÁöÑÊï∞ÊçÆÔºåËØ•Êï∞ÊçÆÂøÖÈ°ªÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ Context ÂØπË±°ÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºå‰Ω†ÂèØ‰ª•Êää‰∏Ä‰∏™ Context ÂØπË±°‰º†ÈÄíÁªô‰ªªÊÑè‰∏™Êï∞ÁöÑ gorotuineÔºåÂØπÂÆÉÊâßË°å ÂèñÊ∂à Êìç‰ΩúÊó∂ÔºåÊâÄÊúâ goroutine ÈÉΩ‰ºöÊé•Êî∂Âà∞ÂèñÊ∂à‰ø°Âè∑„ÄÇ ‰∏Ä‰∏™ Context ‰∏çËÉΩÊã•Êúâ Cancel ÊñπÊ≥ïÔºåÂêåÊó∂Êàë‰ª¨‰πüÂè™ËÉΩ Done channel Êé•Êî∂Êï∞ÊçÆ„ÄÇ ÂÖ∂‰∏≠ÁöÑÂéüÂõ†ÊòØ‰∏ÄËá¥ÁöÑÔºöÊé•Êî∂ÂèñÊ∂à‰ø°Âè∑ÁöÑÂáΩÊï∞ÂíåÂèëÈÄÅ‰ø°Âè∑ÁöÑÂáΩÊï∞ÈÄöÂ∏∏‰∏çÊòØ‰∏Ä‰∏™„ÄÇ ÂÖ∏ÂûãÁöÑÂú∫ÊôØÊòØÔºöÁà∂Êìç‰Ωú‰∏∫Â≠êÊìç‰ΩúÊìç‰ΩúÂêØÂä® goroutineÔºåÂ≠êÊìç‰Ωú‰πüÂ∞±‰∏çËÉΩÂèñÊ∂àÁà∂Êìç‰Ωú„ÄÇ 5. JSON Ê†áÂáÜÂ∫ìÂØπ nil slice Âíå Á©∫ slice ÁöÑÂ§ÑÁêÜÊòØ‰∏ÄËá¥ÁöÑÂêóÔºü È¶ñÂÖàJSON Ê†áÂáÜÂ∫ìÂØπ nil slice Âíå Á©∫ slice ÁöÑÂ§ÑÁêÜÊòØ‰∏ç‰∏ÄËá¥. ÈÄöÂ∏∏ÈîôËØØÁöÑÁî®Ê≥ïÔºå‰ºöÊä•Êï∞ÁªÑË∂äÁïåÁöÑÈîôËØØÔºåÂõ†‰∏∫Âè™ÊòØÂ£∞Êòé‰∫ÜsliceÔºåÂç¥Ê≤°ÊúâÁªôÂÆû‰æãÂåñÁöÑÂØπË±°„ÄÇ 12var slice []intslice[1] = 0 Ê≠§Êó∂sliceÁöÑÂÄºÊòØnilÔºåËøôÁßçÊÉÖÂÜµÂèØ‰ª•Áî®‰∫éÈúÄË¶ÅËøîÂõûsliceÁöÑÂáΩÊï∞ÔºåÂΩìÂáΩÊï∞Âá∫Áé∞ÂºÇÂ∏∏ÁöÑÊó∂ÂÄôÔºå‰øùËØÅÂáΩÊï∞‰æùÁÑ∂‰ºöÊúânilÁöÑËøîÂõûÂÄº„ÄÇ empty slice ÊòØÊåáslice‰∏ç‰∏∫nilÔºå‰ΩÜÊòØsliceÊ≤°ÊúâÂÄºÔºåsliceÁöÑÂ∫ïÂ±ÇÁöÑÁ©∫Èó¥ÊòØÁ©∫ÁöÑÔºåÊ≠§Êó∂ÁöÑÂÆö‰πâÂ¶Ç‰∏ãÔºö 12slice := make([]int,0Ôºâslice := []int&#123;&#125; ÂΩìÊàë‰ª¨Êü•ËØ¢ÊàñËÄÖÂ§ÑÁêÜ‰∏Ä‰∏™Á©∫ÁöÑÂàóË°®ÁöÑÊó∂ÂÄôÔºåËøôÈùûÂ∏∏ÊúâÁî®ÔºåÂÆÉ‰ºöÂëäËØâÊàë‰ª¨ËøîÂõûÁöÑÊòØ‰∏Ä‰∏™ÂàóË°®Ôºå‰ΩÜÊòØÂàóË°®ÂÜÖÊ≤°Êúâ‰ªª‰ΩïÂÄº„ÄÇ ÊÄª‰πãÔºånil slice Âíå empty sliceÊòØ‰∏çÂêåÁöÑ‰∏úË•ø,ÈúÄË¶ÅÊàë‰ª¨Âä†‰ª•Âå∫ÂàÜÁöÑ. 6. ÂçèÁ®ãÔºåÁ∫øÁ®ãÔºåËøõÁ®ãÁöÑÂå∫Âà´„ÄÇ ËøõÁ®ã ËøõÁ®ãÊòØÂÖ∑Êúâ‰∏ÄÂÆöÁã¨Á´ãÂäüËÉΩÁöÑÁ®ãÂ∫èÂÖ≥‰∫éÊüê‰∏™Êï∞ÊçÆÈõÜÂêà‰∏äÁöÑ‰∏ÄÊ¨°ËøêË°åÊ¥ªÂä®,ËøõÁ®ãÊòØÁ≥ªÁªüËøõË°åËµÑÊ∫êÂàÜÈÖçÂíåË∞ÉÂ∫¶ÁöÑ‰∏Ä‰∏™Áã¨Á´ãÂçï‰Ωç„ÄÇÊØè‰∏™ËøõÁ®ãÈÉΩÊúâËá™Â∑±ÁöÑÁã¨Á´ãÂÜÖÂ≠òÁ©∫Èó¥Ôºå‰∏çÂêåËøõÁ®ãÈÄöËøáËøõÁ®ãÈó¥ÈÄö‰ø°Êù•ÈÄö‰ø°„ÄÇÁî±‰∫éËøõÁ®ãÊØîËæÉÈáçÈáèÔºåÂç†ÊçÆÁã¨Á´ãÁöÑÂÜÖÂ≠òÔºåÊâÄ‰ª•‰∏ä‰∏ãÊñáËøõÁ®ãÈó¥ÁöÑÂàáÊç¢ÂºÄÈîÄÔºàÊ†à„ÄÅÂØÑÂ≠òÂô®„ÄÅËôöÊãüÂÜÖÂ≠ò„ÄÅÊñá‰ª∂Âè•ÊüÑÁ≠âÔºâÊØîËæÉÂ§ßÔºå‰ΩÜÁõ∏ÂØπÊØîËæÉÁ®≥ÂÆöÂÆâÂÖ®„ÄÇ Á∫øÁ®ã Á∫øÁ®ãÊòØËøõÁ®ãÁöÑ‰∏Ä‰∏™ÂÆû‰Ωì,ÊòØCPUË∞ÉÂ∫¶ÂíåÂàÜÊ¥æÁöÑÂü∫Êú¨Âçï‰Ωç,ÂÆÉÊòØÊØîËøõÁ®ãÊõ¥Â∞èÁöÑËÉΩÁã¨Á´ãËøêË°åÁöÑÂü∫Êú¨Âçï‰Ωç.Á∫øÁ®ãËá™Â∑±Âü∫Êú¨‰∏ä‰∏çÊã•ÊúâÁ≥ªÁªüËµÑÊ∫ê,Âè™Êã•Êúâ‰∏ÄÁÇπÂú®ËøêË°å‰∏≠ÂøÖ‰∏çÂèØÂ∞ëÁöÑËµÑÊ∫ê(Â¶ÇÁ®ãÂ∫èËÆ°Êï∞Âô®,‰∏ÄÁªÑÂØÑÂ≠òÂô®ÂíåÊ†à),‰ΩÜÊòØÂÆÉÂèØ‰∏éÂêåÂ±û‰∏Ä‰∏™ËøõÁ®ãÁöÑÂÖ∂‰ªñÁöÑÁ∫øÁ®ãÂÖ±‰∫´ËøõÁ®ãÊâÄÊã•ÊúâÁöÑÂÖ®ÈÉ®ËµÑÊ∫ê„ÄÇÁ∫øÁ®ãÈó¥ÈÄö‰ø°‰∏ªË¶ÅÈÄöËøáÂÖ±‰∫´ÂÜÖÂ≠òÔºå‰∏ä‰∏ãÊñáÂàáÊç¢ÂæàÂø´ÔºåËµÑÊ∫êÂºÄÈîÄËæÉÂ∞ëÔºå‰ΩÜÁõ∏ÊØîËøõÁ®ã‰∏çÂ§üÁ®≥ÂÆöÂÆπÊòì‰∏¢Â§±Êï∞ÊçÆ„ÄÇ ÂçèÁ®ã ÂçèÁ®ãÊòØ‰∏ÄÁßçÁî®Êà∑ÊÄÅÁöÑËΩªÈáèÁ∫ßÁ∫øÁ®ãÔºåÂçèÁ®ãÁöÑË∞ÉÂ∫¶ÂÆåÂÖ®Áî±Áî®Êà∑ÊéßÂà∂„ÄÇÂçèÁ®ãÊã•ÊúâËá™Â∑±ÁöÑÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†à„ÄÇÂçèÁ®ãË∞ÉÂ∫¶ÂàáÊç¢Êó∂ÔºåÂ∞ÜÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†à‰øùÂ≠òÂà∞ÂÖ∂‰ªñÂú∞ÊñπÔºåÂú®ÂàáÂõûÊù•ÁöÑÊó∂ÂÄôÔºåÊÅ¢Â§çÂÖàÂâç‰øùÂ≠òÁöÑÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†àÔºåÁõ¥Êé•Êìç‰ΩúÊ†àÂàôÂü∫Êú¨Ê≤°ÊúâÂÜÖÊ†∏ÂàáÊç¢ÁöÑÂºÄÈîÄÔºåÂèØ‰ª•‰∏çÂä†ÈîÅÁöÑËÆøÈóÆÂÖ®Â±ÄÂèòÈáèÔºåÊâÄ‰ª•‰∏ä‰∏ãÊñáÁöÑÂàáÊç¢ÈùûÂ∏∏Âø´„ÄÇ 7. ‰∫íÊñ•ÈîÅÔºåËØªÂÜôÈîÅÔºåÊ≠ªÈîÅÈóÆÈ¢òÊòØÊÄé‰πàËß£ÂÜ≥„ÄÇ ‰∫íÊñ•ÈîÅ ‰∫íÊñ•ÈîÅÂ∞±ÊòØ‰∫íÊñ•ÂèòÈáèmutexÔºåÁî®Êù•ÈîÅ‰Ωè‰∏¥ÁïåÂå∫ÁöÑ. Êù°‰ª∂ÈîÅÂ∞±ÊòØÊù°‰ª∂ÂèòÈáèÔºåÂΩìËøõÁ®ãÁöÑÊüê‰∫õËµÑÊ∫êË¶ÅÊ±Ç‰∏çÊª°Ë∂≥Êó∂Â∞±ËøõÂÖ•‰ºëÁú†Ôºå‰πüÂ∞±ÊòØÈîÅ‰Ωè‰∫Ü„ÄÇÂΩìËµÑÊ∫êË¢´ÂàÜÈÖçÂà∞‰∫ÜÔºåÊù°‰ª∂ÈîÅÊâìÂºÄÔºåËøõÁ®ãÁªßÁª≠ËøêË°åÔºõËØªÂÜôÈîÅÔºå‰πüÁ±ª‰ººÔºåÁî®‰∫éÁºìÂÜ≤Âå∫Á≠â‰∏¥ÁïåËµÑÊ∫êËÉΩ‰∫íÊñ•ËÆøÈóÆÁöÑ„ÄÇ ËØªÂÜôÈîÅ ÈÄöÂ∏∏Êúâ‰∫õÂÖ¨ÂÖ±Êï∞ÊçÆ‰øÆÊîπÁöÑÊú∫‰ºöÂæàÂ∞ëÔºå‰ΩÜÂÖ∂ËØªÁöÑÊú∫‰ºöÂæàÂ§ö„ÄÇÂπ∂‰∏îÂú®ËØªÁöÑËøáÁ®ã‰∏≠‰ºö‰º¥ÈöèÁùÄÊü•ÊâæÔºåÁªôËøôÁßç‰ª£Á†ÅÂä†ÈîÅ‰ºöÈôç‰ΩéÊàë‰ª¨ÁöÑÁ®ãÂ∫èÊïàÁéá„ÄÇËØªÂÜôÈîÅÂèØ‰ª•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ Ê≥®ÊÑèÔºöÂÜôÁã¨Âç†ÔºåËØªÂÖ±‰∫´ÔºåÂÜôÈîÅ‰ºòÂÖàÁ∫ßÈ´ò Ê≠ªÈîÅ ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúÂêå‰∏Ä‰∏™Á∫øÁ®ãÂÖàÂêé‰∏§Ê¨°Ë∞ÉÁî®lockÔºåÂú®Á¨¨‰∫åÊ¨°Ë∞ÉÁî®Êó∂ÔºåÁî±‰∫éÈîÅÂ∑≤ÁªèË¢´Âç†Áî®ÔºåËØ•Á∫øÁ®ã‰ºöÊåÇËµ∑Á≠âÂæÖÂà´ÁöÑÁ∫øÁ®ãÈáäÊîæÈîÅÔºåÁÑ∂ËÄåÈîÅÊ≠£ÊòØË¢´Ëá™Â∑±Âç†Áî®ÁùÄÁöÑÔºåËØ•Á∫øÁ®ãÂèàË¢´ÊåÇËµ∑ËÄåÊ≤°ÊúâÊú∫‰ºöÈáäÊîæÈîÅÔºåÂõ†Ê≠§Â∞±Ê∞∏ËøúÂ§Ñ‰∫éÊåÇËµ∑Á≠âÂæÖÁä∂ÊÄÅ‰∫ÜÔºåËøôÂè´ÂÅöÊ≠ªÈîÅÔºàDeadlockÔºâ„ÄÇ Âè¶Â§ñ‰∏ÄÁßçÊÉÖÂÜµÊòØÔºöËã•Á∫øÁ®ãAËé∑Âæó‰∫ÜÈîÅ1ÔºåÁ∫øÁ®ãBËé∑Âæó‰∫ÜÈîÅ2ÔºåËøôÊó∂Á∫øÁ®ãAË∞ÉÁî®lockËØïÂõæËé∑ÂæóÈîÅ2ÔºåÁªìÊûúÊòØÈúÄË¶ÅÊåÇËµ∑Á≠âÂæÖÁ∫øÁ®ãBÈáäÊîæÈîÅ2ÔºåËÄåËøôÊó∂Á∫øÁ®ãB‰πüË∞ÉÁî®lockËØïÂõæËé∑ÂæóÈîÅ1ÔºåÁªìÊûúÊòØÈúÄË¶ÅÊåÇËµ∑Á≠âÂæÖÁ∫øÁ®ãAÈáäÊîæÈîÅ1Ôºå‰∫éÊòØÁ∫øÁ®ãAÂíåBÈÉΩÊ∞∏ËøúÂ§Ñ‰∫éÊåÇËµ∑Áä∂ÊÄÅ‰∫Ü„ÄÇ Ê≠ªÈîÅ‰∫ßÁîüÁöÑÂõõ‰∏™ÂøÖË¶ÅÊù°‰ª∂: ‰∫íÊñ•Êù°‰ª∂Ôºö‰∏Ä‰∏™ËµÑÊ∫êÊØèÊ¨°Âè™ËÉΩË¢´‰∏Ä‰∏™ËøõÁ®ã‰ΩøÁî® ËØ∑Ê±Ç‰∏é‰øùÊåÅÊù°‰ª∂Ôºö‰∏Ä‰∏™ËøõÁ®ãÂõ†ËØ∑Ê±ÇËµÑÊ∫êËÄåÈòªÂ°ûÊó∂ÔºåÂØπÂ∑≤Ëé∑ÂæóÁöÑËµÑÊ∫ê‰øùÊåÅ‰∏çÊîæ„ÄÇ ‰∏çÂâ•Â§∫Êù°‰ª∂:ËøõÁ®ãÂ∑≤Ëé∑ÂæóÁöÑËµÑÊ∫êÔºåÂú®Êú´‰ΩøÁî®ÂÆå‰πãÂâçÔºå‰∏çËÉΩÂº∫Ë°åÂâ•Â§∫„ÄÇ Âæ™ÁéØÁ≠âÂæÖÊù°‰ª∂:Ëã•Âπ≤ËøõÁ®ã‰πãÈó¥ÂΩ¢Êàê‰∏ÄÁßçÂ§¥Â∞æÁõ∏Êé•ÁöÑÂæ™ÁéØÁ≠âÂæÖËµÑÊ∫êÂÖ≥Á≥ª„ÄÇ ËøôÂõõ‰∏™Êù°‰ª∂ÊòØÊ≠ªÈîÅÁöÑÂøÖË¶ÅÊù°‰ª∂ÔºåÂè™Ë¶ÅÁ≥ªÁªüÂèëÁîüÊ≠ªÈîÅÔºåËøô‰∫õÊù°‰ª∂ÂøÖÁÑ∂ÊàêÁ´ãÔºåËÄåÂè™Ë¶Å‰∏äËø∞Êù°‰ª∂‰πã‰∏Ä‰∏çÊª°Ë∂≥ÔºåÂ∞±‰∏ç‰ºöÂèëÁîüÊ≠ªÈîÅ„ÄÇ a. È¢ÑÈò≤Ê≠ªÈîÅ ÂèØ‰ª•ÊääËµÑÊ∫ê‰∏ÄÊ¨°ÊÄßÂàÜÈÖçÔºöÔºàÁ†¥ÂùèËØ∑Ê±ÇÂíå‰øùÊåÅÊù°‰ª∂Ôºâ ÁÑ∂ÂêéÂâ•Â§∫ËµÑÊ∫êÔºöÂç≥ÂΩìÊüêËøõÁ®ãÊñ∞ÁöÑËµÑÊ∫êÊú™Êª°Ë∂≥Êó∂ÔºåÈáäÊîæÂ∑≤Âç†ÊúâÁöÑËµÑÊ∫êÔºàÁ†¥Âùè‰∏çÂèØÂâ•Â§∫Êù°‰ª∂Ôºâ ËµÑÊ∫êÊúâÂ∫èÂàÜÈÖçÊ≥ïÔºöÁ≥ªÁªüÁªôÊØèÁ±ªËµÑÊ∫êËµã‰∫à‰∏Ä‰∏™ÁºñÂè∑ÔºåÊØè‰∏Ä‰∏™ËøõÁ®ãÊåâÁºñÂè∑ÈÄíÂ¢ûÁöÑÈ°∫Â∫èËØ∑Ê±ÇËµÑÊ∫êÔºåÈáäÊîæÂàôÁõ∏ÂèçÔºàÁ†¥ÂùèÁéØË∑ØÁ≠âÂæÖÊù°‰ª∂Ôºâ b. ÈÅøÂÖçÊ≠ªÈîÅ È¢ÑÈò≤Ê≠ªÈîÅÁöÑÂá†ÁßçÁ≠ñÁï•Ôºå‰ºö‰∏•ÈáçÂú∞ÊçüÂÆ≥Á≥ªÁªüÊÄßËÉΩ„ÄÇÂõ†Ê≠§Âú®ÈÅøÂÖçÊ≠ªÈîÅÊó∂ÔºåË¶ÅÊñΩÂä†ËæÉÂº±ÁöÑÈôêÂà∂Ôºå‰ªéËÄåËé∑Âæó ËæÉÊª°ÊÑèÁöÑÁ≥ªÁªüÊÄßËÉΩ„ÄÇÁî±‰∫éÂú®ÈÅøÂÖçÊ≠ªÈîÅÁöÑÁ≠ñÁï•‰∏≠ÔºåÂÖÅËÆ∏ËøõÁ®ãÂä®ÊÄÅÂú∞Áî≥ËØ∑ËµÑÊ∫ê„ÄÇÂõ†ËÄåÔºåÁ≥ªÁªüÂú®ËøõË°åËµÑÊ∫êÂàÜÈÖç‰πãÂâçÈ¢ÑÂÖàËÆ°ÁÆóËµÑÊ∫êÂàÜÈÖçÁöÑÂÆâÂÖ®ÊÄß„ÄÇËã•Ê≠§Ê¨°ÂàÜÈÖç‰∏ç‰ºöÂØºËá¥Á≥ªÁªüËøõÂÖ•‰∏çÂÆâÂÖ®Áä∂ÊÄÅÔºåÂàôÂ∞ÜËµÑÊ∫êÂàÜÈÖçÁªôËøõÁ®ãÔºõÂê¶ÂàôÔºåËøõÁ®ãÁ≠âÂæÖ„ÄÇÂÖ∂‰∏≠ÊúÄÂÖ∑Êúâ‰ª£Ë°®ÊÄßÁöÑÈÅøÂÖçÊ≠ªÈîÅÁÆóÊ≥ïÊòØÈì∂Ë°åÂÆ∂ÁÆóÊ≥ï„ÄÇ c. Ê£ÄÊµãÊ≠ªÈîÅ È¶ñÂÖà‰∏∫ÊØè‰∏™ËøõÁ®ãÂíåÊØè‰∏™ËµÑÊ∫êÊåáÂÆö‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑÂè∑Á†Å,ÁÑ∂ÂêéÂª∫Á´ãËµÑÊ∫êÂàÜÈÖçË°®ÂíåËøõÁ®ãÁ≠âÂæÖË°®. d. Ëß£Èô§Ê≠ªÈîÅ ÂΩìÂèëÁé∞ÊúâËøõÁ®ãÊ≠ªÈîÅÂêéÔºå‰æøÂ∫îÁ´ãÂç≥ÊääÂÆÉ‰ªéÊ≠ªÈîÅÁä∂ÊÄÅ‰∏≠Ëß£ËÑ±Âá∫Êù•ÔºåÂ∏∏ÈááÁî®ÁöÑÊñπÊ≥ïÊúâ. e. Ââ•Â§∫ËµÑÊ∫ê ‰ªéÂÖ∂ÂÆÉËøõÁ®ãÂâ•Â§∫Ë∂≥Â§üÊï∞ÈáèÁöÑËµÑÊ∫êÁªôÊ≠ªÈîÅËøõÁ®ãÔºå‰ª•Ëß£Èô§Ê≠ªÈîÅÁä∂ÊÄÅ. f. Êí§Ê∂àËøõÁ®ã ÂèØ‰ª•Áõ¥Êé•Êí§Ê∂àÊ≠ªÈîÅËøõÁ®ãÊàñÊí§Ê∂à‰ª£‰ª∑ÊúÄÂ∞èÁöÑËøõÁ®ãÔºåÁõ¥Ëá≥ÊúâË∂≥Â§üÁöÑËµÑÊ∫êÂèØÁî®ÔºåÊ≠ªÈîÅÁä∂ÊÄÅ.Ê∂àÈô§‰∏∫Ê≠¢.ÊâÄË∞ì‰ª£‰ª∑ÊòØÊåá‰ºòÂÖàÁ∫ß„ÄÅËøêË°å‰ª£‰ª∑„ÄÅËøõÁ®ãÁöÑÈáçË¶ÅÊÄßÂíå‰ª∑ÂÄºÁ≠â„ÄÇ 8. GolangÁöÑÂÜÖÂ≠òÊ®°ÂûãÔºå‰∏∫‰ªÄ‰πàÂ∞èÂØπË±°Â§ö‰∫Ü‰ºöÈÄ†ÊàêgcÂéãÂäõ„ÄÇÈÄöÂ∏∏Â∞èÂØπË±°ËøáÂ§ö‰ºöÂØºËá¥GC‰∏âËâ≤Ê≥ïÊ∂àËÄóËøáÂ§öÁöÑGPU„ÄÇ‰ºòÂåñÊÄùË∑ØÊòØÔºåÂáèÂ∞ëÂØπË±°ÂàÜÈÖç. 9. Data RaceÈóÆÈ¢òÊÄé‰πàËß£ÂÜ≥ÔºüËÉΩ‰∏çËÉΩ‰∏çÂä†ÈîÅËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºüÂêåÊ≠•ËÆøÈóÆÂÖ±‰∫´Êï∞ÊçÆÊòØÂ§ÑÁêÜÊï∞ÊçÆÁ´û‰∫âÁöÑ‰∏ÄÁßçÊúâÊïàÁöÑÊñπÊ≥ï.golangÂú®1.1‰πãÂêéÂºïÂÖ•‰∫ÜÁ´û‰∫âÊ£ÄÊµãÊú∫Âà∂ÔºåÂèØ‰ª•‰ΩøÁî® go run -race ÊàñËÄÖ go build -raceÊù•ËøõË°åÈùôÊÄÅÊ£ÄÊµã„ÄÇ ÂÖ∂Âú®ÂÜÖÈÉ®ÁöÑÂÆûÁé∞ÊòØ,ÂºÄÂêØÂ§ö‰∏™ÂçèÁ®ãÊâßË°åÂêå‰∏Ä‰∏™ÂëΩ‰ª§Ôºå Âπ∂‰∏îËÆ∞ÂΩï‰∏ãÊØè‰∏™ÂèòÈáèÁöÑÁä∂ÊÄÅ. Á´û‰∫âÊ£ÄÊµãÂô®Âü∫‰∫éC/C++ÁöÑThreadSanitizer ËøêË°åÊó∂Â∫ìÔºåËØ•Â∫ìÂú®GoogleÂÜÖÈÉ®‰ª£Á†ÅÂü∫Âú∞ÂíåChromiumÊâæÂà∞ËÆ∏Â§öÈîôËØØ„ÄÇËøô‰∏™ÊäÄÊúØÂú®2012Âπ¥‰πùÊúàÈõÜÊàêÂà∞Go‰∏≠Ôºå‰ªéÈÇ£Êó∂ÂºÄÂßãÔºåÂÆÉÂ∑≤ÁªèÂú®Ê†áÂáÜÂ∫ì‰∏≠Ê£ÄÊµãÂà∞42‰∏™Á´û‰∫âÊù°‰ª∂„ÄÇÁé∞Âú®ÔºåÂÆÉÂ∑≤ÁªèÊòØÊàë‰ª¨ÊåÅÁª≠ÊûÑÂª∫ËøáÁ®ãÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂΩìÁ´û‰∫âÊù°‰ª∂Âá∫Áé∞Êó∂ÔºåÂÆÉ‰ºöÁªßÁª≠ÊçïÊçâÂà∞Ëøô‰∫õÈîôËØØ„ÄÇ Á´û‰∫âÊ£ÄÊµãÂô®Â∑≤ÁªèÂÆåÂÖ®ÈõÜÊàêÂà∞GoÂ∑•ÂÖ∑Èìæ‰∏≠Ôºå‰ªÖ‰ªÖÊ∑ªÂä†-raceÊ†áÂøóÂà∞ÂëΩ‰ª§Ë°åÂ∞±‰ΩøÁî®‰∫ÜÊ£ÄÊµãÂô®„ÄÇ 1234$ go test -race mypkg // ÊµãËØïÂåÖ$ go run -race mysrc.go // ÁºñËØëÂíåËøêË°åÁ®ãÂ∫è$ go build -race mycmd // ÊûÑÂª∫Á®ãÂ∫è$ go install -race mypkg // ÂÆâË£ÖÁ®ãÂ∫è Ë¶ÅÊÉ≥Ëß£ÂÜ≥Êï∞ÊçÆÁ´û‰∫âÁöÑÈóÆÈ¢òÂèØ‰ª•‰ΩøÁî®‰∫íÊñ•ÈîÅsync.Mutex,Ëß£ÂÜ≥Êï∞ÊçÆÁ´û‰∫â(Data race),‰πüÂèØ‰ª•‰ΩøÁî®ÁÆ°ÈÅìËß£ÂÜ≥,‰ΩøÁî®ÁÆ°ÈÅìÁöÑÊïàÁéáË¶ÅÊØî‰∫íÊñ•ÈîÅÈ´ò. 10. ‰ªÄ‰πàÊòØchannelÔºå‰∏∫‰ªÄ‰πàÂÆÉÂèØ‰ª•ÂÅöÂà∞Á∫øÁ®ãÂÆâÂÖ®ÔºüChannelÊòØGo‰∏≠ÁöÑ‰∏Ä‰∏™Ê†∏ÂøÉÁ±ªÂûãÔºåÂèØ‰ª•ÊääÂÆÉÁúãÊàê‰∏Ä‰∏™ÁÆ°ÈÅìÔºåÈÄöËøáÂÆÉÂπ∂ÂèëÊ†∏ÂøÉÂçïÂÖÉÂ∞±ÂèØ‰ª•ÂèëÈÄÅÊàñËÄÖÊé•Êî∂Êï∞ÊçÆËøõË°åÈÄöËÆØ(communication),Channel‰πüÂèØ‰ª•ÁêÜËß£ÊòØ‰∏Ä‰∏™ÂÖàËøõÂÖàÂá∫ÁöÑÈòüÂàóÔºåÈÄöËøáÁÆ°ÈÅìËøõË°åÈÄö‰ø°„ÄÇ GolangÁöÑChannel,ÂèëÈÄÅ‰∏Ä‰∏™Êï∞ÊçÆÂà∞Channel Âíå ‰ªéChannelÊé•Êî∂‰∏Ä‰∏™Êï∞ÊçÆ ÈÉΩÊòØ ÂéüÂ≠êÊÄßÁöÑ„ÄÇËÄå‰∏îGoÁöÑËÆæËÆ°ÊÄùÊÉ≥Â∞±ÊòØ:‰∏çË¶ÅÈÄöËøáÂÖ±‰∫´ÂÜÖÂ≠òÊù•ÈÄö‰ø°ÔºåËÄåÊòØÈÄöËøáÈÄö‰ø°Êù•ÂÖ±‰∫´ÂÜÖÂ≠òÔºåÂâçËÄÖÂ∞±ÊòØ‰º†ÁªüÁöÑÂä†ÈîÅÔºåÂêéËÄÖÂ∞±ÊòØChannel„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåËÆæËÆ°ChannelÁöÑ‰∏ªË¶ÅÁõÆÁöÑÂ∞±ÊòØÂú®Â§ö‰ªªÂä°Èó¥‰º†ÈÄíÊï∞ÊçÆÁöÑÔºåËøôÂΩìÁÑ∂ÊòØÂÆâÂÖ®ÁöÑ„ÄÇ 11. EpollÂéüÁêÜ.ÂºÄÂèëÈ´òÊÄßËÉΩÁΩëÁªúÁ®ãÂ∫èÊó∂ÔºåwindowsÂºÄÂèëËÄÖ‰ª¨Ë®ÄÂøÖÁß∞IocpÔºålinuxÂºÄÂèëËÄÖ‰ª¨ÂàôË®ÄÂøÖÁß∞Epoll„ÄÇÂ§ßÂÆ∂ÈÉΩÊòéÁôΩEpollÊòØ‰∏ÄÁßçIOÂ§öË∑ØÂ§çÁî®ÊäÄÊúØÔºåÂèØ‰ª•ÈùûÂ∏∏È´òÊïàÁöÑÂ§ÑÁêÜÊï∞‰ª•Áôæ‰∏áËÆ°ÁöÑSocketÂè•ÊüÑÔºåÊØîËµ∑‰ª•ÂâçÁöÑSelectÂíåPollÊïàÁéáÊèêÈ´ò‰∫ÜÂæàÂ§ö„ÄÇ ÂÖàÁÆÄÂçï‰∫ÜËß£‰∏ãÂ¶Ç‰Ωï‰ΩøÁî®CÂ∫ìÂ∞ÅË£ÖÁöÑ3‰∏™epollÁ≥ªÁªüË∞ÉÁî®„ÄÇ 123int epoll_create(int size); int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event); int epoll_wait(int epfd, struct epoll_event *events,int maxevents, int timeout); ‰ΩøÁî®Ëµ∑Êù•ÂæàÊ∏ÖÊô∞ÔºåÈ¶ñÂÖàË¶ÅË∞ÉÁî®epoll_createÂª∫Á´ã‰∏Ä‰∏™epollÂØπË±°„ÄÇÂèÇÊï∞sizeÊòØÂÜÖÊ†∏‰øùËØÅËÉΩÂ§üÊ≠£Á°ÆÂ§ÑÁêÜÁöÑÊúÄÂ§ßÂè•ÊüÑÊï∞ÔºåÂ§ö‰∫éËøô‰∏™ÊúÄÂ§ßÊï∞Êó∂ÂÜÖÊ†∏ÂèØ‰∏ç‰øùËØÅÊïàÊûú„ÄÇ epoll_ctlÂèØ‰ª•Êìç‰Ωú‰∏äÈù¢Âª∫Á´ãÁöÑepollÔºå‰æãÂ¶ÇÔºåÂ∞ÜÂàöÂª∫Á´ãÁöÑsocketÂä†ÂÖ•Âà∞epoll‰∏≠ËÆ©ÂÖ∂ÁõëÊéßÔºåÊàñËÄÖÊää epollÊ≠£Âú®ÁõëÊéßÁöÑÊüê‰∏™socketÂè•ÊüÑÁßªÂá∫epollÔºå‰∏çÂÜçÁõëÊéßÂÆÉÁ≠âÁ≠â„ÄÇ epoll_waitÂú®Ë∞ÉÁî®Êó∂ÔºåÂú®ÁªôÂÆöÁöÑtimeoutÊó∂Èó¥ÂÜÖÔºåÂΩìÂú®ÁõëÊéßÁöÑÊâÄÊúâÂè•ÊüÑ‰∏≠Êúâ‰∫ã‰ª∂ÂèëÁîüÊó∂ÔºåÂ∞±ËøîÂõûÁî®Êà∑ÊÄÅÁöÑËøõÁ®ã„ÄÇ ‰ªéË∞ÉÁî®ÊñπÂºèÂ∞±ÂèØ‰ª•ÁúãÂà∞epollÁõ∏ÊØîselect/pollÁöÑ‰ºòË∂ä‰πãÂ§ÑÊòØ,Âõ†‰∏∫ÂêéËÄÖÊØèÊ¨°Ë∞ÉÁî®Êó∂ÈÉΩË¶Å‰º†ÈÄí‰Ω†ÊâÄË¶ÅÁõëÊéßÁöÑÊâÄÊúâsocketÁªôselect/pollÁ≥ªÁªüË∞ÉÁî®ÔºåËøôÊÑèÂë≥ÁùÄÈúÄË¶ÅÂ∞ÜÁî®Êà∑ÊÄÅÁöÑsocketÂàóË°®copyÂà∞ÂÜÖÊ†∏ÊÄÅÔºåÂ¶ÇÊûú‰ª•‰∏áËÆ°ÁöÑÂè•ÊüÑ‰ºöÂØºËá¥ÊØèÊ¨°ÈÉΩË¶ÅcopyÂá†ÂçÅÂá†ÁôæKBÁöÑÂÜÖÂ≠òÂà∞ÂÜÖÊ†∏ÊÄÅÔºåÈùûÂ∏∏‰ΩéÊïà„ÄÇËÄåÊàë‰ª¨Ë∞ÉÁî®epoll_waitÊó∂Â∞±Áõ∏ÂΩì‰∫é‰ª•ÂæÄË∞ÉÁî®select/pollÔºå‰ΩÜÊòØËøôÊó∂Âç¥‰∏çÁî®‰º†ÈÄísocketÂè•ÊüÑÁªôÂÜÖÊ†∏ÔºåÂõ†‰∏∫ÂÜÖÊ†∏Â∑≤ÁªèÂú®epoll_ctl‰∏≠ÊãøÂà∞‰∫ÜË¶ÅÁõëÊéßÁöÑÂè•ÊüÑÂàóË°®„ÄÇ ÊâÄ‰ª•ÔºåÂÆûÈôÖ‰∏äÂú®‰Ω†Ë∞ÉÁî®epoll_createÂêéÔºåÂÜÖÊ†∏Â∞±Â∑≤ÁªèÂú®ÂÜÖÊ†∏ÊÄÅÂºÄÂßãÂáÜÂ§áÂ∏Æ‰Ω†Â≠òÂÇ®Ë¶ÅÁõëÊéßÁöÑÂè•ÊüÑ‰∫ÜÔºåÊØèÊ¨°Ë∞ÉÁî®epoll_ctlÂè™ÊòØÂú®ÂæÄÂÜÖÊ†∏ÁöÑÊï∞ÊçÆÁªìÊûÑÈáåÂ°ûÂÖ•Êñ∞ÁöÑsocketÂè•ÊüÑ„ÄÇ Âú®ÂÜÖÊ†∏ÈáåÔºå‰∏ÄÂàáÁöÜÊñá‰ª∂„ÄÇÊâÄ‰ª•ÔºåepollÂêëÂÜÖÊ†∏Ê≥®ÂÜå‰∫Ü‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªüÔºåÁî®‰∫éÂ≠òÂÇ®‰∏äËø∞ÁöÑË¢´ÁõëÊéßsocket„ÄÇÂΩì‰Ω†Ë∞ÉÁî®epoll_createÊó∂ÔºåÂ∞±‰ºöÂú®Ëøô‰∏™ËôöÊãüÁöÑepollÊñá‰ª∂Á≥ªÁªüÈáåÂàõÂª∫‰∏Ä‰∏™fileÁªìÁÇπ„ÄÇÂΩìÁÑ∂Ëøô‰∏™file‰∏çÊòØÊôÆÈÄöÊñá‰ª∂ÔºåÂÆÉÂè™ÊúçÂä°‰∫éepoll„ÄÇ epollÂú®Ë¢´ÂÜÖÊ†∏ÂàùÂßãÂåñÊó∂ÔºàÊìç‰ΩúÁ≥ªÁªüÂêØÂä®ÔºâÔºåÂêåÊó∂‰ºöÂºÄËæüÂá∫epollËá™Â∑±ÁöÑÂÜÖÊ†∏È´òÈÄücacheÂå∫ÔºåÁî®‰∫éÂÆâÁΩÆÊØè‰∏Ä‰∏™Êàë‰ª¨ÊÉ≥ÁõëÊéßÁöÑsocketÔºåËøô‰∫õsocket‰ºö‰ª•Á∫¢ÈªëÊ†ëÁöÑÂΩ¢Âºè‰øùÂ≠òÂú®ÂÜÖÊ†∏cacheÈáåÔºå‰ª•ÊîØÊåÅÂø´ÈÄüÁöÑÊü•Êâæ„ÄÅÊèíÂÖ•„ÄÅÂà†Èô§„ÄÇËøô‰∏™ÂÜÖÊ†∏È´òÈÄücacheÂå∫ÔºåÂ∞±ÊòØÂª∫Á´ãËøûÁª≠ÁöÑÁâ©ÁêÜÂÜÖÂ≠òÈ°µÔºåÁÑ∂ÂêéÂú®‰πã‰∏äÂª∫Á´ãslabÂ±ÇÔºåÈÄöÂ∏∏Êù•ËÆ≤ÔºåÂ∞±ÊòØÁâ©ÁêÜ‰∏äÂàÜÈÖçÂ•Ω‰Ω†ÊÉ≥Ë¶ÅÁöÑsizeÁöÑÂÜÖÂ≠òÂØπË±°ÔºåÊØèÊ¨°‰ΩøÁî®Êó∂ÈÉΩÊòØ‰ΩøÁî®Á©∫Èó≤ÁöÑÂ∑≤ÂàÜÈÖçÂ•ΩÁöÑÂØπË±°„ÄÇ 1234567891011121314static int __init eventpoll_init(void) &#123; ... ... /* Allocates slab cache used to allocate &quot;struct epitem&quot; items */ epi_cache = kmem_cache_create(&quot;eventpoll_epi&quot;, sizeof(struct epitem), 0, SLAB_HWCACHE_ALIGN|EPI_SLAB_DEBUG|SLAB_PANIC, NULL, NULL); /* Allocates slab cache used to allocate &quot;struct eppoll_entry&quot; */ pwq_cache = kmem_cache_create(&quot;eventpoll_pwq&quot;, sizeof(struct eppoll_entry), 0, EPI_SLAB_DEBUG|SLAB_PANIC, NULL, NULL); ... ... &#125; epollÁöÑÈ´òÊïàÂ∞±Âú®‰∫éÔºåÂΩìÊàë‰ª¨Ë∞ÉÁî®epoll_ctlÂæÄÈáåÂ°ûÂÖ•Áôæ‰∏á‰∏™Âè•ÊüÑÊó∂Ôºåepoll_wait‰ªçÁÑ∂ÂèØ‰ª•È£ûÂø´ÁöÑËøîÂõûÔºåÂπ∂ÊúâÊïàÁöÑÂ∞ÜÂèëÁîü‰∫ã‰ª∂ÁöÑÂè•ÊüÑÁªôÊàë‰ª¨Áî®Êà∑„ÄÇËøôÊòØÁî±‰∫éÊàë‰ª¨Âú®Ë∞ÉÁî®epoll_createÊó∂ÔºåÂÜÖÊ†∏Èô§‰∫ÜÂ∏ÆÊàë‰ª¨Âú®epollÊñá‰ª∂Á≥ªÁªüÈáåÂª∫‰∫Ü‰∏™fileÁªìÁÇπÔºåÂú®ÂÜÖÊ†∏cacheÈáåÂª∫‰∫Ü‰∏™Á∫¢ÈªëÊ†ëÁî®‰∫éÂ≠òÂÇ®‰ª•Âêéepoll_ctl‰º†Êù•ÁöÑsocketÂ§ñÔºåËøò‰ºöÂÜçÂª∫Á´ã‰∏Ä‰∏™listÈìæË°®ÔºåÁî®‰∫éÂ≠òÂÇ®ÂáÜÂ§áÂ∞±Áª™ÁöÑ‰∫ã‰ª∂ÔºåÂΩìepoll_waitË∞ÉÁî®Êó∂Ôºå‰ªÖ‰ªÖËßÇÂØüËøô‰∏™listÈìæË°®ÈáåÊúâÊ≤°ÊúâÊï∞ÊçÆÂç≥ÂèØ„ÄÇÊúâÊï∞ÊçÆÂ∞±ËøîÂõûÔºåÊ≤°ÊúâÊï∞ÊçÆÂ∞±sleepÔºåÁ≠âÂà∞timeoutÊó∂Èó¥Âà∞ÂêéÂç≥‰ΩøÈìæË°®Ê≤°Êï∞ÊçÆ‰πüËøîÂõû„ÄÇÊâÄ‰ª•Ôºåepoll_waitÈùûÂ∏∏È´òÊïà„ÄÇ ËÄå‰∏îÔºåÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÂç≥‰ΩøÊàë‰ª¨Ë¶ÅÁõëÊéßÁôæ‰∏áËÆ°ÁöÑÂè•ÊüÑÔºåÂ§ßÂ§ö‰∏ÄÊ¨°‰πüÂè™ËøîÂõûÂæàÂ∞ëÈáèÁöÑÂáÜÂ§áÂ∞±Áª™Âè•ÊüÑËÄåÂ∑≤ÔºåÊâÄ‰ª•Ôºåepoll_wait‰ªÖÈúÄË¶Å‰ªéÂÜÖÊ†∏ÊÄÅcopyÂ∞ëÈáèÁöÑÂè•ÊüÑÂà∞Áî®Êà∑ÊÄÅËÄåÂ∑≤ÔºåÂõ†Ê≠§Â∞±‰ºöÈùûÂ∏∏ÁöÑÈ´òÊïàÔºÅ ÁÑ∂ËÄå,Ëøô‰∏™ÂáÜÂ§áÂ∞±Áª™listÈìæË°®ÊòØÊÄé‰πàÁª¥Êä§ÁöÑÂë¢ÔºüÂΩìÊàë‰ª¨ÊâßË°åepoll_ctlÊó∂ÔºåÈô§‰∫ÜÊääsocketÊîæÂà∞epollÊñá‰ª∂Á≥ªÁªüÈáåfileÂØπË±°ÂØπÂ∫îÁöÑÁ∫¢ÈªëÊ†ë‰∏ä‰πãÂ§ñÔºåËøò‰ºöÁªôÂÜÖÊ†∏‰∏≠Êñ≠Â§ÑÁêÜÁ®ãÂ∫èÊ≥®ÂÜå‰∏Ä‰∏™ÂõûË∞ÉÂáΩÊï∞ÔºåÂëäËØâÂÜÖÊ†∏ÔºåÂ¶ÇÊûúËøô‰∏™Âè•ÊüÑÁöÑ‰∏≠Êñ≠Âà∞‰∫ÜÔºåÂ∞±ÊääÂÆÉÊîæÂà∞ÂáÜÂ§áÂ∞±Áª™listÈìæË°®Èáå„ÄÇÊâÄ‰ª•ÔºåÂΩì‰∏Ä‰∏™socket‰∏äÊúâÊï∞ÊçÆÂà∞‰∫ÜÔºåÂÜÖÊ†∏Âú®ÊääÁΩëÂç°‰∏äÁöÑÊï∞ÊçÆcopyÂà∞ÂÜÖÊ†∏‰∏≠ÂêéÂ∞±Êù•ÊääsocketÊèíÂÖ•Âà∞ÂáÜÂ§áÂ∞±Áª™ÈìæË°®Èáå‰∫Ü„ÄÇ Â¶ÇÊ≠§Ôºå‰∏Ä‰∏™Á∫¢ÈªëÊ†ëÔºå‰∏ÄÂº†ÂáÜÂ§áÂ∞±Áª™Âè•ÊüÑÈìæË°®ÔºåÂ∞ëÈáèÁöÑÂÜÖÊ†∏cacheÔºåÂ∞±Â∏ÆÊàë‰ª¨Ëß£ÂÜ≥‰∫ÜÂ§ßÂπ∂Âèë‰∏ãÁöÑsocketÂ§ÑÁêÜÈóÆÈ¢ò„ÄÇÊâßË°åepoll_createÊó∂ÔºåÂàõÂª∫‰∫ÜÁ∫¢ÈªëÊ†ëÂíåÂ∞±Áª™ÈìæË°®ÔºåÊâßË°åepoll_ctlÊó∂ÔºåÂ¶ÇÊûúÂ¢ûÂä†socketÂè•ÊüÑÔºåÂàôÊ£ÄÊü•Âú®Á∫¢ÈªëÊ†ë‰∏≠ÊòØÂê¶Â≠òÂú®ÔºåÂ≠òÂú®Á´ãÂç≥ËøîÂõûÔºå‰∏çÂ≠òÂú®ÂàôÊ∑ªÂä†Âà∞Ê†ëÂπ≤‰∏äÔºåÁÑ∂ÂêéÂêëÂÜÖÊ†∏Ê≥®ÂÜåÂõûË∞ÉÂáΩÊï∞ÔºåÁî®‰∫éÂΩì‰∏≠Êñ≠‰∫ã‰ª∂Êù•‰∏¥Êó∂ÂêëÂáÜÂ§áÂ∞±Áª™ÈìæË°®‰∏≠ÊèíÂÖ•Êï∞ÊçÆ„ÄÇÊâßË°åepoll_waitÊó∂Á´ãÂàªËøîÂõûÂáÜÂ§áÂ∞±Áª™ÈìæË°®ÈáåÁöÑÊï∞ÊçÆÂç≥ÂèØ„ÄÇ ÊúÄÂêéÁúãÁúãepollÁã¨ÊúâÁöÑ‰∏§ÁßçÊ®°ÂºèLTÂíåET„ÄÇÊó†ËÆ∫ÊòØLTÂíåETÊ®°ÂºèÔºåÈÉΩÈÄÇÁî®‰∫é‰ª•‰∏äÊâÄËØ¥ÁöÑÊµÅÁ®ã„ÄÇÂå∫Âà´ÊòØÔºåLTÊ®°Âºè‰∏ãÔºåÂè™Ë¶Å‰∏Ä‰∏™Âè•ÊüÑ‰∏äÁöÑ‰∫ã‰ª∂‰∏ÄÊ¨°Ê≤°ÊúâÂ§ÑÁêÜÂÆåÔºå‰ºöÂú®‰ª•ÂêéË∞ÉÁî®epoll_waitÊó∂ÊØèÊ¨°ËøîÂõûËøô‰∏™Âè•ÊüÑÔºåËÄåETÊ®°Âºè‰ªÖÂú®Á¨¨‰∏ÄÊ¨°ËøîÂõû„ÄÇ ÂΩì‰∏Ä‰∏™socketÂè•ÊüÑ‰∏äÊúâ‰∫ã‰ª∂Êó∂ÔºåÂÜÖÊ†∏‰ºöÊääËØ•Âè•ÊüÑÊèíÂÖ•‰∏äÈù¢ÊâÄËØ¥ÁöÑÂáÜÂ§áÂ∞±Áª™listÈìæË°®ÔºåËøôÊó∂Êàë‰ª¨Ë∞ÉÁî®epoll_waitÔºå‰ºöÊääÂáÜÂ§áÂ∞±Áª™ÁöÑsocketÊã∑Ë¥ùÂà∞Áî®Êà∑ÊÄÅÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊ∏ÖÁ©∫ÂáÜÂ§áÂ∞±Áª™listÈìæË°®ÔºåÊúÄÂêéÔºåepoll_waitÈúÄË¶ÅÂÅöÁöÑ‰∫ãÊÉÖÔºåÂ∞±ÊòØÊ£ÄÊü•Ëøô‰∫õsocketÔºåÂ¶ÇÊûú‰∏çÊòØETÊ®°ÂºèÔºàÂ∞±ÊòØLTÊ®°ÂºèÁöÑÂè•ÊüÑ‰∫ÜÔºâÔºåÂπ∂‰∏îËøô‰∫õsocket‰∏äÁ°ÆÂÆûÊúâÊú™Â§ÑÁêÜÁöÑ‰∫ã‰ª∂Êó∂ÔºåÂèàÊääËØ•Âè•ÊüÑÊîæÂõûÂà∞ÂàöÂàöÊ∏ÖÁ©∫ÁöÑÂáÜÂ§áÂ∞±Áª™ÈìæË°®‰∫Ü„ÄÇÊâÄ‰ª•ÔºåÈùûETÁöÑÂè•ÊüÑÔºåÂè™Ë¶ÅÂÆÉ‰∏äÈù¢ËøòÊúâ‰∫ã‰ª∂Ôºåepoll_waitÊØèÊ¨°ÈÉΩ‰ºöËøîÂõû„ÄÇËÄåETÊ®°ÂºèÁöÑÂè•ÊüÑÔºåÈô§ÈùûÊúâÊñ∞‰∏≠Êñ≠Âà∞ÔºåÂç≥‰Ωøsocket‰∏äÁöÑ‰∫ã‰ª∂Ê≤°ÊúâÂ§ÑÁêÜÂÆåÔºå‰πüÊòØ‰∏ç‰ºöÊØèÊ¨°‰ªéepoll_waitËøîÂõûÁöÑ„ÄÇ Âõ†Ê≠§epollÊØîselectÁöÑÊèêÈ´òÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™Áî®Á©∫Èó¥Êç¢Êó∂Èó¥ÊÄùÊÉ≥ÁöÑÂÖ∑‰ΩìÂ∫îÁî®.ÂØπÊØîÈòªÂ°ûIOÁöÑÂ§ÑÁêÜÊ®°Âûã, ÂèØ‰ª•ÁúãÂà∞ÈááÁî®‰∫ÜÂ§öË∑ØÂ§çÁî®IO‰πãÂêé, Á®ãÂ∫èÂèØ‰ª•Ëá™Áî±ÁöÑËøõË°åËá™Â∑±Èô§‰∫ÜIOÊìç‰Ωú‰πãÂ§ñÁöÑÂ∑•‰Ωú, Âè™ÊúâÂà∞IOÁä∂ÊÄÅÂèëÁîüÂèòÂåñÁöÑÊó∂ÂÄôÁî±Â§öË∑ØÂ§çÁî®IOËøõË°åÈÄöÁü•, ÁÑ∂ÂêéÂÜçÈááÂèñÁõ∏Â∫îÁöÑÊìç‰Ωú, ËÄå‰∏çÁî®‰∏ÄÁõ¥ÈòªÂ°ûÁ≠âÂæÖIOÁä∂ÊÄÅÂèëÁîüÂèòÂåñ,ÊèêÈ´òÊïàÁéá. 12. Golang GC Êó∂‰ºöÂèëÁîü‰ªÄ‰πà?È¶ñÂÖàÊàë‰ª¨ÂÖàÊù•‰∫ÜËß£‰∏ãÂûÉÂúæÂõûÊî∂.‰ªÄ‰πàÊòØÂûÉÂúæÂõûÊî∂Ôºü ÂÜÖÂ≠òÁÆ°ÁêÜÊòØÁ®ãÂ∫èÂëòÂºÄÂèëÂ∫îÁî®ÁöÑ‰∏ÄÂ§ßÈöæÈ¢ò„ÄÇ‰º†ÁªüÁöÑÁ≥ªÁªüÁ∫ßÁºñÁ®ãËØ≠Ë®ÄÔºà‰∏ªË¶ÅÊåáC/C++Ôºâ‰∏≠ÔºåÁ®ãÂ∫èÂºÄÂèëËÄÖÂøÖÈ°ªÂØπÂÜÖÂ≠òÂ∞èÂøÉÁöÑËøõË°åÁÆ°ÁêÜÊìç‰ΩúÔºåÊéßÂà∂ÂÜÖÂ≠òÁöÑÁî≥ËØ∑ÂèäÈáäÊîæ„ÄÇÂõ†‰∏∫Á®çÊúâ‰∏çÊÖéÔºåÂ∞±ÂèØËÉΩ‰∫ßÁîüÂÜÖÂ≠òÊ≥ÑÈú≤ÈóÆÈ¢òÔºåËøôÁßçÈóÆÈ¢ò‰∏çÊòìÂèëÁé∞Âπ∂‰∏îÈöæ‰ª•ÂÆö‰ΩçÔºå‰∏ÄÁõ¥Êàê‰∏∫Âõ∞Êâ∞Á®ãÂ∫èÂºÄÂèëËÄÖÁöÑÂô©Ê¢¶„ÄÇÂ¶Ç‰ΩïËß£ÂÜ≥Ëøô‰∏™Â§¥ÁñºÁöÑÈóÆÈ¢òÂë¢Ôºü ËøáÂéª‰∏ÄËà¨ÈááÁî®‰∏§ÁßçÂäûÊ≥ïÔºö ÂÜÖÂ≠òÊ≥ÑÈú≤Ê£ÄÊµãÂ∑•ÂÖ∑„ÄÇËøôÁßçÂ∑•ÂÖ∑ÁöÑÂéüÁêÜ‰∏ÄËà¨ÊòØÈùôÊÄÅ‰ª£Á†ÅÊâ´ÊèèÔºåÈÄöËøáÊâ´ÊèèÁ®ãÂ∫èÊ£ÄÊµãÂèØËÉΩÂá∫Áé∞ÂÜÖÂ≠òÊ≥ÑÈú≤ÁöÑ‰ª£Á†ÅÊÆµ„ÄÇÁÑ∂ËÄåÊ£ÄÊµãÂ∑•ÂÖ∑ÈöæÂÖçÊúâÁñèÊºèÂíå‰∏çË∂≥ÔºåÂè™ËÉΩËµ∑Âà∞ËæÖÂä©‰ΩúÁî®„ÄÇ Êô∫ËÉΩÊåáÈíà„ÄÇËøôÊòØ c++ ‰∏≠ÂºïÂÖ•ÁöÑËá™Âä®ÂÜÖÂ≠òÁÆ°ÁêÜÊñπÊ≥ïÔºåÈÄöËøáÊã•ÊúâËá™Âä®ÂÜÖÂ≠òÁÆ°ÁêÜÂäüËÉΩÁöÑÊåáÈíàÂØπË±°Êù•ÂºïÁî®ÂØπË±°ÔºåÊòØÁ®ãÂ∫èÂëò‰∏çÁî®Â§™ÂÖ≥Ê≥®ÂÜÖÂ≠òÁöÑÈáäÊîæÔºåËÄåËææÂà∞ÂÜÖÂ≠òËá™Âä®ÈáäÊîæÁöÑÁõÆÁöÑ„ÄÇËøôÁßçÊñπÊ≥ïÊòØÈááÁî®ÊúÄÂπøÊ≥õÁöÑÂÅöÊ≥ïÔºå‰ΩÜÊòØÂØπÁ®ãÂ∫èÂºÄÂèëËÄÖÊúâ‰∏ÄÂÆöÁöÑÂ≠¶‰π†ÊàêÊú¨ÔºàÂπ∂ÈùûËØ≠Ë®ÄÂ±ÇÈù¢ÁöÑÂéüÁîüÊîØÊåÅÔºâÔºåËÄå‰∏î‰∏ÄÊó¶ÊúâÂøòËÆ∞‰ΩøÁî®ÁöÑÂú∫ÊôØ‰æùÁÑ∂Êó†Ê≥ïÈÅøÂÖçÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇ ‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÂêéÊù•ÂºÄÂèëÂá∫Êù•ÁöÑÂá†‰πéÊâÄÊúâÊñ∞ËØ≠Ë®ÄÔºàjavaÔºåpythonÔºåphpÁ≠âÁ≠âÔºâÈÉΩÂºïÂÖ•‰∫ÜËØ≠Ë®ÄÂ±ÇÈù¢ÁöÑËá™Âä®ÂÜÖÂ≠òÁÆ°ÁêÜ ‚Äì ‰πüÂ∞±ÊòØËØ≠Ë®ÄÁöÑ‰ΩøÁî®ËÄÖÂè™Áî®ÂÖ≥Ê≥®ÂÜÖÂ≠òÁöÑÁî≥ËØ∑ËÄå‰∏çÂøÖÂÖ≥ÂøÉÂÜÖÂ≠òÁöÑÈáäÊîæÔºåÂÜÖÂ≠òÈáäÊîæÁî±ËôöÊãüÊú∫Ôºàvirtual machineÔºâÊàñËøêË°åÊó∂ÔºàruntimeÔºâÊù•Ëá™Âä®ËøõË°åÁÆ°ÁêÜ„ÄÇËÄåËøôÁßçÂØπ‰∏çÂÜç‰ΩøÁî®ÁöÑÂÜÖÂ≠òËµÑÊ∫êËøõË°åËá™Âä®ÂõûÊî∂ÁöÑË°å‰∏∫Â∞±Ë¢´Áß∞‰∏∫ÂûÉÂúæÂõûÊî∂„ÄÇ Â∏∏Áî®ÁöÑÂûÉÂúæÂõûÊî∂ÁöÑÊñπÊ≥ï: ÂºïÁî®ËÆ°Êï∞Ôºàreference countingÔºâ ËøôÊòØÊúÄÁÆÄÂçïÁöÑ‰∏ÄÁßçÂûÉÂúæÂõûÊî∂ÁÆóÊ≥ïÔºåÂíå‰πãÂâçÊèêÂà∞ÁöÑÊô∫ËÉΩÊåáÈíàÂºÇÊõ≤ÂêåÂ∑•„ÄÇÂØπÊØè‰∏™ÂØπË±°Áª¥Êä§‰∏Ä‰∏™ÂºïÁî®ËÆ°Êï∞ÔºåÂΩìÂºïÁî®ËØ•ÂØπË±°ÁöÑÂØπË±°Ë¢´ÈîÄÊØÅÊàñÊõ¥Êñ∞Êó∂Ë¢´ÂºïÁî®ÂØπË±°ÁöÑÂºïÁî®ËÆ°Êï∞Ëá™Âä®Âáè‰∏ÄÔºåÂΩìË¢´ÂºïÁî®ÂØπË±°Ë¢´ÂàõÂª∫ÊàñË¢´ËµãÂÄºÁªôÂÖ∂‰ªñÂØπË±°Êó∂ÂºïÁî®ËÆ°Êï∞Ëá™Âä®Âä†‰∏Ä„ÄÇÂΩìÂºïÁî®ËÆ°Êï∞‰∏∫0Êó∂ÂàôÁ´ãÂç≥ÂõûÊî∂ÂØπË±°„ÄÇ ËøôÁßçÊñπÊ≥ïÁöÑ‰ºòÁÇπÊòØÂÆûÁé∞ÁÆÄÂçïÔºåÂπ∂‰∏îÂÜÖÂ≠òÁöÑÂõûÊî∂ÂæàÂèäÊó∂„ÄÇËøôÁßçÁÆóÊ≥ïÂú®ÂÜÖÂ≠òÊØîËæÉÁ¥ßÂº†ÂíåÂÆûÊó∂ÊÄßÊØîËæÉÈ´òÁöÑÁ≥ªÁªü‰∏≠‰ΩøÁî®ÁöÑÊØîËæÉÂπøÊ≥õÔºåÂ¶Çios cocoaÊ°ÜÊû∂ÔºåphpÔºåpythonÁ≠â„ÄÇ ‰ΩÜÊòØÁÆÄÂçïÂºïÁî®ËÆ°Êï∞ÁÆóÊ≥ï‰πüÊúâÊòéÊòæÁöÑÁº∫ÁÇπÔºö È¢ëÁπÅÊõ¥Êñ∞ÂºïÁî®ËÆ°Êï∞Èôç‰Ωé‰∫ÜÊÄßËÉΩ„ÄÇ ‰∏ÄÁßçÁÆÄÂçïÁöÑËß£ÂÜ≥ÊñπÊ≥ïÂ∞±ÊòØÁºñËØëÂô®Â∞ÜÁõ∏ÈÇªÁöÑÂºïÁî®ËÆ°Êï∞Êõ¥Êñ∞Êìç‰ΩúÂêàÂπ∂Âà∞‰∏ÄÊ¨°Êõ¥Êñ∞ÔºõËøòÊúâ‰∏ÄÁßçÊñπÊ≥ïÊòØÈíàÂØπÈ¢ëÁπÅÂèëÁîüÁöÑ‰∏¥Êó∂ÂèòÈáèÂºïÁî®‰∏çËøõË°åËÆ°Êï∞ÔºåËÄåÊòØÂú®ÂºïÁî®ËææÂà∞0Êó∂ÈÄöËøáÊâ´ÊèèÂ†ÜÊ†àÁ°ÆËÆ§ÊòØÂê¶ËøòÊúâ‰∏¥Êó∂ÂØπË±°ÂºïÁî®ËÄåÂÜ≥ÂÆöÊòØÂê¶ÈáäÊîæ„ÄÇÁ≠âÁ≠âËøòÊúâÂæàÂ§öÂÖ∂‰ªñÊñπÊ≥ïÔºåÂÖ∑‰ΩìÂèØ‰ª•ÂèÇËÄÉËøôÈáå„ÄÇ Âæ™ÁéØÂºïÁî®„ÄÇ ÂΩìÂØπË±°Èó¥ÂèëÁîüÂæ™ÁéØÂºïÁî®Êó∂ÂºïÁî®Èìæ‰∏≠ÁöÑÂØπË±°ÈÉΩÊó†Ê≥ïÂæóÂà∞ÈáäÊîæ„ÄÇÊúÄÊòéÊòæÁöÑËß£ÂÜ≥ÂäûÊ≥ïÊòØÈÅøÂÖç‰∫ßÁîüÂæ™ÁéØÂºïÁî®ÔºåÂ¶ÇcocoaÂºïÂÖ•‰∫ÜstrongÊåáÈíàÂíåweakÊåáÈíà‰∏§ÁßçÊåáÈíàÁ±ªÂûã„ÄÇÊàñËÄÖÁ≥ªÁªüÊ£ÄÊµãÂæ™ÁéØÂºïÁî®Âπ∂‰∏ªÂä®ÊâìÁ†¥Âæ™ÁéØÈìæ„ÄÇÂΩìÁÑ∂Ëøô‰πüÂ¢ûÂä†‰∫ÜÂûÉÂúæÂõûÊî∂ÁöÑÂ§çÊùÇÂ∫¶„ÄÇ Ê†áËÆ∞-Ê∏ÖÈô§Ôºàmark and sweepÔºâ Ê†áËÆ∞-Ê∏ÖÈô§Ôºàmark and sweepÔºâÂàÜ‰∏∫‰∏§Ê≠•ÔºåÊ†áËÆ∞‰ªéÊ†πÂèòÈáèÂºÄÂßãËø≠‰ª£ÂæóÈÅçÂéÜÊâÄÊúâË¢´ÂºïÁî®ÁöÑÂØπË±°ÔºåÂØπËÉΩÂ§üÈÄöËøáÂ∫îÁî®ÈÅçÂéÜËÆøÈóÆÂà∞ÁöÑÂØπË±°ÈÉΩËøõË°åÊ†áËÆ∞‰∏∫‚ÄúË¢´ÂºïÁî®‚ÄùÔºõÊ†áËÆ∞ÂÆåÊàêÂêéËøõË°åÊ∏ÖÈô§Êìç‰ΩúÔºåÂØπÊ≤°ÊúâÊ†áËÆ∞ËøáÁöÑÂÜÖÂ≠òËøõË°åÂõûÊî∂ÔºàÂõûÊî∂ÂêåÊó∂ÂèØËÉΩ‰º¥ÊúâÁ¢éÁâáÊï¥ÁêÜÊìç‰ΩúÔºâ„ÄÇËøôÁßçÊñπÊ≥ïËß£ÂÜ≥‰∫ÜÂºïÁî®ËÆ°Êï∞ÁöÑ‰∏çË∂≥Ôºå‰ΩÜÊòØ‰πüÊúâÊØîËæÉÊòéÊòæÁöÑÈóÆÈ¢òÔºöÊØèÊ¨°ÂêØÂä®ÂûÉÂúæÂõûÊî∂ÈÉΩ‰ºöÊöÇÂÅúÂΩìÂâçÊâÄÊúâÁöÑÊ≠£Â∏∏‰ª£Á†ÅÊâßË°åÔºåÂõûÊî∂ÊòØÁ≥ªÁªüÂìçÂ∫îËÉΩÂäõÂ§ßÂ§ßÈôç‰ΩéÔºÅÂΩìÁÑ∂ÂêéÁª≠‰πüÂá∫Áé∞‰∫ÜÂæàÂ§ömark&amp;sweepÁÆóÊ≥ïÁöÑÂèòÁßçÔºàÂ¶Ç‰∏âËâ≤Ê†áËÆ∞Ê≥ïÔºâ‰ºòÂåñ‰∫ÜËøô‰∏™ÈóÆÈ¢ò„ÄÇ ÂàÜ‰ª£ÊêúÈõÜÔºàgenerationÔºâ javaÁöÑjvm Â∞±‰ΩøÁî®ÁöÑÂàÜ‰ª£ÂõûÊî∂ÁöÑÊÄùË∑Ø„ÄÇÂú®Èù¢ÂêëÂØπË±°ÁºñÁ®ãËØ≠Ë®Ä‰∏≠ÔºåÁªùÂ§ßÂ§öÊï∞ÂØπË±°ÁöÑÁîüÂëΩÂë®ÊúüÈÉΩÈùûÂ∏∏Áü≠„ÄÇÂàÜ‰ª£Êî∂ÈõÜÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÊòØÔºåÂ∞ÜÂ†ÜÂàíÂàÜ‰∏∫‰∏§‰∏™ÊàñÂ§ö‰∏™Áß∞‰∏∫‰ª£ÔºàgenerationÔºâÁöÑÁ©∫Èó¥„ÄÇÊñ∞ÂàõÂª∫ÁöÑÂØπË±°Â≠òÊîæÂú®Áß∞‰∏∫Êñ∞Áîü‰ª£Ôºàyoung generationÔºâ‰∏≠Ôºà‰∏ÄËà¨Êù•ËØ¥ÔºåÊñ∞Áîü‰ª£ÁöÑÂ§ßÂ∞è‰ºöÊØî ËÄÅÂπ¥‰ª£Â∞èÂæàÂ§öÔºâÔºåÈöèÁùÄÂûÉÂúæÂõûÊî∂ÁöÑÈáçÂ§çÊâßË°åÔºåÁîüÂëΩÂë®ÊúüËæÉÈïøÁöÑÂØπË±°‰ºöË¢´ÊèêÂçáÔºàpromotionÔºâÂà∞ËÄÅÂπ¥‰ª£‰∏≠ÔºàËøôÈáåÁî®Âà∞‰∫Ü‰∏Ä‰∏™ÂàÜÁ±ªÁöÑÊÄùË∑ØÔºåËøô‰∏™ÊòØ‰πüÊòØÁßëÂ≠¶ÊÄùËÄÉÁöÑ‰∏Ä‰∏™Âü∫Êú¨ÊÄùË∑ØÔºâ„ÄÇ Âõ†Ê≠§ÔºåÊñ∞Áîü‰ª£ÂûÉÂúæÂõûÊî∂ÂíåËÄÅÂπ¥‰ª£ÂûÉÂúæÂõûÊî∂‰∏§Áßç‰∏çÂêåÁöÑÂûÉÂúæÂõûÊî∂ÊñπÂºèÂ∫îËøêËÄåÁîüÔºåÂàÜÂà´Áî®‰∫éÂØπÂêÑËá™Á©∫Èó¥‰∏≠ÁöÑÂØπË±°ÊâßË°åÂûÉÂúæÂõûÊî∂„ÄÇÊñ∞Áîü‰ª£ÂûÉÂúæÂõûÊî∂ÁöÑÈÄüÂ∫¶ÈùûÂ∏∏Âø´ÔºåÊØîËÄÅÂπ¥‰ª£Âø´Âá†‰∏™Êï∞ÈáèÁ∫ßÔºåÂç≥‰ΩøÊñ∞Áîü‰ª£ÂûÉÂúæÂõûÊî∂ÁöÑÈ¢ëÁéáÊõ¥È´òÔºåÊâßË°åÊïàÁéá‰πü‰ªçÁÑ∂ÊØîËÄÅÂπ¥‰ª£ÂûÉÂúæÂõûÊî∂Âº∫ÔºåËøôÊòØÂõ†‰∏∫Â§ßÂ§öÊï∞ÂØπË±°ÁöÑÁîüÂëΩÂë®ÊúüÈÉΩÂæàÁü≠ÔºåÊ†πÊú¨Êó†ÈúÄÊèêÂçáÂà∞ËÄÅÂπ¥‰ª£„ÄÇ Golang GC Êó∂‰ºöÂèëÁîü‰ªÄ‰πà? Golang 1.5ÂêéÔºåÈááÂèñÁöÑÊòØ‚ÄúÈùûÂàÜ‰ª£ÁöÑ„ÄÅÈùûÁßªÂä®ÁöÑ„ÄÅÂπ∂ÂèëÁöÑ„ÄÅ‰∏âËâ≤ÁöÑ‚ÄùÊ†áËÆ∞Ê∏ÖÈô§ÂûÉÂúæÂõûÊî∂ÁÆóÊ≥ï„ÄÇ golang ‰∏≠ÁöÑ gc Âü∫Êú¨‰∏äÊòØÊ†áËÆ∞Ê∏ÖÈô§ÁöÑËøáÁ®ãÔºö gcÁöÑËøáÁ®ã‰∏ÄÂÖ±ÂàÜ‰∏∫Âõõ‰∏™Èò∂ÊÆµÔºö Ê†àÊâ´ÊèèÔºàÂºÄÂßãÊó∂STWÔºâ Á¨¨‰∏ÄÊ¨°Ê†áËÆ∞ÔºàÂπ∂ÂèëÔºâ Á¨¨‰∫åÊ¨°Ê†áËÆ∞ÔºàSTWÔºâ Ê∏ÖÈô§ÔºàÂπ∂ÂèëÔºâ Êï¥‰∏™ËøõÁ®ãÁ©∫Èó¥ÈáåÁî≥ËØ∑ÊØè‰∏™ÂØπË±°Âç†ÊçÆÁöÑÂÜÖÂ≠òÂèØ‰ª•ËßÜ‰∏∫‰∏Ä‰∏™ÂõæÔºåÂàùÂßãÁä∂ÊÄÅ‰∏ãÊØè‰∏™ÂÜÖÂ≠òÂØπË±°ÈÉΩÊòØÁôΩËâ≤Ê†áËÆ∞„ÄÇ ÂÖàSTWÔºåÂÅö‰∏Ä‰∫õÂáÜÂ§áÂ∑•‰ΩúÔºåÊØîÂ¶Ç enable write barrier„ÄÇÁÑ∂ÂêéÂèñÊ∂àSTWÔºåÂ∞ÜÊâ´Êèè‰ªªÂä°‰Ωú‰∏∫Â§ö‰∏™Âπ∂ÂèëÁöÑgoroutineÁ´ãÂç≥ÂÖ•ÈòüÁªôË∞ÉÂ∫¶Âô®ÔºåËøõËÄåË¢´CPUÂ§ÑÁêÜ Á¨¨‰∏ÄËΩÆÂÖàÊâ´ÊèèrootÂØπË±°ÔºåÂåÖÊã¨ÂÖ®Â±ÄÊåáÈíàÂíå goroutine Ê†à‰∏äÁöÑÊåáÈíàÔºåÊ†áËÆ∞‰∏∫ÁÅ∞Ëâ≤ÊîæÂÖ•ÈòüÂàó Á¨¨‰∫åËΩÆÂ∞ÜÁ¨¨‰∏ÄÊ≠•ÈòüÂàó‰∏≠ÁöÑÂØπË±°ÂºïÁî®ÁöÑÂØπË±°ÁΩÆ‰∏∫ÁÅ∞Ëâ≤Âä†ÂÖ•ÈòüÂàóÔºå‰∏Ä‰∏™ÂØπË±°ÂºïÁî®ÁöÑÊâÄÊúâÂØπË±°ÈÉΩÁΩÆÁÅ∞Âπ∂Âä†ÂÖ•ÈòüÂàóÂêéÔºåËøô‰∏™ÂØπË±°ÊâçËÉΩÁΩÆ‰∏∫ÈªëËâ≤Âπ∂‰ªéÈòüÂàó‰πã‰∏≠ÂèñÂá∫„ÄÇÂæ™ÁéØÂæÄÂ§çÔºåÊúÄÂêéÈòüÂàó‰∏∫Á©∫Êó∂ÔºåÊï¥‰∏™ÂõæÂâ©‰∏ãÁöÑÁôΩËâ≤ÂÜÖÂ≠òÁ©∫Èó¥Âç≥‰∏çÂèØÂà∞ËææÁöÑÂØπË±°ÔºåÂç≥Ê≤°ÊúâË¢´ÂºïÁî®ÁöÑÂØπË±°Ôºõ Á¨¨‰∏âËΩÆÂÜçÊ¨°STWÔºåÂ∞ÜÁ¨¨‰∫åËΩÆËøáÁ®ã‰∏≠Êñ∞Â¢ûÂØπË±°Áî≥ËØ∑ÁöÑÂÜÖÂ≠òËøõË°åÊ†áËÆ∞ÔºàÁÅ∞Ëâ≤ÔºâÔºåËøôÈáå‰ΩøÁî®‰∫Üwrite barrierÔºàÂÜôÂ±èÈöúÔºâÂéªËÆ∞ÂΩï Golang gc ‰ºòÂåñÁöÑÊ†∏ÂøÉÂ∞±ÊòØÂ∞ΩÈáè‰ΩøÂæó STW(Stop The World) ÁöÑÊó∂Èó¥Ë∂äÊù•Ë∂äÁü≠„ÄÇ ËØ¶ÁªÜÁöÑGolangÁöÑGC‰ªãÁªçÂèØ‰ª•ÂèÇÁúãGolangÂûÉÂúæÂõûÊî∂. 13. Golang ‰∏≠ Goroutine Â¶Ç‰ΩïË∞ÉÂ∫¶?goroutineÊòØGolangËØ≠Ë®Ä‰∏≠ÊúÄÁªèÂÖ∏ÁöÑËÆæËÆ°Ôºå‰πüÊòØÂÖ∂È≠ÖÂäõÊâÄÂú®ÔºågoroutineÁöÑÊú¨Ë¥®ÊòØÂçèÁ®ãÔºåÊòØÂÆûÁé∞Âπ∂Ë°åËÆ°ÁÆóÁöÑÊ†∏ÂøÉ„ÄÇ goroutine‰ΩøÁî®ÊñπÂºèÈùûÂ∏∏ÁöÑÁÆÄÂçïÔºåÂè™ÈúÄ‰ΩøÁî®goÂÖ≥ÈîÆÂ≠óÂç≥ÂèØÂêØÂä®‰∏Ä‰∏™ÂçèÁ®ãÔºåÂπ∂‰∏îÂÆÉÊòØÂ§Ñ‰∫éÂºÇÊ≠•ÊñπÂºèËøêË°åÔºå‰Ω†‰∏çÈúÄË¶ÅÁ≠âÂÆÉËøêË°åÂÆåÊàê‰ª•ÂêéÂú®ÊâßË°å‰ª•ÂêéÁöÑ‰ª£Á†Å„ÄÇ 1go func()//ÈÄöËøágoÂÖ≥ÈîÆÂ≠óÂêØÂä®‰∏Ä‰∏™ÂçèÁ®ãÊù•ËøêË°åÂáΩÊï∞ ÂçèÁ®ã: ÂçèÁ®ãÊã•ÊúâËá™Â∑±ÁöÑÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†à„ÄÇÂçèÁ®ãË∞ÉÂ∫¶ÂàáÊç¢Êó∂ÔºåÂ∞ÜÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†à‰øùÂ≠òÂà∞ÂÖ∂‰ªñÂú∞ÊñπÔºåÂú®ÂàáÂõûÊù•ÁöÑÊó∂ÂÄôÔºåÊÅ¢Â§çÂÖàÂâç‰øùÂ≠òÁöÑÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†à„ÄÇ Âõ†Ê≠§ÔºåÂçèÁ®ãËÉΩ‰øùÁïô‰∏ä‰∏ÄÊ¨°Ë∞ÉÁî®Êó∂ÁöÑÁä∂ÊÄÅÔºàÂç≥ÊâÄÊúâÂ±ÄÈÉ®Áä∂ÊÄÅÁöÑ‰∏Ä‰∏™ÁâπÂÆöÁªÑÂêàÔºâÔºåÊØèÊ¨°ËøáÁ®ãÈáçÂÖ•Êó∂ÔºåÂ∞±Áõ∏ÂΩì‰∫éËøõÂÖ•‰∏ä‰∏ÄÊ¨°Ë∞ÉÁî®ÁöÑÁä∂ÊÄÅÔºåÊç¢ÁßçËØ¥Ê≥ïÔºöËøõÂÖ•‰∏ä‰∏ÄÊ¨°Á¶ªÂºÄÊó∂ÊâÄÂ§ÑÈÄªËæëÊµÅÁöÑ‰ΩçÁΩÆ„ÄÇ Á∫øÁ®ãÂíåËøõÁ®ãÁöÑÊìç‰ΩúÊòØÁî±Á®ãÂ∫èËß¶ÂèëÁ≥ªÁªüÊé•Âè£ÔºåÊúÄÂêéÁöÑÊâßË°åËÄÖÊòØÁ≥ªÁªüÔºõÂçèÁ®ãÁöÑÊìç‰ΩúÊâßË°åËÄÖÂàôÊòØÁî®Êà∑Ëá™Ë∫´Á®ãÂ∫èÔºågoroutine‰πüÊòØÂçèÁ®ã„ÄÇ groutineËÉΩÊã•ÊúâÂº∫Â§ßÁöÑÂπ∂ÂèëÂÆûÁé∞ÊòØÈÄöËøáGPMË∞ÉÂ∫¶Ê®°ÂûãÂÆûÁé∞. GoÁöÑË∞ÉÂ∫¶Âô®ÂÜÖÈÉ®ÊúâÂõõ‰∏™ÈáçË¶ÅÁöÑÁªìÊûÑÔºöMÔºåPÔºåSÔºåSchedÔºåÂ¶Ç‰∏äÂõæÊâÄÁ§∫ÔºàSchedÊú™ÁªôÂá∫Ôºâ. M:M‰ª£Ë°®ÂÜÖÊ†∏Á∫ßÁ∫øÁ®ãÔºå‰∏Ä‰∏™MÂ∞±ÊòØ‰∏Ä‰∏™Á∫øÁ®ãÔºågoroutineÂ∞±ÊòØË∑ëÂú®M‰πã‰∏äÁöÑÔºõMÊòØ‰∏Ä‰∏™ÂæàÂ§ßÁöÑÁªìÊûÑÔºåÈáåÈù¢Áª¥Êä§Â∞èÂØπË±°ÂÜÖÂ≠òcacheÔºàmcacheÔºâ„ÄÅÂΩìÂâçÊâßË°åÁöÑgoroutine„ÄÅÈöèÊú∫Êï∞ÂèëÁîüÂô®Á≠âÁ≠âÈùûÂ∏∏Â§öÁöÑ‰ø°ÊÅØ G:‰ª£Ë°®‰∏Ä‰∏™goroutineÔºåÂÆÉÊúâËá™Â∑±ÁöÑÊ†àÔºåinstruction pointerÂíåÂÖ∂‰ªñ‰ø°ÊÅØÔºàÊ≠£Âú®Á≠âÂæÖÁöÑchannelÁ≠âÁ≠âÔºâÔºåÁî®‰∫éË∞ÉÂ∫¶„ÄÇ P:PÂÖ®Áß∞ÊòØProcessorÔºåÂ§ÑÁêÜÂô®ÔºåÂÆÉÁöÑ‰∏ªË¶ÅÁî®ÈÄîÂ∞±ÊòØÁî®Êù•ÊâßË°ågoroutineÁöÑÔºåÊâÄ‰ª•ÂÆÉ‰πüÁª¥Êä§‰∫Ü‰∏Ä‰∏™goroutineÈòüÂàóÔºåÈáåÈù¢Â≠òÂÇ®‰∫ÜÊâÄÊúâÈúÄË¶ÅÂÆÉÊù•ÊâßË°åÁöÑgoroutine SchedÔºö‰ª£Ë°®Ë∞ÉÂ∫¶Âô®ÔºåÂÆÉÁª¥Êä§ÊúâÂ≠òÂÇ®MÂíåGÁöÑÈòüÂàó‰ª•ÂèäË∞ÉÂ∫¶Âô®ÁöÑ‰∏Ä‰∫õÁä∂ÊÄÅ‰ø°ÊÅØÁ≠â„ÄÇ Ë∞ÉÂ∫¶ÂÆûÁé∞: ‰ªé‰∏äÂõæ‰∏≠ÂèØ‰ª•ÁúãÂà∞ÔºåÊúâ2‰∏™Áâ©ÁêÜÁ∫øÁ®ãMÔºåÊØè‰∏Ä‰∏™MÈÉΩÊã•Êúâ‰∏Ä‰∏™Â§ÑÁêÜÂô®PÔºåÊØè‰∏Ä‰∏™‰πüÈÉΩÊúâ‰∏Ä‰∏™Ê≠£Âú®ËøêË°åÁöÑgoroutine„ÄÇPÁöÑÊï∞ÈáèÂèØ‰ª•ÈÄöËøáGOMAXPROCS()Êù•ËÆæÁΩÆÔºåÂÆÉÂÖ∂ÂÆû‰πüÂ∞±‰ª£Ë°®‰∫ÜÁúüÊ≠£ÁöÑÂπ∂ÂèëÂ∫¶ÔºåÂç≥ÊúâÂ§öÂ∞ë‰∏™goroutineÂèØ‰ª•ÂêåÊó∂ËøêË°å„ÄÇ Âõæ‰∏≠ÁÅ∞Ëâ≤ÁöÑÈÇ£‰∫õgoroutineÂπ∂Ê≤°ÊúâËøêË°åÔºåËÄåÊòØÂá∫‰∫éreadyÁöÑÂ∞±Áª™ÊÄÅÔºåÊ≠£Âú®Á≠âÂæÖË¢´Ë∞ÉÂ∫¶„ÄÇPÁª¥Êä§ÁùÄËøô‰∏™ÈòüÂàóÔºàÁß∞‰πã‰∏∫runqueueÔºâÔºåGoËØ≠Ë®ÄÈáåÔºåÂêØÂä®‰∏Ä‰∏™goroutineÂæàÂÆπÊòìÔºögo function Â∞±Ë°åÔºåÊâÄ‰ª•ÊØèÊúâ‰∏Ä‰∏™goËØ≠Âè•Ë¢´ÊâßË°åÔºårunqueueÈòüÂàóÂ∞±Âú®ÂÖ∂Êú´Â∞æÂä†ÂÖ•‰∏Ä‰∏™goroutineÔºåÂú®‰∏ã‰∏Ä‰∏™Ë∞ÉÂ∫¶ÁÇπÔºåÂ∞±‰ªérunqueue‰∏≠ÂèñÂá∫ÔºàÂ¶Ç‰ΩïÂÜ≥ÂÆöÂèñÂì™‰∏™goroutineÔºüÔºâ‰∏Ä‰∏™goroutineÊâßË°å„ÄÇ ÂΩì‰∏Ä‰∏™OSÁ∫øÁ®ãM0Èô∑ÂÖ•ÈòªÂ°ûÊó∂ÔºåPËΩ¨ËÄåÂú®ËøêË°åM1ÔºåÂõæ‰∏≠ÁöÑM1ÂèØËÉΩÊòØÊ≠£Ë¢´ÂàõÂª∫ÔºåÊàñËÄÖ‰ªéÁ∫øÁ®ãÁºìÂ≠ò‰∏≠ÂèñÂá∫„ÄÇ ÂΩìMOËøîÂõûÊó∂ÔºåÂÆÉÂøÖÈ°ªÂ∞ùËØïÂèñÂæó‰∏Ä‰∏™PÊù•ËøêË°ågoroutineÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÂÆÉ‰ºö‰ªéÂÖ∂‰ªñÁöÑOSÁ∫øÁ®ãÈÇ£ÈáåÊãø‰∏Ä‰∏™PËøáÊù•Ôºå Â¶ÇÊûúÊ≤°ÊúâÊãøÂà∞ÁöÑËØùÔºåÂÆÉÂ∞±ÊäägoroutineÊîæÂú®‰∏Ä‰∏™global runqueueÈáåÔºåÁÑ∂ÂêéËá™Â∑±Áù°Áú†ÔºàÊîæÂÖ•Á∫øÁ®ãÁºìÂ≠òÈáåÔºâ„ÄÇÊâÄÊúâÁöÑP‰πü‰ºöÂë®ÊúüÊÄßÁöÑÊ£ÄÊü•global runqueueÂπ∂ËøêË°åÂÖ∂‰∏≠ÁöÑgoroutineÔºåÂê¶Âàôglobal runqueue‰∏äÁöÑgoroutineÊ∞∏ËøúÊó†Ê≥ïÊâßË°å„ÄÇ Âè¶‰∏ÄÁßçÊÉÖÂÜµÊòØPÊâÄÂàÜÈÖçÁöÑ‰ªªÂä°GÂæàÂø´Â∞±ÊâßË°åÂÆå‰∫ÜÔºàÂàÜÈÖç‰∏çÂùáÔºâÔºåËøôÂ∞±ÂØºËá¥‰∫ÜËøô‰∏™Â§ÑÁêÜÂô®PÂæàÂøôÔºå‰ΩÜÊòØÂÖ∂‰ªñÁöÑPËøòÊúâ‰ªªÂä°ÔºåÊ≠§Êó∂Â¶ÇÊûúglobal runqueueÊ≤°Êúâ‰ªªÂä°G‰∫ÜÔºåÈÇ£‰πàP‰∏çÂæó‰∏ç‰ªéÂÖ∂‰ªñÁöÑPÈáåÊãø‰∏Ä‰∫õGÊù•ÊâßË°å„ÄÇ ÈÄöÂ∏∏Êù•ËØ¥ÔºåÂ¶ÇÊûúP‰ªéÂÖ∂‰ªñÁöÑPÈÇ£ÈáåË¶ÅÊãø‰ªªÂä°ÁöÑËØùÔºå‰∏ÄËà¨Â∞±Êãørun queueÁöÑ‰∏ÄÂçäÔºåËøôÂ∞±Á°Æ‰øù‰∫ÜÊØè‰∏™OSÁ∫øÁ®ãÈÉΩËÉΩÂÖÖÂàÜÁöÑ‰ΩøÁî®„ÄÇ 14. Âπ∂ÂèëÁºñÁ®ãÊ¶ÇÂøµÊòØ‰ªÄ‰πàÔºüÂπ∂Ë°åÊòØÊåá‰∏§‰∏™ÊàñËÄÖÂ§ö‰∏™‰∫ã‰ª∂Âú®Âêå‰∏ÄÊó∂ÂàªÂèëÁîüÔºõÂπ∂ÂèëÊòØÊåá‰∏§‰∏™ÊàñÂ§ö‰∏™‰∫ã‰ª∂Âú®Âêå‰∏ÄÊó∂Èó¥Èó¥ÈöîÂèëÁîü„ÄÇ Âπ∂Ë°åÊòØÂú®‰∏çÂêåÂÆû‰Ωì‰∏äÁöÑÂ§ö‰∏™‰∫ã‰ª∂ÔºåÂπ∂ÂèëÊòØÂú®Âêå‰∏ÄÂÆû‰Ωì‰∏äÁöÑÂ§ö‰∏™‰∫ã‰ª∂„ÄÇÂú®‰∏ÄÂè∞Â§ÑÁêÜÂô®‰∏ä‚ÄúÂêåÊó∂‚ÄùÂ§ÑÁêÜÂ§ö‰∏™‰ªªÂä°ÔºåÂú®Â§öÂè∞Â§ÑÁêÜÂô®‰∏äÂêåÊó∂Â§ÑÁêÜÂ§ö‰∏™‰ªªÂä°„ÄÇÂ¶ÇhadoopÂàÜÂ∏ÉÂºèÈõÜÁæ§ Âπ∂ÂèëÂÅèÈáç‰∫éÂ§ö‰∏™‰ªªÂä°‰∫§ÊõøÊâßË°åÔºåËÄåÂ§ö‰∏™‰ªªÂä°‰πãÈó¥ÊúâÂèØËÉΩËøòÊòØ‰∏≤Ë°åÁöÑ„ÄÇËÄåÂπ∂Ë°åÊòØÁúüÊ≠£ÊÑè‰πâ‰∏äÁöÑ‚ÄúÂêåÊó∂ÊâßË°å‚Äù„ÄÇ Âπ∂ÂèëÁºñÁ®ãÊòØÊåáÂú®‰∏ÄÂè∞Â§ÑÁêÜÂô®‰∏ä‚ÄúÂêåÊó∂‚ÄùÂ§ÑÁêÜÂ§ö‰∏™‰ªªÂä°„ÄÇÂπ∂ÂèëÊòØÂú®Âêå‰∏ÄÂÆû‰Ωì‰∏äÁöÑÂ§ö‰∏™‰∫ã‰ª∂„ÄÇÂ§ö‰∏™‰∫ã‰ª∂Âú®Âêå‰∏ÄÊó∂Èó¥Èó¥ÈöîÂèëÁîü„ÄÇÂπ∂ÂèëÁºñÁ®ãÁöÑÁõÆÊ†áÊòØÂÖÖÂàÜÁöÑÂà©Áî®Â§ÑÁêÜÂô®ÁöÑÊØè‰∏Ä‰∏™Ê†∏Ôºå‰ª•ËææÂà∞ÊúÄÈ´òÁöÑÂ§ÑÁêÜÊÄßËÉΩ„ÄÇ 15. Ë¥üËΩΩÂùáË°°ÂéüÁêÜÊòØ‰ªÄ‰πà?Ë¥üËΩΩÂùáË°°Load BalanceÔºâÊòØÈ´òÂèØÁî®ÁΩëÁªúÂü∫Á°ÄÊû∂ÊûÑÁöÑÂÖ≥ÈîÆÁªÑ‰ª∂ÔºåÈÄöÂ∏∏Áî®‰∫éÂ∞ÜÂ∑•‰ΩúË¥üËΩΩÂàÜÂ∏ÉÂà∞Â§ö‰∏™ÊúçÂä°Âô®Êù•ÊèêÈ´òÁΩëÁ´ô„ÄÅÂ∫îÁî®„ÄÅÊï∞ÊçÆÂ∫ìÊàñÂÖ∂‰ªñÊúçÂä°ÁöÑÊÄßËÉΩÂíåÂèØÈù†ÊÄß„ÄÇË¥üËΩΩÂùáË°°ÔºåÂÖ∂Ê†∏ÂøÉÂ∞±ÊòØÁΩëÁªúÊµÅÈáèÂàÜÂèëÔºåÂàÜÂæàÂ§öÁª¥Â∫¶„ÄÇ Ë¥üËΩΩÂùáË°°ÔºàLoad BalanceÔºâÈÄöÂ∏∏ÊòØÂàÜÊëäÂà∞Â§ö‰∏™Êìç‰ΩúÂçïÂÖÉ‰∏äËøõË°åÊâßË°åÔºå‰æãÂ¶ÇWebÊúçÂä°Âô®„ÄÅFTPÊúçÂä°Âô®„ÄÅ‰ºÅ‰∏öÂÖ≥ÈîÆÂ∫îÁî®ÊúçÂä°Âô®ÂíåÂÖ∂ÂÆÉÂÖ≥ÈîÆ‰ªªÂä°ÊúçÂä°Âô®Á≠âÔºå‰ªéËÄåÂÖ±ÂêåÂÆåÊàêÂ∑•‰Ωú‰ªªÂä°„ÄÇ Ë¥üËΩΩÂùáË°°ÊòØÂª∫Á´ãÂú®Áé∞ÊúâÁΩëÁªúÁªìÊûÑ‰πã‰∏äÔºåÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁßçÂªâ‰ª∑ÊúâÊïàÈÄèÊòéÁöÑÊñπÊ≥ïÊâ©Â±ïÁΩëÁªúËÆæÂ§áÂíåÊúçÂä°Âô®ÁöÑÂ∏¶ÂÆΩ„ÄÅÂ¢ûÂä†ÂêûÂêêÈáè„ÄÅÂä†Âº∫ÁΩëÁªúÊï∞ÊçÆÂ§ÑÁêÜËÉΩÂäõ„ÄÅÊèêÈ´òÁΩëÁªúÁöÑÁÅµÊ¥ªÊÄßÂíåÂèØÁî®ÊÄß„ÄÇ ÈÄöËøá‰∏Ä‰∏™‰æãÂ≠êËØ¶ÁªÜ‰ªãÁªç: Ê≤°ÊúâË¥üËΩΩÂùáË°° web Êû∂ÊûÑ Âú®ËøôÈáåÁî®Êà∑ÊòØÁõ¥ËøûÂà∞ web ÊúçÂä°Âô®ÔºåÂ¶ÇÊûúËøô‰∏™ÊúçÂä°Âô®ÂÆïÊú∫‰∫ÜÔºåÈÇ£‰πàÁî®Êà∑Ëá™ÁÑ∂‰πüÂ∞±Ê≤°ÂäûÊ≥ïËÆøÈóÆ‰∫Ü„ÄÇ Âè¶Â§ñÔºåÂ¶ÇÊûúÂêåÊó∂ÊúâÂæàÂ§öÁî®Êà∑ËØïÂõæËÆøÈóÆÊúçÂä°Âô®ÔºåË∂ÖËøá‰∫ÜÂÖ∂ËÉΩÂ§ÑÁêÜÁöÑÊûÅÈôêÔºåÂ∞±‰ºöÂá∫Áé∞Âä†ËΩΩÈÄüÂ∫¶ÁºìÊÖ¢ÊàñÊ†πÊú¨Êó†Ê≥ïËøûÊé•ÁöÑÊÉÖÂÜµ„ÄÇ ËÄåÈÄöËøáÂú®ÂêéÁ´ØÂºïÂÖ•‰∏Ä‰∏™Ë¥üËΩΩÂùáË°°Âô®ÂíåËá≥Â∞ë‰∏Ä‰∏™È¢ùÂ§ñÁöÑ web ÊúçÂä°Âô®ÔºåÂèØ‰ª•ÁºìËß£Ëøô‰∏™ÊïÖÈöú„ÄÇ ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÊâÄÊúâÁöÑÂêéÁ´ØÊúçÂä°Âô®‰ºö‰øùËØÅÊèê‰æõÁõ∏ÂêåÁöÑÂÜÖÂÆπÔºå‰ª•‰æøÁî®Êà∑Êó†ËÆ∫Âì™‰∏™ÊúçÂä°Âô®ÂìçÂ∫îÔºåÈÉΩËÉΩÊî∂Âà∞‰∏ÄËá¥ÁöÑÂÜÖÂÆπ„ÄÇ ÊúâË¥üËΩΩÂùáË°° web Êû∂ÊûÑ Áî®Êà∑ËÆøÈóÆË¥üËΩΩÂùáË°°Âô®ÔºåÂÜçÁî±Ë¥üËΩΩÂùáË°°Âô®Â∞ÜËØ∑Ê±ÇËΩ¨ÂèëÁªôÂêéÁ´ØÊúçÂä°Âô®„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂçïÁÇπÊïÖÈöúÁé∞Âú®ËΩ¨ÁßªÂà∞Ë¥üËΩΩÂùáË°°Âô®‰∏ä‰∫Ü„ÄÇ ËøôÈáåÂèàÂèØ‰ª•ÈÄöËøáÂºïÂÖ•Á¨¨‰∫å‰∏™Ë¥üËΩΩÂùáË°°Âô®Êù•ÁºìËß£„ÄÇ ÈÇ£‰πàË¥üËΩΩÂùáË°°Âô®ÁöÑÂ∑•‰ΩúÊñπÂºèÊòØ‰ªÄ‰πàÊ†∑ÁöÑÂë¢,Ë¥üËΩΩÂùáË°°Âô®ÂèàÂèØ‰ª•Â§ÑÁêÜ‰ªÄ‰πàÊ†∑ÁöÑËØ∑Ê±ÇÔºü Ë¥üËΩΩÂùáË°°Âô®ÁöÑÁÆ°ÁêÜÂëòËÉΩ‰∏ªË¶Å‰∏∫‰∏ãÈù¢ÂõõÁßç‰∏ªË¶ÅÁ±ªÂûãÁöÑËØ∑Ê±ÇËÆæÁΩÆËΩ¨ÂèëËßÑÂàôÔºö HTTP (‰∏ÉÂ±Ç) HTTPS (‰∏ÉÂ±Ç) TCP (ÂõõÂ±Ç) UDP (ÂõõÂ±Ç) Ë¥üËΩΩÂùáË°°Âô®Â¶Ç‰ΩïÈÄâÊã©Ë¶ÅËΩ¨ÂèëÁöÑÂêéÁ´ØÊúçÂä°Âô®Ôºü Ë¥üËΩΩÂùáË°°Âô®‰∏ÄËà¨Ê†πÊçÆ‰∏§‰∏™Âõ†Á¥†Êù•ÂÜ≥ÂÆöË¶ÅÂ∞ÜËØ∑Ê±ÇËΩ¨ÂèëÂà∞Âì™‰∏™ÊúçÂä°Âô®„ÄÇÈ¶ñÂÖàÔºåÁ°Æ‰øùÊâÄÈÄâÊã©ÁöÑÊúçÂä°Âô®ËÉΩÂ§üÂØπËØ∑Ê±ÇÂÅöÂá∫ÂìçÂ∫îÔºåÁÑ∂ÂêéÊ†πÊçÆÈ¢ÑÂÖàÈÖçÁΩÆÁöÑËßÑÂàô‰ªéÂÅ•Â∫∑ÊúçÂä°Âô®Ê±†Ôºàhealthy poolÔºâ‰∏≠ËøõË°åÈÄâÊã©„ÄÇ Âõ†‰∏∫ÔºåË¥üËΩΩÂùáË°°Âô®Â∫îÂΩìÂè™ÈÄâÊã©ËÉΩÊ≠£Â∏∏ÂÅöÂá∫ÂìçÂ∫îÁöÑÂêéÁ´ØÊúçÂä°Âô®ÔºåÂõ†Ê≠§Â∞±ÈúÄË¶ÅÊúâ‰∏ÄÁßçÂà§Êñ≠ÂêéÁ´ØÊúçÂä°Âô®ÊòØÂê¶ÂÅ•Â∫∑ÁöÑÊñπÊ≥ï„ÄÇ‰∏∫‰∫ÜÁõëËßÜÂêéÂè∞ÊúçÂä°Âô®ÁöÑËøêË°åÁä∂ÂÜµÔºåËøêË°åÁä∂ÊÄÅÊ£ÄÊü•ÊúçÂä°‰ºöÂÆöÊúüÂ∞ùËØï‰ΩøÁî®ËΩ¨ÂèëËßÑÂàôÂÆö‰πâÁöÑÂçèËÆÆÂíåÁ´ØÂè£ÂéªËøûÊé•ÂêéÁ´ØÊúçÂä°Âô®„ÄÇ Â¶ÇÊûúÔºåÊúçÂä°Âô®Êó†Ê≥ïÈÄöËøáÂÅ•Â∫∑Ê£ÄÊü•ÔºåÂ∞±‰ºö‰ªéÊ±†‰∏≠ÂâîÈô§Ôºå‰øùËØÅÊµÅÈáè‰∏ç‰ºöË¢´ËΩ¨ÂèëÂà∞ËØ•ÊúçÂä°Âô®ÔºåÁõ¥Âà∞ÂÖ∂ÂÜçÊ¨°ÈÄöËøáÂÅ•Â∫∑Ê£ÄÊü•‰∏∫Ê≠¢„ÄÇ Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ï Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ïÂÜ≥ÂÆö‰∫ÜÂêéÁ´ØÁöÑÂì™‰∫õÂÅ•Â∫∑ÊúçÂä°Âô®‰ºöË¢´ÈÄâ‰∏≠„ÄÇ ÂÖ∂‰∏≠Â∏∏Áî®ÁöÑÁÆóÊ≥ïÂåÖÊã¨Ôºö Round RobinÔºàËΩÆËØ¢ÔºâÔºö‰∏∫Á¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÈÄâÊã©ÂàóË°®‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÊúçÂä°Âô®ÔºåÁÑ∂ÂêéÊåâÈ°∫Â∫èÂêë‰∏ãÁßªÂä®ÂàóË°®Áõ¥Âà∞ÁªìÂ∞æÔºåÁÑ∂ÂêéÂæ™ÁéØ„ÄÇ Least ConnectionsÔºàÊúÄÂ∞èËøûÊé•ÔºâÔºö‰ºòÂÖàÈÄâÊã©ËøûÊé•Êï∞ÊúÄÂ∞ëÁöÑÊúçÂä°Âô®ÔºåÂú®ÊôÆÈÅç‰ºöËØùËæÉÈïøÁöÑÊÉÖÂÜµ‰∏ãÊé®Ëçê‰ΩøÁî®„ÄÇ SourceÔºöÊ†πÊçÆËØ∑Ê±ÇÊ∫êÁöÑ IP ÁöÑÊï£ÂàóÔºàhashÔºâÊù•ÈÄâÊã©Ë¶ÅËΩ¨ÂèëÁöÑÊúçÂä°Âô®„ÄÇËøôÁßçÊñπÂºèÂèØ‰ª•‰∏ÄÂÆöÁ®ãÂ∫¶‰∏ä‰øùËØÅÁâπÂÆöÁî®Êà∑ËÉΩËøûÊé•Âà∞Áõ∏ÂêåÁöÑÊúçÂä°Âô®„ÄÇ Â¶ÇÊûú‰Ω†ÁöÑÂ∫îÁî®ÈúÄË¶ÅÂ§ÑÁêÜÁä∂ÊÄÅËÄåË¶ÅÊ±ÇÁî®Êà∑ËÉΩËøûÊé•Âà∞Âíå‰πãÂâçÁõ∏ÂêåÁöÑÊúçÂä°Âô®„ÄÇÂèØ‰ª•ÈÄöËøá Source ÁÆóÊ≥ïÂü∫‰∫éÂÆ¢Êà∑Á´ØÁöÑ IP ‰ø°ÊÅØÂàõÂª∫ÂÖ≥ËÅîÔºåÊàñËÄÖ‰ΩøÁî®Á≤òÊÄß‰ºöËØùÔºàsticky sessionsÔºâ„ÄÇ Èô§Ê≠§‰πãÂ§ñÔºåÊÉ≥Ë¶ÅËß£ÂÜ≥Ë¥üËΩΩÂùáË°°Âô®ÁöÑÂçïÁÇπÊïÖÈöúÈóÆÈ¢òÔºåÂèØ‰ª•Â∞ÜÁ¨¨‰∫å‰∏™Ë¥üËΩΩÂùáË°°Âô®ËøûÊé•Âà∞Á¨¨‰∏Ä‰∏™‰∏äÔºå‰ªéËÄåÂΩ¢Êàê‰∏Ä‰∏™ÈõÜÁæ§„ÄÇ 16. LVSÁõ∏ÂÖ≥‰∫ÜËß£.LVSÊòØ Linux Virtual Server ÁöÑÁÆÄÁß∞Ôºå‰πüÂ∞±ÊòØLinuxËôöÊãüÊúçÂä°Âô®„ÄÇËøôÊòØ‰∏Ä‰∏™Áî±Á´†ÊñáÂµ©ÂçöÂ£´ÂèëËµ∑ÁöÑ‰∏Ä‰∏™ÂºÄÊ∫êÈ°πÁõÆÔºåÂÆÉÁöÑÂÆòÊñπÁΩëÁ´ôÊòØLinuxVirtualServerÁé∞Âú® LVS Â∑≤ÁªèÊòØ Linux ÂÜÖÊ†∏Ê†áÂáÜÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ‰ΩøÁî® LVS ÂèØ‰ª•ËææÂà∞ÁöÑÊäÄÊúØÁõÆÊ†áÊòØÔºöÈÄöËøá LVS ËææÂà∞ÁöÑË¥üËΩΩÂùáË°°ÊäÄÊúØÂíå Linux Êìç‰ΩúÁ≥ªÁªüÂÆûÁé∞‰∏Ä‰∏™È´òÊÄßËÉΩÈ´òÂèØÁî®ÁöÑ Linux ÊúçÂä°Âô®ÈõÜÁæ§ÔºåÂÆÉÂÖ∑ÊúâËâØÂ•ΩÁöÑÂèØÈù†ÊÄß„ÄÅÂèØÊâ©Â±ïÊÄßÂíåÂèØÊìç‰ΩúÊÄß„ÄÇ ‰ªéËÄå‰ª•‰ΩéÂªâÁöÑÊàêÊú¨ÂÆûÁé∞ÊúÄ‰ºòÁöÑÊÄßËÉΩ„ÄÇLVS ÊòØ‰∏Ä‰∏™ÂÆûÁé∞Ë¥üËΩΩÂùáË°°ÈõÜÁæ§ÁöÑÂºÄÊ∫êËΩØ‰ª∂È°πÁõÆÔºåLVSÊû∂ÊûÑ‰ªéÈÄªËæë‰∏äÂèØÂàÜ‰∏∫Ë∞ÉÂ∫¶Â±Ç„ÄÅServerÈõÜÁæ§Â±ÇÂíåÂÖ±‰∫´Â≠òÂÇ®„ÄÇ LVSÁöÑÂü∫Êú¨Â∑•‰ΩúÂéüÁêÜ: ÂΩìÁî®Êà∑ÂêëË¥üËΩΩÂùáË°°Ë∞ÉÂ∫¶Âô®ÔºàDirector ServerÔºâÂèëËµ∑ËØ∑Ê±ÇÔºåË∞ÉÂ∫¶Âô®Â∞ÜËØ∑Ê±ÇÂèëÂæÄËá≥ÂÜÖÊ†∏Á©∫Èó¥ PREROUTINGÈìæÈ¶ñÂÖà‰ºöÊé•Êî∂Âà∞Áî®Êà∑ËØ∑Ê±ÇÔºåÂà§Êñ≠ÁõÆÊ†áIPÁ°ÆÂÆöÊòØÊú¨Êú∫IPÔºåÂ∞ÜÊï∞ÊçÆÂåÖÂèëÂæÄINPUTÈìæ IPVSÊòØÂ∑•‰ΩúÂú®INPUTÈìæ‰∏äÁöÑÔºåÂΩìÁî®Êà∑ËØ∑Ê±ÇÂà∞ËææINPUTÊó∂ÔºåIPVS‰ºöÂ∞ÜÁî®Êà∑ËØ∑Ê±ÇÂíåËá™Â∑±Â∑≤ÂÆö‰πâÂ•ΩÁöÑÈõÜÁæ§ÊúçÂä°ËøõË°åÊØîÂØπÔºåÂ¶ÇÊûúÁî®Êà∑ËØ∑Ê±ÇÁöÑÂ∞±ÊòØÂÆö‰πâÁöÑÈõÜÁæ§ÊúçÂä°ÔºåÈÇ£‰πàÊ≠§Êó∂IPVS‰ºöÂº∫Ë°å‰øÆÊîπÊï∞ÊçÆÂåÖÈáåÁöÑÁõÆÊ†áIPÂú∞ÂùÄÂèäÁ´ØÂè£ÔºåÂπ∂Â∞ÜÊñ∞ÁöÑÊï∞ÊçÆÂåÖÂèëÂæÄPOSTROUTINGÈìæ POSTROUTINGÈìæÊé•Êî∂Êï∞ÊçÆÂåÖÂêéÂèëÁé∞ÁõÆÊ†áIPÂú∞ÂùÄÂàöÂ•ΩÊòØËá™Â∑±ÁöÑÂêéÁ´ØÊúçÂä°Âô®ÔºåÈÇ£‰πàÊ≠§Êó∂ÈÄöËøáÈÄâË∑ØÔºåÂ∞ÜÊï∞ÊçÆÂåÖÊúÄÁªàÂèëÈÄÅÁªôÂêéÁ´ØÁöÑÊúçÂä°Âô® LVSÁöÑÁªÑÊàê: LVS Áî±2ÈÉ®ÂàÜÁ®ãÂ∫èÁªÑÊàêÔºåÂåÖÊã¨ ipvs Âíå ipvsadm„ÄÇ ipvs(ip virtual server)Ôºö‰∏ÄÊÆµ‰ª£Á†ÅÂ∑•‰ΩúÂú®ÂÜÖÊ†∏Á©∫Èó¥ÔºåÂè´ipvsÔºåÊòØÁúüÊ≠£ÁîüÊïàÂÆûÁé∞Ë∞ÉÂ∫¶ÁöÑ‰ª£Á†Å„ÄÇ ipvsadmÔºöÂè¶Â§ñ‰∏ÄÊÆµÊòØÂ∑•‰ΩúÂú®Áî®Êà∑Á©∫Èó¥ÔºåÂè´ipvsadmÔºåË¥üË¥£‰∏∫ipvsÂÜÖÊ†∏Ê°ÜÊû∂ÁºñÂÜôËßÑÂàôÔºåÂÆö‰πâË∞ÅÊòØÈõÜÁæ§ÊúçÂä°ÔºåËÄåË∞ÅÊòØÂêéÁ´ØÁúüÂÆûÁöÑÊúçÂä°Âô®(Real Server) ËØ¶ÁªÜÁöÑLVSÁöÑ‰ªãÁªçÂèØ‰ª•ÂèÇËÄÉLVSËØ¶Ëß£. 17. ÂæÆÊúçÂä°Êû∂ÊûÑÊòØ‰ªÄ‰πàÊ†∑Â≠êÁöÑ?ÈÄöÂ∏∏‰º†ÁªüÁöÑÈ°πÁõÆ‰ΩìÁßØÂ∫ûÂ§ßÔºåÈúÄÊ±Ç„ÄÅËÆæËÆ°„ÄÅÂºÄÂèë„ÄÅÊµãËØï„ÄÅÈÉ®ÁΩ≤ÊµÅÁ®ãÂõ∫ÂÆö„ÄÇÊñ∞ÂäüËÉΩÈúÄË¶ÅÂú®ÂéüÈ°πÁõÆ‰∏äÂÅö‰øÆÊîπ„ÄÇ ‰ΩÜÊòØÂæÆÊúçÂä°ÂèØ‰ª•ÁúãÂÅöÊòØÂØπÂ§ßÈ°πÁõÆÁöÑÊãÜÂàÜÔºåÊòØÂú®Âø´ÈÄüËø≠‰ª£Êõ¥Êñ∞‰∏äÁ∫øÁöÑÈúÄÊ±Ç‰∏ã‰∫ßÁîüÁöÑ„ÄÇÊñ∞ÁöÑÂäüËÉΩÊ®°Âùó‰ºöÂèëÂ∏ÉÊàêÊñ∞ÁöÑÊúçÂä°ÁªÑ‰ª∂Ôºå‰∏éÂÖ∂‰ªñÂ∑≤ÂèëÂ∏ÉÁöÑÊúçÂä°ÁªÑ‰ª∂‰∏ÄÂêåÂçè‰Ωú„ÄÇ ÊúçÂä°ÂÜÖÈÉ®ÊúâÂ§ö‰∏™Áîü‰∫ßËÄÖÂíåÊ∂àË¥πËÄÖÔºåÈÄöÂ∏∏‰ª•http restÁöÑÊñπÂºèË∞ÉÁî®ÔºåÊúçÂä°ÊÄª‰Ωì‰ª•‰∏Ä‰∏™ÔºàÊàñÂá†‰∏™ÔºâÊúçÂä°ÁöÑÂΩ¢ÂºèÂëàÁé∞ÁªôÂÆ¢Êà∑‰ΩøÁî®„ÄÇ ÂæÆÊúçÂä°Êû∂ÊûÑÊòØ‰∏ÄÁßçÊÄùÊÉ≥ÂØπÂæÆÊúçÂä°Êû∂ÊûÑÊàë‰ª¨Ê≤°Êúâ‰∏Ä‰∏™ÊòéÁ°ÆÁöÑÂÆö‰πâÔºå‰ΩÜÁÆÄÂçïÊù•ËØ¥ÂæÆÊúçÂä°Êû∂ÊûÑÊòØÔºö ÈááÁî®‰∏ÄÁªÑÊúçÂä°ÁöÑÊñπÂºèÊù•ÊûÑÂª∫‰∏Ä‰∏™Â∫îÁî®ÔºåÊúçÂä°Áã¨Á´ãÈÉ®ÁΩ≤Âú®‰∏çÂêåÁöÑËøõÁ®ã‰∏≠Ôºå‰∏çÂêåÊúçÂä°ÈÄöËøá‰∏Ä‰∫õËΩªÈáèÁ∫ß‰∫§‰∫íÊú∫Âà∂Êù•ÈÄö‰ø°Ôºå‰æãÂ¶Ç RPC„ÄÅHTTP Á≠âÔºåÊúçÂä°ÂèØÁã¨Á´ãÊâ©Â±ï‰º∏Áº©ÔºåÊØè‰∏™ÊúçÂä°ÂÆö‰πâ‰∫ÜÊòéÁ°ÆÁöÑËæπÁïåÔºå‰∏çÂêåÁöÑÊúçÂä°ÁîöËá≥ÂèØ‰ª•ÈááÁî®‰∏çÂêåÁöÑÁºñÁ®ãËØ≠Ë®ÄÊù•ÂÆûÁé∞ÔºåÁî±Áã¨Á´ãÁöÑÂõ¢ÈòüÊù•Áª¥Êä§„ÄÇ GolangÁöÑÂæÆÊúçÂä°Ê°ÜÊû∂kit‰∏≠ÊúâËØ¶ÁªÜÁöÑÂæÆÊúçÂä°ÁöÑ‰æãÂ≠ê,ÂèØ‰ª•ÂèÇËÄÉÂ≠¶‰π†. ÂæÆÊúçÂä°Êû∂ÊûÑËÆæËÆ°ÂåÖÊã¨Ôºö ÊúçÂä°ÁÜîÊñ≠ÈôçÁ∫ßÈôêÊµÅÊú∫Âà∂ ÁÜîÊñ≠ÈôçÁ∫ßÁöÑÊ¶ÇÂøµ(Rate Limiter ÈôêÊµÅÂô®,Circuit breaker Êñ≠Ë∑ØÂô®). Ê°ÜÊû∂Ë∞ÉÁî®ÊñπÂºèËß£ËÄ¶ÊñπÂºè Kit Êàñ Istio Êàñ Micro ÊúçÂä°ÂèëÁé∞(consul zookeeper kubeneters etcd ) RPCË∞ÉÁî®Ê°ÜÊû∂. ÈìæË∑ØÁõëÊéß,zipkinÂíåprometheus. Â§öÁ∫ßÁºìÂ≠ò. ÁΩëÂÖ≥ (kong gateway). DockerÈÉ®ÁΩ≤ÁÆ°ÁêÜ Kubenetters. Ëá™Âä®ÈõÜÊàêÈÉ®ÁΩ≤ CI/CD ÂÆûË∑µ. Ëá™Âä®Êâ©ÂÆπÊú∫Âà∂ËßÑÂàô. ÂéãÊµã ‰ºòÂåñ. Trasport Êï∞ÊçÆ‰º†Ëæì(Â∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ). Logging Êó•Âøó. Metrics ÊåáÈíàÂØπÊØè‰∏™ËØ∑Ê±Ç‰ø°ÊÅØÁöÑ‰ª™Ë°®ÁõòÂåñ. ÂæÆÊúçÂä°Êû∂ÊûÑ‰ªãÁªçËØ¶ÁªÜÁöÑÂèØ‰ª•ÂèÇËÄÉ: Microservice Architectures 18. ÂàÜÂ∏ÉÂºèÈîÅÂÆûÁé∞ÂéüÁêÜÔºåÁî®ËøáÂêóÔºüÂú®ÂàÜÊûêÂàÜÂ∏ÉÂºèÈîÅÁöÑ‰∏âÁßçÂÆûÁé∞ÊñπÂºè‰πãÂâçÔºåÂÖà‰∫ÜËß£‰∏Ä‰∏ãÂàÜÂ∏ÉÂºèÈîÅÂ∫îËØ•ÂÖ∑Â§áÂì™‰∫õÊù°‰ª∂Ôºö Âú®ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁéØÂ¢É‰∏ãÔºå‰∏Ä‰∏™ÊñπÊ≥ïÂú®Âêå‰∏ÄÊó∂Èó¥Âè™ËÉΩË¢´‰∏Ä‰∏™Êú∫Âô®ÁöÑ‰∏Ä‰∏™Á∫øÁ®ãÊâßË°åÔºõ È´òÂèØÁî®ÁöÑËé∑ÂèñÈîÅ‰∏éÈáäÊîæÈîÅÔºõ È´òÊÄßËÉΩÁöÑËé∑ÂèñÈîÅ‰∏éÈáäÊîæÈîÅÔºõ ÂÖ∑Â§áÂèØÈáçÂÖ•ÁâπÊÄßÔºõ ÂÖ∑Â§áÈîÅÂ§±ÊïàÊú∫Âà∂ÔºåÈò≤Ê≠¢Ê≠ªÈîÅÔºõ ÂÖ∑Â§áÈùûÈòªÂ°ûÈîÅÁâπÊÄßÔºåÂç≥Ê≤°ÊúâËé∑ÂèñÂà∞ÈîÅÂ∞ÜÁõ¥Êé•ËøîÂõûËé∑ÂèñÈîÅÂ§±Ë¥•„ÄÇ ÂàÜÂ∏ÉÂºèÁöÑCAPÁêÜËÆ∫ÂëäËØâÊàë‰ª¨‚Äú‰ªª‰Ωï‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÈÉΩÊó†Ê≥ïÂêåÊó∂Êª°Ë∂≥‰∏ÄËá¥ÊÄßÔºàConsistencyÔºâ„ÄÅÂèØÁî®ÊÄßÔºàAvailabilityÔºâÂíåÂàÜÂå∫ÂÆπÈîôÊÄßÔºàPartition toleranceÔºâÔºåÊúÄÂ§öÂè™ËÉΩÂêåÊó∂Êª°Ë∂≥‰∏§È°π„ÄÇ‚ÄùÊâÄ‰ª•ÔºåÂæàÂ§öÁ≥ªÁªüÂú®ËÆæËÆ°‰πãÂàùÂ∞±Ë¶ÅÂØπËøô‰∏âËÄÖÂÅöÂá∫ÂèñËàç„ÄÇÂú®‰∫íËÅîÁΩëÈ¢ÜÂüüÁöÑÁªùÂ§ßÂ§öÊï∞ÁöÑÂú∫ÊôØ‰∏≠ÔºåÈÉΩÈúÄË¶ÅÁâ∫Áâ≤Âº∫‰∏ÄËá¥ÊÄßÊù•Êç¢ÂèñÁ≥ªÁªüÁöÑÈ´òÂèØÁî®ÊÄßÔºåÁ≥ªÁªüÂæÄÂæÄÂè™ÈúÄË¶Å‰øùËØÅ‚ÄúÊúÄÁªà‰∏ÄËá¥ÊÄß‚ÄùÔºåÂè™Ë¶ÅËøô‰∏™ÊúÄÁªàÊó∂Èó¥ÊòØÂú®Áî®Êà∑ÂèØ‰ª•Êé•ÂèóÁöÑËåÉÂõ¥ÂÜÖÂç≥ÂèØ„ÄÇ ÈÄöÂ∏∏ÂàÜÂ∏ÉÂºèÈîÅ‰ª•ÂçïÁã¨ÁöÑÊúçÂä°ÊñπÂºèÂÆûÁé∞ÔºåÁõÆÂâçÊØîËæÉÂ∏∏Áî®ÁöÑÂàÜÂ∏ÉÂºèÈîÅÂÆûÁé∞Êúâ‰∏âÁßçÔºö Âü∫‰∫éÊï∞ÊçÆÂ∫ìÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ„ÄÇ Âü∫‰∫éÁºìÂ≠òÔºàredisÔºåmemcachedÔºåtairÔºâÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ„ÄÇ Âü∫‰∫éZookeeperÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ„ÄÇ Â∞ΩÁÆ°ÊúâËøô‰∏âÁßçÊñπÊ°àÔºå‰ΩÜÊòØ‰∏çÂêåÁöÑ‰∏öÂä°‰πüË¶ÅÊ†πÊçÆËá™Â∑±ÁöÑÊÉÖÂÜµËøõË°åÈÄâÂûãÔºå‰ªñ‰ª¨‰πãÈó¥Ê≤°ÊúâÊúÄÂ•ΩÂè™ÊúâÊõ¥ÈÄÇÂêàÔºÅ Âü∫‰∫éÊï∞ÊçÆÂ∫ìÁöÑÂÆûÁé∞ÊñπÂºè Âü∫‰∫éÊï∞ÊçÆÂ∫ìÁöÑÂÆûÁé∞ÊñπÂºèÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÊòØÔºöÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÂàõÂª∫‰∏Ä‰∏™Ë°®ÔºåË°®‰∏≠ÂåÖÂê´ÊñπÊ≥ïÂêçÁ≠âÂ≠óÊÆµÔºåÂπ∂Âú®ÊñπÊ≥ïÂêçÂ≠óÊÆµ‰∏äÂàõÂª∫ÂîØ‰∏ÄÁ¥¢ÂºïÔºåÊÉ≥Ë¶ÅÊâßË°åÊüê‰∏™ÊñπÊ≥ïÔºåÂ∞±‰ΩøÁî®Ëøô‰∏™ÊñπÊ≥ïÂêçÂêëË°®‰∏≠ÊèíÂÖ•Êï∞ÊçÆÔºåÊàêÂäüÊèíÂÖ•ÂàôËé∑ÂèñÈîÅÔºåÊâßË°åÂÆåÊàêÂêéÂà†Èô§ÂØπÂ∫îÁöÑË°åÊï∞ÊçÆÈáäÊîæÈîÅ„ÄÇ ÂàõÂª∫‰∏Ä‰∏™Ë°®Ôºö 123456789DROP TABLE IF EXISTS `method_lock`;CREATE TABLE `method_lock` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT COMMENT &apos;‰∏ªÈîÆ&apos;, `method_name` varchar(64) NOT NULL COMMENT &apos;ÈîÅÂÆöÁöÑÊñπÊ≥ïÂêç&apos;, `desc` varchar(255) NOT NULL COMMENT &apos;Â§áÊ≥®‰ø°ÊÅØ&apos;, `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, PRIMARY KEY (`id`), UNIQUE KEY `uidx_method_name` (`method_name`) USING BTREE) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8 COMMENT=&apos;ÈîÅÂÆö‰∏≠ÁöÑÊñπÊ≥ï&apos;; ÊÉ≥Ë¶ÅÊâßË°åÊüê‰∏™ÊñπÊ≥ïÔºåÂ∞±‰ΩøÁî®Ëøô‰∏™ÊñπÊ≥ïÂêçÂêëË°®‰∏≠ÊèíÂÖ•Êï∞ÊçÆÔºö 1INSERT INTO method_lock (method_name, desc) VALUES (&apos;methodName&apos;, &apos;ÊµãËØïÁöÑmethodName&apos;); Âõ†‰∏∫Êàë‰ª¨ÂØπmethod_nameÂÅö‰∫ÜÂîØ‰∏ÄÊÄßÁ∫¶ÊùüÔºåËøôÈáåÂ¶ÇÊûúÊúâÂ§ö‰∏™ËØ∑Ê±ÇÂêåÊó∂Êèê‰∫§Âà∞Êï∞ÊçÆÂ∫ìÁöÑËØùÔºåÊï∞ÊçÆÂ∫ì‰ºö‰øùËØÅÂè™Êúâ‰∏Ä‰∏™Êìç‰ΩúÂèØ‰ª•ÊàêÂäüÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ËÆ§‰∏∫Êìç‰ΩúÊàêÂäüÁöÑÈÇ£‰∏™Á∫øÁ®ãËé∑Âæó‰∫ÜËØ•ÊñπÊ≥ïÁöÑÈîÅÔºåÂèØ‰ª•ÊâßË°åÊñπÊ≥ï‰ΩìÂÜÖÂÆπ„ÄÇ ÊàêÂäüÊèíÂÖ•ÂàôËé∑ÂèñÈîÅÔºåÊâßË°åÂÆåÊàêÂêéÂà†Èô§ÂØπÂ∫îÁöÑË°åÊï∞ÊçÆÈáäÊîæÈîÅÔºö 1delete from method_lock where method_name =&apos;methodName&apos;; Ê≥®ÊÑèÔºöËøôÈáåÂè™ÊòØ‰ΩøÁî®Âü∫‰∫éÊï∞ÊçÆÂ∫ìÁöÑ‰∏ÄÁßçÊñπÊ≥ïÔºå‰ΩøÁî®Êï∞ÊçÆÂ∫ìÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅËøòÊúâÂæàÂ§öÂÖ∂‰ªñÁöÑÁî®Ê≥ïÂèØ‰ª•ÂÆûÁé∞ÔºÅ ‰ΩøÁî®Âü∫‰∫éÊï∞ÊçÆÂ∫ìÁöÑËøôÁßçÂÆûÁé∞ÊñπÂºèÂæàÁÆÄÂçïÔºå‰ΩÜÊòØÂØπ‰∫éÂàÜÂ∏ÉÂºèÈîÅÂ∫îËØ•ÂÖ∑Â§áÁöÑÊù°‰ª∂Êù•ËØ¥ÔºåÂÆÉÊúâ‰∏Ä‰∫õÈóÆÈ¢òÈúÄË¶ÅËß£ÂÜ≥Âèä‰ºòÂåñÔºö 1„ÄÅÂõ†‰∏∫ÊòØÂü∫‰∫éÊï∞ÊçÆÂ∫ìÂÆûÁé∞ÁöÑÔºåÊï∞ÊçÆÂ∫ìÁöÑÂèØÁî®ÊÄßÂíåÊÄßËÉΩÂ∞ÜÁõ¥Êé•ÂΩ±ÂìçÂàÜÂ∏ÉÂºèÈîÅÁöÑÂèØÁî®ÊÄßÂèäÊÄßËÉΩÔºåÊâÄ‰ª•ÔºåÊï∞ÊçÆÂ∫ìÈúÄË¶ÅÂèåÊú∫ÈÉ®ÁΩ≤„ÄÅÊï∞ÊçÆÂêåÊ≠•„ÄÅ‰∏ªÂ§áÂàáÊç¢Ôºõ 2„ÄÅ‰∏çÂÖ∑Â§áÂèØÈáçÂÖ•ÁöÑÁâπÊÄßÔºåÂõ†‰∏∫Âêå‰∏Ä‰∏™Á∫øÁ®ãÂú®ÈáäÊîæÈîÅ‰πãÂâçÔºåË°åÊï∞ÊçÆ‰∏ÄÁõ¥Â≠òÂú®ÔºåÊó†Ê≥ïÂÜçÊ¨°ÊàêÂäüÊèíÂÖ•Êï∞ÊçÆÔºåÊâÄ‰ª•ÔºåÈúÄË¶ÅÂú®Ë°®‰∏≠Êñ∞Â¢û‰∏ÄÂàóÔºåÁî®‰∫éËÆ∞ÂΩïÂΩìÂâçËé∑ÂèñÂà∞ÈîÅÁöÑÊú∫Âô®ÂíåÁ∫øÁ®ã‰ø°ÊÅØÔºåÂú®ÂÜçÊ¨°Ëé∑ÂèñÈîÅÁöÑÊó∂ÂÄôÔºåÂÖàÊü•ËØ¢Ë°®‰∏≠Êú∫Âô®ÂíåÁ∫øÁ®ã‰ø°ÊÅØÊòØÂê¶ÂíåÂΩìÂâçÊú∫Âô®ÂíåÁ∫øÁ®ãÁõ∏ÂêåÔºåËã•Áõ∏ÂêåÂàôÁõ¥Êé•Ëé∑ÂèñÈîÅÔºõ 3„ÄÅÊ≤°ÊúâÈîÅÂ§±ÊïàÊú∫Âà∂ÔºåÂõ†‰∏∫ÊúâÂèØËÉΩÂá∫Áé∞ÊàêÂäüÊèíÂÖ•Êï∞ÊçÆÂêéÔºåÊúçÂä°Âô®ÂÆïÊú∫‰∫ÜÔºåÂØπÂ∫îÁöÑÊï∞ÊçÆÊ≤°ÊúâË¢´Âà†Èô§ÔºåÂΩìÊúçÂä°ÊÅ¢Â§çÂêé‰∏ÄÁõ¥Ëé∑Âèñ‰∏çÂà∞ÈîÅÔºåÊâÄ‰ª•ÔºåÈúÄË¶ÅÂú®Ë°®‰∏≠Êñ∞Â¢û‰∏ÄÂàóÔºåÁî®‰∫éËÆ∞ÂΩïÂ§±ÊïàÊó∂Èó¥ÔºåÂπ∂‰∏îÈúÄË¶ÅÊúâÂÆöÊó∂‰ªªÂä°Ê∏ÖÈô§Ëøô‰∫õÂ§±ÊïàÁöÑÊï∞ÊçÆÔºõ 4„ÄÅ‰∏çÂÖ∑Â§áÈòªÂ°ûÈîÅÁâπÊÄßÔºåËé∑Âèñ‰∏çÂà∞ÈîÅÁõ¥Êé•ËøîÂõûÂ§±Ë¥•ÔºåÊâÄ‰ª•ÈúÄË¶Å‰ºòÂåñËé∑ÂèñÈÄªËæëÔºåÂæ™ÁéØÂ§öÊ¨°ÂéªËé∑Âèñ„ÄÇ 5„ÄÅÂú®ÂÆûÊñΩÁöÑËøáÁ®ã‰∏≠‰ºöÈÅáÂà∞ÂêÑÁßç‰∏çÂêåÁöÑÈóÆÈ¢òÔºå‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∫õÈóÆÈ¢òÔºåÂÆûÁé∞ÊñπÂºèÂ∞Ü‰ºöË∂äÊù•Ë∂äÂ§çÊùÇÔºõ‰æùËµñÊï∞ÊçÆÂ∫ìÈúÄË¶Å‰∏ÄÂÆöÁöÑËµÑÊ∫êÂºÄÈîÄÔºåÊÄßËÉΩÈóÆÈ¢òÈúÄË¶ÅËÄÉËôë„ÄÇ Âü∫‰∫éRedisÁöÑÂÆûÁé∞ÊñπÂºè ÈÄâÁî®RedisÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÂéüÂõ†Ôºö RedisÊúâÂæàÈ´òÁöÑÊÄßËÉΩÔºõ RedisÂëΩ‰ª§ÂØπÊ≠§ÊîØÊåÅËæÉÂ•ΩÔºåÂÆûÁé∞Ëµ∑Êù•ÊØîËæÉÊñπ‰æø ‰∏ªË¶ÅÂÆûÁé∞ÊñπÂºè: SET lock currentTime+expireTime EX 600 NXÔºå‰ΩøÁî®setËÆæÁΩÆlockÂÄºÔºåÂπ∂ËÆæÁΩÆËøáÊúüÊó∂Èó¥‰∏∫600ÁßíÔºåÂ¶ÇÊûúÊàêÂäüÔºåÂàôËé∑ÂèñÈîÅÔºõ Ëé∑ÂèñÈîÅÂêéÔºåÂ¶ÇÊûúËØ•ËäÇÁÇπÊéâÁ∫øÔºåÂàôÂà∞ËøáÊúüÊó∂Èó¥ockÂÄºËá™Âä®Â§±ÊïàÔºõ ÈáäÊîæÈîÅÊó∂Ôºå‰ΩøÁî®delÂà†Èô§lockÈîÆÂÄºÔºõ ‰ΩøÁî®redisÂçïÊú∫Êù•ÂÅöÂàÜÂ∏ÉÂºèÈîÅÊúçÂä°ÔºåÂèØËÉΩ‰ºöÂá∫Áé∞ÂçïÁÇπÈóÆÈ¢òÔºåÂØºËá¥ÊúçÂä°ÂèØÁî®ÊÄßÂ∑ÆÔºåÂõ†Ê≠§Âú®ÊúçÂä°Á®≥ÂÆöÊÄßË¶ÅÊ±ÇÈ´òÁöÑÂú∫ÂêàÔºåÂÆòÊñπÂª∫ËÆÆ‰ΩøÁî®redisÈõÜÁæ§Ôºà‰æãÂ¶Ç5Âè∞ÔºåÊàêÂäüËØ∑Ê±ÇÈîÅË∂ÖËøá3Âè∞Â∞±ËÆ§‰∏∫Ëé∑ÂèñÈîÅÔºâÔºåÊù•ÂÆûÁé∞redisÂàÜÂ∏ÉÂºèÈîÅ„ÄÇËØ¶ËßÅRedLock„ÄÇ ‰ºòÁÇπ:ÊÄßËÉΩÈ´òÔºåredisÂèØÊåÅ‰πÖÂåñÔºå‰πüËÉΩ‰øùËØÅÊï∞ÊçÆ‰∏çÊòì‰∏¢Â§±,redisÈõÜÁæ§ÊñπÂºèÊèêÈ´òÁ®≥ÂÆöÊÄß„ÄÇ Áº∫ÁÇπ:‰ΩøÁî®redis‰∏ª‰ªéÂàáÊç¢Êó∂ÂèØËÉΩ‰∏¢Â§±ÈÉ®ÂàÜÊï∞ÊçÆ„ÄÇ Âü∫‰∫éZooKeeperÁöÑÂÆûÁé∞ÊñπÂºè ZooKeeperÊòØ‰∏Ä‰∏™‰∏∫ÂàÜÂ∏ÉÂºèÂ∫îÁî®Êèê‰æõ‰∏ÄËá¥ÊÄßÊúçÂä°ÁöÑÂºÄÊ∫êÁªÑ‰ª∂ÔºåÂÆÉÂÜÖÈÉ®ÊòØ‰∏Ä‰∏™ÂàÜÂ±ÇÁöÑÊñá‰ª∂Á≥ªÁªüÁõÆÂΩïÊ†ëÁªìÊûÑÔºåËßÑÂÆöÂêå‰∏Ä‰∏™ÁõÆÂΩï‰∏ãÂè™ËÉΩÊúâ‰∏Ä‰∏™ÂîØ‰∏ÄÊñá‰ª∂Âêç„ÄÇÂü∫‰∫éZooKeeperÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÁöÑÊ≠•È™§Â¶Ç‰∏ãÔºö ÂàõÂª∫‰∏Ä‰∏™ÁõÆÂΩïmylockÔºõ Á∫øÁ®ãAÊÉ≥Ëé∑ÂèñÈîÅÂ∞±Âú®mylockÁõÆÂΩï‰∏ãÂàõÂª∫‰∏¥Êó∂È°∫Â∫èËäÇÁÇπÔºõ Ëé∑ÂèñmylockÁõÆÂΩï‰∏ãÊâÄÊúâÁöÑÂ≠êËäÇÁÇπÔºåÁÑ∂ÂêéËé∑ÂèñÊØîËá™Â∑±Â∞èÁöÑÂÖÑÂºüËäÇÁÇπÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂàôËØ¥ÊòéÂΩìÂâçÁ∫øÁ®ãÈ°∫Â∫èÂè∑ÊúÄÂ∞èÔºåËé∑ÂæóÈîÅÔºõ Á∫øÁ®ãBËé∑ÂèñÊâÄÊúâËäÇÁÇπÔºåÂà§Êñ≠Ëá™Â∑±‰∏çÊòØÊúÄÂ∞èËäÇÁÇπÔºåËÆæÁΩÆÁõëÂê¨ÊØîËá™Â∑±Ê¨°Â∞èÁöÑËäÇÁÇπÔºõ Á∫øÁ®ãAÂ§ÑÁêÜÂÆåÔºåÂà†Èô§Ëá™Â∑±ÁöÑËäÇÁÇπÔºåÁ∫øÁ®ãBÁõëÂê¨Âà∞ÂèòÊõ¥‰∫ã‰ª∂ÔºåÂà§Êñ≠Ëá™Â∑±ÊòØ‰∏çÊòØÊúÄÂ∞èÁöÑËäÇÁÇπÔºåÂ¶ÇÊûúÊòØÂàôËé∑ÂæóÈîÅ„ÄÇ ËøôÈáåÊé®Ëçê‰∏Ä‰∏™ApacheÁöÑÂºÄÊ∫êÂ∫ìCuratorÔºåÂÆÉÊòØ‰∏Ä‰∏™ZooKeeperÂÆ¢Êà∑Á´ØÔºåCuratorÊèê‰æõÁöÑInterProcessMutexÊòØÂàÜÂ∏ÉÂºèÈîÅÁöÑÂÆûÁé∞ÔºåacquireÊñπÊ≥ïÁî®‰∫éËé∑ÂèñÈîÅÔºåreleaseÊñπÊ≥ïÁî®‰∫éÈáäÊîæÈîÅ„ÄÇ ‰ºòÁÇπÔºöÂÖ∑Â§áÈ´òÂèØÁî®„ÄÅÂèØÈáçÂÖ•„ÄÅÈòªÂ°ûÈîÅÁâπÊÄßÔºåÂèØËß£ÂÜ≥Â§±ÊïàÊ≠ªÈîÅÈóÆÈ¢ò„ÄÇ Áº∫ÁÇπÔºöÂõ†‰∏∫ÈúÄË¶ÅÈ¢ëÁπÅÁöÑÂàõÂª∫ÂíåÂà†Èô§ËäÇÁÇπÔºåÊÄßËÉΩ‰∏ä‰∏çÂ¶ÇRedisÊñπÂºè„ÄÇ ‰∏äÈù¢ÁöÑ‰∏âÁßçÂÆûÁé∞ÊñπÂºèÔºåÊ≤°ÊúâÂú®ÊâÄÊúâÂú∫ÂêàÈÉΩÊòØÂÆåÁæéÁöÑÔºåÊâÄ‰ª•ÔºåÂ∫îÊ†πÊçÆ‰∏çÂêåÁöÑÂ∫îÁî®Âú∫ÊôØÈÄâÊã©ÊúÄÈÄÇÂêàÁöÑÂÆûÁé∞ÊñπÂºè„ÄÇ Âú®ÂàÜÂ∏ÉÂºèÁéØÂ¢É‰∏≠ÔºåÂØπËµÑÊ∫êËøõË°å‰∏äÈîÅÊúâÊó∂ÂÄôÊòØÂæàÈáçË¶ÅÁöÑÔºåÊØîÂ¶ÇÊä¢Ë¥≠Êüê‰∏ÄËµÑÊ∫êÔºåËøôÊó∂ÂÄô‰ΩøÁî®ÂàÜÂ∏ÉÂºèÈîÅÂ∞±ÂèØ‰ª•ÂæàÂ•ΩÂú∞ÊéßÂà∂ËµÑÊ∫ê„ÄÇ 19. EtcdÊÄé‰πàÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ?È¶ñÂÖàÊÄùËÄÉ‰∏ãEtcdÊòØ‰ªÄ‰πàÔºüÂèØËÉΩÂæàÂ§ö‰∫∫Á¨¨‰∏ÄÂèçÂ∫îÂèØËÉΩÊòØ‰∏Ä‰∏™ÈîÆÂÄºÂ≠òÂÇ®‰ªìÂ∫ìÔºåÂç¥Ê≤°ÊúâÈáçËßÜÂÆòÊñπÂÆö‰πâÁöÑÂêéÂçäÂè•ÔºåÁî®‰∫éÈÖçÁΩÆÂÖ±‰∫´ÂíåÊúçÂä°ÂèëÁé∞„ÄÇ 1A highly-available key value store for shared configuration and service discovery. ÂÆûÈôÖ‰∏äÔºåetcd ‰Ωú‰∏∫‰∏Ä‰∏™ÂèóÂà∞ ZooKeeper ‰∏é doozer ÂêØÂèëËÄåÂÇ¨ÁîüÁöÑÈ°πÁõÆÔºåÈô§‰∫ÜÊã•Êúâ‰∏é‰πãÁ±ª‰ººÁöÑÂäüËÉΩÂ§ñÔºåÊõ¥‰∏ìÊ≥®‰∫é‰ª•‰∏ãÂõõÁÇπ„ÄÇ ÁÆÄÂçïÔºöÂü∫‰∫é HTTP+JSON ÁöÑ API ËÆ©‰Ω†Áî® curl Â∞±ÂèØ‰ª•ËΩªÊùæ‰ΩøÁî®„ÄÇ ÂÆâÂÖ®ÔºöÂèØÈÄâ SSL ÂÆ¢Êà∑ËÆ§ËØÅÊú∫Âà∂„ÄÇ Âø´ÈÄüÔºöÊØè‰∏™ÂÆû‰æãÊØèÁßíÊîØÊåÅ‰∏ÄÂçÉÊ¨°ÂÜôÊìç‰Ωú„ÄÇ ÂèØ‰ø°Ôºö‰ΩøÁî® Raft ÁÆóÊ≥ïÂÖÖÂàÜÂÆûÁé∞‰∫ÜÂàÜÂ∏ÉÂºè„ÄÇ ‰ΩÜÊòØËøôÈáåÊàë‰ª¨‰∏ªË¶ÅËÆ≤Ëø∞EtcdÂ¶Ç‰ΩïÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ? Âõ†‰∏∫ Etcd ‰ΩøÁî® Raft ÁÆóÊ≥ï‰øùÊåÅ‰∫ÜÊï∞ÊçÆÁöÑÂº∫‰∏ÄËá¥ÊÄßÔºåÊüêÊ¨°Êìç‰ΩúÂ≠òÂÇ®Âà∞ÈõÜÁæ§‰∏≠ÁöÑÂÄºÂøÖÁÑ∂ÊòØÂÖ®Â±Ä‰∏ÄËá¥ÁöÑÔºåÊâÄ‰ª•ÂæàÂÆπÊòìÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ„ÄÇÈîÅÊúçÂä°Êúâ‰∏§Áßç‰ΩøÁî®ÊñπÂºèÔºå‰∏ÄÊòØ‰øùÊåÅÁã¨Âç†Ôºå‰∫åÊòØÊéßÂà∂Êó∂Â∫è„ÄÇ ‰øùÊåÅÁã¨Âç†Âç≥ÊâÄÊúâËé∑ÂèñÈîÅÁöÑÁî®Êà∑ÊúÄÁªàÂè™Êúâ‰∏Ä‰∏™ÂèØ‰ª•ÂæóÂà∞„ÄÇetcd ‰∏∫Ê≠§Êèê‰æõ‰∫Ü‰∏ÄÂ•óÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÂéüÂ≠êÊìç‰Ωú CASÔºàCompareAndSwapÔºâÁöÑ API„ÄÇÈÄöËøáËÆæÁΩÆprevExistÂÄºÔºåÂèØ‰ª•‰øùËØÅÂú®Â§ö‰∏™ËäÇÁÇπÂêåÊó∂ÂéªÂàõÂª∫Êüê‰∏™ÁõÆÂΩïÊó∂ÔºåÂè™Êúâ‰∏Ä‰∏™ÊàêÂäü„ÄÇËÄåÂàõÂª∫ÊàêÂäüÁöÑÁî®Êà∑Â∞±ÂèØ‰ª•ËÆ§‰∏∫ÊòØËé∑Âæó‰∫ÜÈîÅ„ÄÇ ÊéßÂà∂Êó∂Â∫èÔºåÂç≥ÊâÄÊúâÊÉ≥Ë¶ÅËé∑ÂæóÈîÅÁöÑÁî®Êà∑ÈÉΩ‰ºöË¢´ÂÆâÊéíÊâßË°åÔºå‰ΩÜÊòØËé∑ÂæóÈîÅÁöÑÈ°∫Â∫è‰πüÊòØÂÖ®Â±ÄÂîØ‰∏ÄÁöÑÔºåÂêåÊó∂ÂÜ≥ÂÆö‰∫ÜÊâßË°åÈ°∫Â∫è„ÄÇetcd ‰∏∫Ê≠§‰πüÊèê‰æõ‰∫Ü‰∏ÄÂ•ó APIÔºàËá™Âä®ÂàõÂª∫ÊúâÂ∫èÈîÆÔºâÔºåÂØπ‰∏Ä‰∏™ÁõÆÂΩïÂª∫ÂÄºÊó∂ÊåáÂÆö‰∏∫POSTÂä®‰ΩúÔºåËøôÊ†∑ etcd ‰ºöËá™Âä®Âú®ÁõÆÂΩï‰∏ãÁîüÊàê‰∏Ä‰∏™ÂΩìÂâçÊúÄÂ§ßÁöÑÂÄº‰∏∫ÈîÆÔºåÂ≠òÂÇ®Ëøô‰∏™Êñ∞ÁöÑÂÄºÔºàÂÆ¢Êà∑Á´ØÁºñÂè∑Ôºâ„ÄÇÂêåÊó∂ËøòÂèØ‰ª•‰ΩøÁî® API ÊåâÈ°∫Â∫èÂàóÂá∫ÊâÄÊúâÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÈîÆÂÄº„ÄÇÊ≠§Êó∂Ëøô‰∫õÈîÆÁöÑÂÄºÂ∞±ÊòØÂÆ¢Êà∑Á´ØÁöÑÊó∂Â∫èÔºåËÄåËøô‰∫õÈîÆ‰∏≠Â≠òÂÇ®ÁöÑÂÄºÂèØ‰ª•ÊòØ‰ª£Ë°®ÂÆ¢Êà∑Á´ØÁöÑÁºñÂè∑„ÄÇ Âú®ËøôÈáåEctdÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÂü∫Êú¨ÂÆûÁé∞ÂéüÁêÜ‰∏∫Ôºö Âú®ectdÁ≥ªÁªüÈáåÂàõÂª∫‰∏Ä‰∏™key Â¶ÇÊûúÂàõÂª∫Â§±Ë¥•ÔºåkeyÂ≠òÂú®ÔºåÂàôÁõëÂê¨ËØ•keyÁöÑÂèòÂåñ‰∫ã‰ª∂ÔºåÁõ¥Âà∞ËØ•keyË¢´Âà†Èô§ÔºåÂõûÂà∞1 Â¶ÇÊûúÂàõÂª∫ÊàêÂäüÔºåÂàôËÆ§‰∏∫ÊàëËé∑Âæó‰∫ÜÈîÅ Â∫îÁî®Á§∫‰æã: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176package etcdsyncimport ( &quot;fmt&quot; &quot;io&quot; &quot;os&quot; &quot;sync&quot; &quot;time&quot; &quot;github.com/coreos/etcd/client&quot; &quot;github.com/coreos/etcd/Godeps/_workspace/src/golang.org/x/net/context&quot;)const ( defaultTTL = 60 defaultTry = 3 deleteAction = &quot;delete&quot; expireAction = &quot;expire&quot;)// A Mutex is a mutual exclusion lock which is distributed across a cluster.type Mutex struct &#123; key string id string // The identity of the caller client client.Client kapi client.KeysAPI ctx context.Context ttl time.Duration mutex *sync.Mutex logger io.Writer&#125;// New creates a Mutex with the given key which must be the same// across the cluster nodes.// machines are the ectd cluster addressesfunc New(key string, ttl int, machines []string) *Mutex &#123; cfg := client.Config&#123; Endpoints: machines, Transport: client.DefaultTransport, HeaderTimeoutPerRequest: time.Second, &#125; c, err := client.New(cfg) if err != nil &#123; return nil &#125; hostname, err := os.Hostname() if err != nil &#123; return nil &#125; if len(key) == 0 || len(machines) == 0 &#123; return nil &#125; if key[0] != &apos;/&apos; &#123; key = &quot;/&quot; + key &#125; if ttl &lt; 1 &#123; ttl = defaultTTL &#125; return &amp;Mutex&#123; key: key, id: fmt.Sprintf(&quot;%v-%v-%v&quot;, hostname, os.Getpid(), time.Now().Format(&quot;20060102-15:04:05.999999999&quot;)), client: c, kapi: client.NewKeysAPI(c), ctx: context.TODO(), ttl: time.Second * time.Duration(ttl), mutex: new(sync.Mutex), &#125;&#125;// Lock locks m.// If the lock is already in use, the calling goroutine// blocks until the mutex is available.func (m *Mutex) Lock() (err error) &#123; m.mutex.Lock() for try := 1; try &lt;= defaultTry; try++ &#123; if m.lock() == nil &#123; return nil &#125; m.debug(&quot;Lock node %v ERROR %v&quot;, m.key, err) if try &lt; defaultTry &#123; m.debug(&quot;Try to lock node %v again&quot;, m.key, err) &#125; &#125; return err&#125;func (m *Mutex) lock() (err error) &#123; m.debug(&quot;Trying to create a node : key=%v&quot;, m.key) setOptions := &amp;client.SetOptions&#123; PrevExist:client.PrevNoExist, TTL: m.ttl, &#125; resp, err := m.kapi.Set(m.ctx, m.key, m.id, setOptions) if err == nil &#123; m.debug(&quot;Create node %v OK [%q]&quot;, m.key, resp) return nil &#125; m.debug(&quot;Create node %v failed [%v]&quot;, m.key, err) e, ok := err.(client.Error) if !ok &#123; return err &#125; if e.Code != client.ErrorCodeNodeExist &#123; return err &#125; // Get the already node&apos;s value. resp, err = m.kapi.Get(m.ctx, m.key, nil) if err != nil &#123; return err &#125; m.debug(&quot;Get node %v OK&quot;, m.key) watcherOptions := &amp;client.WatcherOptions&#123; AfterIndex : resp.Index, Recursive:false, &#125; watcher := m.kapi.Watcher(m.key, watcherOptions) for &#123; m.debug(&quot;Watching %v ...&quot;, m.key) resp, err = watcher.Next(m.ctx) if err != nil &#123; return err &#125; m.debug(&quot;Received an event : %q&quot;, resp) if resp.Action == deleteAction || resp.Action == expireAction &#123; return nil &#125; &#125;&#125;// Unlock unlocks m.// It is a run-time error if m is not locked on entry to Unlock.//// A locked Mutex is not associated with a particular goroutine.// It is allowed for one goroutine to lock a Mutex and then// arrange for another goroutine to unlock it.func (m *Mutex) Unlock() (err error) &#123; defer m.mutex.Unlock() for i := 1; i &lt;= defaultTry; i++ &#123; var resp *client.Response resp, err = m.kapi.Delete(m.ctx, m.key, nil) if err == nil &#123; m.debug(&quot;Delete %v OK&quot;, m.key) return nil &#125; m.debug(&quot;Delete %v falied: %q&quot;, m.key, resp) e, ok := err.(client.Error) if ok &amp;&amp; e.Code == client.ErrorCodeKeyNotFound &#123; return nil &#125; &#125; return err&#125;func (m *Mutex) debug(format string, v ...interface&#123;&#125;) &#123; if m.logger != nil &#123; m.logger.Write([]byte(m.id)) m.logger.Write([]byte(&quot; &quot;)) m.logger.Write([]byte(fmt.Sprintf(format, v...))) m.logger.Write([]byte(&quot;\n&quot;)) &#125;&#125;func (m *Mutex) SetDebugLogger(w io.Writer) &#123; m.logger = w&#125; ÂÖ∂ÂÆûÁ±ª‰ººÁöÑÂÆûÁé∞ÊúâÂæàÂ§öÔºå‰ΩÜÁõÆÂâçÈÉΩÂ∑≤ÁªèËøáÊó∂Ôºå‰ΩøÁî®ÁöÑÈÉΩÊòØË¢´ÂÆòÊñπÊ†áËÆ∞‰∏∫deprecatedÁöÑÈ°πÁõÆ„ÄÇ‰∏îÂ§ßÈÉ®ÂàÜÊé•Âè£ÈÉΩ‰∏çÂ¶Ç‰∏äËø∞‰ª£Á†ÅÁÆÄÂçï„ÄÇ ‰ΩøÁî®‰∏äÔºåË∑üGolangÂÆòÊñπsyncÂåÖÁöÑMutexÊé•Âè£ÈùûÂ∏∏Á±ª‰ººÔºåÂÖàNew()ÔºåÁÑ∂ÂêéË∞ÉÁî®Lock()Ôºå‰ΩøÁî®ÂÆåÂêéË∞ÉÁî®Unlock()ÔºåÂ∞±‰∏â‰∏™Êé•Âè£ÔºåÂ∞±ÊòØËøô‰πàÁÆÄÂçï„ÄÇÁ§∫‰æã‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930package mainimport ( &quot;github.com/zieckey/etcdsync&quot; &quot;log&quot;)func main() &#123; //etcdsync.SetDebug(true) log.SetFlags(log.Ldate|log.Ltime|log.Lshortfile) m := etcdsync.New(&quot;/etcdsync&quot;, &quot;123&quot;, []string&#123;&quot;http://127.0.0.1:2379&quot;&#125;) if m == nil &#123; log.Printf(&quot;etcdsync.NewMutex failed&quot;) &#125; err := m.Lock() if err != nil &#123; log.Printf(&quot;etcdsync.Lock failed&quot;) &#125; else &#123; log.Printf(&quot;etcdsync.Lock OK&quot;) &#125; log.Printf(&quot;Get the lock. Do something here.&quot;) err = m.Unlock() if err != nil &#123; log.Printf(&quot;etcdsync.Unlock failed&quot;) &#125; else &#123; log.Printf(&quot;etcdsync.Unlock OK&quot;) &#125;&#125; 20. RedisÁöÑÊï∞ÊçÆÁªìÊûÑÊúâÂì™‰∫õÔºå‰ª•ÂèäÂÆûÁé∞Âú∫ÊôØ?RedisÁöÑÊï∞ÊçÆÁªìÊûÑÊúâ‰∫îÁßç: string Â≠óÁ¨¶‰∏≤ String Êï∞ÊçÆÁªìÊûÑÊòØÁÆÄÂçïÁöÑ key-value Á±ªÂûãÔºåvalue ‰∏ç‰ªÖÂèØ‰ª•ÊòØ StringÔºå‰πüÂèØ‰ª•ÊòØÊï∞Â≠óÔºàÂΩìÊï∞Â≠óÁ±ªÂûãÁî® Long ÂèØ‰ª•Ë°®Á§∫ÁöÑÊó∂ÂÄôencoding Â∞±ÊòØÊï¥ÂûãÔºåÂÖ∂‰ªñÈÉΩÂ≠òÂÇ®Âú® sdshdr ÂΩìÂÅöÂ≠óÁ¨¶‰∏≤Ôºâ„ÄÇ‰ΩøÁî® Strings Á±ªÂûãÔºåÂèØ‰ª•ÂÆåÂÖ®ÂÆûÁé∞ÁõÆÂâç Memcached ÁöÑÂäüËÉΩÔºåÂπ∂‰∏îÊïàÁéáÊõ¥È´ò„ÄÇËøòÂèØ‰ª•‰∫´Âèó Redis ÁöÑÂÆöÊó∂ÊåÅ‰πÖÂåñÔºàÂèØ‰ª•ÈÄâÊã© RDB Ê®°ÂºèÊàñËÄÖ AOF Ê®°ÂºèÔºâÔºåÊìç‰ΩúÊó•ÂøóÂèä Replication Á≠âÂäüËÉΩ„ÄÇ Èô§‰∫ÜÊèê‰æõ‰∏é Memcached ‰∏ÄÊ†∑ÁöÑ get„ÄÅset„ÄÅincr„ÄÅdecr Á≠âÊìç‰ΩúÂ§ñÔºåRedis ËøòÊèê‰æõ‰∫Ü‰∏ãÈù¢‰∏Ä‰∫õÊìç‰ΩúÔºö LEN niushuaiÔºöO(1)Ëé∑ÂèñÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶. APPEND niushuai redisÔºöÂæÄÂ≠óÁ¨¶‰∏≤ append ÂÜÖÂÆπÔºåËÄå‰∏îÈááÁî®Êô∫ËÉΩÂàÜÈÖçÂÜÖÂ≠òÔºàÊØèÊ¨°2ÂÄçÔºâ. ËÆæÁΩÆÂíåËé∑ÂèñÂ≠óÁ¨¶‰∏≤ÁöÑÊüê‰∏ÄÊÆµÂÜÖÂÆπ. ËÆæÁΩÆÂèäËé∑ÂèñÂ≠óÁ¨¶‰∏≤ÁöÑÊüê‰∏Ä‰ΩçÔºàbitÔºâ. ÊâπÈáèËÆæÁΩÆ‰∏ÄÁ≥ªÂàóÂ≠óÁ¨¶‰∏≤ÁöÑÂÜÖÂÆπ. ÂéüÂ≠êËÆ°Êï∞Âô®. GETSET ÂëΩ‰ª§ÁöÑÂ¶ôÁî®ÔºåËØ∑‰∫éÊ∏ÖÁ©∫ÊóßÂÄºÁöÑÂêåÊó∂ËÆæÁΩÆ‰∏Ä‰∏™Êñ∞ÂÄºÔºåÈÖçÂêàÂéüÂ≠êËÆ°Êï∞Âô®‰ΩøÁî®. Hash Â≠óÂÖ∏ Âú® Memcached ‰∏≠ÔºåÊàë‰ª¨ÁªèÂ∏∏Â∞Ü‰∏Ä‰∫õÁªìÊûÑÂåñÁöÑ‰ø°ÊÅØÊâìÂåÖÊàê hashmapÔºåÂú®ÂÆ¢Êà∑Á´ØÂ∫èÂàóÂåñÂêéÂ≠òÂÇ®‰∏∫‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÂÄºÔºà‰∏ÄËà¨ÊòØ JSON Ê†ºÂºèÔºâÔºåÊØîÂ¶ÇÁî®Êà∑ÁöÑÊòµÁß∞„ÄÅÂπ¥ÈæÑ„ÄÅÊÄßÂà´„ÄÅÁßØÂàÜÁ≠â„ÄÇËøôÊó∂ÂÄôÂú®ÈúÄË¶Å‰øÆÊîπÂÖ∂‰∏≠Êüê‰∏ÄÈ°πÊó∂ÔºåÈÄöÂ∏∏ÈúÄË¶ÅÂ∞ÜÂ≠óÁ¨¶‰∏≤ÔºàJSONÔºâÂèñÂá∫Êù•ÔºåÁÑ∂ÂêéËøõË°åÂèçÂ∫èÂàóÂåñÔºå‰øÆÊîπÊüê‰∏ÄÈ°πÁöÑÂÄºÔºåÂÜçÂ∫èÂàóÂåñÊàêÂ≠óÁ¨¶‰∏≤ÔºàJSONÔºâÂ≠òÂÇ®ÂõûÂéª„ÄÇÁÆÄÂçï‰øÆÊîπ‰∏Ä‰∏™Â±ûÊÄßÂ∞±Âπ≤Ëøô‰πàÂ§ö‰∫ãÊÉÖÔºåÊ∂àËÄóÂøÖÂÆöÊòØÂæàÂ§ßÁöÑÔºå‰πü‰∏çÈÄÇÁî®‰∫é‰∏Ä‰∫õÂèØËÉΩÂπ∂ÂèëÊìç‰ΩúÁöÑÂú∫ÂêàÔºàÊØîÂ¶Ç‰∏§‰∏™Âπ∂ÂèëÁöÑÊìç‰ΩúÈÉΩÈúÄË¶Å‰øÆÊîπÁßØÂàÜÔºâ„ÄÇËÄå Redis ÁöÑ Hash ÁªìÊûÑÂèØ‰ª•‰Ωø‰Ω†ÂÉèÂú®Êï∞ÊçÆÂ∫ì‰∏≠ Update ‰∏Ä‰∏™Â±ûÊÄß‰∏ÄÊ†∑Âè™‰øÆÊîπÊüê‰∏ÄÈ°πÂ±ûÊÄßÂÄº„ÄÇ HashÂèØ‰ª•Áî®Êù•Â≠òÂÇ®„ÄÅËØªÂèñ„ÄÅ‰øÆÊîπÁî®Êà∑Â±ûÊÄß„ÄÇ List ÂàóË°® List ËØ¥ÁôΩ‰∫ÜÂ∞±ÊòØÈìæË°®Ôºàredis ‰ΩøÁî®ÂèåÁ´ØÈìæË°®ÂÆûÁé∞ÁöÑ ListÔºâÔºåÁõ∏‰ø°Â≠¶ËøáÊï∞ÊçÆÁªìÊûÑÁü•ËØÜÁöÑ‰∫∫ÈÉΩÂ∫îËØ•ËÉΩÁêÜËß£ÂÖ∂ÁªìÊûÑ„ÄÇ‰ΩøÁî® List ÁªìÊûÑÔºåÊàë‰ª¨ÂèØ‰ª•ËΩªÊùæÂú∞ÂÆûÁé∞ÊúÄÊñ∞Ê∂àÊÅØÊéíË°åÁ≠âÂäüËÉΩÔºàÊØîÂ¶ÇÊñ∞Êµ™ÂæÆÂçöÁöÑ TimeLine Ôºâ„ÄÇList ÁöÑÂè¶‰∏Ä‰∏™Â∫îÁî®Â∞±ÊòØÊ∂àÊÅØÈòüÂàóÔºåÂèØ‰ª•Âà©Áî® List ÁöÑ *PUSH Êìç‰ΩúÔºåÂ∞Ü‰ªªÂä°Â≠òÂú® List ‰∏≠ÔºåÁÑ∂ÂêéÂ∑•‰ΩúÁ∫øÁ®ãÂÜçÁî® POP Êìç‰ΩúÂ∞Ü‰ªªÂä°ÂèñÂá∫ËøõË°åÊâßË°å„ÄÇ Redis ËøòÊèê‰æõ‰∫ÜÊìç‰Ωú List ‰∏≠Êüê‰∏ÄÊÆµÂÖÉÁ¥†ÁöÑ APIÔºå‰Ω†ÂèØ‰ª•Áõ¥Êé•Êü•ËØ¢ÔºåÂà†Èô§ List ‰∏≠Êüê‰∏ÄÊÆµÁöÑÂÖÉÁ¥†„ÄÇ List ÂàóË°®Â∫îÁî®: ÂæÆÂçö TimeLine. Ê∂àÊÅØÈòüÂàó. Set ÈõÜÂêà Set Â∞±ÊòØ‰∏Ä‰∏™ÈõÜÂêàÔºåÈõÜÂêàÁöÑÊ¶ÇÂøµÂ∞±ÊòØ‰∏ÄÂ†Ü‰∏çÈáçÂ§çÂÄºÁöÑÁªÑÂêà„ÄÇÂà©Áî® Redis Êèê‰æõÁöÑ Set Êï∞ÊçÆÁªìÊûÑÔºåÂèØ‰ª•Â≠òÂÇ®‰∏Ä‰∫õÈõÜÂêàÊÄßÁöÑÊï∞ÊçÆ„ÄÇÊØîÂ¶ÇÂú®ÂæÆÂçöÂ∫îÁî®‰∏≠ÔºåÂèØ‰ª•Â∞Ü‰∏Ä‰∏™Áî®Êà∑ÊâÄÊúâÁöÑÂÖ≥Ê≥®‰∫∫Â≠òÂú®‰∏Ä‰∏™ÈõÜÂêà‰∏≠ÔºåÂ∞ÜÂÖ∂ÊâÄÊúâÁ≤â‰∏ùÂ≠òÂú®‰∏Ä‰∏™ÈõÜÂêà„ÄÇÂõ†‰∏∫ Redis ÈùûÂ∏∏‰∫∫ÊÄßÂåñÁöÑ‰∏∫ÈõÜÂêàÊèê‰æõ‰∫ÜÊ±Ç‰∫§ÈõÜ„ÄÅÂπ∂ÈõÜ„ÄÅÂ∑ÆÈõÜÁ≠âÊìç‰ΩúÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈùûÂ∏∏Êñπ‰æøÁöÑÂÆûÁé∞Â¶ÇÂÖ±ÂêåÂÖ≥Ê≥®„ÄÅÂÖ±ÂêåÂñúÂ•Ω„ÄÅ‰∫åÂ∫¶Â•ΩÂèãÁ≠âÂäüËÉΩÔºåÂØπ‰∏äÈù¢ÁöÑÊâÄÊúâÈõÜÂêàÊìç‰ΩúÔºå‰Ω†ËøòÂèØ‰ª•‰ΩøÁî®‰∏çÂêåÁöÑÂëΩ‰ª§ÈÄâÊã©Â∞ÜÁªìÊûúËøîÂõûÁªôÂÆ¢Êà∑Á´ØËøòÊòØÂ≠òÈõÜÂà∞‰∏Ä‰∏™Êñ∞ÁöÑÈõÜÂêà‰∏≠„ÄÇ Set ÈõÜÂêàÂ∫îÁî®: ÂÖ±ÂêåÂ•ΩÂèã„ÄÅ‰∫åÂ∫¶Â•ΩÂèã Âà©Áî®ÂîØ‰∏ÄÊÄßÔºåÂèØ‰ª•ÁªüËÆ°ËÆøÈóÆÁΩëÁ´ôÁöÑÊâÄÊúâÁã¨Á´ã IP. Â•ΩÂèãÊé®ËçêÁöÑÊó∂ÂÄôÔºåÊ†πÊçÆ tag Ê±Ç‰∫§ÈõÜÔºåÂ§ß‰∫éÊüê‰∏™ threshold Â∞±ÂèØ‰ª•Êé®Ëçê. Sorted SetÊúâÂ∫èÈõÜÂêà ÂíåSetsÁõ∏ÊØîÔºåSorted SetsÊòØÂ∞Ü Set ‰∏≠ÁöÑÂÖÉÁ¥†Â¢ûÂä†‰∫Ü‰∏Ä‰∏™ÊùÉÈáçÂèÇÊï∞ scoreÔºå‰ΩøÂæóÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ËÉΩÂ§üÊåâ score ËøõË°åÊúâÂ∫èÊéíÂàóÔºåÊØîÂ¶Ç‰∏Ä‰∏™Â≠òÂÇ®ÂÖ®Áè≠ÂêåÂ≠¶ÊàêÁª©ÁöÑ Sorted SetsÔºåÂÖ∂ÈõÜÂêà value ÂèØ‰ª•ÊòØÂêåÂ≠¶ÁöÑÂ≠¶Âè∑ÔºåËÄå score Â∞±ÂèØ‰ª•ÊòØÂÖ∂ËÄÉËØïÂæóÂàÜÔºåËøôÊ†∑Âú®Êï∞ÊçÆÊèíÂÖ•ÈõÜÂêàÁöÑÊó∂ÂÄôÔºåÂ∞±Â∑≤ÁªèËøõË°å‰∫ÜÂ§©ÁÑ∂ÁöÑÊéíÂ∫è„ÄÇÂè¶Â§ñËøòÂèØ‰ª•Áî® Sorted Sets Êù•ÂÅöÂ∏¶ÊùÉÈáçÁöÑÈòüÂàóÔºåÊØîÂ¶ÇÊôÆÈÄöÊ∂àÊÅØÁöÑ score ‰∏∫1ÔºåÈáçË¶ÅÊ∂àÊÅØÁöÑ score ‰∏∫2ÔºåÁÑ∂ÂêéÂ∑•‰ΩúÁ∫øÁ®ãÂèØ‰ª•ÈÄâÊã©Êåâ score ÁöÑÂÄíÂ∫èÊù•Ëé∑ÂèñÂ∑•‰Ωú‰ªªÂä°„ÄÇËÆ©ÈáçË¶ÅÁöÑ‰ªªÂä°‰ºòÂÖàÊâßË°å„ÄÇ Sorted SetÊúâÂ∫èÈõÜÂêàÂ∫îÁî®: 1.Â∏¶ÊúâÊùÉÈáçÁöÑÂÖÉÁ¥†ÔºåÊØîÂ¶Ç‰∏Ä‰∏™Ê∏∏ÊàèÁöÑÁî®Êà∑ÂæóÂàÜÊéíË°åÊ¶ú. 2.ÊØîËæÉÂ§çÊùÇÁöÑÊï∞ÊçÆÁªìÊûÑÔºå‰∏ÄËà¨Áî®Âà∞ÁöÑÂú∫ÊôØ‰∏çÁÆóÂ§™Â§ö. Redis ÂÖ∂‰ªñÂäüËÉΩ‰ΩøÁî®Âú∫ÊôØ: ËÆ¢ÈòÖ-ÂèëÂ∏ÉÁ≥ªÁªü Pub/Sub ‰ªéÂ≠óÈù¢‰∏äÁêÜËß£Â∞±ÊòØÂèëÂ∏ÉÔºàPublishÔºâ‰∏éËÆ¢ÈòÖÔºàSubscribeÔºâÔºåÂú® Redis ‰∏≠Ôºå‰Ω†ÂèØ‰ª•ËÆæÂÆöÂØπÊüê‰∏Ä‰∏™ key ÂÄºËøõË°åÊ∂àÊÅØÂèëÂ∏ÉÂèäÊ∂àÊÅØËÆ¢ÈòÖÔºåÂΩì‰∏Ä‰∏™ key ÂÄº‰∏äËøõË°å‰∫ÜÊ∂àÊÅØÂèëÂ∏ÉÂêéÔºåÊâÄÊúâËÆ¢ÈòÖÂÆÉÁöÑÂÆ¢Êà∑Á´ØÈÉΩ‰ºöÊî∂Âà∞Áõ∏Â∫îÁöÑÊ∂àÊÅØ„ÄÇËøô‰∏ÄÂäüËÉΩÊúÄÊòéÊòæÁöÑÁî®Ê≥ïÂ∞±ÊòØÁî®‰ΩúÂÆûÊó∂Ê∂àÊÅØÁ≥ªÁªüÔºåÊØîÂ¶ÇÊôÆÈÄöÁöÑÂç≥Êó∂ËÅäÂ§©ÔºåÁæ§ËÅäÁ≠âÂäüËÉΩ„ÄÇ ‰∫ãÂä°‚Äî‚ÄîTransactions Ë∞ÅËØ¥ NoSQL ÈÉΩ‰∏çÊîØÊåÅ‰∫ãÂä°ÔºåËôΩÁÑ∂ Redis ÁöÑ Transactions Êèê‰æõÁöÑÂπ∂‰∏çÊòØ‰∏•Ê†ºÁöÑ ACID ÁöÑ‰∫ãÂä°ÔºàÊØîÂ¶Ç‰∏Ä‰∏≤Áî® EXEC Êèê‰∫§ÊâßË°åÁöÑÂëΩ‰ª§ÔºåÂú®ÊâßË°å‰∏≠ÊúçÂä°Âô®ÂÆïÊú∫ÔºåÈÇ£‰πà‰ºöÊúâ‰∏ÄÈÉ®ÂàÜÂëΩ‰ª§ÊâßË°å‰∫ÜÔºåÂâ©‰∏ãÁöÑÊ≤°ÊâßË°åÔºâÔºå‰ΩÜÊòØËøô‰∏™ Transactions ËøòÊòØÊèê‰æõ‰∫ÜÂü∫Êú¨ÁöÑÂëΩ‰ª§ÊâìÂåÖÊâßË°åÁöÑÂäüËÉΩÔºàÂú®ÊúçÂä°Âô®‰∏çÂá∫ÈóÆÈ¢òÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØ‰ª•‰øùËØÅ‰∏ÄËøû‰∏≤ÁöÑÂëΩ‰ª§ÊòØÈ°∫Â∫èÂú®‰∏ÄËµ∑ÊâßË°åÁöÑÔºå‰∏≠Èó¥Êúâ‰ºöÊúâÂÖ∂ÂÆÉÂÆ¢Êà∑Á´ØÂëΩ‰ª§ÊèíËøõÊù•ÊâßË°åÔºâ„ÄÇRedis ËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ Watch ÂäüËÉΩÔºå‰Ω†ÂèØ‰ª•ÂØπ‰∏Ä‰∏™ key ËøõË°å WatchÔºåÁÑ∂ÂêéÂÜçÊâßË°å TransactionsÔºåÂú®ËøôËøáÁ®ã‰∏≠ÔºåÂ¶ÇÊûúËøô‰∏™ Watched ÁöÑÂÄºËøõË°å‰∫Ü‰øÆÊîπÔºåÈÇ£‰πàËøô‰∏™ Transactions ‰ºöÂèëÁé∞Âπ∂ÊãíÁªùÊâßË°å„ÄÇ 21. MysqlÈ´òÂèØÁî®ÊñπÊ°àÊúâÂì™‰∫õ?MysqlÈ´òÂèØÁî®ÊñπÊ°àÂåÖÊã¨: ‰∏ª‰ªéÂ§çÂà∂ÊñπÊ°à ËøôÊòØMySQLËá™Ë∫´Êèê‰æõÁöÑ‰∏ÄÁßçÈ´òÂèØÁî®Ëß£ÂÜ≥ÊñπÊ°àÔºåÊï∞ÊçÆÂêåÊ≠•ÊñπÊ≥ïÈááÁî®ÁöÑÊòØMySQL replicationÊäÄÊúØ„ÄÇMySQL replicationÂ∞±ÊòØ‰ªéÊúçÂä°Âô®Âà∞‰∏ªÊúçÂä°Âô®ÊãâÂèñ‰∫åËøõÂà∂Êó•ÂøóÊñá‰ª∂ÔºåÁÑ∂ÂêéÂÜçÂ∞ÜÊó•ÂøóÊñá‰ª∂Ëß£ÊûêÊàêÁõ∏Â∫îÁöÑSQLÂú®‰ªéÊúçÂä°Âô®‰∏äÈáçÊñ∞ÊâßË°å‰∏ÄÈÅç‰∏ªÊúçÂä°Âô®ÁöÑÊìç‰ΩúÔºåÈÄöËøáËøôÁßçÊñπÂºè‰øùËØÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄß„ÄÇ‰∏∫‰∫ÜËææÂà∞Êõ¥È´òÁöÑÂèØÁî®ÊÄßÔºåÂú®ÂÆûÈôÖÁöÑÂ∫îÁî®ÁéØÂ¢É‰∏≠Ôºå‰∏ÄËà¨ÈÉΩÊòØÈááÁî®MySQL replicationÊäÄÊúØÈÖçÂêàÈ´òÂèØÁî®ÈõÜÁæ§ËΩØ‰ª∂keepalivedÊù•ÂÆûÁé∞Ëá™Âä®failoverÔºåËøôÁßçÊñπÂºèÂèØ‰ª•ÂÆûÁé∞95.000%ÁöÑSLA„ÄÇ MMM/MHAÈ´òÂèØÁî®ÊñπÊ°à MMMÊèê‰æõ‰∫ÜMySQL‰∏ª‰∏ªÂ§çÂà∂ÈÖçÁΩÆÁöÑÁõëÊéß„ÄÅÊïÖÈöúËΩ¨ÁßªÂíåÁÆ°ÁêÜÁöÑ‰∏ÄÂ•óÂèØ‰º∏Áº©ÁöÑËÑöÊú¨Â•ó‰ª∂„ÄÇÂú®MMMÈ´òÂèØÁî®ÊñπÊ°à‰∏≠ÔºåÂÖ∏ÂûãÁöÑÂ∫îÁî®ÊòØÂèå‰∏ªÂ§ö‰ªéÊû∂ÊûÑÔºåÈÄöËøáMySQL replicationÊäÄÊúØÂèØ‰ª•ÂÆûÁé∞‰∏§‰∏™ÊúçÂä°Âô®‰∫í‰∏∫‰∏ª‰ªéÔºå‰∏îÂú®‰ªª‰ΩïÊó∂ÂÄôÂè™Êúâ‰∏Ä‰∏™ËäÇÁÇπÂèØ‰ª•Ë¢´ÂÜôÂÖ•ÔºåÈÅøÂÖç‰∫ÜÂ§öÁÇπÂÜôÂÖ•ÁöÑÊï∞ÊçÆÂÜ≤Á™Å„ÄÇÂêåÊó∂ÔºåÂΩìÂèØÂÜôÁöÑ‰∏ªËäÇÁÇπÊïÖÈöúÊó∂ÔºåMMMÂ•ó‰ª∂ÂèØ‰ª•Á´ãÂàªÁõëÊéßÂà∞ÔºåÁÑ∂ÂêéÂ∞ÜÊúçÂä°Ëá™Âä®ÂàáÊç¢Âà∞Âè¶‰∏Ä‰∏™‰∏ªËäÇÁÇπÔºåÁªßÁª≠Êèê‰æõÊúçÂä°Ôºå‰ªéËÄåÂÆûÁé∞MySQLÁöÑÈ´òÂèØÁî®„ÄÇ Heartbeat/SANÈ´òÂèØÁî®ÊñπÊ°à Âú®Ëøô‰∏™ÊñπÊ°à‰∏≠ÔºåÂ§ÑÁêÜfailoverÁöÑÊñπÂºèÊòØÈ´òÂèØÁî®ÈõÜÁæ§ËΩØ‰ª∂HeartbeatÔºåÂÆÉÁõëÊéßÂíåÁÆ°ÁêÜÂêÑ‰∏™ËäÇÁÇπÈó¥ËøûÊé•ÁöÑÁΩëÁªúÔºåÂπ∂ÁõëÊéßÈõÜÁæ§ÊúçÂä°ÔºåÂΩìËäÇÁÇπÂá∫Áé∞ÊïÖÈöúÊàñËÄÖÊúçÂä°‰∏çÂèØÁî®Êó∂ÔºåËá™Âä®Âú®ÂÖ∂‰ªñËäÇÁÇπÂêØÂä®ÈõÜÁæ§ÊúçÂä°„ÄÇÂú®Êï∞ÊçÆÂÖ±‰∫´ÊñπÈù¢ÔºåÈÄöËøáSANÔºàStorage Area NetworkÔºâÂ≠òÂÇ®Êù•ÂÖ±‰∫´Êï∞ÊçÆÔºåËøôÁßçÊñπÊ°àÂèØ‰ª•ÂÆûÁé∞99.990%ÁöÑSLA„ÄÇ Heartbeat/DRBDÈ´òÂèØÁî®ÊñπÊ°à Ëøô‰∏™ÊñπÊ°àÂ§ÑÁêÜfailoverÁöÑÊñπÂºè‰∏ä‰æùÊóßÈááÁî®HeartbeatÔºå‰∏çÂêåÁöÑÊòØÔºåÂú®Êï∞ÊçÆÂÖ±‰∫´ÊñπÈù¢ÔºåÈááÁî®‰∫ÜÂü∫‰∫éÂùóÁ∫ßÂà´ÁöÑÊï∞ÊçÆÂêåÊ≠•ËΩØ‰ª∂DRBDÊù•ÂÆûÁé∞„ÄÇDRBDÊòØ‰∏Ä‰∏™Áî®ËΩØ‰ª∂ÂÆûÁé∞ÁöÑ„ÄÅÊó†ÂÖ±‰∫´ÁöÑ„ÄÅÊúçÂä°Âô®‰πãÈó¥ÈïúÂÉèÂùóËÆæÂ§áÂÜÖÂÆπÁöÑÂ≠òÂÇ®Â§çÂà∂Ëß£ÂÜ≥ÊñπÊ°à„ÄÇÂíåSANÁΩëÁªú‰∏çÂêåÔºåÂÆÉÂπ∂‰∏çÂÖ±‰∫´Â≠òÂÇ®ÔºåËÄåÊòØÈÄöËøáÊúçÂä°Âô®‰πãÈó¥ÁöÑÁΩëÁªúÂ§çÂà∂Êï∞ÊçÆ„ÄÇ NDB CLUSTERÈ´òÂèØÁî®ÊñπÊ°à ÂõΩÂÜÖÁî®NDBÈõÜÁæ§ÁöÑÂÖ¨Âè∏ÈùûÂ∏∏Â∞ëÔºåË≤å‰ººÊúâ‰∫õÈì∂Ë°åÊúâÁî®„ÄÇNDBÈõÜÁæ§‰∏çÈúÄË¶Å‰æùËµñÁ¨¨‰∏âÊñπÁªÑ‰ª∂ÔºåÂÖ®ÈÉ®ÈÉΩ‰ΩøÁî®ÂÆòÊñπÁªÑ‰ª∂ÔºåËÉΩ‰øùËØÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºåÊüê‰∏™Êï∞ÊçÆËäÇÁÇπÊåÇÊéâÔºåÂÖ∂‰ªñÊï∞ÊçÆËäÇÁÇπ‰æùÁÑ∂ÂèØ‰ª•Êèê‰æõÊúçÂä°ÔºåÁÆ°ÁêÜËäÇÁÇπÈúÄË¶ÅÂÅöÂÜó‰Ωô‰ª•Èò≤ÊåÇÊéâ„ÄÇÁº∫ÁÇπÊòØÔºöÁÆ°ÁêÜÂíåÈÖçÁΩÆÈÉΩÂæàÂ§çÊùÇÔºåËÄå‰∏îÊüê‰∫õSQLËØ≠Âè•‰æãÂ¶ÇjoinËØ≠Âè•ÈúÄË¶ÅÈÅøÂÖç„ÄÇ 22. GoËØ≠Ë®ÄÁöÑÊ†àÁ©∫Èó¥ÁÆ°ÁêÜÊòØÊÄé‰πàÊ†∑ÁöÑ?GoËØ≠Ë®ÄÁöÑËøêË°åÁéØÂ¢ÉÔºàruntimeÔºâ‰ºöÂú®goroutineÈúÄË¶ÅÁöÑÊó∂ÂÄôÂä®ÊÄÅÂú∞ÂàÜÈÖçÊ†àÁ©∫Èó¥ÔºåËÄå‰∏çÊòØÁªôÊØè‰∏™goroutineÂàÜÈÖçÂõ∫ÂÆöÂ§ßÂ∞èÁöÑÂÜÖÂ≠òÁ©∫Èó¥„ÄÇËøôÊ†∑Â∞±ÈÅøÂÖç‰∫ÜÈúÄË¶ÅÁ®ãÂ∫èÂëòÊù•ÂÜ≥ÂÆöÊ†àÁöÑÂ§ßÂ∞è„ÄÇ ÂàÜÂùóÂºèÁöÑÊ†àÊòØÊúÄÂàùGoËØ≠Ë®ÄÁªÑÁªáÊ†àÁöÑÊñπÂºè„ÄÇÂΩìÂàõÂª∫‰∏Ä‰∏™goroutineÁöÑÊó∂ÂÄôÔºåÂÆÉ‰ºöÂàÜÈÖç‰∏Ä‰∏™8KBÁöÑÂÜÖÂ≠òÁ©∫Èó¥Êù•ÁªôgoroutineÁöÑÊ†à‰ΩøÁî®„ÄÇÊàë‰ª¨ÂèØËÉΩ‰ºöËÄÉËôëÂΩìËøô8KBÁöÑÊ†àÁ©∫Èó¥Ë¢´Áî®ÂÆåÁöÑÊó∂ÂÄôËØ•ÊÄé‰πàÂäû? ‰∏∫‰∫ÜÂ§ÑÁêÜËøôÁßçÊÉÖÂÜµÔºåÊØè‰∏™GoÂáΩÊï∞ÁöÑÂºÄÂ§¥ÈÉΩÊúâ‰∏ÄÂ∞èÊÆµÊ£ÄÊµã‰ª£Á†Å„ÄÇËøôÊÆµ‰ª£Á†Å‰ºöÊ£ÄÊü•Êàë‰ª¨ÊòØÂê¶Â∑≤ÁªèÁî®ÂÆå‰∫ÜÂàÜÈÖçÁöÑÊ†àÁ©∫Èó¥„ÄÇÂ¶ÇÊûúÊòØÁöÑËØùÔºåÂÆÉ‰ºöË∞ÉÁî®morestackÂáΩÊï∞„ÄÇmorestackÂáΩÊï∞ÂàÜÈÖç‰∏ÄÂùóÊñ∞ÁöÑÂÜÖÂ≠ò‰Ωú‰∏∫Ê†àÁ©∫Èó¥ÔºåÂπ∂‰∏îÂú®ËøôÂùóÊ†àÁ©∫Èó¥ÁöÑÂ∫ïÈÉ®Â°´ÂÖ•ÂêÑÁßç‰ø°ÊÅØÔºàÂåÖÊã¨‰πãÂâçÁöÑÈÇ£ÂùóÊ†àÂú∞ÂùÄÔºâ„ÄÇÂú®ÂàÜÈÖç‰∫ÜËøôÂùóÊñ∞ÁöÑÊ†àÁ©∫Èó¥‰πãÂêéÔºåÂÆÉ‰ºöÈáçËØïÂàöÊâçÈÄ†ÊàêÊ†àÁ©∫Èó¥‰∏çË∂≥ÁöÑÂáΩÊï∞„ÄÇËøô‰∏™ËøáÁ®ãÂè´ÂÅöÊ†àÂàÜË£ÇÔºàstack splitÔºâ„ÄÇ Âú®Êñ∞ÂàÜÈÖçÁöÑÊ†àÂ∫ïÈÉ®ÔºåËøòÊèíÂÖ•‰∫Ü‰∏Ä‰∏™Âè´ÂÅölessstackÁöÑÂáΩÊï∞ÊåáÈíà„ÄÇËøô‰∏™ÂáΩÊï∞ËøòÊ≤°ÊúâË¢´Ë∞ÉÁî®„ÄÇËøôÊ†∑ËÆæÁΩÆÊòØ‰∏∫‰∫Ü‰ªéÂàöÊâçÈÄ†ÊàêÊ†àÁ©∫Èó¥‰∏çË∂≥ÁöÑÈÇ£‰∏™ÂáΩÊï∞ËøîÂõûÊó∂ÂÅöÂáÜÂ§áÁöÑ„ÄÇÂΩìÊàë‰ª¨‰ªéÈÇ£‰∏™ÂáΩÊï∞ËøîÂõûÊó∂ÔºåÂÆÉ‰ºöË∑≥ËΩ¨Âà∞lessstack„ÄÇlessstackÂáΩÊï∞‰ºöÊü•ÁúãÂú®Ê†àÂ∫ïÈÉ®Â≠òÊîæÁöÑÊï∞ÊçÆÁªìÊûÑÈáåÁöÑ‰ø°ÊÅØÔºåÁÑ∂ÂêéË∞ÉÊï¥Ê†àÊåáÈíàÔºàstack pointerÔºâ„ÄÇËøôÊ†∑Â∞±ÂÆåÊàê‰∫Ü‰ªéÊñ∞ÁöÑÊ†àÂùóÂà∞ËÄÅÁöÑÊ†àÂùóÁöÑË∑≥ËΩ¨„ÄÇÊé•‰∏ãÊù•ÔºåÊñ∞ÂàÜÈÖçÁöÑËøô‰∏™ÂùóÊ†àÁ©∫Èó¥Â∞±ÂèØ‰ª•Ë¢´ÈáäÊîæÊéâ‰∫Ü„ÄÇ ÂàÜÂùóÂºèÁöÑÊ†àËÆ©Êàë‰ª¨ËÉΩÂ§üÊåâÁÖßÈúÄÊ±ÇÊù•Êâ©Â±ïÂíåÊî∂Áº©Ê†àÁöÑÂ§ßÂ∞è„ÄÇ GoÂºÄÂèëËÄÖ‰∏çÈúÄË¶ÅËä±Á≤æÂäõÂéª‰º∞ËÆ°goroutine‰ºöÁî®Âà∞Â§öÂ§ßÁöÑÊ†à„ÄÇÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑgoroutineÁöÑÂºÄÈîÄ‰πü‰∏çÂ§ß„ÄÇÂΩì GoÂºÄÂèëËÄÖ‰∏çÁü•ÈÅìÊ†à‰ºöÊâ©Â±ïÂà∞Â§öÂ∞ëÂ§ßÊó∂ÔºåÂÆÉ‰πüËÉΩÂæàÂ•ΩÁöÑÂ§ÑÁêÜËøôÁßçÊÉÖÂÜµ„ÄÇ Ëøô‰∏ÄÁõ¥ÊòØ‰πãÂâçGoËØ≠Ë®ÄÁÆ°ÁêÜÊ†àÁöÑÁöÑÊñπÊ≥ï„ÄÇ‰ΩÜËøô‰∏™ÊñπÊ≥ïÊúâ‰∏Ä‰∏™ÈóÆÈ¢ò„ÄÇÁº©ÂáèÊ†àÁ©∫Èó¥ÊòØ‰∏Ä‰∏™ÂºÄÈîÄÁõ∏ÂØπËæÉÂ§ßÁöÑÊìç‰Ωú„ÄÇÂ¶ÇÊûúÂú®‰∏Ä‰∏™Âæ™ÁéØÈáåÊúâÊ†àÂàÜË£ÇÔºåÈÇ£‰πàÂÆÉÁöÑÂºÄÈîÄÂ∞±ÂèòÂæó‰∏çÂèØÂøΩÁï•‰∫Ü„ÄÇ‰∏Ä‰∏™ÂáΩÊï∞‰ºöÊâ©Â±ïÔºåÁÑ∂ÂêéÂàÜË£ÇÊ†à„ÄÇÂΩìÂÆÉËøîÂõûÁöÑÊó∂ÂÄôÂèà‰ºöÈáäÊîæ‰πãÂâçÂàÜÈÖçÁöÑÂÜÖÂ≠òÂùó„ÄÇÂ¶ÇÊûúËøô‰∫õÈÉΩÂèëÁîüÂú®‰∏Ä‰∏™Âæ™ÁéØÈáåÁöÑËØùÔºå‰ª£‰ª∑ÊòØÁõ∏ÂΩìÂ§ßÁöÑ„ÄÇ ËøôÂ∞±ÊòØÊâÄË∞ìÁöÑÁÉ≠ÂàÜË£ÇÈóÆÈ¢òÔºàhot split problemÔºâ„ÄÇÂÆÉÊòØGoËØ≠Ë®ÄÂºÄÂèëËÄÖÈÄâÊã©Êñ∞ÁöÑÊ†àÁÆ°ÁêÜÊñπÊ≥ïÁöÑ‰∏ªË¶ÅÂéüÂõ†„ÄÇÊñ∞ÁöÑÊñπÊ≥ïÂè´ÂÅöÊ†àÂ§çÂà∂Ê≥ïÔºàstack copyingÔºâ„ÄÇ Ê†àÂ§çÂà∂Ê≥ï‰∏ÄÂºÄÂßãÂíåÂàÜÂùóÂºèÁöÑÊ†àÂæàÂÉè„ÄÇÂΩìgoroutineËøêË°åÂπ∂Áî®ÂÆåÊ†àÁ©∫Èó¥ÁöÑÊó∂ÂÄôÔºå‰∏é‰πãÂâçÁöÑÊñπÊ≥ï‰∏ÄÊ†∑ÔºåÊ†àÊ∫¢Âá∫Ê£ÄÊü•‰ºöË¢´Ëß¶Âèë„ÄÇ‰ΩÜÊòØÔºå‰∏çÂÉè‰πãÂâçÁöÑÊñπÊ≥ïÈÇ£Ê†∑ÂàÜÈÖç‰∏Ä‰∏™Êñ∞ÁöÑÂÜÖÂ≠òÂùóÂπ∂ÈìæÊé•Âà∞ËÄÅÁöÑÊ†àÂÜÖÂ≠òÂùóÔºåÊñ∞ÁöÑÊñπÊ≥ï‰ºöÂàÜÈÖç‰∏Ä‰∏™‰∏§ÂÄçÂ§ßÁöÑÂÜÖÂ≠òÂùóÂπ∂ÊääËÄÅÁöÑÂÜÖÂ≠òÂùóÂÜÖÂÆπÂ§çÂà∂Âà∞Êñ∞ÁöÑÂÜÖÂ≠òÂùóÈáå„ÄÇËøôÊ†∑ÂÅöÊÑèÂë≥ÁùÄÂΩìÊ†àÁº©ÂáèÂõû‰πãÂâçÂ§ßÂ∞èÊó∂ÔºåÊàë‰ª¨‰∏çÈúÄË¶ÅÂÅö‰ªª‰Ωï‰∫ãÊÉÖ„ÄÇÊ†àÁöÑÁº©ÂáèÊ≤°Êúâ‰ªª‰Ωï‰ª£‰ª∑„ÄÇËÄå‰∏îÔºåÂΩìÊ†àÂÜçÊ¨°Êâ©Â±ïÊó∂ÔºåËøêË°åÁéØÂ¢É‰πü‰∏çÈúÄË¶ÅÂÜçÂÅö‰ªª‰Ωï‰∫ã„ÄÇÂÆÉÂèØ‰ª•ÈáçÁî®‰πãÂâçÂàÜÈÖçÁöÑÁ©∫Èó¥„ÄÇ Ê†àÁöÑÂ§çÂà∂Âê¨Ëµ∑Êù•ÂæàÂÆπÊòìÔºå‰ΩÜÂÆûÈôÖÊìç‰ΩúÂπ∂ÈùûÈÇ£‰πàÁÆÄÂçï„ÄÇÂ≠òÂÇ®Âú®Ê†à‰∏äÁöÑÂèòÈáèÁöÑÂú∞ÂùÄÂèØËÉΩÂ∑≤ÁªèË¢´‰ΩøÁî®Âà∞„ÄÇ‰πüÂ∞±ÊòØËØ¥Á®ãÂ∫è‰ΩøÁî®Âà∞‰∫Ü‰∏Ä‰∫õÊåáÂêëÊ†àÁöÑÊåáÈíà„ÄÇÂΩìÁßªÂä®Ê†àÁöÑÊó∂ÂÄôÔºåÊâÄÊúâÊåáÂêëÊ†àÈáåÂÜÖÂÆπÁöÑÊåáÈíàÈÉΩ‰ºöÂèòÂæóÊó†Êïà„ÄÇÁÑ∂ËÄåÔºåÊåáÂêëÊ†àÂÜÖÂÆπÁöÑÊåáÈíàËá™Ë∫´‰πüÂøÖÂÆöÊòØ‰øùÂ≠òÂú®Ê†à‰∏äÁöÑ„ÄÇËøôÊòØ‰∏∫‰∫Ü‰øùËØÅÂÜÖÂ≠òÂÆâÂÖ®ÁöÑÂøÖË¶ÅÊù°‰ª∂„ÄÇÂê¶Âàô‰∏Ä‰∏™Á®ãÂ∫èÂ∞±ÊúâÂèØËÉΩËÆøÈóÆ‰∏ÄÊÆµÂ∑≤ÁªèÊó†ÊïàÁöÑÊ†àÁ©∫Èó¥‰∫Ü„ÄÇ Âõ†‰∏∫ÂûÉÂúæÂõûÊî∂ÁöÑÈúÄË¶ÅÔºåÊàë‰ª¨ÂøÖÈ°ªÁü•ÈÅìÊ†àÁöÑÂì™‰∫õÈÉ®ÂàÜÊòØË¢´Áî®‰ΩúÊåáÈíà‰∫Ü„ÄÇÂΩìÊàë‰ª¨ÁßªÂä®Ê†àÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•Êõ¥Êñ∞Ê†àÈáåÁöÑÊåáÈíàËÆ©ÂÆÉ‰ª¨ÊåáÂêëÊñ∞ÁöÑÂú∞ÂùÄ„ÄÇÊâÄÊúâÁõ∏ÂÖ≥ÁöÑÊåáÈíàÈÉΩ‰ºöË¢´Êõ¥Êñ∞„ÄÇÊàë‰ª¨‰ΩøÁî®‰∫ÜÂûÉÂúæÂõûÊî∂ÁöÑ‰ø°ÊÅØÊù•Â§çÂà∂Ê†àÔºå‰ΩÜÂπ∂‰∏çÊòØ‰ªª‰Ωï‰ΩøÁî®Ê†àÁöÑÂáΩÊï∞ÈÉΩÊúâËøô‰∫õ‰ø°ÊÅØ„ÄÇÂõ†‰∏∫ÂæàÂ§ß‰∏ÄÈÉ®ÂàÜËøêË°åÁéØÂ¢ÉÊòØÁî®CËØ≠Ë®ÄÂÜôÁöÑÔºåÂæàÂ§öË¢´Ë∞ÉÁî®ÁöÑËøêË°åÁéØÂ¢ÉÈáåÁöÑÂáΩÊï∞Âπ∂Ê≤°ÊúâÊåáÈíàÁöÑ‰ø°ÊÅØÔºåÊâÄ‰ª•‰πüÂ∞±‰∏çËÉΩÂ§üË¢´Â§çÂà∂‰∫Ü„ÄÇÂΩìÈÅáÂà∞ËøôÁßçÊÉÖÂÜµÊó∂ÔºåÊàë‰ª¨Âè™ËÉΩÈÄÄÂõûÂà∞ÂàÜÂùóÂºèÁöÑÊ†àÂπ∂ÊîØ‰ªòÁõ∏Â∫îÁöÑÂºÄÈîÄ„ÄÇ Ëøô‰πüÊòØ‰∏∫‰ªÄ‰πàÁé∞Âú®ËøêË°åÁéØÂ¢ÉÁöÑÂºÄÂèëËÄÖÊ≠£Âú®Áî®GoËØ≠Ë®ÄÈáçÂÜôËøêË°åÁéØÂ¢ÉÁöÑÂ§ßÈÉ®ÂàÜ‰ª£Á†Å„ÄÇÊó†Ê≥ïÁî®GoËØ≠Ë®ÄÈáçÂÜôÁöÑÈÉ®ÂàÜÔºàÊØîÂ¶ÇË∞ÉÂ∫¶Âô®ÁöÑÊ†∏ÂøÉ‰ª£Á†ÅÂíåÂûÉÂúæÂõûÊî∂Âô®Ôºâ‰ºöÂú®ÁâπÊÆäÁöÑÊ†à‰∏äËøêË°å„ÄÇËøô‰∏™ÁâπÊÆäÊ†àÁöÑÂ§ßÂ∞èÁî±ËøêË°åÁéØÂ¢ÉÁöÑÂºÄÂèëËÄÖËÆæÁΩÆ„ÄÇ Ëøô‰∫õÊîπÂèòÈô§‰∫Ü‰ΩøÊ†àÂ§çÂà∂Êàê‰∏∫ÂèØËÉΩÔºåÂÆÉ‰πüÂÖÅËÆ∏Êàë‰ª¨Âú®Â∞ÜÊù•ÂÆûÁé∞Âπ∂Ë°åÂûÉÂúæÂõûÊî∂„ÄÇ Âè¶Â§ñ‰∏ÄÁßç‰∏çÂêåÁöÑÊ†àÂ§ÑÁêÜÊñπÂºèÂ∞±ÊòØÂú®ËôöÊãüÂÜÖÂ≠ò‰∏≠ÂàÜÈÖçÂ§ßÂÜÖÂ≠òÊÆµ„ÄÇÁî±‰∫éÁâ©ÁêÜÂÜÖÂ≠òÂè™ÊòØÂú®ÁúüÊ≠£‰ΩøÁî®Êó∂Êâç‰ºöË¢´ÂàÜÈÖçÔºåÂõ†Ê≠§ÁúãËµ∑Êù•Â•Ω‰ºº‰Ω†ÂèØ‰ª•ÂàÜÈÖç‰∏Ä‰∏™Â§ßÂÜÖÂ≠òÊÆµÂπ∂ËÆ©Êìç ‰ΩúÁ≥ªÁªüÂ§ÑÁêÜÂÆÉ„ÄÇ‰∏ãÈù¢ÊòØËøôÁßçÊñπÊ≥ïÁöÑ‰∏Ä‰∫õÈóÆÈ¢ò È¶ñÂÖàÔºå32‰ΩçÁ≥ªÁªüÂè™ËÉΩÊîØÊåÅ4GÂ≠óËäÇËôöÊãüÂÜÖÂ≠òÔºåÂπ∂‰∏îÂ∫îÁî®Âè™ËÉΩÁî®Âà∞ÂÖ∂‰∏≠ÁöÑ3GÁ©∫Èó¥„ÄÇÁî±‰∫éÂêåÊó∂ËøêË°åÁôæ‰∏ágoroutinesÁöÑÊÉÖÂÜµÂπ∂‰∏çÂ∞ëËßÅÔºåÂõ†Ê≠§‰Ω†ÂæàÂèØ ËÉΩÁî®ÂÖâËôöÊãüÂÜÖÂ≠òÔºåÂç≥‰æøÊàë‰ª¨ÂÅáËÆæÊØè‰∏™goroutineÁöÑstackÂè™Êúâ8K„ÄÇ Á¨¨‰∫åÔºåÁÑ∂ËÄåÊàë‰ª¨ÂèØ‰ª•Âú®64‰ΩçÁ≥ªÁªü‰∏≠ÂàÜÈÖçÂ§ßÂÜÖÂ≠òÔºåÂÆÉ‰æùËµñ‰∫éËøáÈáèÂÜÖÂ≠ò‰ΩøÁî®„ÄÇÊâÄË∞ìËøáÈáè‰ΩøÁî®ÊòØÊåáÂΩì‰Ω†ÂàÜÈÖçÁöÑÂÜÖÂ≠òÂ§ßÂ∞èË∂ÖÂá∫Áâ©ÁêÜÂÜÖÂ≠òÂ§ßÂ∞èÊó∂Ôºå‰æùËµñÊìç‰ΩúÁ≥ªÁªü‰øùËØÅ Âú®ÈúÄË¶ÅÊó∂ËÉΩÂ§üÂàÜÈÖçÂá∫Áâ©ÁêÜÂÜÖÂ≠ò„ÄÇÁÑ∂ËÄåÔºåÂÖÅËÆ∏ËøáÈáè‰ΩøÁî®ÂèØËÉΩ‰ºöÂØºËá¥‰∏Ä‰∫õÈ£éÈô©„ÄÇÁî±‰∫é‰∏Ä‰∫õËøõÁ®ãÂàÜÈÖç‰∫ÜË∂ÖÂá∫Êú∫Âô®Áâ©ÁêÜÂÜÖÂ≠òÂ§ßÂ∞èÁöÑÂÜÖÂ≠òÔºåÂ¶ÇÊûúËøô‰∫õËøõÁ®ã‰ΩøÁî®Êõ¥Â§öÂÜÖÂ≠ò Êó∂ÔºåÊìç‰ΩúÁ≥ªÁªüÂ∞Ü‰∏çÂæó‰∏ç‰∏∫ÂÆÉ‰ª¨Ë°•ÂÖÖÂàÜÈÖçÂÜÖÂ≠ò„ÄÇËøô‰ºöÂØºËá¥Êìç‰ΩúÁ≥ªÁªüÂ∞Ü‰∏Ä‰∫õÂÜÖÂ≠òÊÆµÊîæÂÖ•Á£ÅÁõòÁºìÂ≠òÔºåËøôÂ∏∏Â∏∏‰ºöÂ¢ûÂä†‰∏çÂèØÈ¢ÑÊµãÁöÑÂ§ÑÁêÜÂª∂Ëøü„ÄÇÊ≠£ÊòØËÄÉËôëÂà∞Ëøô‰∏™ÂéüÂõ†Ôºå‰∏Ä ‰∫õÊñ∞Á≥ªÁªüÂÖ≥Èó≠‰∫ÜÂØπËøáÈáè‰ΩøÁî®ÁöÑÊîØÊåÅ„ÄÇ 23. GoroutineÂíåChannelÁöÑ‰ΩúÁî®ÂàÜÂà´ÊòØ‰ªÄ‰πà?ËøõÁ®ãÊòØÂÜÖÂ≠òËµÑÊ∫êÁÆ°ÁêÜÂíåcpuË∞ÉÂ∫¶ÁöÑÊâßË°åÂçïÂÖÉ„ÄÇ‰∏∫‰∫ÜÊúâÊïàÂà©Áî®Â§öÊ†∏Â§ÑÁêÜÂô®ÁöÑ‰ºòÂäøÔºåÂ∞ÜËøõÁ®ãËøõ‰∏ÄÊ≠•ÁªÜÂàÜÔºåÂÖÅËÆ∏‰∏Ä‰∏™ËøõÁ®ãÈáåÂ≠òÂú®Â§ö‰∏™Á∫øÁ®ãÔºåËøôÂ§ö‰∏™Á∫øÁ®ãËøòÊòØÂÖ±‰∫´Âêå‰∏ÄÁâáÂÜÖÂ≠òÁ©∫Èó¥Ôºå‰ΩÜcpuË∞ÉÂ∫¶ÁöÑÊúÄÂ∞èÂçïÂÖÉÂèòÊàê‰∫ÜÁ∫øÁ®ã„ÄÇ ÈÇ£ÂçèÁ®ãÂèàÊòØ‰ªÄ‰πàÂë¢Ôºå‰ª•Âèä‰∏éÁ∫øÁ®ãÁöÑÂ∑ÆÂºÇÊÄß?? ÂçèÁ®ãÔºåÂèØ‰ª•Áúã‰ΩúÊòØËΩªÈáèÁ∫ßÁöÑÁ∫øÁ®ã„ÄÇ‰ΩÜ‰∏éÁ∫øÁ®ã‰∏çÂêåÁöÑÊòØÔºåÁ∫øÁ®ãÁöÑÂàáÊç¢ÊòØÁî±Êìç‰ΩúÁ≥ªÁªüÊéßÂà∂ÁöÑÔºåËÄåÂçèÁ®ãÁöÑÂàáÊç¢ÂàôÊòØÁî±Áî®Êà∑ÊéßÂà∂ÁöÑ„ÄÇ ÊúÄÊó©ÊîØÊåÅÂçèÁ®ãÁöÑÁ®ãÂ∫èËØ≠Ë®ÄÂ∫îËØ•ÊòØlispÊñπË®ÄschemeÈáåÁöÑcontinuationÔºàÁª≠Âª∂ÔºâÔºåÁª≠Âª∂ÂÖÅËÆ∏scheme‰øùÂ≠ò‰ªªÊÑèÂáΩÊï∞Ë∞ÉÁî®ÁöÑÁé∞Âú∫Ôºå‰øùÂ≠òËµ∑Êù•Âπ∂ÈáçÊñ∞ÊâßË°å„ÄÇLua,C#,pythonÁ≠âËØ≠Ë®Ä‰πüÊúâËá™Â∑±ÁöÑÂçèÁ®ãÂÆûÁé∞„ÄÇ Go‰∏≠ÁöÑgoroutinueÂ∞±ÊòØÂçèÁ®ã,ÂèØ‰ª•ÂÆûÁé∞Âπ∂Ë°åÔºåÂ§ö‰∏™ÂçèÁ®ãÂèØ‰ª•Âú®Â§ö‰∏™Â§ÑÁêÜÂô®ÂêåÊó∂Ë∑ë„ÄÇËÄåÂçèÁ®ãÂêå‰∏ÄÊó∂ÂàªÂè™ËÉΩÂú®‰∏Ä‰∏™Â§ÑÁêÜÂô®‰∏äË∑ëÔºàÂèØ‰ª•ÊääÂÆø‰∏ªËØ≠Ë®ÄÊÉ≥Ë±°ÊàêÂçïÁ∫øÁ®ãÁöÑÂ∞±Â•Ω‰∫ÜÔºâ„ÄÇ ÁÑ∂ËÄå,Â§ö‰∏™goroutine‰πãÈó¥ÁöÑÈÄö‰ø°ÊòØÈÄöËøáchannelÔºåËÄåÂçèÁ®ãÁöÑÈÄö‰ø°ÊòØÈÄöËøáyieldÂíåresume()Êìç‰Ωú„ÄÇ goroutineÈùûÂ∏∏ÁÆÄÂçïÔºåÂè™ÈúÄË¶ÅÂú®ÂáΩÊï∞ÁöÑË∞ÉÁî®ÂâçÈù¢Âä†ÂÖ≥ÈîÆÂ≠ógoÂç≥ÂèØÔºå‰æãÂ¶Ç: 1go elegance() Êàë‰ª¨‰πüÂèØ‰ª•ÂêØÂä®5‰∏™goroutinesÂàÜÂà´ÊâìÂç∞Á¥¢Âºï„ÄÇ 123456789func main() &#123; for i:=1;i&lt;5;i++ &#123; go func(i int) &#123; fmt.Println(i) &#125;(i) &#125; // ÂÅúÊ≠á5sÔºå‰øùËØÅÊâìÂç∞ÂÖ®ÈÉ®ÁªìÊùü time.Sleep(5*time.Second)&#125; Âú®ÂàÜÊûêgoroutineÊâßË°åÁöÑÈöèÊú∫ÊÄßÂíåÂπ∂ÂèëÊÄßÔºåÂêØÂä®‰∫Ü5‰∏™goroutineÔºåÂÜçÂä†‰∏ämainÂáΩÊï∞ÁöÑ‰∏ªgoroutineÔºåÊÄªÂÖ±Êúâ6‰∏™goroutines„ÄÇÁî±‰∫égoroutineÁ±ª‰ºº‰∫é‚ÄùÂÆàÊä§Á∫øÁ®ã‚ÄúÔºåÂºÇÊ≠•ÊâßË°åÁöÑ,Â¶ÇÊûú‰∏ªgoroutine‰∏çÁ≠âÂæÖÁâáÂàªÔºåÂèØËÉΩÁ®ãÂ∫èÂ∞±Ê≤°ÊúâËæìÂá∫ÊâìÂç∞‰∫Ü„ÄÇ Âú®Golang‰∏≠channelÂàôÊòØgoroutinues‰πãÈó¥ËøõË°åÈÄö‰ø°ÁöÑÊ∏†ÈÅì„ÄÇ ÂèØ‰ª•ÊäächannelÂΩ¢Ë±°ÊØîÂñª‰∏∫Â∑•ÂéÇÈáåÁöÑ‰º†ÈÄÅÂ∏¶,‰∏ÄÂ§¥ÁöÑÁîü‰∫ßËÄÖgoroutineÂæÄ‰º†ËæìÂ∏¶Êîæ‰∏úË•ø,Âè¶‰∏ÄÂ§¥ÁöÑÊ∂àË¥πËÄÖgoroutinueÂàô‰ªéËæìÈÄÅÂ∏¶Âèñ‰∏úË•ø„ÄÇchannelÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™ÊúâÁ±ªÂûãÁöÑÊ∂àÊÅØÈòüÂàó,ÈÅµÂæ™ÂÖàËøõÂÖàÂá∫ÁöÑÁâπÁÇπ„ÄÇ channelÁöÑÊìç‰ΩúÁ¨¶Âè∑ ch &lt;- data Ë°®Á§∫dataË¢´ÂèëÈÄÅÁªôchannel chÔºõ data &lt;- ch Ë°®Á§∫‰ªéchannel chÂèñ‰∏Ä‰∏™ÂÄºÔºåÁÑ∂ÂêéËµãÁªôdata„ÄÇ ÈòªÂ°ûÂºèchannel channelÈªòËÆ§ÊòØÊ≤°ÊúâÁºìÂÜ≤Âå∫ÁöÑÔºå‰πüÂ∞±ÊòØËØ¥ÔºåÈÄö‰ø°ÊòØÈòªÂ°ûÁöÑ„ÄÇsendÊìç‰ΩúÂøÖÈ°ªÁ≠âÂà∞ÊúâÊ∂àË¥πËÄÖacceptÊâçÁÆóÂÆåÊàê„ÄÇ Â∫îÁî®Á§∫‰æã: 1234567891011func main() &#123; ch1 := make(chan int) go pump(ch1) // pump hangs fmt.Println(&lt;-ch1) // prints only 1&#125;func pump(ch chan int) &#123; for i:= 1; ; i++ &#123; ch &lt;- i &#125;&#125; Âú®ÂáΩÊï∞pump()ÈáåÁöÑchannelÂú®Êé•ÂèóÂà∞Á¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÂêéÂ∞±Ë¢´ÈòªÂ°û‰∫ÜÔºåÁõ¥Âà∞‰∏ªgoroutinueÂèñËµ∞‰∫ÜÊï∞ÊçÆ„ÄÇÊúÄÁªàchannelÈòªÂ°ûÂú®Êé•ÂèóÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†ÔºåÁ®ãÂ∫èÂè™ÊâìÂç∞ 1„ÄÇ Ê≤°ÊúâÁºìÂÜ≤(buffer)ÁöÑchannelÂè™ËÉΩÂÆπÁ∫≥‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåËÄåÂ∏¶ÊúâÁºìÂÜ≤(buffer)channelÂàôÂèØ‰ª•ÈùûÈòªÂ°ûÂÆπÁ∫≥N‰∏™ÂÖÉÁ¥†„ÄÇÂèëÈÄÅÊï∞ÊçÆÂà∞ÁºìÂÜ≤(buffer) channel‰∏ç‰ºöË¢´ÈòªÂ°ûÔºåÈô§ÈùûchannelÂ∑≤Êª°ÔºõÂêåÊ†∑ÁöÑÔºå‰ªéÁºìÂÜ≤(buffer) channelÂèñÊï∞ÊçÆ‰πü‰∏ç‰ºöË¢´ÈòªÂ°ûÔºåÈô§ÈùûchannelÁ©∫‰∫Ü„ÄÇ 24. ÊÄé‰πàÊü•ÁúãGoroutineÁöÑÊï∞Èáè?GOMAXPROCS‰∏≠ÊéßÂà∂ÁöÑÊòØÊú™Ë¢´ÈòªÂ°ûÁöÑÊâÄÊúâGoroutine,ÂèØ‰ª•Ë¢´MultiplexÂà∞Â§öÂ∞ë‰∏™Á∫øÁ®ã‰∏äËøêË°å,ÈÄöËøáGOMAXPROCSÂèØ‰ª•Êü•ÁúãGoroutineÁöÑÊï∞Èáè„ÄÇ 25. ËØ¥‰∏ãGo‰∏≠ÁöÑÈîÅÊúâÂì™‰∫õ?‰∏âÁßçÈîÅÔºåËØªÂÜôÈîÅÔºå‰∫íÊñ•ÈîÅÔºåËøòÊúâmapÁöÑÂÆâÂÖ®ÁöÑÈîÅ?Go‰∏≠ÁöÑ‰∏âÁßçÈîÅÂåÖÊã¨:‰∫íÊñ•ÈîÅ,ËØªÂÜôÈîÅ,sync.MapÁöÑÂÆâÂÖ®ÁöÑÈîÅ. ‰∫íÊñ•ÈîÅ GoÂπ∂ÂèëÁ®ãÂ∫èÂØπÂÖ±‰∫´ËµÑÊ∫êËøõË°åËÆøÈóÆÊéßÂà∂ÁöÑ‰∏ªË¶ÅÊâãÊÆµÔºåÁî±Ê†áÂáÜÂ∫ì‰ª£Á†ÅÂåÖ‰∏≠sync‰∏≠ÁöÑMutexÁªìÊûÑ‰ΩìË°®Á§∫„ÄÇ 12345//Mutex ÊòØ‰∫íÊñ•ÈîÅÔºå Èõ∂ÂÄºÊòØËß£ÈîÅÁöÑ‰∫íÊñ•ÈîÅÔºå È¶ñÊ¨°‰ΩøÁî®Âêé‰∏çÂæóÂ§çÂà∂‰∫íÊñ•ÈîÅ„ÄÇtype Mutex struct &#123; state int32 sema uint32&#125; sync.MutexÂåÖ‰∏≠ÁöÑÁ±ªÂûãÂè™Êúâ‰∏§‰∏™ÂÖ¨ÂºÄÁöÑÊåáÈíàÊñπÊ≥ïLockÂíåUnlock„ÄÇ 12345678910111213141516//LockerË°®Á§∫ÂèØ‰ª•ÈîÅÂÆöÂíåËß£ÈîÅÁöÑÂØπË±°„ÄÇtype Locker interface &#123; Lock() Unlock()&#125;//ÈîÅÂÆöÂΩìÂâçÁöÑ‰∫íÊñ•Èáè//Â¶ÇÊûúÈîÅÂ∑≤Ë¢´‰ΩøÁî®ÔºåÂàôË∞ÉÁî®goroutine//ÈòªÂ°ûÁõ¥Âà∞‰∫íÊñ•ÈîÅÂèØÁî®„ÄÇfunc (m *Mutex) Lock() //ÂØπÂΩìÂâç‰∫íÊñ•ÈáèËøõË°åËß£ÈîÅ//Â¶ÇÊûúÂú®ËøõÂÖ•Ëß£ÈîÅÊó∂Êú™ÈîÅÂÆömÔºåÂàô‰∏∫ËøêË°åÊó∂ÈîôËØØ„ÄÇ//ÈîÅÂÆöÁöÑ‰∫íÊñ•ÈîÅ‰∏éÁâπÂÆöÁöÑgoroutineÊó†ÂÖ≥„ÄÇ//ÂÖÅËÆ∏‰∏Ä‰∏™goroutineÈîÅÂÆöMutexÁÑ∂ÂêéÂÆâÊéíÂè¶‰∏Ä‰∏™goroutineÊù•Ëß£ÈîÅÂÆÉ„ÄÇfunc (m *Mutex) Unlock() Â£∞Êòé‰∏Ä‰∏™‰∫íÊñ•ÈîÅÔºö 1var mutex sync.Mutex ‰∏çÂÉèCÊàñJavaÁöÑÈîÅÁ±ªÂ∑•ÂÖ∑ÔºåÊàë‰ª¨ÂèØËÉΩ‰ºöÁäØ‰∏Ä‰∏™ÈîôËØØÔºöÂøòËÆ∞ÂèäÊó∂Ëß£ÂºÄÂ∑≤Ë¢´ÈîÅ‰ΩèÁöÑÈîÅÔºå‰ªéËÄåÂØºËá¥ÊµÅÁ®ãÂºÇÂ∏∏„ÄÇ‰ΩÜGoÁî±‰∫éÂ≠òÂú®deferÔºåÊâÄ‰ª•Ê≠§Á±ªÈóÆÈ¢òÂá∫Áé∞ÁöÑÊ¶ÇÁéáÊûÅ‰Ωé„ÄÇÂÖ≥‰∫édeferËß£ÈîÅÁöÑÊñπÂºèÂ¶Ç‰∏ãÔºö 12345var mutex sync.Mutexfunc Write() &#123; mutex.Lock() defer mutex.Unlock()&#125; Â¶ÇÊûúÂØπ‰∏Ä‰∏™Â∑≤Áªè‰∏äÈîÅÁöÑÂØπË±°ÂÜçÊ¨°‰∏äÈîÅÔºåÈÇ£‰πàÂ∞±‰ºöÂØºËá¥ËØ•ÈîÅÂÆöÊìç‰ΩúË¢´ÈòªÂ°ûÔºåÁõ¥Âà∞ËØ•‰∫íÊñ•ÈîÅÂõûÂà∞Ë¢´Ëß£ÈîÅÁä∂ÊÄÅ. 12345678910111213141516171819202122232425262728fpackage mainimport ( &quot;fmt&quot; &quot;sync&quot; &quot;time&quot;)func main() &#123; var mutex sync.Mutex fmt.Println(&quot;begin lock&quot;) mutex.Lock() fmt.Println(&quot;get locked&quot;) for i := 1; i &lt;= 3; i++ &#123; go func(i int) &#123; fmt.Println(&quot;begin lock &quot;, i) mutex.Lock() fmt.Println(&quot;get locked &quot;, i) &#125;(i) &#125; time.Sleep(time.Second) fmt.Println(&quot;Unlock the lock&quot;) mutex.Unlock() fmt.Println(&quot;get unlocked&quot;) time.Sleep(time.Second)&#125; Êàë‰ª¨Âú®forÂæ™ÁéØ‰πãÂâçÂºÄÂßãÂä†ÈîÅÔºåÁÑ∂ÂêéÂú®ÊØè‰∏ÄÊ¨°Âæ™ÁéØ‰∏≠ÂàõÂª∫‰∏Ä‰∏™ÂçèÁ®ãÔºåÂπ∂ÂØπÂÖ∂Âä†ÈîÅÔºå‰ΩÜÊòØÁî±‰∫é‰πãÂâçÂ∑≤ÁªèÂä†ÈîÅ‰∫ÜÔºåÊâÄ‰ª•Ëøô‰∏™forÂæ™ÁéØ‰∏≠ÁöÑÂä†ÈîÅ‰ºöÈô∑ÂÖ•ÈòªÂ°ûÁõ¥Âà∞main‰∏≠ÁöÑÈîÅË¢´Ëß£ÈîÅÔºå time.Sleep(time.Second) ÊòØ‰∏∫‰∫ÜËÉΩËÆ©Á≥ªÁªüÊúâË∂≥Â§üÁöÑÊó∂Èó¥ËøêË°åforÂæ™ÁéØÔºåËæìÂá∫ÁªìÊûúÂ¶Ç‰∏ãÔºö 123456789&gt; go run mutex.go begin lockget lockedbegin lock 3begin lock 1begin lock 2Unlock the lockget unlockedget locked 3 ËøôÈáåÂèØ‰ª•ÁúãÂà∞Ëß£ÈîÅÂêéÔºå‰∏â‰∏™ÂçèÁ®ã‰ºöÈáçÊñ∞Êä¢Â§∫‰∫íÊñ•ÈîÅÊùÉÔºåÊúÄÁªàÂçèÁ®ã3Ëé∑ËÉú„ÄÇ ‰∫íÊñ•ÈîÅÈîÅÂÆöÊìç‰ΩúÁöÑÈÄÜÊìç‰ΩúÂπ∂‰∏ç‰ºöÂØºËá¥ÂçèÁ®ãÈòªÂ°ûÔºå‰ΩÜÊòØÊúâÂèØËÉΩÂØºËá¥ÂºïÂèë‰∏Ä‰∏™Êó†Ê≥ïÊÅ¢Â§çÁöÑËøêË°åÊó∂ÁöÑpanicÔºåÊØîÂ¶ÇÂØπ‰∏Ä‰∏™Êú™ÈîÅÂÆöÁöÑ‰∫íÊñ•ÈîÅËøõË°åËß£ÈîÅÊó∂Â∞±‰ºöÂèëÁîüpanic„ÄÇÈÅøÂÖçËøôÁßçÊÉÖÂÜµÁöÑÊúÄÊúâÊïàÊñπÂºèÂ∞±ÊòØ‰ΩøÁî®defer„ÄÇ Êàë‰ª¨Áü•ÈÅìÂ¶ÇÊûúÈÅáÂà∞panicÔºåÂèØ‰ª•‰ΩøÁî®recoverÊñπÊ≥ïËøõË°åÊÅ¢Â§çÔºå‰ΩÜÊòØÂ¶ÇÊûúÂØπÈáçÂ§çËß£ÈîÅ‰∫íÊñ•ÈîÅÂºïÂèëÁöÑpanicÂç¥ÊòØÊó†Áî®ÁöÑÔºàGo 1.8Âèä‰ª•ÂêéÔºâ„ÄÇ 123456789101112131415161718192021222324package mainimport ( &quot;fmt&quot; &quot;sync&quot;)func main() &#123; defer func() &#123; fmt.Println(&quot;Try to recover the panic&quot;) if p := recover(); p != nil &#123; fmt.Println(&quot;recover the panic : &quot;, p) &#125; &#125;() var mutex sync.Mutex fmt.Println(&quot;begin lock&quot;) mutex.Lock() fmt.Println(&quot;get locked&quot;) fmt.Println(&quot;unlock lock&quot;) mutex.Unlock() fmt.Println(&quot;lock is unlocked&quot;) fmt.Println(&quot;unlock lock again&quot;) mutex.Unlock()&#125; ËøêË°å: 12345678910111213141516171819202122&gt; go run mutex.go begin lockget lockedunlock locklock is unlockedunlock lock againfatal error: sync: unlock of unlocked mutexgoroutine 1 [running]:runtime.throw(0x4bc1a8, 0x1e) /home/keke/soft/go/src/runtime/panic.go:617 +0x72 fp=0xc000084ea8 sp=0xc000084e78 pc=0x427ba2sync.throw(0x4bc1a8, 0x1e) /home/keke/soft/go/src/runtime/panic.go:603 +0x35 fp=0xc000084ec8 sp=0xc000084ea8 pc=0x427b25sync.(*Mutex).Unlock(0xc00001a0c8) /home/keke/soft/go/src/sync/mutex.go:184 +0xc1 fp=0xc000084ef0 sp=0xc000084ec8 pc=0x45f821main.main() /home/keke/go/Test/mutex.go:25 +0x25f fp=0xc000084f98 sp=0xc000084ef0 pc=0x486c1fruntime.main() /home/keke/soft/go/src/runtime/proc.go:200 +0x20c fp=0xc000084fe0 sp=0xc000084f98 pc=0x4294ecruntime.goexit() /home/keke/soft/go/src/runtime/asm_amd64.s:1337 +0x1 fp=0xc000084fe8 sp=0xc000084fe0 pc=0x450ad1exit status 2 ËøôÈáåËØïÂõæÂØπÈáçÂ§çËß£ÈîÅÂºïÂèëÁöÑpanicËøõË°årecoverÔºå‰ΩÜÊòØÊàë‰ª¨ÂèëÁé∞Êìç‰ΩúÂ§±Ë¥•ÔºåËôΩÁÑ∂‰∫íÊñ•ÈîÅÂèØ‰ª•Ë¢´Â§ö‰∏™ÂçèÁ®ãÂÖ±‰∫´Ôºå‰ΩÜËøòÊòØÂª∫ËÆÆÂ∞ÜÂØπÂêå‰∏Ä‰∏™‰∫íÊñ•ÈîÅÁöÑÂä†ÈîÅËß£ÈîÅÊìç‰ΩúÊîæÂú®Âêå‰∏Ä‰∏™Â±ÇÊ¨°ÁöÑ‰ª£Á†Å‰∏≠„ÄÇ ËØªÂÜôÈîÅ ËØªÂÜôÈîÅÊòØÈíàÂØπËØªÂÜôÊìç‰ΩúÁöÑ‰∫íÊñ•ÈîÅÔºåÂèØ‰ª•ÂàÜÂà´ÈíàÂØπËØªÊìç‰Ωú‰∏éÂÜôÊìç‰ΩúËøõË°åÈîÅÂÆöÂíåËß£ÈîÅÊìç‰Ωú „ÄÇ ËØªÂÜôÈîÅÁöÑËÆøÈóÆÊéßÂà∂ËßÑÂàôÂ¶Ç‰∏ãÔºö ‚ë† Â§ö‰∏™ÂÜôÊìç‰Ωú‰πãÈó¥ÊòØ‰∫íÊñ•ÁöÑ ‚ë° ÂÜôÊìç‰Ωú‰∏éËØªÊìç‰Ωú‰πãÈó¥‰πüÊòØ‰∫íÊñ•ÁöÑ ‚ë¢ Â§ö‰∏™ËØªÊìç‰Ωú‰πãÈó¥‰∏çÊòØ‰∫íÊñ•ÁöÑ Âú®ËøôÊ†∑ÁöÑÊéßÂà∂ËßÑÂàô‰∏ãÔºåËØªÂÜôÈîÅÂèØ‰ª•Â§ßÂ§ßÈôç‰ΩéÊÄßËÉΩÊçüËÄó„ÄÇ Âú®GoÁöÑÊ†áÂáÜÂ∫ì‰ª£Á†ÅÂåÖ‰∏≠sync‰∏≠ÁöÑRWMutexÁªìÊûÑ‰ΩìË°®Á§∫‰∏∫: 123456789101112// RWMutexÊòØ‰∏Ä‰∏™ËØª/ÂÜô‰∫íÊñ•ÈîÅÔºåÂèØ‰ª•Áî±‰ªªÊÑèÊï∞ÈáèÁöÑËØªÊìç‰ΩúÊàñÂçï‰∏™ÂÜôÊìç‰ΩúÊåÅÊúâ„ÄÇ// RWMutexÁöÑÈõ∂ÂÄºÊòØÊú™ÈîÅÂÆöÁöÑ‰∫íÊñ•ÈîÅ„ÄÇ//È¶ñÊ¨°‰ΩøÁî®ÂêéÔºå‰∏çÂæóÂ§çÂà∂RWMutex„ÄÇ//Â¶ÇÊûúgoroutineÊåÅÊúâRWMutexËøõË°åËØªÂèñËÄåÂè¶‰∏Ä‰∏™goroutineÂèØËÉΩ‰ºöË∞ÉÁî®LockÔºåÈÇ£‰πàÂú®ÈáäÊîæÂàùÂßãËØªÈîÅ‰πãÂâçÔºågoroutine‰∏çÂ∫îËØ•ÊúüÊúõËÉΩÂ§üËé∑ÂèñËØªÈîÅÂÆö„ÄÇ //ÁâπÂà´ÊòØÔºåËøôÁßçÁ¶ÅÊ≠¢ÈÄíÂΩíËØªÈîÅÂÆö„ÄÇ ËøôÊòØ‰∏∫‰∫ÜÁ°Æ‰øùÈîÅÊúÄÁªàÂèòÂæóÂèØÁî®; ÈòªÊ≠¢ÁöÑÈîÅÂÆö‰ºöÈòªÊ≠¢Êñ∞ËØªÊìç‰ΩúËé∑ÂèñÈîÅÂÆö„ÄÇtype RWMutex struct &#123; w Mutex //Â¶ÇÊûúÊúâÂæÖÂ§ÑÁêÜÁöÑÂÜôÊìç‰ΩúÂ∞±ÊåÅÊúâ writerSem uint32 // ÂÜôÊìç‰ΩúÁ≠âÂæÖËØªÊìç‰ΩúÂÆåÊàêÁöÑ‰ø°Âè∑Èáè readerSem uint32 //ËØªÊìç‰ΩúÁ≠âÂæÖÂÜôÊìç‰ΩúÂÆåÊàêÁöÑ‰ø°Âè∑Èáè readerCount int32 // ÂæÖÂ§ÑÁêÜÁöÑËØªÊìç‰ΩúÊï∞Èáè readerWait int32 // number of departing readers&#125; sync‰∏≠ÁöÑRWMutexÊúâ‰ª•‰∏ãÂá†ÁßçÊñπÊ≥ïÔºö 1234567891011//ÂØπËØªÊìç‰ΩúÁöÑÈîÅÂÆöfunc (rw *RWMutex) RLock()//ÂØπËØªÊìç‰ΩúÁöÑËß£ÈîÅfunc (rw *RWMutex) RUnlock()//ÂØπÂÜôÊìç‰ΩúÁöÑÈîÅÂÆöfunc (rw *RWMutex) Lock()//ÂØπÂÜôÊìç‰ΩúÁöÑËß£ÈîÅfunc (rw *RWMutex) Unlock()//ËøîÂõû‰∏Ä‰∏™ÂÆûÁé∞‰∫Üsync.LockerÊé•Âè£Á±ªÂûãÁöÑÂÄºÔºåÂÆûÈôÖ‰∏äÊòØÂõûË∞Érw.RLock and rw.RUnlock.func (rw *RWMutex) RLocker() Locker UnlockÊñπÊ≥ï‰ºöËØïÂõæÂî§ÈÜíÊâÄÊúâÊÉ≥ËøõË°åËØªÈîÅÂÆöËÄåË¢´ÈòªÂ°ûÁöÑÂçèÁ®ãÔºåËÄå RUnlockÊñπÊ≥ïÂè™‰ºöÂú®Â∑≤Êó†‰ªª‰ΩïËØªÈîÅÂÆöÁöÑÊÉÖÂÜµ‰∏ãÔºåËØïÂõæÂî§ÈÜí‰∏Ä‰∏™Âõ†Ê¨≤ËøõË°åÂÜôÈîÅÂÆöËÄåË¢´ÈòªÂ°ûÁöÑÂçèÁ®ã„ÄÇËã•ÂØπ‰∏Ä‰∏™Êú™Ë¢´ÂÜôÈîÅÂÆöÁöÑËØªÂÜôÈîÅËøõË°åÂÜôËß£ÈîÅÔºåÂ∞±‰ºöÂºïÂèë‰∏Ä‰∏™‰∏çÂèØÊÅ¢Â§çÁöÑpanicÔºåÂêåÁêÜÂØπ‰∏Ä‰∏™Êú™Ë¢´ËØªÈîÅÂÆöÁöÑËØªÂÜôÈîÅËøõË°åËØªÂÜôÈîÅ‰πü‰ºöÂ¶ÇÊ≠§„ÄÇ Áî±‰∫éËØªÂÜôÈîÅÊéßÂà∂‰∏ãÁöÑÂ§ö‰∏™ËØªÊìç‰Ωú‰πãÈó¥‰∏çÊòØ‰∫íÊñ•ÁöÑÔºåÂõ†Ê≠§ÂØπ‰∫éËØªËß£ÈîÅÊõ¥ÂÆπÊòìË¢´ÂøΩËßÜ„ÄÇÂØπ‰∫éÂêå‰∏Ä‰∏™ËØªÂÜôÈîÅÔºåÊ∑ªÂä†Â§öÂ∞ë‰∏™ËØªÈîÅÂÆöÔºåÂ∞±ÂøÖË¶ÅÊúâÁ≠âÈáèÁöÑËØªËß£ÈîÅÔºåËøôÊ†∑ÊâçËÉΩÂÖ∂‰ªñÂçèÁ®ãÊúâÊú∫‰ºöËøõË°åÊìç‰Ωú„ÄÇ 1234567891011121314151617181920212223242526package mainimport ( &quot;fmt&quot; &quot;sync&quot; &quot;time&quot;)func main() &#123; var rwm sync.RWMutex for i := 0; i &lt; 5; i++ &#123; go func(i int) &#123; fmt.Println(&quot;try to lock read &quot;, i) rwm.RLock() fmt.Println(&quot;get locked &quot;, i) time.Sleep(time.Second * 2) fmt.Println(&quot;try to unlock for reading &quot;, i) rwm.RUnlock() fmt.Println(&quot;unlocked for reading &quot;, i) &#125;(i) &#125; time.Sleep(time.Millisecond * 1000) fmt.Println(&quot;try to lock for writing&quot;) rwm.Lock() fmt.Println(&quot;locked for writing&quot;)&#125; ËøêË°å: 1234567891011121314151617181920212223&gt; go run rwmutex.go try to lock read 0get locked 0try to lock read 4get locked 4try to lock read 3get locked 3try to lock read 1get locked 1try to lock read 2get locked 2try to lock for writingtry to unlock for reading 0unlocked for reading 0try to unlock for reading 2unlocked for reading 2try to unlock for reading 1unlocked for reading 1try to unlock for reading 3unlocked for reading 3try to unlock for reading 4unlocked for reading 4locked for writing ËøôÈáåÂèØ‰ª•ÁúãÂà∞ÂàõÂª∫‰∫Ü‰∫î‰∏™ÂçèÁ®ãÁî®‰∫éÂØπËØªÂÜôÈîÅÁöÑËØªÈîÅÂÆö‰∏éËØªËß£ÈîÅÊìç‰Ωú„ÄÇÂú® rwm.Lock()Áßç‰ºöÂØπmain‰∏≠ÂçèÁ®ãËøõË°åÂÜôÈîÅÂÆöÔºå‰ΩÜÊòØforÂæ™ÁéØ‰∏≠ÁöÑËØªËß£ÈîÅÂ∞öÊú™ÂÆåÊàêÔºåÂõ†Ê≠§‰ºöÈÄ†Êàêmian‰∏≠ÁöÑÂçèÁ®ãÈòªÂ°û„ÄÇÂΩìforÂæ™ÁéØ‰∏≠ÁöÑËØªËß£ÈîÅÊìç‰ΩúÈÉΩÂÆåÊàêÂêéÂ∞±‰ºöËØïÂõæÂî§ÈÜímain‰∏≠ÈòªÂ°ûÁöÑÂçèÁ®ãÔºåmain‰∏≠ÁöÑÂÜôÈîÅÂÆöÊâç‰ºöÂÆåÊàê„ÄÇ sync.MapÂÆâÂÖ®ÈîÅ golang‰∏≠ÁöÑsync.MapÊòØÂπ∂ÂèëÂÆâÂÖ®ÁöÑÔºåÂÖ∂ÂÆû‰πüÂ∞±ÊòØsyncÂåÖ‰∏≠golangËá™ÂÆö‰πâÁöÑ‰∏Ä‰∏™ÂêçÂè´MapÁöÑÁªìÊûÑ‰Ωì„ÄÇ Â∫îÁî®Á§∫‰æã: 1234567891011121314151617181920212223242526272829303132package mainimport ( &quot;sync&quot; &quot;fmt&quot;)func main() &#123; //ÂºÄÁÆ±Âç≥Áî® var sm sync.Map //store ÊñπÊ≥ï,Ê∑ªÂä†ÂÖÉÁ¥† sm.Store(1,&quot;a&quot;) //Load ÊñπÊ≥ïÔºåËé∑Âæóvalue if v,ok:=sm.Load(1);ok&#123; fmt.Println(v) &#125; //LoadOrStoreÊñπÊ≥ïÔºåËé∑ÂèñÊàñËÄÖ‰øùÂ≠ò //ÂèÇÊï∞ÊòØ‰∏ÄÂØπkeyÔºövalueÔºåÂ¶ÇÊûúËØ•keyÂ≠òÂú®‰∏îÊ≤°ÊúâË¢´Ê†áËÆ∞Âà†Èô§ÂàôËøîÂõûÂéüÂÖàÁöÑvalueÔºà‰∏çÊõ¥Êñ∞ÔºâÂíåtrueÔºõ‰∏çÂ≠òÂú®ÂàôstoreÔºåËøîÂõûËØ•value Âíåfalse if vv,ok:=sm.LoadOrStore(1,&quot;c&quot;);ok&#123; fmt.Println(vv) &#125; if vv,ok:=sm.LoadOrStore(2,&quot;c&quot;);!ok&#123; fmt.Println(vv) &#125; //ÈÅçÂéÜËØ•mapÔºåÂèÇÊï∞ÊòØ‰∏™ÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞ÂèÇÁöÑ‰∏§‰∏™ÂèÇÊï∞ÊòØÈÅçÂéÜËé∑ÂæóÁöÑkeyÂíåvalueÔºåËøîÂõû‰∏Ä‰∏™boolÂÄºÔºåÂΩìËøîÂõûfalseÊó∂ÔºåÈÅçÂéÜÁ´ãÂàªÁªìÊùü„ÄÇ sm.Range(func(k,v interface&#123;&#125;)bool&#123; fmt.Print(k) fmt.Print(&quot;:&quot;) fmt.Print(v) fmt.Println() return true &#125;)&#125; ËøêË°å : 12345aac1:a2:c sync.MapÁöÑÊï∞ÊçÆÁªìÊûÑ: 12345678910 type Map struct &#123; // ËØ•ÈîÅÁî®Êù•‰øùÊä§dirty mu Mutex // Â≠òËØªÁöÑÊï∞ÊçÆÔºåÂõ†‰∏∫ÊòØatomic.valueÁ±ªÂûãÔºåÂè™ËØªÁ±ªÂûãÔºåÊâÄ‰ª•ÂÆÉÁöÑËØªÊòØÂπ∂ÂèëÂÆâÂÖ®ÁöÑ read atomic.Value // readOnly //ÂåÖÂê´ÊúÄÊñ∞ÁöÑÂÜôÂÖ•ÁöÑÊï∞ÊçÆÔºåÂπ∂‰∏îÂú®ÂÜôÁöÑÊó∂ÂÄôÔºå‰ºöÊääread ‰∏≠Êú™Ë¢´Âà†Èô§ÁöÑÊï∞ÊçÆÊã∑Ë¥ùÂà∞ËØ•dirty‰∏≠ÔºåÂõ†‰∏∫ÊòØÊôÆÈÄöÁöÑmapÂ≠òÂú®Âπ∂ÂèëÂÆâÂÖ®ÈóÆÈ¢òÔºåÈúÄË¶ÅÁî®Âà∞‰∏äÈù¢ÁöÑmuÂ≠óÊÆµ„ÄÇ dirty map[interface&#123;&#125;]*entry // ‰ªéreadËØªÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºå‰ºöÂ∞ÜËØ•Â≠óÊÆµ+1ÔºåÂΩìÁ≠â‰∫élenÔºàdirtyÔºâÁöÑÊó∂ÂÄôÔºå‰ºöÂ∞ÜdirtyÊã∑Ë¥ùÂà∞read‰∏≠Ôºà‰ªéËÄåÊèêÂçáËØªÁöÑÊÄßËÉΩÔºâ„ÄÇ misses int&#125; readÁöÑÊï∞ÊçÆÁªìÊûÑÊòØÔºö 12345type readOnly struct &#123; m map[interface&#123;&#125;]*entry // Â¶ÇÊûúMap.dirtyÁöÑÊï∞ÊçÆÂíåm ‰∏≠ÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄÊ†∑ÊòØ‰∏∫true amended bool &#125; entryÁöÑÊï∞ÊçÆÁªìÊûÑÔºö 1234type entry struct &#123; //ÂèØËßÅvalueÊòØ‰∏™ÊåáÈíàÁ±ªÂûãÔºåËôΩÁÑ∂readÂíådirtyÂ≠òÂú®ÂÜó‰ΩôÊÉÖÂÜµÔºàamended=falseÔºâÔºå‰ΩÜÊòØÁî±‰∫éÊòØÊåáÈíàÁ±ªÂûãÔºåÂ≠òÂÇ®ÁöÑÁ©∫Èó¥Â∫îËØ•‰∏çÊòØÈóÆÈ¢ò p unsafe.Pointer // *interface&#123;&#125;&#125; Delete ÊñπÊ≥ï: 1234567891011121314151617181920212223242526272829303132func (m *Map) Delete(key interface&#123;&#125;) &#123; read, _ := m.read.Load().(readOnly) e, ok := read.m[key] //Â¶ÇÊûúread‰∏≠Ê≤°ÊúâÔºåÂπ∂‰∏îdirty‰∏≠ÊúâÊñ∞ÂÖÉÁ¥†ÔºåÈÇ£‰πàÂ∞±Âéªdirty‰∏≠ÂéªÊâæ if !ok &amp;&amp; read.amended &#123; m.mu.Lock() //ËøôÊòØÂèåÊ£ÄÊü•Ôºà‰∏äÈù¢ÁöÑifÂà§Êñ≠ÂíåÈîÅ‰∏çÊòØ‰∏Ä‰∏™ÂéüÂ≠êÊÄßÊìç‰ΩúÔºâ read, _ = m.read.Load().(readOnly) e, ok = read.m[key] if !ok &amp;&amp; read.amended &#123; //Áõ¥Êé•Âà†Èô§ delete(m.dirty, key) &#125; m.mu.Unlock() &#125; if ok &#123; //Â¶ÇÊûúread‰∏≠Â≠òÂú®ËØ•keyÔºåÂàôÂ∞ÜËØ•value ËµãÂÄºnilÔºàÈááÁî®Ê†áËÆ∞ÁöÑÊñπÂºèÂà†Èô§ÔºÅÔºâ e.delete() &#125;&#125;func (e *entry) delete() (hadValue bool) &#123; for &#123; p := atomic.LoadPointer(&amp;e.p) if p == nil || p == expunged &#123; return false &#125; if atomic.CompareAndSwapPointer(&amp;e.p, p, nil) &#123; return true &#125; &#125;&#125; Store ÊñπÊ≥ï: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788func (m *Map) Store(key, value interface&#123;&#125;) &#123; // Â¶ÇÊûúm.readÂ≠òÂú®Ëøô‰∏™keyÔºåÂπ∂‰∏îÊ≤°ÊúâË¢´Ê†áËÆ∞Âà†Èô§ÔºåÂàôÂ∞ùËØïÊõ¥Êñ∞„ÄÇ read, _ := m.read.Load().(readOnly) if e, ok := read.m[key]; ok &amp;&amp; e.tryStore(&amp;value) &#123; return &#125; // Â¶ÇÊûúread‰∏çÂ≠òÂú®ÊàñËÄÖÂ∑≤ÁªèË¢´Ê†áËÆ∞Âà†Èô§ m.mu.Lock() read, _ = m.read.Load().(readOnly) if e, ok := read.m[key]; ok &#123; //Â¶ÇÊûúentryË¢´Ê†áËÆ∞expungeÔºåÂàôË°®ÊòédirtyÊ≤°ÊúâkeyÔºåÂèØÊ∑ªÂä†ÂÖ•dirtyÔºåÂπ∂Êõ¥Êñ∞entry if e.unexpungeLocked() &#123; //Âä†ÂÖ•dirty‰∏≠ m.dirty[key] = e &#125; //Êõ¥Êñ∞valueÂÄº e.storeLocked(&amp;value) //dirty Â≠òÂú®ËØ•keyÔºåÊõ¥Êñ∞ &#125; else if e, ok := m.dirty[key]; ok &#123; e.storeLocked(&amp;value) //read ÂíådirtyÈÉΩÊ≤°ÊúâÔºåÊñ∞Ê∑ªÂä†‰∏ÄÊù° &#125; else &#123; //dirty‰∏≠Ê≤°ÊúâÊñ∞ÁöÑÊï∞ÊçÆÔºåÂæÄdirty‰∏≠Â¢ûÂä†Á¨¨‰∏Ä‰∏™Êñ∞ÈîÆ if !read.amended &#123; //Â∞Üread‰∏≠Êú™Âà†Èô§ÁöÑÊï∞ÊçÆÂä†ÂÖ•Âà∞dirty‰∏≠ m.dirtyLocked() m.read.Store(readOnly&#123;m: read.m, amended: true&#125;) &#125; m.dirty[key] = newEntry(value) &#125; m.mu.Unlock()&#125;//Â∞Üread‰∏≠Êú™Âà†Èô§ÁöÑÊï∞ÊçÆÂä†ÂÖ•Âà∞dirty‰∏≠func (m *Map) dirtyLocked() &#123; if m.dirty != nil &#123; return &#125; read, _ := m.read.Load().(readOnly) m.dirty = make(map[interface&#123;&#125;]*entry, len(read.m)) //readÂ¶ÇÊûúËæÉÂ§ßÁöÑËØùÔºåÂèØËÉΩÂΩ±ÂìçÊÄßËÉΩ for k, e := range read.m &#123; //ÈÄöËøáÊ≠§Ê¨°Êìç‰ΩúÔºådirty‰∏≠ÁöÑÂÖÉÁ¥†ÈÉΩÊòØÊú™Ë¢´Âà†Èô§ÁöÑÔºåÂèØËßÅexpungeÁöÑÂÖÉÁ¥†‰∏çÂú®dirty‰∏≠ if !e.tryExpungeLocked() &#123; m.dirty[k] = e &#125; &#125;&#125;//Âà§Êñ≠entryÊòØÂê¶Ë¢´Ê†áËÆ∞Âà†Èô§ÔºåÂπ∂‰∏îÂ∞ÜÊ†áËÆ∞‰∏∫nilÁöÑentryÊõ¥Êñ∞Ê†áËÆ∞‰∏∫expungefunc (e *entry) tryExpungeLocked() (isExpunged bool) &#123; p := atomic.LoadPointer(&amp;e.p) for p == nil &#123; // Â∞ÜÂ∑≤ÁªèÂà†Èô§Ê†áËÆ∞‰∏∫nilÁöÑÊï∞ÊçÆÊ†áËÆ∞‰∏∫expunged if atomic.CompareAndSwapPointer(&amp;e.p, nil, expunged) &#123; return true &#125; p = atomic.LoadPointer(&amp;e.p) &#125; return p == expunged&#125;//ÂØπentry Â∞ùËØïÊõ¥Êñ∞func (e *entry) tryStore(i *interface&#123;&#125;) bool &#123; p := atomic.LoadPointer(&amp;e.p) if p == expunged &#123; return false &#125; for &#123; if atomic.CompareAndSwapPointer(&amp;e.p, p, unsafe.Pointer(i)) &#123; return true &#125; p = atomic.LoadPointer(&amp;e.p) if p == expunged &#123; return false &#125; &#125;&#125;//readÈáå Â∞ÜÊ†áËÆ∞‰∏∫expungeÁöÑÊõ¥Êñ∞‰∏∫nilfunc (e *entry) unexpungeLocked() (wasExpunged bool) &#123; return atomic.CompareAndSwapPointer(&amp;e.p, expunged, nil)&#125;//Êõ¥Êñ∞entryfunc (e *entry) storeLocked(i *interface&#123;&#125;) &#123; atomic.StorePointer(&amp;e.p, unsafe.Pointer(i))&#125; Âõ†Ê≠§ÔºåÊØèÊ¨°Êìç‰ΩúÂÖàÊ£ÄÊü•readÔºåÂõ†‰∏∫read Âπ∂ÂèëÂÆâÂÖ®ÔºåÊÄßËÉΩÂ•Ω‰∫õÔºõread‰∏çÊª°Ë∂≥ÔºåÂàôÂä†ÈîÅÊ£ÄÊü•dirtyÔºå‰∏ÄÊó¶ÊòØÊñ∞ÁöÑÈîÆÂÄºÔºådirty‰ºöË¢´readÊõ¥Êñ∞„ÄÇ LoadÊñπÊ≥ï: LoadÊñπÊ≥ïÊòØ‰∏Ä‰∏™Âä†ËΩΩÊñπÊ≥ïÔºåÊü•Êâækey„ÄÇ 1234567891011121314151617181920212223242526272829303132333435func (m *Map) Load(key interface&#123;&#125;) (value interface&#123;&#125;, ok bool) &#123; //Âõ†readÂè™ËØªÔºåÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂÖàÊü•ÁúãÊòØÂê¶Êª°Ë∂≥Êù°‰ª∂ read, _ := m.read.Load().(readOnly) e, ok := read.m[key] //Â¶ÇÊûúreadÊ≤°ÊúâÔºåÂπ∂‰∏îdirtyÊúâÊñ∞Êï∞ÊçÆÔºåÈÇ£‰ªédirty‰∏≠Êü•ÊâæÔºåÁî±‰∫édirtyÊòØÊôÆÈÄömapÔºåÁ∫øÁ®ã‰∏çÂÆâÂÖ®ÔºåËøô‰∏™Êó∂ÂÄôÁî®Âà∞‰∫íÊñ•ÈîÅ‰∫Ü if !ok &amp;&amp; read.amended &#123; m.mu.Lock() // ÂèåÈáçÊ£ÄÊü• read, _ = m.read.Load().(readOnly) e, ok = read.m[key] // Â¶ÇÊûúread‰∏≠ËøòÊòØ‰∏çÂ≠òÂú®ÔºåÂπ∂‰∏îdirty‰∏≠ÊúâÊñ∞Êï∞ÊçÆ if !ok &amp;&amp; read.amended &#123; e, ok = m.dirty[key] // mssLockedÔºàÔºâÂáΩÊï∞ÊòØÊÄßËÉΩÊòØsync.Map ÊÄßËÉΩÂæó‰ª•‰øùËØÅÁöÑÈáçË¶ÅÂáΩÊï∞ÔºåÁõÆÁöÑËÆ≤ÊúâÈîÅÁöÑdirtyÊï∞ÊçÆÔºåÊõøÊç¢Âà∞Âè™ËØªÁ∫øÁ®ãÂÆâÂÖ®ÁöÑreadÈáå m.missLocked() &#125; m.mu.Unlock() &#125; if !ok &#123; return nil, false &#125; return e.load()&#125;//dirty ÊèêÂçáËá≥read ÂÖ≥ÈîÆÂáΩÊï∞ÔºåÂΩìmisses ÁªèËøáÂ§öÊ¨°Âõ†‰∏∫load‰πãÂêéÔºåÂ§ßÂ∞èÁ≠â‰∫élenÔºàdirtyÔºâÊó∂ÂÄôÔºåËÆ≤dirtyÊõøÊç¢Âà∞readÈáåÔºå‰ª•Ê≠§ËææÂà∞ÊÄßËÉΩÊèêÂçá„ÄÇfunc (m *Map) missLocked() &#123; m.misses++ if m.misses &lt; len(m.dirty) &#123; return &#125; //ÂéüÂ≠êÊìç‰ΩúÔºåËÄóÊó∂ÂæàÂ∞è m.read.Store(readOnly&#123;m: m.dirty&#125;) m.dirty = nil m.misses = 0&#125; sync.MapÊòØÈÄöËøáÂÜó‰ΩôÁöÑ‰∏§‰∏™Êï∞ÊçÆÁªìÊûÑ(read„ÄÅdirty),ÂÆûÁé∞ÊÄßËÉΩÁöÑÊèêÂçá„ÄÇ‰∏∫‰∫ÜÊèêÂçáÊÄßËÉΩÔºåload„ÄÅdelete„ÄÅstoreÁ≠âÊìç‰ΩúÂ∞ΩÈáè‰ΩøÁî®Âè™ËØªÁöÑreadÔºõ‰∏∫‰∫ÜÊèêÈ´òreadÁöÑkeyÂáª‰∏≠Ê¶ÇÁéáÔºåÈááÁî®Âä®ÊÄÅË∞ÉÊï¥ÔºåÂ∞ÜdirtyÊï∞ÊçÆÊèêÂçá‰∏∫readÔºõÂØπ‰∫éÊï∞ÊçÆÁöÑÂà†Èô§ÔºåÈááÁî®Âª∂ËøüÊ†áËÆ∞Âà†Èô§Ê≥ïÔºåÂè™ÊúâÂú®ÊèêÂçádirtyÁöÑÊó∂ÂÄôÊâçÂà†Èô§„ÄÇ 26. ËØªÂÜôÈîÅÊàñËÄÖ‰∫íÊñ•ÈîÅËØªÁöÑÊó∂ÂÄôËÉΩÂÜôÂêó?Go‰∏≠ËØªÂÜôÈîÅÂåÖÊã¨ËØªÈîÅÂíåÂÜôÈîÅÔºåÂ§ö‰∏™ËØªÁ∫øÁ®ãÂèØ‰ª•ÂêåÊó∂ËÆøÈóÆÂÖ±‰∫´Êï∞ÊçÆÔºõÂÜôÁ∫øÁ®ãÂøÖÈ°ªÁ≠âÂæÖÊâÄÊúâËØªÁ∫øÁ®ãÈÉΩÈáäÊîæÈîÅ‰ª•ÂêéÔºåÊâçËÉΩÂèñÂæóÈîÅÔºõÂêåÊ†∑ÁöÑÔºåËØªÁ∫øÁ®ãÂøÖÈ°ªÁ≠âÂæÖÂÜôÁ∫øÁ®ãÈáäÊîæÈîÅÂêéÔºåÊâçËÉΩÂèñÂæóÈîÅÔºå‰πüÂ∞±ÊòØËØ¥ËØªÂÜôÈîÅË¶ÅÁ°Æ‰øùÁöÑÊòØÂ¶Ç‰∏ã‰∫íÊñ•ÂÖ≥Á≥ªÔºåÂèØ‰ª•ÂêåÊó∂ËØªÔºå‰ΩÜÊòØËØª-ÂÜôÔºåÂÜô-ÂÜôÈÉΩÊòØ‰∫íÊñ•ÁöÑ„ÄÇ 27. ÊÄé‰πàÈôêÂà∂GoroutineÁöÑÊï∞Èáè.Âú®Golang‰∏≠ÔºåGoroutineËôΩÁÑ∂ÂæàÂ•ΩÔºå‰ΩÜÊòØÊï∞ÈáèÂ§™Â§ö‰∫ÜÔºåÂæÄÂæÄ‰ºöÂ∏¶Êù•ÂæàÂ§öÈ∫ªÁÉ¶ÔºåÊØîÂ¶ÇËÄóÂ∞ΩÁ≥ªÁªüËµÑÊ∫êÂØºËá¥Á®ãÂ∫èÂ¥©Ê∫ÉÔºåÊàñËÄÖCPU‰ΩøÁî®ÁéáËøáÈ´òÂØºËá¥Á≥ªÁªüÂøô‰∏çËøáÊù•„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈôêÂà∂‰∏ãGoroutineÁöÑÊï∞Èáè,ËøôÊ†∑Â∞±ÈúÄË¶ÅÂú®ÊØè‰∏ÄÊ¨°ÊâßË°ågo‰πãÂâçÂà§Êñ≠goroutineÁöÑÊï∞ÈáèÔºåÂ¶ÇÊûúÊï∞ÈáèË∂Ö‰∫ÜÔºåÂ∞±Ë¶ÅÈòªÂ°ûgoÁöÑÊâßË°å„ÄÇÁ¨¨‰∏ÄÊó∂Èó¥ÊÉ≥Âà∞ÁöÑÂ∞±ÊòØ‰ΩøÁî®ÈÄöÈÅì„ÄÇÊØèÊ¨°ÊâßË°åÁöÑgo‰πãÂâçÂêëÈÄöÈÅìÂÜôÂÖ•ÂÄºÔºåÁõ¥Âà∞ÈÄöÈÅìÊª°ÁöÑÊó∂ÂÄôÂ∞±ÈòªÂ°û‰∫ÜÔºå 123456789101112131415161718192021package mainimport &quot;fmt&quot;var ch chan intfunc elegance()&#123; &lt;-ch fmt.Println(&quot;the ch value receive&quot;,ch)&#125;func main()&#123; ch = make(chan int,5) for i:=0;i&lt;10;i++&#123; ch &lt;-1 fmt.Println(&quot;the ch value send&quot;,ch) go elegance() fmt.Println(&quot;the result i&quot;,i) &#125;&#125; ËøêË°å: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&gt; go run goroutine.go the ch value send 0xc00009c000the result i 0the ch value send 0xc00009c000the result i 1the ch value send 0xc00009c000the result i 2the ch value send 0xc00009c000the result i 3the ch value send 0xc00009c000the result i 4the ch value send 0xc00009c000the result i 5the ch value send 0xc00009c000the ch value receive 0xc00009c000the result i 6the ch value receive 0xc00009c000the ch value send 0xc00009c000the result i 7the ch value send 0xc00009c000the result i 8the ch value send 0xc00009c000the result i 9the ch value send 0xc00009c000the ch value receive 0xc00009c000the ch value receive 0xc00009c000the ch value receive 0xc00009c000the result i 10the ch value send 0xc00009c000the result i 11the ch value send 0xc00009c000the result i 12the ch value send 0xc00009c000the result i 13the ch value send 0xc00009c000the ch value receive 0xc00009c000the ch value receive 0xc00009c000the ch value receive 0xc00009c000the ch value receive 0xc00009c000the result i 14the ch value receive 0xc00009c000&gt; go run goroutine.go the ch value send 0xc00007e000the result i 0the ch value send 0xc00007e000the result i 1the ch value send 0xc00007e000the result i 2the ch value send 0xc00007e000the result i 3the ch value send 0xc00007e000the ch value receive 0xc00007e000the result i 4the ch value send 0xc00007e000the ch value receive 0xc00007e000the result i 5the ch value send 0xc00007e000the ch value receive 0xc00007e000the result i 6the ch value send 0xc00007e000the result i 7the ch value send 0xc00007e000the ch value receive 0xc00007e000the ch value receive 0xc00007e000the ch value receive 0xc00007e000the result i 8the ch value send 0xc00007e000the result i 9 ËøôÊ†∑ÊØèÊ¨°ÂêåÊó∂ËøêË°åÁöÑgoroutineÂ∞±Ë¢´ÈôêÂà∂‰∏∫5‰∏™‰∫Ü„ÄÇ‰ΩÜÊòØÊñ∞ÁöÑÈóÆÈ¢ò‰∫éÊòØÂ∞±Âá∫Áé∞‰∫ÜÔºåÂõ†‰∏∫Âπ∂‰∏çÊòØÊâÄÊúâÁöÑgoroutineÈÉΩÊâßË°åÂÆå‰∫ÜÔºåÂú®mainÂáΩÊï∞ÈÄÄÂá∫‰πãÂêéÔºåËøòÊúâ‰∏Ä‰∫õgoroutineÊ≤°ÊúâÊâßË°åÂÆåÂ∞±Ë¢´Âº∫Âà∂ÁªìÊùü‰∫Ü„ÄÇËøô‰∏™Êó∂ÂÄôÊàë‰ª¨Â∞±ÈúÄË¶ÅÁî®Âà∞sync.WaitGroup„ÄÇ‰ΩøÁî®WaitGroupÁ≠âÂæÖÊâÄÊúâÁöÑgoroutineÈÄÄÂá∫„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960package mainimport ( &quot;fmt&quot; &quot;runtime&quot; &quot;sync&quot; &quot;time&quot;)// Pool Goroutine Pooltype Pool struct &#123; queue chan int wg *sync.WaitGroup&#125;// New Êñ∞Âª∫‰∏Ä‰∏™ÂçèÁ®ãÊ±†func NewPool(size int) *Pool&#123; if size &lt;=0&#123; size = 1 &#125; return &amp;Pool&#123; queue:make(chan int,size), wg:&amp;sync.WaitGroup&#123;&#125;, &#125;&#125;// Add Êñ∞Â¢û‰∏Ä‰∏™ÊâßË°åfunc (p *Pool)Add(delta int)&#123; // delta‰∏∫Ê≠£Êï∞Â∞±Ê∑ªÂä† for i :=0;i&lt;delta;i++&#123; p.queue &lt;-1 &#125; // delta‰∏∫Ë¥üÊï∞Â∞±ÂáèÂ∞ë for i:=0;i&gt;delta;i--&#123; &lt;-p.queue &#125; p.wg.Add(delta)&#125;// Done ÊâßË°åÂÆåÊàêÂáè‰∏Äfunc (p *Pool) Done()&#123; &lt;-p.queue p.wg.Done()&#125;// Wait Á≠âÂæÖGoroutineÊâßË°åÂÆåÊØïfunc (p *Pool) Wait()&#123; p.wg.Wait()&#125;func main()&#123; // ËøôÈáåÈôêÂà∂5‰∏™Âπ∂Âèë pool := NewPool(5) fmt.Println(&quot;the NumGoroutine begin is:&quot;,runtime.NumGoroutine()) for i:=0;i&lt;20;i++&#123; pool.Add(1) go func(i int) &#123; time.Sleep(time.Second) fmt.Println(&quot;the NumGoroutine continue is:&quot;,runtime.NumGoroutine()) pool.Done() &#125;(i) &#125; pool.Wait() fmt.Println(&quot;the NumGoroutine done is:&quot;,runtime.NumGoroutine())&#125; ËøêË°å: 12345678910111213141516171819202122the NumGoroutine begin is: 1the NumGoroutine continue is: 6the NumGoroutine continue is: 7the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 6the NumGoroutine continue is: 3the NumGoroutine continue is: 2the NumGoroutine done is: 1 ÂÖ∂‰∏≠ÔºåGoÁöÑGOMAXPROCSÈªòËÆ§ÂÄºÂ∑≤ÁªèËÆæÁΩÆ‰∏∫CPUÁöÑÊ†∏Êï∞Ôºå ËøôÈáåÂÖÅËÆ∏Êàë‰ª¨ÁöÑGoÁ®ãÂ∫èÂÖÖÂàÜ‰ΩøÁî®Êú∫Âô®ÁöÑÊØè‰∏Ä‰∏™CPU,ÊúÄÂ§ßÁ®ãÂ∫¶ÁöÑÊèêÈ´òÊàë‰ª¨Á®ãÂ∫èÁöÑÂπ∂ÂèëÊÄßËÉΩ„ÄÇruntime.NumGoroutineÂáΩÊï∞Âú®Ë¢´Ë∞ÉÁî®ÂêéÔºå‰ºöËøîÂõûÁ≥ªÁªü‰∏≠ÁöÑÂ§Ñ‰∫éÁâπÂÆöÁä∂ÊÄÅÁöÑGoroutineÁöÑÊï∞Èáè„ÄÇËøôÈáåÁöÑÁâπÊåáÊòØÊåáGrunnable\Gruning\Gsyscall\Gwaition„ÄÇÂ§Ñ‰∫éËøô‰∫õÁä∂ÊÄÅÁöÑGroutineÂç≥Ë¢´ÁúãÂÅöÊòØÊ¥ªË∑ÉÁöÑÊàñËÄÖËØ¥Ê≠£Âú®Ë¢´Ë∞ÉÂ∫¶„ÄÇ ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑè‰∏ãÔºöÂûÉÂúæÂõûÊî∂ÊâÄÂú®GroutineÁöÑÁä∂ÊÄÅ‰πüÂ§Ñ‰∫éËøô‰∏™ËåÉÂõ¥ÂÜÖÁöÑËØùÔºå‰πü‰ºöË¢´Á∫≥ÂÖ•ËØ•ËÆ°Êï∞Âô®„ÄÇ 28. ChannelÊòØÂêåÊ≠•ÁöÑËøòÊòØÂºÇÊ≠•ÁöÑ.ChannelÊòØÂºÇÊ≠•ËøõË°åÁöÑ„ÄÇ channelÂ≠òÂú®3ÁßçÁä∂ÊÄÅÔºö nilÔºåÊú™ÂàùÂßãÂåñÁöÑÁä∂ÊÄÅÔºåÂè™ËøõË°å‰∫ÜÂ£∞ÊòéÔºåÊàñËÄÖÊâãÂä®ËµãÂÄº‰∏∫nil activeÔºåÊ≠£Â∏∏ÁöÑchannelÔºåÂèØËØªÊàñËÄÖÂèØÂÜô closedÔºåÂ∑≤ÂÖ≥Èó≠ÔºåÂçÉ‰∏á‰∏çË¶ÅËØØËÆ§‰∏∫ÂÖ≥Èó≠channelÂêéÔºåchannelÁöÑÂÄºÊòØnil 29. ËØ¥‰∏Ä‰∏ãÂºÇÊ≠•ÂíåÈùûÈòªÂ°ûÁöÑÂå∫Âà´? ÂºÇÊ≠•ÂíåÈùûÈòªÂ°ûÁöÑÂå∫Âà´: ÂºÇÊ≠•ÔºöË∞ÉÁî®Âú®ÂèëÂá∫‰πãÂêéÔºåËøô‰∏™Ë∞ÉÁî®Â∞±Áõ¥Êé•ËøîÂõûÔºå‰∏çÁÆ°ÊúâÊó†ÁªìÊûúÔºõÂºÇÊ≠•ÊòØËøáÁ®ã„ÄÇ ÈùûÈòªÂ°ûÔºöÂÖ≥Ê≥®ÁöÑÊòØÁ®ãÂ∫èÂú®Á≠âÂæÖË∞ÉÁî®ÁªìÊûúÔºàÊ∂àÊÅØÔºåËøîÂõûÂÄºÔºâÊó∂ÁöÑÁä∂ÊÄÅÔºåÊåáÂú®‰∏çËÉΩÁ´ãÂàªÂæóÂà∞ÁªìÊûú‰πãÂâçÔºåËØ•Ë∞ÉÁî®‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ã„ÄÇ ÂêåÊ≠•ÂíåÂºÇÊ≠•ÁöÑÂå∫Âà´Ôºö Ê≠•Ôºö‰∏Ä‰∏™ÊúçÂä°ÁöÑÂÆåÊàêÈúÄË¶Å‰æùËµñÂÖ∂‰ªñÊúçÂä°Êó∂ÔºåÂè™ÊúâÁ≠âÂæÖË¢´‰æùËµñÁöÑÊúçÂä°ÂÆåÊàêÂêéÔºåÊâçÁÆóÂÆåÊàêÔºåËøôÊòØ‰∏ÄÁßçÂèØÈù†ÁöÑÊúçÂä°Â∫èÂàó„ÄÇË¶Å‰πàÊàêÂäüÈÉΩÊàêÂäüÔºåÂ§±Ë¥•ÈÉΩÂ§±Ë¥•ÔºåÊúçÂä°ÁöÑÁä∂ÊÄÅÂèØ‰ª•‰øùÊåÅ‰∏ÄËá¥„ÄÇ ÂºÇÊ≠•Ôºö‰∏Ä‰∏™ÊúçÂä°ÁöÑÂÆåÊàêÈúÄË¶Å‰æùËµñÂÖ∂‰ªñÊúçÂä°Êó∂ÔºåÂè™ÈÄöÁü•ÂÖ∂‰ªñ‰æùËµñÊúçÂä°ÂºÄÂßãÊâßË°åÔºåËÄå‰∏çÈúÄË¶ÅÁ≠âÂæÖË¢´‰æùËµñÁöÑÊúçÂä°ÂÆåÊàêÔºåÊ≠§Êó∂ËØ•ÊúçÂä°Â∞±ÁÆóÂÆåÊàê‰∫Ü„ÄÇË¢´‰æùËµñÁöÑÊúçÂä°ÊòØÂê¶ÊúÄÁªàÂÆåÊàêÊó†Ê≥ïÁ°ÆÂÆöÔºå‰∏ÄÊ¨°ÂÆÉÊòØ‰∏Ä‰∏™‰∏çÂèØÈù†ÁöÑÊúçÂä°Â∫èÂàó„ÄÇ Ê∂àÊÅØÈÄöÁü•‰∏≠ÁöÑÂêåÊ≠•ÂíåÂºÇÊ≠•Ôºö ÂêåÊ≠•ÔºöÂΩì‰∏Ä‰∏™ÂêåÊ≠•Ë∞ÉÁî®ÂèëÂá∫ÂêéÔºåË∞ÉÁî®ËÄÖË¶Å‰∏ÄÁõ¥Á≠âÂæÖËøîÂõûÊ∂àÊÅØÔºàÊàñËÄÖË∞ÉÁî®ÁªìÊûúÔºâÈÄöÁü•ÂêéÔºåÊâçËÉΩËøõË°åÂêéÁª≠ÁöÑÊâßË°å„ÄÇ ÂºÇÊ≠•ÔºöÂΩì‰∏Ä‰∏™ÂºÇÊ≠•ËøáÁ®ãË∞ÉÁî®ÂèëÂá∫ÂêéÔºåË∞ÉÁî®ËÄÖ‰∏çËÉΩÁ´ãÂàªÂæóÂà∞ËøîÂõûÊ∂àÊÅØÔºàÁªìÊûúÔºâ„ÄÇÂú®Ë∞ÉÁî®ÁªìÊùü‰πãÂêéÔºåÈÄöËøáÊ∂àÊÅØÂõûË∞ÉÊù•ÈÄöÁü•Ë∞ÉÁî®ËÄÖÊòØÂê¶Ë∞ÉÁî®ÊàêÂäü„ÄÇ ÈòªÂ°û‰∏éÈùûÈòªÂ°ûÁöÑÂå∫Âà´Ôºö ÈòªÂ°ûÔºöÈòªÂ°ûË∞ÉÁî®ÊòØÊåáË∞ÉÁî®ÁªìÊûúËøîÂõû‰πãÂâçÔºåÂΩìÂâçÁ∫øÁ®ã‰ºöË¢´ÊåÇËµ∑Ôºå‰∏ÄÁõ¥Â§Ñ‰∫éÁ≠âÂæÖÊ∂àÊÅØÈÄöÁü•Ôºå‰∏çËÉΩÂ§üÊâßË°åÂÖ∂‰ªñ‰∏öÂä°,ÂáΩÊï∞Âè™ÊúâÂú®ÂæóÂà∞ÁªìÊûú‰πãÂêéÊâç‰ºöËøîÂõû„ÄÇ ÈùûÈòªÂ°ûÔºöÈùûÈòªÂ°ûÂíåÈòªÂ°ûÁöÑÊ¶ÇÂøµÁõ∏ÂØπÂ∫îÔºåÊåáÂú®‰∏çËÉΩÁ´ãÂàªÂæóÂà∞ÁªìÊûú‰πãÂâçÔºåËØ•ÂáΩÊï∞‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÔºåËÄå‰ºöÁ´ãÂàªËøîÂõû„ÄÇ ÂêåÊ≠•‰∏éÂºÇÊ≠•ÊòØÂØπÂ∫îÁöÑÔºåÂÆÉ‰ª¨ÊòØÁ∫øÁ®ã‰πãÈó¥ÁöÑÂÖ≥Á≥ªÔºå‰∏§‰∏™Á∫øÁ®ã‰πãÈó¥Ë¶Å‰πàÊòØÂêåÊ≠•ÁöÑÔºåË¶Å‰πàÊòØÂºÇÊ≠•ÁöÑ„ÄÇ ÈòªÂ°û‰∏éÈùûÈòªÂ°ûÊòØÂØπÂêå‰∏Ä‰∏™Á∫øÁ®ãÊù•ËØ¥ÁöÑÔºåÂú®Êüê‰∏™Êó∂ÂàªÔºåÁ∫øÁ®ãË¶Å‰πàÂ§Ñ‰∫éÈòªÂ°ûÔºåË¶Å‰πàÂ§Ñ‰∫éÈùûÈòªÂ°û„ÄÇ ÈòªÂ°ûÊòØ‰ΩøÁî®ÂêåÊ≠•Êú∫Âà∂ÁöÑÁªìÊûúÔºåÈùûÈòªÂ°ûÂàôÊòØ‰ΩøÁî®ÂºÇÊ≠•Êú∫Âà∂ÁöÑÁªìÊûú„ÄÇ 30. LogÂåÖÁ∫øÁ®ãÂÆâÂÖ®ÂêóÔºüGolangÁöÑÊ†áÂáÜÂ∫ìÊèê‰æõ‰∫ÜlogÁöÑÊú∫Âà∂Ôºå‰ΩÜÊòØËØ•Ê®°ÂùóÁöÑÂäüËÉΩËæÉ‰∏∫ÁÆÄÂçïÔºàÁúã‰ººÁÆÄÂçïÔºåÂÖ∂ÂÆû‰ªñÊúâ‰ªñÁöÑËÆæËÆ°ÊÄùË∑ØÔºâ„ÄÇÂú®ËæìÂá∫ÁöÑ‰ΩçÁΩÆÂÅö‰∫ÜÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ‰øùÊä§„ÄÇ 31. GoroutineÂíåÁ∫øÁ®ãÁöÑÂå∫Âà´?‰ªéË∞ÉÂ∫¶‰∏äÁúãÔºågoroutineÁöÑË∞ÉÂ∫¶ÂºÄÈîÄËøúËøúÂ∞è‰∫éÁ∫øÁ®ãË∞ÉÂ∫¶ÂºÄÈîÄ„ÄÇ OSÁöÑÁ∫øÁ®ãÁî±OSÂÜÖÊ†∏Ë∞ÉÂ∫¶ÔºåÊØèÈöîÂá†ÊØ´ÁßíÔºå‰∏Ä‰∏™Á°¨‰ª∂Êó∂Èíü‰∏≠Êñ≠ÂèëÂà∞CPUÔºåCPUË∞ÉÁî®‰∏Ä‰∏™Ë∞ÉÂ∫¶Âô®ÂÜÖÊ†∏ÂáΩÊï∞„ÄÇËøô‰∏™ÂáΩÊï∞ÊöÇÂÅúÂΩìÂâçÊ≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ãÔºåÊää‰ªñÁöÑÂØÑÂ≠òÂô®‰ø°ÊÅØ‰øùÂ≠òÂà∞ÂÜÖÂ≠ò‰∏≠ÔºåÊü•ÁúãÁ∫øÁ®ãÂàóË°®Âπ∂ÂÜ≥ÂÆöÊé•‰∏ãÊù•ËøêË°åÂì™‰∏Ä‰∏™Á∫øÁ®ãÔºåÂÜç‰ªéÂÜÖÂ≠ò‰∏≠ÊÅ¢Â§çÁ∫øÁ®ãÁöÑÊ≥®ÂÜåË°®‰ø°ÊÅØÔºåÊúÄÂêéÁªßÁª≠ÊâßË°åÈÄâ‰∏≠ÁöÑÁ∫øÁ®ã„ÄÇËøôÁßçÁ∫øÁ®ãÂàáÊç¢ÈúÄË¶Å‰∏Ä‰∏™ÂÆåÊï¥ÁöÑ‰∏ä‰∏ãÊñáÂàáÊç¢ÔºöÂç≥‰øùÂ≠ò‰∏Ä‰∏™Á∫øÁ®ãÁöÑÁä∂ÊÄÅÂà∞ÂÜÖÂ≠òÔºåÂÜçÊÅ¢Â§çÂè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãÁöÑÁä∂ÊÄÅÔºåÊúÄÂêéÊõ¥Êñ∞Ë∞ÉÂ∫¶Âô®ÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇÊüêÁßçÊÑè‰πâ‰∏äÔºåËøôÁßçÊìç‰ΩúËøòÊòØÂæàÊÖ¢ÁöÑ„ÄÇ GoËøêË°åÁöÑÊó∂ÂÄôÂåÖÊ∂µ‰∏Ä‰∏™Ëá™Â∑±ÁöÑË∞ÉÂ∫¶Âô®ÔºåËøô‰∏™Ë∞ÉÂ∫¶Âô®‰ΩøÁî®‰∏Ä‰∏™Áß∞‰∏∫‰∏Ä‰∏™M:NË∞ÉÂ∫¶ÊäÄÊúØÔºåm‰∏™goroutineÂà∞n‰∏™osÁ∫øÁ®ãÔºàÂèØ‰ª•Áî®GOMAXPROCSÊù•ÊéßÂà∂nÁöÑÊï∞ÈáèÔºâÔºåGoÁöÑË∞ÉÂ∫¶Âô®‰∏çÊòØÁî±Á°¨‰ª∂Êó∂ÈíüÊù•ÂÆöÊúüËß¶ÂèëÁöÑÔºåËÄåÊòØÁî±ÁâπÂÆöÁöÑgoËØ≠Ë®ÄÁªìÊûÑÊù•Ëß¶ÂèëÁöÑÔºå‰ªñ‰∏çÈúÄË¶ÅÂàáÊç¢Âà∞ÂÜÖÊ†∏ËØ≠Â¢ÉÔºåÊâÄ‰ª•Ë∞ÉÂ∫¶‰∏Ä‰∏™goroutineÊØîË∞ÉÂ∫¶‰∏Ä‰∏™Á∫øÁ®ãÁöÑÊàêÊú¨‰ΩéÂæàÂ§ö„ÄÇ ‰ªéÊ†àÁ©∫Èó¥‰∏äÔºågoroutineÁöÑÊ†àÁ©∫Èó¥Êõ¥Âä†Âä®ÊÄÅÁÅµÊ¥ª„ÄÇ ÊØè‰∏™OSÁöÑÁ∫øÁ®ãÈÉΩÊúâ‰∏Ä‰∏™Âõ∫ÂÆöÂ§ßÂ∞èÁöÑÊ†àÂÜÖÂ≠òÔºåÈÄöÂ∏∏ÊòØ2MBÔºåÊ†àÂÜÖÂ≠òÁî®‰∫é‰øùÂ≠òÂú®ÂÖ∂‰ªñÂáΩÊï∞Ë∞ÉÁî®ÊúüÈó¥Âì™‰∫õÊ≠£Âú®ÊâßË°åÊàñËÄÖ‰∏¥Êó∂ÊöÇÂÅúÁöÑÂáΩÊï∞ÁöÑÂ±ÄÈÉ®ÂèòÈáè„ÄÇËøô‰∏™Âõ∫ÂÆöÁöÑÊ†àÂ§ßÂ∞èÔºåÂ¶ÇÊûúÂØπ‰∫égoroutineÊù•ËØ¥ÔºåÂèØËÉΩÊòØ‰∏ÄÁßçÂ∑®Â§ßÁöÑÊµ™Ë¥π„ÄÇ‰Ωú‰∏∫ÂØπÊØîgoroutineÂú®ÁîüÂëΩÂë®ÊúüÂºÄÂßãÂè™Êúâ‰∏Ä‰∏™ÂæàÂ∞èÁöÑÊ†àÔºåÂÖ∏ÂûãÊÉÖÂÜµÊòØ2KB, Âú®goÁ®ãÂ∫è‰∏≠Ôºå‰∏ÄÊ¨°ÂàõÂª∫ÂçÅ‰∏áÂ∑¶Âè≥ÁöÑgoroutine‰πü‰∏çÁΩïËßÅÔºà2KB*100,000=200MBÔºâ„ÄÇËÄå‰∏îgoroutineÁöÑÊ†à‰∏çÊòØÂõ∫ÂÆöÂ§ßÂ∞èÔºåÂÆÉÂèØ‰ª•ÊåâÈúÄÂ¢ûÂ§ßÂíåÁº©Â∞èÔºåÊúÄÂ§ßÈôêÂà∂ÂèØ‰ª•Âà∞1GB„ÄÇ goroutineÊ≤°Êúâ‰∏Ä‰∏™ÁâπÂÆöÁöÑÊ†áËØÜ„ÄÇ Âú®Â§ßÈÉ®ÂàÜÊîØÊåÅÂ§öÁ∫øÁ®ãÁöÑÊìç‰ΩúÁ≥ªÁªüÂíåÁºñÁ®ãËØ≠Ë®Ä‰∏≠ÔºåÁ∫øÁ®ãÊúâ‰∏Ä‰∏™Áã¨ÁâπÁöÑÊ†áËØÜÔºåÈÄöÂ∏∏ÊòØ‰∏Ä‰∏™Êï¥Êï∞ÊàñËÄÖÊåáÈíàÔºåËøô‰∏™ÁâπÊÄßÂèØ‰ª•ËÆ©Êàë‰ª¨ÊûÑÂª∫‰∏Ä‰∏™Á∫øÁ®ãÁöÑÂ±ÄÈÉ®Â≠òÂÇ®ÔºåÊú¨Ë¥®ÊòØ‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑmapÔºå‰ª•Á∫øÁ®ãÁöÑÊ†áËØÜ‰Ωú‰∏∫ÈîÆÔºåËøôÊ†∑ÊØè‰∏™Á∫øÁ®ãÂèØ‰ª•Áã¨Á´ã‰ΩøÁî®Ëøô‰∏™mapÂ≠òÂÇ®ÂíåËé∑ÂèñÂÄºÔºå‰∏çÂèóÂÖ∂‰ªñÁ∫øÁ®ãÂπ≤Êâ∞„ÄÇ goroutine‰∏≠Ê≤°ÊúâÂèØ‰æõÁ®ãÂ∫èÂëòËÆøÈóÆÁöÑÊ†áËØÜÔºåÂéüÂõ†ÊòØ‰∏ÄÁßçÁ∫ØÂáΩÊï∞ÁöÑÁêÜÂøµÔºå‰∏çÂ∏åÊúõÊª•Áî®Á∫øÁ®ãÂ±ÄÈÉ®Â≠òÂÇ®ÂØºËá¥‰∏Ä‰∏™‰∏çÂÅ•Â∫∑ÁöÑË∂ÖË∑ù‰ΩúÁî®ÔºåÂç≥ÂáΩÊï∞ÁöÑË°å‰∏∫‰∏ç‰ªÖÂèñÂÜ≥‰∫éÂÆÉÁöÑÂèÇÊï∞ÔºåËøòÂèñÂÜ≥‰∫éËøêË°åÂÆÉÁöÑÁ∫øÁ®ãÊ†áËØÜ„ÄÇ 32. ÊªëÂä®Á™óÂè£ÁöÑÊ¶ÇÂøµ‰ª•ÂèäÂ∫îÁî®?ÊªëÂä®Á™óÂè£Ê¶ÇÂøµ‰∏ç‰ªÖÂ≠òÂú®‰∫éÊï∞ÊçÆÈìæË∑ØÂ±ÇÔºå‰πüÂ≠òÂú®‰∫é‰º†ËæìÂ±ÇÔºå‰∏§ËÄÖÊúâ‰∏çÂêåÁöÑÂçèËÆÆÔºå‰ΩÜÂü∫Êú¨ÂéüÁêÜÊòØÁõ∏ËøëÁöÑ„ÄÇÂÖ∂‰∏≠‰∏Ä‰∏™ÈáçË¶ÅÂå∫Âà´ÊòØÔºå‰∏Ä‰∏™ÊòØÈíàÂØπ‰∫éÂ∏ßÁöÑ‰º†ÈÄÅÔºåÂè¶‰∏Ä‰∏™ÊòØÂ≠óËäÇÊï∞ÊçÆÁöÑ‰º†ÈÄÅ„ÄÇ ÊªëÂä®Á™óÂè£ÔºàSliding windowÔºâÊòØ‰∏ÄÁßçÊµÅÈáèÊéßÂà∂ÊäÄÊúØ„ÄÇÊó©ÊúüÁöÑÁΩëÁªúÈÄö‰ø°‰∏≠ÔºåÈÄö‰ø°ÂèåÊñπ‰∏ç‰ºöËÄÉËôëÁΩëÁªúÁöÑÊã•Êå§ÊÉÖÂÜµÁõ¥Êé•ÂèëÈÄÅÊï∞ÊçÆ„ÄÇÁî±‰∫éÂ§ßÂÆ∂‰∏çÁü•ÈÅìÁΩëÁªúÊã•Â°ûÁä∂ÂÜµÔºåÂêåÊó∂ÂèëÈÄÅÊï∞ÊçÆÔºåÂØºËá¥‰∏≠Èó¥ËäÇÁÇπÈòªÂ°ûÊéâÂåÖÔºåË∞Å‰πüÂèë‰∏ç‰∫ÜÊï∞ÊçÆÔºåÊâÄ‰ª•Â∞±Êúâ‰∫ÜÊªëÂä®Á™óÂè£Êú∫Âà∂Êù•Ëß£ÂÜ≥Ê≠§ÈóÆÈ¢ò„ÄÇÂèÇËßÅÊªëÂä®Á™óÂè£Â¶Ç‰ΩïÊ†πÊçÆÁΩëÁªúÊã•Â°ûÂèëÈÄÅÊï∞ÊçÆ‰ªøÁúüËßÜÈ¢ë„ÄÇ ÊªëÂä®Á™óÂè£ÂçèËÆÆÊòØÁî®Êù•ÊîπÂñÑÂêûÂêêÈáèÁöÑ‰∏ÄÁßçÊäÄÊúØÔºåÂç≥ÂÆπËÆ∏ÂèëÈÄÅÊñπÂú®Êé•Êî∂‰ªª‰ΩïÂ∫îÁ≠î‰πãÂâç‰º†ÈÄÅÈôÑÂä†ÁöÑÂåÖ„ÄÇÊé•Êî∂ÊñπÂëäËØâÂèëÈÄÅÊñπÂú®Êüê‰∏ÄÊó∂ÂàªËÉΩÈÄÅÂ§öÂ∞ëÂåÖÔºàÁß∞Á™óÂè£Â∞∫ÂØ∏Ôºâ„ÄÇ CP‰∏≠ÈááÁî®ÊªëÂä®Á™óÂè£Êù•ËøõË°å‰º†ËæìÊéßÂà∂ÔºåÊªëÂä®Á™óÂè£ÁöÑÂ§ßÂ∞èÊÑèÂë≥ÁùÄÊé•Êî∂ÊñπËøòÊúâÂ§öÂ§ßÁöÑÁºìÂÜ≤Âå∫ÂèØ‰ª•Áî®‰∫éÊé•Êî∂Êï∞ÊçÆ„ÄÇÂèëÈÄÅÊñπÂèØ‰ª•ÈÄöËøáÊªëÂä®Á™óÂè£ÁöÑÂ§ßÂ∞èÊù•Á°ÆÂÆöÂ∫îËØ•ÂèëÈÄÅÂ§öÂ∞ëÂ≠óËäÇÁöÑÊï∞ÊçÆ„ÄÇÂΩìÊªëÂä®Á™óÂè£‰∏∫0Êó∂ÔºåÂèëÈÄÅÊñπ‰∏ÄËà¨‰∏çËÉΩÂÜçÂèëÈÄÅÊï∞ÊçÆÊä•Ôºå‰ΩÜÊúâ‰∏§ÁßçÊÉÖÂÜµÈô§Â§ñÔºå‰∏ÄÁßçÊÉÖÂÜµÊòØÂèØ‰ª•ÂèëÈÄÅÁ¥ßÊÄ•Êï∞ÊçÆÔºå‰æãÂ¶ÇÔºåÂÖÅËÆ∏Áî®Êà∑ÁªàÊ≠¢Âú®ËøúÁ´ØÊú∫‰∏äÁöÑËøêË°åËøõÁ®ã„ÄÇÂè¶‰∏ÄÁßçÊÉÖÂÜµÊòØÂèëÈÄÅÊñπÂèØ‰ª•ÂèëÈÄÅ‰∏Ä‰∏™1Â≠óËäÇÁöÑÊï∞ÊçÆÊä•Êù•ÈÄöÁü•Êé•Êî∂ÊñπÈáçÊñ∞Â£∞ÊòéÂÆÉÂ∏åÊúõÊé•Êî∂ÁöÑ‰∏ã‰∏ÄÂ≠óËäÇÂèäÂèëÈÄÅÊñπÁöÑÊªëÂä®Á™óÂè£Â§ßÂ∞è„ÄÇ 33. ÊÄé‰πàÂÅöÂºπÊÄßÊâ©Áº©ÂÆπÔºåÂéüÁêÜÊòØ‰ªÄ‰πà?ÂºπÊÄß‰º∏Áº©ÔºàAuto ScalingÔºâÊ†πÊçÆÊÇ®ÁöÑ‰∏öÂä°ÈúÄÊ±ÇÂíå‰º∏Áº©Á≠ñÁï•Ôºå‰∏∫ÊÇ®Ëá™Âä®Ë∞ÉÊï¥ËÆ°ÁÆóËµÑÊ∫ê„ÄÇÊÇ®ÂèØËÆæÁΩÆÂÆöÊó∂„ÄÅÂë®ÊúüÊàñÁõëÊéßÁ≠ñÁï•ÔºåÊÅ∞Âà∞Â•ΩÂ§ÑÂú∞Â¢ûÂä†ÊàñÂáèÂ∞ëCVMÂÆû‰æãÔºåÂπ∂ÂÆåÊàêÂÆû‰æãÈÖçÁΩÆÔºå‰øùËØÅ‰∏öÂä°Âπ≥Á®≥ÂÅ•Â∫∑ËøêË°å„ÄÇÂú®ÈúÄÊ±ÇÈ´òÂ≥∞ÊúüÊó∂ÔºåÂºπÊÄß‰º∏Áº©Ëá™Âä®Â¢ûÂä†CVMÂÆû‰æãÁöÑÊï∞ÈáèÔºå‰ª•‰øùËØÅÊÄßËÉΩ‰∏çÂèóÂΩ±ÂìçÔºõÂΩìÈúÄÊ±ÇËæÉ‰ΩéÊó∂ÔºåÂàô‰ºöÂáèÂ∞ëCVMÂÆû‰æãÊï∞Èáè‰ª•Èôç‰ΩéÊàêÊú¨„ÄÇÂºπÊÄß‰º∏Áº©Êó¢ÈÄÇÂêàÈúÄÊ±ÇÁ®≥ÂÆöÁöÑÂ∫îÁî®Á®ãÂ∫èÔºåÂêåÊó∂‰πüÈÄÇÂêàÊØèÂ§©„ÄÅÊØèÂë®„ÄÅÊØèÊúà‰ΩøÁî®Èáè‰∏çÂÅúÊ≥¢Âä®ÁöÑÂ∫îÁî®Á®ãÂ∫è„ÄÇ 34. ËÆ©‰Ω†ËÆæËÆ°‰∏Ä‰∏™webÊ°ÜÊû∂Ôºå‰Ω†Ë¶ÅÊÄé‰πàËÆæËÆ°ÔºåËØ¥‰∏Ä‰∏ãÊ≠•È™§.35. ËØ¥‰∏Ä‰∏ã‰∏≠Èó¥‰ª∂ÂéüÁêÜ.‰∏≠Èó¥‰ª∂ÔºàmiddlewareÔºâÊòØÂü∫Á°ÄËΩØ‰ª∂ÁöÑ‰∏ÄÂ§ßÁ±ªÔºåÂ±û‰∫éÂèØÂ§çÁî®ËΩØ‰ª∂ÁöÑËåÉÁï¥„ÄÇ‰∏≠Èó¥‰ª∂Â§Ñ‰∫éÊìç‰ΩúÁ≥ªÁªüËΩØ‰ª∂‰∏éÁî®Êà∑ÁöÑÂ∫îÁî®ËΩØ‰ª∂ÁöÑ‰∏≠Èó¥„ÄÇ‰∏≠Èó¥‰ª∂Âú®Êìç‰ΩúÁ≥ªÁªü„ÄÅÁΩëÁªúÂíåÊï∞ÊçÆÂ∫ì‰πã‰∏äÔºåÂ∫îÁî®ËΩØ‰ª∂ÁöÑ‰∏ãÂ±ÇÔºåÊÄªÁöÑ‰ΩúÁî®ÊòØ‰∏∫Â§Ñ‰∫éËá™Â∑±‰∏äÂ±ÇÁöÑÂ∫îÁî®ËΩØ‰ª∂Êèê‰æõËøêË°å‰∏éÂºÄÂèëÁöÑÁéØÂ¢ÉÔºåÂ∏ÆÂä©Áî®Êà∑ÁÅµÊ¥ª„ÄÅÈ´òÊïàÂú∞ÂºÄÂèëÂíåÈõÜÊàêÂ§çÊùÇÁöÑÂ∫îÁî®ËΩØ‰ª∂ IDCÁöÑÂÆö‰πâÊòØÔºö‰∏≠Èó¥‰ª∂ÊòØ‰∏ÄÁßçÁã¨Á´ãÁöÑÁ≥ªÁªüËΩØ‰ª∂ÊàñÊúçÂä°Á®ãÂ∫èÔºåÂàÜÂ∏ÉÂºèÂ∫îÁî®ËΩØ‰ª∂ÂÄüÂä©ËøôÁßçËΩØ‰ª∂Âú®‰∏çÂêåÁöÑÊäÄÊúØ‰πãÈó¥ÂÖ±‰∫´ËµÑÊ∫êÔºå‰∏≠Èó¥‰ª∂‰Ωç‰∫éÂÆ¢Êà∑Êú∫ÊúçÂä°Âô®ÁöÑÊìç‰ΩúÁ≥ªÁªü‰πã‰∏äÔºåÁÆ°ÁêÜËÆ°ÁÆóËµÑÊ∫êÂíåÁΩëÁªúÈÄö‰ø°„ÄÇ ‰∏≠Èó¥‰ª∂Ëß£ÂÜ≥ÁöÑÈóÆÈ¢òÊòØÔºö Âú®‰∏≠Èó¥‰ª∂‰∫ßÁîü‰ª•ÂâçÔºåÂ∫îÁî®ËΩØ‰ª∂Áõ¥Êé•‰ΩøÁî®Êìç‰ΩúÁ≥ªÁªü„ÄÅÁΩëÁªúÂçèËÆÆÂíåÊï∞ÊçÆÂ∫ìÁ≠âÂºÄÂèëÔºåËøô‰∫õÈÉΩÊòØËÆ°ÁÆóÊú∫ÊúÄÂ∫ïÂ±ÇÁöÑ‰∏úË•øÔºåË∂äÂ∫ïÂ±ÇË∂äÂ§çÊùÇÔºåÂºÄÂèëËÄÖ‰∏çÂæó‰∏çÈù¢‰∏¥ËÆ∏Â§öÂæàÊ£òÊâãÁöÑÈóÆÈ¢òÔºåÂ¶ÇÊìç‰ΩúÁ≥ªÁªüÁöÑÂ§öÊ†∑ÊÄßÔºåÁπÅÊùÇÁöÑÁΩëÁªúÁ®ãÂ∫èËÆæËÆ°„ÄÅÁÆ°ÁêÜÔºåÂ§çÊùÇÂ§öÂèòÁöÑÁΩëÁªúÁéØÂ¢ÉÔºåÊï∞ÊçÆÂàÜÊï£Â§ÑÁêÜÂ∏¶Êù•ÁöÑ‰∏ç‰∏ÄËá¥ÊÄßÈóÆÈ¢ò„ÄÅÊÄßËÉΩÂíåÊïàÁéá„ÄÅÂÆâÂÖ®ÔºåÁ≠âÁ≠â„ÄÇËøô‰∫õ‰∏éÁî®Êà∑ÁöÑ‰∏öÂä°Ê≤°ÊúâÁõ¥Êé•ÂÖ≥Á≥ªÔºå‰ΩÜÂèàÂøÖÈ°ªËß£ÂÜ≥ÔºåËÄóË¥π‰∫ÜÂ§ßÈáèÊúâÈôêÁöÑÊó∂Èó¥ÂíåÁ≤æÂäõ„ÄÇ‰∫éÊòØÔºåÊúâ‰∫∫ÊèêÂá∫ËÉΩ‰∏çËÉΩÂ∞ÜÂ∫îÁî®ËΩØ‰ª∂ÊâÄË¶ÅÈù¢‰∏¥ÁöÑÂÖ±ÊÄßÈóÆÈ¢òËøõË°åÊèêÁÇº„ÄÅÊäΩË±°ÔºåÂú®Êìç‰ΩúÁ≥ªÁªü‰πã‰∏äÂÜçÂΩ¢Êàê‰∏Ä‰∏™ÂèØÂ§çÁî®ÁöÑÈÉ®ÂàÜÔºå‰æõÊàêÂçÉ‰∏ä‰∏áÁöÑÂ∫îÁî®ËΩØ‰ª∂ÈáçÂ§ç‰ΩøÁî®„ÄÇËøô‰∏ÄÊäÄÊúØÊÄùÊÉ≥ÊúÄÁªàÊûÑÊàê‰∫Ü‰∏≠Èó¥‰ª∂ËøôÁ±ªÁöÑËΩØ‰ª∂„ÄÇ‰∏≠Èó¥‰ª∂Â±èËîΩ‰∫ÜÂ∫ïÂ±ÇÊìç‰ΩúÁ≥ªÁªüÁöÑÂ§çÊùÇÊÄßÔºå‰ΩøÁ®ãÂ∫èÂºÄÂèë‰∫∫ÂëòÈù¢ÂØπ‰∏Ä‰∏™ÁÆÄÂçïËÄåÁªü‰∏ÄÁöÑÂºÄÂèëÁéØÂ¢ÉÔºåÂáèÂ∞ëÁ®ãÂ∫èËÆæËÆ°ÁöÑÂ§çÊùÇÊÄßÔºåÂ∞ÜÊ≥®ÊÑèÂäõÈõÜ‰∏≠Âú®Ëá™Â∑±ÁöÑ‰∏öÂä°‰∏äÔºå‰∏çÂøÖÂÜç‰∏∫Á®ãÂ∫èÂú®‰∏çÂêåÁ≥ªÁªüËΩØ‰ª∂‰∏äÁöÑÁßªÊ§çËÄåÈáçÂ§çÂ∑•‰ΩúÔºå‰ªéËÄåÂ§ßÂ§ßÂáèÂ∞ë‰∫ÜÊäÄÊúØ‰∏äÁöÑË¥üÊãÖ„ÄÇ 36. ÊÄé‰πàËÆæËÆ°ormÔºåËÆ©‰Ω†ÂÜô,‰Ω†‰ºöÊÄé‰πàÂÜô?37. Áî®ËøáÂéüÁîüÁöÑhttpÂåÖÂêóÔºü38. ‰∏Ä‰∏™ÈùûÂ∏∏Â§ßÁöÑÊï∞ÁªÑÔºåËÆ©ÂÖ∂‰∏≠‰∏§‰∏™Êï∞ÊÉ≥Âä†Á≠â‰∫é1000ÊÄé‰πàÁÆó?39. ÂêÑ‰∏™Á≥ªÁªüÂá∫ÈóÆÈ¢òÊÄé‰πàÁõëÊéßÊä•Ë≠¶.ÂèØ‰ª•‰ΩøÁî®prometheusÊê≠ÈÖçkongÁΩëÂÖ≥ÔºåÁõëÊéßÂêÑ‰∏™Á≥ªÁªüÁöÑÊé•Âè£ËΩ¨ÂèëÂ§ÑÔºåËøõË°åÂ§ÑÁêÜÊä•Ë≠¶ÔºåÁÑ∂Âêé‰∏äÊä•‰πãÂêéÔºåËÆæÁΩÆÈòàÂÄºÔºåÊä•Ë≠¶ÂíåËá™ÊÅ¢Â§çÁ≥ªÁªüËÆæËÆ°„ÄÇ 40. Â∏∏Áî®ÊµãËØïÂ∑•ÂÖ∑ÔºåÂéãÊµãÂ∑•ÂÖ∑ÔºåÊñπÊ≥ï?1goconvey,vegeta 41. Â§çÊùÇÁöÑÂçïÂÖÉÊµãËØïÊÄé‰πàÊµãËØïÔºåÊØîÂ¶ÇÊúâÂ§ñÈÉ®Êé•Âè£mysqlÊé•Âè£ÁöÑÊÉÖÂÜµ42. redisÈõÜÁæ§ÔºåÂì®ÂÖµÔºåÊåÅ‰πÖÂåñÔºå‰∫ãÂä°43. mysqlÂíåredisÂå∫Âà´ÊòØ‰ªÄ‰πàÔºü mysqlÂíåredisÁöÑÊï∞ÊçÆÂ∫ìÁ±ªÂûã mysqlÊòØÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÔºå‰∏ªË¶ÅÁî®‰∫éÂ≠òÊîæÊåÅ‰πÖÂåñÊï∞ÊçÆÔºåÂ∞ÜÊï∞ÊçÆÂ≠òÂÇ®Âú®Á°¨Áõò‰∏≠ÔºåËØªÂèñÈÄüÂ∫¶ËæÉÊÖ¢„ÄÇ redisÊòØNOSQLÔºåÂç≥ÈùûÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÔºå‰πüÊòØÁºìÂ≠òÊï∞ÊçÆÂ∫ìÔºåÂç≥Â∞ÜÊï∞ÊçÆÂ≠òÂÇ®Âú®ÁºìÂ≠ò‰∏≠ÔºåÁºìÂ≠òÁöÑËØªÂèñÈÄüÂ∫¶Âø´ÔºåËÉΩÂ§üÂ§ßÂ§ßÁöÑÊèêÈ´òËøêË°åÊïàÁéáÔºå‰ΩÜÊòØ‰øùÂ≠òÊó∂Èó¥ÊúâÈôê„ÄÇ mysqlÁöÑËøêË°åÊú∫Âà∂ mysql‰Ωú‰∏∫ÊåÅ‰πÖÂåñÂ≠òÂÇ®ÁöÑÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÔºåÁõ∏ÂØπËñÑÂº±ÁöÑÂú∞ÊñπÂú®‰∫éÊØèÊ¨°ËØ∑Ê±ÇËÆøÈóÆÊï∞ÊçÆÂ∫ìÊó∂ÔºåÈÉΩÂ≠òÂú®ÁùÄI/OÊìç‰ΩúÔºåÂ¶ÇÊûúÂèçÂ§çÈ¢ëÁπÅÁöÑËÆøÈóÆÊï∞ÊçÆÂ∫ì„ÄÇÁ¨¨‰∏ÄÔºö‰ºöÂú®ÂèçÂ§çÈìæÊé•Êï∞ÊçÆÂ∫ì‰∏äËä±Ë¥πÂ§ßÈáèÊó∂Èó¥Ôºå‰ªéËÄåÂØºËá¥ËøêË°åÊïàÁéáËøáÊÖ¢ÔºõÁ¨¨‰∫åÔºöÂèçÂ§çÁöÑËÆøÈóÆÊï∞ÊçÆÂ∫ì‰πü‰ºöÂØºËá¥Êï∞ÊçÆÂ∫ìÁöÑË¥üËΩΩËøáÈ´òÔºåÈÇ£‰πàÊ≠§Êó∂ÁºìÂ≠òÁöÑÊ¶ÇÂøµÂ∞±Ë°çÁîü‰∫ÜÂá∫Êù•„ÄÇ ÁºìÂ≠ò ÁºìÂ≠òÂ∞±ÊòØÊï∞ÊçÆ‰∫§Êç¢ÁöÑÁºìÂÜ≤Âå∫ÔºàcacheÔºâÔºåÂΩìÊµèËßàÂô®ÊâßË°åËØ∑Ê±ÇÊó∂ÔºåÈ¶ñÂÖà‰ºöÂØπÂú®ÁºìÂ≠ò‰∏≠ËøõË°åÊü•ÊâæÔºåÂ¶ÇÊûúÂ≠òÂú®ÔºåÂ∞±Ëé∑ÂèñÔºõÂê¶ÂàôÂ∞±ËÆøÈóÆÊï∞ÊçÆÂ∫ì„ÄÇ ÁºìÂ≠òÁöÑÂ•ΩÂ§ÑÂ∞±ÊòØËØªÂèñÈÄüÂ∫¶Âø´„ÄÇ redisÊï∞ÊçÆÂ∫ì redisÊï∞ÊçÆÂ∫ìÂ∞±ÊòØ‰∏ÄÊ¨æÁºìÂ≠òÊï∞ÊçÆÂ∫ìÔºåÁî®‰∫éÂ≠òÂÇ®‰ΩøÁî®È¢ëÁπÅÁöÑÊï∞ÊçÆÔºåËøôÊ†∑ÂáèÂ∞ëËÆøÈóÆÊï∞ÊçÆÂ∫ìÁöÑÊ¨°Êï∞ÔºåÊèêÈ´òËøêË°åÊïàÁéá„ÄÇ redisÂíåmysqlÁöÑÂå∫Âà´ÊÄªÁªì Ôºà1ÔºâÁ±ªÂûã‰∏ä ‰ªéÁ±ªÂûã‰∏äÊù•ËØ¥ÔºåmysqlÊòØÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÔºåredisÊòØÁºìÂ≠òÊï∞ÊçÆÂ∫ì Ôºà2Ôºâ‰ΩúÁî®‰∏ä mysqlÁî®‰∫éÊåÅ‰πÖÂåñÁöÑÂ≠òÂÇ®Êï∞ÊçÆÂà∞Á°¨ÁõòÔºåÂäüËÉΩÂº∫Â§ßÔºå‰ΩÜÊòØÈÄüÂ∫¶ËæÉÊÖ¢ redisÁî®‰∫éÂ≠òÂÇ®‰ΩøÁî®ËæÉ‰∏∫È¢ëÁπÅÁöÑÊï∞ÊçÆÂà∞ÁºìÂ≠ò‰∏≠ÔºåËØªÂèñÈÄüÂ∫¶Âø´ Ôºà3ÔºâÈúÄÊ±Ç‰∏ä mysqlÂíåredisÂõ†‰∏∫ÈúÄÊ±ÇÁöÑ‰∏çÂêåÔºå‰∏ÄËà¨ÈÉΩÊòØÈÖçÂêà‰ΩøÁî®„ÄÇ 44. È´òÂèØÁî®ËΩØ‰ª∂ÊòØ‰ªÄ‰πàÔºü Heartbeat HeartbeatÊòØ‰∏Ä‰∏™ÊØîËæÉËÄÅÁâåÁöÑÈõÜÁæ§ÁÆ°ÁêÜËΩØ‰ª∂ÔºåÊúÄÊñ∞ÁâàÊú¨ÊòØV3.0Ôºå ‰πüÁß∞‰∏∫Heartbeat 3.ÈÄöËøáHeartbeatÔºåÂèØ‰ª•ÂÆûÁé∞ÂØπÊúçÂä°Âô®ËµÑÊ∫êÔºàip‰ª•ÂèäÁ®ãÂ∫èÊúçÂä°Á≠âËµÑÊ∫êÔºâÁöÑÁõëÊéßÂíåÁÆ°ÁêÜÔºåÂπ∂Âú®Âá∫Áé∞ÊïÖÈöúÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ∞ÜËµÑÊ∫êÈõÜÂêà‰ªé‰∏ÄÂè∞Â∑≤ÁªèÊïÖÈöúÁöÑËÆ°ÁÆóÊú∫Âø´ÈÄüËΩ¨ÁßªÂà∞Âè¶‰∏ÄÂè∞Ê≠£Â∏∏ËøêËΩ¨ÁöÑÊú∫Âô®‰∏äÁªßÁª≠Êèê‰æõÊúçÂä°„ÄÇ Keepalived Keepalived‰πüÊòØ‰∏ÄÊ¨æÈ´òÂèØÁî®ÈõÜÁæ§ÁÆ°ÁêÜËΩØ‰ª∂ÔºåÂÖ∂Âü∫Êú¨ÂäüËÉΩ‰∏éHeartbeatÈùûÂ∏∏Á±ª‰ºº„ÄÇ KeepalivedÂÆÉÁöÑÂäüËÉΩ‰∏ªË¶ÅÂåÖÊã¨‰∏§ÊñπÈù¢Ôºö 1ÔºâÈÄöËøáIPÊºÇÁßªÔºåÂÆûÁé∞ÊúçÂä°ÁöÑÈ´òÂèØÁî®ÔºöÊúçÂä°Âô®ÈõÜÁæ§ÂÖ±‰∫´‰∏Ä‰∏™ËôöÊãüIPÔºåÂêå‰∏ÄÊó∂Èó¥Âè™Êúâ‰∏Ä‰∏™ÊúçÂä°Âô®Âç†ÊúâËôöÊãüIPÂπ∂ÂØπÂ§ñÊèê‰æõÊúçÂä°ÔºåËã•ËØ•ÊúçÂä°Âô®‰∏çÂèØÁî®ÔºåÂàôËôöÊãüIPÊºÇÁßªËá≥Âè¶‰∏ÄÂè∞ÊúçÂä°Âô®Âπ∂ÂØπÂ§ñÊèê‰æõÊúçÂä°Ôºõ 2ÔºâÂØπLVSÂ∫îÁî®ÊúçÂä°Â±ÇÁöÑÂ∫îÁî®ÊúçÂä°Âô®ÈõÜÁæ§ËøõË°åÁä∂ÊÄÅÁõëÊéßÔºöËã•Â∫îÁî®ÊúçÂä°Âô®‰∏çÂèØÁî®ÔºåÂàôkeepalivedÂ∞ÜÂÖ∂‰ªéÈõÜÁæ§‰∏≠ÊëòÈô§ÔºåËã•Â∫îÁî®ÊúçÂä°Âô®ÊÅ¢Â§çÔºåÂàôkeepalivedÂ∞ÜÂÖ∂ÈáçÊñ∞Âä†ÂÖ•ÈõÜÁæ§‰∏≠„ÄÇ KeepalivedÂèØ‰ª•ÂçïÁã¨‰ΩøÁî®ÔºåÂç≥ÈÄöËøáIPÊºÇÁßªÂÆûÁé∞ÊúçÂä°ÁöÑÈ´òÂèØÁî®Ôºå‰πüÂèØ‰ª•ÁªìÂêàLVS‰ΩøÁî®ÔºåÂç≥‰∏ÄÊñπÈù¢ÈÄöËøáIPÊºÇÁßªÂÆûÁé∞LVSË¥üËΩΩÂùáË°°Â±ÇÁöÑÈ´òÂèØÁî®ÔºåÂè¶‰∏ÄÊñπÈù¢ÂÆûÁé∞LVSÂ∫îÁî®ÊúçÂä°Â±ÇÁöÑÁä∂ÊÄÅÁõëÊéß„ÄÇ 45. ÊÄé‰πàÊêû‰∏Ä‰∏™Âπ∂ÂèëÊúçÂä°Á®ãÂ∫èÔºü46. ËÆ≤Ëß£‰∏Ä‰∏ã‰Ω†ÂÅöËøáÁöÑÈ°πÁõÆÔºåÁÑ∂ÂêéÊâæÈóÆÈ¢òÈóÆÂÆûÁé∞ÁªÜËäÇ„ÄÇ47. mysql‰∫ãÂä°ËØ¥‰∏ã‰∫ãÂä°ÊòØ‰∏ÄÁªÑÂéüÂ≠êÊÄßÁöÑsqlÂëΩ‰ª§ÊàñËÄÖËØ¥ÊòØ‰∏Ä‰∏™Áã¨Á´ãÁöÑÂ∑•‰ΩúÂçïÂÖÉ,Â¶ÇÊûúÊï∞ÊçÆÂ∫ìÂºïÊìéËÉΩÂ§üÊàêÂäüÁöÑÂØπÊï∞ÊçÆÂ∫ìÂ∫îÁî®ËØ•ÁªÑÁöÑÂÖ®ÈÉ®sqlËØ≠Âè•,ÈÇ£‰πàÂ∞±ÊâßË°åËØ•ÁªÑÂëΩ‰ª§Â¶ÇÊûúÂÖ∂‰∏≠Êúâ‰ªª‰Ωï‰∏ÄÊù°ËØ≠Âè•Âõ†‰∏∫Â¥©Ê∫ÉÊàñËÄÖÂÖ∂ÂÆÉÂéüÂõ†Êó†Ê≥ïÊâßË°å,ÈÇ£‰πàËØ•ÁªÑ‰∏≠ÊâÄÊúâÁöÑsqlËØ≠Âè•ÈÉΩ‰∏ç‰ºöÊâßË°å,Â¶ÇÊûúÊ≤°ÊúâÊòæÁ§∫ÂêØÂä®‰∫ãÂä°,Êï∞ÊçÆÂ∫ì‰ºöÊ†πÊçÆautocommitÁöÑÂÄº.ÈªòËÆ§ÊØèÊù°sqlÊìç‰ΩúÈÉΩ‰ºöËá™Âä®Êèê‰∫§„ÄÇ ÂéüÂ≠êÊÄß ‰∏Ä‰∏™‰∫ãÂä°‰∏≠ÁöÑÊâÄÊúâÊìç‰Ωú,Ë¶Å‰πàÈÉΩÂÆåÊàê,Ë¶Å‰πàÈÉΩ‰∏çÊâßË°å.ÂØπ‰∫é‰∏Ä‰∏™‰∫ãÂä°Êù•ËØ¥,‰∏çÂèØËÉΩÂè™ÊâßË°åÂÖ∂‰∏≠ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ ‰∏ÄËá¥ÊÄß Êï∞ÊçÆÂ∫ì‰∏ÄËá¥ÊÄßÊòØÊåá‰∫ãÂä°ÂøÖÈ°ª‰ΩøÊï∞ÊçÆÂ∫ì‰ªé‰∏Ä‰∏™‰∏ÄËá¥ÁöÑÁä∂ÊÄÅÂèòÂà∞Âè¶Â§ñ‰∏Ä‰∏™‰∏ÄËá¥ÁöÑÁä∂ÊÄÅÔºå‰πüÂ∞±ÊòØÊâßË°å‰∫ãÂä°‰πãÂâçÂíå‰πãÂêéÁöÑÁä∂ÊÄÅÈÉΩÂøÖÈ°ªÂ§Ñ‰∫é‰∏ÄËá¥ÁöÑÁä∂ÊÄÅ„ÄÇ 1Âú®‰∫ãÂä°TÂºÄÂßãÊó∂ÔºåÊ≠§Êó∂Êï∞ÊçÆÂ∫ìÊúâ‰∏ÄÁßçÁä∂ÊÄÅÔºåËøô‰∏™Áä∂ÊÄÅÊòØÊâÄÊúâÁöÑMySQLÂØπË±°Â§Ñ‰∫é‰∏ÄËá¥ÁöÑÁä∂ÊÄÅÔºå‰æãÂ¶ÇÊï∞ÊçÆÂ∫ìÂÆåÊï¥ÊÄßÁ∫¶ÊùüÊ≠£Á°ÆÔºåÊó•ÂøóÁä∂ÊÄÅ‰∏ÄËá¥Á≠âÔºåÂΩì‰∫ãÂä°TÊèê‰∫§ÂêéÔºåËøôÊó∂Êï∞ÊçÆÂ∫ìÂèàÊúâ‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÁä∂ÊÄÅÔºå‰∏çÂêåÁöÑÊï∞ÊçÆÔºå‰∏çÂêåÁöÑÁ¥¢ÂºïÔºå‰∏çÂêåÁöÑÊó•ÂøóÁ≠âÔºå‰ΩÜÊ≠§Êó∂ÔºåÁ∫¶ÊùüÔºåÊï∞ÊçÆÔºåÁ¥¢ÂºïÔºåÊó•ÂøóÁ≠âMySQLÂêÑÁßçÂØπË±°ËøòÊòØË¶Å‰øùÊåÅ‰∏ÄËá¥ÊÄßÔºàÊ≠£Á°ÆÊÄßÔºâ„ÄÇ ËøôÂ∞±ÊòØ ‰ªé‰∏Ä‰∏™‰∏ÄËá¥ÊÄßÁöÑÁä∂ÊÄÅÔºåÂèòÂà∞Âè¶‰∏Ä‰∏™‰∏ÄËá¥ÊÄßÁöÑÁä∂ÊÄÅ„ÄÇ‰πüÂ∞±ÊòØ‰∫ãÂä°ÊâßË°åÂêéÔºåÂπ∂Ê≤°ÊúâÁ†¥ÂùèÊï∞ÊçÆÂ∫ìÁöÑÂÆåÊï¥ÊÄßÁ∫¶ÊùüÔºà‰∏ÄÂàáÈÉΩÊòØÂØπÁöÑÔºâ„ÄÇ ÈöîÁ¶ªÊÄß ÈöîÁ¶ªÊÄßÊòØÊåáÂΩìÂ§ö‰∏™Áî®Êà∑Âπ∂ÂèëËÆøÈóÆÊï∞ÊçÆÂ∫ìÊó∂ÔºåÊØîÂ¶ÇÊìç‰ΩúÂêå‰∏ÄÂº†Ë°®Êó∂ÔºåÊï∞ÊçÆÂ∫ì‰∏∫ÊØè‰∏Ä‰∏™Áî®Êà∑ÂºÄÂêØÁöÑ‰∫ãÂä°Ôºå‰∏çËÉΩË¢´ÂÖ∂‰ªñ‰∫ãÂä°ÁöÑÊìç‰ΩúÊâÄÂπ≤Êâ∞ÔºåÂ§ö‰∏™Âπ∂Âèë‰∫ãÂä°‰πãÈó¥Ë¶ÅÁõ∏‰∫íÈöîÁ¶ª„ÄÇ 1ÂØπ‰∫é‰ªªÊÑè‰∏§‰∏™Âπ∂ÂèëÁöÑ‰∫ãÂä°T1ÂíåT2ÔºåÂú®‰∫ãÂä°T1ÁúãÊù•ÔºåT2Ë¶Å‰πàÂú®T1ÂºÄÂßã‰πãÂâçÂ∞±Â∑≤ÁªèÁªìÊùüÔºåË¶Å‰πàÂú®T1ÁªìÊùü‰πãÂêéÊâçÂºÄÂßãÔºåËøôÊ†∑ÊØè‰∏™‰∫ãÂä°ÈÉΩÊÑüËßâ‰∏çÂà∞ÊúâÂÖ∂‰ªñ‰∫ãÂä°Âú®Âπ∂ÂèëÂú∞ÊâßË°å„ÄÇ ÊåÅ‰πÖÊÄß ÊåÅ‰πÖÊÄßÊòØÊåá‰∏Ä‰∏™‰∫ãÂä°‰∏ÄÊó¶Ë¢´Êèê‰∫§‰∫ÜÔºåÈÇ£‰πàÂØπ‰∫éÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆÊîπÂèòÂ∞±ÊòØÊ∞∏‰πÖÊÄßÁöÑÔºåÂç≥‰æøÊòØÂú®Êï∞ÊçÆÂ∫ìÁ≥ªÁªüÈÅ≠ÈÅáÂà∞ÊïÖÈöúÁöÑÊÉÖÂÜµ‰∏ã‰πü‰∏ç‰ºö‰∏¢Â§±Êèê‰∫§‰∫ãÂä°ÁöÑÊìç‰Ωú„ÄÇ 1Êàë‰ª¨Âú®‰ΩøÁî®ËøûÊé•Ê±†Êìç‰ΩúÊï∞ÊçÆÂ∫ìÊó∂ÔºåÂú®Êèê‰∫§‰∫ãÂä°ÊñπÊ≥ïÂêéÔºåÊèêÁ§∫Áî®Êà∑‰∫ãÂä°Êìç‰ΩúÂÆåÊàêÔºåÂΩìÊàë‰ª¨Á®ãÂ∫èÊâßË°åÂÆåÊàêÁõ¥Âà∞ÁúãÂà∞ÊèêÁ§∫ÂêéÔºåÂ∞±ÂèØ‰ª•ËÆ§ÂÆö‰∫ãÂä°‰ª•ÂèäÊ≠£Á°ÆÊèê‰∫§ÔºåÂç≥‰ΩøËøôÊó∂ÂÄôÊï∞ÊçÆÂ∫ìÂá∫Áé∞‰∫ÜÈóÆÈ¢òÔºå‰πüÂøÖÈ°ªË¶ÅÂ∞ÜÊàë‰ª¨ÁöÑ‰∫ãÂä°ÂÆåÂÖ®ÊâßË°åÂÆåÊàêÔºåÂê¶ÂàôÂ∞±‰ºöÈÄ†ÊàêÊàë‰ª¨ÁúãÂà∞ÊèêÁ§∫‰∫ãÂä°Â§ÑÁêÜÂÆåÊØïÔºå‰ΩÜÊòØÊï∞ÊçÆÂ∫ìÂõ†‰∏∫ÊïÖÈöúËÄåÊ≤°ÊúâÊâßË°å‰∫ãÂä°ÁöÑÈáçÂ§ßÈîôËØØ„ÄÇ 48. ÊÄé‰πàÂÅö‰∏Ä‰∏™Ëá™Âä®ÂåñÈÖçÁΩÆÂπ≥Âè∞Á≥ªÁªüÔºü49. grpcÈÅµÂæ™‰ªÄ‰πàÂçèËÆÆÔºü50. grpcÂÜÖÈÉ®ÂéüÁêÜÊòØ‰ªÄ‰πàÔºü51. http2ÁöÑÁâπÁÇπÊòØ‰ªÄ‰πàÔºå‰∏éhttp1.1ÁöÑÂØπÊØî„ÄÇ HTTP1.1 HTTP2 QUIC ÊåÅ‰πÖËøûÊé• ‰∫åËøõÂà∂ÂàÜÂ∏ß Âü∫‰∫éUDPÁöÑÂ§öË∑Ø‰º†ËæìÔºàÂçïËøûÊé•‰∏ãÔºâ ËØ∑Ê±ÇÁÆ°ÈÅìÂåñ Â§öË∑ØÂ§çÁî®ÔºàÊàñËøûÊé•ÂÖ±‰∫´Ôºâ ÊûÅ‰ΩéÁöÑÁ≠âÂæÖÊó∂Âª∂ÔºàÁõ∏ÊØî‰∫éTCPÁöÑ‰∏âÊ¨°Êè°ÊâãÔºâ Â¢ûÂä†ÁºìÂ≠òÂ§ÑÁêÜÔºàÊñ∞ÁöÑÂ≠óÊÆµÂ¶Çcache-controlÔºâ Â§¥ÈÉ®ÂéãÁº© QUIC‰∏∫ ‰º†ËæìÂ±Ç ÂçèËÆÆ ÔºåÊàê‰∏∫Êõ¥Â§öÂ∫îÁî®Â±ÇÁöÑÈ´òÊÄßËÉΩÈÄâÊã© Â¢ûÂä†HostÂ≠óÊÆµ„ÄÅÊîØÊåÅÊñ≠ÁÇπ‰º†ËæìÁ≠âÔºàÊääÊñá‰ª∂ÂàÜÊàêÂá†ÈÉ®ÂàÜÔºâ ÊúçÂä°Âô®Êé®ÈÄÅ 52. GoÁöÑË∞ÉÂ∫¶ÂéüÁêÜ. GoË∞ÉÂ∫¶Âô®: M, P Âíå G GoËØ≠Ë®ÄÂÆûÊàòÁ¨îËÆ∞ÔºàÂçÅ‰∫åÔºâ| Go goroutine GolangË∞ÉÂ∫¶Âô®Ê∫êÁ†ÅÂàÜÊûê GoroutineË∞ÉÂ∫¶ËøáÁ®ã 53. go structËÉΩ‰∏çËÉΩÊØîËæÉ Áõ∏ÂêåstructÁ±ªÂûãÁöÑÂèØ‰ª•ÊØîËæÉ ‰∏çÂêåstructÁ±ªÂûãÁöÑ‰∏çÂèØ‰ª•ÊØîËæÉ,ÁºñËØëÈÉΩ‰∏çËøáÔºåÁ±ªÂûã‰∏çÂåπÈÖç 123456789101112131415161718192021package mainimport &quot;fmt&quot;func main() &#123; type A struct &#123; a int &#125; type B struct &#123; a int &#125; a := A&#123;1&#125; //b := A&#123;1&#125; b := B&#123;1&#125; if a == b &#123; fmt.Println(&quot;a == b&quot;) &#125;else&#123; fmt.Println(&quot;a != b&quot;) &#125;&#125; // output// command-line-arguments [command-line-arguments.test]// ./.go:14:7: invalid operation: a == b (mismatched types A and B) go deferÔºàfor deferÔºâ Go ÂÖ≥ÈîÆÂ≠ó defer ÁöÑ‰∏Ä‰∫õÂùë selectÂèØ‰ª•Áî®‰∫é‰ªÄ‰πà? GoÁöÑselect‰∏ªË¶ÅÊòØÂ§ÑÁêÜÂ§ö‰∏™channelÁöÑÊìç‰Ωú. GoËØ≠Ë®ÄÂπ∂ÂèëÊ®°ÂûãÔºö‰ΩøÁî® select contextÂåÖÁöÑÁî®ÈÄîÊòØ‰ªÄ‰πà? godoc: https://golang.org/pkg/context/ Go ContextÁöÑË∏©ÂùëÁªèÂéÜ GoËØ≠Ë®ÄÂÆûÊàòÁ¨îËÆ∞Ôºà‰∫åÂçÅÔºâ| Go Context clientÂ¶Ç‰ΩïÂÆûÁé∞ÈïøËøûÊé•? TCPÂçèËÆÆÁöÑKeepAliveÊú∫Âà∂‰∏éHeartBeatÂøÉË∑≥ÂåÖ HTTP Keep-AliveÊòØ‰ªÄ‰πàÔºüÂ¶Ç‰ΩïÂ∑•‰ΩúÔºü ‰∏ªÂçèÁ®ãÂ¶Ç‰ΩïÁ≠âÂÖ∂‰ΩôÂçèÁ®ãÂÆåÂÜçÊìç‰Ωú? GoÂπ∂ÂèëÔºöÂà©Áî®sync.WaitGroupÂÆûÁé∞ÂçèÁ®ãÂêåÊ≠• GoËØ≠Ë®ÄÈáçÁÇπÁ¨îËÆ∞-Ê∑±ÂÖ•‰∫ÜËß£sync.WaitGroup sliceÔºålenÔºåcapÔºåÂÖ±‰∫´ÔºåÊâ©ÂÆπ. mapÂ¶Ç‰ΩïÈ°∫Â∫èËØªÂèñ? ÂèØ‰ª•ÈÄöËøásort‰∏≠ÁöÑÊéíÂ∫èÂåÖËøõË°åÂØπmap‰∏≠ÁöÑkeyËøõË°åÊéíÂ∫è golang:‰ΩøÁî® sort Êù•ÊéíÂ∫è 1234567891011121314151617181920212223package mainimport ( &quot;fmt&quot; &quot;sort&quot;)func main() &#123; var m = map[string]int&#123; &quot;hello&quot;: 0, &quot;morning&quot;: 1, &quot;my&quot;: 2, &quot;girl&quot;: 3, &#125; var keys []string for k := range m &#123; keys = append(keys, k) &#125; sort.Strings(keys) for _, k := range keys &#123; fmt.Println(&quot;Key:&quot;, k, &quot;Value:&quot;, m[k]) &#125;&#125; ÂÆûÁé∞set Ê†πÊçÆgo‰∏≠mapÁöÑkeysÁöÑÊó†Â∫èÊÄßÂíåÂîØ‰∏ÄÊÄßÔºåÂèØ‰ª•Â∞ÜÂÖ∂‰Ωú‰∏∫set golangÂÆûÁé∞setÈõÜÂêà,ÂèòÁõ∏ÂÆûÁé∞ÂàáÁâáÂéªÈáç ÂÆûÁé∞Ê∂àÊÅØÈòüÂàóÔºàÂ§öÁîü‰∫ßËÄÖÔºåÂ§öÊ∂àË¥πËÄÖÔºâ Ê†πÊçÆGoroutineÂíåchannelÁöÑËØªÂÜôÂèØ‰ª•ÂÆûÁé∞Ê∂àÊÅØÈòüÂàóÔºå golang channelÂ§öÁîü‰∫ßËÄÖÂíåÂ§öÊ∂àË¥πËÄÖÂÆû‰æã Â§ßÊñá‰ª∂ÊéíÂ∫è „ÄêÁÆóÊ≥ï„ÄëÂØπ‰∏Ä‰∏™20GBÂ§ßÁöÑÊñá‰ª∂ÊéíÂ∫è 64.Âü∫Êú¨ÊéíÂ∫èÔºåÂì™‰∫õÊòØÁ®≥ÂÆöÁöÑ ÈÄâÊã©ÊéíÂ∫è„ÄÅÂø´ÈÄüÊéíÂ∫è„ÄÅÂ∏åÂ∞îÊéíÂ∫è„ÄÅÂ†ÜÊéíÂ∫è‰∏çÊòØÁ®≥ÂÆöÁöÑÊéíÂ∫èÁÆóÊ≥ïÔºå ÂÜíÊ≥°ÊéíÂ∫è„ÄÅÊèíÂÖ•ÊéíÂ∫è„ÄÅÂΩíÂπ∂ÊéíÂ∫èÂíåÂü∫Êï∞ÊéíÂ∫èÊòØÁ®≥ÂÆöÁöÑÊéíÂ∫èÁÆóÊ≥ï Á®≥ÂÆöÊéíÂ∫èÂíå‰∏çÁ®≥ÂÆöÊéíÂ∫è Http getË∑ühead get:Ëé∑ÂèñÁî±Request-URIÊ†áËØÜÁöÑ‰ªª‰Ωï‰ø°ÊÅØ(‰ª•ÂÆû‰ΩìÁöÑÂΩ¢Âºè)ÔºåÂ¶ÇÊûúRequest-URIÂºïÁî®Êüê‰∏™Êï∞ÊçÆÂ§ÑÁêÜËøáÁ®ãÔºåÂàôÂ∫îËØ•‰ª•ÂÆÉ‰∫ßÁîüÁöÑÊï∞ÊçÆ‰Ωú‰∏∫Âú®ÂìçÂ∫î‰∏≠ÁöÑÂÆû‰ΩìÔºåËÄå‰∏çÊòØËØ•ËøáÁ®ãÁöÑÊ∫ê‰ª£Á†ÅÊñáÊú¨ÔºåÈô§ÈùûËØ•ËøáÁ®ãÁ¢∞Â∑ßËæìÂá∫ËØ•ÊñáÊú¨„ÄÇ head: Èô§‰∫ÜÊúçÂä°Âô®‰∏çËÉΩÂú®ÂìçÂ∫î‰∏≠ËøîÂõûÊ∂àÊÅØ‰ΩìÔºåHEADÊñπÊ≥ï‰∏éGETÁõ∏Âêå„ÄÇÁî®Êù•Ëé∑ÂèñÊöóÁ§∫ÂÆû‰ΩìÁöÑÂÖÉ‰ø°ÊÅØÔºåËÄå‰∏çÈúÄË¶Å‰º†ËæìÂÆû‰ΩìÊú¨Ë∫´„ÄÇÂ∏∏Áî®‰∫éÊµãËØïË∂ÖÊñáÊú¨ÈìæÊé•ÁöÑÊúâÊïàÊÄß„ÄÅÂèØÁî®ÊÄßÂíåÊúÄËøëÁöÑ‰øÆÊîπ„ÄÇ Http‰ªãÁªç Http 401,403 401 UnauthorizedÔºö ËØ•HTTPÁä∂ÊÄÅÁ†ÅË°®Á§∫ËÆ§ËØÅÈîôËØØÔºåÂÆÉÊòØ‰∏∫‰∫ÜËÆ§ËØÅËÆæËÆ°ÁöÑÔºåËÄå‰∏çÊòØ‰∏∫‰∫ÜÊéàÊùÉËÆæËÆ°ÁöÑ„ÄÇÊî∂Âà∞401ÂìçÂ∫îÔºåË°®Á§∫ËØ∑Ê±ÇÊ≤°ÊúâË¢´ËÆ§ËØÅ‚ÄîÂéãÊ†πÊ≤°ÊúâËÆ§ËØÅÊàñËÄÖËÆ§ËØÅ‰∏çÊ≠£Á°Æ‚Äî‰ΩÜÊòØËØ∑ÈáçÊñ∞ËÆ§ËØÅÂíåÈáçËØï„ÄÇÔºà‰∏ÄËà¨Âú®ÂìçÂ∫îÂ§¥ÈÉ®ÂåÖÂê´‰∏Ä‰∏™WWW-AuthenticateÊù•ÊèèËø∞Â¶Ç‰ΩïËÆ§ËØÅÔºâ„ÄÇÈÄöÂ∏∏Áî±webÊúçÂä°Âô®ËøîÂõûÔºåËÄå‰∏çÊòØwebÂ∫îÁî®„ÄÇ‰ªéÊÄßË¥®‰∏äÊù•ËØ¥ÊòØ‰∏¥Êó∂ÁöÑ‰∏úË•ø„ÄÇÔºàÊúçÂä°Âô®Ë¶ÅÊ±ÇÂÆ¢Êà∑Á´ØÈáçËØïÔºâ 403 ForbiddenÔºöËØ•HTTPÁä∂ÊÄÅÁ†ÅÊòØÂÖ≥‰∫éÊéàÊùÉÊñπÈù¢ÁöÑ„ÄÇ‰ªéÊÄßË¥®‰∏äÊù•ËØ¥ÊòØÊ∞∏‰πÖÁöÑ‰∏úË•øÔºåÂíåÂ∫îÁî®ÁöÑ‰∏öÂä°ÈÄªËæëÁõ∏ÂÖ≥ËÅî„ÄÇÂÆÉÊØî401Êõ¥ÂÖ∑‰ΩìÔºåÊõ¥ÂÆûÈôÖ„ÄÇÊî∂Âà∞403ÂìçÂ∫îË°®Á§∫ÊúçÂä°Âô®ÂÆåÊàêËÆ§ËØÅËøáÁ®ãÔºå‰ΩÜÊòØÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÊ≤°ÊúâÊùÉÈôêÂéªËÆøÈóÆË¶ÅÊ±ÇÁöÑËµÑÊ∫ê„ÄÇ ÊÄªÁöÑÊù•ËØ¥Ôºå401 UnauthorizedÂìçÂ∫îÂ∫îËØ•Áî®Êù•Ë°®Á§∫Áº∫Â§±ÊàñÈîôËØØÁöÑËÆ§ËØÅÔºõ403 ForbiddenÂìçÂ∫îÂ∫îËØ•Âú®Ëøô‰πãÂêéÁî®ÔºåÂΩìÁî®Êà∑Ë¢´ËÆ§ËØÅÂêéÔºå‰ΩÜÁî®Êà∑Ê≤°ÊúâË¢´ÊéàÊùÉÂú®ÁâπÂÆöËµÑÊ∫ê‰∏äÊâßË°åÊìç‰Ωú„ÄÇ HTTPÂìçÂ∫îÁ†Å403 ForbiddenÂíå401 UnauthorizedÂØπÊØî 67.Http keep-alive HttpËÉΩ‰∏çËÉΩ‰∏ÄÊ¨°ËøûÊé•Â§öÊ¨°ËØ∑Ê±ÇÔºå‰∏çÁ≠âÂêéÁ´ØËøîÂõû TCP Âíå UDP Êúâ‰ªÄ‰πàÂå∫Âà´,ÈÄÇÁî®Âú∫ÊôØ TCP ÊòØÈù¢ÂêëËøûÊé•ÁöÑÔºåUDP ÊòØÈù¢ÂêëÊó†ËøûÊé•ÁöÑÔºõÊïÖ TCP ÈúÄË¶ÅÂª∫Á´ãËøûÊé•ÂíåÊñ≠ÂºÄËøûÊé•ÔºåUDP ‰∏çÈúÄË¶Å„ÄÇ TCP ÊòØÊµÅÂçèËÆÆÔºåUDP ÊòØÊï∞ÊçÆÂåÖÂçèËÆÆÔºõÊïÖ TCP Êï∞ÊçÆÊ≤°ÊúâÂ§ßÂ∞èÈôêÂà∂ÔºåUDP Êï∞ÊçÆÊä•ÊúâÂ§ßÂ∞èÈôêÂà∂ÔºàUDP ÂçèËÆÆÊú¨Ë∫´ÈôêÂà∂„ÄÅÊï∞ÊçÆÈìæË∑ØÂ±ÇÁöÑ MTU„ÄÅÁºìÂ≠òÂå∫Â§ßÂ∞èÔºâ„ÄÇ TCP ÊòØÂèØÈù†ÂçèËÆÆÔºåUDP ÊòØ‰∏çÂèØÈù†ÂçèËÆÆÔºõÊïÖ TCP ‰ºöÂ§ÑÁêÜÊï∞ÊçÆ‰∏¢ÂåÖÈáçÂèë‰ª•Âèä‰π±Â∫èÁ≠âÊÉÖÂÜµÔºåUDP Âàô‰∏ç‰ºöÂ§ÑÁêÜ„ÄÇ UDP ÁöÑÁâπÁÇπÂèä‰ΩøÁî®Âú∫ÊôØ: UDP ‰∏çÊèê‰æõÂ§çÊùÇÁöÑÊéßÂà∂Êú∫Âà∂ÔºåÂà©Áî® IP Êèê‰æõÈù¢ÂêëÊó†ËøûÊé•ÁöÑÈÄö‰ø°ÊúçÂä°ÔºåÈöèÊó∂ÈÉΩÂèØ‰ª•ÂèëÈÄÅÊï∞ÊçÆÔºåÂ§ÑÁêÜÁÆÄÂçï‰∏îÈ´òÊïàÔºåÁªèÂ∏∏Áî®‰∫é‰ª•‰∏ãÂú∫ÊôØÔºö ÂåÖÊÄªÈáèËæÉÂ∞èÁöÑÈÄö‰ø°ÔºàDNS„ÄÅSNMPÔºâ ËßÜÈ¢ë„ÄÅÈü≥È¢ëÁ≠âÂ§öÂ™í‰ΩìÈÄö‰ø°ÔºàÂç≥Êó∂ÈÄö‰ø°Ôºâ ÂπøÊí≠ÈÄö‰ø° TCP ÁöÑÁâπÁÇπÂèä‰ΩøÁî®Âú∫ÊôØ: Áõ∏ÂØπ‰∫é UDPÔºåTCP ÂÆûÁé∞‰∫ÜÊï∞ÊçÆ‰º†ËæìËøáÁ®ã‰∏≠ÁöÑÂêÑÁßçÊéßÂà∂ÔºåÂèØ‰ª•ËøõË°å‰∏¢ÂåÖÊó∂ÁöÑÈáçÂèëÊéßÂà∂ÔºåËøòÂèØ‰ª•ÂØπÊ¨°Â∫è‰π±ÊéâÁöÑÂàÜÂåÖËøõË°åÈ°∫Â∫èÊéßÂà∂„ÄÇ Âú®ÂØπÂèØÈù†ÊÄßË¶ÅÊ±ÇËæÉÈ´òÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØ‰ª•‰ΩøÁî® TCPÔºåÂç≥‰∏çËÄÉËôë UDP ÁöÑÊó∂ÂÄôÔºåÈÉΩÂèØ‰ª•ÈÄâÊã© TCP„ÄÇ iOS Èù¢ËØïÈ¢ò TCP UDP Êúâ‰ªÄ‰πàÂå∫Âà´ÔºüTCP ‰∏∫‰ªÄ‰πàË¶Å‰∏âÊ¨°Êè°ÊâãÔºåÂõõÊ¨°Êå•ÊâãÔºü time-waitÁöÑ‰ΩúÁî® TCP/IPÁä∂ÊÄÅÂõæÁöÑTIME_WAIT‰ΩúÁî® Êï∞ÊçÆÂ∫ìÂ¶Ç‰ΩïÂª∫Á¥¢Âºï Ê≠£Á°ÆÂêàÁêÜÁöÑÂª∫Á´ãMySQLÊï∞ÊçÆÂ∫ìÁ¥¢Âºï Â≠§ÂÑøËøõÁ®ãÔºåÂÉµÂ∞∏ËøõÁ®ã Â≠§ÂÑøËøõÁ®ãÔºö‰∏Ä‰∏™Áà∂ËøõÁ®ãÈÄÄÂá∫ÔºåËÄåÂÆÉÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™Â≠êËøõÁ®ãËøòÂú®ËøêË°åÔºåÈÇ£‰πàÈÇ£‰∫õÂ≠êËøõÁ®ãÂ∞ÜÊàê‰∏∫Â≠§ÂÑøËøõÁ®ã„ÄÇÂ≠§ÂÑøËøõÁ®ãÂ∞ÜË¢´initËøõÁ®ã(ËøõÁ®ãÂè∑‰∏∫1)ÊâÄÊî∂ÂÖªÔºåÂπ∂Áî±initËøõÁ®ãÂØπÂÆÉ‰ª¨ÂÆåÊàêÁä∂ÊÄÅÊî∂ÈõÜÂ∑•‰Ωú„ÄÇ ÂÉµÂ∞∏ËøõÁ®ãÔºö‰∏Ä‰∏™ËøõÁ®ã‰ΩøÁî®forkÂàõÂª∫Â≠êËøõÁ®ãÔºåÂ¶ÇÊûúÂ≠êËøõÁ®ãÈÄÄÂá∫ÔºåËÄåÁà∂ËøõÁ®ãÂπ∂Ê≤°ÊúâË∞ÉÁî®waitÊàñwaitpidËé∑ÂèñÂ≠êËøõÁ®ãÁöÑÁä∂ÊÄÅ‰ø°ÊÅØÔºåÈÇ£‰πàÂ≠êËøõÁ®ãÁöÑËøõÁ®ãÊèèËø∞Á¨¶‰ªçÁÑ∂‰øùÂ≠òÂú®Á≥ªÁªü‰∏≠„ÄÇËøôÁßçËøõÁ®ãÁß∞‰πã‰∏∫ÂÉµÊ≠ªËøõÁ®ã„ÄÇ Ê≠ªÈîÅÊù°‰ª∂ÔºåÂ¶Ç‰ΩïÈÅøÂÖç linuxÂëΩ‰ª§ÔºåÊü•ÁúãÁ´ØÂè£Âç†Áî®ÔºåcpuË¥üËΩΩÔºåÂÜÖÂ≠òÂç†Áî®ÔºåÂ¶Ç‰ΩïÂèëÈÄÅ‰ø°Âè∑Áªô‰∏Ä‰∏™ËøõÁ®ã gitÊñá‰ª∂ÁâàÊú¨Ôºå‰ΩøÁî®È°∫Â∫èÔºåmergeË∑ürebase ÈÄöÂ∏∏‰∏ÄËà¨‰ºöÁî®Âà∞Âì™‰∫õÊï∞ÊçÆÁªìÊûÑ? ÈìæË°®ÂíåÊï∞ÁªÑÁõ∏ÊØî, Êúâ‰ªÄ‰πà‰ºòÁº∫ÁÇπ? Â¶Ç‰ΩïÂà§Êñ≠‰∏§‰∏™Êó†ÁéØÂçïÈìæË°®ÊúâÊ≤°Êúâ‰∫§ÂèâÁÇπ? Â¶Ç‰ΩïÂà§Êñ≠‰∏Ä‰∏™ÂçïÈìæË°®ÊúâÊ≤°ÊúâÁéØ, Âπ∂ÊâæÂá∫ÂÖ•ÁéØÁÇπ? ÊèèËø∞‰∏Ä‰∏ã TCP ÂõõÊ¨°Êå•ÊâãÁöÑËøáÁ®ã‰∏≠ TCP ÊúâÂì™‰∫õÁä∂ÊÄÅ? TCP ÁöÑ LISTEN Áä∂ÊÄÅÊòØ‰ªÄ‰πà? TCP ÁöÑ CLOSE_WAIT Áä∂ÊÄÅÊòØ‰ªÄ‰πà? Âª∫Á´ã‰∏Ä‰∏™ socket ËøûÊé•Ë¶ÅÁªèËøáÂì™‰∫õÊ≠•È™§? Â∏∏ËßÅÁöÑ HTTP Áä∂ÊÄÅÁ†ÅÊúâÂì™‰∫õ? 301Âíå302Êúâ‰ªÄ‰πàÂå∫Âà´? 504Âíå500Êúâ‰ªÄ‰πàÂå∫Âà´? HTTPS Âíå HTTP Êúâ‰ªÄ‰πàÂå∫Âà´? ÁÆóÊ≥ïÈ¢ò: ÊâãÂÜô‰∏Ä‰∏™Âø´ÈÄüÊéíÂ∫è Âø´ÈÄüÊéíÂ∫è: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364func main() &#123; var arr = []int&#123;19,8,16,15,23,34,6,3,1,0,2,9,7&#125; quickAscendingSort(arr, 0, len(arr)-1) fmt.Println(&quot;quickAscendingSort:&quot;,arr) quickDescendingSort(arr, 0, len(arr)-1) fmt.Println(&quot;quickDescendingSort:&quot;,arr)&#125;//ÂçáÂ∫èfunc quickAscendingSort(arr []int, start, end int) &#123; if (start &lt; end) &#123; i, j := start, end key := arr[(start + end)/2] for i &lt;= j &#123; for arr[i] &lt; key &#123; i++ &#125; for arr[j] &gt; key &#123; j-- &#125; if i &lt;= j &#123; arr[i], arr[j] = arr[j], arr[i] i++ j-- &#125; &#125; if start &lt; j &#123; quickAscendingSort(arr, start, j) &#125; if end &gt; i &#123; quickAscendingSort(arr, i, end) &#125; &#125;&#125;//ÈôçÂ∫èfunc quickDescendingSort(arr []int, start, end int) &#123; if (start &lt; end) &#123; i, j := start, end key := arr[(start + end)/2] for i &lt;= j &#123; for arr[i] &gt; key &#123; i++ &#125; for arr[j] &lt; key &#123; j-- &#125; if i &lt;= j &#123; arr[i], arr[j] = arr[j], arr[i] i++ j-- &#125; &#125; if start &lt; j &#123; quickDescendingSort(arr, start, j) &#125; if end &gt; i &#123; quickDescendingSort(arr, i, end) &#125; &#125;&#125; Golang ÈáåÁöÑÈÄÉÈÄ∏ÂàÜÊûêÊòØ‰ªÄ‰πàÔºüÊÄé‰πàÈÅøÂÖçÂÜÖÂ≠òÈÄÉÈÄ∏Ôºü ÈÖçÁΩÆ‰∏≠ÂøÉÂ¶Ç‰Ωï‰øùËØÅ‰∏ÄËá¥ÊÄßÔºü Golang ÁöÑGCËß¶ÂèëÊó∂Êú∫ÊòØ‰ªÄ‰πà? Redis ÈáåÊï∞ÊçÆÁªìÊûÑÁöÑÂÆûÁé∞ÁÜüÊÇâÂêó? EtcdÁöÑRaft‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÂéüÁêÜ? ÂæÆÊúçÂä°Ê¶ÇÂøµ. SLBÂéüÁêÜ. ÂàÜÂ∏ÉÂºè‰∏ÄÁõ¥ÊÄßÂéüÂàô. Â¶Ç‰Ωï‰øùËØÅÊúçÂä°ÂÆïÊú∫ÈÄ†ÊàêÁöÑÂàÜÂ∏ÉÂºèÊúçÂä°ËäÇÁÇπÂ§ÑÁêÜÈóÆÈ¢ò? ÊúçÂä°ÂèëÁé∞ÊÄé‰πàÂÆûÁé∞ÁöÑ. Go‰∏≠ÂàáÁâáÔºåmapÔºåstruct Âú®64‰ΩçÊú∫Âô®‰∏≠Âç†Áî®Â≠óËäÇÊòØÂ§öÂ∞ë? Âú®64‰ΩçÁ≥ªÁªü‰∏ãÔºåGolangÁöÑÂàáÁâáÂç†Áî®Â≠óËäÇÊòØ24‰ΩçÔºåmapÂíåstructÈÉΩÊòØ8‰Ωç. Go‰∏≠ÁöÑdeferÂáΩÊï∞‰ΩøÁî®‰∏ãÈù¢ÁöÑ‰∏§ÁßçÊÉÖÂÜµ‰∏ãÁªìÊûúÊòØÂ§öÂ∞ëÔºå‰∏∫‰ªÄ‰πà? 1234567a := 1defer fmt.Println(&quot;the value of a1:&quot;,a)a++defer func() &#123; fmt.Println(&quot;the value of a2:&quot;,a)&#125;() ËøêË°å: 12the value of a1: 1the value of a1: 2 Á¨¨‰∏ÄÁßçÊÉÖÂÜµÔºö 1defer fmt.Println(&quot;the value of a1:&quot;,a) deferÂª∂ËøüÂáΩÊï∞Ë∞ÉÁî®ÁöÑfmt.Println(a)ÂáΩÊï∞ÁöÑÂèÇÊï∞ÂÄºÂú®deferËØ≠Âè•Âá∫Áé∞Êó∂Â∞±Â∑≤ÁªèÁ°ÆÂÆö‰∫ÜÔºåÊâÄ‰ª•Êó†ËÆ∫ÂêéÈù¢Â¶Ç‰Ωï‰øÆÊîπaÂèòÈáèÈÉΩ‰∏ç‰ºöÂΩ±ÂìçÂª∂ËøüÂáΩÊï∞„ÄÇ Á¨¨‰∫åÁßçÊÉÖÂÜµ: 123defer func() &#123; fmt.Println(&quot;the value of a2:&quot;,a) &#125;() deferÂª∂ËøüÂáΩÊï∞Ë∞ÉÁî®ÁöÑÂáΩÊï∞ÂèÇÊï∞ÁöÑÂÄºÂú®deferÂÆö‰πâÊó∂ÂÄôÂ∞±Á°ÆÂÆö‰∫ÜÔºåËÄådeferÂª∂ËøüÂáΩÊï∞ÂÜÖÈÉ®ÊâÄ‰ΩøÁî®ÁöÑÂÄºÈúÄË¶ÅÂú®Ëøô‰∏™ÂáΩÊï∞ËøêË°åÊó∂ÂÄôÊâçÁ°ÆÂÆö„ÄÇ GolangÈù¢ËØïÂèÇËÄÉ GolangÈù¢ËØï GolangË∞ÉÂ∫¶]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mongodb ÂëΩ‰ª§Ë°åÁôªÂΩïÊìç‰Ωú]]></title>
    <url>%2F2019%2F04%2F11%2Fmongodb-%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%99%BB%E5%BD%95%E6%93%8D%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[Mac OS‰∏ãËΩΩÂÆâË£ÖÂèäÈÖçÁΩÆ‰ΩøÁî®brewÂèØ‰ª•Áõ¥Êé•ÊêûÂÆöÔºåÁÆÄÂçïÊñπ‰æøÔºÅ 1brew install mongodb ÂÆâË£ÖÂÆåÊàêÂêé‰ºöÊèêÁ§∫ÂêØÂä®ÁöÑÊñπÂºèÔºåÂÆâË£Ö‰ΩçÁΩÆÁ≠âÁ≠â‰ø°ÊÅØ„ÄÇ ÂÆâË£ÖÂÆåÊàê ÂÆâË£ÖÂÆåÊàêÂêéÔºåÊåâÁÖßÊèêÁ§∫ÂêØÂä®MongoDBÔºö 1mongod --config /usr/local/etc/mongod.conf ÈÖçÁΩÆÊñá‰ª∂Â∑≤‰øÆÊîπfork=trueÔºåÂõ†Ê≠§ÂêØÂä®ÂêéÂ∞Ü‰ª•ÂêéÂè∞ËøõÁ®ãÊñπÂºèÂ≠òÂú®„ÄÇ MongoDBÂêØÂä® ÁªàÁ´ØËæìÂÖ•mongoËøûÊé•MongoDBÊï∞ÊçÆÂ∫ì(ÈªòËÆ§ËøûÊé•Êú¨Êú∫ÁöÑ27017Á´ØÂè£) 1mongo ÂÆ¢Êà∑Á´ØËøûÊé• ÈÖçÁΩÆÊñá‰ª∂MongoDBÂºïÂÖ•‰∏Ä‰∏™YAML-basedÊ†ºÂºèÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇ Áé∞Âú®ÁöÑÈÖçÁΩÆÊñá‰ª∂/usr/local/etc/mongod.confÊòæÁ§∫Â¶Ç‰∏ãÔºö 12345678910111213141516171819# Êó•ÂøósystemLog:# Êó•Âøó‰∏∫Êñá‰ª∂ destination: file# Êñá‰ª∂‰ΩçÁΩÆ path: /usr/local/var/log/mongodb/mongo.log# ÊòØÂê¶ËøΩÂä† logAppend: true#ËøõÁ®ãprocessManagement:# ÂÆàÊä§ËøõÁ®ãÊñπÂºè fork: truestorage: dbPath: /usr/local/var/mongodbnet:# ÁªëÂÆöIPÔºåÈªòËÆ§127.0.0.1ÔºåÂè™ËÉΩÊú¨Êú∫ËÆøÈóÆ bindIp: 127.0.0.1# Á´ØÂè£ port: 27017 CentOS 7 ÂÆâË£ÖMongoDBËØ¶ÁªÜÊ≠•È™§ÂàõÂª∫/etc/yum.repos.d/mongodb-org-4.0.repoÊñá‰ª∂ÔºåÁºñËæëÂÜÖÂÆπÂ¶Ç‰∏ãÔºö 123456[mongodb-org-4.0]name=MongoDB Repositorybaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/4.0/x86_64/gpgcheck=1enabled=1gpgkey=https://www.mongodb.org/static/pgp/server-4.0.asc ËøêË°å‰ª•‰∏ãÂëΩ‰ª§ÂÆâË£ÖÊúÄÊñ∞ÁâàÁöÑmongodbÔºö 1sudo yum install -y mongodb-org ÈÖçÁΩÆmongod.confÂÖÅËÆ∏ËøúÁ®ãËøûÊé•Ôºö 1234$ vim /etc/mongod.conf# Listen to all ip addressbind_ip = 0.0.0.0 ÂêØÂä®mongodbÔºö 1sudo service mongod start ÂàõÂª∫ÁÆ°ÁêÜÂëòÁî®Êà∑Ôºö 123456789$ mongo&gt;use admin db.createUser( &#123; user: &quot;myUserAdmin&quot;, pwd: &quot;abc123&quot;, roles: [ &#123; role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; &#125;, &quot;readWriteAnyDatabase&quot; ] &#125; ) ÂêØÁî®ÊùÉÈôêÁÆ°ÁêÜÔºö 12345$ vim /etc/mongod.conf#security security: authorization: enabled ÈáçÂêØmongodbÔºö 1sudo service mongod restart Mongodb Áî®Êà∑È™åËØÅÁôªÈôÜÂêØÂä®Â∏¶ËÆøÈóÆÊéßÂà∂ÁöÑ Mongodb Êñ∞Âª∫ÁªàÁ´Ø 1mongod --auth --port 27017 --dbpath /data/db1 Áé∞Âú®Êúâ‰∏§ÁßçÊñπÂºèËøõË°åÁî®Êà∑Ë∫´‰ªΩÁöÑÈ™åËØÅ Á¨¨‰∏ÄÁßç ÔºàÁ±ª‰ºº MySqlÔºâ ÂÆ¢Êà∑Á´ØËøûÊé•Êó∂ÔºåÊåáÂÆöÁî®Êà∑ÂêçÔºåÂØÜÁ†ÅÔºådbÂêçÁß∞ 1mongo --port 27017 -u &quot;adminUser&quot; -p &quot;adminPass&quot; --authenticationDatabase &quot;admin&quot; Á¨¨‰∫åÁßç ÂÆ¢Êà∑Á´ØËøûÊé•ÂêéÔºåÂÜçËøõË°åÈ™åËØÅ 123456mongo --port 27017use admindb.auth(&quot;adminUser&quot;, &quot;adminPass&quot;)// ËæìÂá∫ 1 Ë°®Á§∫È™åËØÅÊàêÂäü ÂàõÂª∫ÊôÆÈÄöÁî®Êà∑ËøáÁ®ãÁ±ª‰ººÂàõÂª∫ÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºåÂè™ÊòØ role ÊúâÊâÄ‰∏çÂêå 12345678910use foodb.createUser( &#123; user: &quot;simpleUser&quot;, pwd: &quot;simplePass&quot;, roles: [ &#123; role: &quot;readWrite&quot;, db: &quot;foo&quot; &#125;, &#123; role: &quot;read&quot;, db: &quot;bar&quot; &#125; ] &#125;) Áé∞Âú®Êàë‰ª¨Êúâ‰∫Ü‰∏Ä‰∏™ÊôÆÈÄöÁî®Êà∑ Áî®Êà∑ÂêçÔºösimpleUser ÂØÜÁ†ÅÔºösimplePass ÊùÉÈôêÔºöËØªÂÜôÊï∞ÊçÆÂ∫ì fooÔºå Âè™ËØªÊï∞ÊçÆÂ∫ì bar„ÄÇ Ê≥®ÊÑè NOTE WARN use fooË°®Á§∫Áî®Êà∑Âú® foo Â∫ì‰∏≠ÂàõÂª∫ÔºåÂ∞±‰∏ÄÂÆöË¶Å foo Â∫ìÈ™åËØÅË∫´‰ªΩÔºåÂç≥Áî®Êà∑ÁöÑ‰ø°ÊÅØË∑üÈöèÈöèÊï∞ÊçÆÂ∫ì„ÄÇÊØîÂ¶Ç‰∏äËø∞ simpleUser ËôΩÁÑ∂Êúâ bar Â∫ìÁöÑËØªÂèñÊùÉÈôêÔºå‰ΩÜÊòØ‰∏ÄÂÆöË¶ÅÂÖàÂú® foo Â∫ìËøõË°åË∫´‰ªΩÈ™åËØÅÔºåÁõ¥Êé•ËÆøÈóÆ‰ºöÊèêÁ§∫È™åËØÅÂ§±Ë¥•„ÄÇ 12345use foodb.auth(&quot;simpleUser&quot;, &quot;simplePass&quot;)use barshow collections ËøòÊúâ‰∏ÄÁÇπÈúÄË¶ÅÊ≥®ÊÑèÔºåÂ¶ÇÊûú admin Â∫ìÊ≤°Êúâ‰ªª‰ΩïÁî®Êà∑ÁöÑËØùÔºåÂç≥‰ΩøÂú®ÂÖ∂‰ªñÊï∞ÊçÆÂ∫ì‰∏≠ÂàõÂª∫‰∫ÜÁî®Êà∑ÔºåÂêØÁî®Ë∫´‰ªΩÈ™åËØÅÔºåÈªòËÆ§ÁöÑËøûÊé•ÊñπÂºè‰æùÁÑ∂‰ºöÊúâË∂ÖÁ∫ßÊùÉÈôê]]></content>
      <categories>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Scrapy Ëß£ÂÜ≥URLË¢´ÈáçÂÆöÂêëÊó†Ê≥ïÊäìÂèñÂà∞Êï∞ÊçÆÈóÆÈ¢ò301Âíå302]]></title>
    <url>%2F2019%2F04%2F10%2FScrapy-%E8%A7%A3%E5%86%B3URL%E8%A2%AB%E9%87%8D%E5%AE%9A%E5%90%91%E6%97%A0%E6%B3%95%E6%8A%93%E5%8F%96%E5%88%B0%E6%95%B0%E6%8D%AE%E9%97%AE%E9%A2%98301%E5%92%8C302%2F</url>
    <content type="text"><![CDATA[1.‰ªÄ‰πàÊòØÁä∂ÊÄÅÁ†Å301,302 301 Moved PermanentlyÔºàÊ∞∏‰πÖÈáçÂÆöÂêëÔºâ Ë¢´ËØ∑Ê±ÇÁöÑËµÑÊ∫êÂ∑≤Ê∞∏‰πÖÁßªÂä®Âà∞Êñ∞‰ΩçÁΩÆÔºåÂπ∂‰∏îÂ∞ÜÊù•‰ªª‰ΩïÂØπÊ≠§ËµÑÊ∫êÁöÑÂºïÁî®ÈÉΩÂ∫îËØ•‰ΩøÁî®Êú¨ÂìçÂ∫îËøîÂõûÁöÑËã•Âπ≤‰∏™URI‰πã‰∏Ä„ÄÇ Ëß£ÂÜ≥Ôºà‰∏ÄÔºâ 1.Âú®Request‰∏≠Â∞ÜscrapyÁöÑdont_filter=TrueÔºåÂõ†‰∏∫scrapyÊòØÈªòËÆ§ËøáÊª§ÊéâÈáçÂ§çÁöÑËØ∑Ê±ÇURLÔºåÊ∑ªÂä†‰∏äÂèÇÊï∞‰πãÂêéÂç≥‰ΩøË¢´ÈáçÂÆöÂêë‰∫Ü‰πüËÉΩËØ∑Ê±ÇÂà∞Ê≠£Â∏∏ÁöÑÊï∞ÊçÆ‰∫Ü exampleRequest(url, callback=self.next_parse, dont_filter=True)Ëß£ÂÜ≥Ôºà‰∫åÔºâ Âú®scrapyÊ°ÜÊû∂‰∏≠ÁöÑ settings.pyÊñá‰ª∂ÈáåÊ∑ªÂä† HTTPERROR_ALLOWED_CODES = [301]Ëß£ÂÜ≥Ôºà‰∏âÔºâ ‰ΩøÁî®requestsÊ®°ÂùóÈÅáÂà∞301Âíå302ÈóÆÈ¢òÊó∂ def website(): ‚Äòurl‚Äô headers = {‚ÄòAccept‚Äô: ‚Äòtext/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8‚Äô, ‚ÄòAccept-Encoding‚Äô: ‚Äògzip, deflate, sdch, br‚Äô, ‚ÄòAccept-Language‚Äô: ‚Äòzh-CN,zh;q=0.8‚Äô, ‚ÄòConnection‚Äô: ‚Äòkeep-alive‚Äô, ‚ÄòHost‚Äô: ‚Äòpan.baidu.com‚Äô, ‚ÄòUpgrade-Insecure-Requests‚Äô: ‚Äò1‚Äô, ‚ÄòUser-Agent‚Äô: ‚ÄòMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36‚Äô} url = &apos;https://www.baidu.com/&apos; html = requests.get(url, headers=headers, allow_redirects=False) return html.headers[&apos;Location&apos;] allow_redirects=FalseÁöÑÊÑè‰πâ‰∏∫ÊãíÁªùÈªòËÆ§ÁöÑ301/302ÈáçÂÆöÂêë‰ªéËÄåÂèØ‰ª•ÈÄöËøáhtml.headers[‚ÄòLocation‚Äô]ÊãøÂà∞ÈáçÂÆöÂêëÁöÑURL„ÄÇ]]></content>
      <categories>
        <category>Scrapy</category>
      </categories>
      <tags>
        <tag>Scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scrapy Ê∫êÁ†ÅÂàÜÊûê‰πãretry‰∏≠Èó¥‰ª∂‰∏éÂ∫îÁî®]]></title>
    <url>%2F2019%2F03%2F29%2Fscrapy-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bretry%E4%B8%AD%E9%97%B4%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[ËøôÊ¨°ËÆ©Êàë‰ª¨ÂàÜÊûêscrapyÈáçËØïÊú∫Âà∂ÁöÑÊ∫êÁ†ÅÔºåÂ≠¶‰π†ÂÖ∂‰∏≠ÁöÑÊÄùÊÉ≥ÔºåÁºñÂÜôÂÆöÂà∂Âåñmiddleware,ÊçïÊçâÁà¨ÂèñÂ§±Ë¥•ÁöÑURLÁ≠â‰ø°ÊÅØ„ÄÇ scrapyÁÆÄ‰ªãScrapyÊòØ‰∏Ä‰∏™‰∏∫‰∫ÜÁà¨ÂèñÁΩëÁ´ôÊï∞ÊçÆÔºåÊèêÂèñÁªìÊûÑÊÄßÊï∞ÊçÆËÄåÁºñÂÜôÁöÑÂ∫îÁî®Ê°ÜÊû∂„ÄÇ ÂèØ‰ª•Â∫îÁî®Âú®ÂåÖÊã¨Êï∞ÊçÆÊåñÊéòÔºå‰ø°ÊÅØÂ§ÑÁêÜÊàñÂ≠òÂÇ®ÂéÜÂè≤Êï∞ÊçÆÁ≠â‰∏ÄÁ≥ªÂàóÁöÑÁ®ãÂ∫è‰∏≠„ÄÇ ÂÖ∂ÊúÄÂàùÊòØ‰∏∫‰∫Ü È°µÈù¢ÊäìÂèñ (Êõ¥Á°ÆÂàáÊù•ËØ¥, ÁΩëÁªúÊäìÂèñ )ÊâÄËÆæËÆ°ÁöÑÔºå ‰πüÂèØ‰ª•Â∫îÁî®Âú®Ëé∑ÂèñAPIÊâÄËøîÂõûÁöÑÊï∞ÊçÆ(‰æãÂ¶Ç Amazon Associates Web Services ) ÊàñËÄÖÈÄöÁî®ÁöÑÁΩëÁªúÁà¨Ëô´„ÄÇ ‰∏ÄÂº†ÂõæÂèØÁúãÊ∏ÖÊ•öscrapy‰∏≠Êï∞ÊçÆÁöÑÊµÅÂêëÔºö ÁÆÄÂçï‰∫ÜËß£‰∏Ä‰∏ãÂêÑ‰∏™ÈÉ®ÂàÜÁöÑÂäüËÉΩÔºåÂèØ‰ª•Áúã‰∏ãÈù¢ÁÆÄÂåñÁâàÊï∞ÊçÆÊµÅÔºö ÊÄªÊúâÊºèÁΩë‰πãÈ±º‰∏çÁÆ°‰Ω†ÁöÑ‰∏ªÊú∫ÈÖçÁΩÆÂ§ö‰πàÂêäÁÇ∏Â§©ÔºåËøòÊòØÁΩëÈÄüÂ§ö‰πàÁªôÂäõÔºåÂú®scrapyÁöÑÂ§ßËßÑÊ®°‰ªªÂä°‰∏≠ÔºåÊúÄÁªàÁà¨ÂèñÁöÑitemÊï∞ÈáèÈÉΩ‰∏ç‰ºöÁ≠â‰∫éÊúüÊúõÁà¨ÂèñÁöÑÊï∞ÈáèÔºå‰πüÂ∞±ÊòØËØ¥ÊÄªÊúâÈÇ£‰πà‰∏Ä‰∫õÁà¨ÂèñÂ§±Ë¥•ÁöÑÊºèÁΩë‰πãÈ±ºÔºåÈÄöËøáÂàÜÊûêscrapyÁöÑÊó•ÂøóÔºåÂèØ‰ª•Áü•ÈÅìÈÄ†ÊàêÂ§±Ë¥•ÁöÑÂéüÂõ†Êúâ‰ª•‰∏ã‰∏§ÁßçÊÉÖÂÜµÔºö exception_count httperror ‰ª•‰∏äÁöÑ‰∏çÁÆ°ÊòØexceptionËøòÊòØhttperror, scrapy‰∏≠ÈÉΩÊúâÂØπÂ∫îÁöÑretryÊú∫Âà∂ÔºåÂú®settings.pyÊñá‰ª∂‰∏≠Êàë‰ª¨ÂèØ‰ª•ËÆæÁΩÆÊúâÂÖ≥ÈáçËØïÁöÑÂèÇÊï∞ÔºåÁ≠âËøêË°åÈÅáÂà∞ÂºÇÂ∏∏ÂíåÈîôËØØÊó∂ÂÄôÔºåscrapyÂ∞±‰ºöËá™Âä®Â§ÑÁêÜËøô‰∫õÈóÆÈ¢òÔºåÂÖ∂‰∏≠ÊúÄÂÖ≥ÈîÆÁöÑÈÉ®ÂàÜÂ∞±ÊòØÈáçËØï‰∏≠Èó¥‰ª∂Ôºå‰∏ãÈù¢ËÆ©Êàë‰ª¨Áúã‰∏Ä‰∏ãscrapyÁöÑretry middleware„ÄÇ RetryMiddleÊ∫êÁ†ÅÂàÜÊûêÂú®scrapyÈ°πÁõÆÁöÑmiddlewares.pyÊñá‰ª∂‰∏≠ Êï≤Â¶Ç‰∏ã‰ª£Á†ÅÔºö 1from scrapy.downloadermiddlewares.retry import RetryMiddleware Êåâ‰ΩèctrlÈîÆÔºàMacÊòØcommandÈîÆÔºâÔºåÈº†Ê†áÂ∑¶ÈîÆÁÇπÂáªRetryMiddlewareËøõÂÖ•ËØ•‰∏≠Èó¥‰ª∂ÊâÄÂú®ÁöÑÈ°πÁõÆÊñá‰ª∂ÁöÑ‰ΩçÁΩÆÔºå‰πüÂèØ‰ª•ÈÄöËøáÊü•ÁúãÊñá‰ª∂ÁöÑÂΩ¢ÂºèÊâæÂà∞ËØ•ËØ•‰∏≠Èó¥‰ª∂ÁöÑ‰ΩçÁΩÆÔºåË∑ØÂæÑÊòØÔºö 1site-packages/scrapy/downloadermiddlewares/retry.RetryMiddleware Ê∫êÁ†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364class RetryMiddleware(object): # IOError is raised by the HttpCompression middleware when trying to # decompress an empty response # ÈúÄË¶ÅÈáçËØïÁöÑÂºÇÂ∏∏Áä∂ÊÄÅÔºåÂèØ‰ª•ÁúãÂá∫ÔºåÂÖ∂‰∏≠Êúâ‰∫õÊòØ‰∏äÈù¢log‰∏≠ÁöÑÂºÇÂ∏∏ EXCEPTIONS_TO_RETRY = (defer.TimeoutError, TimeoutError, DNSLookupError, ConnectionRefusedError, ConnectionDone, ConnectError, ConnectionLost, TCPTimedOutError, ResponseFailed, IOError, TunnelError) def __init__(self, settings): # ËØªÂèñ settings.py ‰∏≠ÂÖ≥‰∫éÈáçËØïÁöÑÈÖçÁΩÆ‰ø°ÊÅØÔºåÂ¶ÇÊûúÊ≤°ÊúâÈÖçÁΩÆÈáçËØïÁöÑËØùÔºåÁõ¥Êé•Ë∑≥Ëøá if not settings.getbool('RETRY_ENABLED'): raise NotConfigured self.max_retry_times = settings.getint('RETRY_TIMES') self.retry_http_codes = set(int(x) for x in settings.getlist('RETRY_HTTP_CODES')) self.priority_adjust = settings.getint('RETRY_PRIORITY_ADJUST') @classmethod def from_crawler(cls, crawler): return cls(crawler.settings)# Â¶ÇÊûúresponseÁöÑÁä∂ÊÄÅÁ†ÅÔºåÊòØÊàë‰ª¨Ë¶ÅÈáçËØïÁöÑ def process_response(self, request, response, spider): if request.meta.get('dont_retry', False): return response if response.status in self.retry_http_codes: reason = response_status_message(response.status) return self._retry(request, reason, spider) or response return response# Âá∫Áé∞‰∫ÜÈúÄË¶ÅÈáçËØïÁöÑÂºÇÂ∏∏Áä∂ÊÄÅÔºå def process_exception(self, request, exception, spider): if isinstance(exception, self.EXCEPTIONS_TO_RETRY) \ and not request.meta.get('dont_retry', False): return self._retry(request, exception, spider)# ÈáçËØïÊìç‰Ωú def _retry(self, request, reason, spider): retries = request.meta.get('retry_times', 0) + 1 retry_times = self.max_retry_times if 'max_retry_times' in request.meta: retry_times = request.meta['max_retry_times'] stats = spider.crawler.stats if retries &lt;= retry_times: logger.debug("Retrying %(request)s (failed %(retries)d times): %(reason)s", &#123;'request': request, 'retries': retries, 'reason': reason&#125;, extra=&#123;'spider': spider&#125;) retryreq = request.copy() retryreq.meta['retry_times'] = retries retryreq.dont_filter = True retryreq.priority = request.priority + self.priority_adjust if isinstance(reason, Exception): reason = global_object_name(reason.__class__) stats.inc_value('retry/count') stats.inc_value('retry/reason_count/%s' % reason) return retryreq else: stats.inc_value('retry/max_reached') logger.debug("Gave up retrying %(request)s (failed %(retries)d times): %(reason)s", &#123;'request': request, 'retries': retries, 'reason': reason&#125;, extra=&#123;'spider': spider&#125;) Êü•ÁúãÊ∫êÁ†ÅÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ÔºåÂØπ‰∫éËøîÂõûhttp codeÁöÑresponseÔºåËØ•‰∏≠Èó¥‰ª∂‰ºöÈÄöËøáprocess_responseÊñπÊ≥ïÊù•Â§ÑÁêÜÔºåÂ§ÑÁêÜÂäûÊ≥ïÊØîËæÉÁÆÄÂçïÔºåÂà§Êñ≠response.statusÊòØÂê¶Âú®retry_http_codesÈõÜÂêà‰∏≠ÔºåËøô‰∏™ÈõÜÂêàÊòØËØªÂèñÁöÑÈÖçÁΩÆÊñá‰ª∂Ôºö 123RETRY_ENABLED = True # ÈªòËÆ§ÂºÄÂêØÂ§±Ë¥•ÈáçËØïÔºå‰∏ÄËà¨ÂÖ≥Èó≠RETRY_TIMES = 3 # Â§±Ë¥•ÂêéÈáçËØïÊ¨°Êï∞ÔºåÈªòËÆ§‰∏§Ê¨°RETRY_HTTP_CODES = [500, 502, 503, 504, 522, 524, 408] # Á¢∞Âà∞Ëøô‰∫õÈ™åËØÅÁ†ÅÔºåÊâçÂºÄÂêØÈáçËØï ÂØπ‰∫éhttperrorÁöÑÂ§ÑÁêÜ‰πüÊòØÂêåÊ†∑ÁöÑÈÅìÁêÜÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ EXCEPTIONS_TO_RETRYÁöÑÂàóË°®ÔºåÈáåÈù¢Â≠òÊîæÊâÄÊúâÁöÑÂºÇÂ∏∏Á±ªÂûãÔºåÁÑ∂ÂêéÂà§Êñ≠‰º†ÂÖ•ÁöÑÂºÇÂ∏∏ÊòØÂê¶Â≠òÂú®‰∫éËØ•ÈõÜÂêà‰∏≠ÔºåÂ¶ÇÊûúÂú®Â∞±ËøõÂÖ•retryÈÄªËæëÔºå‰∏çÂú®Â∞±ÂøΩÁï•„ÄÇ Ê∫êÁ†ÅÊÄùÊÉ≥ÁöÑÂ∫îÁî®‰∫ÜËß£scrapyÂ¶Ç‰ΩïÂ§ÑÁêÜÂºÇÂ∏∏ÂêéÔºåÂ∞±ÂèØ‰ª•Âà©Áî®ËøôÁßçÊÄùÊÉ≥ÔºåÂÜô‰∏Ä‰∏™middlewareÔºåÂØπÁà¨ÂèñÂ§±Ë¥•ÁöÑÊºèÁΩë‰πãÈ±ºËøõË°åÊçïËé∑ÔºåÊñπ‰æø‰ª•ÂêéÂÅöË°•Áà¨„ÄÇ Âú®middlewares.py‰∏≠ from scrapy.downloadermiddlewares.retry import RetryMiddleware, ÂÜô‰∏Ä‰∏™classÔºåÁªßÊâøËá™RetryMiddlewareÔºõ ÂØπÁà∂Á±ªÁöÑprocess_response()Âíåprocess_exception()ÊñπÊ≥ïËøõË°åÈáçÂÜôÔºõ Â∞ÜËØ•middlewareÂä†ÂÖ•setting.py; Ê≥®ÊÑè‰∫ãÈ°πÔºöËØ•‰∏≠Èó¥‰ª∂ÁöÑOrder_code‰∏çËÉΩËøáÂ§ßÔºåÂ¶ÇÊûúËøáÂ§ßÂ∞±‰ºöË∂äÊé•Ëøë‰∏ãËΩΩÂô®ÔºåÂ∞±‰ºö‰ºòÂÖà‰∫éRetryMiddlewareÂ§ÑÁêÜresponseÔºå‰ΩÜËøô‰∏™‰∏≠Èó¥‰ª∂ÊòØÁî®Êù•Â§ÑÁêÜÊúÄÁªàÁöÑÈîôËØØÁöÑÔºåÂç≥ÂΩì‰∏Ä‰∏™response 500ËøõÂÖ•‰∏≠Èó¥‰ª∂ÈìæË∑ØÊó∂ÔºåÈúÄË¶ÅÂÖàÁªèËøáretry‰∏≠Èó¥‰ª∂Â§ÑÁêÜÔºå‰∏çËÉΩÂÖàÁî±Êàë‰ª¨ÂÜôÁöÑ‰∏≠Èó¥‰ª∂Êù•Â§ÑÁêÜÔºåÂÆÉ‰∏çÂÖ∑ÊúâretryÁöÑÂäüËÉΩÔºåÊé•Êî∂Âà∞500ÁöÑresponseÂ∞±Áõ¥Êé•ÊîæÂºÉÊéâËØ•requestÁõ¥Êé•return‰∫ÜÔºåËøôÊòØ‰∏çÂêàÁêÜÁöÑ„ÄÇÂè™ÊúâÁªèËøáretryÂêé‰ªçÁÑ∂ÊúâÂºÇÂ∏∏ÁöÑrequestÊâçÂ∫îÂΩìÁî±Êàë‰ª¨ÂÜôÁöÑ‰∏≠Èó¥‰ª∂Êù•Â§ÑÁêÜÔºåËøôÊó∂ÂÄô‰Ω†ÊÉ≥ÊÄé‰πàÂ§ÑÁêÜÈÉΩÂèØ‰ª•ÔºåÊØîÂ¶ÇÂÜçÊ¨°retry„ÄÅreturn‰∏Ä‰∏™ÈáçÊñ∞ÊûÑÈÄ†ÁöÑresponseÔºå‰ΩÜÊòØÂ¶ÇÊûú‰Ω†‰∏∫‰∫ÜÂä†Âø´Áà¨Ëô´ÈÄüÂ∫¶Ôºå‰∏çËÆæÁΩÆretry‰πüÊòØÂèØ‰ª•ÁöÑ„ÄÇ Talk is cheap, show the code: 1234567891011121314151617181920class GetFailedUrl(RetryMiddleware): def __init__(self, settings): self.max_retry_times = settings.getint('RETRY_TIMES') self.retry_http_codes = set(int(x) for x in settings.getlist('RETRY_HTTP_CODES')) self.priority_adjust = settings.getint('RETRY_PRIORITY_ADJUST') def process_response(self, request, response, spider): if response.status in self.retry_http_codes: # Â∞ÜÁà¨ÂèñÂ§±Ë¥•ÁöÑURLÂ≠ò‰∏ãÊù•Ôºå‰Ω†‰πüÂèØ‰ª•Â≠òÂà∞Âà´ÁöÑÂ≠òÂÇ® with open(str(spider.name) + ".txt", "a") as f: f.write(response.url + "\n") return response return response def process_exception(self, request, exception, spider): # Âá∫Áé∞ÂºÇÂ∏∏ÁöÑÂ§ÑÁêÜ if isinstance(exception, self.EXCEPTIONS_TO_RETRY): with open(str(spider.name) + ".txt", "a") as f: f.write(str(request) + "\n") return None setting.py‰∏≠Ê∑ªÂä†ËØ•‰∏≠Èó¥‰ª∂Ôºö 12345DOWNLOADER_MIDDLEWARES = &#123; 'myspider.middlewares.TabelogDownloaderMiddleware': 543, 'myspider.middlewares.RandomProxy': 200, 'myspider.middlewares.GetFailedUrl': 220,&#125; ‰∏∫‰∫ÜÊµãËØïÔºåÊàë‰ª¨ÊïÖÊÑèÂÜôÈîôURLÔºåÊàñËÄÖÂ∞Üdownload_delayÁº©Áü≠ÔºåÂ∞±‰ºöÂá∫Áé∞ÂêÑÁßçÂºÇÂ∏∏Ôºå‰ΩÜÊòØÊàë‰ª¨Áé∞Âú®ËÉΩÂ§üÊçïËé∑ÂÆÉ‰ª¨‰∫ÜÔºö]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Go Modules‰ΩøÁî®ÊñπÊ≥ï]]></title>
    <url>%2F2019%2F03%2F29%2FGo-Modules%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[Go Modules‰ΩøÁî®ÊïôÁ®ãÂºïÂÖ•https://talks.godoc.org/github.com/myitcv/talks/2018-08-15-glug-modules/main.slide#1 Go Modules‰ªãÁªçModulesÊòØGo 1.11‰∏≠Êñ∞Â¢ûÁöÑÂÆûÈ™åÊÄßÂäüËÉΩÔºåÂü∫‰∫évgoÊºîÂèòËÄåÊù•ÔºåÊòØ‰∏Ä‰∏™Êñ∞ÂûãÁöÑÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑„ÄÇ Â∏∏ËßÅÁöÑÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑ govendor dep glide godep Ëøô‰∫õÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑ÈÉΩÊòØÂü∫‰∫éGOPATHÊàñËÄÖvendorÁõÆÂΩïÔºåÂπ∂‰∏çËÉΩÂæàÂ•ΩÁöÑËß£ÂÜ≥‰∏çÂêåÁâàÊú¨‰æùËµñÈóÆÈ¢ò„ÄÇModulesÊòØÂú®GOPATH‰πãÂ§ñ‰∏ÄÂ•óÊñ∞ÁöÑÂåÖÁÆ°ÁêÜÊñπÂºè„ÄÇ Â¶Ç‰ΩïÊøÄÊ¥ªModulesÈ¶ñÂÖàË¶ÅÊäägoÂçáÁ∫ßÂà∞1.11„ÄÇ ÂçáÁ∫ßÂêéÔºåÂèØ‰ª•ËÆæÁΩÆÈÄöËøá‰∏Ä‰∏™ÁéØÂ¢ÉÂèòÈáèGO111MODULEÊù•ÊøÄÊ¥ªmodulesÔºö GO111MODULE=offÔºågoÂëΩ‰ª§Ë°åÂ∞Ü‰∏ç‰ºöÊîØÊåÅmoduleÂäüËÉΩÔºåÂØªÊâæ‰æùËµñÂåÖÁöÑÊñπÂºèÂ∞Ü‰ºöÊ≤øÁî®ÊóßÁâàÊú¨ÈÇ£ÁßçÈÄöËøávendorÁõÆÂΩïÊàñËÄÖGOPATHÊ®°ÂºèÊù•Êü•Êâæ„ÄÇ GO111MODULE=onÔºågoÂëΩ‰ª§Ë°å‰ºö‰ΩøÁî®modulesÔºåËÄå‰∏ÄÁÇπ‰πü‰∏ç‰ºöÂéªGOPATHÁõÆÂΩï‰∏ãÊü•Êâæ„ÄÇ GO111MODULE=autoÔºåÈªòËÆ§ÂÄºÔºågoÂëΩ‰ª§Ë°åÂ∞Ü‰ºöÊ†πÊçÆÂΩìÂâçÁõÆÂΩïÊù•ÂÜ≥ÂÆöÊòØÂê¶ÂêØÁî®moduleÂäüËÉΩ„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÂèØ‰ª•ÂàÜ‰∏∫‰∏§ÁßçÊÉÖÂΩ¢ÔºöÂΩìÂâçÁõÆÂΩïÂú®GOPATH/src‰πãÂ§ñ‰∏îËØ•ÁõÆÂΩïÂåÖÂê´go.modÊñá‰ª∂ÔºåÊàñËÄÖÂΩìÂâçÊñá‰ª∂Âú®ÂåÖÂê´go.modÊñá‰ª∂ÁöÑÁõÆÂΩï‰∏ãÈù¢„ÄÇ ÂΩìmoduleÂäüËÉΩÂêØÁî®Êó∂ÔºåGOPATHÂú®È°πÁõÆÊûÑÂª∫ËøáÁ®ã‰∏≠‰∏çÂÜçÊãÖÂΩìimportÁöÑËßíËâ≤Ôºå‰ΩÜÂÆÉ‰ªçÁÑ∂Â≠òÂÇ®‰∏ãËΩΩÁöÑ‰æùËµñÂåÖÔºåÂÖ∑‰Ωì‰ΩçÁΩÆÂú®$GOPATH/pkg/mod„ÄÇ ÂàùÂßãÂåñModulesGo1.11Êñ∞Â¢û‰∫ÜÂëΩ‰ª§go modÊù•ÊîØÊåÅModulesÁöÑ‰ΩøÁî®„ÄÇ 123456789101112131415161718192021222324&gt; go help modGo mod provides access to operations on modules.Note that support for modules is built into all the go commands,not just &apos;go mod&apos;. For example, day-to-day adding, removing, upgrading,and downgrading of dependencies should be done using &apos;go get&apos;.See &apos;go help modules&apos; for an overview of module functionality.Usage: go mod &lt;command&gt; [arguments]The commands are: download download modules to local cache edit edit go.mod from tools or scripts graph print module requirement graph init initialize new module in current directory tidy add missing and remove unused modules vendor make vendored copy of dependencies verify verify dependencies have expected content why explain why packages or modules are neededUse &quot;go help mod &lt;command&gt;&quot; for more information about a command. È¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™È°πÁõÆhelloworldÔºö 1cd &amp;&amp; mkdir helloworld &amp;&amp; cd helloworld ÁÑ∂ÂêéÂàõÂª∫Êñá‰ª∂main.goÂπ∂ÂÜôÂÖ•Ôºö 1234567891011package mainimport ( log &quot;github.com/sirupsen/logrus&quot;)func main() &#123; log.WithFields(log.Fields&#123; &quot;animal&quot;: &quot;walrus&quot;, &#125;).Info(&quot;A walrus appears&quot;)&#125; ÂàùÂßãÂåñmod: 1go mod init helloworld Á≥ªÁªüÁîüÊàê‰∫Ü‰∏Ä‰∏™go.modÁöÑÊñá‰ª∂Ôºö 1module helloworld ÁÑ∂ÂêéÊâßË°ågo buildÔºåÂÜçÊ¨°Êü•Áúãgo.modÊñá‰ª∂ÂèëÁé∞Â§ö‰∫Ü‰∏Ä‰∫õÂÜÖÂÆπÔºö 123module helloworldrequire github.com/sirupsen/logrus v1.1.1 ÂêåÊó∂Â§ö‰∫Ü‰∏Ä‰∏™go.sumÁöÑÊñá‰ª∂Ôºö 12345678910github.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=github.com/konsorten/go-windows-terminal-sequences v0.0.0-20180402223658-b729f2633dfe/go.mod h1:T0+1ngSBFLxvqU3pZ+m/2kptfBszLMUkC4ZK/EgS/cQ=github.com/pmezard/go-difflib v1.0.0/go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ/4=github.com/sirupsen/logrus v1.1.1 h1:VzGj7lhU7KEB9e9gMpAV/v5XT2NVSvLJhJLCWbnkgXg=github.com/sirupsen/logrus v1.1.1/go.mod h1:zrgwTnHtNr00buQ1vSptGe8m1f/BbgsPukg8qsT7A+A=github.com/stretchr/testify v1.2.2/go.mod h1:a8OnRcib4nhh0OaRAV+Yts87kKdq0PP7pXfy6kDkUVs=golang.org/x/crypto v0.0.0-20180904163835-0709b304e793 h1:u+LnwYTOOW7Ukr/fppxEb1Nwz0AtPflrblfvUudpo+I=golang.org/x/crypto v0.0.0-20180904163835-0709b304e793/go.mod h1:6SG95UA2DQfeDnfUPMdvaQW0Q7yPrPDi9nlGo2tz2b4=golang.org/x/sys v0.0.0-20180905080454-ebe1bf3edb33 h1:I6FyU15t786LL7oL/hn43zqTuEGr4PN7F4XJ1p4E3Y8=golang.org/x/sys v0.0.0-20180905080454-ebe1bf3edb33/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY= go.sum‰∏çÊòØ‰∏Ä‰∏™ÈîÅÊñá‰ª∂ÔºåÊòØ‰∏Ä‰∏™Ê®°ÂùóÁâàÊú¨ÂÜÖÂÆπÁöÑÊ†°È™åÂÄºÔºåÁî®Êù•È™åËØÅÂΩìÂâçÁºìÂ≠òÁöÑÊ®°Âùó„ÄÇgo.sumÂåÖÂê´‰∫ÜÁõ¥Êé•‰æùËµñÂíåÈó¥Êé•‰æùËµñÁöÑÂåÖÁöÑ‰ø°ÊÅØÔºåÊØîgo.modË¶ÅÂ§ö‰∏Ä‰∫õ„ÄÇ go.modÊúâÂõõÁßçÊåá‰ª§ÔºömoduleÔºårequireÔºåexcludeÔºåreplace„ÄÇ moduleÔºöÊ®°ÂùóÂêçÁß∞ requireÔºö‰æùËµñÂåÖÂàóË°®‰ª•ÂèäÁâàÊú¨ excludeÔºöÁ¶ÅÊ≠¢‰æùËµñÂåÖÂàóË°®Ôºà‰ªÖÂú®ÂΩìÂâçÊ®°Âùó‰∏∫‰∏ªÊ®°ÂùóÊó∂ÁîüÊïàÔºâ replaceÔºöÊõøÊç¢‰æùËµñÂåÖÂàóË°® Ôºà‰ªÖÂú®ÂΩìÂâçÊ®°Âùó‰∏∫‰∏ªÊ®°ÂùóÊó∂ÁîüÊïàÔºâ ÂÖ∂‰ªñÂëΩ‰ª§123456go mod tidy //ÊãâÂèñÁº∫Â∞ëÁöÑÊ®°ÂùóÔºåÁßªÈô§‰∏çÁî®ÁöÑÊ®°Âùó„ÄÇgo mod download //‰∏ãËΩΩ‰æùËµñÂåÖgo mod graph //ÊâìÂç∞Ê®°Âùó‰æùËµñÂõægo mod vendor //Â∞Ü‰æùËµñÂ§çÂà∂Âà∞vendor‰∏ãgo mod verify //Ê†°È™å‰æùËµñgo mod why //Ëß£Èáä‰∏∫‰ªÄ‰πàÈúÄË¶Å‰æùËµñ 1go list -m -json all //‰æùËµñËØ¶ÊÉÖ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PythonÁöÑmap/reduce/filter]]></title>
    <url>%2F2019%2F03%2F27%2FPython%E7%9A%84map-reduce-filter%2F</url>
    <content type="text"><![CDATA[ËΩ¨ËΩΩËá™explore_python http://funhacks.net/explore-python/Functional/map_reduce_filter.html]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golangÁöÑÂ§öÊÄÅÂÆûÁé∞]]></title>
    <url>%2F2019%2F03%2F18%2Fgolang%E7%9A%84%E5%A4%9A%E6%80%81%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[Â§öÊÄÅÔºàpolymorphismÔºâÂ§öÊÄÅÊòØÊé•Âè£ÁöÑ‰∏Ä‰∏™ÂÖ≥ÈîÆÂäüËÉΩÂíåGoËØ≠Ë®ÄÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÁâπÊÄß„ÄÇ ÂΩìÈùûÊé•Âè£Á±ªÂûãTÁöÑ‰∏Ä‰∏™ÂÄºtË¢´ÂåÖË£πÂú®Êé•Âè£Á±ªÂûãIÁöÑ‰∏Ä‰∏™Êé•Âè£ÂÄºi‰∏≠ÔºåÈÄöËøáiË∞ÉÁî®Êé•Âè£Á±ªÂûãIÊåáÂÆöÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÊó∂Ôºå‰∫ãÂÆû‰∏ä‰∏∫ÈùûÊé•Âè£Á±ªÂûãTÂ£∞ÊòéÁöÑÂØπÂ∫îÊñπÊ≥ïÂ∞ÜÈÄöËøáÈùûÊé•Âè£ÂÄºtË¢´Ë∞ÉÁî®„ÄÇ Êç¢Âè•ËØùËØ¥ÔºåË∞ÉÁî®‰∏Ä‰∏™Êé•Âè£ÂÄºÁöÑÊñπÊ≥ïÂÆûÈôÖ‰∏äÂ∞ÜË∞ÉÁî®Ê≠§Êé•Âè£ÂÄºÁöÑÂä®ÊÄÅÂÄºÁöÑÂØπÂ∫îÊñπÊ≥ï„ÄÇ ÊØîÂ¶ÇÔºåÂΩìÊñπÊ≥ïi.mË¢´Ë∞ÉÁî®Êó∂ÔºåÂÖ∂ÂÆûË¢´Ë∞ÉÁî®ÁöÑÊòØÊñπÊ≥ït.m„ÄÇ ‰∏Ä‰∏™Êé•Âè£ÂÄºÂèØ‰ª•ÈÄöËøáÂåÖË£π‰∏çÂêåÂä®ÊÄÅÁ±ªÂûãÁöÑÂä®ÊÄÅÂÄºÊù•Ë°®Áé∞Âá∫ÂêÑÁßç‰∏çÂêåÁöÑË°å‰∏∫ÔºåËøôÁß∞‰∏∫Â§öÊÄÅ„ÄÇ ÂΩìÊñπÊ≥ïi.mË¢´Ë∞ÉÁî®Êó∂ÔºåiÂ≠òÂÇ®ÁöÑÂÆûÁé∞ÂÖ≥Á≥ª‰ø°ÊÅØÁöÑÊñπÊ≥ïË°®‰∏≠ÁöÑÊñπÊ≥ït.mÂ∞ÜË¢´ÊâæÂà∞Âπ∂Ë¢´Ë∞ÉÁî®„ÄÇ Ê≠§ÊñπÊ≥ïË°®ÊòØ‰∏Ä‰∏™ÂàáÁâáÔºåÊâÄ‰ª•Ê≠§ÂØªÊâæËøáÁ®ãÂè™‰∏çËøáÊòØ‰∏Ä‰∏™ÂàáÁâáÂÖÉÁ¥†ËÆøÈóÆÊìç‰ΩúÔºå‰∏ç‰ºöÊ∂àËÄóÂæàÂ§öÊó∂Èó¥„ÄÇ Ê≥®ÊÑèÔºåÂú®nilÊé•Âè£ÂÄº‰∏äË∞ÉÁî®ÊñπÊ≥ïÂ∞Ü‰∫ßÁîü‰∏Ä‰∏™ÊÅêÊÖåÔºåÂõ†‰∏∫Ê≤°ÊúâÂÖ∑‰ΩìÁöÑÊñπÊ≥ïÂèØË¢´Ë∞ÉÁî®„ÄÇ ‰∏Ä‰∏™‰æãÂ≠êÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566package mainimport "fmt"type Filter interface &#123; About() string Process([]int) []int&#125;// UniqueFilterÁî®Êù•Âà†Èô§ÈáçÂ§çÁöÑÊï∞Â≠ó„ÄÇtype UniqueFilter struct&#123;&#125;func (UniqueFilter) About() string &#123; return "Âà†Èô§ÈáçÂ§çÁöÑÊï∞Â≠ó"&#125;func (UniqueFilter) Process(inputs []int) []int &#123; outs := make([]int, 0, len(inputs)) pusheds := make(map[int]bool) for _, n := range inputs &#123; if !pusheds[n] &#123; pusheds[n] = true outs = append(outs, n) &#125; &#125; return outs&#125;// MultipleFilterÁî®Êù•Âè™‰øùÁïôÊüê‰∏™Êï¥Êï∞ÁöÑÂÄçÊï∞Êï∞Â≠ó„ÄÇtype MultipleFilter intfunc (mf MultipleFilter) About() string &#123; return fmt.Sprintf("‰øùÁïô%vÁöÑÂÄçÊï∞", mf)&#125;func (mf MultipleFilter) Process(inputs []int) []int &#123; var outs = make([]int, 0, len(inputs)) for _, n := range inputs &#123; if n % int(mf) == 0 &#123; outs = append(outs, n) &#125; &#125; return outs&#125;// Âú®Â§öÊÄÅÁâπÊÄßÁöÑÂ∏ÆÂä©‰∏ãÔºåÂè™ÈúÄË¶Å‰∏Ä‰∏™filteAndPrintÂáΩÊï∞„ÄÇfunc filteAndPrint(fltr Filter, unfiltered []int) []int &#123; // Âú®fltrÂèÇÊï∞‰∏äË∞ÉÁî®ÊñπÊ≥ïÂÖ∂ÂÆûÊòØË∞ÉÁî®fltrÁöÑÂä®ÊÄÅÂÄºÁöÑÊñπÊ≥ï„ÄÇ filtered := fltr.Process(unfiltered) fmt.Println(fltr.About() + ":\n\t", filtered) return filtered&#125;func main() &#123; numbers := []int&#123;12, 7, 21, 12, 12, 26, 25, 21, 30&#125; fmt.Println("ËøáÊª§‰πãÂâçÔºö\n\t", numbers) // ‰∏â‰∏™ÈùûÊé•Âè£ÂÄºË¢´ÂåÖË£πÂú®‰∏Ä‰∏™FilterÂàáÁâáÁöÑ‰∏â‰∏™Êé•Âè£ÂÖÉÁ¥†‰∏≠„ÄÇ filters := []Filter&#123; UniqueFilter&#123;&#125;, MultipleFilter(2), MultipleFilter(3), &#125; // ÊØè‰∏™ÂàáÁâáÂÖÉÁ¥†Â∞ÜË¢´ËµãÂÄºÁªôÁ±ªÂûã‰∏∫FilterÁöÑÂæ™ÁéØÂèòÈáèfltr„ÄÇ // ÊØè‰∏™ÂÖÉÁ¥†‰∏≠ÁöÑÂä®ÊÄÅÂÄº‰πüÂ∞ÜË¢´ÂêåÊó∂Â§çÂà∂Âπ∂Ë¢´ÂåÖË£πÂú®Âæ™ÁéØÂèòÈáèfltr‰∏≠„ÄÇ for _, fltr := range filters &#123; numbers = filteAndPrint(fltr, numbers) &#125;&#125; ËæìÂá∫ÁªìÊûúÔºö 12345678ËøáÊª§‰πãÂâçÔºö [12 7 21 12 12 26 25 21 30]Âà†Èô§ÈáçÂ§çÁöÑÊï∞Â≠ó: [12 7 21 26 25 30]‰øùÁïô2ÁöÑÂÄçÊï∞: [12 26 30]‰øùÁïô3ÁöÑÂÄçÊï∞: [12 30] Âú®‰∏äÈù¢Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåÂ§öÊÄÅ‰ΩøÂæóÊàë‰ª¨‰∏çÂøÖ‰∏∫ÊØè‰∏™ËøáÊª§Âô®Á±ªÂûãÂÜô‰∏Ä‰∏™ÂçïÁã¨ÁöÑfilteAndPrintÂáΩÊï∞„ÄÇ Èô§‰∫Ü‰∏äËø∞Ëøô‰∏™Â•ΩÂ§ÑÔºåÂ§öÊÄÅ‰πü‰ΩøÂæó‰∏Ä‰∏™‰ª£Á†ÅÂåÖÁöÑÂºÄÂèëËÄÖÂèØ‰ª•Âú®Ê≠§‰ª£Á†ÅÂåÖ‰∏≠Â£∞Êòé‰∏Ä‰∏™Êé•Âè£Á±ªÂûãÂπ∂Â£∞Êòé‰∏Ä‰∏™Êã•ÊúâÊ≠§Êé•Âè£Á±ªÂûãÂèÇÊï∞ÁöÑÂáΩÊï∞ÔºàÊàñËÄÖÊñπÊ≥ïÔºâÔºå‰ªéËÄåÊ≠§‰ª£Á†ÅÂåÖÁöÑ‰∏Ä‰∏™Áî®Êà∑ÂèØ‰ª•Âú®Áî®Êà∑ÂåÖ‰∏≠Â£∞Êòé‰∏Ä‰∏™ÂÆûÁé∞‰∫ÜÊ≠§Êé•Âè£Á±ªÂûãÁöÑÁî®Êà∑Á±ªÂûãÔºåÂπ∂‰∏îÂ∞ÜÊ≠§Áî®Êà∑Á±ªÂûãÁöÑÂÄºÂÅö‰∏∫ÂÆûÂèÇ‰º†ÈÄíÁªôÊ≠§‰ª£Á†ÅÂåÖ‰∏≠Â£∞ÊòéÁöÑÂáΩÊï∞ÔºàÊàñËÄÖÊñπÊ≥ïÔºâÁöÑË∞ÉÁî®„ÄÇ Ê≠§‰ª£Á†ÅÂåÖÁöÑÂºÄÂèëËÄÖÂπ∂‰∏çÁî®ÂÖ≥ÂøÉ‰∏Ä‰∏™Áî®Êà∑Á±ªÂûãÂÖ∑‰ΩìÊòØÂ¶Ç‰ΩïÂ£∞ÊòéÁöÑÔºåÂè™Ë¶ÅÊ≠§Áî®Êà∑Á±ªÂûãÊª°Ë∂≥Ê≠§‰ª£Á†ÅÂåÖ‰∏≠Â£∞ÊòéÁöÑÊé•Âè£Á±ªÂûãËßÑÂÆöÁöÑË°å‰∏∫Âç≥ÂèØ„ÄÇ ‰∫ãÂÆû‰∏äÔºåÂ§öÊÄÅÂØπ‰∫é‰∏Ä‰∏™ËØ≠Ë®ÄÊù•ËØ¥Âπ∂Èùû‰∏Ä‰∏™‰∏çÂèØÊàñÁº∫ÁöÑÁâπÊÄß„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂÖ∂ÂÆÉÈÄîÂæÑÊù•ÂÆûÁé∞Â§öÊÄÅÁöÑ‰ΩúÁî®„ÄÇ ‰ΩÜÊòØÔºåÂ§öÊÄÅÂèØ‰ª•‰ΩøÂæóÊàë‰ª¨ÁöÑ‰ª£Á†ÅÊõ¥Âä†ÁÆÄÊ¥ÅÂíå‰ºòÈõÖ„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlÂÖ≥Èó≠update safe mode]]></title>
    <url>%2F2019%2F03%2F11%2Fmysql%E5%85%B3%E9%97%ADupdate-safe-mode%2F</url>
    <content type="text"><![CDATA[SET SQL_SAFE_UPDATES = 0;]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git-‰øùÊåÅforkÁöÑÈ°πÁõÆ‰∏é‰∏äÊ∏∏ÂêåÊ≠•]]></title>
    <url>%2F2019%2F02%2F26%2Fgit-%E4%BF%9D%E6%8C%81fork%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%8E%E4%B8%8A%E6%B8%B8%E5%90%8C%E6%AD%A5%2F</url>
    <content type="text"><![CDATA[Ê∑ªÂä†‰∏äÊ∏∏‰ªìÂ∫ìÔºö git remote add upstream [upstream_url] fetch ‰πãÔºö git fetch upstream ÂàáÊç¢Âà∞Êú¨Âú∞masterÂàÜÊîØÔºö git checkout master Â∞Üupstream/master mergeÂà∞ Êú¨Âú∞masterÂàÜÊîØÔºö git merge upstream/master //ÂèØËÉΩ‰ºöÊä•ÈîôÔºåÂ¶ÇÊûúÊä•ÈîôÂ∞±ÊâßË°åÔºögit pull ÂêåÊó∂pushÂà∞Ëá™Â∑±ÁöÑgithub‰ªìÂ∫ìÔºö git push origin master]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËØ¶Ëß£Go regexpÂåÖ‰∏≠ ReplaceAllString ÁöÑÁî®Ê≥ï]]></title>
    <url>%2F2019%2F02%2F01%2F%E8%AF%A6%E8%A7%A3Go-regexp%E5%8C%85%E4%B8%AD-ReplaceAllString-%E7%9A%84%E7%94%A8%E6%B3%95%2F</url>
    <content type="text"><![CDATA[Êò®Â§©ÊúâÂêå‰∫ãÂú®Áúãk8sÊ∫êÁ†ÅÔºåÁ™ÅÁÑ∂ÈóÆ‰∫Ü‰∏Ä‰∏™Áúã‰ººÂæàÁÆÄÂçïÁöÑÈóÆÈ¢òÔºåhttps://golang.org/pkg/regexp/#Regexp.ReplaceAllString ÂÆòÊñπÊñáÊ°£‰∏≠ReplaceAllStringÁöÑËß£ÈáäÔºåÂà∞Â∫ïÊòØ‰ªÄ‰πàÊÑèÊÄùÔºüÂà∞Â∫ïÊÄé‰πàÁî®Ôºü ÂÆòÊñπËã±ÊñáÂéüÊñáÔºö func (re *Regexp) ReplaceAllString(src, repl string) string 12ReplaceAllString returns a copy of src, replacing matches of the Regexp with the replacement string repl. Inside repl, $ signs are interpreted as in Expand, so for instance $1 represents the text of the first submatch. ‰∏≠ÊñáÊñáÊ°£Ôºö 1ReplaceAllLiteralËøîÂõûsrcÁöÑ‰∏Ä‰∏™Êã∑Ë¥ùÔºåÂ∞Üsrc‰∏≠ÊâÄÊúâreÁöÑÂåπÈÖçÁªìÊûúÈÉΩÊõøÊç¢‰∏∫repl„ÄÇÂú®ÊõøÊç¢Êó∂Ôºårepl‰∏≠ÁöÑ&apos;$&apos;Á¨¶Âè∑‰ºöÊåâÁÖßExpandÊñπÊ≥ïÁöÑËßÑÂàôËøõË°åËß£ÈáäÂíåÊõøÊç¢Ôºå‰æãÂ¶Ç$1‰ºöË¢´ÊõøÊç¢‰∏∫Á¨¨‰∏Ä‰∏™ÂàÜÁªÑÂåπÈÖçÁªìÊûú„ÄÇ Áúã‰∏äÂéª‰∏ÄËÑ∏ÊáµÈÄºÔºåËøòÊòØ‰∏çÁêÜËß£Ëøô‰∏™ÂáΩÊï∞Âà∞Â∫ïÊÄé‰πàÁî®„ÄÇ ÂèàÂéªÁúãÂÆòÊñπÁöÑÁ§∫‰æãÔºö 12345678910111213ExampleÔºöre := regexp.MustCompile("a(x*)b")fmt.Println(re.ReplaceAllString("-ab-axxb-", "T"))fmt.Println(re.ReplaceAllString("-ab-axxb-", "$1"))fmt.Println(re.ReplaceAllString("-ab-axxb-", "$1W"))fmt.Println(re.ReplaceAllString("-ab-axxb-", "$&#123;1&#125;W"))Output:-T-T---xx-----W-xxW- Á¨¨‰∏Ä‰∏™ÊõøÊç¢ÂãâÂº∫ËÉΩÁúãÊòéÁôΩÔºåÊòØÁî®TÂéªÊõøÊç¢-ab-axxb-‰∏≠Á¨¶ÂêàÊ≠£ÂàôË°®ËææÂºèÂåπÈÖçÁöÑÈÉ®ÂàÜÔºõÁ¨¨‰∫å‰∏™‰∏≠ÁöÑ$ÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü$1ÁúãËµ∑Êù•ÂÉèÊòØÂåπÈÖçÊ≠£ÂàôË°®ËææÂºèÂàÜÁªÑ‰∏≠Á¨¨‰∏ÄÈÉ®ÂàÜÔºåÈÇ£$1WÂë¢Ôºü${1}WÂë¢ÔºüÂ∏¶ÁùÄËøô‰∫õÈóÆÈ¢òÔºåÂºÄÂßãÊ∑±ÂÖ•Á†îÁ©∂Ëøô‰∏™ÂáΩÊï∞Âà∞Â∫ïÊÄé‰πàÁî®„ÄÇ È¶ñÂÖàÔºå$Á¨¶Âè∑Âú®ExpandÂáΩÊï∞‰∏≠ÊúâËß£ÈáäËøáÔºö 123456789func (re *Regexp) Expand(dst []byte, template []byte, src []byte, match []int) []byteExpandËøîÂõûÊñ∞ÁîüÊàêÁöÑÂ∞ÜtemplateÊ∑ªÂä†Âà∞dstÂêéÈù¢ÁöÑÂàáÁâá„ÄÇÂú®Ê∑ªÂä†Êó∂ÔºåExpand‰ºöÂ∞Ütemplate‰∏≠ÁöÑÂèòÈáèÊõøÊç¢‰∏∫‰ªésrcÂåπÈÖçÁöÑÁªìÊûú„ÄÇmatchÂ∫îËØ•ÊòØË¢´FindSubmatchIndexËøîÂõûÁöÑÂåπÈÖçÁªìÊûúËµ∑Ê≠¢‰ΩçÁΩÆÁ¥¢Âºï„ÄÇÔºàÈÄöÂ∏∏Â∞±ÊòØÂåπÈÖçsrcÔºåÈô§Èùû‰Ω†Ë¶ÅÂ∞ÜÂåπÈÖçÂæóÂà∞ÁöÑ‰ΩçÁΩÆÁî®‰∫éÂè¶‰∏Ä‰∏™[]byteÔºâÂú®templateÂèÇÊï∞ÈáåÔºå‰∏Ä‰∏™ÂèòÈáèË°®Á§∫‰∏∫Ê†ºÂºèÂ¶ÇÔºö$nameÊàñ$&#123;name&#125;ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂÖ∂‰∏≠nameÊòØÈïøÂ∫¶&gt;0ÁöÑÂ≠óÊØç„ÄÅÊï∞Â≠óÂíå‰∏ãÂàíÁ∫øÁöÑÂ∫èÂàó„ÄÇ‰∏Ä‰∏™ÂçïÁ∫ØÁöÑÊï∞Â≠óÂ≠óÁ¨¶ÂêçÂ¶Ç$1‰ºö‰Ωú‰∏∫ÊçïËé∑ÂàÜÁªÑÁöÑÊï∞Â≠óÁ¥¢ÂºïÔºõÂÖ∂‰ªñÁöÑÂêçÂ≠óÂØπÂ∫î(?P&lt;name&gt;...)ËØ≠Ê≥ï‰∫ßÁîüÁöÑÂëΩÂêçÊçïËé∑ÂàÜÁªÑÁöÑÂêçÂ≠ó„ÄÇË∂ÖÂá∫ËåÉÂõ¥ÁöÑÊï∞Â≠óÁ¥¢Âºï„ÄÅÁ¥¢ÂºïÂØπÂ∫îÁöÑÂàÜÁªÑÊú™ÂåπÈÖçÂà∞ÊñáÊú¨„ÄÅÊ≠£ÂàôË°®ËææÂºè‰∏≠Êú™Âá∫Áé∞ÁöÑÂàÜÁªÑÂêçÔºåÈÉΩ‰ºöË¢´ÊõøÊç¢‰∏∫Á©∫ÂàáÁâá„ÄÇ$nameÊ†ºÂºèÁöÑÂèòÈáèÂêçÔºåname‰ºöÂ∞ΩÂèØËÉΩÂèñÊúÄÈïøÂ∫èÂàóÔºö$1xÁ≠â‰ª∑‰∫é$&#123;1x&#125;ËÄåÈùû$&#123;1&#125;xÔºå$10Á≠â‰ª∑‰∫é$&#123;10&#125;ËÄåÈùû$&#123;1&#125;0„ÄÇÂõ†Ê≠§$nameÈÄÇÁî®Âú®ÂêéË∑üÁ©∫Ê†º/Êç¢Ë°åÁ≠âÂ≠óÁ¨¶ÁöÑÊÉÖÂÜµÔºå$&#123;name&#125;ÈÄÇÁî®ÊâÄÊúâÊÉÖÂÜµ„ÄÇÂ¶ÇÊûúË¶ÅÂú®ËæìÂá∫‰∏≠ÊèíÂÖ•‰∏Ä‰∏™Â≠óÈù¢ÂÄº&apos;$&apos;ÔºåÂú®templateÈáåÂèØ‰ª•‰ΩøÁî®$$„ÄÇ ËØ¥‰∫ÜËøô‰πàÂ§öÔºåÂÖ∂ÂÆûÊúÄÁªàË¶ÅÁöÑÈÉ®ÂàÜÂèØ‰ª•Ê¶ÇÊã¨‰∏∫‰∏âÁÇπÔºö $ÂêéÈù¢Âè™ÊúâÊï∞Â≠óÔºåÂàô‰ª£Ë°®Ê≠£ÂàôË°®ËææÂºèÁöÑÂàÜÁªÑÁ¥¢ÂºïÔºåÂÖ≥‰∫éÊ≠£ÂàôË°®ËææÂºèÁöÑÂàÜÁªÑËß£ÈáäÔºö ÊçïËé∑ÁªÑÂèØ‰ª•ÈÄöËøá‰ªéÂ∑¶Âà∞Âè≥ËÆ°ÁÆóÂÖ∂ÂºÄÊã¨Âè∑Êù•ÁºñÂè∑ „ÄÇ‰æãÂ¶ÇÔºåÂú®Ë°®ËææÂºè (A)(B(C)) ‰∏≠ÔºåÂ≠òÂú®Âõõ‰∏™ËøôÊ†∑ÁöÑÁªÑÔºö 0 (A)(B(C)) 1 (A) 2 (B(C)) 3 (C) ÁªÑÈõ∂ÂßãÁªà‰ª£Ë°®Êï¥‰∏™Ë°®ËææÂºè ‰πãÊâÄ‰ª•ËøôÊ†∑ÂëΩÂêçÊçïËé∑ÁªÑÊòØÂõ†‰∏∫Âú®ÂåπÈÖç‰∏≠Ôºå‰øùÂ≠ò‰∫Ü‰∏éËøô‰∫õÁªÑÂåπÈÖçÁöÑËæìÂÖ•Â∫èÂàóÁöÑÊØè‰∏™Â≠êÂ∫èÂàó„ÄÇÊçïËé∑ÁöÑÂ≠êÂ∫èÂàóÁ®çÂêéÂèØ‰ª•ÈÄöËøá Back ÂºïÁî®ÔºàÂèçÂêëÂºïÁî®Ôºâ Âú®Ë°®ËææÂºè‰∏≠‰ΩøÁî®Ôºå‰πüÂèØ‰ª•Âú®ÂåπÈÖçÊìç‰ΩúÂÆåÊàêÂêé‰ªéÂåπÈÖçÂô®Ê£ÄÁ¥¢„ÄÇ ÂåπÈÖçÊ≠£ÂàôË°®ËææÂºèÁöÑ$1ÈÉ®ÂàÜÔºå‰øùÁïôËØ•ÈÉ®ÂàÜÔºåÂéªÊéâÂÖ∂‰ΩôÈÉ®ÂàÜÔºõ $ÂêéÈù¢ÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂç≥$name,‰ª£Ë°®ÂåπÈÖçÂØπÂ∫î(?P‚Ä¶)ËØ≠Ê≥ï‰∫ßÁîüÁöÑÂëΩÂêçÊçïËé∑ÂàÜÁªÑÁöÑÂêçÂ≠ó ${Êï∞Â≠ó}Â≠óÁ¨¶‰∏≤,Âç≥${1}xxxÔºåÊÑèÊÄùÊòØÂåπÈÖçÊ≠£ÂàôË°®ËææÂºèÁöÑÂàÜÁªÑ1Ôºåsrc‰∏≠ÂåπÈÖçÂàÜÁªÑ1ÁöÑ‰øùÁïôÔºåÂπ∂Âà†Èô§srcÂâ©‰ΩôÈÉ®ÂàÜÔºåËøΩÂä†xxxÔºåÂêéÈù¢‰ºöÊúâ‰ª£Á†ÅÁ§∫‰æãËß£ÈáäËøôÈÉ®ÂàÜÔºå‰πüÊòØÊúÄÈöæÁêÜËß£ÁöÑÈÉ®ÂàÜ ÊúÄÁÆÄÂçïÁöÑÊÉÖÂÜµÔºåÂèÇÊï∞replÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂ∞Üsrc‰∏≠ÊâÄÊúâreÁöÑÂåπÈÖçÁªìÊûúÈÉΩÊõøÊç¢‰∏∫repl ‰∏ãÈù¢Áî®‰ª£Á†ÅÊù•Ëß£Èáä‰ª•‰∏äÂá†ÁßçÊÉÖÂÜµÔºö 1234567891011121314151617181920212223242526272829303132333435package mainimport ("fmt""regexp")func main() &#123; s := "Hello World, 123 Go!" //ÂÆö‰πâ‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèregÔºåÂåπÈÖçHelloÊàñËÄÖGo reg := regexp.MustCompile(`(Hell|G)o`) s2 := "2019-12-01,test" //ÂÆö‰πâ‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèreg2,ÂåπÈÖç YYYY-MM-DD ÁöÑÊó•ÊúüÊ†ºÂºè reg2 := regexp.MustCompile(`(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)`) //ÊúÄÁÆÄÂçïÁöÑÊÉÖÂÜµÔºåÁî®‚ÄúTÊõøÊç¢‚Äù"-ab-axxb-"‰∏≠Á¨¶ÂêàÊ≠£Âàô"a(x*)b"ÁöÑÈÉ®ÂàÜ reg3 := regexp.MustCompile("a(x*)b") fmt.Println(re.ReplaceAllString("-ab-axxb-", "T")) //$&#123;1&#125;ÂåπÈÖç"Hello World, 123 Go!"‰∏≠Á¨¶ÂêàÊ≠£Âàô`(Hell|G)`ÁöÑÈÉ®ÂàÜÂπ∂‰øùÁïôÔºåÂéªÊéâ"Hello"‰∏é"Go"‰∏≠ÁöÑ'o'Âπ∂Áî®"ddd"ËøΩÂä† rep1 := "$&#123;1&#125;ddd" fmt.Printf("%q\n", reg.ReplaceAllString(s, rep1)) //È¶ñÂÖàÔºå"2019-12-01,test"‰∏≠Á¨¶ÂêàÊ≠£ÂàôË°®ËææÂºè`(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)`ÁöÑÈÉ®ÂàÜÊòØ"2019-12-01",Â∞ÜËØ•ÈÉ®ÂàÜÂåπÈÖç'(\d&#123;4&#125;)'ÁöÑ'2019'‰øùÁïôÔºåÂéªÊéâÂâ©‰ΩôÈÉ®ÂàÜ rep2 := "$&#123;1&#125;" fmt.Printf("%q\n", reg2.ReplaceAllString(s2,rep2)) //È¶ñÂÖàÔºå"2019-12-01,test"‰∏≠Á¨¶ÂêàÊ≠£ÂàôË°®ËææÂºè`(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)`ÁöÑÈÉ®ÂàÜÊòØ"2019-12-01",Â∞ÜËØ•ÈÉ®ÂàÜÂåπÈÖç'(\d&#123;2&#125;)'ÁöÑ'12'‰øùÁïôÔºåÂéªÊéâÂâ©‰ΩôÈÉ®ÂàÜ rep3 := "$&#123;2&#125;" fmt.Printf("%q\n", reg2.ReplaceAllString(s2,rep3)) //È¶ñÂÖàÔºå"2019-12-01,test"‰∏≠Á¨¶ÂêàÊ≠£ÂàôË°®ËææÂºè`(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)`ÁöÑÈÉ®ÂàÜÊòØ"2019-12-01",Â∞ÜËØ•ÈÉ®ÂàÜÂåπÈÖç'(\d&#123;2&#125;)'ÁöÑ'01'‰øùÁïôÔºåÂéªÊéâÂâ©‰ΩôÈÉ®ÂàÜ,Âπ∂ËøΩÂä†"13:30:12" rep4 := "$&#123;3&#125;:13:30:12" fmt.Printf("%q\n", reg2.ReplaceAllString(s2,rep4)) &#125; ‰∏äÈù¢‰ª£Á†ÅËæìÂá∫‰æùÊ¨°ÊòØÔºö 123456$ go run main.go-T-T-"Hellddd World, 123 Gddd!""2019,test""12,test""01:13:30:12,test" ÊÄªÁªìGoregexpÂåÖ‰∏≠ÁöÑReplaceAllStringËÆæËÆ°Êúâ‰∫õËÆ∏Âèç‰∫∫Á±ªÔºåÁêÜËß£Âíå‰ΩøÁî®‰∏äÊÑüËßâ‰∏çÊñπ‰æøÔºåÂ¶ÇÊûú‰Ω†ÊúâÊõ¥Â•ΩÁöÑÁêÜËß£ÊàñËÄÖÁ§∫‰æã‰ª£Á†ÅÔºåCall me!]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[goËØ≠Ë®ÄÂùë‰πãfor range]]></title>
    <url>%2F2019%2F01%2F31%2Fgo%E8%AF%AD%E8%A8%80%E5%9D%91%E4%B9%8Bfor-range%2F</url>
    <content type="text"><![CDATA[goËØ≠Ë®ÄÂùë‰πãfor range ËøôÁØáÊñáÁ´†ÁÆÄÂçïÊ∏ÖÊô∞Âú∞Ëß£Èáä‰∫Ü‰πãÂâçÈÅçÂéÜstructÂàáÁâáÊó∂ÈÅáÂà∞ÁöÑ‰∏Ä‰∫õÊÄ™ÂºÇÁé∞Ë±°ÔºåËøô‰∏™ÈóÆÈ¢òÂΩìÊó∂‰πüÂÜô‰∫Ü‰∏ÄÁØáÊñáÁ´†Êù•ËÆ®ËÆ∫ÔºåÊñáÁ´†Âú∞ÂùÄÔºå‰ΩÜÊòØÊ≤°ÊúâÂàá‰∏≠Ë¶ÅÁÇπ„ÄÇÊò®Â§©Êó†ÊÑè‰∏≠ÁúãÂà∞ËøôÁØáÂçöÂÆ¢ÔºåË±ÅÁÑ∂ÂºÄÊúó„ÄÇ goÂè™Êèê‰æõ‰∫Ü‰∏ÄÁßçÂæ™ÁéØÊñπÂºèÔºåÂç≥forÂæ™ÁéØÔºåÂú®‰ΩøÁî®Êó∂ÂèØ‰ª•ÂÉècÈÇ£Ê†∑‰ΩøÁî®Ôºå‰πüÂèØ‰ª•ÈÄöËøáfor rangeÊñπÂºèÈÅçÂéÜÂÆπÂô®Á±ªÂûãÂ¶ÇÊï∞ÁªÑ„ÄÅÂàáÁâáÂíåÊò†Â∞Ñ„ÄÇ‰ΩÜÊòØÂú®‰ΩøÁî®for rangeÊó∂ÔºåÂ¶ÇÊûú‰ΩøÁî®‰∏çÂΩìÔºåÂ∞±‰ºöÂá∫Áé∞‰∏Ä‰∫õÈóÆÈ¢òÔºåÂØºËá¥Á®ãÂ∫èËøêË°åË°å‰∏∫‰∏çÂ¶ÇÈ¢ÑÊúü„ÄÇÊØîÂ¶ÇÔºå‰∏ãÈù¢ÁöÑÁ§∫‰æãÁ®ãÂ∫èÂ∞ÜÈÅçÂéÜ‰∏Ä‰∏™ÂàáÁâáÔºåÂπ∂Â∞ÜÂàáÁâáÁöÑÂÄºÂΩìÊàêÊò†Â∞ÑÁöÑÈîÆÂíåÂÄºÂ≠òÂÖ•ÔºåÂàáÁâáÁ±ªÂûãÊòØ‰∏Ä‰∏™intÂûãÔºåÊò†Â∞ÑÁöÑÁ±ªÂûãÊòØÈîÆ‰∏∫intÂûãÔºåÂÄº‰∏∫*intÔºåÂç≥ÂÄºÊòØ‰∏Ä‰∏™Âú∞ÂùÄ„ÄÇ 1234567891011121314151617181920package mainimport &quot;fmt&quot;func main() &#123; slice := []int&#123;0, 1, 2, 3&#125; myMap := make(map[int]*int) for index, value := range slice &#123; myMap[index] = &amp;value &#125; fmt.Println(&quot;=====new map=====&quot;) prtMap(myMap)&#125;func prtMap(myMap map[int]*int) &#123; for key, value := range myMap &#123; fmt.Printf(&quot;map[%v]=%v\n&quot;, key, *value) &#125;&#125; ËøêË°åÁ®ãÂ∫èËæìÂá∫Â¶Ç‰∏ãÔºö 12345=====new map=====map[3]=3map[0]=3map[1]=3map[2]=3 Áî±ËæìÂá∫ÂèØ‰ª•Áü•ÈÅìÔºå‰∏çÊòØÊàë‰ª¨È¢ÑÊúüÁöÑËæìÂá∫ÔºåÊ≠£Á°ÆËæìÂá∫Â∫îËØ•Â¶Ç‰∏ãÔºö 123456=====new map=====map[0]=0map[1]=1map[2]=2map[3]=3ÔºàÊó†Â∫èËæìÂá∫Ôºå‰ΩÜÊòØÂÄºÊòØ0,1,2,3Ôºâ ‰ΩÜÊòØÁî±ËæìÂá∫ÂèØ‰ª•Áü•ÈÅìÔºåÊò†Â∞ÑÁöÑÂÄºÈÉΩÁõ∏Âêå‰∏îÈÉΩÊòØ3„ÄÇÂÖ∂ÂÆûÂèØ‰ª•ÁåúÊµãÊò†Â∞ÑÁöÑÂÄºÈÉΩÊòØÂêå‰∏Ä‰∏™Âú∞ÂùÄÔºåÈÅçÂéÜÂà∞ÂàáÁâáÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†3Êó∂ÔºåÂ∞Ü3ÂÜôÂÖ•‰∫ÜËØ•Âú∞ÂùÄÔºåÊâÄ‰ª•ÂØºËá¥Êò†Â∞ÑÊâÄÊúâÂÄºÈÉΩÁõ∏Âêå„ÄÇÂÖ∂ÂÆûÁúüÂÆûÂéüÂõ†‰πüÊòØÂ¶ÇÊ≠§ÔºåÂõ†‰∏∫for rangeÂàõÂª∫‰∫ÜÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂâØÊú¨ÔºåËÄå‰∏çÊòØÁõ¥Êé•ËøîÂõûÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂºïÁî®ÔºåÂ¶ÇÊûú‰ΩøÁî®ËØ•ÂÄºÂèòÈáèÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ÊåáÂêëÊØè‰∏™ÂÖÉÁ¥†ÁöÑÊåáÈíàÔºåÂ∞±‰ºöÂØºËá¥ÈîôËØØÔºåÂú®Ëø≠‰ª£Êó∂ÔºåËøîÂõûÁöÑÂèòÈáèÊòØ‰∏Ä‰∏™Ëø≠‰ª£ËøáÁ®ã‰∏≠Ê†πÊçÆÂàáÁâá‰æùÊ¨°ËµãÂÄºÁöÑÊñ∞ÂèòÈáèÔºåÊâÄ‰ª•ÂÄºÁöÑÂú∞ÂùÄÊÄªÊòØÁõ∏ÂêåÁöÑÔºåÂØºËá¥ÁªìÊûú‰∏çÂ¶ÇÈ¢ÑÊúü„ÄÇ ‰øÆÊ≠£ÂêéÁ®ãÂ∫èÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021package mainimport &quot;fmt&quot;func main() &#123; slice := []int&#123;0, 1, 2, 3&#125; myMap := make(map[int]*int) for index, value := range slice &#123; num := value myMap[index] = &amp;num &#125; fmt.Println(&quot;=====new map=====&quot;) prtMap(myMap)&#125;func prtMap(myMap map[int]*int) &#123; for key, value := range myMap &#123; fmt.Printf(&quot;map[%v]=%v\n&quot;, key, *value) &#125;&#125; ËøêË°åÁ®ãÂ∫èËæìÂá∫Â¶Ç‰∏ãÔºö 12345=====new map=====map[2]=2map[3]=3map[0]=0map[1]=1 ÂºïÁî®Â£∞ÊòéÔºöËØ•ÂçöÂÆ¢Êù•Ëá™‰∫éËøôÈáå.]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËÆ∞Á¨¨‰∏Ä‰∏™VueÈ°πÁõÆÂè∞ÂâçÂπïÂêéÁöÑÁªèÂéÜ]]></title>
    <url>%2F2019%2F01%2F28%2F%E8%AE%B0%E7%AC%AC%E4%B8%80%E4%B8%AAVue%E9%A1%B9%E7%9B%AE%E5%8F%B0%E5%89%8D%E5%B9%95%E5%90%8E%E7%9A%84%E7%BB%8F%E5%8E%86%2F</url>
    <content type="text"><![CDATA[0ÂâçÁ´ØÂºÄÂèëÁªèÈ™åÔºåÂàùÊ¨°Êé•Ëß¶VueÔºå‰ªéÂêéÁ´ØÂà∞ÂâçÁ´ØÔºå‰ªéÂºÄÂèë„ÄÅÊâìÂåÖÂà∞ÈÉ®ÁΩ≤ÔºåÂÆåÊï¥ÁöÑÂéÜÁ®ã„ÄÇ È¶ñÂÖàÁ≤óÁï•ÈÄöËØª‰∫Ü‰∏ÄÈÅçÂÆòÊñπÊñáÊ°£ÔºåÂä®ÊâãÁî®webpackÊê≠Âª∫‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑdemo„ÄÇ Áúã‰∫ÜEchartsÁöÑÂÆòÊñπdemoÔºå‰∫ÜËß£‰∫ÜÂá†ÁßçÊï∞ÊçÆÂõæË°®ÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇÂõ†‰∏∫ÊàëË¶ÅÂÅöÁöÑÈ°πÁõÆÂ∞±ÊòØË¶ÅÂ∞ÜÂêéÁ´ØÊé•Âè£ÁöÑÊï∞ÊçÆÊãøÂà∞ÔºåÁÑ∂ÂêéÂõæÂΩ¢ÂåñÁöÑÂΩ¢ÂºèÂ±ïÁ§∫Âá∫Êù•„ÄÇ ÂØπÊé•ÂêéÁ´ØÔºåËøõË°åaxios‰∫åÊ¨°ÂºÄÂèëÂú®ÊûÑÂª∫Â∫îÁî®Êó∂ÈúÄË¶ÅËÆøÈóÆ‰∏Ä‰∏™ API Âπ∂Â±ïÁ§∫ÂÖ∂Êï∞ÊçÆÔºåË∞ÉÁ†îVueÁöÑÂ§öÁßçÊñπÂºèÂêéÈÄâÊã©‰∫ÜÂÆòÊñπÊé®ËçêÁöÑaxiox„ÄÇ ‰ªéajaxÂà∞fetch„ÄÅaxiosÂâçÁ´ØÊòØ‰∏™ÂèëÂ±ïËøÖÈÄüÁöÑÈ¢ÜÂüüÔºåÂâçÁ´ØËØ∑Ê±ÇËá™ÁÑ∂‰πüÂèëÂ±ïËøÖÈÄüÔºå‰ªéÂéüÁîüÁöÑXHRÂà∞jquery ajaxÔºåÂÜçÂà∞Áé∞Âú®ÁöÑaxiosÂíåfetch„ÄÇ jquery ajax123456789$.ajax(&#123; type: &apos;POST&apos;, url: url, data: data, dataType: dataType, success: function() &#123;&#125;, error: function() &#123;&#125;&#125;)Â§çÂà∂‰ª£Á†Å ÂÆÉÊòØÂØπÂéüÁîüXHRÁöÑÂ∞ÅË£ÖÔºåËøòÊîØÊåÅJSONPÔºåÈùûÂ∏∏Êñπ‰æøÔºõÁúüÁöÑÊòØÁî®ËøáÁöÑÈÉΩËØ¥Â•Ω„ÄÇ‰ΩÜÊòØÈöèÁùÄreactÔºåvueÁ≠âÂâçÁ´ØÊ°ÜÊû∂ÁöÑÂÖ¥Ëµ∑ÔºåjqueryÊó©Â∑≤‰∏çÂ§çÂΩìÂπ¥‰πãÂãá„ÄÇÂæàÂ§öÊÉÖÂÜµ‰∏ãÊàë‰ª¨Âè™ÈúÄË¶Å‰ΩøÁî®ajaxÔºå‰ΩÜÊòØÂç¥ÈúÄË¶ÅÂºïÂÖ•Êï¥‰∏™jqueryÔºåËøôÈùûÂ∏∏ÁöÑ‰∏çÂêàÁêÜÔºå‰∫éÊòØ‰æøÊúâ‰∫ÜfetchÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ fetchfetchÂè∑Áß∞ÊòØajaxÁöÑÊõø‰ª£ÂìÅÔºåÂÆÉÁöÑAPIÊòØÂü∫‰∫éPromiseËÆæËÆ°ÁöÑÔºåÊóßÁâàÊú¨ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅPromiseÔºåÈúÄË¶Å‰ΩøÁî®polyfill es6-promise ‰∏æ‰∏™‰æãÂ≠êÔºö 12345678910111213141516171819// ÂéüÁîüXHRvar xhr = new XMLHttpRequest();xhr.open(&apos;GET&apos;, url);xhr.onreadystatechange = function() &#123; if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123; console.log(xhr.responseText) // ‰ªéÊúçÂä°Âô®Ëé∑ÂèñÊï∞ÊçÆ &#125;&#125;xhr.send()// fetchfetch(url) .then(response =&gt; &#123; if (response.ok) &#123; response.json() &#125; &#125;) .then(data =&gt; console.log(data)) .catch(err =&gt; console.log(err))Â§çÂà∂‰ª£Á†Å ÁúãËµ∑Êù•Â•ΩÂÉèÊòØÊñπ‰æøÁÇπÔºåthenÈìæÂ∞±ÂÉè‰πãÂâçÁÜüÊÇâÁöÑcallback„ÄÇ Âú®MDN‰∏äÔºåËÆ≤Âà∞ÂÆÉË∑üjquery ajaxÁöÑÂå∫Âà´ÔºåËøô‰πüÊòØfetchÂæàÂ•áÊÄ™ÁöÑÂú∞ÊñπÔºö ÂΩìÊé•Êî∂Âà∞‰∏Ä‰∏™‰ª£Ë°®ÈîôËØØÁöÑ HTTP Áä∂ÊÄÅÁ†ÅÊó∂Ôºå‰ªé fetch()ËøîÂõûÁöÑ Promise ‰∏ç‰ºöË¢´Ê†áËÆ∞‰∏∫ rejectÔºå Âç≥‰ΩøËØ• HTTP ÂìçÂ∫îÁöÑÁä∂ÊÄÅÁ†ÅÊòØ 404 Êàñ 500„ÄÇÁõ∏ÂèçÔºåÂÆÉ‰ºöÂ∞Ü Promise Áä∂ÊÄÅÊ†áËÆ∞‰∏∫ resolve Ôºà‰ΩÜÊòØ‰ºöÂ∞Ü resolve ÁöÑËøîÂõûÂÄºÁöÑ ok Â±ûÊÄßËÆæÁΩÆ‰∏∫ false ÔºâÔºå ‰ªÖÂΩìÁΩëÁªúÊïÖÈöúÊó∂ÊàñËØ∑Ê±ÇË¢´ÈòªÊ≠¢Êó∂ÔºåÊâç‰ºöÊ†áËÆ∞‰∏∫ reject„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ã, fetch ‰∏ç‰ºö‰ªéÊúçÂä°Á´ØÂèëÈÄÅÊàñÊé•Êî∂‰ªª‰Ωï cookies, Â¶ÇÊûúÁ´ôÁÇπ‰æùËµñ‰∫éÁî®Êà∑ sessionÔºåÂàô‰ºöÂØºËá¥Êú™ÁªèËÆ§ËØÅÁöÑËØ∑Ê±ÇÔºàË¶ÅÂèëÈÄÅ cookiesÔºåÂøÖÈ°ªËÆæÁΩÆ credentials ÈÄâÈ°πÔºâ. Á™ÅÁÑ∂ÊÑüËßâËøôËøò‰∏çÂ¶Çjquery ajaxÂ•ΩÁî®Âë¢ÔºüÂà´ÊÄ•ÔºåÂÜçÊê≠ÈÖç‰∏äasync/awaitÂ∞Ü‰ºöËÆ©Êàë‰ª¨ÁöÑÂºÇÊ≠•‰ª£Á†ÅÊõ¥Âä†‰ºòÈõÖÔºö 123456async function test() &#123; let response = await fetch(url); let data = await response.json(); console.log(data)&#125;Â§çÂà∂‰ª£Á†Å ÁúãËµ∑Êù•ÊòØ‰∏çÊòØÂÉèÂêåÊ≠•‰ª£Á†Å‰∏ÄÊ†∑ÔºüÁÆÄÁõ¥ÂÆåÁæéÔºÅÂ•ΩÂêßÔºåÂÖ∂ÂÆûÂπ∂‰∏çÂÆåÁæéÔºåasync/awaitÊòØES7ÁöÑAPIÔºåÁõÆÂâçËøòÂú®ËØïÈ™åÈò∂ÊÆµÔºåËøòÈúÄË¶ÅÊàë‰ª¨‰ΩøÁî®babelËøõË°åËΩ¨ËØëÊàêES5‰ª£Á†Å„ÄÇ ËøòË¶ÅÊèê‰∏Ä‰∏ãÁöÑÊòØÔºåfetchÊòØÊØîËæÉÂ∫ïÂ±ÇÁöÑAPIÔºåÂæàÂ§öÊÉÖÂÜµ‰∏ãÈÉΩÈúÄË¶ÅÊàë‰ª¨ÂÜçÊ¨°Â∞ÅË£Ö„ÄÇ ÊØîÂ¶ÇÔºö 12345678910// jquery ajax$.post(url, &#123;name: &apos;test&apos;&#125;)// fetchfetch(url, &#123; method: &apos;POST&apos;, body: Object.keys(&#123;name: &apos;test&apos;&#125;).map((key) =&gt; &#123; return encodeURIComponent(key) + &apos;=&apos; + encodeURIComponent(params[key]); &#125;).join(&apos;&amp;&apos;)&#125;)Â§çÂà∂‰ª£Á†Å Áî±‰∫éfetchÊòØÊØîËæÉÂ∫ïÂ±ÇÁöÑAPIÔºåÊâÄ‰ª•ÈúÄË¶ÅÊàë‰ª¨ÊâãÂä®Â∞ÜÂèÇÊï∞ÊãºÊé•Êàê‚Äôname=test‚ÄôÁöÑÊ†ºÂºèÔºåËÄåjquery ajaxÂ∑≤ÁªèÂ∞ÅË£ÖÂ•Ω‰∫Ü„ÄÇÊâÄ‰ª•fetchÂπ∂‰∏çÊòØÂºÄÁÆ±Âç≥Áî®ÁöÑ„ÄÇ Âè¶Â§ñÔºåfetchËøò‰∏çÊîØÊåÅË∂ÖÊó∂ÊéßÂà∂„ÄÇ ÂìéÂëÄÔºåÊÑüËßâfetchÂ•ΩÂûÉÂúæÂïäÔºåÔºåËøòÈúÄË¶ÅÁªßÁª≠ÊàêÈïø„ÄÇ„ÄÇ axiosaxiosÊòØÂ∞§Èõ®Ê∫™Â§ßÁ•ûÊé®Ëçê‰ΩøÁî®ÁöÑÔºåÂÆÉ‰πüÊòØÂØπÂéüÁîüXHRÁöÑÂ∞ÅË£Ö„ÄÇÂÆÉÊúâ‰ª•‰∏ãÂá†Â§ßÁâπÊÄßÔºö ÂèØ‰ª•Âú®node.js‰∏≠‰ΩøÁî® Êèê‰æõ‰∫ÜÂπ∂ÂèëËØ∑Ê±ÇÁöÑÊé•Âè£ ÊîØÊåÅPromise API ÁÆÄÂçï‰ΩøÁî® 123456axios(&#123; method: &apos;GET&apos;, url: url,&#125;).then(res =&gt; &#123;console.log(res)&#125;).catch(err =&gt; &#123;console.log(err)&#125;) Âπ∂ÂèëËØ∑Ê±Ç,ÂÆòÊñπÁöÑÂπ∂Âèë‰æãÂ≠êÔºö 123456789101112function getUserAccount() &#123; return axios.get(&apos;/user/12345&apos;);&#125;function getUserPermissions() &#123; return axios.get(&apos;/user/12345/permissions&apos;);&#125;axios.all([getUserAccount(), getUserPermissions()]) .then(axios.spread(function (acct, perms) &#123; // Both requests are now complete &#125;)); axios‰ΩìÁßØÊØîËæÉÂ∞èÔºå‰πüÊ≤°Êúâ‰∏äÈù¢fetchÁöÑÂêÑÁßçÈóÆÈ¢òÔºåÊàëËÆ§‰∏∫ÊòØÂΩìÂâçÊúÄÂ•ΩÁöÑËØ∑Ê±ÇÊñπÂºè ËØ¶ÊÉÖÂèÇËÄÉÂÆòÊñπÊñáÊ°£ #‰∫åÊ¨°Â∞ÅË£Öaxios È¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™request.js,ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788import axios from 'axios';import Qs from 'qs';function checkStatus(err) &#123; let msg = "", level = "error"; switch (err.response.status) &#123; case 401: msg = "ÊÇ®ËøòÊ≤°ÊúâÁôªÈôÜ"; break; case 403: msg = "ÊÇ®Ê≤°ÊúâËØ•È°πÊùÉÈôê"; break; case 404: msg = "ËµÑÊ∫ê‰∏çÂ≠òÂú®"; break; case 500: msg = "ÊúçÂä°Âô®ÂèëÁîü‰∫ÜÁÇπÊÑèÂ§ñ"; break; &#125; try &#123; msg = res.data.msg; &#125; catch (err) &#123; &#125; finally &#123; if (msg !== "" &amp;&amp; msg !== undefined &amp;&amp; msg !== null) &#123; store.dispatch('showSnackBar', &#123;text: msg, level: level&#125;); &#125; &#125; return err.response; &#125; function checkCode(res) &#123; if ((res.status &gt;= 200 &amp;&amp; res.status &lt; 400) &amp;&amp; (res.data.status &gt;= 200 &amp;&amp; res.data.status &lt; 400)) &#123; let msg = "", level = "success"; switch (res.data.status) &#123; case 201: msg = "ÂàõÂª∫ÊàêÂäü"; break; case 204: msg = "Âà†Èô§ÊàêÂäü"; break; &#125; try &#123; msg = res.data.success; &#125; catch (err) &#123; &#125; finally &#123; &#125; return res; &#125; return res; &#125;//ËøôÈáåÂ∞ÅË£ÖaxiosÁöÑget,post,put,deleteÁ≠âÊñπÊ≥ïexport default &#123; get(url, params) &#123; return axios.get( url, params, ).then(checkCode).catch((error)=&gt;&#123;console.log(error)&#125;); &#125;, post(url, data) &#123; return axios.post( url, Qs.stringify(data), ).then(checkCode).catch(checkStatus); &#125;, put(url, data) &#123; return axios.put( url, Qs.stringify(data), ).then(checkCode).catch(checkStatus); &#125;, delete(url, data) &#123; return axios.delete( url, &#123;data: Qs.stringify(data)&#125;, ).then(checkCode).catch(checkStatus); &#125;, patch(url, data) &#123; return axios.patch( url, data, ).then(checkCode).catch(checkStatus); &#125;, &#125;; ÂàõÂª∫‰∏Ä‰∏™api.js,Â≠òÊîæÂêéÁ´ØÁöÑÊé•Âè£Ôºö 12345678910//ÂØºÂÖ•‰∏äÈù¢ÁöÑrequestÊ®°Âùóimport request from './request';//Â£∞ÊòéÂêéÁ´ØÊé•Âè£export const urlUserPrefix = '/v1/users';export const urlProductPrefix = '/v1/products';//‰ΩøÁî®ÂâçÈù¢Â∞ÅË£ÖÂ•ΩÁöÑÊñπÊ≥ïÔºåË∞ÉÁî®ÂêéÁ´ØÊé•Âè£export const getUserslInfoLast = data =&gt; request.get(`$&#123;urlUserPrefix&#125;`, data);export const getProductsInfo = data =&gt; request.get(`$&#123;urlProductPrefix&#125;`, data); Âú®.vueÊñá‰ª∂‰∏≠‰ΩøÁî®ÂÆö‰πâÁöÑÊñπÊ≥ïÔºåËé∑ÂèñÂêéÁ´ØÊé•Âè£ÁöÑÊï∞ÊçÆÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344export default &#123; components: &#123; chart: ECharts, &#125;, store, name: 'ResourceTypeLine', data: () =&gt;(&#123; seconds: -1, //define dataset apiResponse:&#123;&#125;, initOptions: &#123; renderer: options.renderer || 'canvas' &#125;, mounted:function() &#123; this.fTimeArray = this.getFormatTime()//Ë∞ÉÁî®methodÈáåÈù¢ÁöÑÊñπÊ≥ïthis.getUserInfo() &#125;, methods: &#123;//ÂºÇÊ≠•ÊñπÂºèË∞ÉÁî®ÂêéÁ´ØÊé•Âè£ async getUserInfo() &#123; const resThis = await urlUserPrefix(&#123; params: &#123; //getÁöÑÂèÇÊï∞Âú®ËøôÈáåÊ∑ªÂä† beginTime: this.fTimeArray[0], endTime: this.fTimeArray[1], &#125; &#125;); this.apiResponseThisMonth = resThis.data try &#123; &#125; catch (err) &#123; console.log(err); &#125; &#125;, ÂºÄÂèëÁéØÂ¢ÉÈÖçÁΩÆË∑®Âüü‰∏∫‰∫ÜÊõ¥Êñπ‰æøÂú∞‰∏éÂêéÂè∞ËÅîË∞ÉÔºåÈúÄË¶ÅÂú®Áî®vueËÑöÊâãÊû∂ÂàõÂª∫Âú∞È°πÁõÆ‰∏≠ÔºåÂú®configÁõÆÂΩïÂú∞index.jsËÆæÁΩÆproxytableÊù•ÂÆûÁé∞Ë∑®ÂüüËØ∑Ê±ÇÔºåÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647module.exports = &#123; build: &#123; env: require('./prod.env'), index: path.resolve(__dirname, '../dist/index.html'), assetsRoot: path.resolve(__dirname, '../dist'), assetsSubDirectory: 'static', assetsPublicPath: '.', productionSourceMap: false, // Gzip off by default as many popular static hosts such as // Surge or Netlify already gzip all static assets for you. // Before setting to `true`, make sure to: // npm install --save-dev compression-webpack-plugin productionGzip: false, productionGzipExtensions: ['js', 'css'], // Run the build command with an extra argument to // View the bundle analyzer report after build finishes: // `npm run build --report` // Set to `true` or `false` to always turn it on or off bundleAnalyzerReport: process.env.npm_config_report &#125;, dev: &#123; env: require('./dev.env'), port: 8080, // hosts:"0.0.0.0", autoOpenBrowser: true, assetsSubDirectory: 'static', assetsPublicPath: '/', //ÈÖçÁΩÆË∑®ÂüüËØ∑Ê±Ç,Ê≥®ÊÑèÈÖçÁΩÆÂÆå‰πãÂêéÈúÄË¶ÅÈáçÂêØÁºñËØëËØ•È°πÁõÆ proxyTable: &#123; //ËØ∑Ê±ÇÂêçÂ≠óÂèòÈáèÂèØ‰ª•Ëá™Â∑±ÂÆö‰πâ '/api': &#123; target: 'http://test.com', // ËØ∑Ê±ÇÁöÑÊé•Âè£ÂüüÂêçÊàñIPÂú∞ÂùÄÔºåÂºÄÂ§¥ÊòØhttpÊàñhttps // secure: false, // Â¶ÇÊûúÊòØhttpsÊé•Âè£ÔºåÈúÄË¶ÅÈÖçÁΩÆËøô‰∏™ÂèÇÊï∞ changeOrigin: true,// ÊòØÂê¶Ë∑®ÂüüÔºåÂ¶ÇÊûúÊé•Âè£Ë∑®ÂüüÔºåÈúÄË¶ÅËøõË°åËøô‰∏™ÂèÇÊï∞ÈÖçÁΩÆ pathRewrite: &#123; '^/api':""//Ë°®Á§∫ÈúÄË¶ÅrewriteÈáçÂÜôË∑ØÂæÑ &#125; &#125; &#125;, // CSS Sourcemaps off by default because relative paths are "buggy" // with this option, according to the CSS-Loader README // (https://github.com/webpack/css-loader#sourcemaps) // In our experience, they generally work as expected, // just be aware of this issue when enabling this option. cssSourceMap: false &#125;&#125; vue È°πÁõÆÊâìÂåÖÈÉ®ÁΩ≤ÔºåÈÄöËøánginx Ëß£ÂÜ≥Ë∑®ÂüüÈóÆÈ¢ò‚Äã ÊúÄËøëÂ∞ÜÂÖ¨Âè∏vue È°πÁõÆÊâìÂåÖÈÉ®ÁΩ≤ÊúçÂä°Âô®Êó∂Ôºå‰∫ßÁîü‰∫Ü‰∏ÄÁÇπÂ∞èÊèíÊõ≤ÔºåÂºÄÂèëÁéØÂ¢É‰∏≠ÈÖçÁΩÆÁöÑË∑®ÂüüÂú®Â∞ÜÈ°πÁõÆÊâìÂåÖ‰∏∫ÈùôÊÄÅÊñá‰ª∂Êó∂ÊòØÊ≤°ÊúâÁî®ÁöÑ ÔºåÂ∞±ÊÉ≥Âà∞‰∫ÜÁî® nginx ÈÄöËøáÂèçÂêë‰ª£ÁêÜÁöÑÊñπÂºèËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºå‰ΩÜÊòØÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™Â∑®Â§ßÁöÑÂùëÔºåÂêéÈù¢‰ºöËÆ≤Âà∞„ÄÇ ÂâçÊèêÊù°‰ª∂liunx ‰∏ã nginx ÂÆâË£ÖÈÖçÁΩÆÔºàÂ∞Ü‰∏çÂÅöÂ§öÁöÑÈòêËø∞ÔºåËØ∑Ëá™Ë°åÁôæÂ∫¶Ôºâ ÈÖçÁΩÆnginx ÈÄöËøá Xshell ËøûÊé• liunx ÊúçÂä°Âô® ÔºåÊâìÂºÄ nginx.conf ÈÖçÁΩÆÊñá‰ª∂ÔºåÊàñÈÄöËøá WinSCP Áõ¥Êé•ÊâìÂºÄÂπ∂ÁºñËæënginx.confÊñá‰ª∂ ÔºåËøôÈáåÊàëÈÄâÊã©ÂêéËÄÖ „ÄÇÔºàÂÖ∑‰ΩìÈÖçÁΩÆÊñá‰ª∂ÁöÑË∑ØÂæÑÊ†πÊçÆ‰Ω†ÂÆâË£ÖÊó∂ÂÜ≥ÂÆöÔºâ Âú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠Êñ∞Â¢û‰∏Ä‰∏™server 123456789101112131415161718192021222324# Êñ∞Â¢ûÁöÑÊúçÂä° # Êñ∞Â¢ûÁöÑÊúçÂä° server &#123; listen 8086; # ÁõëÂê¨ÁöÑÁ´ØÂè£ location / &#123; root /var/www; # vue ÊâìÂåÖÂêéÈùôÊÄÅÊñá‰ª∂Â≠òÊîæÁöÑÂú∞ÂùÄ index index.html; # ÈªòËÆ§‰∏ªÈ°µÂú∞ÂùÄ &#125; location /v1 &#123; proxy_pass http://47.106.184.89:9010/v1; # ‰ª£ÁêÜÊé•Âè£Âú∞ÂùÄ &#125; location /testApi &#123; proxy_pass http://40.106.197.89:9086/testApi; # ‰ª£ÁêÜÊé•Âè£Âú∞ÂùÄ &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root html; &#125; &#125;Â§çÂà∂‰ª£Á†Å Ëß£ÈáäËØ¥Êòé /var/wwwÊòØÊàëÂΩìÂâçÂ∞Üvue Êñá‰ª∂ÊâìÂåÖÂêéÂ≠òÊîæÂú® liunx‰∏ãÁöÑË∑ØÂæÑ Ôºå ÂΩìÊàë‰ª¨ÂêØÂä® nginx Âêé Â∞±ÂèØ‰ª•ÈÄöËøáhttp://ipÂú∞ÂùÄ:8086/ËÆøÈóÆÂà∞vue ÊâìÂåÖÁöÑÈùôÊÄÅÊñá‰ª∂„ÄÇ 2.location /v1 ÊåáÊã¶Êà™‰ª•v1ÂºÄÂ§¥ÁöÑËØ∑Ê±ÇÔºåhttpËØ∑Ê±ÇÊ†ºÂºè‰∏∫http://ipÂú∞ÂùÄ:8086/v1/***`,ËøôÈáåÊúâ‰∏Ä‰∏™ÂùëÔºÅ‰∏ÄÂÆöË¶ÅÊåâÁÖß‰∏äÈù¢ÁöÑÈÖçÁΩÆÊñá‰ª∂**Ôºöproxy_pass http://47.106.184.89:9010/v1; # ‰ª£ÁêÜÊé•Âè£Âú∞ÂùÄÔºåÂ¶ÇÊûú‰Ω†ÂÉèÊàë‰∏ÄÂºÄÂßãÂÜôÁöÑproxy_pass http://47.106.184.89:9010/; # ‰ª£ÁêÜÊé•Âè£Âú∞ÂùÄ**Ôºå‰Ω†Ê∞∏Ëøú‰πüÂåπÈÖç‰∏çÂà∞ÂØπÂ∫îÁöÑÊé•Âè£ÔºÅ„ÄÇ proxy_pass http://47.106.197.89:9093/v1;` ÂΩìÊã¶Êà™Âà∞ÈúÄË¶ÅÂ§ÑÁêÜÁöÑËØ∑Ê±ÇÊó∂ÔºåÂ∞ÜÊã¶Êà™ËØ∑Ê±Ç‰ª£ÁêÜÂà∞ÁöÑ Êé•Âè£Âú∞ÂùÄ„ÄÇ webpackÊâìÂåÖ‰∏ãÈù¢ÊòØconfig/index.jsÈÖçÁΩÆÊñá‰ª∂ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// see http://vuejs-templates.github.io/webpack for documentation.var path = require(&apos;path&apos;)module.exports = &#123; build: &#123; env: require(&apos;./prod.env&apos;), index: path.resolve(__dirname, &apos;../dist/index.html&apos;), assetsRoot: path.resolve(__dirname, &apos;../dist&apos;), assetsSubDirectory: &apos;static&apos;, assetsPublicPath: &apos;.&apos;, productionSourceMap: false, // Gzip off by default as many popular static hosts such as // Surge or Netlify already gzip all static assets for you. // Before setting to `true`, make sure to: // npm install --save-dev compression-webpack-plugin productionGzip: false, productionGzipExtensions: [&apos;js&apos;, &apos;css&apos;], // Run the build command with an extra argument to // View the bundle analyzer report after build finishes: // `npm run build --report` // Set to `true` or `false` to always turn it on or off bundleAnalyzerReport: process.env.npm_config_report &#125;, dev: &#123; env: require(&apos;./dev.env&apos;), port: 8080, // hosts:&quot;0.0.0.0&quot;, autoOpenBrowser: true, assetsSubDirectory: &apos;static&apos;, assetsPublicPath: &apos;/&apos;, //ÈÖçÁΩÆË∑®ÂüüËØ∑Ê±Ç,Ê≥®ÊÑèÈÖçÁΩÆÂÆå‰πãÂêéÈúÄË¶ÅÈáçÂêØÁºñËØëËØ•È°πÁõÆ proxyTable: &#123; //ËØ∑Ê±ÇÂêçÂ≠óÂèòÈáèÂèØ‰ª•Ëá™Â∑±ÂÆö‰πâ &apos;/api&apos;: &#123; target: &apos;http://billing.hybrid.cloud.ctripcorp.com&apos;, // ËØ∑Ê±ÇÁöÑÊé•Âè£ÂüüÂêçÊàñIPÂú∞ÂùÄÔºåÂºÄÂ§¥ÊòØhttpÊàñhttps // secure: false, // Â¶ÇÊûúÊòØhttpsÊé•Âè£ÔºåÈúÄË¶ÅÈÖçÁΩÆËøô‰∏™ÂèÇÊï∞ changeOrigin: true,// ÊòØÂê¶Ë∑®ÂüüÔºåÂ¶ÇÊûúÊé•Âè£Ë∑®ÂüüÔºåÈúÄË¶ÅËøõË°åËøô‰∏™ÂèÇÊï∞ÈÖçÁΩÆ pathRewrite: &#123; &apos;^/api&apos;:&quot;&quot;//Ë°®Á§∫ÈúÄË¶ÅrewriteÈáçÂÜôË∑ØÂæÑ &#125; &#125; &#125;, // CSS Sourcemaps off by default because relative paths are &quot;buggy&quot; // with this option, according to the CSS-Loader README // (https://github.com/webpack/css-loader#sourcemaps) // In our experience, they generally work as expected, // just be aware of this issue when enabling this option. cssSourceMap: false &#125;&#125; DockerfileÊâìÂåÖDockerÈïúÂÉè 123456789101112FROM Nginx:baseMAINTAINER author &lt;hantmac@outlook.com&gt;WORKDIR /opt/workDirRUN mkdir /var/log/workDirCOPY dist /var/wwwADD nginx/default.conf /etc/nginx/conf.d/default.confENTRYPOINT nginx -g "daemon off;" ÂêéËÆ∞ËøôÊòØÈ¶ñÊ¨°Êé•Ëß¶ÂâçÁ´ØÁöÑÁ¨¨‰∏Ä‰∏™È°πÁõÆÔºåÊúüÈó¥ÁªèÂéÜ‰∫Ü‰ªéÂêéÁ´ØÊé•Âè£ÂºÄÂèëÔºåÂâçÁ´ØÊ°ÜÊû∂ÈÄâÂûãÔºà‰∏ÄÂ∫¶ÊÉ≥Ë¶ÅÁî®reactÔºåÂêéÊù•ËøòÊòØÊîæÂºÉÔºâÔºåÁÜüÊÇâVueÔºåÂà∞ÁªÑ‰ª∂ÂºÄÂèëÔºåwebpackÊûÑÂª∫ÔºåNginxÈÉ®ÁΩ≤ÔºåDockerÂèëÂ∏ÉÁöÑÂÆåÊï¥ËøáÁ®ã„ÄÇËôΩÁÑ∂È°µÈù¢ÊØîËæÉÁÆÄÂçïÔºå‰ΩÜÊòØÊúüÈó¥ÁöÑÈááÂùëÊó†Êï∞ÔºåÂêéÈù¢ËøòË¶ÅÁªßÁª≠Âä™ÂäõÔºÅ]]></content>
      <categories>
        <category>Frontend</category>
      </categories>
      <tags>
        <tag>Vue</tag>
        <tag>Frontend</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[20181202-Postmortem-debugging-Go-services-with-Delve[ÁøªËØë]]]></title>
    <url>%2F2019%2F01%2F20%2F20181202-Postmortem-debugging-Go-services-with-Delve-%E7%BF%BB%E8%AF%91%2F</url>
    <content type="text"><![CDATA[‰ΩøÁî®Delve Ë∞ÉËØïGoÊúçÂä°ÁöÑ‰∏ÄÊ¨°ÁªèÂéÜ Vladimir Varankin ÂÜô‰∫é 2018/12/02 ÊüêÂ§©ÔºåÊàë‰ª¨ÁöÑÁîü‰∫ßÊúçÂä°‰∏äÁöÑÂá†‰∏™ÂÆû‰æãÁ™ÅÁÑ∂‰∏çËÉΩÂ§ÑÁêÜÂ§ñÈÉ®ËøõÂÖ•ÁöÑÊµÅÈáèÔºåHTTPËØ∑Ê±ÇÊàêÂäüÈÄöËøáË¥üËΩΩÂùáË°°Âà∞ËææÂÆû‰æãÔºå‰ΩÜÊòØ‰πãÂêéÂç¥hang‰Ωè‰∫Ü„ÄÇÊé•‰∏ãÊù•ËÆ∞ÂΩïÁöÑÊòØ‰∏ÄÊ¨°Ë∞ÉËØïÂú®Á∫øGoÊúçÂä°ÁöÑÊÉäÂøÉÂä®È≠ÑÁöÑÁªèÂéÜ„ÄÇ Ê≠£ÊòØ‰∏ãÈù¢ÈÄêÊ≠•ÊºîÁ§∫ÁöÑÊìç‰ΩúÔºåÂ∏ÆÂä©Êàë‰ª¨ÂÆö‰Ωç‰∫ÜÈóÆÈ¢òÁöÑÊ†πÊú¨ÂéüÂõ†„ÄÇ ÁÆÄÂçïËµ∑ËßÅÔºåÊàë‰ª¨Â∞ÜËµ∑‰∏Ä‰∏™GoÂÜôÁöÑHTTPÊúçÂä°‰Ωú‰∏∫Ë∞ÉËØï‰ΩøÁî®ÔºåËøô‰∏™ÊúçÂä°ÂÆûÁé∞ÁöÑÁªÜËäÇÊöÇÊó∂‰∏çÂÅöÊ∑±Á©∂Ôºà‰πãÂêéÊàë‰ª¨Â∞ÜÊ∑±ÂÖ•ÂàÜÊûê‰ª£Á†ÅÔºâ„ÄÇ‰∏Ä‰∏™ÁúüÂÆûÁöÑÁîü‰∫ßÂ∫îÁî®ÂèØËÉΩÂåÖÂê´ÂæàÂ§öÁªÑ‰ª∂ÔºåËøô‰∫õÁªÑ‰ª∂ÂÆûÁé∞‰∫Ü‰∏öÂä°ÁΩóÂíåÊúçÂä°ÁöÑÂü∫Á°ÄÊû∂ÊûÑ„ÄÇÊàë‰ª¨ÂèØ‰ª•Á°Æ‰ø°ÔºåËøô‰∫õÂ∫îÁî®Â∑≤ÁªèÂú®Áîü‰∫ßÁéØÂ¢É‚ÄúË∫´ÁªèÁôæÊàò‚Äù :)„ÄÇ Ê∫ê‰ª£Á†Å‰ª•ÂèäÈÖçÁΩÆÁªÜËäÇÂèØ‰ª•Êü•ÁúãGitHub‰ªìÂ∫ì„ÄÇ‰∏∫‰∫ÜÂÆåÊàêÊé•‰∏ãÊù•ÁöÑÂ∑•‰ΩúÔºå‰Ω†ÈúÄË¶Å‰∏ÄÂè∞LinuxÁ≥ªÁªüÁöÑËôöÊú∫ÔºåËøôÈáåÊàë‰ΩøÁî®vagrant-hostmanagerÊèí‰ª∂„ÄÇVagrantfileÂú®GitHub‰ªìÂ∫ìÁöÑÊ†πÁõÆÂΩïÔºåÂèØ‰ª•Êü•ÁúãÊõ¥Â§öÁªÜËäÇ„ÄÇ ËÆ©Êàë‰ª¨ÂºÄÂêØËôöÊú∫ÔºåÊûÑÂª∫HTTPÊúçÂä°Âπ∂‰∏îËøêË°åËµ∑Êù•ÔºåÂèØ‰ª•ÁúãÂà∞‰∏ãÈù¢ÁöÑËæìÂá∫Ôºö 12345678910$ vagrant upBringing machine 'server-test-1' up with 'virtualbox' provider...$ vagrant ssh server-test-1Welcome to Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-33-generic x86_64)¬∑¬∑¬∑vagrant@server-test-1:~$ cd /vagrant/example/servervagrant@server-test-1:/vagrant/example/server$ go buildvagrant@server-test-1:/vagrant/example/server$ ./server --addr=:10080server listening addr=:10080 ÈÄöËøácurlÂèëÈÄÅËØ∑Ê±ÇÂà∞ÊâÄËµ∑ÁöÑHTTPÊúçÂä°ÔºåÂèØ‰ª•Âà§Êñ≠ÂÖ∂ÊòØÂê¶Â§Ñ‰∫éÂ∑•‰ΩúÁä∂ÊÄÅÔºåÊñ∞ÂºÄ‰∏Ä‰∏™terminalÂπ∂ÊâßË°å‰∏ãÈù¢ÁöÑÂëΩ‰ª§Ôºö 12$ curl 'http://server-test-1:10080'OK ‰∏∫‰∫ÜÊ®°ÊãüÂ§±Ë¥•ÁöÑÊÉÖÂÜµÔºåÊàë‰ª¨ÈúÄË¶ÅÂèëÈÄÅÂ§ßÈáèËØ∑Ê±ÇÂà∞HTTPÊúçÂä°ÔºåËøôÈáåÊàë‰ª¨‰ΩøÁî®HTTP benchmarkÊµãËØïÂ∑•ÂÖ∑wrkËøõË°åÊ®°Êãü„ÄÇÊàëÁöÑMacBookÊòØ4Ê†∏ÁöÑÔºåÊâÄ‰ª•‰ΩøÁî®4‰∏™Á∫øÁ®ãËøêË°åwrkÔºåËÉΩÂ§ü‰∫ßÁîü1000‰∏™ËøûÊé•ÔºåÂü∫Êú¨ËÉΩÂ§üÊª°Ë∂≥ÈúÄÊ±Ç„ÄÇ 1234$ wrk -d1m -t4 -c1000 'http://server-test-1:10080'Running 1m test @ http://server-test-1:10080 4 threads and 1000 connections ¬∑¬∑¬∑ ‰∏Ä‰ºöÁöÑÊó∂Èó¥ÔºåÊúçÂä°Âô®hang‰Ωè‰∫Ü„ÄÇÁîöËá≥Á≠âwrkË∑ëÂÆå‰πãÂêéÔºåÊúçÂä°Âô®Â∑≤Áªè‰∏çËÉΩÂ§ÑÁêÜ‰ªª‰ΩïËØ∑Ê±ÇÔºö 12$ curl --max-time 5 'http://server-test-1:10080/'curl: (28) Operation timed out after 5001 milliseconds with 0 bytes received Êàë‰ª¨ÈÅáÂà∞È∫ªÁÉ¶‰∫ÜÔºÅËÆ©Êàë‰ª¨ÂàÜÊûê‰∏Ä‰∏ã„ÄÇ Âú®Êàë‰ª¨Áîü‰∫ßÊúçÂä°ÁöÑÁúüÂÆûÂú∫ÊôØ‰∏≠ÔºåÊúçÂä°Âô®Ëµ∑Êù•‰ª•ÂêéÔºågoroutinesÁöÑÊï∞ÈáèÁî±‰∫éËØ∑Ê±ÇÁöÑÂ¢ûÂ§öËÄåËøÖÈÄüÂ¢ûÂä†Ôºå‰πãÂêé‰æøÂ§±ÂéªÂìçÂ∫î„ÄÇÂØπpprofË∞ÉËØïÂè•ÊüÑÁöÑËØ∑Ê±ÇÂèòÂæóÈùûÂ∏∏ÈùûÂ∏∏ÊÖ¢ÔºåÁúãËµ∑Êù•Â∞±ÂÉèÊúçÂä°Âô®‚ÄúÊ≠ªÊéâ‰∫Ü‚Äù„ÄÇÂêåÊ†∑ÔºåÊàë‰ª¨‰πüÂ∞ùËØï‰ΩøÁî®SIGQUITÂëΩ‰ª§ÊùÄÊéâËøõÁ®ã‰ª•ÈáäÊîæÊâÄËøêË°ågoroutinesÂ†ÜÊ†àÔºå‰ΩÜÊòØÊî∂‰∏çÂà∞‰ªª‰ΩïÊïàÊûú„ÄÇ GDBÂíåCoredumpÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®GDBÔºàGNU DebuggerÔºâÂ∞ùËØïËøõÂÖ•Ê≠£Âú®ËøêË°åÁöÑÊúçÂä°ÂÜÖÈÉ®„ÄÇ Âú®Áîü‰∫ßÁéØÂ¢ÉËøêË°åË∞ÉËØïÂô®ÂèØËÉΩÈúÄË¶ÅÈ¢ùÂ§ñÁöÑÊùÉÈôêÔºåÊâÄ‰ª•‰∏é‰Ω†ÁöÑÂõ¢ÈòüÊèêÂâçÊ≤üÈÄöÊòØÂæàÊòéÊô∫ÁöÑ„ÄÇ Âú®ËôöÊú∫‰∏äÂÜçÂºÄÂêØ‰∏Ä‰∏™SSH‰ºöËØùÔºåÊâæÂà∞ÊúçÂä°Âô®ÁöÑËøõÁ®ãidÂπ∂‰ΩøÁî®Ë∞ÉËØïÂô®ËøûÊé•Âà∞ËØ•ËøõÁ®ãÔºö 123456789$ vagrant ssh server-test-1Welcome to Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-33-generic x86_64)¬∑¬∑¬∑vagrant@server-test-1:~$ pgrep server1628vagrant@server-test-1:~$ cd /vagrantvagrant@server-test-1:/vagrant$ sudo gdb --pid=1628 example/server/serverGNU gdb (Ubuntu 8.1-0ubuntu3) 8.1.0.20180409-git¬∑¬∑¬∑ Ë∞ÉËØïÂô®ËøûÊé•Âà∞ÊúçÂä°Âô®ËøõÁ®ã‰πãÂêéÔºåÊàë‰ª¨ÂèØ‰ª•ËøêË°åGDBÁöÑbtÂëΩ‰ª§Ôºàaka backtraceÔºâÊù•Ê£ÄÊü•ÂΩìÂâçÁ∫øÁ®ãÁöÑÂ†ÜÊ†à‰ø°ÊÅØÔºö 12345678910(gdb) bt#0 runtime.futex () at /usr/local/go/src/runtime/sys_linux_amd64.s:532#1 0x000000000042b08b in runtime.futexsleep (addr=0xa9a160 &lt;runtime.m0+320&gt;, ns=-1, val=0) at /usr/local/go/src/runtime/os_linux.go:46#2 0x000000000040c382 in runtime.notesleep (n=0xa9a160 &lt;runtime.m0+320&gt;) at /usr/local/go/src/runtime/lock_futex.go:151#3 0x0000000000433b4a in runtime.stoplockedm () at /usr/local/go/src/runtime/proc.go:2165#4 0x0000000000435279 in runtime.schedule () at /usr/local/go/src/runtime/proc.go:2565#5 0x00000000004353fe in runtime.park_m (gp=0xc000066d80) at /usr/local/go/src/runtime/proc.go:2676#6 0x000000000045ae1b in runtime.mcall () at /usr/local/go/src/runtime/asm_amd64.s:299#7 0x000000000045ad39 in runtime.rt0_go () at /usr/local/go/src/runtime/asm_amd64.s:201#8 0x0000000000000000 in ?? () ËØ¥ÂÆûËØùÊàëÂπ∂‰∏çÊòØGDBÁöÑ‰∏ìÂÆ∂Ôºå‰ΩÜÊòØÊòæËÄåÊòìËßÅGoËøêË°åÊó∂‰ºº‰πé‰ΩøÁ∫øÁ®ãËøõÂÖ•Áù°Áú†Áä∂ÊÄÅ‰∫ÜÔºå‰∏∫‰ªÄ‰πàÂë¢Ôºü Ë∞ÉËØï‰∏Ä‰∏™Ê≠£Âú®ËøêË°åÁöÑËøõÁ®ãÊòØ‰∏çÊòéÊô∫ÁöÑÔºå‰∏çÂ¶ÇÂ∞ÜËØ•Á∫øÁ®ãÁöÑcoredump‰øùÂ≠ò‰∏ãÊù•ÔºåËøõË°åÁ¶ªÁ∫øÂàÜÊûê„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®GDBÁöÑgcoreÂëΩ‰ª§ÔºåËØ•ÂëΩ‰ª§Â∞ÜcoreÊñá‰ª∂‰øùÂ≠òÂú®ÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩïÂπ∂ÂëΩÂêç‰∏∫core.&lt;process_id&gt;„ÄÇ 123456789(gdb) gcoreSaved corefile core.1628(gdb) quitA debugging session is active. Inferior 1 [process 1628] will be detached.Quit anyway? (y or n) yDetaching from program: /vagrant/example/server/server, process 1628 coreÊñá‰ª∂‰øùÂ≠òÂêéÔºåÊúçÂä°Âô®Ê≤°ÂøÖË¶ÅÁªßÁª≠ËøêË°åÔºå‰ΩøÁî®kill -9ÁªìÊùüÂÆÉ„ÄÇ Êàë‰ª¨ËÉΩÂ§üÊ≥®ÊÑèÂà∞ÔºåÂç≥‰ΩøÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊúçÂä°Âô®ÔºåcoreÊñá‰ª∂‰æùÁÑ∂‰ºöÂæàÂ§ßÔºàÊàëËøô‰∏Ä‰ªΩÊòØ1.2GÔºâ,ÂØπ‰∫éÁîü‰∫ßÁöÑÊúçÂä°Êù•ËØ¥ÔºåÂèØËÉΩ‰ºöÊõ¥Âä†Â∑®Â§ß„ÄÇ Â¶ÇÊûúÈúÄË¶Å‰∫ÜËß£Êõ¥Â§ö‰ΩøÁî®GDBË∞ÉËØïÁöÑÊäÄÂ∑ßÔºåÂèØ‰ª•ÁªßÁª≠ÈòÖËØª‰ΩøÁî®GDBË∞ÉËØïGo‰ª£Á†Å„ÄÇ ‰ΩøÁî®DelveË∞ÉËØïÂô®DelveÊòØ‰∏Ä‰∏™ÈíàÂØπGoÁ®ãÂ∫èÁöÑË∞ÉËØïÂô®„ÄÇÂÆÉÁ±ª‰ºº‰∫éGDBÔºå‰ΩÜÊòØÊõ¥ÂÖ≥Ê≥®GoÁöÑËøêË°åÊó∂„ÄÅÊï∞ÊçÆÁªìÊûÑ‰ª•ÂèäÂÖ∂‰ªñÂÜÖÈÉ®ÁöÑÊú∫Âà∂„ÄÇ Â¶ÇÊûú‰Ω†ÂØπDelveÁöÑÂÜÖÈÉ®ÂÆûÁé∞Êú∫Âà∂ÂæàÊÑüÂÖ¥Ë∂£ÔºåÈÇ£‰πàÊàëÂçÅÂàÜÊé®Ëçê‰Ω†ÈòÖËØªAlessandro ArzilliÂú®GopherCon EU 2018ÊâÄ‰ΩúÁöÑÊºîËÆ≤Ôºå[Internal Architecture of Delve, a Debugger For Go]„ÄÇ DelveÊòØÁî®GoÂÜôÁöÑÔºåÊâÄ‰ª•ÂÆâË£ÖËµ∑Êù•ÈùûÂ∏∏ÁÆÄÂçïÔºö 1$ go get -u github.com/derekparker/delve/cmd/dlv DelveÂÆâË£Ö‰ª•ÂêéÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáËøêË°ådlv core &lt;path to service binary&gt; &lt;core file&gt;Êù•ÂàÜÊûêcoreÊñá‰ª∂„ÄÇÊàë‰ª¨ÂÖàÂàóÂá∫ÊâßË°åcoredumpÊó∂Ê≠£Âú®ËøêË°åÁöÑÊâÄÊúâgoroutines„ÄÇDelveÁöÑgoroutinesÂëΩ‰ª§Â¶Ç‰∏ãÔºö 1234567$ dlv core example/server/server core.1628(dlv) goroutines ¬∑¬∑¬∑ Goroutine 4611 - User: /vagrant/example/server/metrics.go:113 main.(*Metrics).CountS (0x703948) Goroutine 4612 - User: /vagrant/example/server/metrics.go:113 main.(*Metrics).CountS (0x703948) Goroutine 4613 - User: /vagrant/example/server/metrics.go:113 main.(*Metrics).CountS (0x703948) ‰∏çÂπ∏ÁöÑÊòØÔºåÂú®ÁúüÂÆûÁîü‰∫ßÁéØÂ¢É‰∏ãÔºåËøô‰∏™ÂàóË°®ÂèØËÉΩ‰ºöÂæàÈïøÔºåÁîöËá≥‰ºöË∂ÖÂá∫terminalÁöÑÁºìÂÜ≤Âå∫„ÄÇÁî±‰∫éÊúçÂä°Âô®‰∏∫ÊØè‰∏Ä‰∏™ËØ∑Ê±ÇÈÉΩÁîüÊàê‰∏Ä‰∏™ÂØπÂ∫îÁöÑgoroutineÔºåÊâÄ‰ª•goroutinesÂëΩ‰ª§ÁîüÊàêÁöÑÂàóË°®ÂèØËÉΩ‰ºöÊúâÁôæ‰∏áÊù°„ÄÇÊàë‰ª¨ÂÅáËÆæÁé∞Âú®Â∑≤ÁªèÈÅáÂà∞Ëøô‰∏™ÈóÆÈ¢òÔºåÂπ∂ÊÉ≥‰∏Ä‰∏™ÊñπÊ≥ïÊù•Ëß£ÂÜ≥ÂÆÉ„ÄÇ DelveÊîØÊåÅ‚Äùheadless‚ÄùÊ®°ÂºèÔºåÂπ∂‰∏îËÉΩÂ§üÈÄöËøáJSON-RPC API‰∏éË∞ÉËØïÂô®‰∫§‰∫í„ÄÇ ËøêË°ådlv coreÂëΩ‰ª§ÔºåÊåáÂÆöÊÉ≥Ë¶ÅÂêØÂä®ÁöÑDelve API serverÔºö 123$ dlv core example/server/server core.1628 --listen :44441 --headless --logAPI server listening at: [::]:44441INFO[0000] opening core file core.1628 (executable example/server/server) layer=debugger Ë∞ÉËØïÊúçÂä°Âô®ËøêË°åÂêéÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÈÄÅÂëΩ‰ª§Âà∞ÂÖ∂TCPÁ´ØÂè£Âπ∂Â∞ÜËøîÂõûÁªìÊûú‰ª•ÂéüÁîüJSONÁöÑÊ†ºÂºèÂ≠òÂÇ®„ÄÇÊàë‰ª¨‰ª•‰∏äÈù¢Áõ∏ÂêåÁöÑÊñπÂºèÂæóÂà∞Ê≠£Âú®ËøêË°åÁöÑgoroutinesÔºå‰∏çÂêåÁöÑÊòØÊàë‰ª¨Â∞ÜÁªìÊûúÂ≠òÂÇ®Âà∞Êñá‰ª∂‰∏≠Ôºö 1$ echo -n '&#123;"method":"RPCServer.ListGoroutines","params":[],"id":2&#125;' | nc -w 1 localhost 44441 &gt; server-test-1_dlv-rpc-list_goroutines.json Áé∞Âú®Êàë‰ª¨Êã•Êúâ‰∫Ü‰∏Ä‰∏™ÔºàÊØîËæÉÂ§ßÁöÑÔºâJSONÊñá‰ª∂ÔºåÈáåÈù¢Â≠òÂÇ®Â§ßÈáèÂéüÂßã‰ø°ÊÅØ„ÄÇÊé®Ëçê‰ΩøÁî®jqÂëΩ‰ª§Ëøõ‰∏ÄÊ≠•‰∫ÜËß£JSONÊï∞ÊçÆÁöÑÂéüË≤åÔºå‰∏æ‰æãÔºöËøôÈáåÊàëËé∑ÂèñJSONÊï∞ÊçÆÁöÑresultÂ≠óÊÆµÁöÑÂâç‰∏â‰∏™ÂØπË±°Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657$ jq '.result[0:3]' server-test-1_dlv-rpc-list_goroutines.json[ &#123; "id": 1, "currentLoc": &#123; "pc": 4380603, "file": "/usr/local/go/src/runtime/proc.go", "line": 303, "function": &#123; "name": "runtime.gopark", "value": 4380368, "type": 0, "goType": 0, "optimized": true &#125; &#125;, "userCurrentLoc": &#123; "pc": 6438159, "file": "/vagrant/example/server/main.go", "line": 52, "function": &#123; "name": "main.run", "value": 6437408, "type": 0, "goType": 0, "optimized": true &#125; &#125;, "goStatementLoc": &#123; "pc": 4547433, "file": "/usr/local/go/src/runtime/asm_amd64.s", "line": 201, "function": &#123; "name": "runtime.rt0_go", "value": 4547136, "type": 0, "goType": 0, "optimized": true &#125; &#125;, "startLoc": &#123; "pc": 4379072, "file": "/usr/local/go/src/runtime/proc.go", "line": 110, "function": &#123; "name": "runtime.main", "value": 4379072, "type": 0, "goType": 0, "optimized": true &#125; &#125;, "threadID": 0, "unreadable": "" &#125;, ¬∑¬∑¬∑] JSONÊï∞ÊçÆ‰∏≠ÁöÑÊØè‰∏™ÂØπË±°ÈÉΩ‰ª£Ë°®‰∫Ü‰∏Ä‰∏™goroutine„ÄÇÈÄöËøáÂëΩ‰ª§ÊâãÂÜå ÂèØÁü•ÔºågoroutinesÂëΩ‰ª§ÂèØ‰ª•Ëé∑ÂæóÊØè‰∏Ä‰∏™goroutinesÁöÑ‰ø°ÊÅØ„ÄÇÈÄöËøáÊâãÂÜåÊàë‰ª¨ËÉΩÂ§üÂàÜÊûêÂá∫userCurrentLocÂ≠óÊÆµÊòØÊúçÂä°Âô®Ê∫êÁ†Å‰∏≠goroutinesÊúÄÂêéÂá∫Áé∞ÁöÑÂú∞Êñπ„ÄÇ ‰∏∫‰∫ÜËÉΩÂ§ü‰∫ÜËß£ÂΩìcore fileÂàõÂª∫ÁöÑÊó∂ÂÄôÔºågoroutinesÊ≠£Âú®ÂÅö‰ªÄ‰πàÔºåÊàë‰ª¨ÈúÄË¶ÅÊî∂ÈõÜJSONÊñá‰ª∂‰∏≠ÂåÖÂê´userCurrentLocÂ≠óÊÆµÁöÑÂáΩÊï∞ÂêçÂ≠ó‰ª•ÂèäÂÖ∂Ë°åÂè∑Ôºö 123456789$ jq -c '.result[] | [.userCurrentLoc.function.name, .userCurrentLoc.line]' server-test-1_dlv-rpc-list_goroutines.json | sort | uniq -c 1 ["internal/poll.runtime_pollWait",173]1000 ["main.(*Metrics).CountS",95] 1 ["main.(*Metrics).SetM",105] 1 ["main.(*Metrics).startOutChannelConsumer",179] 1 ["main.run",52] 1 ["os/signal.signal_recv",139] 6 ["runtime.gopark",303] Â§ßÈáèÁöÑgoroutines(‰∏äÈù¢ÊòØ1000‰∏™)Âú®ÂáΩÊï∞main.(*Metrics).CoutSÁöÑ95Ë°åË¢´ÈòªÂ°û„ÄÇÁé∞Âú®Êàë‰ª¨ÂõûÂ§¥Áúã‰∏Ä‰∏ãÊàë‰ª¨ÊúçÂä°Âô®ÁöÑÊ∫êÁ†Å„ÄÇ Âú®mainÂåÖ‰∏≠ÊâæÂà∞MetricsÁªìÊûÑ‰ΩìÂπ∂‰∏îÊâæÂà∞ÂÆÉÁöÑCountSÊñπÊ≥ïÔºàexample/server/metrics.goÔºâ„ÄÇ 1234// CountS increments counter per second.func (m *Metrics) CountS(key string) &#123; m.inChannel &lt;- NewCountMetric(key, 1, second)&#125; Êàë‰ª¨ÁöÑÊúçÂä°Âô®Âú®ÂæÄinChannelÈÄöÈÅìÂèëÈÄÅÁöÑÊó∂ÂÄôÈòªÂ°û‰Ωè‰∫Ü„ÄÇËÆ©Êàë‰ª¨ÊâæÂá∫Ë∞ÅË¥üË¥£‰ªéËøô‰∏™ÈÄöÈÅìËØªÂèñÊï∞ÊçÆÔºåÊ∑±ÂÖ•Á†îÁ©∂‰ª£Á†Å‰πãÂêéÊàë‰ª¨ÊâæÂà∞‰∫Ü‰∏ãÈù¢ÁöÑÂáΩÊï∞Ôºö 123456// starts a consumer for inChannelfunc (m *Metrics) startInChannelConsumer() &#123; for inMetrics := range m.inChannel &#123; // ¬∑¬∑¬∑ &#125;&#125; Ëøô‰∏™ÂáΩÊï∞ÈÄê‰∏™Âú∞‰ªéÈÄöÈÅì‰∏≠ËØªÂèñÊï∞ÊçÆÂπ∂Âä†‰ª•Â§ÑÁêÜÔºåÈÇ£‰πà‰ªÄ‰πàÊÉÖÂÜµ‰∏ãÂèëÈÄÅÂà∞Ëøô‰∏™ÈÄöÈÅìÁöÑ‰ªªÂä°‰ºöË¢´ÈòªÂ°ûÂë¢Ôºü ÂΩìÂ§ÑÁêÜÈÄöÈÅìÁöÑÊó∂ÂÄôÔºåÊ†πÊçÆDave CheneyÁöÑÈÄöÈÅìÂáÜÂàôÔºåÂè™ÊúâÂõõÁßçÊÉÖÂÜµÂèØËÉΩÂØºËá¥ÈÄöÈÅìÊúâÈóÆÈ¢òÔºö Âêë‰∏Ä‰∏™nilÈÄöÈÅìÂèëÈÄÅ ‰ªé‰∏Ä‰∏™nilÈÄöÈÅìÊé•Êî∂ Âêë‰∏Ä‰∏™Â∑≤ÂÖ≥Èó≠ÁöÑÈÄöÈÅìÂèëÈÄÅ ‰ªé‰∏Ä‰∏™Â∑≤ÂÖ≥Èó≠ÁöÑÈÄöÈÅìÊé•Êî∂Âπ∂Á´ãÂç≥ËøîÂõûÈõ∂ÂÄº Á¨¨‰∏ÄÁúºÂ∞±ÁúãÂà∞‰∫Ü‚ÄúÂêë‰∏Ä‰∏™nilÈÄöÈÅìÂèëÈÄÅ‚ÄùÔºåËøôÁúãËµ∑Êù•ÂÉèÊòØÈóÆÈ¢òÁöÑÂéüÂõ†„ÄÇ‰ΩÜÊòØÂèçÂ§çÊ£ÄÊü•‰ª£Á†ÅÂêéÔºåinChannelÊòØÁî±MetricsÂàùÂßãÂåñÁöÑÔºå‰∏çÂèØËÉΩ‰∏∫nil„ÄÇ n‰Ω†ÂèØËÉΩ‰ºöÊ≥®ÊÑèÂà∞Ôºå‰ΩøÁî®jqÂëΩ‰ª§Ëé∑ÂèñÂà∞ÁöÑ‰ø°ÊÅØ‰∏≠ÔºåÊ≤°ÊúâstartInChannelConsumerÊñπÊ≥ï„ÄÇ‰ºö‰∏ç‰ºöÊòØÂõ†‰∏∫Âú®main.(*Metrics).startInChannelConsumerÁöÑÊüê‰∏™Âú∞ÊñπÈòªÂ°ûËÄåÂØºËá¥Ëøô‰∏™ÔºàÂèØÁºìÂÜ≤ÔºâÈÄöÈÅìÊª°‰∫ÜÔºü DelveËÉΩÂ§üÊèê‰æõ‰ªéÂºÄÂßã‰ΩçÁΩÆÂà∞userCurrentLocÂ≠óÊÆµ‰πãÈó¥ÁöÑÂàùÂßã‰ΩçÁΩÆ‰ø°ÊÅØÔºåËøô‰∏™‰ø°ÊÅØÂ≠òÂÇ®Âà∞startLocÂ≠óÊÆµ‰∏≠„ÄÇ‰ΩøÁî®‰∏ãÈù¢ÁöÑjqÂëΩ‰ª§ÂèØ‰ª•Êü•ËØ¢Âá∫ÊâÄÊúâgoroutines,ÂÖ∂ÂàùÂßã‰ΩçÁΩÆÈÉΩÂú®ÂáΩÊï∞startInChannelConsumer‰∏≠Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142$ jq '.result[] | select(.startLoc.function.name | test("startInChannelConsumer$"))' server-test-1_dlv-rpc-list_goroutines.json&#123; "id": 20, "currentLoc": &#123; "pc": 4380603, "file": "/usr/local/go/src/runtime/proc.go", "line": 303, "function": &#123; "name": "runtime.gopark", "value": 4380368, "type": 0, "goType": 0, "optimized": true &#125; &#125;, "userCurrentLoc": &#123; "pc": 6440847, "file": "/vagrant/example/server/metrics.go", "line": 105, "function": &#123; "name": "main.(*Metrics).SetM", "value": 6440672, "type": 0, "goType": 0, "optimized": true &#125; &#125;, "startLoc": &#123; "pc": 6440880, "file": "/vagrant/example/server/metrics.go", "line": 109, "function": &#123; "name": "main.(*Metrics).startInChannelConsumer", "value": 6440880, "type": 0, "goType": 0, "optimized": true &#125; &#125;, ¬∑¬∑¬∑&#125; ÁªìÊûú‰∏≠Êúâ‰∏ÄÊù°‰ø°ÊÅØÈùûÂ∏∏ÊåØÂ•ã‰∫∫ÂøÉÔºÅ Âú®main.(*Metrics).startInChannelConsumerÔºå109Ë°åÔºàÁúãÁªìÊûú‰∏≠ÁöÑstartLocÂ≠óÊÆµÔºâÔºåÊúâ‰∏Ä‰∏™id‰∏∫20ÁöÑgoroutinesÈòªÂ°û‰Ωè‰∫ÜÔºÅ ÊãøÂà∞goroutinesÁöÑidËÉΩÂ§üÂ§ßÂ§ßÈôç‰ΩéÊàë‰ª¨ÊêúÁ¥¢ÁöÑËåÉÂõ¥ÔºàÂπ∂‰∏îÊàë‰ª¨ÂÜç‰πü‰∏çÁî®Ê∑±ÂÖ•Â∫ûÂ§ßÁöÑJSONÊñá‰ª∂‰∫ÜÔºâ„ÄÇ‰ΩøÁî®DelveÁöÑgoroutinesÂëΩ‰ª§Êàë‰ª¨ËÉΩÂ§üÂ∞ÜÂΩìÂâçgoroutinesÂàáÊç¢Âà∞ÁõÆÊ†ágoroutinesÔºåÁÑ∂ÂêéÂèØ‰ª•‰ΩøÁî®stackÂëΩ‰ª§ÊâìÂç∞ËØ•goroutinesÁöÑÂ†ÜÊ†à‰ø°ÊÅØÔºö 123456789101112131415161718192021222324252627282930313233$ dlv core example/server/server core.1628(dlv) goroutine 20Switched from 0 to 20 (thread 1628)(dlv) stack -full0 0x000000000042d7bb in runtime.gopark at /usr/local/go/src/runtime/proc.go:303 lock = unsafe.Pointer(0xc000104058) reason = waitReasonChanSend¬∑¬∑¬∑3 0x00000000004066a5 in runtime.chansend1 at /usr/local/go/src/runtime/chan.go:125 c = (unreadable empty OP stack) elem = (unreadable empty OP stack)4 0x000000000062478f in main.(*Metrics).SetM at /vagrant/example/server/metrics.go:105 key = (unreadable empty OP stack) m = (unreadable empty OP stack) value = (unreadable empty OP stack)5 0x0000000000624e64 in main.(*Metrics).sendMetricsToOutChannel at /vagrant/example/server/metrics.go:146 m = (*main.Metrics)(0xc000056040) scope = 0 updateInterval = (unreadable could not find loclist entry at 0x89f76 for address 0x624e63)6 0x0000000000624a2f in main.(*Metrics).startInChannelConsumer at /vagrant/example/server/metrics.go:127 m = (*main.Metrics)(0xc000056040) inMetrics = main.Metric &#123;Type: TypeCount, Scope: 0, Key: "server.req-incoming",...+2 more&#125; nextUpdate = (unreadable could not find loclist entry at 0x89e86 for address 0x624a2e) ‰ªé‰∏ãÂæÄ‰∏äÂàÜÊûêÔºö Ôºà6Ôºâ‰∏Ä‰∏™Êù•Ëá™ÈÄöÈÅìÁöÑÊñ∞inMetricsÂÄºÂú®main.(*Metrics).startInChannelConsumer‰∏≠Ë¢´Êé•Êî∂ Ôºà5ÔºâÊàë‰ª¨Ë∞ÉÁî®main.(*Metrics).sendMetricsToOutChannelÂπ∂‰∏îÂú®example/server/metrics.goÁöÑ146Ë°åËøõË°åÂ§ÑÁêÜ Ôºà4ÔºâÁÑ∂Âêémain.(*Metrics).SetMË¢´Ë∞ÉÁî® ‰∏ÄÁõ¥ËøêË°åÂà∞runtime.gopark‰∏≠ÁöÑwaitReasonChanSendÈòªÂ°ûÔºÅ ‰∏ÄÂàáÁöÑ‰∏ÄÂàáÈÉΩÊòéÊúó‰∫ÜÔºÅ Âçï‰∏™goroutines‰∏≠Ôºå‰∏Ä‰∏™‰ªéÁºìÂÜ≤ÈÄöÈÅìËØªÂèñÊï∞ÊçÆÁöÑÂáΩÊï∞ÔºåÂêåÊó∂‰πüÂú®ÂæÄÈÄöÈÅì‰∏≠ÂèëÈÄÅÊï∞ÊçÆ„ÄÇÂΩìËøõÂÖ•ÈÄöÈÅìÁöÑÂÄºËææÂà∞ÈÄöÈÅìÁöÑÂÆπÈáèÊó∂ÔºåÊ∂àË¥πÂáΩÊï∞ÁªßÁª≠ÂæÄÂ∑≤Êª°ÁöÑÈÄöÈÅì‰∏≠ÂèëÈÄÅÊï∞ÊçÆÂ∞±‰ºöÈÄ†ÊàêËá™Ë∫´ÁöÑÊ≠ªÈîÅ„ÄÇÁî±‰∫éÂçï‰∏™ÈÄöÈÅìÁöÑÊ∂àË¥πËÄÖÊ≠ªÈîÅÔºåÈÇ£‰πàÊØè‰∏Ä‰∏™Â∞ùËØïÂæÄÈÄöÈÅì‰∏≠ÂèëÈÄÅÊï∞ÊçÆÁöÑËØ∑Ê±ÇÈÉΩ‰ºöË¢´ÈòªÂ°û„ÄÇ ËøôÂ∞±ÊòØÊàë‰ª¨ÁöÑÊïÖ‰∫ãÔºå‰ΩøÁî®‰∏äËø∞Ë∞ÉËØïÊäÄÊúØÂ∏ÆÂä©Êàë‰ª¨ÂèëÁé∞‰∫ÜÈóÆÈ¢òÁöÑÊ†πÊ∫ê„ÄÇÈÇ£‰∫õ‰ª£Á†ÅÊòØÂæàÂ§öÂπ¥ÂâçÂÜôÁöÑÔºåÁîöËá≥‰ªéÊ≤°Êúâ‰∫∫ÁúãËøáËøô‰∫õ‰ª£Á†ÅÔºå‰πü‰∏á‰∏áÊ≤°ÊúâÊÉ≥Âà∞‰ºöÂØºËá¥Ëøô‰πàÂ§ßÁöÑÈóÆÈ¢ò„ÄÇ Â¶Ç‰Ω†ÊâÄËßÅÔºåÂπ∂‰∏çÊòØÊâÄÊúâÈóÆÈ¢òÈÉΩËÉΩÁî±Â∑•ÂÖ∑Ëß£ÂÜ≥Ôºå‰ΩÜÊòØÂ∑•ÂÖ∑ËÉΩÂ§üÂ∏ÆÂä©‰Ω†Êõ¥Â•ΩÂú∞Â∑•‰Ωú„ÄÇÊàëÂ∏åÊúõÔºåÈÄöËøáÊ≠§ÊñáËÉΩÂ§üÊøÄÂä±‰Ω†Â§öÂ§öÂ∞ùËØïËøô‰∫õÂ∑•ÂÖ∑„ÄÇÊàëÈùûÂ∏∏‰πêÊÑèÂÄæÂê¨‰Ω†‰ª¨Â§ÑÁêÜÁ±ª‰ººÈóÆÈ¢òÁöÑÂÖ∂ÂÆÉËß£ÂÜ≥ÊñπÊ°à„ÄÇ VladimirÊòØ‰∏Ä‰∏™ÂêéÁ´ØÂºÄÂèëÂ∑•Á®ãÂ∏àÔºåÁõÆÂâçÂ∞±ËÅå‰∫éadjust.com. @tvii on Twitter, @narqo on Github via: https://blog.gopheracademy.com/advent-2018/postmortem-debugging-delve/ ‰ΩúËÄÖÔºöVladimir VarankinËØëËÄÖÔºöhantmac]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ëá™Âä®ÂåñËÑöÊú¨ÂÆûÁé∞goÂÆâË£Ö‰∏éÂçáÁ∫ß]]></title>
    <url>%2F2019%2F01%2F12%2F%E8%87%AA%E5%8A%A8%E5%8C%96%E8%84%9A%E6%9C%AC%E5%AE%9E%E7%8E%B0go%E5%AE%89%E8%A3%85%E4%B8%8E%E5%8D%87%E7%BA%A7%2F</url>
    <content type="text"><![CDATA[Ê∫êÁ†ÅÂÆâË£ÖÔºö ‰∏ãËΩΩÂØπÂ∫îÁöÑÊìç‰ΩúÁ≥ªÁªüÁöÑÊúÄÊñ∞ÁöÑ Golang ÁâàÊú¨Ôºöhttps://golang.org/dl/ Âú® home ÁõÆÂΩï‰∏ãÂª∫Á´ã installGoÁõÆÂΩïÔºåÁÑ∂ÂêéÂú®ËØ•ÁõÆÂΩï‰∏ãÊñ∞Âª∫ÂçáÁ∫ß‰∏éÈÉ®ÁΩ≤Êñá‰ª∂‰ª•Âèä‰∏ãËΩΩÊúÄÊñ∞ÁöÑ golang Ê∫êÁ†ÅÂåÖÔºö ‰ª•‰∏ãÊòØ installOrUpdate.sh ÂÖ∑‰ΩìÂÜÖÂÆπÔºö 1234567891011121314151617# !/bin/bashif [ -z "$1" ]; then‚Äã echo "usage: ./install.sh go-package.tar.gz"‚Äã exitfiif [ -d "/usr/local/go" ]; then‚Äã echo "Uninstalling old go version..."‚Äã sudo rm -rf /usr/local/gofiecho "Installing..."sudo tar -C /usr/local -xzf $1echo export GOPATH=/go" &gt;&gt; /etc/profileecho export GOROOT=/usr/local/go &gt;&gt; /etc/profileecho export PATH=$PATH:$GOROOT/bin:$GOPATH/bin1 &gt;&gt; /etc/profilesource /etc/profilerm -rf $1echo "Done" ÁÑ∂ÂêéËøêË°åÔºö sudo sh install.sh go1.10.linux-amd64.tar.gz ÊàñËÄÖÊâãÂä®ËÆæÁΩÆÂ•ΩGOPATHÔºåGOROOT ÁºñËæë /etc/profile Âú®Êñá‰ª∂Â∞æÈÉ®Âä†ÂÖ•Ôºö 12345export GOPATH=/goexport GOROOT=/usr/local/goexport PATH=$PATH:$GOROOT/bin:$GOPATH/bin1ËøêË°å source /etc/profile ËÆ©ÁéØÂ¢ÉÂèòÈáèÁîüÊïà Ëá≥Ê≠§ÔºåGo Â∑≤ÂÆâË£ÖÊàêÂäü ÂçáÁ∫ß Â¶ÇÊûúÈúÄË¶ÅÂçáÁ∫ßÁöÑËØùÂè™ÈúÄË¶ÅÂ∞ÜÊúÄÊñ∞ÁöÑÊ∫êÁ†ÅÂåÖ‰∏ãËΩΩÂà∞Á¨¨‰∏ÄÊ≠•ÁöÑ installGo Êñá‰ª∂Â§π‰∏ãÔºåÁÑ∂ÂêéËøêË°åsudo sh install.sh go1.xx.linux-amd64.tar.gz Âç≥ÂèØ„ÄÇ shellËÑöÊú¨Êõ¥Êñ∞Âú∞ÂùÄgithub]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[beegoÊ≥®Ëß£Ë∑ØÁî±‰∏≠@ParamÁöÑÂèÇÊï∞Ëß£Èáä]]></title>
    <url>%2F2019%2F01%2F03%2Fbeego%E6%B3%A8%E8%A7%A3%E8%B7%AF%E7%94%B1%E4%B8%AD-Param%E7%9A%84%E5%8F%82%E6%95%B0%E8%A7%A3%E9%87%8A%2F</url>
    <content type="text"><![CDATA[beegoÊ≥®Ëß£Ë∑ØÁî±ÁöÑÊ≥®ÈáäÔºåÊàë‰ª¨ÂèØ‰ª•ÊääÊàë‰ª¨ÁöÑÊ≥®ÈáäÂàÜ‰∏∫‰ª•‰∏ãÁ±ªÂà´Ôºö @Title Êé•Âè£ÁöÑÊ†áÈ¢òÔºåÁî®Êù•Ê†áÁ§∫ÂîØ‰∏ÄÊÄßÔºåÂîØ‰∏ÄÔºåÂèØÈÄâ Ê†ºÂºèÔºö‰πãÂêéË∑ü‰∏Ä‰∏™ÊèèËø∞Â≠óÁ¨¶‰∏≤ @Description Êé•Âè£ÁöÑ‰ΩúÁî®ÔºåÁî®Êù•ÊèèËø∞Êé•Âè£ÁöÑÁî®ÈÄîÔºåÂîØ‰∏ÄÔºåÂèØÈÄâ Ê†ºÂºèÔºö‰πãÂêéË∑ü‰∏Ä‰∏™ÊèèËø∞Â≠óÁ¨¶‰∏≤ @Param ËØ∑Ê±ÇÁöÑÂèÇÊï∞ÔºåÁî®Êù•ÊèèËø∞Êé•ÂèóÁöÑÂèÇÊï∞ÔºåÂ§ö‰∏™ÔºåÂèØÈÄâ Ê†ºÂºèÔºöÂèòÈáèÂêç ‰º†ËæìÁ±ªÂûã Á±ªÂûã ÊòØÂê¶ÂøÖÈ°ª ÊèèËø∞ ‰º†ËæìÁ±ªÂûãÔºöpaht or body Á±ªÂûãÔºö ÂèòÈáèÂêçÂíåÊèèËø∞ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ ÊòØÂê¶ÂøÖÈ°ªÔºötrue ÊàñËÄÖfalse string int int64 ÂØπË±°ÔºåËøô‰∏™Âú∞ÊñπÂ§ßÂÆ∂ÂÜôÁöÑÊó∂ÂÄôÈúÄË¶ÅÊ≥®ÊÑèÔºåÈúÄË¶ÅÊòØÁõ∏ÂØπ‰∫éÂΩìÂâçÈ°πÁõÆÁöÑË∑ØÂæÑ.ÂØπË±°Ôºå‰æãÂ¶Çmodels.ObjectË°®Á§∫modelsÁõÆÂΩï‰∏ãÁöÑObjectÂØπË±°ÔºåËøôÊ†∑beeÂú®ÁîüÊàêÊñáÊ°£ÁöÑÊó∂ÂÄô‰ºöÂéªÊâ´ÊèèÊîπÂØπË±°Âπ∂ÊòæÁ§∫ÁªôÁî®Êà∑ÊîπÂØπË±°„ÄÇ query Ë°®Á§∫Â∏¶Âú®url‰∏≤ÈáåÈù¢?aa=bb&amp;cc=dd form Ë°®Á§∫‰ΩøÁî®Ë°®ÂçïÈÄí‰∫§Êï∞ÊçÆ path Ë°®Á§∫URL‰∏≤‰∏≠ÂæóÂ≠óÁ¨¶Ôºå‰æãÂ¶Ç/user/{uid} ÈÇ£‰πàuidÂ∞±ÊòØ‰∏Ä‰∏™pathÁ±ªÂûãÁöÑÂèÇÊï∞ body Ë°®Á§∫‰ΩøÁî®raw bodyËøõË°åÊï∞ÊçÆÁöÑ‰º†Ëæì header Ë°®Á§∫ÈÄöËøáheaderËøõË°åÊï∞ÊçÆÁöÑ‰º†Ëæì @Success ÊàêÂäüËøîÂõûÁöÑcodeÂíåÂØπË±°ÊàñËÄÖ‰ø°ÊÅØ Ê†ºÂºèÔºöcode ÂØπË±°Á±ªÂûã ‰ø°ÊÅØÊàñËÄÖÂØπË±°Ë∑ØÂæÑ codeÔºöË°®Á§∫HTTPÁöÑÊ†áÂáÜstatus codeÔºå200 201Á≠â ÂØπË±°Á±ªÂûãÔºö{object}Ë°®Á§∫ÂØπË±°ÔºåÂÖ∂‰ªñÈªòËÆ§ÈÉΩËÆ§‰∏∫ÊòØÂ≠óÁ¨¶Á±ªÂûãÔºå‰ºöÊòæÁ§∫Á¨¨‰∏â‰∏™ÂèÇÊï∞ÁªôÁî®Êà∑ÔºåÂ¶ÇÊûúÊòØ{object}Á±ªÂûãÔºåÈÇ£‰πàÂ∞±‰ºöÂéªÊâ´ÊèèÊîπÂØπË±°ÔºåÂπ∂ÊòæÁ§∫ÁªôÁî®Êà∑ ÂØπË±°Ë∑ØÂæÑÂíå‰∏äÈù¢Param‰∏≠ÂæóÂØπË±°Á±ªÂûã‰∏ÄÊ†∑Ôºå‰ΩøÁî®Ë∑ØÂæÑ.ÂØπË±°ÁöÑÊñπÂºèÊù•ÊèèËø∞ @Failure ÈîôËØØËøîÂõûÁöÑ‰ø°ÊÅØÔºå Ê†ºÂºèÔºö code ‰ø°ÊÅØ code:Âêå‰∏äSuccess ÈîôËØØ‰ø°ÊÅØÔºöÂ≠óÁ¨¶‰∏≤ÊèèËø∞‰ø°ÊÅØ @router ‰∏äÈù¢Â∑≤ÁªèÊèèËø∞ËøáÊîØÊåÅ‰∏§‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÊòØË∑ØÁî±ÔºåÁ¨¨‰∫å‰∏™Ë°®Á§∫ÊîØÊåÅÁöÑHTTPÊñπÊ≥ï]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>beego</tag>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golang use reflect to judge type of variable]]></title>
    <url>%2F2018%2F12%2F25%2Fgolang-use-reflect-to-judge-type-of-variable%2F</url>
    <content type="text"><![CDATA[‰ºóÊâÄÂë®Áü•Ôºågolang‰∏≠ÂèØ‰ª•‰ΩøÁî®Á©∫Êé•Âè£Âç≥interface{}‰ª£Ë°®‰ªª‰ΩïÁ±ªÂûãÁöÑÊï∞ÊçÆÔºåÈÇ£‰πàÂú®‰ΩøÁî®ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÊúâÊó∂ÈúÄË¶ÅËé∑ÂèñËøîÂõûÂÄºÁöÑÂÖ∑‰ΩìÁ±ªÂûã Âú∫ÊôØÔºöbeegoÊ°ÜÊû∂‰∏≠ÁöÑorm.ParamsÁ±ªÂûãÔºåÂÆûÈôÖ‰∏äÊòØmap[string]interface{},Âú®‰ΩøÁî®valuesÊé•Âè£ÁöÑÊó∂ÂÄôÔºåÈúÄË¶Å‰ªéËøîÂõûMap‰∏≠Ëé∑ÂèñÊï∞ÊçÆÔºåÈúÄË¶ÅËøôÊ†∑Ëé∑ÂèñÔºöId:m[&quot;Id&quot;].(string),ËøôÊó∂m[‚ÄúId‚Äù]ÂÆûÈôÖ‰∏äÊòØStringÁ±ªÂûãÔºåÊàë‰ª¨ÂèØ‰ª•Áî®reflectÊ®°ÂùóÊù•Ëé∑ÂèñÂÆûÈôÖÁöÑÁ±ªÂûã 12reflect.TypeOf(m["Id"])//ËøîÂõû‰∏∫String 1234567891011package mainimport ( &quot;fmt&quot; &quot;reflect&quot;)func main() &#123; var x int32 = 20 fmt.Println(&quot;type:&quot;, reflect.TypeOf(x))&#125;]]></content>
      <categories>
        <category>go</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysql add primary key auto_increment]]></title>
    <url>%2F2018%2F12%2F25%2Fmysql-add-primary-key-auto-increment%2F</url>
    <content type="text"><![CDATA[Ê∑ªÂä†Â≠óÊÆµid,Âπ∂Â∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫‰∏ªÈîÆËá™Â¢û alter table TABLE_NAME add id int not null primary key Auto_increment Â¶ÇÊûúÊÉ≥Ê∑ªÂä†Â∑≤ÁªèÊúâ‰∫Ü‰∏ÄÂàó‰∏∫‰∏ªÈîÆÔºåÂèØ‰ª•Áî®Ôºö alter table TABLE_NAME add primary key(COL_NAME); Â¶ÇÊûúÊÉ≥‰øÆÊîπ‰∏ÄÂàó‰∏∫‰∏ªÈîÆÔºåÂàôÈúÄË¶ÅÂÖàÂà†Èô§ÂéüÊù•ÁöÑ‰∏ªÈîÆÔºö alter table TABLE_NAME drop primary key; ÂÜçÈáçÊñ∞Ê∑ªÂä†‰∏ªÈîÆÔºö alter table TABLE_NAME add primary key(COL_NAME);]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GoÂÖ≥‰∫étimeÂåÖÁöÑËß£Êûê‰∏é‰ΩøÁî®]]></title>
    <url>%2F2018%2F12%2F16%2FGo%E5%85%B3%E4%BA%8Etime%E5%8C%85%E7%9A%84%E8%A7%A3%E6%9E%90%E4%B8%8E%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[GoÂÖ≥‰∫éÊó∂Èó¥‰∏éÊó•ÊúüÁöÑÂ§ÑÁêÜÂÖ≥‰∫étimeÁöÑÊï∞ÊçÆÁ±ªÂûã timeÂåÖ‰æùËµñÁöÑÊï∞ÊçÆÁ±ªÂûãÊúâÔºötime.Time,time.Month,time.WeekDay,time.Duration,time.Location. ËØ¶ÁªÜ‰ªãÁªç‰ª•‰∏äÂá†ÁßçÊï∞ÊçÆÁ±ªÂûã time.Time /usr/local/go/src/time/time.go ÂÆö‰πâÂ¶Ç‰∏ã: 12345type Time struct &#123; sec int64 // ‰ªé1Âπ¥1Êúà1Êó• 00:00:00 UTC Ëá≥‰ªäËøáÂéªÁöÑÁßíÊï∞ nsec int32 // ÊúÄËøë‰∏ÄÁßíÂà∞‰∏ã‰∏ÄÁßíËøáÂéªÁöÑÁ∫≥ÁßíÊï∞ loc *Location // Êó∂Âå∫&#125; time.Time‰ºöËøîÂõûÁ∫≥ÁßíÊó∂Èó¥Á≤æÂ∫¶ÁöÑÊó∂Èó¥ 1234var ti time.Timeti = time.Now()fmt.Printf("Êó∂Èó¥: %v, Êó∂Âå∫: %v, Êó∂Èó¥Á±ªÂûã: %T\n", t, t.Location(), t)//Êó∂Èó¥: 2018-12-15 09:06:05.816187261 +0800 CST, Êó∂Âå∫: Local, Êó∂Èó¥Á±ªÂûã: time.Time time.Month, go‰∏≠Ëá™Â∑±ÈáçÊñ∞ÂÆö‰πâ‰∫ÜmonthÁöÑÁ±ªÂûãÔºå‰∏étime.yearÂíåtime.day‰∏çÂêå„ÄÇ 12345678910111213141516type Month intconst ( January Month = 1 + iota February March April May June July August September October November December) iotaÊòØgolangËØ≠Ë®ÄÁöÑÂ∏∏ÈáèËÆ°Êï∞Âô®,Âè™ËÉΩÂú®Â∏∏ÈáèÁöÑË°®ËææÂºè‰∏≠‰ΩøÁî®„ÄÇ iotaÂú®constÂÖ≥ÈîÆÂ≠óÂá∫Áé∞Êó∂Â∞ÜË¢´ÈáçÁΩÆ‰∏∫0(constÂÜÖÈÉ®ÁöÑÁ¨¨‰∏ÄË°å‰πãÂâç)Ôºåconst‰∏≠ÊØèÊñ∞Â¢û‰∏ÄË°åÂ∏∏ÈáèÂ£∞ÊòéÂ∞Ü‰ΩøiotaËÆ°Êï∞‰∏ÄÊ¨°(iotaÂèØÁêÜËß£‰∏∫constËØ≠Âè•Âùó‰∏≠ÁöÑË°åÁ¥¢Âºï)„ÄÇ ‰ΩøÁî®iotaËÉΩÁÆÄÂåñÂÆö‰πâÔºåÂú®ÂÆö‰πâÊûö‰∏æÊó∂ÂæàÊúâÁî®„ÄÇ time.WeekDay,‰ª£Ë°®‰∏ÄÂë®‰πã‰∏≠ÁöÑÊòüÊúüÂá†ÔºàÂΩìÁÑ∂ÊòØÊåâÁÖßË•øÊñπÁöÑËßÑÂàôÔºå‰ªñ‰ª¨ÊääÂë®Êó•ÂΩìÂÅöÊòØ‰∏ÄÂë®ÁöÑÂºÄÂßãÔºâ 1234567891011type WeekDay intconst ( Sunday Weekday = iota Monday Tuesday Wednesday Thursday Friday Saturday) time.Duration,‰ª£Ë°®‰∏§‰∏™Êó∂Èó¥ÁÇπ‰πãÈó¥ÁöÑÁ∫≥ÁßíÂ∑ÆÂÄº„ÄÇ 12345678910type Duration int64const ( Nanosecond Duration = 1 Microsecond = 1000 * Nanosecond Millisecond = 1000 * Microsecond Second = 1000 * Millisecond Minute = 60 * Second Hour = 60 * Minute) time.Location,Êó∂Âå∫‰ø°ÊÅØ 123456789type Location struct &#123; name string zone []zone tx []zoneTrans cacheStart int64 cacheEnd int64 cacheZone *zone&#125;//Âåó‰∫¨Êó∂Èó¥ÔºöAsia/Shanghai ‰ª•‰∏äÁ±ªÂûãreceiverÁöÑÂÆûÁé∞ÊñπÊ≥ï time.TimeÁõ∏ÂÖ≥ÊñπÊ≥ï func Now() Time {} // ÂΩìÂâçÊú¨Âú∞Êó∂Èó¥ func Unix(sec int64, nsec int64) Time {} // Ê†πÊçÆÊó∂Èó¥Êà≥ËøîÂõûÊú¨Âú∞Êó∂Èó¥ func Date(year int, month Month, day, hour, min, sec, nsec int, loc *Location) Time {} // ËøîÂõûÊåáÂÆöÊó∂Èó¥ 1234567891011/ ÂΩìÂâçÊú¨Âú∞Êó∂Èó¥t = time.Now()fmt.Println("'time.Now': ", t)// Ê†πÊçÆÊó∂Èó¥Êà≥ËøîÂõûÊú¨Âú∞Êó∂Èó¥t_by_unix := time.Unix(1487780010, 0)fmt.Println("'time.Unix': ", t_by_unix)// ËøîÂõûÊåáÂÆöÊó∂Èó¥t_by_date := time.Date(2017, time.Month(2), 23, 1, 30, 30, 0, l)fmt.Println("'time.Date': ", t_by_date) ÊåâÁÖßÊó∂Âå∫‰ø°ÊÅØÊòæÁ§∫Êó∂Èó¥ func (t Time) UTC() Time {} // Ëé∑ÂèñÊåáÂÆöÊó∂Èó¥Âú®UTC Êó∂Âå∫ÁöÑÊó∂Èó¥Ë°®Á§∫ func (t Time) Local() Time {} // ‰ª•Êú¨Âú∞Êó∂Âå∫Ë°®Á§∫ func (t Time) In(loc *Location) Time {} // Êó∂Èó¥Âú®ÊåáÂÆöÊó∂Âå∫ÁöÑË°®Á§∫ func (t Time) Format(layout string) string {} // ÊåâÊåáÂÆöÊ†ºÂºèÊòæÁ§∫Êó∂Èó¥ 1234567891011121314// Ëé∑ÂèñÊåáÂÆöÊó∂Èó¥Âú®UTC Êó∂Âå∫ÁöÑÊó∂Èó¥Ë°®Á§∫t_by_utc := t.UTC()fmt.Println("'t.UTC': ", t_by_utc)// Ëé∑ÂèñÊú¨Âú∞Êó∂Èó¥Ë°®Á§∫t_by_local := t.Local()fmt.Println("'t.Local': ", t_by_local)// Êó∂Èó¥Âú®ÊåáÂÆöÊó∂Âå∫ÁöÑË°®Á§∫t_in := t.In(time.UTC)fmt.Println("'t.In': ", t_in)// Formatfmt.Println("t.Format", t.Format(time.RFC3339)) Ëé∑ÂèñÂπ¥ÊúàÊó•Á≠â‰ø°ÊÅØ func (t Time) Date() (year int, month Month, day int) {} // ËøîÂõûÊó∂Èó¥ÁöÑÊó•Êúü‰ø°ÊÅØ func (t Time) Year() int {} // ËøîÂõûÂπ¥ func (t Time) Month() Month {} // Êúà func (t Time) Day() int {} // Êó• func (t Time) Weekday() Weekday {} // ÊòüÊúü func (t Time) ISOWeek() (year, week int) {} // ËøîÂõûÂπ¥ÔºåÊòüÊúüËåÉÂõ¥ÁºñÂè∑ func (t Time) Clock() (hour, min, sec int) {} // ËøîÂõûÊó∂Èó¥ÁöÑÊó∂ÂàÜÁßí func (t Time) Hour() int {} // ËøîÂõûÂ∞èÊó∂ func (t Time) Minute() int {} // ÂàÜÈíü func (t Time) Second() int {} // Áßí func (t Time) Nanosecond() int {} // Á∫≥Áßí func (t Time) YearDay() int {} // ‰∏ÄÂπ¥‰∏≠ÂØπÂ∫îÁöÑÂ§© func (t Time) Location() *Location {} // Êó∂Èó¥ÁöÑÊó∂Âå∫ func (t Time) Zone() (name string, offset int) {} // Êó∂Èó¥ÊâÄÂú®Êó∂Âå∫ÁöÑËßÑËåÉÂêçÂíåÊÉ≥ÂØπUTC Êó∂Èó¥ÂÅèÁßªÈáè func (t Time) Unix() int64 {} // Êó∂Èó¥ËΩ¨‰∏∫Êó∂Èó¥Êà≥ func (t Time) UnixNano() int64 {} // Êó∂Èó¥ËΩ¨‰∏∫Êó∂Èó¥Êà≥ÔºàÁ∫≥ÁßíÔºâ 123456789101112131415// ËøîÂõûÊó∂Èó¥ÁöÑÊó•Êúü‰ø°ÊÅØyear, month, day := t.Date()fmt.Println("'t.Date': ", year, month, day)// ÊòüÊúüweek := t.Weekday()fmt.Println("'t.Weekday': ", week)// ËøîÂõûÂπ¥ÔºåÊòüÊúüËåÉÂõ¥ÁºñÂè∑year, week_int := t.ISOWeek()fmt.Println("'t.ISOWeek': ", year, week_int)// ËøîÂõûÊó∂Èó¥ÁöÑÊó∂ÂàÜÁßíhour, min, sec := t.Clock()fmt.Println("'t.Clock': ", hour, min, sec) Êó∂Èó¥ËøêÁÆó func (t Time) IsZero() bool {} // ÊòØÂê¶ÊòØÈõ∂Êó∂Êó∂Èó¥ func (t Time) After(u Time) bool {} // Êó∂Èó¥Âú®u ‰πãÂâç func (t Time) Before(u Time) bool {} // Êó∂Èó¥Âú®u ‰πãÂêé func (t Time) Equal(u Time) bool {} // Êó∂Èó¥‰∏éu Áõ∏Âêå func (t Time) Add(d Duration) Time {} // ËøîÂõût +d ÁöÑÊó∂Èó¥ÁÇπ func (t Time) Sub(u Time) Duration {} // ËøîÂõû t-u func (t Time) AddDate(years int, months int, days int) Time {} ËøîÂõûÂ¢ûÂä†‰∫ÜÁªôÂá∫ÁöÑÂπ¥‰ªΩ„ÄÅÊúà‰ªΩÂíåÂ§©Êï∞ÁöÑÊó∂Èó¥ÁÇπTime 1234567// ËøîÂõûÂ¢ûÂä†‰∫ÜÁªôÂá∫ÁöÑÂπ¥‰ªΩ„ÄÅÊúà‰ªΩÂíåÂ§©Êï∞ÁöÑÊó∂Èó¥ÁÇπTimet_new := t.AddDate(0, 1, 1)fmt.Println(&quot;&apos;t.AddDate&apos;: &quot;, t_new)// Êó∂Èó¥Âú®u ‰πãÂâçis_after := t.After(t_new)fmt.Println(&quot;&apos;t.After&apos;: &quot;, is_after) time.DurationÁöÑÁ±ªÂûãreceiverÂÆûÁé∞ÁöÑÊñπÊ≥ï func (d Duration) String() string // Ê†ºÂºèÂåñËæìÂá∫ Duration func (d Duration) Nanoseconds() int64 // Â∞ÜÊó∂Èó¥ÊÆµË°®Á§∫‰∏∫Á∫≥Áßí func (d Duration) Seconds() float64 // Â∞ÜÊó∂Èó¥ÊÆµË°®Á§∫‰∏∫Áßí func (d Duration) Minutes() float64 // Â∞ÜÊó∂Èó¥ÊÆµË°®Á§∫‰∏∫ÂàÜÈíü func (d Duration) Hours() float64 // Â∞ÜÊó∂Èó¥ÊÆµË°®Á§∫‰∏∫Â∞èÊó∂ 1234567// time.Duration Êó∂Èó¥ÊÆµfmt.Println("time.Duration Êó∂Èó¥ÊÆµ")d = time.Duration(10000000000000)//ËæìÂÖ•ÂèÇÊï∞‰∏∫int64Á±ªÂûãfmt.Printf("'String: %v', 'Nanoseconds: %v', 'Seconds: %v', 'Minutes: %v', 'Hours: %v'\n", d.String(), d.Nanoseconds(), d.Seconds(), d.Minutes(), d.Hours())// 'String: 2h46m40s', 'Nanoseconds: 10000000000000', 'Seconds: 10000', 'Minutes: 166.66666666666666', 'Hours: 2.7777777777777777' time.LocationÁöÑreceiverÂÆûÁé∞ÁöÑÊñπÊ≥ï func (l *Location) String() string // ËæìÂá∫Êó∂Âå∫Âêç func FixedZone(name string, offset int) *Location // FixedZone ‰ΩøÁî®ÁªôÂÆöÁöÑÂú∞ÁÇπÂêçnameÂíåÊó∂Èó¥ÂÅèÁßªÈáèoffsetÔºàÂçï‰ΩçÁßíÔºâÂàõÂª∫Âπ∂ËøîÂõû‰∏Ä‰∏™Location func LoadLocation(name string) (*Location, error) // LoadLocation ‰ΩøÁî®ÁªôÂÆöÁöÑÂêçÂ≠óÂàõÂª∫Location func Sleep(d Duration) // SleepÈòªÂ°ûÂΩìÂâçgoÁ®ãËá≥Â∞ëd‰ª£Ë°®ÁöÑÊó∂Èó¥ÊÆµ„ÄÇd&lt;=0Êó∂ÔºåSleep‰ºöÁ´ãÂàªËøîÂõû 12d_second := time.Secondtime.Sleep(d_second) ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÊäÄÂ∑ß‰∏é‰ª£Á†ÅÁ§∫‰æã string‰∏étime.Time‰∫íËΩ¨ 12345678const ( date = "2006-01-02" datetime = "2006-01-02 15:04:02")timeStamp := time.Now().Format(date) //Â∞ÜÂΩìÂâçÊó∂Èó¥ÔºåÂç≥time.TimeÁ±ªÂûãËΩ¨‰∏∫stringbillTimeStamp, err := time.Parse(date,timeStamp)//Â∞ÜStringÁ±ªÂûãÁöÑÊó∂Èó¥ËΩ¨‰∏∫time.TimeÁ±ªÂûã unix time‰∏éString‰∫íËΩ¨ 1234567891011121314151617181920212223242526272829303132333435363738endTime := time.Unix(time.Now().Unix(), 0)//Ê≠§Êó∂endTimeÊòØtime.TimeÁ±ªÂûãendStr := endTime.Format(datetime)//Â∞Üunix time ËΩ¨‰∏∫‰∫ÜStringÔºåÂÜçÊ†πÊçÆ‰∏äÈù¢ÁöÑ‰æãÂ≠êÔºåÂèØËΩ¨‰∏∫time.Timepackage mainimport ("fmt""time")func main() &#123;//Ëé∑ÂèñÊó∂Èó¥Êà≥timestamp := time.Now().Unix()fmt.Println(timestamp)//Ê†ºÂºèÂåñ‰∏∫Â≠óÁ¨¶‰∏≤,tm‰∏∫TimeÁ±ªÂûãtm := time.Unix(timestamp, 0)fmt.Println(tm.Format("2006-01-02 03:04:05 PM"))fmt.Println(tm.Format("02/01/2006 15:04:05 PM")) //‰ªéÂ≠óÁ¨¶‰∏≤ËΩ¨‰∏∫Êó∂Èó¥Êà≥ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊ†ºÂºèÔºåÁ¨¨‰∫å‰∏™ÊòØË¶ÅËΩ¨Êç¢ÁöÑÊó∂Èó¥Â≠óÁ¨¶‰∏≤tm2, _ := time.Parse("01/02/2006", "02/08/2018")fmt.Println(tm2.Unix())&#125; Áõ∏ÂÖ≥ÂèÇËÄÉpkg/time‰∏≠ÊñáÁøªËØë pkg/timeËã±Êñá]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ªéÂÜíÊ≥°ÊéíÂ∫è‰ºòÂåñÂà∞GoÂü∫ÂáÜÊµãËØï]]></title>
    <url>%2F2018%2F12%2F15%2F%E4%BB%8E%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E4%BC%98%E5%8C%96%E5%88%B0Go%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95%2F</url>
    <content type="text"><![CDATA[GoÁöÑÊµãËØïÂçïÂÖÉÊµãËØï ÊµãËØïÊñá‰ª∂ÂëΩÂêçÔºöÊñá‰ª∂ÂëΩÂêç‰ΩøÁî® xx_test.go ‰øùÂ≠òÂú®È°πÁõÆÁõÆÂΩïÈáåÂç≥ÂèØÔºå‰πüÂèØ‰ª•Êñ∞Âª∫‰∏™testÁõÆÂΩïÔºåTestAllÔºõ ÊµãËØïÂáΩÊï∞ÂëΩÂêçÔºöÂçïÂÖÉÊµãËØïÂáΩÊï∞ÂêçTestÂºÄÂ§¥ÔºåÊé•Êî∂‰∏Ä‰∏™ÊåáÈíàÂûãÂèÇÊï∞Ôºà*testing.TÔºâÔºõ ËøêË°åÊµãËØïÁ®ãÂ∫èÔºögo run test -v -run=‚ÄùÂáΩÊï∞Âêç‚ÄùÔºåÂÖ∂‰∏≠-vÊÑèÊÄùÊòØËæìÂá∫ËØ¶ÁªÜÁöÑÊµãËØï‰ø°ÊÅØÔºõ Âü∫ÂáÜÊµãËØï ÊµãËØïÊñá‰ª∂ÂëΩÂêçÔºöÊµãËØïÊñá‰ª∂ÂëΩÂêçÔºöÊñá‰ª∂ÂëΩÂêç‰ΩøÁî® xx_test.go ‰øùÂ≠òÂú®È°πÁõÆÁõÆÂΩïÈáåÂç≥ÂèØÔºå‰πüÂèØ‰ª•Êñ∞Âª∫‰∏™testÁõÆÂΩïÔºåTestAllÔºõ ÊµãËØïÂáΩÊï∞ÂëΩÂêçÔºöÂü∫ÂáÜÊµãËØï‰ª•BenchmarkÂºÄÂ§¥ÔºåÊé•Êî∂‰∏Ä‰∏™ÊåáÈíàÂûãÂèÇÊï∞Ôºà*testing.BÔºâÔºõ ËøêË°åÊµãËØïÁ®ãÂ∫èÔºögo test -v -bench=‚ÄùÂáΩÊï∞Âêç‚ÄùÔºõ ËøòÊúâ‰∏Ä‰∏™ÂèÇÊï∞ÊòØ -benchmem, -benchmem Ë°®Á§∫ÂàÜÈÖçÂÜÖÂ≠òÁöÑÊ¨°Êï∞ÂíåÂ≠óËäÇÊï∞Ôºå-benchtime=‚Äù3s‚Äù Ë°®Á§∫ÊåÅÁª≠3Áßí ÂÜíÊ≥°ÊéíÂ∫èÂèäÂÖ∂ÁÆÄÂçï‰ºòÂåñÂÜíÊ≥°ÊéíÂ∫èÂâçÂá†Â§©Áúã‰∏Ä‰∏™ÂÖ¨‰ºóÂè∑ÔºåËØ¥ÊòØÊúâ‰∏™‰∫∫ÂéªÁæéÂõ¢Èù¢ËØïÔºåË¢´Ë¶ÅÊ±ÇÊâãÂÜôÂÜíÊ≥°ÊéíÂ∫èÁÆóÊ≥ïÔºåËøô‰∫∫ÂøÉÊÉ≥ËøôËøò‰∏çÁÆÄÂçïÁöÑÔºåÂàÜÂàÜÈíüÂÜô‰∏ã‰∫Ü‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºåÂèØ‰ª•ËØ¥ÊòØÈùûÂ∏∏Ê†áÂáÜÁöÑÂÜíÊ≥°ÊéíÂ∫è‰∫Ü 123456789101112func BubbleSort(array []int) &#123; i := 0 for i = 0; i&lt;len(array)-1;i++&#123; for j :=0;j&lt;len(array)-i-1;j++&#123; if array[j]&gt;array[j+1]&#123; swap(j, j+1) &#125; &#125; &#125;&#125; ‰ΩÜÊòØÈöè‰πãÔºåÈù¢ËØïÂÆòËØ¥ËÆ©‰ªñ‰ºòÂåñ‰∏Ä‰∏ãËøô‰∏™ÁÆóÊ≥ïÔºåÈóÆ‰ªñÊúâÊ≤°ÊúâÂèØ‰ºòÂåñÁöÑÂú∞ÊñπÔºåËøô‰∫∫Â∞±ÊáµÈÄº‰∫Ü„ÄÇÂÖ∂ÂÆûÂÜíÊ≥°ÊéíÂ∫èÂèØ‰ºòÂåñÁöÑÂú∞ÊñπÂæàÂ§öÔºåÊúÄÁÆÄÂçïÁöÑ‰∏ÄÁßçÂ∞±ÊòØÂä†‰∏Ä‰∏™Ê†áÂøó‰ΩçÔºåÊ£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊéíÂ∫èÂÆåÊØïÔºåÊéíÂ∫èÂ∑≤ÁªèÂÆåÊàêÁöÑËØùÂ∞±Ê≤°ÊúâÂøÖË¶ÅÂÜçÊØîËæÉ‰∏ãÂéªÔºåÊµ™Ë¥πÊó∂Èó¥„ÄÇ‰∏äÈù¢ÁöÑ‰ª£Á†ÅÊ∑ªÂä†Âá†Ë°åÔºåÈÇ£‰∫∫Â∞±ÂæàÂèØËÉΩÊãøÂà∞offer‰∫Ü„ÄÇ 123456789101112131415func BubbleSort(array []int) &#123; i := 0 for i = 0; i&lt;len(array)-1;i++&#123; exchanged := false for j :=0;j&lt;len(array)-i-1;j++&#123; if array[j]&gt;array[j+1]&#123; swap(j, j+1) exchanged = true &#125; &#125; if exchanged == false &#123; return &#125; &#125;&#125; ÈÇ£‰πàÔºåÂ¶Ç‰ΩïÊõ¥Áõ¥ËßÇÁöÑÁúãÂá∫Ôºå‰ºòÂåñËøáÁöÑ‰ª£Á†ÅÁ°ÆÂÆûÊúâÊïàÂë¢ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøÁî®goËá™Â∏¶ÁöÑÂü∫ÂáÜÊµãËØïÔºåÊµãËØï‰∏Ä‰∏ã‰∏§ÊÆµ‰ª£Á†ÅÁöÑÊÄßËÉΩÔºå‰ºòÂåñ‰∏éÂê¶Â∞±‰∏ÄÁõÆ‰∫ÜÁÑ∂„ÄÇ Âü∫ÂáÜÊµãËØïÂÜíÊ≥°ÊéíÂ∫è È¶ñÂÖàÊàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™Â≠òÊîæÊµãËØïÊñá‰ª∂ÁöÑÊñá‰ª∂Â§π 1mkdir testAll ÁÑ∂ÂêéÂàõÂª∫Âü∫ÂáÜÊµãËØïÊñá‰ª∂ 1touch benchmark_test.go ÁºñÂÜôÂü∫ÂáÜÊµãËØï‰ª£Á†Å 1234567var sortArray = []int&#123;41, 24, 76, 11, 45, 64, 21, 69, 19, 36&#125;func BenchmarkBubbleSort(b *testing.B) &#123; for i:=0;i&lt;b.N;i++ &#123; BubbleSort(sortArray) &#125;&#125; ÊµãËØïÂü∫Êú¨ÂÜíÊ≥°ÊéíÂ∫è Êàë‰ª¨È¶ñÂÖàÊµãËØïÊúÄÂéüÂßãÁöÑÂÜíÊ≥°ÊéíÂ∫è Âú®testAllÊñá‰ª∂Â§π‰∏ãÊâßË°å 1go test -v -bench=&quot;BubbleSort&quot; Âü∫ÂáÜÊµãËØïÁªìÊûúÂ¶ÇÂõæÊâÄÁ§∫ÔºåËß£Èáä‰∏Ä‰∏ãÂá†‰∏™ÂÖ≥ÈîÆÂèÇÊï∞Ôºå 81.2ns/op Ë°®Á§∫ÊØèÊ¨°Êìç‰ΩúËÄóÊó∂81.2Á∫≥ÁßíÔºå1.725sË°®Á§∫Á®ãÂ∫èËøêË°åÁöÑÊó∂Èó¥„ÄÇ ÊµãËØï‰ºòÂåñÁöÑÂÜíÊ≥°ÊéíÂ∫è ÊâßË°å 1go test -v -bench=&quot;BubbleSort&quot; ÂèØ‰ª•ÁúãÂà∞‰ºòÂåñËøáÁöÑ‰ª£Á†ÅÔºåÊâßË°åÊó∂Èó¥‰∏∫1.2s,ËÄå‰∏îÊØèÊ¨°Êìç‰ΩúÁöÑËÄóÊó∂‰∏∫23.0Á∫≥ÁßíÔºåË∂≥Ë∂≥Èôç‰Ωé‰∫Ü60%Â§ö„ÄÇÂèØËßÅ‰∏Ä‰∏™ÂæàÁÆÄÂçïÁöÑ‰ºòÂåñÂ∞±ÂèØ‰ª•‰Ωø‰ª£Á†ÅÊèêÂçáËøô‰πàÂ§öÔºåÂú®‰ª•ÂêéÁöÑÂ∑•‰Ωú‰∏≠ÔºåÂØπ‰∫é‰ª£Á†ÅÁöÑËÆæËÆ°‰∏é‰ºòÂåñËøòÊòØË¶ÅÈáçËßÜ„ÄÇ]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>go</tag>
        <tag>ÊäÄÊúØÂë®Âàä</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[postman Êé•Âè£ÊµãËØïÁ•ûÂô®]]></title>
    <url>%2F2018%2F12%2F08%2Fpostman-%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E7%A5%9E%E5%99%A8%2F</url>
    <content type="text"><![CDATA[Postman Êé•Âè£ÊµãËØïÁ•ûÂô®Postman ÊòØ‰∏Ä‰∏™Êé•Âè£ÊµãËØïÂíå http ËØ∑Ê±ÇÁöÑÁ•ûÂô®ÔºåÈùûÂ∏∏Â•ΩÁî®„ÄÇ ÂÆòÊñπ github Âú∞ÂùÄ: https://github.com/postmanlabs Postman ÁöÑ‰ºòÁÇπÔºö ÊîØÊåÅÂêÑÁßçÁöÑËØ∑Ê±ÇÁ±ªÂûã: get„ÄÅpost„ÄÅput„ÄÅpatch„ÄÅdelete Á≠â ÊîØÊåÅÂú®Á∫øÂ≠òÂÇ®Êï∞ÊçÆÔºåÈÄöËøáË¥¶Âè∑Â∞±ÂèØ‰ª•ËøõË°åËøÅÁßªÊï∞ÊçÆ ÂæàÊñπ‰æøÁöÑÊîØÊåÅËØ∑Ê±Ç header ÂíåËØ∑Ê±ÇÂèÇÊï∞ÁöÑËÆæÁΩÆ ÊîØÊåÅ‰∏çÂêåÁöÑËÆ§ËØÅÊú∫Âà∂ÔºåÂåÖÊã¨ Basic AuthÔºåDigest AuthÔºåOAuth 1.0ÔºåOAuth 2.0 Á≠â ÂìçÂ∫îÊï∞ÊçÆÊòØËá™Âä®ÊåâÁÖßËØ≠Ê≥ïÊ†ºÂºèÈ´ò‰∫ÆÁöÑÔºåÂåÖÊã¨ HTMLÔºåJSON Âíå XML ‰ª•‰∏ãÂÜÖÂÆπ‰∏ªË¶ÅÂèÇËÄÉÔºö Github: api_tool_postman ÂÆâË£ÖPostman ÂèØ‰ª•ÂçïÁã¨‰Ωú‰∏∫‰∏Ä‰∏™Â∫îÁî®ÂÆâË£ÖÔºå‰πüÂèØ‰ª•‰Ωú‰∏∫ chrome ÁöÑ‰∏Ä‰∏™Êèí‰ª∂ÂÆâË£Ö„ÄÇ chrome Êèí‰ª∂ÂÆâË£Ö, Postman Êèí‰ª∂Âú∞ÂùÄ ÂçïÁã¨Â∫îÁî®ÂÆâË£Ö‰∏ãËΩΩ ‰∏ãÈù¢‰∏ªË¶Å‰ªãÁªç‰∏ãËΩΩÂÆâË£ÖÁã¨Á´ãÁâàÊú¨app ËΩØ‰ª∂ÁöÑ Postman ÁöÑËøáÁ®ãÔºö Âéª‰∏ªÈ°µPostman ÂÆòÁΩëÊâæÂà∞ÔºöPostman | Apps Âéª‰∏ãËΩΩËá™Â∑±Âπ≥Âè∞ÁöÑÁâàÊú¨Ôºö Mac WindowsÔºàx86/x64Ôºâ LinuxÔºàx86/x64Ôºâ Âç≥ÂèØ„ÄÇ Âø´ÈÄüÂÖ•Èó®ÔºåÊÄª‰Ωì‰ΩøÁî®ÊñπÁï•ÂÆâË£ÖÊàêÂäüÂêéÔºåÊâìÂºÄËΩØ‰ª∂„ÄÇ Êñ∞Âª∫Êé•Âè£ÂØπÂ∫îÁöÑRequestÔºöNew -&gt; Request ÊàñÔºåÂú®Âè≥ËæπÁöÑ Tab È°µÈù¢‰∏≠ÁÇπÂáªÂä†Âè∑+Ôºö Âç≥ÂèØÁúãÂà∞Êñ∞Âª∫ÁöÑ Tab È°µÔºö ËÆæÁΩÆ HTTP ËØ∑Ê±ÇÁöÑÊñπÊ≥ïËÆæÁΩÆ HTTP ÁöÑ Method ÊñπÊ≥ïÂíåËæìÂÖ• api ÁöÑÂú∞ÂùÄ ËÆæÁΩÆÁõ∏ÂÖ≥ËØ∑Ê±ÇÂ§¥‰ø°ÊÅØ ËÆæÁΩÆÁõ∏ÂÖ≥ GET Êàñ POST Á≠âÁöÑÂèÇÊï∞ ÂèëÈÄÅËØ∑Ê±ÇÈÉΩÂ°´ÂÜôÂ•Ω‰πãÂêéÔºåÁÇπÂáª Send ÂéªÂèëÈÄÅËØ∑Ê±Ç RequestÔºö Êü•ÁúãÂìçÂ∫î ResponseÁöÑ‰ø°ÊÅØ ÁÑ∂ÂêéÂèØ‰ª•ÈáçÂ§ç‰∏äËø∞‰øÆÊîπ Request ÁöÑÂèÇÊï∞ÔºåÁÇπÂáª Send ÂéªÂèëÈÄÅËØ∑Ê±ÇÁöÑËøáÁ®ãÔºå‰ª•‰æøË∞ÉËØïÂà∞ API Êé•Âè£Ê≠£Â∏∏Â∑•‰Ωú‰∏∫Ê≠¢„ÄÇ ‰øùÂ≠òÊé•Âè£ÈÖçÁΩÆÂæÖÊï¥‰∏™Êé•Âè£ÈÉΩË∞ÉËØïÂÆåÊØïÂêéÔºåËÆ∞ÂæóÁÇπÂáª Save Âéª‰øùÂ≠òÊé•Âè£‰ø°ÊÅØÔºö Âéª‰øùÂ≠òÂΩìÂâç API Êé•Âè£ÔºåÁÑ∂ÂêéÈúÄË¶ÅÂ°´ÂÜôÁõ∏ÂÖ≥ÁöÑÊé•Âè£‰ø°ÊÅØÔºö Request Name: ËØ∑Ê±ÇÁöÑÂêçÂ≠ó Êàë‰∏ÄËà¨‰π†ÊÉØÁî®‰øùÂ≠ò‰∏∫ Êé•Âè£ÁöÑÊúÄÂêéÁöÑÂ≠óÊÆµÂêçÔºåÊØîÂ¶Çhttp://{{server_address}}/ucows/login/login‰∏≠ÁöÑ/login/login Request Description: Êé•Âè£ÁöÑÊèèËø∞ ÂèØÈÄâ ÊúÄÂ•ΩÂÜô‰∏äËØ•Êé•Âè£ÁöÑË¶ÅÂÆûÁé∞ÁöÑÂü∫Êú¨ÂäüËÉΩÂíåÁõ∏ÂÖ≥Ê≥®ÊÑè‰∫ãÈ°π ÊîØÊåÅ Markdown ËØ≠Ê≥ï Select a collection or folder to save: ÈÄâÊã©Ë¶Å‰øùÂ≠òÂà∞Âì™‰∏™ÂàÜÁªÑÔºàÊàñÊñá‰ª∂Â§πÔºâ ÂæÄÂæÄ‰øùÂ≠òÂà∞Êüê‰∏™ API Êé•Âè£Âà∞ÊâÄÂ±ûÁöÑËØ•È°πÁõÆÂêçÁöÑÂàÜÁªÑ Â°´ÂÜôÂ•ΩÂÜÖÂÆπÔºåÈÄâÊã©Â•ΩÂàÜÁªÑÔºåÂÜçÁÇπÂáª‰øùÂ≠òÔºö Ê≠§Êó∂ÔºåTab ÁöÑÂè≥‰∏äËßíÁöÑÈªÑËâ≤ÁÇπÔºàË°®Á§∫Ê≤°Êúâ‰øùÂ≠òÔºâÊ∂àÂ§±‰∫ÜÔºåË°®Á§∫Â∑≤‰øùÂ≠ò„ÄÇ ‰∏îÂØπÂ∫îÁöÑÂàÜÁªÑ‰∏≠ÂèØ‰ª•ÁúãÂà∞ÂØπÂ∫îÁöÑÊé•Âè£‰∫ÜÔºö [warning] ÈªòËÆ§‰∏ç‰øùÂ≠òËøîÂõûÁöÑ Response Êï∞ÊçÆ Áõ¥Êé•ÁÇπÂáª Save Âéª‰øùÂ≠òÔºåÂè™ËÉΩ‰øùÂ≠ò API Êú¨Ë∫´ÔºàÁöÑ Request ËØ∑Ê±ÇÔºâÔºå‰∏ç‰ºö‰øùÂ≠ò Response ÁöÑÊï∞ÊçÆ ÊÉ≥Ë¶Å‰øùÂ≠ò Response Êï∞ÊçÆÔºåÈúÄË¶ÅÁî®ÂêéÈù¢Ë¶Å‰ªãÁªçÁöÑ Â§ö‰∏™ Example Request ÁöÑÂ§öÂèÇÊï∞Êìç‰ΩúËØ¶Ëß£Ëá™Âä®Ëß£ÊûêÂ§ö‰∏™ÂèÇÊï∞ ParamsÊØîÂ¶ÇÔºåÂØπ‰∫é‰∏Ä‰∏™ GET ÁöÑËØ∑Ê±ÇÁöÑ url ÊòØÔºö http://openapi.youdao.com/api?q=Á∫†Âà†Á†Å(EC)ÁöÑÂ≠¶‰π†&amp;from=zh_CHS&amp;to=EN&amp;appKey=152e0e77723a0026&amp;salt=4&amp;sign=6BE15F1868019AD71C442E6399DB1FE4 ÂØπÂ∫îÁùÄÂÖ∂ÂÆûÊòØ?key=valueÂΩ¢Âºè‰∏≠ÂåÖÂê´Â§ö‰∏™ Http ÁöÑ GET ÁöÑ query string=query parameters Postman ÂèØ‰ª•Ëá™Âä®Â∏ÆÊàë‰ª¨Ëß£ÊûêÂá∫ÂØπÂ∫îÂèÇÊï∞ÔºåÂèØ‰ª•ÁÇπÂáª ParamsÔºö ÁúãÂà∞Â±ïÂºÄÁöÑÂ§ö‰∏™ÂèÇÊï∞Ôºö Â¶ÇÊ≠§Â∞±ÂèØ‰ª•ÂæàÊñπ‰æøÁöÑ‰øÆÊîπÔºåÂ¢ûÂà†ÂØπÂ∫îÁöÑÂèÇÊï∞‰∫Ü„ÄÇ ‰∏¥Êó∂Á¶ÅÁî®ÂèÇÊï∞‰∏îËøòÊîØÊåÅÔºåÂú®‰∏çÂà†Èô§ÊüêÂèÇÊï∞ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅÊöÇÊó∂‰∏ç‰º†ÂèÇÊï∞ÔºåÂèØ‰ª•Êñπ‰æøÁöÑÈÄöËøá‰∏çÂãæÈÄâÁöÑÊñπÂºèÂéªÂÆûÁé∞Ôºö ÊâπÈáèÁºñËæë GET ÁöÑÂ§ö‰∏™ÂèÇÊï∞ÂΩìÁÑ∂ÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅÊâπÈáèÁöÑÁºñËæëÂèÇÊï∞ÔºåÂèØ‰ª•ÁÇπÂáªÂè≥‰∏äËßíÁöÑBulk EditÔºåÂéªÂÆûÁé∞ÊâπÈáèÁºñËæë„ÄÇ Êé•Âè£ÊèèËø∞‰∏éËá™Âä®ÁîüÊàêÊñáÊ°£API ÁöÑÊèèËø∞‰∏≠Ôºå‰πüÊîØÊåÅ MarkdownÔºåÂÆòÊñπÁöÑÊé•Âè£ËØ¥ÊòéÊñáÊ°£ÔºöIntro to API documentation„ÄÇ ÊâÄ‰ª•ÔºåÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÊ∑ªÂä†ÊúâÊù°ÁêÜÁöÑÊé•Âè£ÊèèËø∞ÔºåÂ∞§ÂÖ∂ÊòØÂèÇÊï∞Ëß£Èáä‰∫ÜÔºö ÊèèËø∞ÊîØÊåÅ markdown ËØ≠Ê≥ï ËÄåÂØπ‰∫éË¶ÅËß£ÈáäÁöÑÂèÇÊï∞ÔºåÂèØ‰ª•ÈÄöËøá‰πãÂâçÁöÑParam -&gt; Bulk EditÁöÑÂÜÖÂÆπÔºö Êã∑Ë¥ùËøáÊù•ÔºåÂÜçÁªßÁª≠ÂéªÁºñËæëÔºö ‰ª•ÂèäÊ∑ªÂä†Êõ¥Â§öËß£Èáä‰ø°ÊÅØÔºö ÁÇπÂáª Update ÂêéÔºåÂç≥ÂèØ‰øùÂ≠ò„ÄÇ ÂèëÂ∏ÉÊé•Âè£Âπ∂ÁîüÊàê markdown ÁöÑÊèèËø∞Êñá‰ª∂ÂéªÂèëÂ∏ÉÂêéÔºö ÂØπÂ∫îÁöÑÊïàÊûúÔºöÊúâÈÅìÁøªËØë Response Ê∑±ÂÖ•Response Êï∞ÊçÆÊòæÁ§∫Ê®°ÂºèPostman ÂØπ‰∫éËøîÂõûÁöÑ Response Êï∞ÊçÆÔºåÊîØÊåÅ‰∏âÁßçÊòæÁ§∫Ê®°Âºè„ÄÇ ÈªòËÆ§Ê†ºÂºèÂåñÂêéÁöÑ Pretty Ê®°Âºè Raw ÂéüÂßãÊ®°Âºè ÁÇπÂáªRawÔºåÂèØ‰ª•Êü•ÁúãÂà∞ËøîÂõûÁöÑÊ≤°ÊúâÊ†ºÂºèÂåñ‰πãÂâçÁöÑÂéüÂßãÊï∞ÊçÆÔºö Preview È¢ÑËßàÊ®°Âºè ‰ª•Âèä PreviewÔºåÊòØÂØπÂ∫î Raw ÂéüÂßãÊ†ºÂºèÁöÑÈ¢ÑËßàÊ®°ÂºèÔºö Preview ËøôÁßçÊ®°ÂºèÁöÑÊòæÁ§∫ÊïàÊûúÔºåÂ•ΩÂÉèÊòØÂØπ‰∫éËøîÂõûÁöÑÊòØ html È°µÈù¢ËøôÁ±ªÔºåÊâçÊØîËæÉÊúâÊïàÊûú„ÄÇ Response ÁöÑ CookiesÂæàÂ§öÊó∂ÂÄôÊôÆÈÄöÁöÑ API Ë∞ÉÁî®ÔºåÂÄíÊòØÊ≤°Êúâ Cookie ÁöÑÔºö Response ÁöÑ Headers Â§¥‰ø°ÊÅØ‰∏æ‰æãÔºåÊ≠§Â§ÑËøîÂõûÁöÑÊòØÊúâ Headers Â§¥‰ø°ÊÅØÁöÑÔºö ÂèØ‰ª•‰ªé‰∏≠ÁúãÂà∞ÊúçÂä°Âô®ÊòØ Nginx ÁöÑ„ÄÇ ‰øùÂ≠òÂ§ö‰∏™ Example‰πãÂâçÊÉ≥Ë¶ÅÂÆûÁé∞ÔºåËÆ©ÂØºÂá∫ÁöÑ API ÊñáÊ°£‰∏≠ËÉΩÁúãÂà∞Êé•Âè£ËøîÂõûÁöÑ Response Êï∞ÊçÆ„ÄÇÂêéÊù•ÂèëÁé∞ÊòØExampleËøô‰∏™ÂäüËÉΩÂéªÂÆûÁé∞Ê≠§ÊïàÊûúÁöÑ„ÄÇ Â¶Ç‰ΩïÊ∑ªÂä† Example ÁªßÁª≠ÁÇπÂáªSave ExampleÔºö ‰øùÂ≠òÂêéÔºåÂ∞±ËÉΩÁúãÂà∞Example(1)‰∫ÜÔºö Âçï‰∏™ Example Âú®ÂØºÂá∫ÁöÑ API ÊñáÊ°£‰∏≠ÁöÑÊïàÊûúÁÑ∂ÂêéÂÜçÂéªÂØºÂá∫ÊñáÊ°£ÔºåÂØºÂá∫ÊñáÊ°£‰∏≠ÁöÑÁ°ÆËÉΩÁúãÂà∞ËøîÂõûÊï∞ÊçÆÁöÑ‰æãÂ≠êÔºö Â§ö‰∏™ Example Âú®ÂØºÂá∫ÁöÑ API ÊñáÊ°£‰∏≠ÁöÑÊïàÊûú ÂÖ∂‰ªñÂ•ΩÁî®ÁöÑÂäüËÉΩÂèäÂ∑•ÂÖ∑ÂàÜÁªÑ CollectionÂú®ÂàöÂºÄÂßã‰∏Ä‰∏™È°πÁõÆÊó∂Ôºå‰∏∫‰∫ÜÂêéÁª≠‰æø‰∫éÁªÑÁªáÂíåÁÆ°ÁêÜÔºåÊääÂêåÂ±ûËØ•È°πÁõÆÁöÑÂ§ö‰∏™ APIÔºåÊîæÂú®‰∏ÄÁªÑÈáå ÊâÄ‰ª•Ë¶ÅÂÖàÂéªÊñ∞Âª∫‰∏Ä‰∏™ Collection: New -&gt; Collection ‰ΩøÁî®‰∫ÜÊÆµÊó∂Èó¥ÂêéÔºåÂª∫‰∫ÜÂ§ö‰∏™ÂàÜÁªÑÁöÑÊïàÊûúÔºö Âçï‰∏™ÂàÜÁªÑÂ±ïÂºÄÂêéÁöÑÊïàÊûúÔºö ÂéÜÂè≤ËÆ∞ÂΩï HistoryPostman ÊîØÊåÅ history ÂéÜÂè≤ËÆ∞ÂΩïÔºåÊòæÁ§∫Âá∫ÊúÄËøë‰ΩøÁî®ËøáÁöÑ APIÔºö Áî®ÁéØÂ¢ÉÂèòÈáèÂÆûÁé∞Â§öÊúçÂä°Âô®ÁâàÊú¨Áé∞Â≠òÈóÆÈ¢òÂú®ÊµãËØï API ÊúüÈó¥ÔºåÂæÄÂæÄÂ≠òÂú®Â§öÁßçÁéØÂ¢ÉÔºåÂØπÂ∫î IP Âú∞ÂùÄÔºàÊàñÂüüÂêç‰πü‰∏çÂêåÔºâ ÊØîÂ¶ÇÔºö Prod: 1http://116.62.25.57/ucows Áî®‰∫éÂºÄÂèëÂÆåÊàêÂèëÂ∏ÉÂà∞Áîü‰∫ßÁéØÂ¢É Dev: 1http://123.206.191.125/ucows Áî®‰∫éÂºÄÂèëÊúüÈó¥ÁöÑÁ∫ø‰∏äÁöÑ Development ÁöÑÊµãËØïÁéØÂ¢É LocalTest: 1http://192.168.0.140:80/ucows Áî®‰∫éÂºÄÂèëÊúüÈó¥ÈÖçÂêàÂêéÂè∞ÂºÄÂèë‰∫∫ÂëòÁöÑÊú¨Âú∞Â±ÄÂüüÁΩëÂÜÖÁöÑÊú¨Âú∞ÁéØÂ¢ÉÔºåÁî®‰∫éËÅîÂêàË∞ÉËØï API Êé•Âè£ ËÄåÂú®ÊµãËØï API ÊúüÈó¥ÔºåÂæÄÂæÄÈúÄË¶ÅÊâãÂä®Âéª‰øÆÊîπ API ÁöÑÂú∞ÂùÄÔºö ÊïàÁéáÊØîËæÉ‰ΩéÔºå‰∏îÂú∞ÂùÄÊõ¥Êç¢Âêé‰πãÂâçÂú∞ÂùÄÂ∞±Ê≤°Ê≥ï‰øùÁïô‰∫Ü„ÄÇ Âè¶Â§ñÔºå‰∏îÊ†πÊçÆ‰∏çÂêå IP Âú∞ÂùÄÔºàÊàñËÄÖÂüüÂêçÔºâ‰πü‰∏çÂÆπÊòìËØÜÂà´ÊòØÂì™Â•óÁéØÂ¢É„ÄÇ Postman ÊîØÊåÅÁî® Environment ÁéØÂ¢ÉÂèòÈáèÂéªÂÆûÁé∞Â§öÊúçÂä°Âô®ÁâàÊú¨ÂêéÊù•ÂèëÁé∞ Postman ‰∏≠ÔºåÊúâ Environment Âíå Global VariableÔºåÁî®‰∫éËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÂÆûÁé∞‰∏çÂêåÁéØÂ¢ÉÁöÑÁÆ°ÁêÜÔºö ÂæàÊòéÊòæÔºåÂ∞±ÂèØ‰ª•Áî®Êù•ÂÆûÁé∞‰∏çÁî®ÊâãÂä®‰øÆÊîπ url ‰∏≠ÁöÑÊúçÂä°Âô®Âú∞ÂùÄÔºå‰ªéËÄåÂä®ÊÄÅÁöÑÂÆûÁé∞ÔºåÊîØÊåÅ‰∏çÂêåÊúçÂä°Âô®ÁéØÂ¢É: Production Áîü‰∫ßÁéØÂ¢É Development ÂºÄÂèëÁéØÂ¢É Local Êú¨Âú∞Â±ÄÂüüÁΩëÁéØÂ¢É Â¶Ç‰Ωï‰ΩøÁî® Enviroment ÂÆûÁé∞Â§öÊúçÂä°Âô®ÁâàÊú¨ ÊàñËÄÖÔºö Environments are a group of variables &amp; values, that allow you to quickly switch the context for your requests and collections. Learn more about environments You can declare a variable in an environment and give it a starting value, then use it in a request by putting the variable name within curly-braces. Create an environment to get started. ËæìÂÖ• Key Âíå valueÔºö ÁÇπÂáª Add ÂêéÔºö [info] ÁéØÂ¢ÉÂèòÈáèÂèØ‰ª•‰ΩøÁî®ÁöÑÂú∞Êñπ URL URL params Header values form-data/url-encoded values Raw body content Helper fields ÂÜô test ÊµãËØïËÑöÊú¨‰∏≠ ÈÄöËøá postman ÁöÑÊé•Âè£ÔºåËé∑ÂèñÊàñËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÁöÑÂÄº„ÄÇ Ê≠§Â§ÑÊää‰πãÂâçÁöÑÂú® url ‰∏≠ÁöÑ IP Âú∞ÂùÄÔºàÊàñÂüüÂêçÔºâÊç¢ÊàêÁéØÂ¢ÉÂèòÈáèÔºö Èº†Ê†áÁßªÂä®Âà∞ÁéØÂ¢ÉÂèòÈáè‰∏äÔºåÂèØ‰ª•Âä®ÊÄÅÊòæÁ§∫Âá∫ÂÖ∑‰ΩìÁöÑÂÄºÔºö ÂÜçÂéªÊ∑ªÂä†Âè¶Â§ñ‰∏Ä‰∏™ÂºÄÂèëÁéØÂ¢ÉÔºö ÂàôÂèØÊ∑ªÂä†ÂÆå 2 ‰∏™ÁéØÂ¢ÉÂèòÈáèÔºåË°®Á§∫‰∏§‰∏™ÊúçÂä°Âô®Âú∞ÂùÄÔºå‰∏§‰∏™ÁâàÊú¨Ôºö ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÂàáÊç¢‰∏çÂêåÊúçÂä°Âô®ÁéØÂ¢É‰∫ÜÔºö ÂèØ‰ª•ÁúãÂà∞ÔºåÂêåÊ†∑ÁöÑÂèòÈáè server_addressÔºåÂú®ÂàáÊç¢ÂêéÂØπÂ∫î IP Âú∞ÂùÄÂ∞±ÂèòÊàêÂ∏åÊúõÁöÑÂºÄÂèëÁéØÂ¢ÉÁöÑ IP ‰∫ÜÔºö Postman ÂØºÂá∫ API ÊñáÊ°£‰∏≠Â§ö‰∏™ÁéØÂ¢ÉÂèòÈáèÁöÑÊïàÊûúÈ°∫Â∏¶‰πüÂéªÁúãÁúãÔºåÂØºÂá∫‰∏∫ API ÊñáÊ°£ÂêéÔºåÂ∏¶‰∫ÜËøôÁßç Environment ÁöÑÂèòÈáèÁöÑÊé•Âè£ÔºåÊñáÊ°£Èïø‰ªÄ‰πàÊ†∑Â≠êÔºö ÂèëÁé∞ÊòØÂú®ÂèëÂ∏É‰πãÂâçÔºåÈúÄË¶ÅÈÄâÊã©ÂØπÂ∫îÁöÑÁéØÂ¢ÉÁöÑÔºö ÂèëÂ∏ÉÂêéÁöÑÊñáÊ°£ÔºåÂèØ‰ª•ÁúãÂà∞ÊâÄÈÄâÁéØÂ¢ÉÂíåÂØπÂ∫îÊúçÂä°Âô®ÁöÑ IP ÁöÑÔºö ÂΩìÁÑ∂ÂèëÂ∏ÉÊñáÊ°£ÂêéÔºå‰πüÂèØ‰ª•ÂÆûÊó∂ÂàáÊç¢ÁéØÂ¢ÉÔºö ÁéØÂ¢ÉÂèòÈáèÁöÑÂ•ΩÂ§ÑÂΩìÊõ¥Êç¢ÊúçÂä°Âô®Êó∂ÔºåÁõ¥Êé•‰øÆÊîπÂèòÈáèÁöÑ IP Âú∞ÂùÄÔºö Âç≥ÂèØÂÆûÊó∂Êõ¥Êñ∞ÔºåÂΩìÈº†Ê†áÁßªÂä®Âà∞ÂèòÈáè‰∏äÂç≥ÂèØÁúãÂà∞ÊïàÊûúÔºö ‰ª£Á†ÅÁîüÊàêÂ∑•ÂÖ∑Êü•ÁúãÂΩìÂâçËØ∑Ê±ÇÁöÑ HTTP ÂéüÂßãÂÜÖÂÆπÂØπ‰∫éÂΩìÂâçÁöÑËØ∑Ê±ÇÔºåËøòÂèØ‰ª•ÈÄöËøáÁÇπÂáª Code ÂéªÊü•ÁúãÂØπÂ∫îÁöÑÁ¨¶Âêà HTTP ÂçèËÆÆÁöÑÂéüÂßãÁöÑÂÜÖÂÆπÔºö ÂêÑÁßçËØ≠Ë®ÄÁöÑÁ§∫‰æã‰ª£Á†ÅCode Generation ToolsÊØîÂ¶ÇÔºö Swift ËØ≠Ë®Ä Java ËØ≠Ë®Ä ÂÖ∂‰ªñÂêÑÁßçËØ≠Ë®Ä ËøòÊîØÊåÅÂÖ∂‰ªñÂêÑÁßçËØ≠Ë®ÄÔºö ÁõÆÂâçÊîØÊåÅÁöÑËØ≠Ë®ÄÊúâÔºö HTTP C (LibCurl) cURL C#(RestSharp) Go Java OK HTTP Unirest Javascript NodeJS Objective-C(NSURL) OCaml(Cohttp) PHP Python Ruby(NET::Http) Shell Swift(NSURL) ‰ª£Á†ÅÁîüÊàêÂ∑•ÂÖ∑ÁöÑÂ•ΩÂ§ÑÊòØÔºöÂú®ÂÜôË∞ÉÁî®Ê≠§ API ÁöÑ‰ª£Á†ÅÊó∂ÔºåÂ∞±ÂèØ‰ª•ÂèÇËÄÉÂØπÂ∫î‰ª£Á†ÅÔºåÁîöËá≥Êã∑Ë¥ùÁ≤òË¥¥ÂØπÂ∫î‰ª£Á†ÅÔºåÂç≥ÂèØ„ÄÇ ÊµãËØïÊé•Âè£ÈÄâ‰∏≠Êüê‰∏™ÂàÜÁªÑÂêéÔºåÁÇπÂáª Runner ÈÄâ‰∏≠Êüê‰∏™ÂàÜÁªÑÂêéÁÇπÂáª Run Âç≥ÂèØÁúãÂà∞ÊµãËØïÁªìÊûúÔºö ÂÖ≥‰∫éÊ≠§ÂäüËÉΩÁöÑ‰ªãÁªçÂèØÂèÇËÄÉPostman ÂÆòÁΩëÁöÑgit Âõæ MockServerÁõ¥Êé•ÂèÇËÄÉÂÆòÁΩë„ÄÇ ÂäüËÉΩÁïåÈù¢Â§ö Tab ÂàÜÈ°µPostman ÊîØÊåÅÂ§ö tab È°µÔºå‰∫éÊ≠§ÂØπÊØî‰πãÂâçÊúâ‰∫õ API Ë∞ÉËØïÂ∑•ÂÖ∑Â∞±‰∏çÊîØÊåÅÂ§ö Tab È°µÔºåÊØîÂ¶ÇAdvanced Rest Client Â§ö tab ÁöÑÂ•ΩÂ§ÑÔºö Êñπ‰æøÂú®‰∏Ä‰∏™ tab ‰∏≠ÊµãËØïÔºåÂæóÂà∞ÁªìÊûúÂêéÔºåÂ§çÂà∂Á≤òË¥¥Âà∞Âè¶Â§ñÁöÑ tab ‰∏≠ÔºåÁªßÁª≠ÊµãËØïÂÖ∂ÂÆÉÊé•Âè£ ÊØîÂ¶ÇÊ≠§Â§Ñ tab1 ‰∏≠ÔºåÊµãËØï‰∫ÜËé∑ÂèñÈ™åËØÅÁ†ÅÊé•Âè£ÂêéÔºåÊã∑Ë¥ùÊâãÊú∫Âè∑ÂíåÈ™åËØÅÁ†ÅÔºåÁ≤òË¥¥Âà∞ tab2 ‰∏≠ÔºåÁªßÁª≠ÊµãËØïÊ≥®ÂÜåÁöÑÊé•Âè£ ÁïåÈù¢Êü•ÁúãÊ®°ÂºèPostman ÁöÑÈªòËÆ§ÁöÑ Request Âíå Response ÊòØ‰∏ä‰∏ãÂ∏ÉÂ±ÄÔºö Ê≠§Â§ÑÁÇπÂáªÂè≥‰∏ãËßíÁöÑTwo pane viewÔºåÂ∞±ÂèòÊàêÂ∑¶Âè≥ÁöÑ‰∫ÜÔºö [info] Â∑¶Âè≥Â∏ÉÂ±ÄÁöÑÁî®ÈÄî ÂØπ‰∫éÊï∞ÊçÆÈáèÂæàÂ§ßÔºåÂèàÊÉ≥Ë¶ÅÂêåÊó∂ÁúãÂà∞ËØ∑Ê±ÇÂíåËøîÂõûÁöÑÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºåÂ∫îËØ•ÊØîËæÉÊúâÁî®„ÄÇ Â§öÈ¢úËâ≤‰∏ªÈ¢òPosman ÊîØÊåÅ‰∏§Áßç‰∏ªÈ¢òÔºö Ê∑±Ëâ≤‰∏ªÈ¢ò ÂΩìÂâçÊòØÊ∑±Ëâ≤‰∏ªÈ¢òÔºåÊïàÊûúÂæà‰∏çÈîôÔºö ÊµÖËâ≤‰∏ªÈ¢ò ÂèØ‰ª•ÂàáÊç¢Âà∞ ÊµÖËâ≤‰∏ªÈ¢òÔºö API ÊñáÊ°£ÁîüÊàêÂú®ÊúçÂä°Á´ØÂêéÂè∞ÁöÑÂºÄÂèë‰∫∫ÂëòÊµãËØïÂ•Ω‰∫ÜÊé•Âè£ÂêéÔºåÊâìÁÆóÊääÊé•Âè£ÁöÑÂêÑÁßç‰ø°ÊÅØÂèëÁªô‰ΩøÁî®Ê≠§ API ÁöÑÂâçÁ´ØÁöÑÁßªÂä®Á´Ø‰∫∫ÂëòÊó∂ÔºåÂæÄÂæÄ‰ºöÈÅáÂà∞Ôºö Ë¶Å‰πàÊòØÁî®Â§çÂà∂Á≤òË¥¥ -&gt; Ê†ºÂºè‰∏çÂèãÂ•Ω Ë¶Å‰πàÊòØÁî® Postman ‰∏≠Êà™Âõæ -&gt; Êñπ‰æøÁúãÔºå‰ΩÜÊòØ‰∏çÊñπ‰æøËé∑Âæó API Êé•Âè£ÂíåÂ≠óÊÆµÁ≠âÊñáÂ≠óÂÜÖÂÆπ Ë¶Å‰πàÊòØÁî® Postman ‰∏≠ÂØºÂá∫‰∏∫ JSON -&gt; json Êñá‰ª∂‰∏≠‰ø°ÊÅØÂ§™ÁπÅÊùÇÔºå‰∏çÂà©‰∫éÊâæÂà∞ÊâÄÈúÄË¶ÅÁöÑ‰ø°ÊÅØ Ë¶Å‰πàÊòØÁî®ÊñáÊ°£ÔºåÊØîÂ¶ÇÂéªÁºñÂÜô Markdown ÊñáÊ°£ -&gt; ‰ΩÜÂêéÁª≠ API ÁöÑÂèòÊõ¥ÈúÄË¶ÅÂÆûÊó∂ÂêåÊ≠•‰øÆÊîπÊñáÊ°£Ôºå‰πü‰ºöÂæàÈ∫ªÁÉ¶ ËøôÈÉΩ‰ºöÂØºËá¥Âà´‰∫∫Êü•ÁúãÂíå‰ΩøÁî® API Êó∂Âæà‰∏çÊñπ‰æø„ÄÇ -&gt; ÂØπÊ≠§ÔºåPostman Êèê‰æõ‰∫ÜÂèëÂ∏É API È¢ÑËßàÂíåÂèëÂ∏É API ÊñáÊ°£ ‰∏ãÈù¢‰ªãÁªç Postman ‰∏≠Â¶Ç‰ΩïÈ¢ÑËßàÂíåÂèëÂ∏É API ÊñáÊ°£„ÄÇ ÁÆÄË¶ÅÊ¶ÇËø∞Ê≠•È™§ Collection Èº†Ê†áÁßªÂä®Âà∞Êüê‰∏™ CollectionÔºåÁÇπÂáª ‰∏â‰∏™ÁÇπ Publish Docs Publish ÂæóÂà∞ Public URL Âà´‰∫∫ÊâìÂºÄËøô‰∏™ Public URLÔºåÂç≥ÂèØÊü•Áúã API ÊñáÊ°£ È¢ÑËßà API ÊñáÊ°£ÁÇπÂáªÂàÜÁªÑÂè≥ËæπÁöÑÂ§ß‰∫éÂè∑&gt; Â¶ÇÊûúÂè™ÊòØÈ¢ÑËßàÔºåÊØîÂ¶ÇÂêéÂè∞ÂºÄÂèëÂëòËá™Â∑±Êü•Áúã API ÊñáÊ°£ÁöÑËØùÔºåÂèØ‰ª•ÈÄâÊã©ÔºöView in web Á≠â‰ª∑‰∫éÁÇπÂáªPublish DocsÂéªÂèëÂ∏ÉÔºö View in Web ÂêéÔºåÊúâ Publish ÁöÑÈÄâÈ°πÔºàËßÅÂêéÈù¢ÁöÑÊà™ÂõæÔºâ View in Web ÂêéÔºå‰ºöÊâìÂºÄÈ¢ÑËßàÈ°µÈù¢Ôºö ÊØîÂ¶ÇÔºö Â•∂Áâõ‰∫ë 1https://documenter.getpostman.com/collection/view/669382-42273840-6237-dbae-5455-26b16f45e2b9 ËÄåÂè≥ËæπÁöÑÁ§∫‰æã‰ª£Á†ÅÔºå‰πüÂèØ‰ª•‰ªéÈªòËÆ§ÁöÑ cURL Êç¢ÊàêÂÖ∂‰ªñÁöÑÔºö ÂèëÂ∏É API ÊñáÊ°£Â¶ÇÊûúÊÉ≥Ë¶ÅËÆ©ÂÖ∂‰ªñ‰∫∫ËÉΩÁúãÂà∞Ëøô‰∏™ÊñáÊ°£ÔºåÂàôÁÇπÂáª PublishÔºö ÁÑ∂Âêé‰ºöÊâìÂºÄÁ±ª‰ºº‰∫éËøôÊ†∑ÁöÑÂú∞ÂùÄÔºö Postman Documenter 1https://documenter.getpostman.com/collection/publish?meta=Y29sbGVjdGlvbl9pZD00MjI3Mzg0MC02MjM3LWRiYWUtNTQ1NS0yNmIxNmY0NWUyYjkmb3duZXI9NjY5MzgyJmNvbGxlY3Rpb25fbmFtZT0lRTUlQTUlQjYlRTclODklOUIlRTQlQkElOTE= ÁÇπÂáª Publish ÂêéÔºåÂèØ‰ª•ÁîüÊàêÂØπÂ∫îÁöÑÂÖ¨ÂºÄÁöÑÁΩëÈ°µÂú∞ÂùÄÔºö ÊâìÂºÄ API Êé•Âè£ÊñáÊ°£Âú∞ÂùÄÔºö 1https://documenter.getpostman.com/view/669382/collection/77fd4RM Âç≥ÂèØÁúãÂà∞ÔºàÂíåÂâçÈù¢È¢ÑËßà‰∏ÄÊ†∑ÊïàÊûúÁöÑ API ÊñáÊ°£‰∫ÜÔºâÔºö Â¶ÇÊ≠§ÔºåÂà´‰∫∫Âç≥ÂèØÊü•ÁúãÂØπÂ∫îÁöÑ API Êé•Âè£ÊñáÊ°£„ÄÇ Â∑≤ÂèëÂ∏ÉÁöÑ API ÊñáÊ°£ÊîØÊåÅËá™Âä®Êõ¥Êñ∞ÂêéÁª≠Â¶ÇÊûúËá™Â∑±ÁöÑ API Êé•Âè£‰øÆÊîπÂêéÔºö ÊØîÂ¶ÇÔºö ÔºàÂêéÊù•ÂèëÁé∞Ôºå‰∏çÁî®ÂÜçÂéªËøõÂÖ•Ê≠§È¢ÑËßàÂíåÂèëÂ∏ÉÁöÑÊµÅÁ®ãÔºåÂéªÊõ¥Êñ∞ÊñáÊ°£ÔºåËÄåÊòØ Postman Ëá™Âä®ÊîØÊåÅÔºâ Âà´‰∫∫ÂéªÂà∑Êñ∞ËØ•ÊñáÊ°£ÁöÑÈ°µÈù¢Ôºö 1https://documenter.getpostman.com/view/669382/collection/77fd4RM Âç≥ÂèØÁúãÂà∞Êõ¥Êñ∞ÂêéÁöÑÂÜÖÂÆπÔºö ÂèÇËÄÉËµÑÊñô ‰∏ªË¶ÅÂèÇËÄÉÔºöGithub: api_tool_postman Manage environments postman-ÂèòÈáè/ÁéØÂ¢É/ËøáÊª§Á≠â - ÁÆÄ‰π¶ Postman ‰ΩøÁî®ÊâãÂÜå 3‚Äî‚ÄîÁéØÂ¢ÉÂèòÈáè - ÁÆÄ‰π¶ postman ‰ΩøÁî®‰πãÂõõÔºöÂàáÊç¢ÁéØÂ¢ÉÂíåËÆæÁΩÆËØªÂèñÂèòÈáè - ‰πîÂè∂Âè∂ - ÂçöÂÆ¢Âõ≠]]></content>
      <categories>
        <category>Â∑•ÂÖ∑</category>
      </categories>
      <tags>
        <tag>postman</tag>
        <tag>Â∑•ÂÖ∑</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊäÄÊúØÂë®Âàä‰πãinfluxDB‰ΩøÁî®ÂÖ•Èó®]]></title>
    <url>%2F2018%2F12%2F08%2F%E6%8A%80%E6%9C%AF%E5%91%A8%E5%88%8A%E4%B9%8BinfluxDB%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄInfluxDBÊòØ‰∏Ä‰∏™Áî®‰∫éÂ≠òÂÇ®ÂíåÂàÜÊûêÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÁöÑÂºÄÊ∫êÊï∞ÊçÆÂ∫ì„ÄÇ ‰∏ªË¶ÅÁâπÊÄßÊúâÔºö ÂÜÖÁΩÆHTTPÊé•Âè£Ôºå‰ΩøÁî®Êñπ‰æø Êï∞ÊçÆÂèØ‰ª•ÊâìÊ†áËÆ∞ÔºåÊü•ËÆ©Êü•ËØ¢ÂèØ‰ª•ÂæàÁÅµÊ¥ª Á±ªSQLÁöÑÊü•ËØ¢ËØ≠Âè• ÂÆâË£ÖÁÆ°ÁêÜÂæàÁÆÄÂçïÔºåÂπ∂‰∏îËØªÂÜôÊï∞ÊçÆÂæàÈ´òÊïà ËÉΩÂ§üÂÆûÊó∂Êü•ËØ¢ÔºåÊï∞ÊçÆÂú®ÂÜôÂÖ•Êó∂Ë¢´Á¥¢ÂºïÂêéÂ∞±ËÉΩÂ§üË¢´Á´ãÂç≥Êü•Âá∫ ‚Ä¶‚Ä¶ Âú®ÊúÄÊñ∞ÁöÑDB-ENGINESÁªôÂá∫ÁöÑÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂ∫ìÁöÑÊéíÂêç‰∏≠ÔºåInfluxDBÈ´òÂ±ÖÁ¨¨‰∏Ä‰ΩçÔºåÂèØ‰ª•È¢ÑËßÅÔºåInfluxDB‰ºöË∂äÊù•Ë∂äÂæóÂà∞ÂπøÊ≥õÁöÑ‰ΩøÁî®„ÄÇ influxDB‰ΩøÁî®goËØ≠Ë®ÄÁºñÂÜôÔºåÈááÁî®‰∫ÜSQL likeÁöÑËØ≠Ê≥ïÔºåÈùûÂ∏∏ÁÅµÊ¥ªÈ´òÊïàÔºåÂ¶ÇÊûú‰Ω†ÁöÑÊï∞ÊçÆÊòØ‰∏éÊó∂Èó¥Áõ∏ÂÖ≥ÁöÑÔºåÈÇ£‰πà‰ΩøÁî®influxDBÂÅöÊï∞ÊçÆÂèØËßÜÂåñÊòØÊúÄÂêàÈÄÇ‰∏çËøáÁöÑÔºåÂ∞§ÂÖ∂ÊòØinfluxDBËá™Ë∫´Â∞±Êèê‰æõÊï∞ÊçÆÂ∫ìCRUDÊâÄÈúÄË¶ÅÁöÑAPIÔºåËôΩÁÑ∂‰∏çÊòØRESTFulÁöÑÔºå‰ΩÜÊòØ‰πüÁúÅÂéª‰∫ÜÁºñÂÜôÂêéÁ´ØÊé•Âè£ÁöÑÂäõÊ∞î„ÄÇ ‰∏ãÈù¢‰ªéinfluxDBÁöÑÂÆâË£Ö„ÄÅ‰ΩøÁî®CLIÁöÑinfluxdbÂü∫Êú¨Êìç‰Ωú„ÄÅ‰ΩøÁî®APIÂØπinfluxdbÊìç‰ΩúÂèägolang‰ª£Á†ÅÂÆûÁé∞„ÄÅÁªèÂéÜÁöÑÂùëÔºåÂá†‰∏™ÊñπÈù¢ÂàÜ‰∫´influxDBÁöÑÂÖ•Èó®ÁªèÂéÜ„ÄÇ ÂÆâË£Ö Êú¨Ê¨°ÂÆâË£ÖÁöÑÁéØÂ¢ÉÊòØÔºö CentOS 7 ÂÜÖÊ†∏ÁâàÊú¨Ôºö4.4.135-1.el7.elrepo.x86_64 Áõ¥Êé•‰ΩøÁî®yumÂÆâË£Ö 123456789cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/influxdb.repo # ËæìÂÖ•influxDBÁöÑrepoURLÂú∞ÂùÄÁ≠â‰ø°ÊÅØ[influxdb] name = InfluxDB Repository - RHEL \$releasever baseurl = https://repos.influxdata.com/rhel/\$releasever/\$basearch/stable enabled = 1 gpgcheck = 1 gpgkey = https://repos.influxdata.com/influxdb.key EOF #EOFÊòØÊñáÊú¨ÁöÑÁªìÊùüÁ¨¶ 1sudo yum install influxdb influxd config ÂÆâË£ÖÂÆåÊàêÂêé‰ΩøÁî®ËØ•ÂëΩ‰ª§Êü•ÁúãinfluxDBÁöÑÈÖçÁΩÆÂÜÖÂÆπÔºådefaultÁöÑconfigÊñá‰ª∂Ë∑ØÂæÑÂú®Ôºö/etc/influxdb/influxdb.conf ÂêØÂä®influxDB 12345[root@k8s-m1 ~]# influxConnected to http://localhost:8086 version 1.7.1InfluxDB shell version: 1.7.1Enter an InfluxQL query&gt; Âà∞Ê≠§ÂÆåÊàê‰∫ÜinfluxDBÁöÑÂÆâË£ÖÔºåÊé•‰∏ãÊù•Êàë‰ª¨ÂÅöÂü∫Êú¨ÁöÑÈÖçÁΩÆ„ÄÇ ÈÖçÁΩÆ Áî®Êà∑ÁÆ°ÁêÜ 12345678910-- ÂàõÂª∫‰∏Ä‰∏™ÁÆ°ÁêÜÂëòÁî®Êà∑CREATE USER "admin" WITH PASSWORD 'xxxx' WITH ALL PRIVILEGES-- ÂàõÂª∫‰∏Ä‰∏™ÊôÆÈÄöÁî®Êà∑CREATE USER "user" WITH PASSWORD 'xxxxx'-- ‰∏∫Áî®Êà∑ÊéàÊùÉËØªÊùÉÈôêGRANT READ ON [database] to "user"-- ‰∏∫Áî®Êà∑ÊéàÊùÉÂÜôÊùÉÈôêGRANT WRITE ON [database] to "user"--------------------- # ÈúÄË¶Å‰øÆÊîπInfluxDBÁöÑÈÖçÁΩÆÊñá‰ª∂/etc/influxdb/influxdb.confÔºåËÆæÁΩÆhttp‰∏ãÁöÑauth-enabled = trueÔºåÈáçÂêØÂêéÔºå‰ΩøÁî®influxÂëΩ‰ª§ÁôªÂΩïÊï∞ÊçÆÂ∫ìÂ∞±ÈúÄË¶ÅÁî®Êà∑ÂêçÂíåÂØÜÁ†Å‰∫Ü„ÄÇÔºàInfluxÂëΩ‰ª§ÂÆûÈôÖ‰∏ä‰πüÊòØ‰ΩøÁî®APIÊù•Êìç‰ΩúInfluxDBÁöÑÔºåInfluxDBÂè™Êèê‰æõ‰∫ÜAPIÊé•Âè£Ôºâ Êü•ÁúãÁî®Êà∑ 123456&gt; show usersuser admin---- -----admin truesjhan true&gt; influxDBÁöÑÈÖçÁΩÆÈ°πÁõÆÊúâÂæàÂ§öÔºåÂâ©‰∏ãÁöÑÂèØ‰ª•Ê†πÊçÆËá™Â∑±ÁöÑÈúÄÊ±ÇÁªßÁª≠Á†îÁ©∂ÔºåËøôÈáåÂ∞±‰∏çÂ±ïÂºÄ‰∫Ü„ÄÇ Âú®ËøõË°åÊï∞ÊçÆÂ∫ìÂü∫Êú¨Êìç‰Ωú‰πãÂâçÊàë‰ª¨ÂøÖÈ°ª‰∫ÜËß£‰∏Ä‰∏ãinfuxDBÁöÑ‰∏Ä‰∫õÂü∫Êú¨Ê¶ÇÂøµ influxDBÂü∫Êú¨Ê¶ÇÂøµ influxDBÈáåÈù¢ÊúÄÂü∫Êú¨ÁöÑÊ¶ÇÂøµÂ∞±ÊòØÔºåmeasurementÔºåtagsÔºåfieldsÔºåpoints„ÄÇÊàë‰ª¨ÂèØ‰ª•Á±ªÊØî‰∫éMySQLÊù•ÁêÜËß£ËøôÂá†‰∏™Â≠óÊÆµÔºö measurementÁ±ª‰ºº‰∫éSQL‰∏≠ÁöÑtableÔºõ tagsÁ±ª‰ººSQL‰∏≠ÁöÑË¢´Á¥¢ÂºïÁöÑÂàóÔºõ fieldsÁ±ª‰ºº‰∫éSQL‰∏≠Ê≤°ÊúâË¢´Á¥¢ÂºïÁöÑÂàóÔºõ pointsÂØπÂ∫îSQLÁöÑtable‰∏≠ÁöÑÊØèË°åÊï∞ÊçÆ„ÄÇ Áü•ÈÅì‰∫ÜËøôÂá†‰∏™Ê¶ÇÂøµÔºå‰æøÂèØ‰ª•ÁªßÁª≠ÂæÄ‰∏ãËøõË°åÔºåÂ¶ÇÈúÄÊõ¥Âä†ËØ¶ÁªÜÁöÑÊñáÊ°£ÔºåËã±ÊñáÁâàÊñáÊ°£ÁåõÊà≥ËøôÈáåÔºåÂΩìÁÑ∂‰πüÊúâ‰∏≠ÊñáÁâàÔºåÁåõÊà≥ËøôÈáå„ÄÇ‰∏çÁü•‰∏∫‰Ωï‰∏≠ÊñáÁâàÊàëÂè™ÊúâÁï™Ëî∑ÊâçËÉΩËÆøÈóÆ„ÄÇ influxDBÂü∫Êú¨Êìç‰Ωú È¶ñÂÖàÔºåË∑üMySQL‰∏ÄÊ†∑ÔºåÊàë‰ª¨ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™Êï∞ÊçÆÂ∫ì 12345-- ÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºåÈªòËÆ§ËÆæÁΩÆCREATE DATABASE &quot;first_db&quot;-- ÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºåÂêåÊó∂ÂàõÂª∫‰∏Ä‰∏™Retention PolicyÔºåÊï∞ÊçÆ‰øùÁïôÊó∂Èó¥ÊèèËø∞-- Retention PolicyÂêÑÈÉ®ÂàÜÊèèËø∞ÔºöDURATION‰∏∫Êï∞ÊçÆÂ≠òÂÇ®Êó∂ÈïøÔºå‰∏ãÈù¢ÁöÑ1dÂç≥Âè™Â≠ò1Â§©ÁöÑÊï∞ÊçÆÔºõREPLICATION‰∏∫Êï∞ÊçÆÂâØÊú¨Ôºå‰∏ÄËà¨Âú®‰ΩøÁî®ÈõÜÁæ§ÁöÑÊó∂ÂÄôÊâç‰ºöËÆæÁΩÆ‰∏∫&gt;1ÔºõSHARD DURATION‰∏∫ÂàÜÂå∫Èó¥ÈöîÔºåInfluxDBÈªòËÆ§ÂØπÊï∞ÊçÆÂàÜÂå∫ÔºåÂ°´ÂÜô30mÂç≥ÂØπÊï∞ÊçÆÊØèÈöî30ÂàÜÈíüÂÅö‰∏Ä‰∏™Êñ∞ÁöÑÂàÜÂå∫ÔºõNameÊòØRPÁöÑÂêçÂ≠ó„ÄÇCREATE DATABASE &quot;first_db&quot; WITH DURATION 1d REPLICATION 1 SHARD DURATION 30m NAME &quot;myrp&quot; Êàë‰ª¨ÂàõÂª∫‰∫Ü‰∏Ä‰∏™influxDBÁöÑÊï∞ÊçÆÂ∫ìÔºåÂêçÂ≠ó‰∏∫first_db, Êï∞ÊçÆÂ≠òÂÇ®Êó∂Èó¥‰∏∫‰∏ÄÂ§©Ôºå‰∏Ä‰∏™ÂâØÊú¨ÔºåÊØè30ÂàÜÈíüÂÅö‰∏Ä‰∏™Êñ∞ÁöÑÂàÜÂå∫„ÄÇ influxDBÊèíÂÖ•Êï∞ÊçÆ influx -username admin -password Êàë‰ª¨ÊèíÂÖ•‰∏ÄÊù°Êï∞ÊçÆÂà∞ÂàöÂàöÂàõÂª∫ÁöÑÊï∞ÊçÆÂ∫ì‰∏≠ 1insert product,productName=disk,usageType=pay,creator=zhangsan,appId=105 cost=3421.6 Êàë‰ª¨ÂàÜÊûê‰∏Ä‰∏ãËøôÊù°ÊèíÂÖ•ËØ≠Âè•ÔºåÂÖ∂‰∏≠productÂ≠óÊÆµÊòØinfluxDB‰∏≠ÁöÑmeasurement,ÂâçÈù¢ËÆ≤Âü∫Êú¨Ê¶ÇÂøµÁöÑÊó∂ÂÄôÂ∑≤ÁªèËß£ÈáäËøáÔºåÁ±ª‰ºº‰∫éMySQL‰∏≠ÁöÑtableÔºå‚ÄúproductName=disk,usageType=pay,creator=zhangsan,appId=105‚ÄùÔºåËøô‰∏ÄÂù®Âú®influxDB‰∏≠Âè´ÂÅötag set,ÂèØ‰ª•ÁêÜËß£‰∏∫tagÁöÑ‰∏Ä‰∏™ÈõÜÂêàÔºåtagÁöÑÁ±ªÂûãÂè™ËÉΩÊòØÂ≠óÁ¨¶‰∏≤ÁöÑK-VÔºåËøòÊúâÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØtag set‰∏éÂâçÈù¢ÁöÑmeasurement‰πãÈó¥Âè™Êúâ‰∏Ä‰∏™ÈÄóÂè∑ÔºåÂπ∂Ê≤°ÊúâÁ©∫Ê†ºÔºÅÔºå‰∏ÄÂºÄÂßã‰∏çÁü•ÈÅìËøôÂõû‰∫ãÔºåÊÄé‰πàÊèíÂÖ•ÈÉΩÊòØÂ§±Ë¥•„ÄÇ‚Äúcost=3421.6‚ÄùËøô‰∏™Âè´ÂÅöfiled setÔºåfiledÁöÑÁ±ªÂûãÂèØ‰ª•ÊòØfloat„ÄÅboolean„ÄÅinteger„ÄÇËøôÊ†∑ÊèíÂÖ•ÁöÑ‰∏ÄÊù°Êï∞ÊçÆÔºåinfluxDB‰∏≠Âè´ÂÅö‰∏Ä‰∏™point„ÄÇ Êü•ËØ¢Êìç‰Ωú Êü•ËØ¢‰πãÂâçË¶ÅÈÄâÊã©‰Ω†ÊÉ≥Êü•ËØ¢ÁöÑÊï∞ÊçÆÂ∫ì 1use first_db 1select * from product ÂèØ‰ª•ÁúãÂà∞influxDBËá™Âä®‰∏∫Êàë‰ª¨ÁöÑËøô‰∏™pointÂä†‰∫Ü‰∏Ä‰∏™timestampÔºåËøô‰∏™ÊòØÊï∞ÊçÆÁöÑUNIXÊó∂Èó¥Ê†ºÂºèÁöÑÊó∂Èó¥Á≤æÂ∫¶ÔºåÊàë‰ª¨Âú®ÂêØÂä®Êï∞ÊçÆÂ∫ìÊó∂ÂèØ‰ª•ÂÆö‰πâËøô‰∏™precisionÔºåÂÉè‰∏ãÈù¢ËøôÊ†∑ 1influx --precision rfc3339 influxDBËßÑÂÆö‰∫ÜÂæàÂ§öÊó∂Èó¥Á≤æÂ∫¶ÔºåÂÖ∑‰ΩìÂèØ‰ª•Âú®ÂëΩ‰ª§Ë°åËæìÂá∫helpÊü•Áúã 12precision &lt;format&gt; specifies the format of the timestamp: rfc3339, h, m, s, ms, u or ns# ÂèØÊåáÂÆöÁöÑÊó∂Èó¥Á≤æÂ∫¶ ‰ΩøÁî®influxDBÂÜÖÁΩÆCLIÊâßË°åÊü•ËØ¢Êìç‰Ωú ËøòÊòØÊü•ËØ¢Êàë‰ª¨ÂàöÂàöÊèíÂÖ•ÁöÑÈÇ£Êù°Êï∞ÊçÆ,Âú®ÂëΩ‰ª§Ë°å‰∏≠ËæìÂÖ•‰ª•‰∏ãÂëΩ‰ª§ 1curl -G 'http://localhost:8086/query?pretty=true' --data-urlencode "db=first_db" --data-urlencode "q=SELECT \"cost\" FROM \"product\" WHERE \"productName\"='disk'" ÂæóÂà∞ËæìÂá∫‰∏∫jsonÁªìÊûÑÁöÑÊü•ËØ¢ÁªìÊûú influxDBÂÜÖÁΩÆÁöÑAPIÂæàÂ§ßÁ®ãÂ∫¶ÁÆÄÂåñ‰∫ÜÂêéÁ´ØÁöÑÂºÄÂèëÔºå‰ΩøÂêÑÁßçÈ°πÁõÆÂèØ‰ª•Âø´ÈÄü‰∏äÁ∫ø„ÄÇ ÊèíÂÖ•Êìç‰ΩúÁöÑAPI Âú®ÂëΩ‰ª§Ë°å‰∏≠ËæìÂÖ• 12curl -i -XPOST 'http://localhost:8086/write?db=first_db' --data-binary 'weather,location=us-midwes temperature=125'# ÊèíÂÖ•‰∏ÄÊù°Êï∞ÊçÆÔºåmeasurement=weatherÔºåtag=locationÔºåfiled=temperature,Êó∂Èó¥Êà≥‰∏∫ÂΩìÂú∞ÊúçÂä°Âô®Êó∂Èó¥ Êàë‰ª¨‰ΩøÁî®postmanÊµãËØïËøô‰∏™ÊèíÂÖ•Êé•Âè£Ôºå‰ª•Á°ÆÂÆöËØ•Êé•Âè£ÁöÑheaderÔºåbodyÁ≠âÔºå‰∏∫Êé•‰∏ãÊù•‰ΩøÁî®goÁºñÂÜôËØ∑Ê±Ç‰ª£Á†ÅÂÅöÂ•ΩÂáÜÂ§á„ÄÇÈÄöËøáÂàÜÊûêURLÔºåÊàë‰ª¨ÂèØÁü•ËØ∑Ê±ÇÁöÑparamÊòØdb=first_dbÔºå‚Äìdat-binaryËøô‰∏™ÂèÇÊï∞ÔºåÊÑèÂë≥ÁùÄ‰Ω†ÁöÑrequest bodyÂøÖÈ°ªÊòØraw,ËÄå‰∏îheaderÁöÑcontent-Type=‚Äùtext‚Äù,ÂÖ∑‰ΩìÁöÑpostmanËÆæÁΩÆÂèÇÁÖß‰∏ãÂõæÔºö ÁÇπÂáªSend‰πãÂêéÔºåÂèØ‰ª•Âú®‰∏ãÈù¢ÁúãÂà∞responseÁöÑstatusCodeÊòØ204ÔºåÂú®httpÂçèËÆÆ‰∏≠ÔºåËøô‰∏™Áä∂ÊÄÅÁ†ÅÊÑèÊÄùÊòØËøîÂõû‰Ωì‰∏≠Ê≤°ÊúâÂÜÖÂÆπ„ÄÇ Êàë‰ª¨ÂõûÂà∞influxDBÁöÑterminal‰∏≠Êü•Áúã‰∏Ä‰∏ãÔºåÂèØ‰ª•ÁúãÂà∞ËøôÊù°Êï∞ÊçÆÂ∑≤ÁªèÊèíÂÖ•ÊàêÂäü‰∫Ü„ÄÇ GOÊìç‰ΩúinfluxDBÁöÑAPIÂÆûÁé∞ÊèíÂÖ•Êï∞ÊçÆ ÂèØ‰ª•Âà©Áî®ËøôÊ†∑Êñπ‰æøÁöÑAPIÔºåÁºñÂÜô‰ª£Á†ÅÔºåÂÆûÁé∞Êï∞ÊçÆÁöÑÊâπÈáèÈááÈõÜ„ÄÅÁÆ°ÁêÜ„ÄÅÂ±ïÁ§∫ÔºåËøôÈáåÊàëÁî®GOÂØπÊèíÂÖ•Êï∞ÊçÆÁöÑÊìç‰ΩúÁÆÄÂçïÂÆûÁé∞„ÄÇ 1234567891011func main() &#123; reqBody := "weather,location=us-midwes temperature=521 1475839730100400200" rb := []byte(reqBody) headers := map[string]string&#123; "Content-type": "text", &#125; resp, _,err := simpleHttpClient.DoRequest("POST","http://10.18.5.30:8086/write?db=first_db",headers,rb,10) if err != nil &#123; panic(err) &#125; fmt.Println(string(resp)) ‰ΩøÁî®ÁöÑDoRequestÊñπÊ≥ïÊù•Ëá™ËøôÈáåÔºåËøô‰∏™Â∫ìÂØπgolangÁöÑhttpÊìç‰ΩúËøõË°åÁÆÄÂçïÁöÑÂ∞ÅË£ÖÔºåËÄå‰∏îÂä†ÂÖ•‰∫ÜÈîôËØØÂ§ÑÁêÜÔºåtimeoutÂºÇÂ∏∏Ê£ÄÊµãÁ≠â„ÄÇ ÂΩìÁÑ∂‰πüÂèØ‰ª•‰ΩøÁî®GoËá™Â∏¶ÁöÑnet/httpÂåÖ‰∏≠ÁöÑPOSTÊñπÊ≥ï 12345678reqBody := "weather,location=us-midwes temperature=521 1475839730100400200" //rb := []byte(reqBody) rb := io.NewReader(reqBody) resp, err := http.Post("http://10.18.5.30:8086/write?db=first_db","text",rb) if err != nil &#123; panic(err) &#125; fmt.Println(string(resp)) ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÂØπrequest bodyÁöÑÁ±ªÂûãÂ§ÑÁêÜÔºånet/http.postÊñπÊ≥ïË¶ÅÊ±ÇËØ•ÂèÇÊï∞ÁöÑÁ±ªÂûãÊòØio.readerÔºåÊâÄ‰ª•Ë¶Å‰ΩøÁî®io.NewReader()ËøõË°åËΩ¨Êç¢„ÄÇ ÊÄªÁªì ‰ª•‰∏äÂ∞±ÊòØÂØπinfluxDBÁöÑÂÖ•Èó®‰ªãÁªçÔºåÂåÖÊã¨Âü∫Êú¨Ê¶ÇÂøµÔºåÂÆâË£ÖÔºåÈÖçÁΩÆÔºåÂü∫Êú¨Êìç‰ΩúÔºàCLIÔºåAPIÔºâ‰ª•Âèä‰ΩøÁî®GOÁºñÂÜôÊìç‰ΩúÊï∞ÊçÆÂ∫ìÁöÑ‰ª£Á†Å„ÄÇ‰ΩÜinfluxDBÁöÑÂ••ÁßòËøú‰∏çÊ≠¢Ëøô‰∫õÔºåÂ¶ÇÈúÄÊõ¥Âä†Ê∑±ÂÖ•ÁöÑÁ†îÁ©∂ÂèØÂèÇÈòÖÂÆòÊñπÊñáÊ°£„ÄÇ]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>ÊäÄÊúØÂë®Âàä</tag>
        <tag>influxDB</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[(ËΩ¨ËΩΩ)golangËØ≠Ë®ÄÂπ∂Âèë‰∏éÂπ∂Ë°å‚Äî‚ÄîgoroutineÂíåchannelÁöÑËØ¶ÁªÜÁêÜËß£(2)]]></title>
    <url>%2F2018%2F12%2F07%2F%E8%BD%AC%E8%BD%BD-golang%E8%AF%AD%E8%A8%80%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C%E2%80%94%E2%80%94goroutine%E5%92%8Cchannel%E7%9A%84%E8%AF%A6%E7%BB%86%E7%90%86%E8%A7%A3-2%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáËΩ¨ËΩΩËá™ÔºåÁâàÊùÉÂ±û‰∫éÂéü‰ΩúËÄÖ„ÄÇ GoËØ≠Ë®ÄÁöÑÂπ∂ÂèëÂíåÂπ∂Ë°å‰∏çÁü•ÈÅì‰Ω†ÊúâÊ≤°ÊúâÊ≥®ÊÑèÂà∞‰∏Ä‰∏™Áé∞Ë±°ÔºåËøòÊòØËøôÊÆµ‰ª£Á†ÅÔºåÂ¶ÇÊûúÊàëË∑ëÂú®‰∏§‰∏™goroutinesÈáåÈù¢ÁöÑËØù: 12345678910111213141516171819var quit chan int = make(chan int)func loop() &#123; for i := 0; i &lt; 10; i++ &#123; fmt.Printf(&quot;%d &quot;, i) &#125; quit &lt;- 0&#125;func main() &#123; // ÂºÄ‰∏§‰∏™goroutineË∑ëÂáΩÊï∞loop, loopÂáΩÊï∞Ë¥üË¥£ÊâìÂç∞10‰∏™Êï∞ go loop() go loop() for i := 0; i &lt; 2; i++ &#123; &lt;- quit &#125;&#125; Êàë‰ª¨ËßÇÂØü‰∏ãËæìÂá∫: 10 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 ËøôÊòØ‰∏çÊòØÊúâ‰ªÄ‰πàÈóÆÈ¢òÔºü? ‰ª•ÂâçÊàë‰ª¨Áî®Á∫øÁ®ãÂéªÂÅöÁ±ª‰ºº‰ªªÂä°ÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªüÁöÑÁ∫øÁ®ã‰ºöÊä¢Âç†ÂºèÂú∞ËæìÂá∫Ôºå Ë°®Áé∞Âá∫Êù•ÁöÑÊòØ‰π±Â∫èÂú∞ËæìÂá∫„ÄÇËÄågoroutine‰∏∫‰ªÄ‰πàÊòØËøôÊ†∑ËæìÂá∫ÁöÑÂë¢Ôºü goroutineÊòØÂú®Âπ∂Ë°åÂêóÔºüÊàë‰ª¨Êâæ‰∏™‰æãÂ≠êÊµãËØï‰∏ã: 1234567891011121314151617181920212223242526package mainimport &quot;fmt&quot;import &quot;time&quot;var quit chan intfunc foo(id int) &#123; fmt.Println(id) time.Sleep(time.Second) // ÂÅúÈ°ø‰∏ÄÁßí quit &lt;- 0 // ÂèëÊ∂àÊÅØÔºöÊàëÊâßË°åÂÆåÂï¶ÔºÅ&#125;func main() &#123; count := 1000 quit = make(chan int, count) // ÁºìÂÜ≤1000‰∏™Êï∞ÊçÆ for i := 0; i &lt; count; i++ &#123; //ÂºÄ1000‰∏™goroutine go foo(i) &#125; for i :=0 ; i &lt; count; i++ &#123; // Á≠âÂæÖÊâÄÊúâÂÆåÊàêÊ∂àÊÅØÂèëÈÄÅÂÆåÊØï„ÄÇ &lt;- quit &#125;&#125; ËÆ©Êàë‰ª¨Ë∑ë‰∏Ä‰∏ãËøô‰∏™Á®ãÂ∫è(‰πãÊâÄ‰ª•ÂÖàÁºñËØëÂÜçËøêË°åÔºåÊòØ‰∏∫‰∫ÜËÆ©Á®ãÂ∫èË∑ëÁöÑÂ∞ΩÈáèÂø´,ÊµãËØïÁªìÊûúÊõ¥Â•Ω): 123go build test.gotime ./test./test 0.01s user 0.01s system 1% cpu 1.016 total Êàë‰ª¨ÁúãÂà∞ÔºåÊÄªËÆ°Áî®Êó∂Êé•Ëøë‰∏ÄÁßí„ÄÇ Ë≤å‰ººÂπ∂Ë°å‰∫ÜÔºÅ Êàë‰ª¨ÈúÄË¶ÅÈ¶ñÂÖàËÄÉËôë‰∏ã‰ªÄ‰πàÊòØÂπ∂Âèë, ‰ªÄ‰πàÊòØÂπ∂Ë°å Âπ∂Ë°åÂíåÂπ∂Âèë‰ªéÊ¶ÇÂøµ‰∏äËÆ≤ÔºåÂπ∂ÂèëÂíåÂπ∂Ë°åÊòØ‰∏çÂêåÁöÑ, ÁÆÄÂçïÊù•ËØ¥ÁúãËøô‰∏™ÂõæÁâá(ÂéüÂõæÊù•Ëá™ËøôÈáå) ‰∏§‰∏™ÈòüÂàóÔºå‰∏Ä‰∏™CoffeeÊú∫Âô®ÔºåÈÇ£ÊòØÂπ∂Âèë ‰∏§‰∏™ÈòüÂàóÔºå‰∏§‰∏™CoffeeÊú∫Âô®ÔºåÈÇ£ÊòØÂπ∂Ë°å Êõ¥Â§öÁöÑËµÑÊñôÔºö Âπ∂Âèë‰∏çÊòØÂπ∂Ë°å, ÂΩìÁÑ∂Google‰∏äÊúâÊõ¥Â§öÂÖ≥‰∫éÂπ∂Ë°åÂíåÂπ∂ÂèëÁöÑÂå∫Âà´„ÄÇ ÈÇ£‰πàÂõûÂà∞‰∏ÄÂºÄÂßãÁöÑÁñëÈóÆ‰∏äÔºå‰ªé‰∏äÈù¢ÁöÑ‰∏§‰∏™‰æãÂ≠êÊâßË°åÂêéÁöÑË°®Áé∞Êù•ÁúãÔºåÂ§ö‰∏™goroutineË∑ëloopÂáΩÊï∞‰ºöÊå®‰∏™goroutineÂéªËøõË°åÔºåËÄåsleepÂàôÊòØ‰∏ÄËµ∑ÊâßË°åÁöÑ„ÄÇ ËøôÊòØ‰∏∫‰ªÄ‰πàÔºü ÈªòËÆ§Âú∞Ôºå GoÊâÄÊúâÁöÑgoroutinesÂè™ËÉΩÂú®‰∏Ä‰∏™Á∫øÁ®ãÈáåË∑ë „ÄÇ ‰πüÂ∞±ÊòØËØ¥Ôºå ‰ª•‰∏ä‰∏§‰∏™‰ª£Á†ÅÈÉΩ‰∏çÊòØÂπ∂Ë°åÁöÑÔºå‰ΩÜÊòØÈÉΩÊòØÊòØÂπ∂ÂèëÁöÑ„ÄÇ Â¶ÇÊûúÂΩìÂâçgoroutine‰∏çÂèëÁîüÈòªÂ°ûÔºåÂÆÉÊòØ‰∏ç‰ºöËÆ©Âá∫CPUÁªôÂÖ∂‰ªñgoroutineÁöÑ, ÊâÄ‰ª•‰æãÂ≠ê‰∏Ä‰∏≠ÁöÑËæìÂá∫‰ºöÊòØ‰∏Ä‰∏™‰∏Ä‰∏™goroutineËøõË°åÁöÑÔºåËÄåsleepÂáΩÊï∞ÂàôÈòªÂ°ûÊéâ‰∫Ü ÂΩìÂâçgoroutine, ÂΩìÂâçgoroutine‰∏ªÂä®ËÆ©ÂÖ∂‰ªñgoroutineÊâßË°å, ÊâÄ‰ª•ÂΩ¢Êàê‰∫ÜÈÄªËæë‰∏äÁöÑÂπ∂Ë°å, ‰πüÂ∞±ÊòØÂπ∂Âèë„ÄÇ ÁúüÊ≠£ÁöÑÂπ∂Ë°å‰∏∫‰∫ÜËææÂà∞ÁúüÊ≠£ÁöÑÂπ∂Ë°åÔºåÊàë‰ª¨ÈúÄË¶ÅÂëäËØâGoÊàë‰ª¨ÂÖÅËÆ∏ÂêåÊó∂ÊúÄÂ§ö‰ΩøÁî®Â§ö‰∏™Ê†∏„ÄÇ ÂõûÂà∞Ëµ∑ÂàùÁöÑ‰æãÂ≠êÔºåÊàë‰ª¨ËÆæÁΩÆÊúÄÂ§ßÂºÄ2‰∏™ÂéüÁîüÁ∫øÁ®ã, Êàë‰ª¨ÈúÄË¶ÅÁî®Âà∞runtimeÂåÖ(runtimeÂåÖÊòØgoroutineÁöÑË∞ÉÂ∫¶Âô®): 123456789101112131415161718192021222324import ( &quot;fmt&quot; &quot;runtime&quot;)var quit chan int = make(chan int)func loop() &#123; for i := 0; i &lt; 100; i++ &#123; //‰∏∫‰∫ÜËßÇÂØüÔºåË∑ëÂ§ö‰∫õ fmt.Printf(&quot;%d &quot;, i) &#125; quit &lt;- 0&#125;func main() &#123; runtime.GOMAXPROCS(2) // ÊúÄÂ§ö‰ΩøÁî®2‰∏™Ê†∏ go loop() go loop() for i := 0; i &lt; 2; i++ &#123; &lt;- quit &#125;&#125; Ëøô‰∏ã‰ºöÁúãÂà∞‰∏§‰∏™goroutine‰ºöÊä¢Âç†ÂºèÂú∞ËæìÂá∫Êï∞ÊçÆ‰∫Ü„ÄÇ Êàë‰ª¨ËøòÂèØ‰ª•ËøôÊ†∑ÊòæÂºèÂú∞ËÆ©Âá∫CPUÊó∂Èó¥Ôºö 123456789101112131415161718func loop() &#123; for i := 0; i &lt; 10; i++ &#123; runtime.Gosched() // ÊòæÂºèÂú∞ËÆ©Âá∫CPUÊó∂Èó¥ÁªôÂÖ∂‰ªñgoroutine fmt.Printf(&quot;%d &quot;, i) &#125; quit &lt;- 0&#125;func main() &#123; go loop() go loop() for i := 0; i &lt; 2; i++ &#123; &lt;- quit &#125;&#125; ËßÇÂØü‰∏ãÁªìÊûú‰ºöÁúãÂà∞ËøôÊ†∑ÊúâËßÑÂæãÁöÑËæìÂá∫: 10 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 ÂÖ∂ÂÆûÔºåËøôÁßç‰∏ªÂä®ËÆ©Âá∫CPUÊó∂Èó¥ÁöÑÊñπÂºè‰ªçÁÑ∂ÊòØÂú®ÂçïÊ†∏ÈáåË∑ë„ÄÇ‰ΩÜÊâãÂ∑•Âú∞ÂàáÊç¢goroutineÂØºËá¥‰∫ÜÁúã‰∏äÂéªÁöÑ‚ÄúÂπ∂Ë°å‚Äù„ÄÇ ÂÖ∂ÂÆû‰Ωú‰∏∫‰∏Ä‰∏™PythonÁ®ãÂ∫èÂëòÔºågoroutineËÆ©ÊàëÊõ¥Â§öÂú∞ÊÉ≥Âà∞ÁöÑÊòØgeventÁöÑÂçèÁ®ãÔºåËÄå‰∏çÊòØÂéüÁîüÁ∫øÁ®ã„ÄÇ ÂÖ≥‰∫éruntimeÂåÖÂØπgoroutineÁöÑË∞ÉÂ∫¶ÔºåÂú®stackoverflow‰∏äÊúâ‰∏Ä‰∏™‰∏çÈîôÁöÑÁ≠îÊ°à:http://stackoverflow.com/questions/13107958/what-exactly-does-runtime-gosched-do ‰∏Ä‰∏™Â∞èÈóÆÈ¢òÊàëÂú®SegmentfaultÁúãÂà∞‰∫ÜËøô‰∏™ÈóÆÈ¢ò: http://segmentfault.com/q/1010000000207474 È¢òÁõÆËØ¥ÔºåÂ¶Ç‰∏ãÁöÑÁ®ãÂ∫èÔºåÊåâÁÖßÁêÜËß£Â∫îËØ•ÊâìÂç∞‰∏ã5Ê¨° &quot;world&quot;ÂëÄÔºåÂèØÊòØ‰∏∫‰ªÄ‰πà‰ªÄ‰πà‰πüÊ≤°ÊúâÊâìÂç∞ 1234567891011121314151617package mainimport ( &quot;fmt&quot;)func say(s string) &#123; for i := 0; i &lt; 5; i++ &#123; fmt.Println(s) &#125;&#125;func main() &#123; go say(&quot;world&quot;) //ÂºÄ‰∏Ä‰∏™Êñ∞ÁöÑGoroutinesÊâßË°å for &#123; &#125;&#125; Ê•º‰∏ãÁöÑÁ≠îÊ°àÂ∑≤ÁªèÂæàÊ£í‰∫ÜÔºåËøôÈáåGo‰ªçÁÑ∂Âú®‰ΩøÁî®ÂçïÊ†∏ÔºåforÊ≠ªÂæ™ÁéØÂç†ÊçÆ‰∫ÜÂçïÊ†∏CPUÊâÄÊúâÁöÑËµÑÊ∫êÔºåËÄåmainÁ∫øÂíåsay‰∏§‰∏™goroutineÈÉΩÂú®‰∏Ä‰∏™Á∫øÁ®ãÈáåÈù¢Ôºå ÊâÄ‰ª•sayÊ≤°ÊúâÊú∫‰ºöÊâßË°å„ÄÇËß£ÂÜ≥ÊñπÊ°àËøòÊòØ‰∏§‰∏™Ôºö ÂÖÅËÆ∏Go‰ΩøÁî®Â§öÊ†∏(runtime.GOMAXPROCS) ÊâãÂä®ÊòæÂºèË∞ÉÂä®(runtime.Gosched) runtimeË∞ÉÂ∫¶Âô®runtimeË∞ÉÂ∫¶Âô®ÊòØ‰∏™ÂæàÁ•ûÂ•áÁöÑ‰∏úË•øÔºå‰ΩÜÊòØÊàëÁúüÊòØ‰ΩÜÊÑøÂÆÉ‰∏çÂ≠òÂú®ÔºåÊàëÂ∏åÊúõÊòæÂºèË∞ÉÂ∫¶ËÉΩÊõ¥‰∏∫Ëá™ÁÑ∂‰∫õÔºåÂ§öÊ†∏Â§ÑÁêÜÈªòËÆ§ÂºÄÂêØ„ÄÇ ÂÖ≥‰∫éruntimeÂåÖÂá†‰∏™ÂáΩÊï∞: Gosched ËÆ©Âá∫cpu NumCPU ËøîÂõûÂΩìÂâçÁ≥ªÁªüÁöÑCPUÊ†∏Êï∞Èáè GOMAXPROCS ËÆæÁΩÆÊúÄÂ§ßÁöÑÂèØÂêåÊó∂‰ΩøÁî®ÁöÑCPUÊ†∏Êï∞ Goexit ÈÄÄÂá∫ÂΩìÂâçgoroutine(‰ΩÜÊòØdeferËØ≠Âè•‰ºöÁÖßÂ∏∏ÊâßË°å) ÊÄªÁªìÊàë‰ª¨‰ªé‰æãÂ≠ê‰∏≠ÂèØ‰ª•ÁúãÂà∞ÔºåÈªòËÆ§ÁöÑ, ÊâÄÊúâgoroutine‰ºöÂú®‰∏Ä‰∏™ÂéüÁîüÁ∫øÁ®ãÈáåË∑ëÔºå‰πüÂ∞±ÊòØÂè™‰ΩøÁî®‰∫Ü‰∏Ä‰∏™CPUÊ†∏„ÄÇ Âú®Âêå‰∏Ä‰∏™ÂéüÁîüÁ∫øÁ®ãÈáåÔºåÂ¶ÇÊûúÂΩìÂâçgoroutine‰∏çÂèëÁîüÈòªÂ°ûÔºåÂÆÉÊòØ‰∏ç‰ºöËÆ©Âá∫CPUÊó∂Èó¥ÁªôÂÖ∂‰ªñÂêåÁ∫øÁ®ãÁöÑgoroutinesÁöÑÔºåËøôÊòØGoËøêË°åÊó∂ÂØπgoroutineÁöÑË∞ÉÂ∫¶ÔºåÊàë‰ª¨‰πüÂèØ‰ª•‰ΩøÁî®runtimeÂåÖÊù•ÊâãÂ∑•Ë∞ÉÂ∫¶„ÄÇ Êú¨ÊñáÂºÄÂ§¥ÁöÑ‰∏§‰∏™‰æãÂ≠êÈÉΩÊòØÈôêÂà∂Âú®ÂçïÊ†∏CPUÈáåÊâßË°åÁöÑÔºåÊâÄÊúâÁöÑgoroutinesË∑ëÂú®‰∏Ä‰∏™Á∫øÁ®ãÈáåÈù¢ÔºåÂàÜÊûêÂ¶Ç‰∏ã: ÂØπ‰∫é‰ª£Á†Å‰æãÂ≠ê‰∏ÄÔºàloopÂáΩÊï∞ÁöÑÈÇ£‰∏™ÔºâÔºåÊØè‰∏™goroutineÊ≤°ÊúâÂèëÁîüÂ†µÂ°û(Áõ¥Âà∞quitÊµÅÂÖ•Êï∞ÊçÆ), ÊâÄ‰ª•Âú®quit‰πãÂâçÊØè‰∏™goroutine‰∏ç‰ºö‰∏ªÂä®ËÆ©Âá∫CPUÔºå‰πüÂ∞±ÂèëÁîü‰∫Ü‰∏≤Ë°åÊâìÂç∞ ÂØπ‰∫é‰ª£Á†Å‰æãÂ≠ê‰∫åÔºàtimeÁöÑÈÇ£‰∏™ÔºâÔºåÊØè‰∏™goroutineÂú®sleepË¢´Ë∞ÉÁî®ÁöÑÊó∂ÂÄô‰ºöÈòªÂ°ûÔºåËÆ©Âá∫CPU, ÊâÄ‰ª•‰æãÂ≠ê‰∫åÂπ∂ÂèëÊâßË°å„ÄÇ ÈÇ£‰πàÂÖ≥‰∫éÊàë‰ª¨ÂºÄÂêØÂ§öÊ†∏ÁöÑÊó∂ÂÄôÂë¢ÔºüGoËØ≠Ë®ÄÂØπgoroutineÁöÑË∞ÉÂ∫¶Ë°å‰∏∫ÂèàÊòØÊÄé‰πàÊ†∑ÁöÑÔºü Êàë‰ª¨ÂèØ‰ª•Âú®GolangÂÆòÊñπÁΩëÁ´ôÁöÑËøôÈáå ÊâæÂà∞‰∏ÄÂè•ËØù: When a coroutine blocks, such as by calling a blocking system call, the run-time automatically moves other coroutines on the same operating system thread to a different, runnable thread so they won‚Äôt be blocked. ‰πüÂ∞±ÊòØËØ¥: ÂΩì‰∏Ä‰∏™goroutineÂèëÁîüÈòªÂ°ûÔºåGo‰ºöËá™Âä®Âú∞Êää‰∏éËØ•goroutineÂ§Ñ‰∫éÂêå‰∏ÄÁ≥ªÁªüÁ∫øÁ®ãÁöÑÂÖ∂‰ªñgoroutinesËΩ¨ÁßªÂà∞Âè¶‰∏Ä‰∏™Á≥ªÁªüÁ∫øÁ®ã‰∏äÂéªÔºå‰ª•‰ΩøËøô‰∫õgoroutines‰∏çÈòªÂ°û ÂºÄÂêØÂ§öÊ†∏ÁöÑÂÆûÈ™å‰ªçÁÑ∂ÈúÄË¶ÅÂÅö‰∏Ä‰∏™ÂÆûÈ™åÔºåÊù•ÊµãËØï‰∏ãÂ§öÊ†∏ÊîØÊåÅ‰∏ãgoroutinesÁöÑÂØπÂéüÁîüÁ∫øÁ®ãÁöÑÂàÜÈÖç, ‰πüÈ™åËØÅ‰∏ãÊàë‰ª¨ÊâÄÂæóÂà∞ÁöÑÁªìËÆ∫‚Äúgoroutine‰∏çÈòªÂ°û‰∏çÊîæÂºÄCPU‚Äù„ÄÇ ÂÆûÈ™å‰ª£Á†ÅÂ¶Ç‰∏ã: 123456789101112131415161718192021222324252627package mainimport ( &quot;fmt&quot; &quot;runtime&quot;)var quit chan int = make(chan int)func loop(id int) &#123; // id: ËØ•goroutineÁöÑÊ†áÂè∑ for i := 0; i &lt; 10; i++ &#123; //ÊâìÂç∞10Ê¨°ËØ•goroutineÁöÑÊ†áÂè∑ fmt.Printf(&quot;%d &quot;, id) &#125; quit &lt;- 0&#125;func main() &#123; runtime.GOMAXPROCS(2) // ÊúÄÂ§öÂêåÊó∂‰ΩøÁî®2‰∏™Ê†∏ for i := 0; i &lt; 3; i++ &#123; //ÂºÄ‰∏â‰∏™goroutine go loop(i) &#125; for i := 0; i &lt; 3; i++ &#123; &lt;- quit &#125;&#125; Â§öË∑ëÂá†Ê¨°‰ºöÁúãÂà∞Á±ª‰ººËøô‰∫õËæìÂá∫(‰∏çÂêåÊú∫Âô®ÁéØÂ¢É‰∏ç‰∏ÄÊ†∑): 123450 0 0 0 0 1 1 0 0 1 0 0 1 0 1 2 1 2 1 2 1 2 1 2 1 2 2 2 2 20 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 20 0 0 0 0 0 0 1 1 1 1 1 0 1 0 1 0 1 2 1 2 1 2 2 2 2 2 2 2 20 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 0 2 0 2 0 2 2 2 2 2 2 2 20 0 0 0 0 0 0 1 0 0 1 0 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 2 2 ÊâßË°åÂÆÉÊàë‰ª¨‰ºöÂèëÁé∞‰ª•‰∏ãÁé∞Ë±°: ÊúâÊó∂‰ºöÂèëÁîüÊä¢Âç†ÂºèËæìÂá∫(ËØ¥ÊòéGoÂºÄ‰∫Ü‰∏çÊ≠¢‰∏Ä‰∏™ÂéüÁîüÁ∫øÁ®ãÔºåËææÂà∞‰∫ÜÁúüÊ≠£ÁöÑÂπ∂Ë°å) ÊúâÊó∂‰ºöÈ°∫Â∫èËæìÂá∫, ÊâìÂç∞ÂÆå0ÂÜçÊâìÂç∞1, ÂÜçÊâìÂç∞2(ËØ¥ÊòéGoÂºÄ‰∏Ä‰∏™ÂéüÁîüÁ∫øÁ®ãÔºåÂçïÁ∫øÁ®ã‰∏äÁöÑgoroutine‰∏çÈòªÂ°û‰∏çÊùæÂºÄCPU) ÈÇ£‰πàÔºåÊàë‰ª¨Ëøò‰ºöËßÇÂØüÂà∞‰∏Ä‰∏™Áé∞Ë±°ÔºåÊó†ËÆ∫ÊòØÊä¢Âç†Âú∞ËæìÂá∫ËøòÊòØÈ°∫Â∫èÁöÑËæìÂá∫ÔºåÈÉΩ‰ºöÊúâÈÇ£‰πà‰∏§‰∏™Êï∞Â≠óË°®Áé∞Âá∫ËøôÊ†∑ÁöÑÁé∞Ë±°: ‰∏Ä‰∏™Êï∞Â≠óÁöÑÊâÄÊúâËæìÂá∫ÈÉΩ‰ºöÂú®Âè¶‰∏Ä‰∏™Êï∞Â≠óÁöÑÊâÄÊúâËæìÂá∫‰πãÂâç ÂéüÂõ†ÊòØÔºå 3‰∏™goroutineÂàÜÈÖçÂà∞Ëá≥Â§ö2‰∏™Á∫øÁ®ã‰∏äÔºåÂ∞±‰ºöËá≥Â∞ë‰∏§‰∏™goroutineÂàÜÈÖçÂà∞Âêå‰∏Ä‰∏™Á∫øÁ®ãÈáåÔºåÂçïÁ∫øÁ®ãÈáåÁöÑgoroutine ‰∏çÈòªÂ°û‰∏çÊîæÂºÄCPU, ‰πüÂ∞±ÂèëÁîü‰∫ÜÈ°∫Â∫èËæìÂá∫„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[(ËΩ¨ËΩΩ)golangËØ≠Ë®ÄÂπ∂Âèë‰∏éÂπ∂Ë°å‚Äî‚ÄîgoroutineÂíåchannelÁöÑËØ¶ÁªÜÁêÜËß£(1)]]></title>
    <url>%2F2018%2F12%2F07%2F%E8%BD%AC%E8%BD%BD-golang%E8%AF%AD%E8%A8%80%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C%E2%80%94%E2%80%94goroutine%E5%92%8Cchannel%E7%9A%84%E8%AF%A6%E7%BB%86%E7%90%86%E8%A7%A3-1%2F</url>
    <content type="text"><![CDATA[Êú¨ÁØáÂçöÊñáËΩ¨ËΩΩËá™goËØ≠Ë®Ä‰∏≠ÊñáÁΩëÔºåÁâàÊùÉÂ±ûÂéü‰ΩúËÄÖÊâÄÊúâ„ÄÇ Â¶ÇÊûú‰∏çÊòØÊàëÂØπÁúüÊ≠£Âπ∂Ë°åÁöÑÁ∫øÁ®ãÁöÑËøΩÊ±ÇÔºåÂ∞±‰∏ç‰ºöËÆ§ËØÜÂà∞GoÊúâÂ§ö‰πàÁöÑËø∑‰∫∫„ÄÇ GoËØ≠Ë®Ä‰ªéËØ≠Ë®ÄÂ±ÇÈù¢‰∏äÂ∞±ÊîØÊåÅ‰∫ÜÂπ∂ÂèëÔºåËøô‰∏éÂÖ∂‰ªñËØ≠Ë®ÄÂ§ß‰∏ç‰∏ÄÊ†∑Ôºå‰∏çÂÉè‰ª•ÂâçÊàë‰ª¨Ë¶ÅÁî®ThreadÂ∫ì Êù•Êñ∞Âª∫Á∫øÁ®ãÔºåËøòË¶ÅÁî®Á∫øÁ®ãÂÆâÂÖ®ÁöÑÈòüÂàóÂ∫ìÊù•ÂÖ±‰∫´Êï∞ÊçÆ„ÄÇ ‰ª•‰∏ãÊòØÊàëÂÖ•Èó®ÁöÑÂ≠¶‰π†Á¨îËÆ∞„ÄÇ GoËØ≠Ë®ÄÁöÑgoroutines„ÄÅ‰ø°ÈÅìÂíåÊ≠ªÈîÅgoroutineGoËØ≠Ë®Ä‰∏≠Êúâ‰∏™Ê¶ÇÂøµÂè´ÂÅögoroutine, ËøôÁ±ª‰ººÊàë‰ª¨ÁÜüÁü•ÁöÑÁ∫øÁ®ãÔºå‰ΩÜÊòØÊõ¥ËΩª„ÄÇ ‰ª•‰∏ãÁöÑÁ®ãÂ∫èÔºåÊàë‰ª¨‰∏≤Ë°åÂú∞ÂéªÊâßË°å‰∏§Ê¨°loopÂáΩÊï∞: 1234567891011func loop() &#123; for i := 0; i &lt; 10; i++ &#123; fmt.Printf(&quot;%d &quot;, i) &#125;&#125;func main() &#123; loop() loop()&#125; ÊØ´Êó†ÁñëÈóÆÔºåËæìÂá∫‰ºöÊòØËøôÊ†∑ÁöÑ: 10 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 ‰∏ãÈù¢Êàë‰ª¨Êää‰∏Ä‰∏™loopÊîæÂú®‰∏Ä‰∏™goroutineÈáåË∑ëÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂÖ≥ÈîÆÂ≠ógoÊù•ÂÆö‰πâÂπ∂ÂêØÂä®‰∏Ä‰∏™goroutine: 1234func main() &#123; go loop() // ÂêØÂä®‰∏Ä‰∏™goroutine loop()&#125; ËøôÊ¨°ÁöÑËæìÂá∫ÂèòÊàê‰∫Ü: 10 1 2 3 4 5 6 7 8 9 ÂèØÊòØ‰∏∫‰ªÄ‰πàÂè™ËæìÂá∫‰∫Ü‰∏ÄË∂üÂë¢ÔºüÊòéÊòéÊàë‰ª¨‰∏ªÁ∫øË∑ë‰∫Ü‰∏ÄË∂üÔºå‰πüÂºÄ‰∫Ü‰∏Ä‰∏™goroutineÊù•Ë∑ë‰∏ÄË∂üÂïä„ÄÇ ÂéüÊù•ÔºåÂú®goroutineËøòÊ≤°Êù•ÂæóÂèäË∑ëloopÁöÑÊó∂ÂÄôÔºå‰∏ªÂáΩÊï∞Â∑≤ÁªèÈÄÄÂá∫‰∫Ü„ÄÇ mainÂáΩÊï∞ÈÄÄÂá∫Âú∞Â§™Âø´‰∫ÜÔºåÊàë‰ª¨Ë¶ÅÊÉ≥ÂäûÊ≥ïÈòªÊ≠¢ÂÆÉËøáÊó©Âú∞ÈÄÄÂá∫Ôºå‰∏Ä‰∏™ÂäûÊ≥ïÊòØËÆ©mainÁ≠âÂæÖ‰∏Ä‰∏ã: 12345func main() &#123; go loop() loop() time.Sleep(time.Second) // ÂÅúÈ°ø‰∏ÄÁßí&#125; ËøôÊ¨°Á°ÆÂÆûËæìÂá∫‰∫Ü‰∏§Ë∂üÔºåÁõÆÁöÑËææÂà∞‰∫Ü„ÄÇ ÂèØÊòØÈááÁî®Á≠âÂæÖÁöÑÂäûÊ≥ïÂπ∂‰∏çÂ•ΩÔºåÂ¶ÇÊûúgoroutineÂú®ÁªìÊùüÁöÑÊó∂ÂÄôÔºåÂëäËØâ‰∏ã‰∏ªÁ∫øËØ¥‚ÄúHey, ÊàëË¶ÅË∑ëÂÆå‰∫ÜÔºÅ‚ÄùÂ∞±Â•Ω‰∫ÜÔºå Âç≥ÊâÄË∞ìÈòªÂ°û‰∏ªÁ∫øÁöÑÂäûÊ≥ïÔºåÂõûÂøÜ‰∏ãÊàë‰ª¨PythonÈáåÈù¢Á≠âÂæÖÊâÄÊúâÁ∫øÁ®ãÊâßË°åÂÆåÊØïÁöÑÂÜôÊ≥ï: 12for thread in threads: thread.join() ÊòØÁöÑÔºåÊàë‰ª¨‰πüÈúÄË¶Å‰∏Ä‰∏™Á±ª‰ººjoinÁöÑ‰∏úË•øÊù•ÈòªÂ°û‰Ωè‰∏ªÁ∫ø„ÄÇÈÇ£Â∞±ÊòØ‰ø°ÈÅì ‰ø°ÈÅì‰ø°ÈÅìÊòØ‰ªÄ‰πàÔºüÁÆÄÂçïËØ¥ÔºåÊòØgoroutine‰πãÈó¥‰∫íÁõ∏ÈÄöËÆØÁöÑ‰∏úË•ø„ÄÇÁ±ª‰ººÊàë‰ª¨Unix‰∏äÁöÑÁÆ°ÈÅìÔºàÂèØ‰ª•Âú®ËøõÁ®ãÈó¥‰º†ÈÄíÊ∂àÊÅØÔºâÔºå Áî®Êù•goroutine‰πãÈó¥ÂèëÊ∂àÊÅØÂíåÊé•Êî∂Ê∂àÊÅØ„ÄÇÂÖ∂ÂÆûÔºåÂ∞±ÊòØÂú®ÂÅögoroutine‰πãÈó¥ÁöÑÂÜÖÂ≠òÂÖ±‰∫´„ÄÇ ‰ΩøÁî®makeÊù•Âª∫Á´ã‰∏Ä‰∏™‰ø°ÈÅì: 123var channel chan int = make(chan int)// Êàñchannel := make(chan int) ÈÇ£Â¶Ç‰ΩïÂêë‰ø°ÈÅìÂ≠òÊ∂àÊÅØÂíåÂèñÊ∂àÊÅØÂë¢Ôºü ‰∏Ä‰∏™‰æãÂ≠ê: 12345678func main() &#123; var messages chan string = make(chan string) go func(message string) &#123; messages &lt;- message // Â≠òÊ∂àÊÅØ &#125;(&quot;Ping!&quot;) fmt.Println(&lt;-messages) // ÂèñÊ∂àÊÅØ&#125; ÈªòËÆ§ÁöÑÔºå‰ø°ÈÅìÁöÑÂ≠òÊ∂àÊÅØÂíåÂèñÊ∂àÊÅØÈÉΩÊòØÈòªÂ°ûÁöÑ (Âè´ÂÅöÊó†ÁºìÂÜ≤ÁöÑ‰ø°ÈÅìÔºå‰∏çËøáÁºìÂÜ≤Ëøô‰∏™Ê¶ÇÂøµÁ®çÂêé‰∫ÜËß£ÔºåÂÖàËØ¥ÈòªÂ°ûÁöÑÈóÆÈ¢ò)„ÄÇ ‰πüÂ∞±ÊòØËØ¥, Êó†ÁºìÂÜ≤ÁöÑ‰ø°ÈÅìÂú®ÂèñÊ∂àÊÅØÂíåÂ≠òÊ∂àÊÅØÁöÑÊó∂ÂÄôÈÉΩ‰ºöÊåÇËµ∑ÂΩìÂâçÁöÑgoroutineÔºåÈô§ÈùûÂè¶‰∏ÄÁ´ØÂ∑≤ÁªèÂáÜÂ§áÂ•Ω„ÄÇ ÊØîÂ¶Ç‰ª•‰∏ãÁöÑmainÂáΩÊï∞ÂíåfooÂáΩÊï∞: 12345678910var ch chan int = make(chan int)func foo() &#123; ch &lt;- 0 // Âêëch‰∏≠Âä†Êï∞ÊçÆÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÖ∂‰ªñgoroutineÊù•ÂèñËµ∞Ëøô‰∏™Êï∞ÊçÆÔºåÈÇ£‰πàÊåÇËµ∑foo, Áõ¥Âà∞mainÂáΩÊï∞Êää0Ëøô‰∏™Êï∞ÊçÆÊãøËµ∞&#125;func main() &#123; go foo() &lt;- ch // ‰ªéchÂèñÊï∞ÊçÆÔºåÂ¶ÇÊûúch‰∏≠ËøòÊ≤°ÊîæÊï∞ÊçÆÔºåÈÇ£Â∞±ÊåÇËµ∑mainÁ∫øÔºåÁõ¥Âà∞fooÂáΩÊï∞‰∏≠ÊîæÊï∞ÊçÆ‰∏∫Ê≠¢&#125; ÈÇ£Êó¢ÁÑ∂‰ø°ÈÅìÂèØ‰ª•ÈòªÂ°ûÂΩìÂâçÁöÑgoroutine, ÈÇ£‰πàÂõûÂà∞‰∏ä‰∏ÄÈÉ®ÂàÜ„Äågoroutine„ÄçÊâÄÈÅáÂà∞ÁöÑÈóÆÈ¢ò„ÄåÂ¶Ç‰ΩïËÆ©goroutineÂëäËØâ‰∏ªÁ∫øÊàëÊâßË°åÂÆåÊØï‰∫Ü„Äç ÁöÑÈóÆÈ¢òÊù•, ‰ΩøÁî®‰∏Ä‰∏™‰ø°ÈÅìÊù•ÂëäËØâ‰∏ªÁ∫øÂç≥ÂèØ: 123456789101112131415var complete chan int = make(chan int)func loop() &#123; for i := 0; i &lt; 10; i++ &#123; fmt.Printf(&quot;%d &quot;, i) &#125; complete &lt;- 0 // ÊâßË°åÂÆåÊØï‰∫ÜÔºåÂèë‰∏™Ê∂àÊÅØ&#125;func main() &#123; go loop() &lt;- complete // Áõ¥Âà∞Á∫øÁ®ãË∑ëÂÆå, ÂèñÂà∞Ê∂àÊÅØ. mainÂú®Ê≠§ÈòªÂ°û‰Ωè&#125; Â¶ÇÊûú‰∏çÁî®‰ø°ÈÅìÊù•ÈòªÂ°û‰∏ªÁ∫øÁöÑËØùÔºå‰∏ªÁ∫øÂ∞±‰ºöËøáÊó©Ë∑ëÂÆåÔºåloopÁ∫øÈÉΩÊ≤°ÊúâÊú∫‰ºöÊâßË°å„ÄÅ„ÄÅ„ÄÅ ÂÖ∂ÂÆûÔºåÊó†ÁºìÂÜ≤ÁöÑ‰ø°ÈÅìÊ∞∏Ëøú‰∏ç‰ºöÂ≠òÂÇ®Êï∞ÊçÆÔºåÂè™Ë¥üË¥£Êï∞ÊçÆÁöÑÊµÅÈÄöÔºå‰∏∫‰ªÄ‰πàËøô‰πàËÆ≤Âë¢Ôºü ‰ªéÊó†ÁºìÂÜ≤‰ø°ÈÅìÂèñÊï∞ÊçÆÔºåÂøÖÈ°ªË¶ÅÊúâÊï∞ÊçÆÊµÅËøõÊù•ÊâçÂèØ‰ª•ÔºåÂê¶ÂàôÂΩìÂâçÁ∫øÈòªÂ°û Êï∞ÊçÆÊµÅÂÖ•Êó†ÁºìÂÜ≤‰ø°ÈÅì, Â¶ÇÊûúÊ≤°ÊúâÂÖ∂‰ªñgoroutineÊù•ÊãøËµ∞Ëøô‰∏™Êï∞ÊçÆÔºåÈÇ£‰πàÂΩìÂâçÁ∫øÈòªÂ°û ÊâÄ‰ª•Ôºå‰Ω†ÂèØ‰ª•ÊµãËØï‰∏ãÔºåÊó†ËÆ∫Â¶Ç‰ΩïÔºåÊàë‰ª¨ÊµãËØïÂà∞ÁöÑÊó†ÁºìÂÜ≤‰ø°ÈÅìÁöÑÂ§ßÂ∞èÈÉΩÊòØ0 (len(channel)) Â¶ÇÊûú‰ø°ÈÅìÊ≠£ÊúâÊï∞ÊçÆÂú®ÊµÅÂä®ÔºåÊàë‰ª¨ËøòË¶ÅÂä†ÂÖ•Êï∞ÊçÆÔºåÊàñËÄÖ‰ø°ÈÅìÂπ≤Ê∂©ÔºåÊàë‰ª¨‰∏ÄÁõ¥ÂêëÊó†Êï∞ÊçÆÊµÅÂÖ•ÁöÑÁ©∫‰ø°ÈÅìÂèñÊï∞ÊçÆÂë¢Ôºü Â∞±‰ºöÂºïËµ∑Ê≠ªÈîÅ Ê≠ªÈîÅ‰∏Ä‰∏™Ê≠ªÈîÅÁöÑ‰æãÂ≠ê: 1234func main() &#123; ch := make(chan int) &lt;- ch // ÈòªÂ°ûmain goroutine, ‰ø°ÈÅìcË¢´ÈîÅ&#125; ÊâßË°åËøô‰∏™Á®ãÂ∫è‰Ω†‰ºöÁúãÂà∞GoÊä•ËøôÊ†∑ÁöÑÈîôËØØ: 1fatal error: all goroutines are asleep - deadlock! ‰ΩïË∞ìÊ≠ªÈîÅ? Êìç‰ΩúÁ≥ªÁªüÊúâËÆ≤ËøáÁöÑÔºåÊâÄÊúâÁöÑÁ∫øÁ®ãÊàñËøõÁ®ãÈÉΩÂú®Á≠âÂæÖËµÑÊ∫êÁöÑÈáäÊîæ„ÄÇÂ¶Ç‰∏äÁöÑÁ®ãÂ∫è‰∏≠, Âè™Êúâ‰∏Ä‰∏™goroutine, ÊâÄ‰ª•ÂΩì‰Ω†ÂêëÈáåÈù¢Âä†Êï∞ÊçÆÊàñËÄÖÂ≠òÊï∞ÊçÆÁöÑËØùÔºåÈÉΩ‰ºöÈîÅÊ≠ª‰ø°ÈÅìÔºå Âπ∂‰∏îÈòªÂ°ûÂΩìÂâç goroutine, ‰πüÂ∞±ÊòØÊâÄÊúâÁöÑgoroutine(ÂÖ∂ÂÆûÂ∞±mainÁ∫ø‰∏Ä‰∏™)ÈÉΩÂú®Á≠âÂæÖ‰ø°ÈÅìÁöÑÂºÄÊîæ(Ê≤°‰∫∫ÊãøËµ∞Êï∞ÊçÆ‰ø°ÈÅìÊòØ‰∏ç‰ºöÂºÄÊîæÁöÑ)Ôºå‰πüÂ∞±ÊòØÊ≠ªÈîÅÂíØ„ÄÇ ÊàëÂèëÁé∞Ê≠ªÈîÅÊòØ‰∏Ä‰∏™ÂæàÊúâÊÑèÊÄùÁöÑËØùÈ¢òÔºåËøôÈáåÊúâÂá†‰∏™Ê≠ªÈîÅÁöÑ‰æãÂ≠ê: Âè™Âú®Âçï‰∏ÄÁöÑgoroutineÈáåÊìç‰ΩúÊó†ÁºìÂÜ≤‰ø°ÈÅìÔºå‰∏ÄÂÆöÊ≠ªÈîÅ„ÄÇÊØîÂ¶Ç‰Ω†Âè™Âú®mainÂáΩÊï∞ÈáåÊìç‰Ωú‰ø°ÈÅì: 12345func main() &#123; ch := make(chan int) ch &lt;- 1 // 1ÊµÅÂÖ•‰ø°ÈÅìÔºåÂ†µÂ°ûÂΩìÂâçÁ∫ø, Ê≤°‰∫∫ÂèñËµ∞Êï∞ÊçÆ‰ø°ÈÅì‰∏ç‰ºöÊâìÂºÄ fmt.Println(&quot;This line code wont run&quot;) //Âú®Ê≠§Ë°åÊâßË°å‰πãÂâçGoÂ∞±‰ºöÊä•Ê≠ªÈîÅ&#125; Â¶Ç‰∏ã‰πüÊòØ‰∏Ä‰∏™Ê≠ªÈîÅÁöÑ‰æãÂ≠ê: 123456789101112var ch1 chan int = make(chan int)var ch2 chan int = make(chan int)func say(s string) &#123; fmt.Println(s) ch1 &lt;- &lt;- ch2 // ch1 Á≠âÂæÖ ch2ÊµÅÂá∫ÁöÑÊï∞ÊçÆ&#125;func main() &#123; go say(&quot;hello&quot;) &lt;- ch1 // Â†µÂ°û‰∏ªÁ∫ø&#125; ÂÖ∂‰∏≠‰∏ªÁ∫øÁ≠âch1‰∏≠ÁöÑÊï∞ÊçÆÊµÅÂá∫Ôºåch1Á≠âch2ÁöÑÊï∞ÊçÆÊµÅÂá∫Ôºå‰ΩÜÊòØch2Á≠âÂæÖÊï∞ÊçÆÊµÅÂÖ•Ôºå‰∏§‰∏™goroutineÈÉΩÂú®Á≠âÔºå‰πüÂ∞±ÊòØÊ≠ªÈîÅ„ÄÇ ÂÖ∂ÂÆûÔºåÊÄªÁªìÊù•ÁúãÔºå‰∏∫‰ªÄ‰πà‰ºöÊ≠ªÈîÅÔºüÈùûÁºìÂÜ≤‰ø°ÈÅì‰∏äÂ¶ÇÊûúÂèëÁîü‰∫ÜÊµÅÂÖ•Êó†ÊµÅÂá∫ÔºåÊàñËÄÖÊµÅÂá∫Êó†ÊµÅÂÖ•Ôºå‰πüÂ∞±ÂØºËá¥‰∫ÜÊ≠ªÈîÅ„ÄÇÊàñËÄÖËøôÊ†∑ÁêÜËß£ GoÂêØÂä®ÁöÑÊâÄÊúâgoroutineÈáåÁöÑÈùûÁºìÂÜ≤‰ø°ÈÅì‰∏ÄÂÆöË¶Å‰∏Ä‰∏™Á∫øÈáåÂ≠òÊï∞ÊçÆÔºå‰∏Ä‰∏™Á∫øÈáåÂèñÊï∞ÊçÆÔºåË¶ÅÊàêÂØπÊâçË°å „ÄÇÊâÄ‰ª•‰∏ãÈù¢ÁöÑÁ§∫‰æã‰∏ÄÂÆöÊ≠ªÈîÅ: 12345678c, quit := make(chan int), make(chan int)go func() &#123; c &lt;- 1 // cÈÄöÈÅìÁöÑÊï∞ÊçÆÊ≤°ÊúâË¢´ÂÖ∂‰ªñgoroutineËØªÂèñËµ∞ÔºåÂ†µÂ°ûÂΩìÂâçgoroutine quit &lt;- 0 // quitÂßãÁªàÊ≤°ÊúâÂäûÊ≥ïÂÜôÂÖ•Êï∞ÊçÆ&#125;()&lt;- quit // quit Á≠âÂæÖÊï∞ÊçÆÁöÑÂÜô ‰ªîÁªÜÂàÜÊûêÁöÑËØùÔºåÊòØÁî±‰∫éÔºö‰∏ªÁ∫øÁ≠âÂæÖquit‰ø°ÈÅìÁöÑÊï∞ÊçÆÊµÅÂá∫ÔºåquitÁ≠âÂæÖÊï∞ÊçÆÂÜôÂÖ•ÔºåËÄåfuncË¢´cÈÄöÈÅìÂ†µÂ°ûÔºåÊâÄÊúâgoroutineÈÉΩÂú®Á≠âÔºåÊâÄ‰ª•Ê≠ªÈîÅ„ÄÇ ÁÆÄÂçïÊù•ÁúãÁöÑËØùÔºå‰∏ÄÂÖ±‰∏§‰∏™Á∫øÔºåfuncÁ∫ø‰∏≠ÊµÅÂÖ•cÈÄöÈÅìÁöÑÊï∞ÊçÆÂπ∂Ê≤°ÊúâÂú®mainÁ∫ø‰∏≠ÊµÅÂá∫ÔºåËÇØÂÆöÊ≠ªÈîÅ„ÄÇ ‰ΩÜÊòØÔºåÊòØÂê¶ÊûúÁúü ÊâÄÊúâ‰∏çÊàêÂØπÂêë‰ø°ÈÅìÂ≠òÂèñÊï∞ÊçÆÁöÑÊÉÖÂÜµÈÉΩÊòØÊ≠ªÈîÅ? Â¶Ç‰∏ãÊòØ‰∏™Âèç‰æã: 1234567func main() &#123; c := make(chan int) go func() &#123; c &lt;- 1 &#125;()&#125; Á®ãÂ∫èÊ≠£Â∏∏ÈÄÄÂá∫‰∫ÜÔºåÂæàÁÆÄÂçïÔºåÂπ∂‰∏çÊòØÊàë‰ª¨ÈÇ£‰∏™ÊÄªÁªì‰∏çËµ∑‰ΩúÁî®‰∫ÜÔºåËøòÊòØÂõ†‰∏∫‰∏Ä‰∏™ËÆ©‰∫∫ÂæàÂõßÁöÑÂéüÂõ†ÔºåmainÂèàÊ≤°Á≠âÂæÖÂÖ∂ÂÆÉgoroutineÔºåËá™Â∑±ÂÖàË∑ëÂÆå‰∫ÜÔºå ÊâÄ‰ª•Ê≤°ÊúâÊï∞ÊçÆÊµÅÂÖ•c‰ø°ÈÅìÔºå‰∏ÄÂÖ±ÊâßË°å‰∫Ü‰∏Ä‰∏™goroutine, Âπ∂‰∏îÊ≤°ÊúâÂèëÁîüÈòªÂ°ûÔºåÊâÄ‰ª•Ê≤°ÊúâÊ≠ªÈîÅÈîôËØØ„ÄÇ ÈÇ£‰πàÊ≠ªÈîÅÁöÑËß£ÂÜ≥ÂäûÊ≥ïÂë¢Ôºü ÊúÄÁÆÄÂçïÁöÑÔºåÊääÊ≤°ÂèñËµ∞ÁöÑÊï∞ÊçÆÂèñËµ∞ÔºåÊ≤°ÊîæÂÖ•ÁöÑÊï∞ÊçÆÊîæÂÖ•Ôºå Âõ†‰∏∫Êó†ÁºìÂÜ≤‰ø°ÈÅì‰∏çËÉΩÊâøËΩΩÊï∞ÊçÆÔºåÈÇ£‰πàÂ∞±Ëµ∂Á¥ßÊãøËµ∞ÔºÅ ÂÖ∑‰ΩìÊù•ËÆ≤ÔºåÂ∞±Ê≠ªÈîÅ‰æãÂ≠ê3‰∏≠ÁöÑÊÉÖÂÜµÔºåÂèØ‰ª•Ëøô‰πàÈÅøÂÖçÊ≠ªÈîÅ: 123456789c, quit := make(chan int), make(chan int)go func() &#123; c &lt;- 1 quit &lt;- 0&#125;()&lt;- c // ÂèñËµ∞cÁöÑÊï∞ÊçÆÔºÅ&lt;-quit Âè¶‰∏Ä‰∏™Ëß£ÂÜ≥ÂäûÊ≥ïÊòØÁºìÂÜ≤‰ø°ÈÅì, Âç≥ËÆæÁΩÆcÊúâ‰∏Ä‰∏™Êï∞ÊçÆÁöÑÁºìÂÜ≤Â§ßÂ∞è: 1c := make(chan int, 1) ËøôÊ†∑ÁöÑËØùÔºåcÂèØ‰ª•ÁºìÂ≠ò‰∏Ä‰∏™Êï∞ÊçÆ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÊîæÂÖ•‰∏Ä‰∏™Êï∞ÊçÆÔºåcÂπ∂‰∏ç‰ºöÊåÇËµ∑ÂΩìÂâçÁ∫ø, ÂÜçÊîæ‰∏Ä‰∏™Êâç‰ºöÊåÇËµ∑ÂΩìÂâçÁ∫øÁõ¥Âà∞Á¨¨‰∏Ä‰∏™Êï∞ÊçÆË¢´ÂÖ∂‰ªñgoroutineÂèñËµ∞, ‰πüÂ∞±ÊòØÂè™ÈòªÂ°ûÂú®ÂÆπÈáè‰∏ÄÂÆöÁöÑÊó∂ÂÄôÔºå‰∏çËææÂÆπÈáè‰∏çÈòªÂ°û„ÄÇ ËøôÂçÅÂàÜÁ±ª‰ººÊàë‰ª¨Python‰∏≠ÁöÑÈòüÂàóQueue‰∏çÊòØÂêóÔºü Êó†ÁºìÂÜ≤‰ø°ÈÅìÁöÑÊï∞ÊçÆËøõÂá∫È°∫Â∫èÊàë‰ª¨Â∑≤ÁªèÁü•ÈÅìÔºåÊó†ÁºìÂÜ≤‰ø°ÈÅì‰ªé‰∏çÂ≠òÂÇ®Êï∞ÊçÆÔºåÊµÅÂÖ•ÁöÑÊï∞ÊçÆÂøÖÈ°ªË¶ÅÊµÅÂá∫ÊâçÂèØ‰ª•„ÄÇ ËßÇÂØü‰ª•‰∏ãÁöÑÁ®ãÂ∫è: 1234567891011121314151617var ch chan int = make(chan int)func foo(id int) &#123; //id: Ëøô‰∏™routineÁöÑÊ†áÂè∑ ch &lt;- id&#125;func main() &#123; // ÂºÄÂêØ5‰∏™routine for i := 0; i &lt; 5; i++ &#123; go foo(i) &#125; // ÂèñÂá∫‰ø°ÈÅì‰∏≠ÁöÑÊï∞ÊçÆ for i := 0; i &lt; 5; i++ &#123; fmt.Print(&lt;- ch) &#125;&#125; Êàë‰ª¨ÂºÄ‰∫Ü5‰∏™goroutineÔºåÁÑ∂ÂêéÂèà‰æùÊ¨°ÂèñÊï∞ÊçÆ„ÄÇÂÖ∂ÂÆûÊï¥‰∏™ÁöÑÊâßË°åËøáÁ®ãÁªÜÂàÜÁöÑËØùÔºå5‰∏™Á∫øÁöÑÊï∞ÊçÆ ‰æùÊ¨°ÊµÅËøá‰ø°ÈÅìch, mainÊâìÂç∞‰πã, ËÄåÂÆèËßÇ‰∏äÊàë‰ª¨ÁúãÂà∞ÁöÑÂç≥ Êó†ÁºìÂÜ≤‰ø°ÈÅìÁöÑÊï∞ÊçÆÊòØÂÖàÂà∞ÂÖàÂá∫Ôºå‰ΩÜÊòØ Êó†ÁºìÂÜ≤‰ø°ÈÅìÂπ∂‰∏çÂ≠òÂÇ®Êï∞ÊçÆÔºåÂè™Ë¥üË¥£Êï∞ÊçÆÁöÑÊµÅÈÄö ÁºìÂÜ≤‰ø°ÈÅìÁªà‰∫éÂà∞‰∫ÜËøô‰∏™ËØùÈ¢ò‰∫Ü, ÂÖ∂ÂÆûÁºìÂ≠ò‰ø°ÈÅìÁî®Ëã±ÊñáÊù•ËÆ≤Êõ¥‰∏∫ËææÊÑè: buffered channel. ÁºìÂÜ≤Ëøô‰∏™ËØçÊÑèÊÄùÊòØÔºåÁºìÂÜ≤‰ø°ÈÅì‰∏ç‰ªÖÂèØ‰ª•ÊµÅÈÄöÊï∞ÊçÆÔºåËøòÂèØ‰ª•ÁºìÂ≠òÊï∞ÊçÆ„ÄÇÂÆÉÊòØÊúâÂÆπÈáèÁöÑÔºåÂ≠òÂÖ•‰∏Ä‰∏™Êï∞ÊçÆÁöÑËØù , ÂèØ‰ª•ÂÖàÊîæÂú®‰ø°ÈÅìÈáåÔºå‰∏çÂøÖÈòªÂ°ûÂΩìÂâçÁ∫øËÄåÁ≠âÂæÖËØ•Êï∞ÊçÆÂèñËµ∞„ÄÇ ÂΩìÁºìÂÜ≤‰ø°ÈÅìËææÂà∞Êª°ÁöÑÁä∂ÊÄÅÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöË°®Áé∞Âá∫ÈòªÂ°û‰∫ÜÔºåÂõ†‰∏∫ËøôÊó∂ÂÜç‰πü‰∏çËÉΩÊâøËΩΩÊõ¥Â§öÁöÑÊï∞ÊçÆ‰∫ÜÔºå„Äå‰Ω†‰ª¨ÂøÖÈ°ªÊää Êï∞ÊçÆÊãøËµ∞ÔºåÊâçÂèØ‰ª•ÊµÅÂÖ•Êï∞ÊçÆ„Äç„ÄÇ Âú®Â£∞Êòé‰∏Ä‰∏™‰ø°ÈÅìÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Áªômake‰ª•Á¨¨‰∫å‰∏™ÂèÇÊï∞Êù•ÊåáÊòéÂÆÉÁöÑÂÆπÈáè(ÈªòËÆ§‰∏∫0ÔºåÂç≥Êó†ÁºìÂÜ≤): 1var ch chan int = make(chan int, 2) // ÂÜôÂÖ•2‰∏™ÂÖÉÁ¥†ÈÉΩ‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçgoroutine, Â≠òÂÇ®‰∏™Êï∞ËææÂà∞2ÁöÑÊó∂ÂÄô‰ºöÈòªÂ°û Â¶Ç‰∏ãÁöÑ‰æãÂ≠êÔºåÁºìÂÜ≤‰ø°ÈÅìchÂèØ‰ª•Êó†ÁºìÂÜ≤ÁöÑÊµÅÂÖ•3‰∏™ÂÖÉÁ¥†: 123456func main() &#123; ch := make(chan int, 3) ch &lt;- 1 ch &lt;- 2 ch &lt;- 3&#125; Â¶ÇÊûú‰Ω†ÂÜçËØïÂõæÊµÅÂÖ•‰∏Ä‰∏™Êï∞ÊçÆÁöÑËØùÔºå‰ø°ÈÅìch‰ºöÈòªÂ°ûmainÁ∫ø, Êä•Ê≠ªÈîÅ„ÄÇ ‰πüÂ∞±ÊòØËØ¥ÔºåÁºìÂÜ≤‰ø°ÈÅì‰ºöÂú®Êª°ÂÆπÈáèÁöÑÊó∂ÂÄôÂä†ÈîÅ„ÄÇ ÂÖ∂ÂÆûÔºåÁºìÂÜ≤‰ø°ÈÅìÊòØÂÖàËøõÂÖàÂá∫ÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•ÊääÁºìÂÜ≤‰ø°ÈÅìÁúã‰Ωú‰∏∫‰∏Ä‰∏™Á∫øÁ®ãÂÆâÂÖ®ÁöÑÈòüÂàóÔºö 12345678910func main() &#123; ch := make(chan int, 3) ch &lt;- 1 ch &lt;- 2 ch &lt;- 3 fmt.Println(&lt;-ch) // 1 fmt.Println(&lt;-ch) // 2 fmt.Println(&lt;-ch) // 3&#125; ‰ø°ÈÅìÊï∞ÊçÆËØªÂèñÂíå‰ø°ÈÅìÂÖ≥Èó≠‰Ω†‰πüËÆ∏ÂèëÁé∞Ôºå‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏Ä‰∏™‰∏Ä‰∏™Âú∞ÂéªËØªÂèñ‰ø°ÈÅìÁÆÄÁõ¥Â§™Ë¥π‰∫ã‰∫ÜÔºåGoËØ≠Ë®ÄÂÖÅËÆ∏Êàë‰ª¨‰ΩøÁî®rangeÊù•ËØªÂèñ‰ø°ÈÅì: 12345678910func main() &#123; ch := make(chan int, 3) ch &lt;- 1 ch &lt;- 2 ch &lt;- 3 for v := range ch &#123; fmt.Println(v) &#125;&#125; Â¶ÇÊûú‰Ω†ÊâßË°å‰∫Ü‰∏äÈù¢ÁöÑ‰ª£Á†ÅÔºå‰ºöÊä•Ê≠ªÈîÅÈîôËØØÁöÑÔºåÂéüÂõ†ÊòØrange‰∏çÁ≠âÂà∞‰ø°ÈÅìÂÖ≥Èó≠ÊòØ‰∏ç‰ºöÁªìÊùüËØªÂèñÁöÑ„ÄÇ‰πüÂ∞±ÊòØÂ¶ÇÊûú ÁºìÂÜ≤‰ø°ÈÅìÂπ≤Ê∂∏‰∫ÜÔºåÈÇ£‰πàrangeÂ∞±‰ºöÈòªÂ°ûÂΩìÂâçgoroutine, ÊâÄ‰ª•Ê≠ªÈîÅÂíØ„ÄÇ ÈÇ£‰πàÔºåÊàë‰ª¨ËØïÁùÄÈÅøÂÖçËøôÁßçÊÉÖÂÜµÔºåÊØîËæÉÂÆπÊòìÊÉ≥Âà∞ÁöÑÊòØËØªÂà∞‰ø°ÈÅì‰∏∫Á©∫ÁöÑÊó∂ÂÄôÂ∞±ÁªìÊùüËØªÂèñ: 12345678910ch := make(chan int, 3)ch &lt;- 1ch &lt;- 2ch &lt;- 3for v := range ch &#123; fmt.Println(v) if len(ch) &lt;= 0 &#123; // Â¶ÇÊûúÁé∞ÊúâÊï∞ÊçÆÈáè‰∏∫0ÔºåË∑≥Âá∫Âæ™ÁéØ break &#125;&#125; ‰ª•‰∏äÁöÑÊñπÊ≥ïÊòØÂèØ‰ª•Ê≠£Â∏∏ËæìÂá∫ÁöÑÔºå‰ΩÜÊòØÊ≥®ÊÑèÊ£ÄÊü•‰ø°ÈÅìÂ§ßÂ∞èÁöÑÊñπÊ≥ï‰∏çËÉΩÂú®‰ø°ÈÅìÂ≠òÂèñÈÉΩÂú®ÂèëÁîüÁöÑÊó∂ÂÄôÁî®‰∫éÂèñÂá∫ÊâÄÊúâÊï∞ÊçÆÔºåËøô‰∏™‰æãÂ≠ê ÊòØÂõ†‰∏∫Êàë‰ª¨Âè™Âú®ch‰∏≠Â≠ò‰∫ÜÊï∞ÊçÆÔºåÁé∞Âú®‰∏Ä‰∏™‰∏Ä‰∏™ÂæÄÂ§ñÂèñÔºå‰ø°ÈÅìÂ§ßÂ∞èÊòØÈÄíÂáèÁöÑ„ÄÇ Âè¶‰∏Ä‰∏™ÊñπÂºèÊòØÊòæÂºèÂú∞ÂÖ≥Èó≠‰ø°ÈÅì: 1234567891011ch := make(chan int, 3)ch &lt;- 1ch &lt;- 2ch &lt;- 3// ÊòæÂºèÂú∞ÂÖ≥Èó≠‰ø°ÈÅìclose(ch)for v := range ch &#123; fmt.Println(v)&#125; Ë¢´ÂÖ≥Èó≠ÁöÑ‰ø°ÈÅì‰ºöÁ¶ÅÊ≠¢Êï∞ÊçÆÊµÅÂÖ•, ÊòØÂè™ËØªÁöÑ„ÄÇÊàë‰ª¨‰ªçÁÑ∂ÂèØ‰ª•‰ªéÂÖ≥Èó≠ÁöÑ‰ø°ÈÅì‰∏≠ÂèñÂá∫Êï∞ÊçÆÔºå‰ΩÜÊòØ‰∏çËÉΩÂÜçÂÜôÂÖ•Êï∞ÊçÆ‰∫Ü„ÄÇ Á≠âÂæÖÂ§ögorountineÁöÑÊñπÊ°àÈÇ£Â•ΩÔºåÊàë‰ª¨ÂõûÂà∞ÊúÄÂàùÁöÑ‰∏Ä‰∏™ÈóÆÈ¢òÔºå‰ΩøÁî®‰ø°ÈÅìÂ†µÂ°û‰∏ªÁ∫øÔºåÁ≠âÂæÖÂºÄÂá∫ÂéªÁöÑÊâÄÊúâgoroutineË∑ëÂÆå„ÄÇ ËøôÊòØ‰∏Ä‰∏™Ê®°ÂûãÔºåÂºÄÂá∫ÂæàÂ§öÂ∞ègoroutine, ÂÆÉ‰ª¨ÂêÑËá™Ë∑ëÂêÑËá™ÁöÑÔºåÊúÄÂêéË∑ëÂÆå‰∫ÜÂêë‰∏ªÁ∫øÊä•Âëä„ÄÇ Êàë‰ª¨ËÆ®ËÆ∫Â¶Ç‰∏ã2‰∏™ÁâàÊú¨ÁöÑÊñπÊ°à: Âè™‰ΩøÁî®Âçï‰∏™Êó†ÁºìÂÜ≤‰ø°ÈÅìÈòªÂ°û‰∏ªÁ∫ø ‰ΩøÁî®ÂÆπÈáè‰∏∫goroutinesÊï∞ÈáèÁöÑÁºìÂÜ≤‰ø°ÈÅì ÂØπ‰∫éÊñπÊ°à1, Á§∫‰æãÁöÑ‰ª£Á†ÅÂ§ßÊ¶Ç‰ºöÊòØËøô‰∏™Ê†∑Â≠ê: 12345678910111213141516171819var quit chan int // Âè™ÂºÄ‰∏Ä‰∏™‰ø°ÈÅìfunc foo(id int) &#123; fmt.Println(id) quit &lt;- 0 // ok, finished&#125;func main() &#123; count := 1000 quit = make(chan int) // Êó†ÁºìÂÜ≤ for i := 0; i &lt; count; i++ &#123; go foo(i) &#125; for i := 0; i &lt; count; i++ &#123; &lt;- quit &#125;&#125; ÂØπ‰∫éÊñπÊ°à2, Êää‰ø°ÈÅìÊç¢ÊàêÁºìÂÜ≤1000ÁöÑ: 1quit = make(chan int, count) // ÂÆπÈáè1000 ÂÖ∂ÂÆûÂå∫Âà´‰ªÖ‰ªÖÂú®‰∫é‰∏Ä‰∏™ÊòØÁºìÂÜ≤ÁöÑÔºå‰∏Ä‰∏™ÊòØÈùûÁºìÂÜ≤ÁöÑ„ÄÇ ÂØπ‰∫éËøô‰∏™Âú∫ÊôØËÄåË®ÄÔºå‰∏§ËÄÖÈÉΩËÉΩÂÆåÊàê‰ªªÂä°, ÈÉΩÊòØÂèØ‰ª•ÁöÑ„ÄÇ Êó†ÁºìÂÜ≤ÁöÑ‰ø°ÈÅìÊòØ‰∏ÄÊâπÊï∞ÊçÆ‰∏Ä‰∏™‰∏Ä‰∏™ÁöÑ„ÄåÊµÅËøõÊµÅÂá∫„Äç ÁºìÂÜ≤‰ø°ÈÅìÂàôÊòØ‰∏Ä‰∏™‰∏Ä‰∏™Â≠òÂÇ®ÔºåÁÑ∂Âêé‰∏ÄËµ∑ÊµÅÂá∫Âéª]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysql‰∏≠Â≠óÊÆµÂêç‰∏é‰øùÁïôÂ≠óÂÜ≤Á™Å]]></title>
    <url>%2F2018%2F12%2F04%2Fmysql%E4%B8%AD%E5%AD%97%E6%AE%B5%E5%90%8D%E4%B8%8E%E4%BF%9D%E7%95%99%E5%AD%97%E5%86%B2%E7%AA%81%2F</url>
    <content type="text"><![CDATA[Âú®ËÆæËÆ°Êï∞ÊçÆÂ∫ìÁöÑÊó∂ÂÄô‰∏çÂ∞èÂøÉÂ∞ÜÊï∞ÊçÆÂ∫ìÁöÑÂ≠óÊÆµËÆæÁΩÆÊàê‰∫ÜÂÖ∂ÂÜÖÁΩÆÁöÑ‰øùÁïôÂ≠óÔºå‰æãÂ¶Ç‰∏ãÈù¢ÁöÑËøôÊÆµÔºö 123456CREATE TABLE IF NOT EXISTS `test_billing` (`vendor` varchar(255),`cn` varchar(255),`current_date` varchar(255),`cost` varchar(255)) ENGINE=InnoDB DEFAULT CHARSET=utf8; ËøôÊ†∑‰Ω†Âú®ÊâßË°åÁ±ª‰ºº‰∏ãÈù¢ÁöÑÊü•ËØ¢Êó∂Ôºö 1select cn, cost from test_billing where current_date like&quot;2018-10%&quot;; ËøîÂõûÂÄº‰∏≠‰ªÄ‰πàÈÉΩÊ≤°ÊúâÔºåËøòÂ∏¶‰∫Ü‰∏Ä‰∏™warningÔºö 1Empty set, 1 warning (0.00 sec) ÂéüÂõ†Â∞±ÊòØÂ≠óÊÆµcurrent_date‰∏éMySQLÂÜÖÁΩÆÁöÑ‰øùÁïôÂ≠óÂÜ≤Á™Å‰∫ÜÔºåÈÇ£‰πàËøôÊó∂ÂÄô‰Ω†ËøòÊÄ•ÈúÄÊü•ÁúãËøô‰∫õÊï∞ÊçÆÔºåÊØîËæÉÂø´ÁöÑÊñπÊ≥ïÂ∞±ÊòØÔºöÂú®ÂÜ≤Á™ÅÂ≠óÊÆµ‰∏äÂä†ÂèçÂºïÂè∑ current_date,Âç≥ 1select cn, cost from test_billing where `current_date` like&quot;2018-10%&quot;; Â∞±ÂèØ‰ª•Ëß£ÂÜ≥‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gitÂ∏∏Áî®Êìç‰Ωú]]></title>
    <url>%2F2018%2F12%2F02%2Fgit%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[È¶ñÂÖàÊù•‰∏ÄÈÅç‰ªéforkÂà∞pull requestËøô‰∏™ËøáÁ®ãÁöÑÂü∫Á°ÄÊµÅÁ®ãÈ¶ñÂÖàÔºåfork ‰∏Ä‰∏™repositoryÔºåÂÆûÈôÖ‰∏äÊòØÂ§çÂà∂‰∫Ü‰∏Ä‰ªΩ repository Âà∞Ëá™Â∑±ÁöÑ GitHub Ë¥¶Êà∑‰∏ãÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•‰ªé GitHub Â∞ÜÂÆÉ clone Âà∞‰Ω†ÁöÑÁîµËÑë‰∏äÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºö git clone ËøûÊé•Âà∞ÂéüÂßãÁöÑRepositoryÔºåÂõ†‰∏∫Â¶ÇÊûúÂéüÂßãÁöÑRepositoryÂÜÖÂÆπÊúâÊâÄÊîπÂèòÊó∂ÔºåÊàë‰ª¨Â∏åÊúõËÉΩÂ§üpullËøô‰∫õÂèòÂåñÔºåÊâÄ‰ª•Êñ∞Â¢û‰∏Ä‰∏™ËøúÁ´ØÈìæÊé•ÔºåÂπ∂ÊääÂÆÉÂëΩÂêç‰∏∫‚Äôupstream‚ÄôÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºö git remote add upstream Êñ∞Â¢ûbranchÂàÜÊîØÔºåÂπ∂ÈÄâÁî®Êñ∞Â¢ûÂàÜÊîØ„ÄÇÈÅøÂÖç‰∏é‰∏ªÂàÜÊîØmasterÈÄ†ÊàêÂÜ≤Á™ÅÔºåÂΩìÊàë‰ª¨Âú®Êñ∞Â¢ûÂàÜÊîØ‰∏äÂÆåÊàê‰∫ÜËá™Â∑±ÁöÑÂäüËÉΩÂêéÂÜçÂêàÂπ∂Âà∞‰∏ªÂàÜÊîØÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºö git branch git checkout git checkout -b ‚ÄìÂàõÂª∫Êñ∞ÁöÑÂàÜÊîØÂπ∂ÂàáÊç¢Âà∞Êñ∞ÁöÑÂàÜÊîØ‰∏äËÆ∞ÂΩïÔºåÂú®Êàë‰ª¨Ëá™Â∑±ÁöÑÂàÜÊîØ‰∏ä‰øÆÊîπÂêéÔºåÈúÄË¶ÅËÆ∞ÂΩï‰∏ãÊù•„ÄÇ git status ‚ÄìÊü•ÁúãÂΩìÂâçÁä∂ÊÄÅgit add -A ‚ÄìËÆ∞ÂΩï‰øÆÊîπÊñá‰ª∂ÔºåÂä†‰∏ä -AÔºåÊúÉÂ∞áÊñ∞Â¢ûÊ™îÊ°àË∑üÂà™Èô§Ê™îÊ°àÁöÑÂãï‰Ωú‰∏ÄËµ∑Ë®òÈåÑ‰∏ã‰æÜgit commit -m ‚Äúadd a file‚Äù ‚ÄìÊèê‰∫§ÂÖ®ÈÉ®‰øÆÊîπgit checkout master ‚ÄìÁ¨¨‰∫åÂ§©ÂºÄÂßãÂ∑•‰ΩúÂâçÔºåÂàáÊç¢Âà∞masterÂàÜÊîØgit pull origin master ‚Äì‰ªémasterÁöÑËøúÁ®ãÂàÜÊîØÊãâÂèñ‰ª£Á†Ågit checkout ‚ÄìÂàáÊç¢Âà∞taskÊâÄÂú®ÁöÑÊú¨Âú∞ÂàÜÊîØgit rebase -i master ‚ÄìÂ∞Ümaster‰∏äÁöÑÊúÄÊñ∞ÁöÑ‰ª£Á†ÅÂêàÂπ∂Âà∞ÂΩìÂâçÂàÜÊîØ‰∏äÔºåËøôÈáåÁöÑ-iÁöÑ‰ΩúÁî®ÊòØÂ∞ÜÊàë‰ª¨ ÂΩìÂâçÂàÜÊîØ‰πãÂâçÁöÑcommitÂéãÁº©Êàê‰∏∫‰∏Ä‰∏™commitÔºåËøôÊ†∑ÂÅöÁöÑÂ•ΩÂ§ÑÂú®‰∫éÂΩìÊàë‰ª¨‰πãÂêéÂàõÂª∫pull requestÂπ∂ËøõË°åÁõ∏Â∫îÁöÑcode reviewÁöÑÊó∂ÂÄôÔºå‰ª£Á†ÅÁöÑÊîπÂä®‰ºöÈõÜ‰∏≠Âú®‰∏Ä‰∏™commitÔºå‰ΩøÂæócode reviewÊõ¥Áõ¥ËßÇÊñπ‰æøgit push ‚Äìset-upstream origin ‚ÄìÊúÄÂêéÔºåÂΩìtaskÁöÑÊâÄÊúâÁºñÁ†ÅÂÆåÊàê‰πãÂêéÔºåÂ∞Ü‰ª£Á†ÅpushÂà∞ËøúÁ®ãÂàÜÊîØÂÖàËé∑ÂèñËøúÁ´ØÔºåÂÜçÊèê‰∫§ÔºåÊØèÊ¨°Êèê‰∫§‰ª£Á†ÅÂâçÔºåÈÉΩÈúÄË¶ÅÂÖàËé∑ÂèñÊúÄÊñ∞‰ª£Á†ÅÔºåÈò≤Ê≠¢Ë¶ÜÁõñ‰ªñ‰∫∫‰ª£Á†Å git fetch ‚Äìdry-run ‚ÄìÊ£ÄÊü•ËøúÁ´ØÊòØÂê¶ÊúâÂèòÂä®git pull ‚Äì‰ªéËøúÁ´ØÂàÜÊîØÊõ¥Êñ∞ÊúÄÊñ∞‰ª£Á†ÅÂª∫Á´ãPull RequestsÔºåËøõÂÖ•‰Ω†ÁöÑgithubÈ°πÁõÆÈ°µÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã GitHub‰ºöÊ£ÄÊµãÂà∞‰Ω†Êúâ‰∫ÜÊñ∞ÁöÑÊé®ÈÄÅÔºå‰ºö‰∏ªÂä®ÊèêÁ§∫‰Ω†ÔºåÁÇπÂáªCreate pull requestÔºåÂÜô‰∏äËØ¥ÊòéÔºåÂÜçÊåâSend pull requestÂ∞±ÂÆåÊàê‰∫ÜÔºåÂ¶ÇÊûú Pull Request Ê≤íÊúâÈóÆÈ¢òÁöÑËØùÔºåÂæàÂø´Â∞±ÊúÉË¢´Ëá™Âä®ÂêàÂπ∂ merged ‰∫ÜÂì¶ÔºÅ Êú¨Âú∞ÂêàÂπ∂ÂàÜÊîØÔºåÂπ∂Âà†Èô§ÂàÜÊîØÔºåÂ∞ÜÂàÜÊîØÂêàÂπ∂Âà∞‰∏ªÂàÜÊîØ‰∏äÔºåÂπ∂Âà†Èô§‰πã git checkout master ‚ÄìÈ¶ñÂÖàÂàáÊç¢Âà∞‰∏ªÂàÜÊîØ‰∏≠git merge ‚ÄìÂêàÂπ∂Âè¶‰∏Ä‰∏™ÂàÜÊîØËøõÊù•git branch -d ‚ÄìÂà†ÊéâÂàöÂàöÂêàÂπ∂ÁöÑÂàÜÊîØgit push ‚Äìdelete ‚Äì‰πüÂèØ‰ª•ÊääÂêàÂπ∂ÂàÜÊîØ‰ªéGitHub‰∏äÁöÑÂâØÊú¨repository‰∏≠Âà™Èô§ÂÖ∂‰ªñÂ∏∏Áî®ÂëΩ‰ª§git init ‚ÄìÂ∞Ü‰∏Ä‰∏™Êñá‰ª∂Â§πÂàùÂßãÂåñ‰∏∫git‰ªìÂ∫ìgit status ‚ÄìÊ£ÄÊü•ÂΩìÂâçrepository‰∏≠ÁöÑ‰øÆÊîπgit diff ‚ÄìÊü•ÁúãÂØπÊñá‰ª∂ÁöÑ‰øÆÊîπgit add ‚ÄìÂáÜÂ§áÊèê‰∫§ÂØπ‰∫é‰∏Ä‰∏™Êñá‰ª∂ÁöÑ‰øÆÊîπgit add . ‚ÄìÂáÜÂ§áÊèê‰∫§ÂØπÊâÄÊúâÊñá‰ª∂ÁöÑ‰øÆÊîπgit commit -m ‚Äú‚Äú ‚ÄìÊèê‰∫§‰Ω†ÊâÄÂáÜÂ§áÂ•ΩÁöÑ‰øÆÊîπÔºåÂπ∂ÈôÑ‰∏äÁÆÄÁü≠ËØ¥Êòégit config ‚Äìglobal user.username ‚ÄìÈÖçÁΩÆgithubË¥¶Âè∑git remote add ‚ÄìÊñ∞Â¢ûËøúÁ´ØÈìæÊé•git remote set-url ‚ÄìÂØπ‰∏Ä‰∏™ËøúÁ´ØËÆæÂÆöÂú∞ÂùÄgit remote add ‚ÄìÊñ∞Â¢ûÂ∏¶Âú∞ÂùÄÁöÑËøúÁ´ØÈìæÊé•git remote -v ‚ÄìÊü•ÁúãÊâÄÊúâËøúÁ´Øgit pull ‚Äì‰ªé‰∏Ä‰∏™ËøúÁ´ØÊî∂ÂèñÊõ¥Êñ∞ÔºàÈªòËÆ§‰∏∫‰∏ªÂàÜÊîØÔºâgit push ‚ÄìÊèê‰∫§‰ª£Á†ÅÂà∞ÊåáÂÆöËøúÁ´ØÔºàÈªòËÆ§‰∏∫‰∏ªÂàÜÊîØÔºâgit branch -M ‚Äì‰øÆÊîπÂΩìÂâçÂàÜÊîØÂêçÂ≠ógit branch ‚ÄìÂàóÂá∫ÊâÄÊúâÂàÜÊîØ]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ionic project-Could not find module @angular-devkit/build-angular from XXX]]></title>
    <url>%2F2018%2F11%2F30%2Fionic-project-Could-not-find-module-angular-devkit-build-angular-from-XXX%2F</url>
    <content type="text"><![CDATA[‰ªéGitHub‰∏äÊâæ‰∫Ü‰∏Ä‰∏™ionicÁöÑdemoÔºåÂáÜÂ§áËøêË°å‰∏Ä‰∏ãÔºåÊä•ÈîôÔºöCould not find module @angular-devkit/build-angular from XXX Êìç‰ΩúÊ≠•È™§Ôºö git clone https://github.com/ionic-team/ionic-conference-app.git ionic serve Êä•ÈîôÔºö 1Could not find module &quot;@angular-devkit/build-angular&quot; from Ëß£ÂÜ≥ÊñπÊ°àÔºö npm install ‚Äìsave @angular-devkit/build-angular]]></content>
      <categories>
        <category>frontEnd</category>
      </categories>
      <tags>
        <tag>angular</tag>
        <tag>ionic</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âø´Êéí‰πãgolangÂÆûÁé∞]]></title>
    <url>%2F2018%2F11%2F18%2F%E5%BF%AB%E6%8E%92%E4%B9%8Bgolang%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[Âø´ÈÄüÊéíÂ∫èÁî±C. A. R. HoareÂú®1962Âπ¥ÊèêÂá∫„ÄÇÂÆÉÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÊòØÔºöÈÄöËøá‰∏ÄË∂üÊéíÂ∫èÂ∞ÜË¶ÅÊéíÂ∫èÁöÑÊï∞ÊçÆÂàÜÂâ≤ÊàêÁã¨Á´ãÁöÑ‰∏§ÈÉ®ÂàÜÔºåÂÖ∂‰∏≠‰∏ÄÈÉ®ÂàÜÁöÑÊâÄÊúâÊï∞ÊçÆÈÉΩÊØîÂè¶Â§ñ‰∏ÄÈÉ®ÂàÜÁöÑÊâÄÊúâÊï∞ÊçÆÈÉΩË¶ÅÂ∞èÔºåÁÑ∂ÂêéÂÜçÊåâÊ≠§ÊñπÊ≥ïÂØπËøô‰∏§ÈÉ®ÂàÜÊï∞ÊçÆÂàÜÂà´ËøõË°åÂø´ÈÄüÊéíÂ∫èÔºåÊï¥‰∏™ÊéíÂ∫èËøáÁ®ãÂèØ‰ª•ÈÄíÂΩíËøõË°åÔºå‰ª•Ê≠§ËææÂà∞Êï¥‰∏™Êï∞ÊçÆÂèòÊàêÊúâÂ∫èÂ∫èÂàó„ÄÇ Âà©Áî®ÂàÜÊ≤ªÊ≥ïÂèØÂ∞ÜÂø´ÈÄüÊéíÂ∫èÁöÑÂàÜ‰∏∫‰∏âÊ≠•Ôºö Âú®Êï∞ÊçÆÈõÜ‰πã‰∏≠ÔºåÈÄâÊã©‰∏Ä‰∏™ÂÖÉÁ¥†‰Ωú‰∏∫‚ÄùÂü∫ÂáÜ‚ÄùÔºàpivotÔºâ„ÄÇ ÊâÄÊúâÂ∞è‰∫é‚ÄùÂü∫ÂáÜ‚ÄùÁöÑÂÖÉÁ¥†ÔºåÈÉΩÁßªÂà∞‚ÄùÂü∫ÂáÜ‚ÄùÁöÑÂ∑¶ËæπÔºõÊâÄÊúâÂ§ß‰∫é‚ÄùÂü∫ÂáÜ‚ÄùÁöÑÂÖÉÁ¥†ÔºåÈÉΩÁßªÂà∞‚ÄùÂü∫ÂáÜ‚ÄùÁöÑÂè≥Ëæπ„ÄÇËøô‰∏™Êìç‰ΩúÁß∞‰∏∫ÂàÜÂå∫ (partition) Êìç‰ΩúÔºåÂàÜÂå∫Êìç‰ΩúÁªìÊùüÂêéÔºåÂü∫ÂáÜÂÖÉÁ¥†ÊâÄÂ§ÑÁöÑ‰ΩçÁΩÆÂ∞±ÊòØÊúÄÁªàÊéíÂ∫èÂêéÂÆÉÁöÑ‰ΩçÁΩÆ„ÄÇ ÂØπ‚ÄùÂü∫ÂáÜ‚ÄùÂ∑¶ËæπÂíåÂè≥ËæπÁöÑ‰∏§‰∏™Â≠êÈõÜÔºå‰∏çÊñ≠ÈáçÂ§çÁ¨¨‰∏ÄÊ≠•ÂíåÁ¨¨‰∫åÊ≠•ÔºåÁõ¥Âà∞ÊâÄÊúâÂ≠êÈõÜÂè™Ââ©‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†‰∏∫Ê≠¢„ÄÇ Âø´ÈÄüÊéíÂ∫èÂπ≥ÂùáÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(n log n),ÊúÄÂùèÊÉÖÂÜµ‰∏∫O(n2)Ôºå‰∏çÁ®≥ÂÆöÊéíÂ∫è„ÄÇ ËøôÈáåÂÆûÁé∞‰∫Ü‰∏§ÁßçÊñπÂºèÁöÑÂø´ÊéíÔºåÁ¨¨‰∏ÄÁßçÊòØÂçïË∑ØÁöÑÔºåÂÆûÁé∞‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415func partition(sortArray []int, left, right int) int &#123; key := sortArray[right] i := left - 1 for j := left; j &lt; right; j++ &#123; if sortArray[j] &lt;= key &#123; i++ swap(i, j) &#125; &#125; swap(i+1, right) return i + 1&#125; Á¨¨‰∫åÁßçÊòØÂèåË∑ØÁöÑÔºö 123456789101112131415161718192021222324252627unc partition2(arr []int,left,right int)(p int) &#123; if left &gt; right &#123; return &#125; i,j,pivot := left,right ,arr[left] for i&lt;j &#123; for i &lt; j &amp;&amp; arr[j] &gt;pivot &#123; j-- &#125; for i &lt; j &amp;&amp; arr[i] &lt;= pivot &#123; i++ &#125; if i &lt; j &#123; arr[i] ,arr[j] = arr[j],arr[i] &#125; &#125; arr[i],arr[left] = arr[left],arr[i] return i ÊµãËØï‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122import ("fmt")const MAX = 10var sortArray = []int&#123;41, 24, 76, 11, 45, 64, 21, 69, 19, 36&#125;func main() &#123; fmt.Println("before sortÔºö") quickSort(sortArray, 0, MAX-1) fmt.Println("after sort:")&#125;func quickSort(sortArray []int, left, right int) &#123; if left &lt; right &#123; pos := partition2(sortArray, left, right)//‰øÆÊîπÊ≠§Â§ÑÊµãËØï‰∏çÂêåÁöÑÂÆûÁé∞ÊñπÂºè quickSort(sortArray, left, pos-1) quickSort(sortArray, pos+1, right) &#125;&#125; BUT! Ë¶ÅË°®ËææÂø´ÊéíÁöÑÊÄùÊÉ≥ÔºåËøòÊòØ‰ΩøÁî®PythonÊØîËæÉÈÄèÂΩªÔºö 123456789def quickSort(array): if len(array) &lt; 2: return array else: pivot = array[0] less = [i for i in array[1:] if i &lt;= pivot] greater = [i for i in array[1:] if i &gt; pivot] return quickSort(less) + [pivot] + quickSort(greater) ÊòØ‰∏çÊòØÂ∞ÜÂø´ÊéíÁöÑÂàÜÊ≤ªÊÄùÊÉ≥Ë°®ËææÂú∞Ê∑ãÊºìÂ∞ΩËá¥ÔºåÁÆÄÊ¥ÅÁæéËßÇ„ÄÇ ‚Äã ‚Äã EndÔºÅ]]></content>
      <categories>
        <category>Êï∞ÊçÆÁªìÊûÑ‰∏éÁÆóÊ≥ï</category>
      </categories>
      <tags>
        <tag>go Êï∞ÊçÆÁªìÊûÑ‰∏éÁÆóÊ≥ï</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gitÂ¶Ç‰ΩïÊâæÂõûË¢´Âà†Èô§ÁöÑÂàÜÊîØ]]></title>
    <url>%2F2018%2F11%2F15%2Fgit%E5%A6%82%E4%BD%95%E6%89%BE%E5%9B%9E%E8%A2%AB%E5%88%A0%E9%99%A4%E7%9A%84%E5%88%86%E6%94%AF%2F</url>
    <content type="text"><![CDATA[Âú®‰ΩøÁî®gitÁöÑËøáÁ®ã‰∏≠ÔºåÂõ†‰∏∫‰∫∫‰∏∫Âõ†Á¥†ÈÄ†ÊàêÂàÜÊîØÔºàcommit)Ë¢´Âà†Èô§ÔºåÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÊ≠•È™§ËøõË°åÊÅ¢Â§ç„ÄÇ È¶ñÂÖàÁî®‰ª•‰∏ãÊ≠•È™§ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÂàÜÊîØÔºå‰øÆÊîπ‰∏Ä‰∫õÊñá‰ª∂ÂêéÂà†Èô§Ôºå‰ª•‰æøËøõË°åÊÅ¢Â§ç„ÄÇ1.ÂàõÂª∫ÂàÜÊîØ abc git branch abc1 2.Êü•ÁúãÂàÜÊîØÂàóË°® git branch -a abc developremotes/origin-dev/develop1234 3.ÂàáÊç¢Âà∞abcÂàÜÊîØÔºåÈöè‰æø‰øÆÊîπ‰∏Ä‰∏ã‰∏úË•øÂêé commit ÂàáÊç¢ÂàÜÊîØgit checkout abcSwitched to branch ‚Äòabc‚Äô ÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂echo ‚Äòabc‚Äô &gt; test.txt commitgit add .git commit -m ‚Äòadd test.txt‚Äô[abc 3eac14d] add test.txt 1 file changed, 1 insertion(+) create mode 100644 test.txt12345678910111213 4.Âà†Èô§ÂàÜÊîØabc git branch -D abcDeleted branch abc (was 3eac14d).12 5.Êü•ÁúãÂàÜÊîØÂàóË°®ÔºåabcÂàÜÊîØÂ∑≤‰∏çÂ≠òÂú® git branch -a developremotes/origin-dev/develop123 ÊÅ¢Â§çÊ≠•È™§Â¶Ç‰∏ãÔºö1.‰ΩøÁî®git log -g ÊâæÂõû‰πãÂâçÊèê‰∫§ÁöÑcommitcommit 3eac14d05bc1264cda54a7c21f04c3892f32406aReflog: HEAD@{1} (fdipzone &#102;&#x64;&#105;&#112;&#x7a;&#x6f;&#110;&#101;&#x40;&#115;&#x69;&#x6e;&#x61;&#x2e;&#99;&#x6f;&#109;)Reflog message: commit: add test.txtAuthor: fdipzone &#102;&#100;&#105;&#x70;&#x7a;&#x6f;&#110;&#x65;&#x40;&#x73;&#105;&#110;&#97;&#x2e;&#99;&#x6f;&#x6d;Date: Sun Jan 31 22:26:33 2016 +0800 add test.txt 123456789 2.‰ΩøÁî®git branch recover_branch[Êñ∞ÂàÜÊîØ] commit_idÂëΩ‰ª§Áî®Ëøô‰∏™commitÂàõÂª∫‰∏Ä‰∏™ÂàÜÊîØgit branch recover_branch_abc 3eac14d05bc1264cda54a7c21f04c3892f32406a git branch -a developrecover_branch_abcremotes/origin-dev/develop123456ÂèØ‰ª•ËßÅÂà∞recover_branch_abcÂ∑≤ÂàõÂª∫ 3.ÂàáÊç¢Âà∞recover_branch_abcÂàÜÊîØÔºåÊ£ÄÊü•Êñá‰ª∂ÊòØÂê¶Â≠òÂú®git checkout recover_branch_abcSwitched to branch ‚Äòrecover_branch_abc‚Äô ls -lttotal 8-rw-r‚Äìr‚Äì 1 fdipzone staff 4 1 31 22:38 test.txt123456 ËøôÊ†∑Â∞±ÂèØ‰ª•ÊÅ¢Â§çË¢´ËØØÂà†ÁöÑÂàÜÊîØ‰∫ÜÂéüÊñáÔºöhttps://blog.csdn.net/fdipzone/article/details/50616386ÁâàÊùÉÂ£∞ÊòéÔºöÊú¨Êñá‰∏∫Âçö‰∏ªÂéüÂàõÊñáÁ´†ÔºåËΩ¨ËΩΩËØ∑ÈôÑ‰∏äÂçöÊñáÈìæÊé•ÔºÅ]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golangËØªÂèñÂëΩ‰ª§Ë°å‰º†Êù•ÁöÑÂèÇÊï∞]]></title>
    <url>%2F2018%2F11%2F06%2Fgolang%E8%AF%BB%E5%8F%96%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BC%A0%E6%9D%A5%E7%9A%84%E5%8F%82%E6%95%B0%2F</url>
    <content type="text"><![CDATA[Golang-‰ΩøÁî®ÂëΩ‰ª§Ë°åÂèÇÊï∞GolangÊúâ‰∏§‰∏™Ê†áÂáÜÂåÖ‰∏≠ÈÉΩÊúâËé∑ÂæóÂëΩ‰ª§Ë°åÂèÇÊï∞ÁöÑÊñπÊ≥ïÔºö 12[*]os/ArgsÂèØ‰ª•ÁÆÄÂçïÂú∞Ëé∑Âæó‰∏Ä‰∏™Á±ª‰ººÔº£ËØ≠Ë®Ä‰∏≠ÁöÑargvÁªìÊûÑ[*]flagÂàôÊèê‰æõ‰∫Ü‰∏Ä‰∏™Êõ¥‰∏∫Â§çÊùÇÁöÑÊ†áÂøó‰∏éÂÄºÁöÑÊñπÊ≥ï os.Argsos.ArgsËøîÂõû‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑ[] string. ‰ΩøÁî®ÊñπÊ≥ïÂæàÁÆÄÂçïÔºöpackage main 12345678import ( &quot;fmt&quot; &quot;os&quot;)func main() &#123; fmt.Println(os.Args)&#125; ‰ΩøÁî®ÂëΩ‰ª§Ôºögo run test.go arg1 arg2 ÂèØËßÅËøîÂõû‰∫Ü‰∏Ä‰∏™‰∏â‰∏™ÂÖÉÁ¥†ÁöÑÊï∞ÁªÑÔºåÁ¨¨Ôºê‰∏™ÂÖÉÁ¥†ÊòØÁ®ãÂ∫èÁöÑÂêçÂ≠óÂåÖÊã¨Ë∑ØÂæÑÔºåos.ArgsÂ∞±Á¨¨‰∏Ä‰∏™ÂèÇÊï∞Ôºåos.ArgsÂ∞±ÊòØÁ¨¨‰∫å‰∏™ÂèÇÊï∞„ÄÇ flagÂåÖflagÂåÖÊèê‰æõÁöÑÂäüËÉΩÈùûÂ∏∏Â§çÊùÇ„ÄÇ ÂÆÉÂ∞ÜÂëΩ‰ª§Ë°åÂèÇÊï∞ÂàÜ‰∏∫ÈùûÊ†áÂøóÁ±ªÂèÇÊï∞(nonflag arguments)ÂíåFlagsÔºåÊ†áÂøóÂèÇÊï∞ÊòØËøôÊ†∑ÁöÑ-flagname=xÔºåÊØîÂ¶ÇËØ¥-baudrate=1200„ÄÇ ÈùûÊ†áÂøóÁ±ªÂèÇÊï∞‰∏∫arg1 arg2„ÄÇ flagÂèÇÊï∞Â§ÑÁêÜÊµÅÁ®ãÁî±‰∫éÊ†áÂøóÁ±ªÂèÇÊï∞ÊòØÂèÇÊï∞ÁöÑ‰∏ÄÈÉ®ÂàÜÔºå‰ΩÜÂèàÁâπÊÆäÔºå‰∏∫‰∫ÜÂ∞ÜÊ†áÂøóÁ±ªÂèÇÊï∞Âå∫Âà´Â§ÑÁêÜ flagÂåÖÊúâ‰∏§Á±ªÊñπÊ≥ïÔºå‰∏ÄÁ±ªÊòØflagÂ§ÑÁêÜÊñπÊ≥ïÔºåÂè¶‰∏ÄÁ±ªÊòØÊ≠£Â∏∏ÁöÑÂèÇÊï∞Â§ÑÁêÜÊñπÊ≥ï„ÄÇ Ê≠£Â∏∏ÁöÑÂèÇÊï∞Â§ÑÁêÜÊñπÊ≥ïÊ≠£Â∏∏ÂèÇÊï∞Â§ÑÁêÜÊñπÊ≥ï‰∏éos.ArgsÂ∑Æ‰∏çÂ§öÔºåËøôÈáåÊòØ‰∏Ä‰∏™ÊñπÊ≥ïÔºåflag.Args()ÔºåËøîÂõû‰πüÊòØ[]string. 1234567891011121314package mainimport ( &quot;fmt&quot;/* &quot;os/exec&quot; &quot;bytes&quot;*/ &quot;flag&quot;)func main() &#123; flag.Parse() fmt.Println(flag.Args())&#125; go run test.go arg1 arg2 Â¶ÇÊûúÊúâÊ†áÂøóÁ±ªÂèÇÊï∞Âë¢Ôºü 1go run test.go arg1 arg2 -baudrate=1200 ËøôÈáåÂÖÖÂàÜËØÅÊòé‰∫ÜÊ†áÂøóÁ±ªÂèÇÊï∞‰πüÊòØÂèÇÊï∞„ÄÇ Ê†áÂøóÁ±ªÂèÇÊï∞ParseÂâçÂÆö‰πâÂ¶ÇÊûú‰ΩøÁî®Ê†áÂøóÁ±ªÂèÇÊï∞ÔºåË¶ÅÊèêÂâçÂÆö‰πâ,ÂÆö‰πâ‰πãÂêéÂÜçË∞ÉÁî®ParseÊâçËÉΩËß£ÊûêÂá∫Êù•Ôºö 12345678910111213141516package mainimport ( &quot;fmt&quot; &quot;flag&quot;)func main() &#123; baudrate:=flag.Int(&quot;baudrate&quot;,1200, &quot;help message for flagname&quot;) databits:=flag.Int(&quot;databits&quot;,10,&quot;number of data bits&quot;) flag.Parse() fmt.Println(*baudrate) fmt.Println(*databits) fmt.Println(flag.Args())&#125;go run test.go -baudrate=9600 -databits=8 arg1 arg2 Ê†áÂøóÁ±ªÂèÇÊï∞ÂøÖÈ°ªÂú®Parse‰πãÂÆö‰πâÔºåÂê¶Âàô‰ºöÂá∫ÈîôÔºö 123456789101112131415161718192021package mainimport ( &quot;fmt&quot; &quot;flag&quot;)func main() &#123; flag.Parse() baudrate:=flag.Int(&quot;baudrate&quot;,1200, &quot;help message for flagname&quot;) databits:=flag.Int(&quot;databits&quot;,10,&quot;number of data bits&quot;) fmt.Println(*baudrate) fmt.Println(*databits) fmt.Println(flag.Args())&#125;go run test.go -baudrate=9600 -databits=8 arg1 arg2flag provided but not defined: -baudrateUsage of /tmp/go-build944578075/command-line-arguments/_obj/a.out:exit status 2 flag.IntËøîÂõûÁöÑÊòØÂú∞ÂùÄ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËøôÈáåflag.IntËøîÂõûÁöÑÂÄº‰∏∫‰∏Ä‰∏™Âú∞ÂùÄÔºå‰Ω†ÂèØ‰ª•ÈöèÊó∂Âà∞Ëøô‰∏™Âú∞ÂùÄÈáåÂéªÂèñÂÄº ‰ΩÜÂú®Parse‰πãÂâçÂèñÂÄºÔºåÂèñÂà∞ÁöÑÊòØÈªòËÆ§ÂÄºÔºåParse‰πãÂêéÂéªÈöèÂÄºÔºåÂèñÂà∞ÁöÑÊâçÊòØÁúüÊ≠£ÁöÑÂÄºÔºö 1234567891011121314151617package mainimport ( &quot;fmt&quot; &quot;flag&quot;)func main() &#123; baudrate:=flag.Int(&quot;baudrate&quot;,1200, &quot;help message for flagname&quot;) databits:=flag.Int(&quot;databits&quot;,10,&quot;number of data bits&quot;) fmt.Println(*baudrate) fmt.Println(*databits) flag.Parse() fmt.Println(flag.Args())&#125;go run test.go -baudrate=9600 -databits=8 arg1 arg2 Ê†áÂøóÁ±ªÂèÇÊï∞È°∫Â∫è Ê†áÂøóÁ±ªÂèÇÊï∞‰πãÈó¥ÁöÑÂâçÂêéÈ°∫Â∫èÂèØ‰ª•ÊîπÂèòÔºå‰ΩÜÊòØ‰ºº‰πéÊ†áÂøóÁ±ªÂèÇÊï∞ÈùûË¶ÅÊîæÂà∞ÈùûÊ†áÂøóÁ±ªÂèÇÊï∞‰πãÂâçÊâçËÉΩÊ≠£Á°ÆËß£Êûê„ÄÇ 12345678910111213141516package mainimport ( &quot;fmt&quot; &quot;flag&quot;)func main() &#123; databits:=flag.Int(&quot;databits&quot;,10,&quot;number of data bits&quot;) baudrate:=flag.Int(&quot;baudrate&quot;,1200, &quot;help message for flagname&quot;) flag.Parse() fmt.Println(*baudrate) fmt.Println(*databits) fmt.Println(flag.Args())&#125;go run test.go -baudrate=9600 -databits=8 arg1 arg2 ‰∏äÈù¢ÁöÑÂëΩ‰ª§Ê≠£Á°ÆËß£Êûê‰∫ÜÔºåË∞ÉÊç¢‰∫ÜbaudrateÂíådatabitsÁöÑÈ°∫Â∫è 1go run test.go arg1 -baudrate=9600 -databits=8 arg2 ‰∏äÂâçËøôÈáåÊ≤°ËÉΩÊ≠£Á°ÆËß£ÊûêÔºåÂèØ‰ª•baudrateÂíådatabitsÂæóÂà∞ÁöÑËøòÊòØÈªòËÆ§ÂÄºÔºåËÄåÈùûÊ†áÂøóÁ±ªÂèÇÊï∞Ëé∑ÂèñÂà∞‰∫ÜÊâÄÊúâÁöÑÂèÇÊï∞„ÄÇ ‚Äìhelp flag.IntÁöÑÊúÄÂêé‰∏Ä‰∏™ÂèÇÊï∞ÊòØhelp‰ø°ÊÅØÔºö 123456go run test.go --helpUsage of /tmp/go-build327358548/command-line-arguments/_obj/a.out: -baudrate=1200: help message for flagname -databits=10: number of data bitsexit status 2 flag.String‰º†ÂÖ•ÁöÑÂèÇÊï∞ÊòæÁÑ∂‰∏çËÉΩÈÉΩÊòØÊï∞Â≠óÔºåÂÆûÈôÖgoËØ≠Ë®ÄÊèê‰æõÁöÑÁ±ªÂûãÈÉΩÊîØÊåÅÔºå‰∏éflag.IntÁ±ª‰ººÔºåÊâÄÊúâÂÖ∂‰ªñÂáΩÊï∞ÈÉΩÊúâÔºö 1flag.String flag.Uint flag.Float64.... flag.IntVarflag.IntËøîÂõûÁöÑÊòØÊåáÈíàÔºåÁî®Ëµ∑Êù•ÂèØ‰ª•ÊúâÁÇπ‰∏çÂ§™Â•ΩÔºåflag.IntVarÂèØËÉΩÁî®Ëµ∑Êù•Êõ¥Â•ΩÁöÑ‰∫õÔºö 1234var baudrate intflag.IntVar(&amp;baudrate,&quot;baudrate&quot;,1200,&quot;baudrate of serial port&quot;)flag.Parse()fmt.Println(baudrate) ÂΩìÂâç‰Ω†‰∏ÄÊ†∑ÂèØ‰ª•Áî®flag.UintVar flag.Float64Var flag.StringVar ÂèÇÊï∞‰∏™Êï∞ÂèÇÊï∞‰∏™Êï∞‰πüÂàÜ‰∏∫Ê†áÂøóÁ±ªÂèÇÊï∞ÁöÑÈùûÊ†áÂøóÁ±ªÂèÇÊï∞Ôºå‰∏§‰∏™ÊñπÊ≥ï‰∏∫NArgÂíåNFlag, 123456789101112131415161718package mainimport ( "fmt" "flag")func main() &#123; databits:=flag.Int("databits",10,"number of data bits") baudrate:=flag.Int("baudrate",1200, "help message for flagname") flag.Parse() fmt.Println(*baudrate) fmt.Println(*databits) fmt.Println(flag.Args()) fmt.Println(flag.NArg()) fmt.Println(flag.NFlag())&#125;go run test.go -baudrate=9600 -databits=8 arg1 arg2 ‰ª•‰∏ä‰ª£Á†ÅÁöÑÊâßË°åÁöÑËøáÁ®ã‰ª•ÂèäÊâßË°åÁªìÊûúÊòØÔºö ‰ªé‰∏äÂà∞‰∏ãÊâìÂç∞Âá∫ÁöÑÂèÇÊï∞Âê´‰πâÂàÜÂà´ÊòØÔºö 1111ÔºöÊåáÂÆöÁöÑÊ†áÂøóÁ±ªÂèÇÊï∞baudrateÔºåÈªòËÆ§ÂÄºÊòØ1200ÔºåÂèØÈöèÊÑèÊõ¥ÊîπÔºõ 1011Ôºö ÊåáÂÆöÁöÑÊ†áÂøóÁ±ªÂèÇÊï∞databitsÔºåÈªòËÆ§ÂÄºÊòØ10ÔºåÂèØÈöèÊÑèÊõ¥ÊîπÔºõ [la, la]:ÈùûÊ†áÂøóÁ±ªÂèÇÊï∞‰∏∫arg1 arg2Ôºõ 2ÔºöÈùûÊ†áÂøóÁ±ªÂèÇÊï∞ÁöÑÊï∞Èáè 2ÔºöÊ†áÂøóÁ±ªÂèÇÊï∞ÁöÑÊï∞Èáè ‚Äã The End!]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySQL‰ΩøÁî®group byÂàÜÁªÑÂêéÂØπÊØèÁªÑÊìç‰Ωú]]></title>
    <url>%2F2018%2F11%2F05%2FMySQL%E4%BD%BF%E7%94%A8group-by%E5%88%86%E7%BB%84%E5%90%8E%E5%AF%B9%E6%AF%8F%E7%BB%84%E6%93%8D%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[group by Êìç‰Ωú ÂàÜÁªÑËÉΩÂ§üÂ∞ÜÊï∞ÊçÆÂàÜÊàêÂá†‰∏™ÈÄªËæëÁªÑÔºåÁÑ∂ÂêéÂØπÂÖ∂ËøõË°åËÅöÈõÜÊìç‰Ωú ÂâçÂá†Â§©ÂºÄÂèëÁöÑÊó∂ÂÄôÈÅáÂà∞ËøôÊ†∑ÁöÑ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÊúâ‰∏Ä‰∏™vender-costË°®Ôºö mysql&gt; select * from vendor-cost;+‚Äî‚Äî‚Äî+‚Äî‚Äî‚Äî‚Äî‚Äì+‚Äî‚Äî‚Äî‚Äî‚Äì+‚Äî‚Äî‚Äî‚Äì+‚Äî‚Äî‚Äî‚Äî+‚Äî‚Äî‚Äî-+‚Äî‚Äî‚Äî-+ vendor host vendor_id start_date cost +‚Äî‚Äî‚Äî+‚Äî‚Äî‚Äî‚Äî‚Äì+‚Äî‚Äî‚Äî‚Äî‚Äì+‚Äî‚Äî‚Äî‚Äì+‚Äî‚Äî‚Äî‚Äî+‚Äî‚Äî‚Äî-+‚Äî‚Äî‚Äî-+| Tencent | ins-m9faipc4 | 100014390 | 2018-10 | 0.015456 || ‚Äî‚Äî- | ‚Äî‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî | ‚Äî‚Äî- | ‚Äî‚Äî‚Äì || | | | | || Tencent | ins-r76jxurv | 100015923 | 2018-10 | 0.284697 || ‚Äî‚Äî- | ‚Äî‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî | ‚Äî‚Äî- | ‚Äî‚Äî‚Äì || | | | | || Tencent | ins-ramdkuqz | 100015923 | 2018-10 | 0.021175 || ‚Äî‚Äî- | ‚Äî‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî | ‚Äî‚Äî- | ‚Äî‚Äî‚Äì || | | | | || Tencent | ins-q7o1dhsa | 100014390 | 2018-10 | 0.113501 || ‚Äî‚Äî- | ‚Äî‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî | ‚Äî‚Äî- | ‚Äî‚Äî‚Äì || | | | | || Tencent | ins-5xxrgd65 | 100015923 | 2018-10 | 0.058623 || ‚Äî‚Äî- | ‚Äî‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî | ‚Äî‚Äî- | ‚Äî‚Äî‚Äì || | | | | || Tencent | ins-79g28kn6 | 100015923 | 2018-10 | 0.03808 || ‚Äî‚Äî- | ‚Äî‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî | ‚Äî‚Äî- | ‚Äî‚Äî- || | | | | || Tencent | ins-rw54ka4k | 100015923 | 2018-10 | 0.150595 || ‚Äî‚Äî- | ‚Äî‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî | ‚Äî‚Äî- | ‚Äî‚Äî‚Äì || | | | | || Tencent | ins-ggxrtm1v | 100015923 | 2018-10 | 0.068281 || ‚Äî‚Äî- | ‚Äî‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî | ‚Äî‚Äî- | ‚Äî‚Äî‚Äì || | | | | |‰∏∫‰∫ÜÁªüËÆ°Âá∫ÊØè‰∏™vendor_idÁöÑcostÔºåÂ∞±ÈúÄË¶Å‰ΩøÁî®ÂàÜÁªÑËØ≠Âè•ÔºåÂ∞ÜÂêå‰∏Ä‰∏™vendor_idÁöÑcostÊ±ÇÂíåÔºö select vendor_id, sum(cost) from vendor_cost group by vendor_id; ÂæóÂá∫ÁöÑÁªìÊûúÂ∞±ÊòØÊØè‰∏™vendor_idÁöÑÊÄªcost„ÄÇ ËøòÊúâ‰∏ÄÁßçgroup byÁöÑÁî®Ê≥ïÔºöGROUP BY X, YÊÑèÊÄùÊòØÂ∞ÜÊâÄÊúâÂÖ∑ÊúâÁõ∏ÂêåXÂ≠óÊÆµÂÄºÂíåYÂ≠óÊÆµÂÄºÁöÑËÆ∞ÂΩïÊîæÂà∞‰∏Ä‰∏™ÂàÜÁªÑÈáå„ÄÇ ‰∏æ‰∏™Ê†óÂ≠êÔºö Áé∞Âú®ÊúâË°®Ê†º Table: Subject_Selection Subject Semester AttendeeITB001 1 JohnITB001 1 BobITB001 1 MickeyITB001 2 JennyITB001 2 JamesMKB114 1 JohnMKB114 1 Erica Êàë‰ª¨‰∏ãÈù¢ÂÜçÊé•ÁùÄË¶ÅÊ±ÇÁªüËÆ°Âá∫ÊØèÈó®Â≠¶ÁßëÊØè‰∏™Â≠¶ÊúüÊúâÂ§öÂ∞ë‰∫∫ÈÄâÊã©ÔºåÂ∫îÁî®Â¶Ç‰∏ãSQL 123SELECT Subject, Semester, Count(*)FROM Subject_SelectionGROUP BY Subject, Semester ÂæóÂà∞ÁöÑÁªìÊûúÊòØÔºö ÂæóÂà∞ÁöÑÁªìÊûúÊòØÔºö12345Subject Semester Count------------------------------ITB001 1 3ITB001 2 2MKB114 1 2 ‰ªéË°®‰∏≠ÁöÑËÆ∞ÂΩïÊàë‰ª¨ÂèØ‰ª•ÁúãÂá∫Ëøô‰∏™ÂàÜÁªÑÁªìÊûúÊòØÊ≠£Á°ÆÁöÑÊúâ3‰∏™Â≠¶ÁîüÂú®Á¨¨‰∏ÄÂ≠¶ÊúüÈÄâÊã©‰∫ÜITB001, 2‰∏™Â≠¶ÁîüÂú®Á¨¨‰∫åÂ≠¶ÊúüÈÄâÊã©‰∫ÜITB001,ËøòÊúâ‰∏§‰∏™Â≠¶ÁîüÂú®Á¨¨‰∏ÄÂ≠¶ÊúüÈÄâÊã©‰∫ÜMKB114, Ê≤°‰∫∫Âú®Á¨¨‰∫åÂ≠¶ÊúüÈÄâÊã©MKB114„ÄÇ]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golang xorm Êìç‰ΩúÊåáÂçó]]></title>
    <url>%2F2018%2F10%2F31%2Fgolang-xorm-%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97%2F</url>
    <content type="text"><![CDATA[https://www.kancloud.cn/xormplus/xorm/167077]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊäÄÊúØÂë®Âàä‰πãgolang‰∏≠‰øÆÊîπstructÁöÑsliceÁöÑÂÄº]]></title>
    <url>%2F2018%2F10%2F27%2F%E6%8A%80%E6%9C%AF%E5%91%A8%E5%88%8A%E4%B9%8Bgolang%E4%B8%AD%E4%BF%AE%E6%94%B9struct%E7%9A%84slice%E7%9A%84%E5%80%BC%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÂâçÊÆµÊó∂Èó¥ÂÜôgoÁöÑÊó∂ÂÄôÈÅáÂà∞‰∏Ä‰∏™ÈóÆÈ¢òÔºåÈúÄË¶Å‰øÆÊîπÁî±structÊûÑÊàêÁöÑslice‰∏≠structÁöÑÊüê‰∏™Â≠óÊÆµÂÄºÔºåÁ±ª‰ºº‰∫é‰∏ãÈù¢ÁöÑÈúÄÊ±ÇÔºö 1234567891011121314151617181920type Docker struct &#123; Ip string ID string&#125;docker1 := Docker&#123; Ip: "222", ID: "aaa", &#125; docker2 := Docker&#123; Ip: "111", ID: "bbb", &#125; var tmpDocker []Docker tmpDocker = append(tmpDocker, docker1) tmpDocker = append(tmpDocker, docker2) Áé∞Âú®ÈúÄË¶Å‰øÆÊîπtmpDocker‰∏≠ÔºåIpËøô‰∏™Â≠óÊÆµÁöÑÂÄº, ‰Ω†ÂèØ‰ª•ÂÖàËá™Â∑±Â∞ùËØï‰øÆÊîπ‰∏Ä‰∏ãÔºåÁÑ∂ÂêéÂÜçÂæÄ‰∏ãÁúã Áî±Ëøô‰∏™ÈóÆÈ¢òÊàëÊü•ÈòÖÂæàÂ§öËµÑÊñôÔºåÊàë‰ª¨ÂÖà‰ªéËØ≠Ë®Ä‰∏≠ÁªèÂÖ∏ÁöÑ‰º†ÂÄº„ÄÅ‰º†ÂºïÁî®ËØ¥Ëµ∑Êù• ÂØπ‰∫é‰∏ÄÈó®ËØ≠Ë®ÄÔºåÊàë‰ª¨ÂÖ≥ÂøÉ‰º†ÈÄíÂèÇÊï∞ÁöÑËøáÁ®ã‰∏≠ÔºåÊòØ‰º†ÂÄºËøòÊòØ‰º†ÂºïÁî®ÔºåÂÖ∂ÂÆûÂØπ‰∫é‰º†ÂÄºÂíå‰º†ÂºïÁî®ÊòØ‰∏Ä‰∏™ÊØîËæÉÂè§ËÄÅÁöÑÈóÆÈ¢òÔºåÂú®Â§ßÂ≠¶ÂÖ•Èó®ÁöÑÊó∂ÂÄôÔºå‰Ω†ÂèØËÉΩÂ∞±Êé•Ëß¶ËøáËøôÊ†∑ÁöÑCËØ≠Ë®Ä‰ª£Á†ÅÔºö 12345678910111213141516171819//‰ª•‰∏ãÂì™‰∏™ÂáΩÊï∞ËÉΩÂÆûÁé∞‰∫§Êç¢‰∏§‰∏™Êï∞Ôºü#include&lt;iostream&gt;using namespace std; void swap1(int p,int q)&#123; int temp; temp=p; p=q; q=temp;&#125; void swap2(int *p,int *q)&#123; int *temp; *temp=*p; *p=*q; *q=*temp;&#125; ÂÖ∂ÂÆûÂØπ‰∫éCËØ≠Ë®ÄÊù•ËØ¥ÔºåÂπ∂Ê≤°Êúâ‰º†ÂºïÁî®ÁöÑÊ¶ÇÂøµÔºåÁúã‰ºº‰º†ÂºïÁî®ÁöÑÊìçÊéßÔºåÂÆûÈôÖ‰∏ä‰º†ÁöÑÊòØÊåáÈíàÁöÑÂú∞ÂùÄÔºå‰πüÁÆóÊòØ‰∏ÄÁßç‰º†ÂÄºÔºåÂÖàÁúã‰∏Ä‰∏ã‰º†ÂÄºÔºå‰º†ÂºïÁî®Ôºå‰º†ÊåáÈíàÁöÑÊ¶ÇÂøµÔºö ‰º†ÂÄºÔºöÂèØËÉΩÂæàÂ§ö‰∫∫ÈÉΩÂê¨ËØ¥Ôºå‰º†ÂÄºÊó†ÈùûÂ∞±ÊòØÂÆûÂèÇÊã∑Ë¥ù‰º†ÈÄíÁªôÂΩ¢ÂèÇ„ÄÇËøôÂè•ËØùÊ≤°ÊúâÈîôÔºå‰ΩÜÊòØÁêÜËß£Ëµ∑Êù•ËøòÊòØÊúâÁÇπÊäΩË±°„ÄÇ‰∏ÄÂè•ËØùÔºå‰º†ÂÄºÂ∞±ÊòØÊääÂÆûÂèÇËµãÂÄºÁªôÂΩ¢ÂèÇÔºåËµãÂÄºÂÆåÊØïÂêéÂÆûÂèÇÂ∞±ÂíåÂΩ¢ÂèÇÊ≤°Êúâ‰ªª‰ΩïËÅîÁ≥ªÔºåÂØπÂΩ¢ÂèÇÁöÑ‰øÆÊîπÂ∞±‰∏ç‰ºöÂΩ±ÂìçÂà∞ÂÆûÂèÇ„ÄÇ ‰º†Âú∞ÂùÄÔºö‰∏∫‰ªÄ‰πàËØ¥‰º†Âú∞ÂùÄ‰πüÊòØ‰∏ÄÁßç‰º†ÂÄºÂë¢ÔºüÂõ†‰∏∫‰º†Âú∞ÂùÄÊòØÊääÂÆûÂèÇÂú∞ÂùÄÁöÑÊã∑Ë¥ù‰º†ÈÄíÁªôÂΩ¢ÂèÇ„ÄÇËøòÊòØ‰∏ÄÂè•ËØùÔºå‰º†Âú∞ÂùÄÂ∞±ÊòØÊääÂÆûÂèÇÁöÑÂú∞ÂùÄÂ§çÂà∂ÁªôÂΩ¢ÂèÇ„ÄÇÂ§çÂà∂ÂÆåÊØïÂêéÂÆûÂèÇÁöÑÂú∞ÂùÄÂíåÂΩ¢ÂèÇÁöÑÂú∞ÂùÄÊ≤°Êúâ‰ªª‰ΩïËÅîÁ≥ªÔºåÂØπÂÆûÂèÇÂΩ¢ÂèÇÂú∞ÂùÄÁöÑ‰øÆÊîπ‰∏ç‰ºöÂΩ±ÂìçÂà∞ÂÆûÂèÇ, ‰ΩÜÊòØÂØπÂΩ¢ÂèÇÂú∞ÂùÄÊâÄÊåáÂêëÂØπË±°ÁöÑ‰øÆÊîπÂç¥Áõ¥Êé•ÂèçÂ∫îÂú®ÂÆûÂèÇ‰∏≠ÔºåÂõ†‰∏∫ÂΩ¢ÂèÇÊåáÂêëÁöÑÂØπË±°Â∞±ÊòØÂΩ¢ÂèÇÁöÑÂØπË±°„ÄÇ ‰º†ÂºïÁî®Ôºö‰º†ÂºïÁî®Êú¨Ë¥®Ê≤°Êúâ‰ªª‰ΩïÂÆûÂèÇÁöÑÊã∑Ë¥ùÔºå‰∏ÄÂè•ËØùÔºåÂ∞±ÊòØËÆ©Âè¶Â§ñ‰∏Ä‰∏™ÂèòÈáè‰πüÊâßË°åËØ•ÂÆûÂèÇ„ÄÇÂ∞±ÊòØ‰∏§‰∏™ÂèòÈáèÊåáÂêëÂêå‰∏Ä‰∏™ÂØπË±°„ÄÇËøôÊòØÂØπÂΩ¢ÂèÇÁöÑ‰øÆÊîπÔºåÂøÖÁÑ∂ÂèçÊò†Âà∞ÂÆûÂèÇ‰∏ä„ÄÇ ÈÇ£‰πàÂØπ‰∫égoËØ≠Ë®ÄÊù•ËØ¥ÔºåÊòØÊ≤°ÊúâÂºïÁî®‰º†ÈÄíÁöÑÔºågo‰Ωú‰∏∫‰∫ëËÆ°ÁÆóÊó∂‰ª£ÁöÑCËØ≠Ë®ÄÔºåÈááÁî®ÁöÑÈÉΩÊòØÂÄº‰º†ÈÄíÔºåÂç≥‰ΩøÊòØÊåáÈíàÔºå‰πüÊòØÂ∞ÜÊåáÈíàÁöÑÂú∞ÂùÄÂç≥ÊåáÈíàÁöÑÊåáÈíàÔºåÊã∑Ë¥ù‰∏Ä‰ªΩ‰º†ÈÄíÔºåÂèØ‰ª•ÂèÇËÄÉËøôÁØáÂçöÊñáÁöÑËÆ≤Ëß£ÔºöGoËØ≠Ë®ÄÂèÇÊï∞‰º†ÈÄíÊòØ‰º†ÂÄºËøòÊòØ‰º†ÂºïÁî® ÂõûÂà∞Ê≠£È¢ò ‰∫ÜËß£Âü∫Êú¨ÁöÑÁü•ËØÜËÉåÊôØ‰πãÂêéÔºåËÆ©Êàë‰ª¨ÂõûÂà∞ÊñáÁ´†ÂºÄÂ§¥ÁöÑ‰ª£Á†ÅÔºåÂç≥Ë¶Å‰øÆÊîπslice‰∏≠structÊüêÂ≠óÊÆµÁöÑÂÄº„ÄÇ 123456789101112131415161718type Docker struct &#123; Ip string ID string&#125;docker1 := Docker&#123; Ip: &quot;222&quot;, ID: &quot;aaa&quot;, &#125; docker2 := Docker&#123; Ip: &quot;111&quot;, ID: &quot;bbb&quot;, &#125; var tmpDocker []Docker tmpDocker = append(tmpDocker, docker1) tmpDocker = append(tmpDocker, docker2) ÂÖàÂ∞ÜÊàëÊúÄÂàùÁöÑ‰ª£Á†ÅÂÆûÁé∞Ë¥¥Âá∫Êù•Ôºö 12345 for _, dockerInfo := range tmpDocker &#123; dockerInfo.Ip = "192.168,.1.1"&#125;fmt.Println(tmpDocker) ËÆ©Êàë‰ª¨Áúã‰∏Ä‰∏ãËøêË°åÁªìÊûúÔºö ÂèëÁé∞struct‰∏≠IpÂ≠óÊÆµÁöÑÂÄºÂπ∂Ê≤°ÊúâÊîπÂèòÔºåÊòØ‰∏∫‰ªÄ‰πàÂë¢Ôºü ÂéüÂõ†Â∞±ÊòØÔºörangeÁöÑËøáÁ®ã‰∏≠‰∫ßÁîü‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÂØπË±°ÔºåÂç≥dockerInfoÊòØtemDocker‰∏≠ÊØè‰∏™ÂÖÉÁ¥†ÁöÑ‰∏Ä‰∏™ÂâØÊú¨ÔºåÊâÄ‰ª•‰Ω†ÊîπÂèòÁöÑÂè™ÊòØÂâØÊú¨‰∏≠IpÂ≠óÊÆµÁöÑÂÄºÔºåÂπ∂Ê≤°ÊúâÊîπÂèòÁúüÂÆûÁöÑ„ÄÇÈÇ£‰πàÂ¶Ç‰ΩïËß£ÂÜ≥Âë¢? ËøôÈáåÊàëÊèêÂá∫‰∏§ÁßçËß£ÂÜ≥ÁöÑÊñπÊ≥ïÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567//ÊñπÊ≥ï1ÔºöËµãÁªô‰∏Ä‰∏™Êñ∞ÁöÑÂØπË±°newTmpDocker := []Docker&#123;&#125;//Êñ∞ÁöÑÂØπË±°for _, dockerInfo := range tmpDocker &#123; dockerInfo.Ip = "192.168.1.1" newTmpDocker = append(newTmpDocker, dockerInfo)&#125;fmt.Println(newTmpDocker) ÂèØ‰ª•ÁúãÂà∞ÊúÄÁªàËæìÂá∫ÁöÑstructÁöÑslice‰∏≠Êàë‰ª¨ÊÉ≥Ë¶ÅÊîπÂèòÁöÑÂ≠óÊÆµÂ∑≤Áªè‰øÆÊîπÊàêÂäü„ÄÇ Á¨¨‰∫åÁßçÊñπÊ≥ïÊòØÂ∞ÜÂâØÊú¨‰øÆÊîπÂêéËµãÂÄº 123456ÊñπÊ≥ï2Ôºö‰øÆÊîπÂâØÊú¨ÂêéÔºåÂ∞ÜÂâØÊú¨ËµãÂÄºÁªôÂéüÊù•ÁöÑfor i, dockerInfo := range tmpDocker&#123; dockerInfo.Ip = "192.168.1.1" tmpDocker[i] = dockerInfo&#125;fmt.Println(tmpDocker) ËøêË°åÁªìÊûúÔºö ÂèØ‰ª•ÁúãÂà∞ÂêåÊ†∑‰øÆÊîπÊàêÂäü„ÄÇ ÊÄªÁªìÔºåÂú®go‰∏≠ÔºåÊâÄÊúâ‰º†ÂèÇÈÉΩÊòØ‰º†ÂÄºÔºåÈÉΩÊòØ‰∏Ä‰∏™ÂâØÊú¨ÔºåÂç≥‰∏Ä‰∏™Êã∑Ë¥ùÔºåÂõ†‰∏∫Êã∑Ë¥ùÁöÑÂÜÖÂÆπÊúâÊó∂ÂÄôÊòØÈùûÂºïÁî®Á±ªÂûãÔºàint„ÄÅstring„ÄÅstructÁ≠âËøô‰∫õÔºâÔºåËøôÊ†∑Â∞±Âú®ÂáΩÊï∞‰∏≠Â∞±Êó†Ê≥ï‰øÆÊîπÂéüÂÜÖÂÆπÊï∞ÊçÆÔºõÊúâÁöÑÊòØÂºïÁî®Á±ªÂûãÔºàÊåáÈíà„ÄÅmap„ÄÅslice„ÄÅchanÁ≠âËøô‰∫õÔºâÔºåËøôÊ†∑Â∞±ÂèØ‰ª•‰øÆÊîπÂéüÂÜÖÂÆπÊï∞ÊçÆ„ÄÇÊòØÂê¶ÂèØ‰ª•‰øÆÊîπÂéüÂÜÖÂÆπÊï∞ÊçÆÔºåÂíå‰º†ÂÄº„ÄÅ‰º†ÂºïÁî®Ê≤°ÊúâÂøÖÁÑ∂ÁöÑÂÖ≥Á≥ª„ÄÇÂú®C++‰∏≠Ôºå‰º†ÂºïÁî®ËÇØÂÆöÊòØÂèØ‰ª•‰øÆÊîπÂéüÂÜÖÂÆπÊï∞ÊçÆÁöÑÔºåÂú®GoËØ≠Ë®ÄÈáåÔºåËôΩÁÑ∂Âè™Êúâ‰º†ÂÄºÔºå‰ΩÜÊòØÊàë‰ª¨‰πüÂèØ‰ª•‰øÆÊîπÂéüÂÜÖÂÆπÊï∞ÊçÆÔºåÂõ†‰∏∫ÂèÇÊï∞ÊòØÂºïÁî®Á±ªÂûã„ÄÇ ËøôÈáå‰πüË¶ÅËÆ∞‰ΩèÔºåÂºïÁî®Á±ªÂûãÂíå‰º†ÂºïÁî®ÊòØ‰∏§‰∏™Ê¶ÇÂøµ„ÄÇ ÂÜçËÆ∞‰ΩèÔºåGoÈáåÂè™Êúâ‰º†ÂÄºÔºàÂÄº‰º†ÈÄíÔºâ„ÄÇ]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>ÊäÄÊúØÂë®Âàä</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golang‰∏≠string,rune,byteÁöÑÂÖ≥Á≥ª]]></title>
    <url>%2F2018%2F10%2F25%2Fgolang%E4%B8%ADstring-rune-byte%E7%9A%84%E5%85%B3%E7%B3%BB%2F</url>
    <content type="text"><![CDATA[golang‰∏≠StringÁöÑÂ∫ïÂ±ÇÊòØ‰ΩøÁî®byte[]Êï∞ÁªÑÂ≠òÂÇ®ÁöÑÔºå‰∏çÂèØÊîπÂèò 12str := "Golang ÊµãËØï"fmt.Println(len(str)) ËøôÊÆµ‰ª£Á†ÅÊåâÈÅìÁêÜÂ∫îËØ•ËæìÂá∫6+1+2. ÂÆûÈôÖËøêË°å‰πãÂêéËæìÂá∫Âç¥ÊòØ13Ôºå ÂéüÂõ†ÊòØ‰∏≠ÊñáÂ≠óÁ¨¶Âú®utf-8ÁºñÁ†ÅÁöÑÁ≥ªÁªü‰∏≠ÊòØ3‰∏™Â≠óËäÇÂ≠òÂÇ®ÁöÑÔºåÂú®Unicode‰∏≠ÊòØ2‰∏™Â≠óËäÇÂ≠òÂÇ®ÁöÑÔºågoÁöÑÈªòËÆ§ÁºñÁ†ÅÊ†ºÂºèÊòØutf-8Ôºåso„ÄÇ„ÄÇ ËøôÊó∂ÂÄôÔºåÊàë‰ª¨‰ΩøÁî®‰∏ãÊ†áËÆøÈóÆÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑ‰∏≠ÊñáÂ≠óÁ¨¶ÊòØ‰∏çË°åÁöÑÔºåÊÉ≥Ë¶Å‰ΩøÁî®‰∏ãÊ†áËÆøÈóÆÔºåÂ∞±ÈúÄË¶ÅruneÂá∫È©¨„ÄÇ Âú®ÂÆòÊñπÊñáÊ°£‰∏≠ÔºåruneÁöÑÂÆö‰πâÊòØÔºö 123456 rune is an alias for int32 and is equivalent to int32 in all ways. It is used, by convention, to distinguish character values from integer values.int32ÁöÑÂà´ÂêçÔºåÂá†‰πéÂú®ÊâÄÊúâÊñπÈù¢Á≠âÂêå‰∫éint32ÂÆÉÁî®Êù•Âå∫ÂàÜÂ≠óÁ¨¶ÂÄºÂíåÊï¥Êï∞ÂÄºtype rune int32 ÈÇ£‰πàÊàë‰ª¨ÊÉ≥Ë¶ÅÂæóÂà∞È¢ÑÊúüÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶ÔºåÂ∞±Ë¶Å‰ΩøÁî®runeÂàáÁâáÊù•ÂÆûÁé∞„ÄÇ 1fmt.Println("rune:", len([]rune(str))) Â∞±‰ºöËæìÂá∫È¢ÑÊúüÁöÑrune: 9. ËøôÊó∂Êàë‰ª¨‰πüÂèØ‰ª•ÊåâÁÖß‰∏ãÊ†áÂéªËÆøÈóÆstr‰∏≠ÁöÑÂ≠óÁ¨¶‰∫Ü„ÄÇÂç≥[7]rune(str) = ‚ÄúÊµã‚Äù„ÄÇ 3.ÊÄªÁªì stringÁöÑÂ∫ïÂ±ÇÊòØbyteÔºåbyte‰∏éruneÁöÑ‰∏çÂêå‰πãÂ§ÑÊòØÔºö byte Á≠âÂêå‰∫éint8ÔºåÂ∏∏Áî®Êù•Â§ÑÁêÜasciiÂ≠óÁ¨¶rune Á≠âÂêå‰∫éint32,Â∏∏Áî®Êù•Â§ÑÁêÜunicodeÊàñutf-8Â≠óÁ¨¶ ÊàñËÄÖÂèØ‰ª•ËøôÊ†∑ËØ¥Ôºö rune ËÉΩÊìç‰Ωú‰ªª‰ΩïÂ≠óÁ¨¶byte ‰∏çÊîØÊåÅ‰∏≠ÊñáÁöÑÊìç‰Ωú ‚Äã END]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∏äÊµ∑QCon‰πãGo‰∏ìÂÆ∂David CheneyÂÖ≥‰∫éGOÊúÄ‰Ω≥ÂÆûË∑µÁöÑÊºîËÆ≤]]></title>
    <url>%2F2018%2F10%2F21%2F%E4%B8%8A%E6%B5%B7QCon%E4%B9%8BGo%E4%B8%93%E5%AE%B6David-Cheney%E5%85%B3%E4%BA%8EGO%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E7%9A%84%E6%BC%94%E8%AE%B2%2F</url>
    <content type="text"><![CDATA[Êú¨Âë®ÂÖ≠ÊúâÂπ∏ÂèÇÂä†‰∫Ü2018QCon‰∏äÊµ∑ÁöÑ‰ºöËÆÆÔºåÂê¨‰∫ÜDavidÂÖ≥‰∫éGOÊúÄ‰Ω≥ÂÆûË∑µÁöÑ‰∏Ä‰∫õÂª∫ËÆÆÔºå‰∏ãÈù¢Ë¥¥Âá∫ÁöÑÂ∞±ÊòØDavidÁöÑÊºîËÆ≤Á®øÔºåÂÜÖÂÆπÁõ∏ÂØπÊù•ËØ¥ÊØîËæÉÂü∫Á°ÄÔºå‰ΩÜÊòØÂèàÊòØÁºñÁ®ã‰∏≠‰∏çÂèØÈÅøÂÖçÁöÑ‰∏Ä‰∫õÈóÆÈ¢òÔºåÂ∏åÊúõÂèØ‰ª•ÁªôÂ§ßÂÆ∂Â∏¶Êù•‰∏Ä‰∫õÂêØÂèë„ÄÇ Table of Contents Introduction \1. Guiding principles 1.1. Simplicity 1.2. Readability 1.3. Productivity \2. Identiers 2.1. Choose identiers for clarity, not brevity 2.2. Identier length 2.3. Don‚Äôt name your variables for their types 2.4. Use a consistent naming style 2.5. Use a consistent declaration style 2.6. Be a team player \3. Comments 3.1. Comments on variables and constants should describe their contents not their purpose 3.2. Always document public symbols \4. Package Design 4.1. A good package starts with its name 4.2. Avoid package names like base , common , or util 4.3. Return early rather than nesting deeply 4.4. Make the zero value useful 4.5. Avoid package level state \5. Project Structure 5.1. Consider fewer, larger packages 5.2. Keep package main small as small as possible \6. API Design 6.1. Design APIs that are hard to misuse. 6.2. Design APIs for their default use case 6.3. Let functions dene the behaviour they requires \7. Error handling 7.1. Eliminate error handling by eliminating errors 7.2. Only handle an error once \8. Concurrency 8.1. Keep yourself busy or do the work yourself 8.2. Leave concurrency to the caller 8.3. Never start a goroutine without when it will stop. Introduction Hello, My goal over the next two sessions is to give you my advice for best practices writing Go code. https://dave.cheney.net/practical-go/presentations/qcon-china.html 1/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs This is a workshop style presentation, I‚Äôm going to dispense with the usual slide deck and we‚Äôll work directly from the document which you can take away with you today. TIP You can find the latest version of this presentation at https://dave.cheney.net/practical-go/presentations/qcon-china.html \1. Guiding principles If I‚Äôm going to talk about best practices in any programming language I need some way to define what I mean by best. If you came to my keynote yesterday you would have seen this quote from the Go team lead, Russ Cox: ‚ÄúSoftware engineering is what happens to programming when you add time and other programmers. ‚Äî Russ Cox Russ is making the distinction between software programming and software engineering. The former is a program you write for yourself. The latter is a product that many people will work on over time. Engineers will come and go, teams will grow and shrink over time, requirements will change, features will be added and bugs fixed. This is the nature of software engineering. I‚Äôm possibly one of the earliest users of Go in this room, but to argue that my seniority gives my views more weight is false. Instead, the advice I‚Äôm going to present today is informed by what I believe to be the guiding principles underlying Go itself. They are: \1. Simplicity \2. Readability 3. Productivity NOTE You‚Äôll note that I didn‚Äôt say performance, or concurrency. There are languages which are a bit faster than Go, but they‚Äôre certainly not as simple as Go. There are languages which make concurrency their highest goal, but they are not as readable, nor as productive. Performance and concurrency are important attributes, but not as important as simplicity, readability, and productivity. 1.1. Simplicity Why should we strive for simplicity? Why is important that Go programs be simple? We‚Äôve all been in a situation where you say ‚ÄúI can‚Äôt understand this code‚Äù, yes? We‚Äôve all worked on programs where you‚Äôre scared to make a change because you‚Äôre worried it‚Äôll break another part of the program; a part you don‚Äôt understand and don‚Äôt know how to fix. This is complexity. Complexity turns reliable software in unreliable software. Complexity is what kills software projects. Simplicity is the highest goal of Go. Whatever programs we write, we should be able to agree that they are simple. 1.2. Readability ‚Äúhttps://dave.cheney.net/practical-go/presentations/qcon-china.html 2/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs ‚ÄúReadability is essential for maintainability. ‚Äî Mark Reinhold JVM language summit 2018 Why is it important that Go code be readable? Why should we strive for readability? ‚ÄúPrograms must be written for people to read, and only incidentally for machines to execute. ‚Äî Hal Abelson and Gerald Sussman Structure and Interpretation of Computer Programs Readability is important because all software, not just Go programs, is written by humans to be read by other humans. The fact that software is also consumed by machines is secondary. Code is read many more times than it is written. A single piece of code will, over its lifetime, be read hundreds, maybe thousands of times. ‚ÄúThe most important skill for a programmer is the ability to effectively communicate ideas. ‚Äî GastoÃÅn Jorquera [1] Readability is key to being able to understand what the program is doing. If you can‚Äôt understand what a program is doing, how can you hope to maintain it? If software cannot be maintained, then it will be rewritten; and that could be the last time your company will invest in Go. If you‚Äôre writing a program for yourself, maybe it only has to run once, or you‚Äôre the only person who‚Äôll ever see it, then do what ever works for you. But if this is a piece of software that more than one person will contribute to, or that will be used by people over a long enough time that requirements, features, or the environment it runs in changes, then your goal must be for your program to be maintainable. The first step towards writing maintainable code is making sure the code is readable. ‚Äú1.3. Productivity Design is the art of arranging code to work today, and be changeable forever. ‚Äî Sandi Metz The last underlying principle I want to highlight is productivity. Developer productivity is a sprawling topic but it boils down to this; how much time do you spend doing useful work verses waiting for your tools or hopelessly lost in a foreign code-base. Go programmers should feel that they can get a lot done with Go. The joke goes that Go was designed while waiting for a C++ program to compile. Fast compilation is a key feature of Go and a key recruiting tool to attract new developers. While compilation speed remains a constant battleground, it is fair to say that compilations which take minutes in other languages, take seconds in Go. This helps Go developers feel as productive as their counterparts working in dynamic languages without the reliability issues inherent in those languages. More fundamental to the question of developer productivity, Go programmers realise that code is written to be read and so place the act of reading code above the act of writing it. Go goes so far as to enforce, via tooling and custom, that all code be formatted in a specific style. This removes the friction of learning a project specific dialect and helps spot mistakes because they just look incorrect. Go programmers don‚Äôt spend days debugging inscrutable compile errors. They don‚Äôt waste days with complicated build scripts or deploying code to production. And most importantly they don‚Äôt spend their time trying to understand what their coworker wrote. https://dave.cheney.net/practical-go/presentations/qcon-china.html 3/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Productivity is what the Go team talk about when they say the language must scale. 2. Identiers The first topic we‚Äôre going to discuss is identifiers. An identifier is a fancy word for a name; the name of a variable, the name of a function, the name of a method, the name of a type, the name of a package, and so on. ‚ÄúPoor naming is symptomatic of poor design. ‚Äî Dave Cheney Given the limited syntax of Go, the names we choose for things in our programs have an oversized impact on the readability of our programs. Readability is the defining quality of good code thus choosing good names is crucial to the readability of Go code. ‚Äú2.1. Choose identiers for clarity, not brevity Obvious code is important. What you can do in one line you should do in three. ‚Äî Ukiah Smith Go is not a language that optimises for clever one liners. Go is not a language which optimises for the least number of lines in a program. We‚Äôre not optimising for the size of the source code on disk, nor how long it takes to type. ‚ÄúGood naming is like a good joke. If you have to explain it, it‚Äôs not funny. ‚Äî Dave Cheney Key to this clarity is the names we choose for identifies in Go programs. Let‚Äôs talk about the qualities of a good name: A good name is concise. A good name need not be the shortest it can possibly be, but a good name should waste no space on things which are extraneous. Good names have a high signal to noise ratio. A good name is descriptive. A good name should describe the application of a variable or constant, not their contents. A good name should describe the result of a function, or behaviour of a method, not their operation. A good name should describe the purpose of a package, not its contents. The more accurately a name describes the thing it identifies, the better the name. A good name is should be predictable. You should be able to infer the way a name will be used from its name alone. This is a function of choosing descriptive names, but it also about following tradition. This is what Go programmers talk about when they say idiomatic. Let‚Äôs talk about each of these properties in depth. 2.2. Identier length Sometimes people criticise the Go style for recommending short variable names. As Rob Pike said, ‚ÄúGo programmers want the right length identifiers‚Äù. [1] Andrew Gerrand suggests that by using longer identifies for some things we indicate to the reader that they are of higher importance. ‚ÄúThe greater the distance between a name‚Äôs declaration and its uses, the longer the name should be. ‚Äî Andrew Gerrand [2] From this we can draw some guidelines: https://dave.cheney.net/practical-go/presentations/qcon-china.html 4/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Short variable names work well when the distance between their declaration and last use is short. Long variable names need to justify themselves; the longer they are the more value they need to provide. Lengthy bureaucratic names carry a low amount of signal compared to their weight on the page. Don‚Äôt include the name of your type in the name of your variable. Constants should describe the value they hold, not how that value is used. Single letter variables for loops and branches, single words for parameters and return values, multiple words for functions and package level declarations Single words for methods, interfaces, and packages. Remember that the name of a package is part of the name the caller uses to to refer to it, so make use of that. Let‚Äôs look at an example to 12type Person struct &#123; Name string Age int } 1234// AverageAge returns the average age of people.func AverageAge(people []Person) int &#123; if len(people) == 0 &#123; return 0 } 12var count, sum intfor _, p := range people &#123; sum += p.Age count += 1 } 12 return sum / count&#125; GO In this example, the range variable p is declared on line 10 and only referenced on the following line. p lives for a very short time both on the page, and during the execution of the function. A reader who is interested in the effect values of p have on the program need only read two lines. By comparison people is declared in the function parameters and lives for seven lines. The same is true for sum , and count , thus they justify their longer names. The reader has to scan a wider number of lines to locate them so they are given more distinctive names. I could have chosen s for sum and c (or possibly n ) for but this would have reduced all the variables in the program to the same level of importance. I could have chosen instead of but that would have left the problem of what to call the for ‚Ä¶ range iteration variable. The singular would look odd as the loop iteration variable which lives for little time has a longer name than the slice of values it was derived from. count TIP Use blank lines to break up the flow of a function in the same way you use paragraphs to break up the flow of a document. In AverageAge we have three operations occurring in sequence. The first is the precondition, checking that we don‚Äôt divide by zero if people is empty, the second is the accumulation of the sum and count, and the final is the computation of the average. 2.2.1. Context is key https://dave.cheney.net/practical-go/presentations/qcon-china.html 5/45 p people person 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs It‚Äôs important to recognise that most advice on naming is contextual. I like to say it is a principle, not a rule. What is the difference between two identifiers, i , and index . We cannot say conclusively that one is better than another, for example is fundamentally more readable than I argue it is not, because it is likely the scope of i , and index for that matter, is limited to the body of the for loop and the extra verbosity of the latter adds little to comprehension of the program. However, which of these functions is more readable? 1func (s *SNMP) Fetch(oid []int, index int) (int, error) or 1func (s *SNMP) Fetch(o []int, i int) (int, error) In this example, oid is an abbreviation for SNMP Object ID, so shortening it to o would mean programmers have to translate from the common notation that they read in documentation to the shorter notation in your code. Similarly, reducing index to i obscures what i stands for as in SNMP messages a sub value of each OID is called an Index. TIP Don‚Äôt mix and match long and short formal parameters in the same declaration. 2.3. Don‚Äôt name your variables for their types You shouldn‚Äôt name your variables after their types for the same reason you don‚Äôt name your pets ‚Äúdog‚Äù and ‚Äúcat‚Äù. You also probably shouldn‚Äôt include the name of your type in the name of your variable‚Äôs name for the same reason. The name of the variable should describe its contents, not the type of the contents. Consider this example: var usersMap map[string]*User What‚Äôs good about this declaration? We can see that its a map, and it has something to do with the *User type, that‚Äôs probably good. But usersMap is a map, and Go being a statically typed language won‚Äôt let us accidentally use it where a scalar variable is required, so the Map suffix is redundant. Now, consider what happens if we were to declare other variables like: 12for index := 0; index &lt; len(s); index++ &#123; // } 12for i := 0; i &lt; len(s); i++ &#123; // } https://dave.cheney.net/practical-go/presentations/qcon-china.html 6/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs 123var ( companiesMap map[string]*Company productsMap map[string]*Products ) Now we have three map type variables in scope, usersMap , companiesMap , and productsMap , all mapping strings to different types. We know they are maps, and we also know that their map declarations prevent us from using one in place of another‚Äîthe compiler will throw an error if we try to use companiesMap where the code is expecting a map[string]*User . In this situation it‚Äôs clear that the Map suffix does not improve the clarity of the code, its just extra boilerplate to type. My suggestion is to avoid any suffix that resembles the type of the variable. TIP If users isn‚Äôt descriptive enough, then usersMap won‚Äôt be either. This advice also applies to function parameters. For example: Naming the Config parameter config is redundant. We know its a Config , it says so right there. In this case consider conf or maybe c will do if the lifetime of the variable is short enough. If there is more that one in scope at any one time then calling them conf1 and conf2 is less descriptive than calling them and as the latter are less likely to be mistaken for one another. 1234type Config struct &#123; //&#125;func WriteConfig(w io.Writer, config *Config) *Config original updated Don‚Äôt let package names steal good variable names. The name of an imported identifier includes its package name. For example the context package will be known as context.Context . This makes it impossible to use a variable or type in your package. type in the as func WriteLog(context context.Context, message string) Will not compile. This is why the local declaration for context.Context types is traditionally ctx . eg. func WriteLog(ctx context.Context, message string) 2.4. Use a consistent naming style Another property of a good name is it should be predictable. The reader should be able to understand the use of a name when they encounter it for the first time. When they encounter a common name, they should be able to assume it has not changed meanings since the last time they saw it. NOTE https://dave.cheney.net/practical-go/presentations/qcon-china.html 7/45 Context context 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs For example, if your code passes around a database handle, make sure each time the parameter appears, it has the same name. Rather than a combination of d sql.DB , dbase sql.DB , DB sql.DB , and database sql.DB , instead consolidate on something like; db sql.DB Doing so promotes familiarity; if you see a db , you know it‚Äôs a sql.DB and that it has either been declared locally or provided for you by the caller. Similarly for method receivers; use the same receiver name every method on that type. This makes it easier for the reader to internalise the use of the receiver across the methods in this type. The convention for short receiver names in Go is at odds with the advice provided so far. This is just NOTE one of the choices made early on that has become the preferred style, just like the use of CamelCase TIP rather than snake_case . Go style dictates that receivers have a single letter name, or acronyms derived from their type. You may find that the name of your receiver sometimes conflicts with name of a parameter in a method. In this case, consider making the parameter name slightly longer, and don‚Äôt forget to use this new parameter name consistently. Finally, certain single letter variables have traditionally been associated with loops and counting. For example, i , j , and k are commonly the loop induction variable for simple for loops. n is commonly associated with a counter or accumulator. v is a common shorthand for a value in a generic encoding function, k is commonly used for the key of a map, and s is often used as shorthand for parameters of type string . As with the db example above programmers expect to be a loop induction variable. If you ensure that is always a loop variable, not used in other contexts outside a loop. When readers encounter a variable called , or j , they know that a loop is close by. i i for i TIP If you found yourself with so many nested loops that you exhaust your supply of i , j , and k variables, its probably time to break your function into smaller units. 2.5. Use a consistent declaration style Go has at least six different ways to declare a variable varxint=1 varx=1 varxint;x=1 var x = int(1) x:=1 I‚Äôm sure there are more that I haven‚Äôt thought of. This is something that Go‚Äôs designers recognise was probably a mistake, but its too late to change it now. With all these different ways of declaring a variable, how do we avoid each Go programmer choosing their own style? I want to present a suggestions for how I declare variables in my programs. This is the style I try to use where possible. https://dave.cheney.net/practical-go/presentations/qcon-china.html 8/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs When declaring, but not initialising, a variable, use var . When declaring a variable that will be explicitly initialised later in the function, use the var keyword. The var acts as a clue to say that this variable has been deliberately declared as the zero value of the indicated type. This is also consistent with the requirement to declare variables at the package level using var as opposed to the short declaration syntax‚Äîalthough I‚Äôll argue later that you shouldn‚Äôt be using package level variables at all. When declaring and initialising, use := . When declaring and initialising the variable at the same time, that is to say we‚Äôre not letting the variable be implicitly initialised to its zero value, I recommend using the short variable declaration form. This makes it clear to the reader that the variable on the left hand side of the := is being deliberately initialised. To explain why, Let‚Äôs look at the previous example, but this time deliberately initialising each variable: In the first and third examples, because in Go there are no automatic conversions from one type to another; the type on the left hand side of the assignment operator must be identical to the type on the right hand side. The compiler can infer the type of the variable being declared from the type on the right hand side, to the example can be written more concisely like this: This leaves us with explicitly initialising players to 0 which is redundant because 0 is `players‚Äô zero value. So its better to make it clear that we‚Äôre going to use the zero value by instead writing 1var players int What about the second statement? We cannot elide the type and write var things = nil Because nil does not have a type. [2] Instead we have a choice, do we want the zero value for a slice? 123456789101112var players int // 0var things []Thing // an empty slice of Thingsvar thing Thing // empty Thing structjson.Unmarshall(reader, &amp;thing)var players int = 0var things []Thing = nilvar thing *Thing = new(Thing)json.Unmarshall(reader, thing)var players = 0var things []Thing = nilvar thing = new(Thing)json.Unmarshall(reader, thing) https://dave.cheney.net/practical-go/presentations/qcon-china.html 9/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs 1var things []Thing or do we want to create a slice with zero elements? 1var things = make([]Thing, 0) If we wanted the latter then this is not the zero value for a slice so we should make it clear to the reader that we‚Äôre making this choice by using the short declaration form: things := make([]Thing, 0) Which tells the reader that we have chosen to initialise things explicitly. This brings us to the third declaration, var thing = new(Thing) Which is both explicitly initialising a variable and introduces the uncommon use of the new keyword which some Go programmer dislike. If we apply our short declaration syntax recommendation then the statement becomes thing := new(Thing) Which makes it clear that thing is explicitly initialised to the result of new(Thing) ‚Äìa pointer to a Thing ‚Äìbut still leaves us with the unusual use of new . We could address this by using the compact literal struct initialiser form, thing := &amp;Thing{} Which does the same as means we‚Äôre explicitly initialising , hence why some Go programmers are upset by the duplication. However this with a pointer to a Thing{} , which is the zero value for a Thing . new(Thing) thing Instead we should recognise that is being declared as its zero value and use the address of operator to pass the address of thing to thing 123json.Unmarshallvar thing Thingjson.Unmarshall(reader, &amp;thing) https://dave.cheney.net/practical-go/presentations/qcon-china.html 10/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs NOTE Of course, with any rule of thumb, there are exceptions. For example, sometimes two variables are closely related so writing Would be odd. The declaration may be more readable like this min, max := 0, 1000 12var min intmax := 1000 In summary: When declaring a variable without initialisation, use the var syntax. When declaring and explicitly initialising a variable, use := . Make tricky declarations obvious. When something is complicated, it should look complicated. var length uint32 = 0x80 Here length may be being used with a library which requires a specific numeric type and is more TIP explicit that length is being explicitly chosen to be uint32 than the short declaration form: length := uint32(0x80) In the first example I‚Äôm deliberately breaking my rule of using the var declaration form with an explicit initialiser. This decision to vary from my usual form is a clue to the reader that something unusual is happening. 2.6. Be a team player I talked about a goal of software engineering to produce readable, maintainable, code. Therefore you will likely spend most of your career working on projects of which you are not the sole author. My advice in this situation is to follow the local style. Changing styles in the middle of a file is jarring. Uniformity, even if its not your preferred approach, is more valuable for maintenance than your personal preference. My rule of thumb is; if it fits through gofmt then its usually not worth holding up a code review for. If you want to do a renaming across a code-base, do not mix this into another change. If someone is TIP using git bisect they don‚Äôt want to wade through thousands of lines of renaming to find the code you changed as well. \3. Comments Before we move on to larger items I want to spend a few minutes talking about comments. ‚Äúhttps://dave.cheney.net/practical-go/presentations/qcon-china.html 11/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs ‚ÄúGood code has lots of comments, bad code requires lots of comments. ‚Äî Dave Thomas and Andrew Hunt The Pragmatic Programmer Comments are very important to the readability of a Go program. A comments should do one of three things: \1. The comment should explain what the thing does. \2. The comment should explain how the thing does what it does. 3. The comment should explain why the thing is why it is. The first form is ideal for commentary on public symbols: The second form is ideal for commentary inside a method: The third form, the why , is unique as it does not displace the first two, but at the same time it‚Äôs not a replacement for the what, or the how. The why style of commentary exists to explain the external factors that drove the code you read on the page. Frequently those factors rarely make sense taken out of context, the comment exists to provide that context. In this example it may not be immediately clear what the effect of setting HealthyPanicThreshold to zero percent will do. The comment is needed to clarify that the value of 0 will disable the panic threshold behaviour. 3.1. Comments on variables and constants should describe their contents not their purpose I talked earlier that the name of a variable, or a constant, should describe its purpose. When you add a comment to a variable or constant, that comment should describe the variables contents, not the variables purpose. 1const randomNumber = 6 // determined from an unbiased die In this example the comment describes why is assigned the value six, and where the six was derived from. The comment does not describe where will be used. Here are some more examples: 12345// Open opens the named file for reading.// If successful, methods on the returned file can be used for reading.// queue all dependant actionsvar results []chan errorfor _, dep := range a.Deps &#123; } 12345results = append(results, execute(seen, dep))return &amp;v2.Cluster_CommonLbConfig&#123; // Disable HealthyPanicThreshold HealthyPanicThreshold: &amp;envoy_type.Percent&#123; Value: 0, }, } https://dave.cheney.net/practical-go/presentations/qcon-china.html 12/45 12randomNumberrandomNumber 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs 12345const ( StatusContinue = 100 // RFC 7231, 6.2.1 StatusSwitchingProtocols = 101 // RFC 7231, 6.2.2 StatusProcessing = 102 // RFC 2518, 10.1 StatusOK = 200 // RFC 7231, 6.3.1 In the context of HTTP the number 100 is known as StatusContinue , as defined in RFC 7231, section 6.2.1. For variables without an initial value, the comment should describe who is responsible for // sizeCalculationDisabled indicates whether it is safe // to calculate Types‚Äô widths and alignments. See dowidth. var sizeCalculationDisabled bool TIP initialising this variable. Here the comment lets the reader know that the dowidth function is responsible for maintaining the state of sizeCalculationDisabled . Hiding in plain sight This is a tip from Kate Gregory. [3] Sometimes you‚Äôll find a better name for a variable hiding in a comment. The comment was added by the author because registry doesn‚Äôt explain enough about its purpose ‚Äîit‚Äôs a registry, but a registry of what? By renaming the variable to sqlDrivers its now clear that the purpose of this variable is to hold SQL drivers. var sqlDrivers = make(map[string]*sql.Driver) Now the comment is redundant and can be removed. // registry of SQL drivers var registry = make(map[string]*sql.Driver) TIP 3.2. Always document public symbols Because godoc is the documentation for your package, you should always add a comment for every public symbol‚Äî variable, constant, function, and method‚Äîdeclared in your package. Here are two rules from the Google Style guide Any public function that is not both obvious and short must be commented. Any function in a library must be commented regardless of length or complexity https://dave.cheney.net/practical-go/presentations/qcon-china.html 13/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs 123456package ioutil// ReadAll reads from r until an error or EOF and returns the data it read.// A successful call returns err == nil, not err == EOF. Because ReadAll is// defined to read from src until EOF, it does not treat an EOF from Read// as an error to be reported.func ReadAll(r io.Reader) ([]byte, error) There is one exception to this rule; you don‚Äôt need to document methods that implement an interface. Specifically don‚Äôt do this: This comment says nothing. It doesn‚Äôt tell you what the method does, in fact it‚Äôs worse, it tells you to go look somewhere else for the documentation. In this situation I suggest removing the comment entirely. Here is an example from the io package 123456789101112131415161718192021222324// Read implements the io.Reader interfacefunc (r *FileReader) Read(buf []byte) (int, error)// LimitReader returns a Reader that reads from r// but stops with EOF after n bytes.// The underlying implementation is a *LimitedReader.func LimitReader(r Reader, n int64) Reader &#123; return &amp;LimitedReader&#123;r, n&#125; &#125;// A LimitedReader reads from R but limits the amount of// data returned to just N bytes. Each call to Read// updates N to reflect the new amount remaining.// Read returns EOF when N &lt;= 0 or when the underlying R returns EOF.type LimitedReader struct &#123; R Reader // underlying reader N int64 // max bytes remaining&#125;func (l *LimitedReader) Read(p []byte) (n int, err error) &#123; if l.N &lt;= 0 &#123; return 0, EOF &#125; if int64(len(p)) &gt; l.N &#123; p = p[0:l.N] &#125; n, err = l.R.Read(p) l.N -= int64(n) return } Note that the declaration is directly preceded by the function that uses it, and the declaration of follows the declaration of LimitedReader itself. Even though LimitedReader.Read has no documentation itself, its clear from that it is an implementation of io.Reader . 12LimitedReaderLimitedReader.Read TIP Before you write the function, write the comment describing the function. If you find it hard to write the comment, then it‚Äôs a sign that the code you‚Äôre about to write is going to be hard to understand. 3.2.1. Don‚Äôt comment bad code, rewrite it ‚Äúhttps://dave.cheney.net/practical-go/presentations/qcon-china.html 14/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs ‚Äú Don‚Äôt comment bad code ‚Äî rewrite it ‚Äî Brian Kernighan Comments highlighting the grossness of a particular piece of code are not sufficient. If you encounter one of these comments, you should raise an issue as a reminder to refactor it later. It is okay to live with technical debt, as long as the amount of debt is known. The tradition in the standard library is to annotate a TODO style comment with the username of the person who noticed it. 1// TODO(dfc) this is O(N^2), find a faster way to do this. The username is not a promise that that person has committed to fixing the issue, but they may be the best person to ask when the time comes to address it. Other projects annotate TODOs with a date or an issue number. ‚Äú3.2.2. Rather than commenting a block of code, refactor it Good code is its own best documentation. As you‚Äôre about to add a comment, ask yourself, ‚ÄòHow can I improve the code so that this comment isn‚Äôt needed?‚Äô Improve the code and then document it to make it even clearer. ‚Äî Steve McConnell Functions should do one thing only. If you find yourself commenting a piece of code because it is unrelated to the rest of the function, consider extracting it into a function of its own. In addition to be easier to comprehend, smaller functions are easier to test in isolation, and now you‚Äôve isolated the orthogonal code into its own function, its name may be all the documentation required. ‚Äú4. Package Design Write shy code - modules that don‚Äôt reveal anything unnecessary to other modules and that don‚Äôt rely on other modules‚Äô implementations. ‚Äî Dave Thomas Each Go package is in effect it‚Äôs own small Go program. Just as the implementation of a function or method is unimportant to the caller, the implementation of the functions and methods and types that make your package‚Äôs public API‚Äîits behaviour‚Äîis unimportant for the caller. A good Go package should strive to have a low degree of source level coupling such that, as the project grows, changes to one package do not cascade across the code-base. These stop-the-world refactorings place a hard limit on the rate of change in a code base and thus the productivity of the members working in that code-base. In this section we‚Äôll talk about designing a package including the package‚Äôs name, naming types, and tips for writing methods and functions. 4.1. A good package starts with its name Writing a good Go package starts with the package‚Äôs name. Think of your package‚Äôs name as an elevator pitch to describe what it does using just one word. https://dave.cheney.net/practical-go/presentations/qcon-china.html 15/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Just as I talked about names for variables in the previous section, the name of a package is very important. The rule of thumb I follow is not, ‚Äúwhat types should I put in this package?‚Äù. Instead the question I ask ‚Äúwhat does service does package provide?‚Äù Normally the answer to that question is not ‚Äúthis package provides the X type‚Äù, but ‚Äúthis package let‚Äôs you speak HTTP‚Äù. TIP Name your package after what is provides, not what it contains. 4.1.1. Good package names should be unique. Within your project, each package name should be unique. This advice is pretty easy to follow if the advice that a package‚Äôs name should derive from its purpose‚Äîif you find you have two packages which need the same name, it is likely either; a. The name of the package is too generic. b. The package overlaps another package of a similar name. In this case either you should review your design, or consider merging the packages. 4.2. Avoid package names like base , common , or util A common cause of poor package names is what call utility packages. These are packages where common helpers and utility code congeals over time. As these packages contain an assortment of unrelated functions, their utility is hard to describe in terms of what the package provides. This often leads to the package‚Äôs name being derived from what the package contains‚Äìutilities. Package names like utils or helpers are commonly found in larger projects which have developed deep package hierarchies and want to share helper functions without encountering import loops. By extracting utility functions to new package the import loop is broken, but because the package stems from a design problem in the project, its name doesn‚Äôt reflect its purpose, only its function of breaking the import cycle. My recommendation to improve the name of utils or helpers packages is to analyse where they are called and if possible move the relevant functions into their caller‚Äôs package. Even if this involves duplicating some helper code this is better than introducing an import dependency between two packages. ‚Äú[A little] duplication is far cheaper than the wrong abstraction. ‚Äî Sandy Metz In the case where utility functions are used in many places prefer multiple packages, each focused on a single aspect, to a single monolithic package. TIP Use plurals for naming utility packages. For example the strings for string handling utilities. Packages with names like base or common are often found when functionality common to two or more implementations, or common types for a client and server, has been refactored into a separate package. I believe the solution to this is to reduce the number of packages, to combine the client, server, and common code into a single package named after the function of the package. For example, the net/http package does not have client and sub packages, instead it has a client.go and server.go file, each holding their respective types, and a file for the common message transport code. server https://dave.cheney.net/practical-go/presentations/qcon-china.html 16/45 1transport.go 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs TIP An identifier‚Äôs name includes its package name. It‚Äôs important to remember that the name of an identifier includes the name of its package. The Get function from the net/http package becomes http.Get when referenced by another package. The Reader type from the strings package becomes strings.Reader when imported into other packages. The Error interface from the net package is clearly related to network errors. 4.3. Return early rather than nesting deeply As Go does not use exceptions for control flow there is no requirement to deeply indent your code just to provide a top level structure for the try and catch blocks. Rather than the successful path nesting deeper and deeper to the right, Go code is written in a style where the success path continues down the screen as the function progresses. My friend Mat Ryer calls this practice ‚Äòline of sight‚Äô coding. [4] This is achieved by using guard clauses; conditional blocks with assert preconditions upon entering a function. Here is an example from the bytes package, 12func (b *Buffer) UnreadRune() error &#123; if b.lastRead &lt;= opInvalid &#123; GO 1234567 return errors.New(&quot;bytes.Buffer: UnreadRune: previous operation was not a successfulReadRune&quot;) &#125; if b.off &gt;= int(b.lastRead) &#123; b.off -= int(b.lastRead) &#125; b.lastRead = opInvalid return nil } Upon entering UnreadRune the state of b.lastRead is checked and if the previous operation was not an error is returned immediately. From there the rest of the function proceeds with the assertion that is greater that opInvalid . Compare this to the same function written without a guard clause, 1234567func (b *Buffer) UnreadRune() error &#123; if b.lastRead &gt; opInvalid &#123; if b.off &gt;= int(b.lastRead) &#123; b.off -= int(b.lastRead) &#125; b.lastRead = opInvalid return nil } 12 return errors.New(&quot;bytes.Buffer: UnreadRune: previous operation was not a successfulReadRune&quot;) } GO The body of the successful case, the most common, is nested inside the first if condition and the successful exit condition, return nil , has to be discovered by careful matching of closing braces. The final line of the function now returns an error, and the called must trace the execution of the function back to the matching opening brace to know https://dave.cheney.net/practical-go/presentations/qcon-china.html 17/45 ReadRune b.lastRead 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs when control will reach this point. This is more error prone for the reader, and the maintenance programmer, hence why Go prefer to use guard clauses and returning early on errors. 4.4. Make the zero value useful Every variable declaration, assuming no explicit initialiser is provided, will be automatically initialised to a value that matches the contents of zeroed memory. This is the values zero value. The type of the value determines its zero value; for numeric types it is zero, for pointer types nil, the same for slices, maps, and channels. This property of always setting a value to a known default is important for safety and correctness of your program and can make your Go programs simpler and more compact. This is what Go programmers talk about when they say ‚Äúgive your structs a useful zero value‚Äù. Consider the sync.Mutex type. sync.Mutex contains two unexported integer fields, representing the mutex‚Äôs internal state. Thanks to the zero value those fields will be set to will be set to 0 whenever a sync.Mutex is declared. sync.Mutex has been deliberately coded to take advantage of this property, making the type usable without explicit initialisation. 12type MyInt struct &#123; mu sync.Mutex val int } 123456func main() &#123; var i MyInt // i.mu is usable without explicit initialisation. i.mu.Lock() i.val++ i.mu.Unlock() } GO Another example of a type with a useful zero value is bytes.Buffer . You can declare a bytes.Buffer and start writing to it without explicit initialisation. A useful property of slices is their zero value is nil . This makes sense if we look at the runtime‚Äôs definition of a slice header. 1234func main() &#123; var b bytes.Buffer b.WriteString(&quot;Hello, world!\n&quot;) io.Copy(os.Stdout, &amp;b) } GO 1234type slice struct &#123; array *[...]T // pointer to the underlying array len int cap int } https://dave.cheney.net/practical-go/presentations/qcon-china.html 18/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs The zero value of this struct would imply len and cap have the value 0 , and array , the pointer to memory holding the contents of the slice‚Äôs backing array, would be nil . This means you don‚Äôt need to explicitly make a slice, you can just declare it. 1234567func main() &#123; // s := make([]string, 0) // s := []string&#123;&#125; var s []string s = append(s, &quot;Hello&quot;) s = append(s, &quot;world&quot;) fmt.Println(strings.Join(s, &quot; &quot;)) } GO var s []string is similar to the two commented lines above it, but not identical. It is possible to detect the difference between a slice value that is nil and a slice value that has zero length. The following code will output false. NOTE A surprising, but useful, property of uninitialised pointer variables‚Äînil pointers‚Äîis you can call methods on types that have a nil value. This can be used to provide default values simply. func main() { var s1 = []string{} var s2 []string fmt.Println(reflect.DeepEqual(s1, s2)) } GO 12type Config struct &#123; path string } 12345678910func (c *Config) Path() string &#123; if c == nil &#123; return &quot;/usr/home&quot; &#125; return c.path&#125;func main() &#123; var c1 *Config var c2 = &amp;Config&#123; path: &quot;/export&quot;, } 12 fmt.Println(c1.Path(), c2.Path())&#125; GO 4.5. Avoid package level state The key to writing maintainable programs is that they should be loosely coupled‚Äîa change to one package should have a low probability of affecting another package that does not directly depend on the first. There are two excellent ways to achieve loose coupling in Go https://dave.cheney.net/practical-go/presentations/qcon-china.html 19/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs \1. Use interfaces to describe the behaviour your functions or methods require. 2. Avoid the use of global state. In Go we can declare variables at the function or method scope, and also at the package scope. When the variable is public, given a identifier starting with a capital letter, then its scope is effectively global to the entire program‚Äîany package may observe the type and contents of that variable at any time. Mutable global state introduces tight coupling between independent parts of your program as global variables become an invisible parameter to every function in your program! Any function that relies on a global variable can be broken if that variable‚Äôs type changes. Any function that relies on the state of a global variable can be broken if another part of the program changes that variable. If you want to reduce the coupling a global variable creates, \1. Move the relevant variables as fields on structs that need them. \2. Use interfaces to reduce the coupling between the behaviour and the implementation of that behaviour. \5. Project Structure Let‚Äôs talk about combining packages together into a project. Commonly this will be a single git repository, but in the future Go developers will use module and project interchangeably. Just like a package, each project should have a clear purpose. If your project is a library, it should provide one thing, say XML parsing, or logging. You should avoid combining multiple purposes into a single package, this will help avoid the dreaded common library. In my experience, the common repo ends up tightly coupled to its biggest consumer and that makes TIP it hard to back-port fixes without upgrading both common and consumer in lock step, bringing in a lot of unrelated changes and API breakage along the way. If your project is an application, like your web application, Kubernetes controller, and so on, then you might have one or more packages inside your project. For example, the Kubernetes controller I work on has a single package which serves as both the server deployed to a Kubernetes cluster, and a client for debugging purposes. 5.1. Consider fewer, larger packages One of the things I tend to pick up in code review for programmers who are transitioning from other languages to Go is they tend to overuse packages. Go does not provide elaborate ways of establishing visibility; thing Java‚Äôs public , protected , private , and implicit default access modifiers. There is no equivalent of C++‚Äôs notion of friend classes. In Go we have only two access modifiers, public and private, indicated by the capitalisation of the first letter of the identifier. If an identifier is public, it‚Äôs name starts with a capital letter, that identifier can be referenced by any other Go package. NOTE You may hear people say exported and not exported as synonyms for public and private. Given the limited controls available to control access to a package‚Äôs symbols, what practices should Go programmers follow to avoid creating over-complicated package hierarchies? main cmd/contour https://dave.cheney.net/practical-go/presentations/qcon-china.html 20/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs TIP Every package, with the exception of cmd/ and internal/ , should contain some source code. The advice I find myself repeating is to prefer fewer, larger packages. Your default position should be to not create a new package. That will lead to too many types being made public creating a wide, shallow, API surface for your package.. The sections below explores this suggestion in more detail. TIP Coming from Java? If you‚Äôre coming from a Java or C# background, consider this rule of thumb. - A Java package is equivalent to a single .go source file. - A Go package is equivalent to a whole Maven module or .NET assembly. 5.1.1. Arrange code into les by import statements If you‚Äôre arranging your packages by what they provide to callers, should you do the same for files within a Go package? How do you know when you should break up a .go file into multiple ones? How do you know when you‚Äôve gone to far and should consider consolidating .go file? Here are the rules of thumb I use: Start each package with one file. Give that file the same name as the name of the folder. eg. package http should be placed in a file called in a directory named http . As your package grows you may decide to split apart the various responsibilities into different files. eg, contains the `Request and Response types, client.go contains the Client type, server.go contains the type. If you find your files have similar import declarations, consider combining them. Alternatively, identify the differences between the import sets and move those Different files should be responsible for different areas of the package. may be responsible for marshalling of HTTP requests and responses on and off the network, may contain the low level network handling logic, client.go and server.go implement the HTTP business logic of request construction or routing, and so on. TIP Prefer nouns for source file names. The Go compiler compiles each package in parallel. Within a package the compiler compiles each NOTE function (methods are just fancy functions in Go) in parallel. Changing the layout of your code within a package does not affect compilation time. 5.1.2. Prefer internal tests to external tests The go tool supports writing your testing package tests in two places. Assuming your package is called http2 , you can write a file and use the declaration. Doing so will compile the code in as if it were part of the package. This is known colloquially as an internal test. The go tool also supports a special package declaration, ending in test , ie., package http_test . This allows your test files to live alongside your code in the same package, however when those tests are compiled they are not part of your package‚Äôs code, they live in their own package. This allows you to write your tests as if you were another package calling into your code. This is known as an _external test. .go http.go messages.go Server messages.go http.go 1http2_test.go package http2 1http2_test.go http2 https://dave.cheney.net/practical-go/presentations/qcon-china.html 21/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs I recommend using internal tests when writing unit tests for your package. This allows you to test each function or method directly, avoiding the bureaucracy of external testing. However, you should place your Example test functions in an external test file. This ensures that when viewed in godoc, the examples have the appropriate package prefix and can be easily copy pasted. TIP Avoid elaborate package hierarchies, resist the desire to apply taxonomy With one exception, which we‚Äôll talk about next, the hierarchy of Go packages has no meaning to the go tool. For example, the net/http package is not a child or sub-package of the net package. If you find you have created intermediate directories in your project which contain no .go files, you may have failed to follow this advice. 5.1.3. Use internal packages to reduce your public API surface If your project contains multiple packages you may have some exported functions which are intended to be used by other packages in your project, but are not intended to be part of your project‚Äôs public API. If you find yourself in this situation the go tool recognises a special folder name‚Äînot package name‚Äì, internal/ which can be used to place code which is public to your project, but private to other projects. To create such a package, place it in a directory named internal/ or in a sub-directory of a directory named internal/ . When the go command sees an import of a package with in its path, it verifies that the package doing the import is within the tree rooted at the parent of the directory. For example, a package can be imported only by code in the directory tree rooted at ‚Ä¶ /a/b/c . It cannot be imported by code in or in any other repository. [5] 5.2. Keep package main small as small as possible Your main function, and package should do as little as possible. This is because main.main acts as a singleton; there can only be one function in a program, including tests. Because main.main is a singleton there are a lot of assumptions built into the things that main.main will call that they will only be called during main.main or main.init, and only called once. This makes it hard to write tests for code written in main.main , thus you should aim to move as much of your business logic out of your main function and ideally out of your main package. TIP main should parse flags, open connections to databases, loggers, and such, then hand off execution to a high level object. \6. API Design The last piece of design advice I‚Äôm going to give today I feel is the most important. All of the suggestions I‚Äôve made so far are just that, suggestions. These are the way I try to write my Go, but I‚Äôm not going to push them hard in code review. However when it comes to reviewing APIs during code review, I am less forgiving. This is because everything I‚Äôve talked about so far can be fixed without breaking backward compatibility; they are, for the most part, implementation details. When it comes to the public API of a package, it pays to put considerable thought into the initial design, because changing that design later is going to be disruptive for people who are already using your API. https://dave.cheney.net/practical-go/presentations/qcon-china.html 22/45 internal main ‚Ä¶/a/b/g internal 1.../a/b/c/internal/d/e/f main 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs ‚Äú6.1. Design APIs that are hard to misuse. APIs should be easy to use and hard to misuse. ‚Äî Josh Bloch [3] If you take anything away from this presentation, it should be this advice from Josh Bloch. If an API is hard to use for simple things, then every invocation of the API will look complicated. When the actual invocation of the API is complicated it will be less obvious and more likely to be overlooked. 6.1.1. Be wary of functions which take several parameters of the same type A good example of a simple looking, but hard to use correctly API is one which takes two or more parameters of the same type. Let‚Äôs compare two function signatures: What‚Äôs the difference between these two functions? Obviously one returns the maximum of two numbers, the other copies a file, but that‚Äôs not the important thing. Max is commutative; the order of the parameters does not matter. The maximum of eight and ten is ten regardless of if I compare eight to ten or ten two eight. However, this property does not hold true for CopyFile . Which one of these statements made a backup of your presentation and which one overwrite your presentation with last week‚Äôs version? You can‚Äôt tell without consulting the documentation. A code reviewer cannot know if you‚Äôve got the order correct without consulting the documentation. One possible solution to this is to introduce a helper type which will be responsible for calling CopyFile correctly. 123456789func Max(a, b int) intfunc CopyFile(to, from string) errorMax(8, 10) // 10Max(10, 8) // 10CopyFile(&quot;/tmp/backup&quot;, &quot;presentation.md&quot;)CopyFile(&quot;presentation.md&quot;, &quot;/tmp/backup&quot;)type Source stringfunc (src Source) CopyTo(dest string) error &#123; return CopyFile(dest, string(src)) } 123func main() &#123; var from Source = &quot;presentation.md&quot; from.CopyTo(&quot;/tmp/backup&quot;) } GO In this way CopyFile is always called correctly‚Äîthis can be asserted with a unit test‚Äîand can possibly be made private, further reducing the likelihood of misuse. https://dave.cheney.net/practical-go/presentations/qcon-china.html 23/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs TIP APIs with multiple parameters of the same type are hard to use correctly. 6.2. Design APIs for their default use case A few years ago I gave a talk [6] about using functional options [7] to make APIs easier to use for their default case. The gist of this talk was you should design your APIs for the common use case. Sad another way, your API should not require the caller to provide parameters which they don‚Äôt care about. 6.2.1. Discourage the use of nil as a parameter I opened this chapter with the suggestion that you shouldn‚Äôt force the caller of your API into providing you parameters when they don‚Äôt really care what those parameters mean. This is what I mean when I say design APIs for their default use case. Here‚Äôs an example from the net/http package package http 12345678// ListenAndServe listens on the TCP network address addr and then calls// Serve with handler to handle requests on incoming connections.// Accepted connections are configured to enable TCP keep-alives.//// The handler is typically nil, in which case the DefaultServeMux is used.//// ListenAndServe always returns a non-nil error.func ListenAndServe(addr string, handler Handler) error &#123; ListenAndServe takes two parameters, a TCP address to listen for incoming connections, and http.Handler to handle the incoming HTTP request. Serve allows the second parameter to be nil , and notes that usually the caller will pass nil indicating that they want to use http.DefaultServeMux as the implicit parameter. Now the caller of Serve has two ways to do the same thing. Both do exactly the same thing. This behaviour is viral. The http package also has a http.Serve helper, which you can reasonably imagine that builds upon like this 12http.ListenAndServe(&quot;0.0.0.0:8080&quot;, nil)http.ListenAndServe(&quot;0.0.0.0:8080&quot;, http.DefaultServeMux) nil 1234ListenAndServefunc ListenAndServe(addr string, handler Handler) error &#123; l, err := net.Listen(&quot;tcp&quot;, addr) if err != nil &#123; return err } 123 defer l.Close() return Serve(l, handler)&#125; GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 24/45 http.Serve 1ListenAndServe nil handler DefaultServeMux`‚Äù logic. http.Serve Accepting `nil nil Serve 123http.Serve(nil, nil) http.ListenAndServeDefaultServeMux nil 123const root = http.Dir(&quot;/htdocs&quot;)http.Handle(&quot;/&quot;, http.FileServer(root))http.ListenAndServe(&quot;0.0.0.0:8080&quot;, nil) GO 123const root = http.Dir(&quot;/htdocs&quot;)http.Handle(&quot;/&quot;, http.FileServer(root))http.ListenAndServe(&quot;0.0.0.0:8080&quot;, http.DefaultServeMux) GO 1234const root = http.Dir(&quot;/htdocs&quot;)mux := http.NewServeMux()http.Handle(&quot;/&quot;, http.FileServer(root))http.ListenAndServe(&quot;0.0.0.0:8080&quot;, mux) GO 1func ShutdownVMs(ids []string) error 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Because behaviour. In fact, permits the caller to pass for the second parameter, also supports this is the one that implements the ‚Äúif is nil , use for one parameter may lead the caller into thinking they can pass for both parameters. However calling like this, results in an ugly panic. TIP Don‚Äôt mix nil and non nil-able parameters in the same function signature. The author of was trying to make the API user‚Äôs life easier in the common case, but possibly made the package harder to use safely. There is no difference in line count between using explicitly, or implicitly via . verses and a was this confusion really worth saving one line? TIP Give serious consideration to how much time helper functions will save the programmer. Clear is better than concise. Avoid public APIs with test only parameters TIP Avoid exposing APIs with values who only differ in test scope. Instead, use Public wrappers to hide those parameters, use test scoped helpers to set the property in test scope. 6.2.2. Prefer var args to []T parameters It‚Äôs very common to write a function or method that takes a slice of values. https://dave.cheney.net/practical-go/presentations/qcon-china.html 25/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs This is just an example I made up, but its common to a lot of code I‚Äôve worked on. The problem with signatures like these is they presume that they will be called with more than one entry. However, what I have found is many times these type of functions are called with only one argument, which has to be ‚Äúboxed‚Äù inside a slice just to meet the requirements of the functions signature. Additionally, because the ids parameter is a slice, you can pass an empty slice or nil to the function and the compiler will be happy. This adds extra testing load because you should cover these cases in your testing. To give an example of this class of API, recently I was refactoring a piece of logic that required me to set some extra fields if at least one of a set of parameters was non zero. The logic looked like this: As the if statement was getting very long I wanted to pull the logic of the check out into its own function. This is what I came up with: 12345678if svc.MaxConnections &gt; 0 || svc.MaxPendingRequests &gt; 0 || svc.MaxRequests &gt; 0 ||svc.MaxRetries &gt; 0 &#123; // apply the non zero parameters&#125;// anyPostive indicates if any value is greater than zero.func anyPositive(values ...int) bool &#123; for _, v := range values &#123; if v &gt; 0 &#123; return true } } 12 return false&#125; GO This enabled me to make the condition where the inner block will be executed clear to the reader: However there is a problem with anyPositive , someone could accidentally invoke it like this if anyPositive() { ‚Ä¶ } In this case anyPositive would return false because it would execute zero iterations and immediately return false . This isn‚Äôt the worst thing in the world ‚Äî that would be if anyPositive returned true when passed no arguments. Nevertheless it would be be better if we could change the signature of anyPositive to enforce that the caller should pass at least one argument. We can do that by combining normal and vararg parameters like this: 12if anyPositive(svc.MaxConnections, svc.MaxPendingRequests, svc.MaxRequests, svc.MaxRetries) &#123; // apply the non zero parameters } https://dave.cheney.net/practical-go/presentations/qcon-china.html 26/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Now anyPositive cannot be called with less than one argument. 6.3. Let functions dene the behaviour they requires Let‚Äôs say I‚Äôve been given a task to write a function that persists a Document structure to disk. I could specify this function, Save, which takes an *os.File as the destination to write the Document . But this has a few problems The signature of Save precludes the option to write the data to a network location. Assuming that network storage is likely to become requirement later, the signature of this function would have to change, impacting all its callers. Save is also unpleasant to test, because it operates directly with files on disk. So, to verify its operation, the test would have to read the contents of the file after being written. And I would have to ensure that f was written to a temporary location and always removed afterwards. os.File also defines a lot of methods which are not relevant to , like reading directories and checking to see if a path is a symlink. It would be useful if the signature of the function could describe only the parts of os.File that were relevant. What can we do ? Using io.ReadWriteCloser we can apply the interface segregation principle to redefine Save to take an interface that describes more general file shaped things. With this change, any type that implements the io.ReadWriteCloser interface can be substituted for the previous *os.File . This makes Save both broader in its application, and clarifies to the caller of Save which methods of the *os.File type are relevant to its operation. 12// Save writes the contents of doc to the file f.func Save(f *os.File, doc *Document) error Save Save 1234567891011// Save writes the contents of doc to the supplied// ReadWriterCloser.func Save(rwc io.ReadWriteCloser, doc *Document) error// anyPostive indicates if any value is greater than zero.func anyPositive(first int, rest ...int) bool &#123; if first &gt; 0 &#123; return true &#125; for _, v := range rest &#123; if v &gt; 0 &#123; return true } } 12 return false&#125; GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 27/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs And as the author of I no longer have the option to call those unrelated methods on as it is hidden behind the interface. But we can take the interface segregation principle a bit further. Firstly, it is unlikely that if Save follows the single responsibility principle, it will read the file it just wrote to verify its contents‚Äîthat should be responsibility of another piece of code. So we can narrow the specification for the interface we pass to Save to just writing and closing. Secondly, by providing Save with a mechanism to close its stream, which we inherited in this desire to make it still look like a file, this raises the question of under what circumstances will wc be closed. Possibly Save will call Close unconditionally, or perhaps Close will be called in the case of success. This presents a problem for the caller of Save as it may want to write additional data to the stream after the document is written. A better solution would be to redefine Save to take only an io.Writer , stripping it completely of the responsibility to do anything but write data to a stream. By applying the interface segregation principle to our Save function, the results has simultaneously been a function which is the most specific in terms of its requirements‚Äîit only needs a thing that is writable‚Äîand the most general in its function, we can now use Save to save our data to anything which implements io.Writer. \7. Error handling I‚Äôve given several presentations about error handling [8] and written a lot about error handling on my blog. I also spoke a lot about error handling in yesterday‚Äôs session so I won‚Äôt repeat what I‚Äôve said. https://dave.cheney.net/2014/12/24/inspecting-errors https://dave.cheney.net/2016/04/07/constant-errors Instead I want to cover two other areas related to error handling. 7.1. Eliminate error handling by eliminating errors If you were in my presentation yesterday I talked about the draft proposals for improving error handling. But do you know what is better than an improved syntax for handling errors? Not needing to handle errors at all. Save *os.File 123456// Save writes the contents of doc to the supplied// WriteCloser.func Save(wc io.WriteCloser, doc *Document) error// Save writes the contents of doc to the supplied// Writer.func Save(w io.Writer, doc *Document) error NOTE I‚Äôm not saying ‚Äúremove your error handling‚Äù. What I am suggesting is, change your code so you do not have errors to handle. 1io.ReadWriteCloser https://dave.cheney.net/practical-go/presentations/qcon-china.html 28/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs This section draws inspiration from John Ousterhout‚Äôs recently book, A philosophy of Software Design [9]. One of the chapters in that book is called ‚ÄúDefine Errors Out of Existence‚Äù. We‚Äôre going to try to apply this advice to Go. 7.1.1. Counting lines Let‚Äôs write a function to count the number of lines in a file. 12345func CountLines(r io.Reader) (int, error) &#123; var ( br = bufio.NewReader(r) lines int err error ) 1234for &#123; _, err = br.ReadString(&apos;\n&apos;) lines++ if err != nil &#123; break } } 12if err != io.EOF &#123; return 0, err } 12 return lines, nil&#125; GO Because we‚Äôre following our advice from previous sections, CountLines takes an io.Reader, not a *File; its the job of the caller to provide the io.Reader who‚Äôs contents we want to count. We construct a bufio.Reader , and then sit in a loop calling the ReadString method, incrementing a counter until we reach the end of the file, then we return the number of lines read. At least that‚Äôs the code we want to write, but instead this function is made more complicated by error handling. For example, there is this strange construction, We increment the count of lines before checking the error‚Äîthat looks odd. The reason we have to write it this way is ReadString will return an error if it encounters and end-of-file before hitting a newline character. This can happen if there is no final newline in the file. To try to fix this, we rearrange the logic to increment the line count, then see if we need to exit the loop. NOTE this logic still isn‚Äôt perfect, can you spot the bug? 123_, err = br.ReadString(&apos;\n&apos;)lines++if err != nil &#123; break } GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 29/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs But we‚Äôre not done checking errors yet. will return when it hits the end of the file. This is expected, needs some way of saying stop, there is nothing more to read. So before we return the error to the caller of , we need to check if the error was not io.EOF , and in that case propagate it up, otherwise we return nil to say that everything worked fine. I think this is a good example of Russ Cox‚Äôs observation that error handling can obscure the operation of the function. Let‚Äôs look at an improved version. ReadString io.EOF ReadString CountLine 12345func CountLines(r io.Reader) (int, error) &#123; sc := bufio.NewScanner(r) lines := 0 for sc.Scan() &#123; lines++ } 12 return lines, sc.Err()&#125; GO This improved version switches from using bufio.Reader to bufio.Scanner . Under the hood bufio.Scanner uses , but it adds a nice layer of abstraction which helps remove the error handling with obscured the operation of . 1bufio.Reader CountLines NOTE The method, the body of our bufio.Scanner can scan for any pattern, but by default it looks for newlines. returns true if the scanner has matched a line of text and has not encountered an error. So, loop will be called only when there is a line of text in the scanner‚Äôs buffer. This means our revised sc.Scan() for CountLines correctly handles the case where there is no trailing newline, and also handles the case where the file was empty. Secondly, as sc.Scan returns false once an error is encountered, our for loop will exit when the end-of-file is reached or an error is encountered. The type memoises the first error it encountered and we can recover that error once we‚Äôve exited the loop using the method. Lastly, sc.Err() takes care of handling io.EOF and will convert it to a nil if the end of file was reached without encountering another error. 1bufio.Scanner sc.Err() TIP When you find yourself faced with overbearing error handling, try to extract some of the operations into a helper type. 7.1.2. WriteResponse My second example is inspired from the Errors are values blog post [10]. Earlier in this presentation We‚Äôve seen examples dealing with opening, writing and closing files. The error handling is present, but not overwhelming as the operations can be encapsulated in helpers like ioutil.ReadFile and ioutil.WriteFile . However when dealing with low level network protocols it becomes necessary to build the response directly using I/O primitives the error handling can become repetitive. Consider this fragment of a HTTP server which is constructing the HTTP response. https://dave.cheney.net/practical-go/presentations/qcon-china.html 30/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs First we construct the status line using fmt.Fprintf , and check the error. Then for each header we write the header key and value, checking the error each time. Lastly we terminate the header section with an additional \r\n , check the error, and copy the response body to the client. Finally, although we don‚Äôt need to check the error from io.Copy , we need to translate it from the two return value form that io.Copy returns into the single return value that WriteResponse returns. That‚Äôs a lot of repetitive work. But we can make it easier on ourselves by introducing a small wrapper type, errWriter . errWriter fulfils the io.Writer contract so it can be used to wrap an existing io.Writer . errWriter passes writes through to its underlying writer until an error is detected. From that point on, it discards any writes and returns the previous error. 12type Header struct &#123; Key, Value string } 1234567type Status struct &#123; Code int Reason string&#125;func WriteResponse(w io.Writer, st Status, headers []Header, body io.Reader) error &#123; _, err := fmt.Fprintf(w, &quot;HTTP/1.1 %d %s\r\n&quot;, st.Code, st.Reason) if err != nil &#123; return err } 123for _, h := range headers &#123; _, err := fmt.Fprintf(w, &quot;%s: %s\r\n&quot;, h.Key, h.Value) if err != nil &#123; return err } } 12if _, err := fmt.Fprint(w, &quot;\r\n&quot;); err != nil &#123; return err } 1_, err = io.Copy(w, body) return err } GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 31/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Applying errWriter to WriteResponse dramatically improves the clarity of the code. Each of the operations no longer needs to bracket itself with an error check. Reporting the error is moved to the end of the function by inspecting the ew.err field, avoiding the annoying translation from `io.Copy‚Äôs return values. 7.2. Only handle an error once Lastly, I want to mention that you should only handle errors once. Handling an error means inspecting the error value, and making a single decision. If you make less than one decision, you‚Äôre ignoring the error. As we see here, the error from w.WriteAll is being discarded. But making more than one decision in response to a single error is also problematic. The following is code that I come across frequently. 12// WriteAll writes the contents of buf to the supplied writer.func WriteAll(w io.Writer, buf []byte) &#123; } 123w.Write(buf)type errWriter struct &#123; io.Writer err error } 1234567func (e *errWriter) Write(buf []byte) (int, error) &#123; if e.err != nil &#123; return 0, e.err &#125; var n int n, e.err = e.Writer.Write(buf) return n, nil } 12345func WriteResponse(w io.Writer, st Status, headers []Header, body io.Reader) error &#123; ew := &amp;errWriter&#123;Writer: w&#125; fmt.Fprintf(ew, &quot;HTTP/1.1 %d %s\r\n&quot;, st.Code, st.Reason) for _, h := range headers &#123; fmt.Fprintf(ew, &quot;%s: %s\r\n&quot;, h.Key, h.Value) } 123fmt.Fprint(ew, &quot;\r\n&quot;)io.Copy(ew, body)return ew.err } GO 123456func WriteAll(w io.Writer, buf []byte) error &#123; _, err := w.Write(buf) if err != nil &#123; log.Println(&quot;unable to write:&quot;, err) // annotated error goes to log file return err // unannotated error returned to caller &#125; return nil } GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 32/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs In this example if an error occurs during , a line will be written to a log file, noting the file and line that the error occurred, and the error is also returned to the caller, who possibly will log it, and return it, all the way back up to the top of the program. The caller is probably doing the same 1234func WriteConfig(w io.Writer, conf *Config) error &#123; buf, err := json.Marshal(conf) if err != nil &#123; log.Printf(&quot;could not marshal config: %v&quot;, err) return err } 123if err := WriteAll(w, buf); err != nil &#123; log.Println(&quot;could not write config: %v&quot;, err) return err } return nil } GO So you get a stack of duplicate lines in your log file, but at the top of the program you get the original error without any context. I want to dig into this a little further because I don‚Äôt see the problems with logging and returning as just a matter of personal preference. 12345678910111213unable to write: io.EOFcould not write config: io.EOFerr := WriteConfig(f, &amp;conf)fmt.Println(err) // io.EOFfunc WriteConfig(w io.Writer, conf *Config) error &#123; buf, err := json.Marshal(conf) if err != nil &#123; log.Printf(&quot;could not marshal config: %v&quot;, err) // oops, forgot to return &#125; if err := WriteAll(w, buf); err != nil &#123; log.Println(&quot;could not write config: %v&quot;, err) return err } return nil } GO The problem I see a lot is programmers forgetting to return from an error. As we talked about earlier, Go style is to use guard clauses, checking preconditions as the function progresses and returning early. In this example the author checked the error, logged it, but forgot to return. This has caused a subtle bug. w.Write https://dave.cheney.net/practical-go/presentations/qcon-china.html 33/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs The contract for error handling in Go says that you cannot make any assumptions about the contents of other return values in the presence of an error. As the JSON marshalling failed, the contents of buf are unknown, maybe it contains nothing, but worse it could contain a 1/2 written JSON fragment. Because the programmer forgot to return after checking and logging the error, the corrupt buffer will be passed to WriteAll , which will probably succeed and so the config file will be written incorrectly. However the function will return just fine, and the only indication that a problem happened will be a single log line complaining about marshalling JSON, not a failure to write the config. 7.2.1. Adding context to errors The bug occurred because the author was trying to add context to the error message. They were trying to leave themselves a breadcrumb to point them back to the source of the error. Let‚Äôs look at another way to do the same thing using fmt.Errorf . 1234567func WriteConfig(w io.Writer, conf *Config) error &#123; buf, err := json.Marshal(conf) if err != nil &#123; return fmt.Errorf(&quot;could not marshal config: %v&quot;, err) &#125; if err := WriteAll(w, buf); err != nil &#123; return fmt.Errorf(&quot;could not write config: %v&quot;, err) } return nil } 12345func WriteAll(w io.Writer, buf []byte) error &#123; _, err := w.Write(buf) if err != nil &#123; return fmt.Errorf(&quot;write failed: %v&quot;, err) &#125; return nil } GO By combining the annotation of the error with returning onto one line there it is harder to forget to return an error and avoid continuing accidentally. If an I/O error occurs writing the file, the error‚Äôs `Error() method will report something like this; could not write config: write failed: input/output error 7.2.2. Wrapping errors with github.com/pkg/errors The fmt.Errorf pattern works well for annotating the error message, but it does so at the cost of obscuring the type of the original error. I‚Äôve argued that treating errors as opaque values is important to producing software which is loosely coupled, so the face that the type of the original error should not matter if the only thing you do with an error value is \1. Check that it is not nil . 2. Print or log it. However there are some cases, I believe they are infrequent, where you do need to recover the original error. In that case you can use something like my errors package to annotate errors like this https://dave.cheney.net/practical-go/presentations/qcon-china.html 34/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Now the error reported will be the nice K&amp;D [11] style error, 1could not read config: open failed: open /Users/dfc/.settings.xml: no such file or directory and the error value retains a reference to the original cause. 123456func main() &#123; _, err := ReadConfig() if err != nil &#123; fmt.Printf(&quot;original error: %T %v\n&quot;, errors.Cause(err), errors.Cause(err)) fmt.Printf(&quot;stack trace:\n%+v\n&quot;, err) os.Exit(1) } } GO Thus you can recover the original error and print a stack trace; 12345678910111213141516func ReadFile(path string) ([]byte, error) &#123; f, err := os.Open(path) if err != nil &#123; return nil, errors.Wrap(err, &quot;open failed&quot;) &#125; defer f.Close() buf, err := ioutil.ReadAll(f) if err != nil &#123; return nil, errors.Wrap(err, &quot;read failed&quot;) &#125; return buf, nil&#125;func ReadConfig() ([]byte, error) &#123; home := os.Getenv(&quot;HOME&quot;) config, err := ReadFile(filepath.Join(home, &quot;.settings.xml&quot;)) return config, errors.WithMessage(err, &quot;could not read config&quot;) } 1234func main() &#123; _, err := ReadConfig() if err != nil &#123; fmt.Println(err) os.Exit(1) } } GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 35/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Using the errors package gives you the ability to add context to error values, in a way that is inspectable by both a human and a machine. If you came to my presentation yesterday you‚Äôll know that wrapping is moving into the standard library in an upcoming Go release. \8. Concurrency Often Go is chosen for a project because of its concurrency features. The Go team have gone to great lengths to make concurrency in Go cheap (in terms of hardware resources) and performant, however it is possible to use Go‚Äôs concurrency features to write code which is neither performent or reliable. With the time I have left I want to leave you with some advice for avoid some of the pitfalls that come with Go‚Äôs concurrency features. Go features first class support for concurrency with channels, and the select and go statements. If you‚Äôve learnt Go formally from a book or training course, you might have noticed that the concurrency section is always one of the last you‚Äôll cover. This workshop is no different, I have chosen to cover concurrency last, as if it is somehow additional to the regular the skills a Go programmer should master. There is a dichotomy here; Go‚Äôs headline feature is our simple, lightweight concurrency model. As a product, our language almost sells itself on this on feature alone. On the other hand, there is a narrative that concurrency isn‚Äôt actually that easy to use, otherwise authors wouldn‚Äôt make it the last chapter in their book and we wouldn‚Äôt look back on our formative efforts with regret. This section discusses some pitfalls of naive usage of Go‚Äôs concurrency features. 8.1. Keep yourself busy or do the work yourself What is the problem with this program? 123456789101112131415original error: *os.PathError open /Users/dfc/.settings.xml: no such file or directorystack trace:open /Users/dfc/.settings.xml: no such file or directoryopen failedmain.ReadFile /Users/dfc/devel/practical-go/src/errors/readfile2.go:16main.ReadConfig /Users/dfc/devel/practical-go/src/errors/readfile2.go:29main.main /Users/dfc/devel/practical-go/src/errors/readfile2.go:35runtime.main /Users/dfc/go/src/runtime/proc.go:201runtime.goexit /Users/dfc/go/src/runtime/asm_amd64.s:1333could not read config https://dave.cheney.net/practical-go/presentations/qcon-china.html 36/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs The program does what we intended, it serves a simple web server. However it also does something else at the same time, it wastes CPU in an infinite loop. This is because the for{} on the last line of main is going to block the main goroutine because it doesn‚Äôt do any IO, wait on a lock, send or receive on a channel, or otherwise communicate with the scheduler. As the Go runtime is mostly cooperatively scheduled, this program is going to spin fruitlessly on a single CPU, and may eventually end up live-locked. How could we fix this? Here‚Äôs one suggestion. package main 123import ( &quot;fmt&quot; &quot;log&quot; ‚Äúnet/http‚Äù ‚Äúruntime‚Äù ) 12345678func main() &#123; http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123; fmt.Fprintln(w, &quot;Hello, GopherCon SG&quot;) &#125;) go func() &#123; if err := http.ListenAndServe(&quot;:8080&quot;, nil); err != nil &#123; log.Fatal(err) &#125; }() 12for &#123; runtime.Gosched() } } GO package main GO 123import ( &quot;fmt&quot; &quot;log&quot; ‚Äúnet/http‚Äù ) 12345678func main() &#123; http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123; fmt.Fprintln(w, &quot;Hello, GopherCon SG&quot;) &#125;) go func() &#123; if err := http.ListenAndServe(&quot;:8080&quot;, nil); err != nil &#123; log.Fatal(err) &#125; }() for { } } https://dave.cheney.net/practical-go/presentations/qcon-china.html 37/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs This might look silly, but it‚Äôs a common common solution I see in the wild. It‚Äôs symptomatic of not understanding the underlying problem. Now, if you‚Äôre a little more experienced with go, you might instead write something like this. package main 123import ( &quot;fmt&quot; &quot;log&quot; ‚Äúnet/http‚Äù ) 12345678func main() &#123; http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123; fmt.Fprintln(w, &quot;Hello, GopherCon SG&quot;) &#125;) go func() &#123; if err := http.ListenAndServe(&quot;:8080&quot;, nil); err != nil &#123; log.Fatal(err) &#125; }() select {} } GO An empty select statement will block forever. This is a useful property because now we‚Äôre not spinning a whole CPU just to call runtime.GoSched() . However, we‚Äôre only treating the symptom, not the cause. I want to present to you another solution, one which has hopefully already occurred to you. Rather than run in a goroutine, leaving us with the problem of what to do with the main goroutine, simply run 12http.ListenAndServehttp.ListenAndServe TIP on the main goroutine itself. If the main.main function of a Go program returns then the Go program will unconditionally exit no matter what other goroutines started by the program over time are doing. package main 123import ( &quot;fmt&quot; &quot;log&quot; ‚Äúnet/http‚Äù ) 123456func main() &#123; http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123; fmt.Fprintln(w, &quot;Hello, GopherCon SG&quot;) &#125;) if err := http.ListenAndServe(&quot;:8080&quot;, nil); err != nil &#123; log.Fatal(err) } } GO So this is my first piece of advice: if your goroutine cannot make progress until it gets the result from another, oftentimes it is simpler to just do the work yourself rather than to delegate it. https://dave.cheney.net/practical-go/presentations/qcon-china.html 38/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs This often eliminates a lot of state tracking and channel manipulation required to plumb a result back from a goroutine to its initiator. TIP Many Go programmers overuse goroutines, especially when they are starting out. As with all things in life, moderation is the key the key to success. 8.2. Leave concurrency to the caller What is the difference between these two APIs? 123456// ListDirectory returns the contents of dir.func ListDirectory(dir string) ([]string, error)// ListDirectory returns a channel over which// directory entries will be published. When the list// of entries is exhausted, the channel will be closed.func ListDirectory(dir string) chan string Firstly, the obvious differences; the first example reads a directory into a slice then returns the whole slice, or an error if something went wrong. This happens synchronously, the caller of ListDirectory blocks until all directory entries have been read. Depending on how large the directory, this could take a long time, and could potentially allocate a lot of memory building up the slide of directory entry names. Lets look at the second example. This is a little more Go like, ListDirectory returns a channel over which directory entries will be passed. When the channel is closed, that is your indication that there are no more directory entries. As the population of the channel happens after ListDirectory returns, ListDirectory is probably starting a goroutine to populate the channel. NOTE Its not necessary for the second version to actually use a Go routine; it could allocate a channel sufficient to hold all the directory entries without blocking, fill the channel, close it, then return the channel to the caller. But this is unlikely, as this would have the same problems with consuming a large amount of memory to buffer all the results in a channel. The channel version of ListDirectory has two further problems: By using a closed channel as the signal that there are no more items to process there is no way for ListDirectory to tell the caller that the set of items returned over the channel is incomplete because an error was encountered partway through. There is no way for the caller to tell the difference between an empty directory and an error to read from the directory entirely. Both result in a channel returned from ListDirectory which appears to be closed immediately. The caller must continue to read from the channel until it is closed because that is the only way the caller can know that the goroutine which was started to fill the channel has stopped. This is a serious limitation on the use of ListDirectory , the caller has to spend time reading from the channel even though it may have received the answer it wanted. It is probably more efficient in terms of memory usage for medium to large directories, but this method is no faster than the original slice based method. The solution to the problems of both implementations is to use a callback, a function that is called in the context of each directory entry as it is executed. https://dave.cheney.net/practical-go/presentations/qcon-china.html 39/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Not surprisingly this is how the filepath.WalkDir function works. If your function starts a goroutine you must provide the caller with a way to explicitly stop that TIP goroutine. It is often easier to leave decision to execute a function asynchronously to the caller of that function. 8.3. Never start a goroutine without when it will stop. The previous example showed using a goroutine when one wasn‚Äôt really necessary. But one of the driving reasons for using Go is the first class concurrency features the language offers. Indeed there are many instances where you want to exploit the parallelism available in your hardware. To do so, you must use goroutines. This simple application serves http traffic on two different ports, port 8080 for application traffic and port 8001 for access to the /debug/pprof endpoint. package main 12import ( &quot;fmt&quot; ‚Äúnet/http‚Äù 12345678910 _ &quot;net/http/pprof&quot;)func main() &#123; mux := http.NewServeMux() mux.HandleFunc(&quot;/&quot;, func(resp http.ResponseWriter, req *http.Request) &#123; fmt.Fprintln(resp, &quot;Hello, QCon!&quot;) &#125;) go http.ListenAndServe(&quot;127.0.0.1:8001&quot;, http.DefaultServeMux) // debug http.ListenAndServe(&quot;0.0.0.0:8080&quot;, mux) // app traffic&#125; GO Although this program isn‚Äôt very complicated, it represents the basis of a real application. There are a few problems with the application as it stands which will reveal themselves as the application grows, so lets address a few of them now. 1func ListDirectory(dir string, fn func(string)) https://dave.cheney.net/practical-go/presentations/qcon-china.html 40/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs By breaking the serveApp and serveDebug handlers out into their own functions we‚Äôve decoupled them from main.main . We‚Äôve also followed the advice from above and make sure that serveApp and serveDebug leave their concurrency to the caller. But there are some operability problems with this program. If serveApp returns then main.main will return causing the program to shutdown and be restarted by whatever process manager you‚Äôre using. TIP Just as functions in Go leave concurrency to the caller, applications should leave the job of monitoring their status and restarting them if they fail to the program that invoked them. Do not make your applications responsible for restarting themselves, this is a procedure best handled from outside the application. However, serveDebug is run in a separate goroutine and if it returns just that goroutine will exit while the rest of the program continues on. Your operations staff will not be happy to find that they cannot get the statistics out of your application when they want too because the /debug handler stopped working a long time ago. What we want to ensure is that if any of the goroutines responsible for serving this application stop, we shut down the application. 123456789func serveApp() &#123; mux := http.NewServeMux() mux.HandleFunc(&quot;/&quot;, func(resp http.ResponseWriter, req *http.Request) &#123; fmt.Fprintln(resp, &quot;Hello, QCon!&quot;) &#125;) http.ListenAndServe(&quot;0.0.0.0:8080&quot;, mux)&#125;func serveDebug() &#123; http.ListenAndServe(&quot;127.0.0.1:8001&quot;, http.DefaultServeMux) } 12func main() &#123; go serveDebug() serveApp() } GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 41/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Now serverApp and serveDebug check the error returned from ListenAndServe and call if required. Because both handlers are running in goroutines, we park the main goroutine in a . This approach has a number of problems: \1. If ListenAndServer returns with a nil error, log.Fatal won‚Äôt be called and the HTTP service on that port will shut down without stopping the application. \2. log.Fatal calls os.Exit which will unconditionally exit the program; defers won‚Äôt be called, other goroutines won‚Äôt be notified to shut down, the program will just stop. This makes it difficult to write tests for those functions. TIP Only use log.Fatal from main.main or init functions. What we‚Äôd really like is to pass any error that occurs back to the originator of the goroutine so that it can know why the goroutine stopped, can shut down the process cleanly. log.Fatal select{} 1234567func serveApp() &#123; mux := http.NewServeMux() mux.HandleFunc(&quot;/&quot;, func(resp http.ResponseWriter, req *http.Request) &#123; fmt.Fprintln(resp, &quot;Hello, QCon!&quot;) &#125;) if err := http.ListenAndServe(&quot;0.0.0.0:8080&quot;, mux); err != nil &#123; log.Fatal(err) } } 1234func serveDebug() &#123; if err := http.ListenAndServe(&quot;127.0.0.1:8001&quot;, http.DefaultServeMux); err != nil &#123; log.Fatal(err) &#125; } 123func main() &#123; go serveDebug() go serveApp() select {} } GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 42/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs We can use a channel to collect the return status of the goroutine. The size of the channel is equal to the number of goroutines we want to manage so that sending to the done channel will not block, as this will block the shutdown the of goroutine, causing it to leak. As there is no way to safely close the done channel we cannot use the for range idiom to loop of the channel until all goroutines have reported in, instead we loop for as many goroutines we started, which is equal to the capacity of the channel. Now we have a way to wait for each goroutine to exit cleanly and log any error they encounter. All that is needed is a way to forward the shutdown signal from the first goroutine that exits to the others. It turns out that asking a http.Server to shut down is a little involved, so I‚Äôve spun that logic out into a helper function. The serve helper takes an address and http.Handler , similar to http.ListenAndServe , and also a stop channel which we use to trigger the Shutdown method. 123456789func serveApp() error &#123; mux := http.NewServeMux() mux.HandleFunc(&quot;/&quot;, func(resp http.ResponseWriter, req *http.Request) &#123; fmt.Fprintln(resp, &quot;Hello, QCon!&quot;) &#125;) return http.ListenAndServe(&quot;0.0.0.0:8080&quot;, mux)&#125;func serveDebug() error &#123; return http.ListenAndServe(&quot;127.0.0.1:8001&quot;, http.DefaultServeMux) } 1234567func main() &#123; done := make(chan error, 2) go func() &#123; done &lt;- serveDebug() &#125;() go func() &#123; done &lt;- serveApp() }() 1234for i := 0; i &lt; cap(done); i++ &#123; if err := &lt;-done; err != nil &#123; fmt.Println(&quot;error: %v&quot;, err) &#125; } } GO https://dave.cheney.net/practical-go/presentations/qcon-china.html 43/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs Now, each time we receive a value on the channel, we close the stop channel which causes all the goroutines waiting on that channel to shut down their . This in turn will cause all the remaining ListenAndServe goroutines to return. Once all the goroutines we started have stopped, main.main returns and the process stops cleanly. done http.Server TIP Writing this logic yourself is repetitive and subtle. Consider something like this package, https://github.com/heptio/workgroup which will do most of the work for you. 12func serve(addr string, handler http.Handler, stop &lt;-chan struct&#123;&#125;) error &#123; s := http.Server&#123; Addr: addr, 12345 Handler: handler,&#125;go func() &#123; &lt;-stop // wait for stop signal s.Shutdown(context.Background()) }() 1234567891011 return s.ListenAndServe()&#125;func serveApp(stop &lt;-chan struct&#123;&#125;) error &#123; mux := http.NewServeMux() mux.HandleFunc(&quot;/&quot;, func(resp http.ResponseWriter, req *http.Request) &#123; fmt.Fprintln(resp, &quot;Hello, QCon!&quot;) &#125;) return serve(&quot;0.0.0.0:8080&quot;, mux, stop)&#125;func serveDebug(stop &lt;-chan struct&#123;&#125;) error &#123; return serve(&quot;127.0.0.1:8001&quot;, http.DefaultServeMux, stop) } 12345678func main() &#123; done := make(chan error, 2) stop := make(chan struct&#123;&#125;) go func() &#123; done &lt;- serveDebug(stop) &#125;() go func() &#123; done &lt;- serveApp(stop) }() 123456789var stopped boolfor i := 0; i &lt; cap(done); i++ &#123; if err := &lt;-done; err != nil &#123; fmt.Println(&quot;error: %v&quot;, err) &#125; if !stopped &#123; stopped = true close(stop) &#125; } } GO ‰∏ãÈù¢ÊòØDavidÁªôÂá∫ÁöÑ‰∏Ä‰∏ãÂÖ≥‰∫égoÁöÑÂ≠¶‰π†ÂèÇËÄÉËµÑÊñôÁöÑÈìæÊé•Ôºö https://dave.cheney.net/practical-go/presentations/qcon-china.html 44/45 2018/10/21 Practical Go: Real world advice for writing maintainable Go programs https://gaston.life/books/effective-programming/ https://talks.golang.org/2014/names.slide#4 https://www.infoq.com/articles/API-Design-Joshua-Bloch https://www.lysator.liu.se/c/pikestyle.html https://speakerdeck.com/campoy/understanding-nil https://www.youtube.com/watch?v=Ic2y6w8lMPA https://medium.com/@matryer/line-of-sight-in-code-186dd7cdea88 https://golang.org/doc/go1.4#internalpackages https://dave.cheney.net/2014/10/17/functional-options-for-friendly-apis https://commandcenter.blogspot.com/2014/01/self-referential-functions-and-design.html https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully https://www.amazon.com/Philosophy-Software-Design-John-Ousterhout/dp/1732102201 https://blog.golang.org/errors-are-values http://www.gopl.io/]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>GO QCon ÊäÄÊúØÂàÜ‰∫´</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊäÄÊúØÂë®Âàä‰πãÊîπÂñÑ Python Á®ãÂ∫èÁöÑ 91 ‰∏™Âª∫ËÆÆÔºàËΩ¨ËΩΩ)]]></title>
    <url>%2F2018%2F10%2F21%2F%E6%8A%80%E6%9C%AF%E5%91%A8%E5%88%8A%E4%B9%8B%E6%94%B9%E5%96%84-Python-%E7%A8%8B%E5%BA%8F%E7%9A%84-91-%E4%B8%AA%E5%BB%BA%E8%AE%AE%EF%BC%88%E8%BD%AC%E8%BD%BD%2F</url>
    <content type="text"><![CDATA[Êú¨ÁØáÂçöÂÆ¢ËΩ¨ËΩΩËá™zhuanlan.zhihu.com/p/32817459„ÄÇ Èô§‰∫ÜGoogleÁöÑPython‰ª£Á†ÅËßÑËåÉÂ§ñÔºå‰ªéÊù•Ê≤°ÊúâÁ±ª‰ººÁöÑ‰π¶Á±ç„ÄÇÂÅ∂ÁÑ∂ÁöÑÊú∫‰ºöÁúãÂà∞Ëøô‰πà‰∏ÄÊú¨‰π¶ÔºåËØªÂÆå‰πãÂêéËßâÂæóËøò‰∏çÈîôÔºåÊâÄ‰ª•ÂÅö‰∏™ÁÆÄÂçïÁöÑÁ¨îËÆ∞„ÄÇÊúâÊÉ≥Â≠¶‰π†Á±ª‰ººÁü•ËØÜÁöÑÊúãÂèãÔºåÂèàÊáíÂæóÂéªËØªÂÆåÊï¥Êú¨‰π¶Á±çÔºåÂèØ‰ª•ÂèÇËÄÉ‰∏Ä‰∏ã„ÄÇ 1ÔºöÂºïËÆ∫Âª∫ËÆÆ1„ÄÅÁêÜËß£PythonicÊ¶ÇÂøµ‚Äî-ËØ¶ËßÅPython‰∏≠ÁöÑ„ÄäPython‰πãÁ¶Ö„Äã Âª∫ËÆÆ2„ÄÅÁºñÂÜôPythonic‰ª£Á†Å Ôºà1ÔºâÈÅøÂÖç‰∏çËßÑËåÉ‰ª£Á†ÅÔºåÊØîÂ¶ÇÂè™Áî®Â§ßÂ∞èÂÜôÂå∫ÂàÜÂèòÈáè„ÄÅ‰ΩøÁî®ÂÆπÊòìÊ∑∑Ê∑ÜÁöÑÂèòÈáèÂêç„ÄÅÂÆ≥ÊÄïËøáÈïøÂèòÈáèÂêçÁ≠â„ÄÇÊúâÊó∂ÂÄôÈïøÁöÑÂèòÈáèÂêç‰ºö‰Ωø‰ª£Á†ÅÊõ¥Âä†ÂÖ∑ÊúâÂèØËØªÊÄß„ÄÇ Ôºà2ÔºâÊ∑±ÂÖ•Â≠¶‰π†PythonÁõ∏ÂÖ≥Áü•ËØÜÔºåÊØîÂ¶ÇËØ≠Ë®ÄÁâπÊÄß„ÄÅÂ∫ìÁâπÊÄßÁ≠âÔºåÊØîÂ¶ÇPythonÊºîÂèòËøáÁ®ãÁ≠â„ÄÇÊ∑±ÂÖ•Â≠¶‰π†‰∏Ä‰∏§‰∏™‰∏öÂÜÖÂÖ¨ËÆ§ÁöÑPythonicÁöÑ‰ª£Á†ÅÂ∫ìÔºåÊØîÂ¶ÇFlaskÁ≠â„ÄÇ Âª∫ËÆÆ3ÔºöÁêÜËß£Python‰∏éCÁöÑ‰∏çÂêå‰πãÂ§ÑÔºåÊØîÂ¶ÇÁº©Ëøõ‰∏é{}ÔºåÂçïÂºïÂè∑ÂèåÂºïÂè∑Ôºå‰∏âÂÖÉÊìç‰ΩúÁ¨¶ÔºüÔºåSwitch-CaseËØ≠Âè•Á≠â„ÄÇ Âª∫ËÆÆ4ÔºöÂú®‰ª£Á†Å‰∏≠ÈÄÇÂΩìÊ∑ªÂä†Ê≥®Èáä Âª∫ËÆÆ5ÔºöÈÄÇÂΩìÊ∑ªÂä†Á©∫Ë°å‰Ωø‰ª£Á†ÅÂ∏ÉÂ±ÄÊõ¥Âä†ÂêàÁêÜ Âª∫ËÆÆ6ÔºöÁºñÂÜôÂáΩÊï∞ÁöÑ4‰∏™ÂéüÂàô Ôºà1ÔºâÂáΩÊï∞ËÆæËÆ°Ë¶ÅÂ∞ΩÈáèÁü≠Â∞èÔºåÂµåÂ•óÂ±ÇÊ¨°‰∏çÂÆúËøáÊ∑± Ôºà2ÔºâÂáΩÊï∞Â£∞ÊòéÂ∫îËØ•ÂÅöÂà∞ÂêàÁêÜ„ÄÅÁÆÄÂçï„ÄÅÊòìÁî® Ôºà3ÔºâÂáΩÊï∞ÂèÇÊï∞ËÆæËÆ°Â∫îËØ•ËÄÉËôëÂêë‰∏ãÂÖºÂÆπ Ôºà4Ôºâ‰∏Ä‰∏™ÂáΩÊï∞Âè™ÂÅö‰∏Ä‰ª∂‰∫ãÔºåÂ∞ΩÈáè‰øùËØÅÂáΩÊï∞Á≤íÂ∫¶ÁöÑ‰∏ÄËá¥ÊÄß Âª∫ËÆÆ7ÔºöÂ∞ÜÂ∏∏ÈáèÈõÜ‰∏≠Âú®‰∏Ä‰∏™Êñá‰ª∂Ôºå‰∏îÂ∏∏ÈáèÂêçÂ∞ΩÈáè‰ΩøÁî®ÂÖ®Â§ßÂÜôÂ≠óÊØç 2ÔºöÁºñÁ®ãÊÉØÁî®Ê≥ïÂª∫ËÆÆ8ÔºöÂà©Áî®assertËØ≠Âè•Êù•ÂèëÁé∞ÈóÆÈ¢òÔºå‰ΩÜË¶ÅÊ≥®ÊÑèÔºåÊñ≠Ë®Äassert‰ºöÂΩ±ÂìçÊïàÁéá Âª∫ËÆÆ9ÔºöÊï∞ÊçÆ‰∫§Êç¢ÂÄºÊó∂‰∏çÊé®Ëçê‰ΩøÁî®‰∏¥Êó∂ÂèòÈáèÔºåËÄåÊòØÁõ¥Êé•a, b = b, a Âª∫ËÆÆ10ÔºöÂÖÖÂàÜÂà©Áî®ÊÉ∞ÊÄßËÆ°ÁÆóÔºàLazy evaluationÔºâÁöÑÁâπÊÄßÔºå‰ªéËÄåÈÅøÂÖç‰∏çÂøÖË¶ÅÁöÑËÆ°ÁÆó Âª∫ËÆÆ11ÔºöÁêÜËß£Êûö‰∏æÊõø‰ª£ÂÆûÁé∞ÁöÑÁº∫Èô∑ÔºàÊúÄÊñ∞ÁâàPython‰∏≠Â∑≤ÁªèÂä†ÂÖ•‰∫ÜÊûö‰∏æÁâπÊÄßÔºâ Âª∫ËÆÆ12Ôºö‰∏çÊé®Ëçê‰ΩøÁî®typeÊù•ËøõË°åÁ±ªÂûãÊ£ÄÊü•ÔºåÂõ†‰∏∫Êúâ‰∫õÊó∂ÂÄôtypeÁöÑÁªìÊûúÂπ∂‰∏ç‰∏ÄÂÆöÂèØÈù†„ÄÇÂ¶ÇÊûúÊúâÈúÄÊ±ÇÔºåÂª∫ËÆÆ‰ΩøÁî®isinstanceÂáΩÊï∞Êù•‰ª£Êõø Âª∫ËÆÆ13ÔºöÂ∞ΩÈáèÂ∞ÜÂèòÈáèËΩ¨Âåñ‰∏∫ÊµÆÁÇπÁ±ªÂûãÂêéÂÜçÂÅöÈô§Ê≥ïÔºàPython3‰ª•Âêé‰∏çÁî®ËÄÉËôëÔºâ Âª∫ËÆÆ14ÔºöË≠¶ÊÉïeval()ÂáΩÊï∞ÁöÑÂÆâÂÖ®ÊºèÊ¥ûÔºåÊúâÁÇπÁ±ª‰ºº‰∫éSQLÊ≥®ÂÖ• Âª∫ËÆÆ15Ôºö‰ΩøÁî®enumerate()ÂêåÊó∂Ëé∑ÂèñÂ∫èÂàóËø≠‰ª£ÁöÑÁ¥¢ÂºïÂíåÂÄº Âª∫ËÆÆ16ÔºöÂàÜÊ∏Ö==ÂíåisÁöÑÈÄÇÁî®Âú∫ÊôØÔºåÁâπÂà´ÊòØÂú®ÊØîËæÉÂ≠óÁ¨¶‰∏≤Á≠â‰∏çÂèØÂèòÁ±ªÂûãÂèòÈáèÊó∂ÔºàËØ¶ËßÅËØÑËÆ∫Ôºâ Âª∫ËÆÆ17ÔºöÂ∞ΩÈáè‰ΩøÁî®Unicode„ÄÇÂú®Python2‰∏≠ÁºñÁ†ÅÊòØÂæàËÆ©‰∫∫Â§¥ÁóõÁöÑ‰∏Ä‰ª∂‰∫ãÔºå‰ΩÜPython3Â∞±‰∏çÁî®ËøáÂ§öËÄÉËôë‰∫Ü Âª∫ËÆÆ18ÔºöÊûÑÂª∫ÂêàÁêÜÁöÑÂåÖÂ±ÇÊ¨°Êù•ÁÆ°ÁêÜModule 3ÔºöÂü∫Á°ÄÁî®Ê≥ïÂª∫ËÆÆ19ÔºöÊúâËäÇÂà∂ÁöÑ‰ΩøÁî®from‚Ä¶importËØ≠Âè•ÔºåÈò≤Ê≠¢Ê±°ÊüìÂëΩÂêçÁ©∫Èó¥ Âª∫ËÆÆ20Ôºö‰ºòÂÖà‰ΩøÁî®absolute importÊù•ÂØºÂÖ•Ê®°ÂùóÔºàPython3‰∏≠Â∑≤ÁªèÁßªÈô§‰∫Ürelative importÔºâ Âª∫ËÆÆ21Ôºöi+=1‰∏çÁ≠â‰∫é++iÔºåÂú®Python‰∏≠Ôºå++iÂâçËæπÁöÑÂä†Âè∑‰ªÖË°®Á§∫Ê≠£Ôºå‰∏çË°®Á§∫Êìç‰Ωú Âª∫ËÆÆ22Ôºö‰π†ÊÉØ‰ΩøÁî®withËá™Âä®ÂÖ≥Èó≠ËµÑÊ∫êÔºåÁâπÂà´ÊòØÂú®Êñá‰ª∂ËØªÂÜô‰∏≠ Âª∫ËÆÆ23Ôºö‰ΩøÁî®elseÂ≠êÂè•ÁÆÄÂåñÂæ™ÁéØÔºàÂºÇÂ∏∏Â§ÑÁêÜÔºâ Âª∫ËÆÆ24ÔºöÈÅµÂæ™ÂºÇÂ∏∏Â§ÑÁêÜÁöÑÂá†ÁÇπÂü∫Êú¨ÂéüÂàô Ôºà1ÔºâÊ≥®ÊÑèÂºÇÂ∏∏ÁöÑÁ≤íÂ∫¶ÔºåtryÂùó‰∏≠Â∞ΩÈáèÂ∞ëÂÜô‰ª£Á†Å Ôºà2ÔºâË∞®ÊÖé‰ΩøÁî®ÂçïÁã¨ÁöÑexceptËØ≠Âè•ÔºåÊàñexcept ExceptionËØ≠Âè•ÔºåËÄåÊòØÂÆö‰ΩçÂà∞ÂÖ∑‰ΩìÂºÇÂ∏∏ Ôºà3ÔºâÊ≥®ÊÑèÂºÇÂ∏∏ÊçïËé∑ÁöÑÈ°∫Â∫èÔºåÂú®ÂêàÈÄÇÁöÑÂ±ÇÊ¨°Â§ÑÁêÜÂºÇÂ∏∏ Ôºà4Ôºâ‰ΩøÁî®Êõ¥Âä†ÂèãÂ•ΩÁöÑÂºÇÂ∏∏‰ø°ÊÅØÔºåÈÅµÂÆàÂºÇÂ∏∏ÂèÇÊï∞ÁöÑËßÑËåÉ Âª∫ËÆÆ25ÔºöÈÅøÂÖçfinally‰∏≠ÂèØËÉΩÂèëÁîüÁöÑÈô∑Èò± Âª∫ËÆÆ26ÔºöÊ∑±ÂÖ•ÁêÜËß£NoneÔºåÊ≠£Á°ÆÂà§Êñ≠ÂØπË±°ÊòØÂê¶‰∏∫Á©∫„ÄÇPython‰∏≠‰∏ãÂàóÊï∞ÊçÆ‰ºöÂà§Êñ≠‰∏∫Á©∫Ôºö Âª∫ËÆÆ27ÔºöËøûÊé•Â≠óÁ¨¶‰∏≤Â∫î‰ºòÂÖà‰ΩøÁî®joinÂáΩÊï∞ÔºåËÄå‰∏çÊòØ+Êìç‰Ωú Âª∫ËÆÆ28ÔºöÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Êó∂Â∞ΩÈáè‰ΩøÁî®.formatÂáΩÊï∞ÔºåËÄå‰∏çÊòØ%ÂΩ¢Âºè Âª∫ËÆÆ29ÔºöÂå∫Âà´ÂØπÂæÖÂèØÂèòÂØπË±°Âíå‰∏çÂèØÂèòÂØπË±°ÔºåÁâπÂà´ÊòØ‰Ωú‰∏∫ÂáΩÊï∞ÂèÇÊï∞Êó∂ Âª∫ËÆÆ30Ôºö[], {}Âíå()Ôºö‰∏ÄËá¥ÁöÑÂÆπÂô®ÂàùÂßãÂåñÂΩ¢Âºè„ÄÇ‰ΩøÁî®ÂàóË°®Ëß£ÊûêÂèØ‰ª•‰Ωø‰ª£Á†ÅÊõ¥Ê∏ÖÊô∞ÔºåÂêåÊó∂ÊïàÁéáÊõ¥È´ò Âª∫ËÆÆ31ÔºöÂáΩÊï∞‰º†ÂèÇÊï∞ÔºåÊó¢‰∏çÊòØ‰º†ÂÄº‰πü‰∏çÊòØ‰º†ÂºïÁî®ÔºåËÄåÊòØ‰º†ÂØπË±°ÊàñËÄÖËØ¥ÂØπË±°ÁöÑÂºïÁî® Âª∫ËÆÆ32ÔºöË≠¶ÊÉïÈªòËÆ§ÂèÇÊï∞ÊΩúÂú®ÁöÑÈóÆÈ¢òÔºåÁâπÂà´ÊòØÂΩìÈªòËÆ§ÂèÇÊï∞‰∏∫ÂèØÂèòÂØπË±°Êó∂ Âª∫ËÆÆ33ÔºöÂáΩÊï∞‰∏≠ÊÖéÁî®ÂèòÈïøÂèÇÊï∞*argsÂíå**kargs Ôºà1ÔºâËøôÁßç‰ΩøÁî®Â§™ÁÅµÊ¥ªÔºå‰ªéËÄå‰ΩøÂæóÂáΩÊï∞Á≠æÂêç‰∏çÂ§üÊ∏ÖÊô∞ÔºåÂèØËØªÊÄßËæÉÂ∑Æ Ôºà2ÔºâÂ¶ÇÊûúÂõ†‰∏∫ÂáΩÊï∞ÂèÇÊï∞ËøáÂ§öËÄåÊòØÁî®ÂèòÈïøÂèÇÊï∞ÁÆÄÂåñÂáΩÊï∞ÂÆö‰πâÔºåÈÇ£‰πà‰∏ÄËà¨ËØ•ÂáΩÊï∞ÂèØ‰ª•ÈáçÊûÑ Âª∫ËÆÆ34ÔºöÊ∑±ÂÖ•ÁêÜËß£str()Âíårepr()ÁöÑÂå∫Âà´ Ôºà1Ôºâ‰∏§ËÄÖ‰πãÈó¥ÁöÑÁõÆÊ†á‰∏çÂêåÔºöstr‰∏ªË¶ÅÈù¢ÂêëÂÆ¢Êà∑ÔºåÂÖ∂ÁõÆÁöÑÊòØÂèØËØªÊÄßÔºåËøîÂõûÂΩ¢Âºè‰∏∫Áî®Êà∑ÂèãÂ•ΩÊÄßÂíåÂèØËØªÊÄßÈÉΩÊØîËæÉÈ´òÁöÑÂ≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÔºõËÄåreprÊòØÈù¢ÂêëPythonËß£ÈáäÂô®ÊàñËÄÖËØ¥PythonÂºÄÂèë‰∫∫ÂëòÔºåÂÖ∂ÁõÆÁöÑÊòØÂáÜÁ°ÆÊÄßÔºåÂÖ∂ËøîÂõûÂÄºË°®Á§∫PythonËß£ÈáäÂô®ÂÜÖÈÉ®ÁöÑÂÆö‰πâ Ôºà2ÔºâÂú®Ëß£ÈáäÂô®‰∏≠Áõ¥Êé•ËæìÂÖ•ÂèòÈáèÔºåÈªòËÆ§Ë∞ÉÁî®reprÂáΩÊï∞ÔºåËÄåprint(var)ÈªòËÆ§Ë∞ÉÁî®strÂáΩÊï∞ Ôºà3ÔºâreprÂáΩÊï∞ÁöÑËøîÂõûÂÄº‰∏ÄËà¨ÂèØ‰ª•Áî®evalÂáΩÊï∞Êù•ËøòÂéüÂØπË±° Ôºà4Ôºâ‰∏§ËÄÖÂàÜÂà´Ë∞ÉÁî®ÂØπË±°ÁöÑÂÜÖÂª∫ÂáΩÊï∞str__()Âíå__repr() Âª∫ËÆÆ35ÔºöÂàÜÊ∏ÖÈùôÊÄÅÊñπÊ≥ïstaticmethodÂíåÁ±ªÊñπÊ≥ïclassmethodÁöÑ‰ΩøÁî®Âú∫ÊôØ 4ÔºöÂ∫ìÂª∫ËÆÆ36ÔºöÊéåÊè°Â≠óÁ¨¶‰∏≤ÁöÑÂü∫Êú¨Áî®Ê≥ï Âª∫ËÆÆ37ÔºöÊåâÈúÄÈÄâÊã©sort()Âíåsorted()ÂáΩÊï∞ „Äãsort()ÊòØÂàóË°®Âú®Â∞±Âú∞ËøõË°åÊéíÂ∫èÔºåÊâÄ‰ª•‰∏çËÉΩÊéíÂ∫èÂÖÉÁªÑÁ≠â‰∏çÂèØÂèòÁ±ªÂûã„ÄÇ „Äãsorted()ÂèØ‰ª•ÊéíÂ∫è‰ªªÊÑèÁöÑÂèØËø≠‰ª£Á±ªÂûãÔºåÂêåÊó∂‰∏çÊîπÂèòÂéüÂèòÈáèÊú¨Ë∫´„ÄÇ Âª∫ËÆÆ38Ôºö‰ΩøÁî®copyÊ®°ÂùóÊ∑±Êã∑Ë¥ùÂØπË±°ÔºåÂå∫ÂàÜÊµÖÊã∑Ë¥ùÔºàshallow copyÔºâÂíåÊ∑±Êã∑Ë¥ùÔºàdeep copyÔºâ Âª∫ËÆÆ39Ôºö‰ΩøÁî®CounterËøõË°åËÆ°Êï∞ÁªüËÆ°ÔºåCounterÊòØÂ≠óÂÖ∏Á±ªÁöÑÂ≠êÁ±ªÔºåÂú®collectionsÊ®°Âùó‰∏≠ Âª∫ËÆÆ40ÔºöÊ∑±ÂÖ•ÊéåÊè°ConfigParser Âª∫ËÆÆ41Ôºö‰ΩøÁî®argparseÊ®°ÂùóÂ§ÑÁêÜÂëΩ‰ª§Ë°åÂèÇÊï∞ Âª∫ËÆÆ42Ôºö‰ΩøÁî®pandasÂ§ÑÁêÜÂ§ßÂûãCSVÊñá‰ª∂ „ÄãPythonÊú¨Ë∫´Êèê‰æõ‰∏Ä‰∏™CSVÊñá‰ª∂Â§ÑÁêÜÊ®°ÂùóÔºåÂπ∂Êèê‰æõreader„ÄÅwriterÁ≠âÂáΩÊï∞„ÄÇ „ÄãPandasÂèØÊèê‰æõÂàÜÂùó„ÄÅÂêàÂπ∂Â§ÑÁêÜÁ≠âÔºåÈÄÇÁî®‰∫éÊï∞ÊçÆÈáèÂ§ßÁöÑÊÉÖÂÜµÔºå‰∏îÂØπ‰∫åÁª¥Êï∞ÊçÆÊìç‰ΩúÊõ¥Êñπ‰æø„ÄÇ Âª∫ËÆÆ43Ôºö‰ΩøÁî®ElementTreeËß£ÊûêXML Âª∫ËÆÆ44ÔºöÁêÜËß£Ê®°ÂùópickleÁöÑ‰ºòÂä£ „Äã‰ºòÂäøÔºöÊé•Âè£ÁÆÄÂçï„ÄÅÂêÑÂπ≥Âè∞ÈÄöÁî®„ÄÅÊîØÊåÅÁöÑÊï∞ÊçÆÁ±ªÂûãÂπøÊ≥õ„ÄÅÊâ©Â±ïÊÄßÂº∫ „ÄãÂä£ÂäøÔºö‰∏ç‰øùËØÅÊï∞ÊçÆÊìç‰ΩúÁöÑÂéüÂ≠êÊÄß„ÄÅÂ≠òÂú®ÂÆâÂÖ®ÈóÆÈ¢ò„ÄÅ‰∏çÂêåËØ≠Ë®Ä‰πãÈó¥‰∏çÂÖºÂÆπ Âª∫ËÆÆ45ÔºöÂ∫èÂàóÂåñÁöÑÂè¶‰∏Ä‰∏™ÈÄâÊã©JSONÊ®°ÂùóÔºöloadÂíådumpÊìç‰Ωú Âª∫ËÆÆ46Ôºö‰ΩøÁî®tracebackËé∑ÂèñÊ†à‰ø°ÊÅØ Âª∫ËÆÆ47Ôºö‰ΩøÁî®loggingËÆ∞ÂΩïÊó•Âøó‰ø°ÊÅØ Âª∫ËÆÆ48Ôºö‰ΩøÁî®threadingÊ®°ÂùóÁºñÂÜôÂ§öÁ∫øÁ®ãÁ®ãÂ∫è Âª∫ËÆÆ49Ôºö‰ΩøÁî®QueueÊ®°Âùó‰ΩøÂ§öÁ∫øÁ®ãÁºñÁ®ãÊõ¥ÂÆâÂÖ® 5ÔºöËÆæËÆ°Ê®°ÂºèÂª∫ËÆÆ50ÔºöÂà©Áî®Ê®°ÂùóÂÆûÁé∞Âçï‰æãÊ®°Âºè Âª∫ËÆÆ51ÔºöÁî®mixinÊ®°ÂºèËÆ©Á®ãÂ∫èÊõ¥Âä†ÁÅµÊ¥ª Âª∫ËÆÆ52ÔºöÁî®ÂèëÂ∏É-ËÆ¢ÈòÖÊ®°ÂºèÂÆûÁé∞ÊùæËÄ¶Âêà Âª∫ËÆÆ53ÔºöÁî®Áä∂ÊÄÅÊ®°ÂºèÁæéÂåñ‰ª£Á†Å 6ÔºöÂÜÖÈÉ®Êú∫Âà∂Âª∫ËÆÆ54ÔºöÁêÜËß£build-inÂØπË±° Âª∫ËÆÆ55Ôºöinit__()‰∏çÊòØÊûÑÈÄ†ÊñπÊ≥ïÔºåÁêÜËß£__new()‰∏éÂÆÉ‰πãÈó¥ÁöÑÂå∫Âà´ Âª∫ËÆÆ56ÔºöÁêÜËß£ÂèòÈáèÁöÑÊü•ÊâæÊú∫Âà∂ÔºåÂç≥‰ΩúÁî®Âüü „ÄãÂ±ÄÈÉ®‰ΩúÁî®Âüü „ÄãÂÖ®Â±Ä‰ΩúÁî®Âüü „ÄãÂµåÂ•ó‰ΩúÁî®Âüü „ÄãÂÜÖÁΩÆ‰ΩúÁî®Âüü Âª∫ËÆÆ57Ôºö‰∏∫‰ªÄ‰πàÈúÄË¶ÅselfÂèÇÊï∞ Âª∫ËÆÆ58ÔºöÁêÜËß£MROÔºàÊñπÊ≥ïËß£ÊûêÈ°∫Â∫èÔºâ‰∏éÂ§öÁªßÊâø Âª∫ËÆÆ59ÔºöÁêÜËß£ÊèèËø∞Á¨¶Êú∫Âà∂ Âª∫ËÆÆ60ÔºöÂå∫Âà´getattr__()‰∏é__getattribute()ÊñπÊ≥ï‰πãÈó¥ÁöÑÂå∫Âà´ Âª∫ËÆÆ61Ôºö‰ΩøÁî®Êõ¥ÂÆâÂÖ®ÁöÑproperty Âª∫ËÆÆ62ÔºöÊéåÊè°ÂÖÉÁ±ªmetaclass Âª∫ËÆÆ63ÔºöÁÜüÊÇâPythonÂØπË±°ÂçèËÆÆ Âª∫ËÆÆ64ÔºöÂà©Áî®Êìç‰ΩúÁ¨¶ÈáçËΩΩÂÆûÁé∞‰∏≠ÁºÄËØ≠Ê≥ï Âª∫ËÆÆ65ÔºöÁÜüÊÇâPythonÁöÑËø≠‰ª£Âô®ÂçèËÆÆ Âª∫ËÆÆ66ÔºöÁÜüÊÇâPythonÁöÑÁîüÊàêÂô® Âª∫ËÆÆ67ÔºöÂü∫‰∫éÁîüÊàêÂô®ÁöÑÂçèÁ®ãÂíågreenletÔºåÁêÜËß£ÂçèÁ®ã„ÄÅÂ§öÁ∫øÁ®ã„ÄÅÂ§öËøõÁ®ã‰πãÈó¥ÁöÑÂå∫Âà´ Âª∫ËÆÆ68ÔºöÁêÜËß£GILÁöÑÂ±ÄÈôêÊÄß Âª∫ËÆÆ69ÔºöÂØπË±°ÁöÑÁÆ°ÁêÜÂíåÂûÉÂúæÂõûÊî∂ 7Ôºö‰ΩøÁî®Â∑•ÂÖ∑ËæÖÂä©È°πÁõÆÂºÄÂèëÂª∫ËÆÆ70Ôºö‰ªéPyPIÂÆâË£ÖÁ¨¨‰∏âÊñπÂåÖ Âª∫ËÆÆ71Ôºö‰ΩøÁî®pipÂíåyolkÂÆâË£Ö„ÄÅÁÆ°ÁêÜÂåÖ Âª∫ËÆÆ72ÔºöÂÅöpasterÂàõÂª∫ÂåÖ Âª∫ËÆÆ73ÔºöÁêÜËß£ÂçïÂÖÉÊµãËØïÁöÑÊ¶ÇÂøµ Âª∫ËÆÆ74Ôºö‰∏∫ÂåÖÁºñÂÜôÂçïÂÖÉÊµãËØï Âª∫ËÆÆ75ÔºöÂà©Áî®ÊµãËØïÈ©±Âä®ÂºÄÂèëÔºàTDDÔºâÊèêÈ´ò‰ª£Á†ÅÁöÑÂèØÊµãÊÄß Âª∫ËÆÆ76Ôºö‰ΩøÁî®PylintÊ£ÄÊü•‰ª£Á†ÅÈ£éÊ†º „Äã‰ª£Á†ÅÈ£éÊ†ºÂÆ°Êü• „Äã‰ª£Á†ÅÈîôËØØÊ£ÄÊü• „ÄãÂèëÁé∞ÈáçÂ§ç‰ª•Âèä‰∏çÂêàÁêÜÁöÑ‰ª£Á†ÅÔºåÊñπ‰æøÈáçÊûÑ „ÄãÈ´òÂ∫¶ÁöÑÂèØÈÖçÁΩÆÂåñÂíåÂèØÂÆöÂà∂Âåñ „ÄãÊîØÊåÅÂêÑÁßçIDEÂíåÁºñËæëÂô®ÁöÑÈõÜÊàê „ÄãËÉΩÂ§üÂü∫‰∫éPython‰ª£Á†ÅÁîüÊàêUMLÂõæ „ÄãËÉΩÂ§ü‰∏éJenkinsÁ≠âÊåÅÁª≠ÈõÜÊàêÂ∑•ÂÖ∑Áõ∏ÁªìÂêàÔºåÊîØÊåÅËá™Âä®‰ª£Á†ÅÂÆ°Êü• Âª∫ËÆÆ77ÔºöËøõË°åÈ´òÊïàÁöÑ‰ª£Á†ÅÂÆ°Êü• Âª∫ËÆÆ78ÔºöÂ∞ÜÂåÖÂèëÂ∏ÉÂà∞PyPI 8ÔºöÊÄßËÉΩÂâñÊûê‰∏é‰ºòÂåñÂª∫ËÆÆ79Ôºö‰∫ÜËß£‰ª£Á†Å‰ºòÂåñÁöÑÂü∫Êú¨ÂéüÂàô Âª∫ËÆÆ80ÔºöÂÄüÂä©ÊÄßËÉΩ‰ºòÂåñÂ∑•ÂÖ∑ Âª∫ËÆÆ81ÔºöÂà©Áî®cProfileÂÆö‰ΩçÊÄßËÉΩÁì∂È¢à Âª∫ËÆÆ82Ôºö‰ΩøÁî®memory_profilerÂíåobjgraphÂâñÊûêÂÜÖÂ≠ò‰ΩøÁî® Âª∫ËÆÆ83ÔºöÂä™ÂäõÈôç‰ΩéÁÆóÊ≥ïÂ§çÊùÇÂ∫¶ Âª∫ËÆÆ84ÔºöÊéåÊè°Âæ™ÁéØ‰ºòÂåñÁöÑÂü∫Êú¨ÊäÄÂ∑ß „ÄãÂáèÂ∞ëÂæ™ÁéØÂÜÖÈÉ®ÁöÑËÆ°ÁÆó „ÄãÂ∞ÜÊòæÂºèÂæ™ÁéØÊîπ‰∏∫ÈöêÂºèÂæ™ÁéØÔºåÂΩìÁÑ∂Ëøô‰ºöÁâ∫Áâ≤‰ª£Á†ÅÁöÑÂèØËØªÊÄß „ÄãÂú®Âæ™ÁéØ‰∏≠Â∞ΩÈáèÂºïÁî®Â±ÄÈÉ®ÂèòÈáè „ÄãÂÖ≥Ê≥®ÂÜÖÂ±ÇÂµåÂ•óÂæ™ÁéØ Âª∫ËÆÆ85Ôºö‰ΩøÁî®ÁîüÊàêÂô®ÊèêÈ´òÊïàÁéá Âª∫ËÆÆ86Ôºö‰ΩøÁî®‰∏çÂêåÁöÑÊï∞ÊçÆÁªìÊûÑ‰ºòÂåñÊÄßËÉΩ Âª∫ËÆÆ87ÔºöÂÖÖÂàÜÂà©Áî®setÁöÑ‰ºòÂäø Âª∫ËÆÆ88Ôºö‰ΩøÁî®multiprocessingÊ®°ÂùóÂÖãÊúçGILÁº∫Èô∑ Âª∫ËÆÆ89Ôºö‰ΩøÁî®Á∫øÁ®ãÊ±†ÊèêÈ´òÊïàÁéá Âª∫ËÆÆ90Ôºö‰ΩøÁî®C/C++Ê®°ÂùóÊâ©Â±ïÊèêÈ´òÊÄßËÉΩ Âª∫ËÆÆ91Ôºö‰ΩøÁî®CythonbÁºñÂÜôÊâ©Â±ïÊ®°Âùó]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ÁºñÁ®ãËßÑËåÉ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊäÄÊúØÂë®Âàä‰πãÂü∫‰∫ébeego webÊ°ÜÊû∂ÁöÑRESTful APIÁöÑÊûÑÂª∫‰πãÊóÖ]]></title>
    <url>%2F2018%2F10%2F14%2F%E6%8A%80%E6%9C%AF%E5%91%A8%E5%88%8A%E4%B9%8B%E5%9F%BA%E4%BA%8Ebeego-web%E6%A1%86%E6%9E%B6%E7%9A%84RESTful-API%E7%9A%84%E6%9E%84%E5%BB%BA%E4%B9%8B%E6%97%85%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä‚Äã beegoÊòØ‰∏Ä‰∏™Âø´ÈÄüÂºÄÂèëGOÂ∫îÁî®ÁöÑhttpÊ°ÜÊû∂Ôºå‰ΩúËÄÖÊòØgoËØ≠Ë®ÄÊñπÂêëÁöÑÂ§ßÁâõÔºåastaxie„ÄÇbeegoÂèØ‰ª•Áî®Êù•Âø´ÈÄüÂºÄÂèëAPI„ÄÅweb„ÄÅÂêéÁ´ØÊúçÂä°Á≠âÂ∫îÁî®ÔºåÊòØ‰∏Ä‰∏™RESTFulÈ£éÊ†ºÁöÑÊ°ÜÊû∂Ôºå‰∏ªË¶ÅÁöÑËÆæËÆ°ÁÅµÊÑüÊù•Ëá™‰∫éPython webÂºÄÂèëÊ°ÜÊû∂tornado„ÄÅflask„ÄÅsinstraÔºåÂæàÂ•ΩÁöÑÁªìÂêà‰∫ÜGoËØ≠Ë®ÄÊú¨Ë∫´ÁöÑ‰∏Ä‰∫õÁâπÊÄßÔºàinterfaceÔºåstructÁªßÊâøÁ≠âÔºâ„ÄÇ ‚Äã beegoÊòØÂü∫‰∫éÂÖ´Â§ßÁã¨Á´ãÊ®°ÂùóÊù•ÂÆûÁé∞ÁöÑÔºåÂæàÂ•ΩÁöÑÂÆûÁé∞‰∫ÜÊ®°ÂùóÈó¥ÁöÑËß£ËÄ¶ÔºåÂç≥‰ΩøÁî®Êà∑‰∏ç‰ΩøÁî®httpÁöÑÈÄªËæëÔºå‰πüÂèØ‰ª•ÂæàÂ•ΩÁöÑ‰ΩøÁî®ÂÖ∂‰∏≠ÁöÑÂêÑ‰∏™Ê®°Âùó„ÄÇ‰ΩúËÄÖËá™Â∑±ËØ¥Ôºå‰ªñÁöÑËøôÁßçÊÄùÊÉ≥Êù•Ëá™‰∫é‰πêÈ´òÁßØÊú®ÔºåËÆæËÆ°beegoÁöÑÊó∂ÂÄôÔºåËøô‰∫õÊ®°ÂùóÂ∞±ÊòØÁßØÊú®ÔºåËÄåÊúÄÁªàÊê≠Âª∫Â•ΩÁöÑÊú∫Âô®‰∫∫Â∞±ÊòØbeego„ÄÇ ‚Äã ËøôÁØáÂçöÊñáÈÄöËøá‰ΩøÁî®beegoÊù•ÊûÑÂª∫APIÔºåËÆ≤Ëß£ÂÆûÁé∞ËøáÁ®ã‰∏≠ÁöÑÁªÜËäÇ‰ª•ÂèäÈÅáÂà∞ÁöÑ‰∏Ä‰∫õÂùëÔºåËÆ©Êàë‰ª¨È©¨‰∏äÂºÄÂßãbeegoÁöÑAPIÊûÑÂª∫‰πãÊóÖÂêßÔºÅ È°πÁõÆÂàõÂª∫ ËøõÂÖ•Âà∞‰Ω†ÁöÑ$GOPATH/src ÂÆâË£ÖbeegoÂºÄÂèëÂåÖËá™Â∑±Âø´ÈÄüÂºÄÂèëÂ∑•ÂÖ∑bee 123go get github.com/astaxie/beegogo get github.com/astaxie/beego/ormgo get github.com/beego/bee ‰ΩøÁî®Âø´ÈÄüÂºÄÂèëÂ∑•ÂÖ∑beeÔºåÂàõÂª∫Êàë‰ª¨ÁöÑAPIÈ°πÁõÆ 1bee new firstAPI Êàë‰ª¨ÂæóÂà∞ÁöÑÈ°πÁõÆÁªìÊûÑÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÂèØ‰ª•ÁúãÂá∫ËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑMVCÊû∂ÊûÑÁöÑÂ∫îÁî®ÔºåbeegoÊääÊàë‰ª¨È°πÁõÆÊâÄÈúÄË¶ÅÁöÑ‰∏Ä‰∫õÈÉΩÂáÜÂ§áÂ•Ω‰∫ÜÔºå‰æãÂ¶ÇÈÖçÁΩÆÊñá‰ª∂confÔºåÊµãËØïÊñá‰ª∂testsÁ≠âÔºåÊàë‰ª¨Âè™ÈúÄË¶Å‰∏ìÊ≥®‰∫éAPI‰ª£Á†ÅÁöÑÁºñÂÜôÂç≥ÂèØ„ÄÇ ËøêË°åÈ°πÁõÆÂπ∂Ëé∑ÂæóAPIËá™Âä®ÂåñÊñáÊ°£1bee run -gendoc=true -downdoc=true ËøêË°å‰∏äËø∞‰ª£Á†ÅËæìÂá∫Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Êàë‰ª¨Âú®ÊµèËßàÂô®‰∏≠ËÆøÈóÆÔºöÊú¨Êú∫IPÔºö8080/swaggerÔºåÂ∞±‰ºöÁúãÂà∞swaggerÁöÑAPIÊñáÊ°£ÔºåÊàë‰ª¨‰ª£Á†ÅÊõ¥Êñ∞ÂêéÔºåËØ•ÊñáÊ°£Â∞±‰ºöËá™Âä®Êõ¥Êñ∞ÔºåÈùûÂ∏∏Êñπ‰æø„ÄÇ modelsËÆæËÆ° ÂØπ Êï∞ÊçÆÂ∫ìobject Êìç‰ΩúÊúâÂõõ‰∏™ÊñπÊ≥ï Read / Insert / Update / Delete 1234567891011Á§∫‰æã‰ª£Á†ÅÔºöo := orm.NewOrm()user := new(User)user.Name = "slene"fmt.Println(o.Insert(user))user.Name = "Your"fmt.Println(o.Update(user))fmt.Println(o.Read(user))fmt.Println(o.Delete(user)) ËøòÊúâÂÖ∂‰ªñÁöÑÊñπÊ≥ïÂèØ‰ª•ÂèÇÈòÖbeegoÂÆòÊñπÊñáÊ°£ÔºåÈáåÈù¢ÂØπormÊìç‰ΩúÊúâÁùÄËØ¶ÁªÜÁöÑ‰ªãÁªç„ÄÇ ÂàõÂª∫‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÂπ∂ËÆæËÆ°‰∏ÄÂº†Êï∞ÊçÆÂ∫ìË°® 1234567CREATE TABLE IF NOT EXISTS `student` (`Id` int(11),`Name` varchar(255),`Birthdate` varchar(255),`Gender` bool,`Score` int(11)) ENGINE=InnoDB DEFAULT CHARSET=utf8; Âú®modelsÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫‰∏Ä‰∏™Êñá‰ª∂Student.go,Âπ∂ÂÆûÁé∞‰ª•‰∏ã‰ª£Á†ÅÔºå‰ª£Á†Å‰∏≠ÂÖ≥ÈîÆÁÇπÈÉΩÊúâÊ≥®Èáä 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172package modelsimport ( "fmt" "github.com/astaxie/beego/orm")//Âú®modelsÊ®°Âùó‰∏≠ÂàõÂª∫‰∏Ä‰∏™structÔºåÁõÆÁöÑÊòØ‰ΩøÁî®beegoÁöÑormÊ°ÜÊû∂Ôºå‰Ωøstruct‰∏éÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂ≠óÊÆµ‰∫ßÁîüÂØπÂ∫îÂÖ≥Á≥ªtype Student struct &#123; Id int`orm:"column(Id)"` //column()Êã¨Âè∑‰∏≠ÁöÑÂ≠óÊÆµÂ∞±ÊòØÂú®ÂÆö‰πâÊï∞ÊçÆÂ∫ìÊó∂ÁöÑÁõ∏Â∫îÂ≠óÊÆµÔºåËøô‰∏ÄÊÆµÂøÖÈ°ª‰∏•Ê†ºÂ°´ÂÜôÔºå‰∏çÁÑ∂Âú®APIËØªÂÜôÊï∞ÊçÆÊó∂Â∞±‰ºöÂá∫Áé∞ËØª‰∏çÂà∞ÊàñËÄÖÂÜô‰∏çËøõÂéªÁöÑÈóÆÈ¢ò Name string `orm:"column(Name)"` BirthDate string `orm:"column(Birthdate)"` Gender bool `orm:"column(Gender)"` Score int `orm:"column(Score)"`&#125;//ËØ•ÂáΩÊï∞Ëé∑ÂæóÊï∞ÊçÆÂ∫ì‰∏≠ÊâÄÊúâstudentÁöÑ‰ø°ÊÅØÔºåËøîÂõûÂÄºÊòØ‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÊï∞ÁªÑÊåáÈíàfunc GetAllStudents() []*Student &#123; o := orm.NewOrm() //‰∫ßÁîü‰∏Ä‰∏™ormÂØπË±° o.Using("default") //ËøôÂè•ËØùÁöÑÊÑèÊÄùÊòØ‰ΩøÁî®ÂÆö‰πâÁöÑÈªòËÆ§Êï∞ÊçÆÂ∫ìÔºå‰∏émain.go‰∏≠ÁöÑorm.RegisterDataBase()ÂØπÂ∫î var students []*Student //ÂÆö‰πâÊåáÂêëÁªìÊûÑ‰ΩìÊï∞ÁªÑÁöÑÊåáÈíà q := o.QueryTable("student")//Ëé∑Âæó‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìË°®ÁöÑËØ∑Ê±Ç q.All(&amp;students)//ÂèñÂà∞Ëøô‰∏™Ë°®‰∏≠ÁöÑÊâÄÊúâÊï∞ÊçÆ return students&#125;//ËØ•ÂáΩÊï∞Ê†πÊçÆstudent‰∏≠ÁöÑIdÔºåËøîÂõûËØ•Â≠¶ÁîüÁöÑ‰ø°ÊÅØfunc GetStudentById(id int) Student &#123; u := Student&#123;Id:id&#125;//Ê†πÊçÆÊâÄ‰º†ÂÖ•ÁöÑIdÂæóÂà∞ÂØπÂ∫îstudentÁöÑÂØπË±° o := orm.NewOrm()//new ‰∏Ä‰∏™ormÂØπË±° o.Using("default")//‰ΩøÁî®ÊúÄÂºÄÂßãÂÆö‰πâÁöÑdefaultÊï∞ÊçÆÂ∫ì err := o.Read(&amp;u)//ËØªÂèñId=idÁöÑstudentÁöÑ‰ø°ÊÅØ if err == orm.ErrNoRows &#123; fmt.Println("Êü•ËØ¢‰∏çÂà∞")//ÂØπÂ∫îÊìç‰ΩúÔºå‰∏ç‰∏ÄÂÆöÊòØprint &#125; else if err == orm.ErrMissPK &#123; fmt.Println("Ê≤°Êúâ‰∏ªÈîÆ") &#125; return u&#125;//Ê∑ªÂä†‰∏Ä‰∏™Â≠¶ÁîüÁöÑ‰ø°ÊÅØÂà∞Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÂèÇÊï∞ÊòØÊåáÂêëstudentÁªìÊûÑÈ¢òÁöÑÊåáÈíàfunc AddStudent(student *Student) Student &#123; o := orm.NewOrm() o.Using("default") o.Insert(student)//ÊèíÂÖ•Êï∞ÊçÆÂ∫ì return *student&#125;func UpdateStudent(student *Student) &#123; o := orm.NewOrm() o.Using("default") o.Update(student)//Êõ¥Êñ∞ËØ•studentÁöÑ‰ø°ÊÅØ&#125;func DeleteStudent(id int) &#123; o := orm.NewOrm() o.Using("default") o.Delete(&amp;Student&#123;Id:id&#125;)//Âà†Èô§ÂØπÂ∫îidÁöÑstudentÁöÑ‰ø°ÊÅØ&#125;func init() &#123; orm.RegisterModel(new(Student))//Â∞ÜÊï∞ÊçÆÂ∫ìÊ≥®ÂÜåÂà∞orm&#125; modelËøô‰∏ÄÂ±Ç‰∏ªË¶ÅÊòØÂÆö‰πâstructÔºåÂπ∂‰∏∫‰∏äÂ±ÇÁºñÂÜôËØªÂÜôÊï∞ÊçÆÂ∫ì„ÄÇÂ§ÑÁêÜÊï∞ÊçÆÁöÑ‰ª£Á†Å„ÄÇ controllerÂ±ÇÂÆûÁé∞Âü∫‰∫é beego ÁöÑ Controller ËÆæËÆ°ÔºåÂè™ÈúÄË¶ÅÂåøÂêçÁªÑÂêà beego.Controller Â∞±ÂèØ‰ª•‰∫ÜÔºåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö 123type xxxController struct &#123; beego.Controller&#125; beego.Controller ÂÆûÁé∞‰∫ÜÊé•Âè£ beego.ControllerInterfaceÔºåbeego.ControllerInterface ÂÆö‰πâ‰∫ÜÂ¶Ç‰∏ãÂáΩÊï∞Ôºö Init(ct *context.Context, childName string, app interface{}) Ëøô‰∏™ÂáΩÊï∞‰∏ªË¶ÅÂàùÂßãÂåñ‰∫Ü Context„ÄÅÁõ∏Â∫îÁöÑ Controller ÂêçÁß∞ÔºåÊ®°ÊùøÂêçÔºåÂàùÂßãÂåñÊ®°ÊùøÂèÇÊï∞ÁöÑÂÆπÂô® DataÔºåapp Âç≥‰∏∫ÂΩìÂâçÊâßË°åÁöÑ Controller ÁöÑ reflecttypeÔºåËøô‰∏™ app ÂèØ‰ª•Áî®Êù•ÊâßË°åÂ≠êÁ±ªÁöÑÊñπÊ≥ï„ÄÇ Prepare() Ëøô‰∏™ÂáΩÊï∞‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÁî®Êà∑Êâ©Â±ïÁî®ÁöÑÔºåËøô‰∏™ÂáΩÊï∞‰ºöÂú®‰∏ãÈù¢ÂÆö‰πâÁöÑËøô‰∫õ Method ÊñπÊ≥ï‰πãÂâçÊâßË°åÔºåÁî®Êà∑ÂèØ‰ª•ÈáçÂÜôËøô‰∏™ÂáΩÊï∞ÂÆûÁé∞Á±ª‰ººÁî®Êà∑È™åËØÅ‰πãÁ±ª„ÄÇ Get() Â¶ÇÊûúÁî®Êà∑ËØ∑Ê±ÇÁöÑ HTTP Method ÊòØ GETÔºåÈÇ£‰πàÂ∞±ÊâßË°åËØ•ÂáΩÊï∞ÔºåÈªòËÆ§ÊòØ 405ÔºåÁî®Êà∑ÁªßÊâøÁöÑÂ≠ê struct ‰∏≠ÂèØ‰ª•ÂÆûÁé∞‰∫ÜËØ•ÊñπÊ≥ï‰ª•Â§ÑÁêÜ Get ËØ∑Ê±Ç„ÄÇ Post() Â¶ÇÊûúÁî®Êà∑ËØ∑Ê±ÇÁöÑ HTTP Method ÊòØ POSTÔºåÈÇ£‰πàÂ∞±ÊâßË°åËØ•ÂáΩÊï∞ÔºåÈªòËÆ§ÊòØ 405ÔºåÁî®Êà∑ÁªßÊâøÁöÑÂ≠ê struct ‰∏≠ÂèØ‰ª•ÂÆûÁé∞‰∫ÜËØ•ÊñπÊ≥ï‰ª•Â§ÑÁêÜ Post ËØ∑Ê±Ç„ÄÇ Delete() Â¶ÇÊûúÁî®Êà∑ËØ∑Ê±ÇÁöÑ HTTP Method ÊòØ DELETEÔºåÈÇ£‰πàÂ∞±ÊâßË°åËØ•ÂáΩÊï∞ÔºåÈªòËÆ§ÊòØ 405ÔºåÁî®Êà∑ÁªßÊâøÁöÑÂ≠ê struct ‰∏≠ÂèØ‰ª•ÂÆûÁé∞‰∫ÜËØ•ÊñπÊ≥ï‰ª•Â§ÑÁêÜ Delete ËØ∑Ê±Ç„ÄÇ Put() Â¶ÇÊûúÁî®Êà∑ËØ∑Ê±ÇÁöÑ HTTP Method ÊòØ PUTÔºåÈÇ£‰πàÂ∞±ÊâßË°åËØ•ÂáΩÊï∞ÔºåÈªòËÆ§ÊòØ 405ÔºåÁî®Êà∑ÁªßÊâøÁöÑÂ≠ê struct ‰∏≠ÂèØ‰ª•ÂÆûÁé∞‰∫ÜËØ•ÊñπÊ≥ï‰ª•Â§ÑÁêÜ Put ËØ∑Ê±Ç. Head() Â¶ÇÊûúÁî®Êà∑ËØ∑Ê±ÇÁöÑ HTTP Method ÊòØ HEADÔºåÈÇ£‰πàÂ∞±ÊâßË°åËØ•ÂáΩÊï∞ÔºåÈªòËÆ§ÊòØ 405ÔºåÁî®Êà∑ÁªßÊâøÁöÑÂ≠ê struct ‰∏≠ÂèØ‰ª•ÂÆûÁé∞‰∫ÜËØ•ÊñπÊ≥ï‰ª•Â§ÑÁêÜ Head ËØ∑Ê±Ç„ÄÇ Patch() Â¶ÇÊûúÁî®Êà∑ËØ∑Ê±ÇÁöÑ HTTP Method ÊòØ PATCHÔºåÈÇ£‰πàÂ∞±ÊâßË°åËØ•ÂáΩÊï∞ÔºåÈªòËÆ§ÊòØ 405ÔºåÁî®Êà∑ÁªßÊâøÁöÑÂ≠ê struct ‰∏≠ÂèØ‰ª•ÂÆûÁé∞‰∫ÜËØ•ÊñπÊ≥ï‰ª•Â§ÑÁêÜ Patch ËØ∑Ê±Ç. Options() Â¶ÇÊûúÁî®Êà∑ËØ∑Ê±ÇÁöÑHTTP MethodÊòØOPTIONSÔºåÈÇ£‰πàÂ∞±ÊâßË°åËØ•ÂáΩÊï∞ÔºåÈªòËÆ§ÊòØ 405ÔºåÁî®Êà∑ÁªßÊâøÁöÑÂ≠ê struct ‰∏≠ÂèØ‰ª•ÂÆûÁé∞‰∫ÜËØ•ÊñπÊ≥ï‰ª•Â§ÑÁêÜ Options ËØ∑Ê±Ç„ÄÇ Finish() Ëøô‰∏™ÂáΩÊï∞ÊòØÂú®ÊâßË°åÂÆåÁõ∏Â∫îÁöÑ HTTP Method ÊñπÊ≥ï‰πãÂêéÊâßË°åÁöÑÔºåÈªòËÆ§ÊòØÁ©∫ÔºåÁî®Êà∑ÂèØ‰ª•Âú®Â≠ê struct ‰∏≠ÈáçÂÜôËøô‰∏™ÂáΩÊï∞ÔºåÊâßË°å‰æãÂ¶ÇÊï∞ÊçÆÂ∫ìÂÖ≥Èó≠ÔºåÊ∏ÖÁêÜÊï∞ÊçÆ‰πãÁ±ªÁöÑÂ∑•‰Ωú„ÄÇ Render() error Ëøô‰∏™ÂáΩÊï∞‰∏ªË¶ÅÁî®Êù•ÂÆûÁé∞Ê∏≤ÊüìÊ®°ÊùøÔºåÂ¶ÇÊûú beego.AutoRender ‰∏∫ true ÁöÑÊÉÖÂÜµ‰∏ãÊâç‰ºöÊâßË°å„ÄÇ ÊâÄ‰ª•ÈÄöËøáÂ≠ê struct ÁöÑÊñπÊ≥ïÈáçÂÜôÔºåÁî®Êà∑Â∞±ÂèØ‰ª•ÂÆûÁé∞Ëá™Â∑±ÁöÑÈÄªËæë„ÄÇ routersÂ±ÇÂÆûÁé∞‰ªÄ‰πàÊòØË∑ØÁî±ËÆæÁΩÆÂë¢ÔºüÂâçÈù¢‰ªãÁªçÁöÑ MVC ÁªìÊûÑÊâßË°åÊó∂Ôºå‰ªãÁªçËøá beego Â≠òÂú®‰∏âÁßçÊñπÂºèÁöÑË∑ØÁî±:Âõ∫ÂÆöË∑ØÁî±„ÄÅÊ≠£ÂàôË∑ØÁî±„ÄÅËá™Âä®Ë∑ØÁî±Ôºå‰∏éRESTFul APIÁõ∏ÂÖ≥ÁöÑÂ∞±ÊòØÂõ∫ÂÆöË∑ØÁî±ÂíåÊ≠£ÂàôË∑ØÁî±„ÄÇ ‰∏ãÈù¢Â∞±ÊòØÂõ∫ÂÆöË∑ØÁî±ÁöÑ‰æãÂ≠ê 1234beego.Router("/", &amp;controllers.MainController&#123;&#125;)beego.Router("/admin", &amp;admin.UserController&#123;&#125;)beego.Router("/admin/index", &amp;admin.ArticleController&#123;&#125;)beego.Router("/admin/addpkg", &amp;admin.AddController&#123;&#125;) ‰∏ãÈù¢ÊòØÊ≠£ÂàôË∑ØÁî±ÁöÑ‰æãÂ≠êÔºö beego.Router(‚Äú/api/?:id‚Äù, &amp;controllers.RController{}) ÈªòËÆ§ÂåπÈÖç //‰æãÂ¶ÇÂØπ‰∫éURL‚Äù/api/123‚ÄùÂèØ‰ª•ÂåπÈÖçÊàêÂäüÔºåÊ≠§Êó∂ÂèòÈáè‚Äù:id‚ÄùÂÄº‰∏∫‚Äù123‚Äù beego.Router(‚Äú/api/:id‚Äù, &amp;controllers.RController{}) ÈªòËÆ§ÂåπÈÖç //‰æãÂ¶ÇÂØπ‰∫éURL‚Äù/api/123‚ÄùÂèØ‰ª•ÂåπÈÖçÊàêÂäüÔºåÊ≠§Êó∂ÂèòÈáè‚Äù:id‚ÄùÂÄº‰∏∫‚Äù123‚ÄùÔºå‰ΩÜURL‚Äù/api/‚ÄúÂåπÈÖçÂ§±Ë¥• beego.Router(‚Äú/api/:id([0-9]+)‚Äú, &amp;controllers.RController{}) Ëá™ÂÆö‰πâÊ≠£ÂàôÂåπÈÖç //‰æãÂ¶ÇÂØπ‰∫éURL‚Äù/api/123‚ÄùÂèØ‰ª•ÂåπÈÖçÊàêÂäüÔºåÊ≠§Êó∂ÂèòÈáè‚Äù:id‚ÄùÂÄº‰∏∫‚Äù123‚Äù beego.Router(‚Äú/user/:username([\w]+)‚Äú, &amp;controllers.RController{}) Ê≠£ÂàôÂ≠óÁ¨¶‰∏≤ÂåπÈÖç //‰æãÂ¶ÇÂØπ‰∫éURL‚Äù/user/astaxie‚ÄùÂèØ‰ª•ÂåπÈÖçÊàêÂäüÔºåÊ≠§Êó∂ÂèòÈáè‚Äù:username‚ÄùÂÄº‰∏∫‚Äùastaxie‚Äù beego.Router(‚Äú/download/.‚Äù, &amp;controllers.RController{}) *ÂåπÈÖçÊñπÂºè //‰æãÂ¶ÇÂØπ‰∫éURL‚Äù/download/file/api.xml‚ÄùÂèØ‰ª•ÂåπÈÖçÊàêÂäüÔºåÊ≠§Êó∂ÂèòÈáè‚Äù:path‚ÄùÂÄº‰∏∫‚Äùfile/api‚ÄùÔºå ‚Äú:ext‚ÄùÂÄº‰∏∫‚Äùxml‚Äù beego.Router(‚Äú/download/ceshi/*‚Äú, &amp;controllers.RController{}) *ÂÖ®ÂåπÈÖçÊñπÂºè //‰æãÂ¶ÇÂØπ‰∫éURL‚Äù/download/ceshi/file/api.json‚ÄùÂèØ‰ª•ÂåπÈÖçÊàêÂäüÔºåÊ≠§Êó∂ÂèòÈáè‚Äù:splat‚ÄùÂÄº‰∏∫‚Äùfile/api.json‚Äù beego.Router(‚Äú/:id:int‚Äù, &amp;controllers.RController{}) int Á±ªÂûãËÆæÁΩÆÊñπÂºèÔºåÂåπÈÖç :id‰∏∫int Á±ªÂûãÔºåÊ°ÜÊû∂Â∏Æ‰Ω†ÂÆûÁé∞‰∫ÜÊ≠£Âàô ([0-9]+) beego.Router(‚Äú/:hi:string‚Äù, &amp;controllers.RController{}) string Á±ªÂûãËÆæÁΩÆÊñπÂºèÔºåÂåπÈÖç :hi ‰∏∫ string Á±ªÂûã„ÄÇÊ°ÜÊû∂Â∏Æ‰Ω†ÂÆûÁé∞‰∫ÜÊ≠£Âàô ([\w]+) beego.Router(‚Äú/cms_:id([0-9]+).html‚Äù, &amp;controllers.CmsController{}) Â∏¶ÊúâÂâçÁºÄÁöÑËá™ÂÆö‰πâÊ≠£Âàô //ÂåπÈÖç :id ‰∏∫Ê≠£ÂàôÁ±ªÂûã„ÄÇÂåπÈÖç cms_123.html ËøôÊ†∑ÁöÑ url :id = 123 ‰∏™‰∫∫ËßâÂæóÔºåÊúÄÊñπ‰æøÁöÑËøòÊòØÁ±ª‰ºº‰∫éPythonÊ°ÜÊû∂flaskÁöÑÊ≥®Ëß£Ë∑ØÁî±Ôºå‰πüÊòØÂú®Ëøô‰∏™È°πÁõÆ‰∏≠‰ΩøÁî®ÁöÑÔºö Âú®routers/routers.goÈáåÈù¢Ê∑ªÂä†‰Ω†ÊâÄÂ∏åÊúõÁöÑAPI 12345678910111213141516171819202122232425262728package routersimport ( "firstAPI/controllers" "github.com/astaxie/beego")func init() &#123; ns := beego.NewNamespace("/v1", beego.NSNamespace("/object", beego.NSInclude( &amp;controllers.ObjectController&#123;&#125;, ), ), beego.NSNamespace("/user", beego.NSInclude( &amp;controllers.UserController&#123;&#125;, ), ), beego.NSNamespace("/student", beego.NSInclude( &amp;controllers.StudentController&#123;&#125;, ), ), ) beego.AddNamespace(ns)&#125; ‰ª•‰∏ä‰ª£Á†ÅÂÆûÁé∞‰∫ÜÂ¶Ç‰∏ãÁöÑAPIÔºö /v1/object /v1/user /v1/student ÈùûÂ∏∏Ê∏ÖÊô∞Êòé‰∫Ü„ÄÇ main.goÁöÑÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ1234567891011121314151617181920212223package mainimport ( _ "firstAPI/routers" "github.com/astaxie/beego" "github.com/astaxie/beego/orm" _ "github.com/go-sql-driver/mysql")func init() &#123; orm.RegisterDriver("mysql", orm.DRMySQL)//Ê≥®ÂÜåMySQLÁöÑdriver orm.RegisterDataBase("default", "mysql", "root:test@tcp(127.0.0.1:3306)/restapi_test?charset=utf8")//Êú¨Âú∞Êï∞ÊçÆÂ∫ìÁöÑË¥¶Âè∑„ÄÇÂØÜÁ†ÅÁ≠â orm.RunSyncdb("default", false, true)&#125;func main() &#123; if beego.BConfig.RunMode == "dev" &#123; beego.BConfig.WebConfig.DirectoryIndex = true beego.BConfig.WebConfig.StaticDir["/swagger"] = "swagger"//ÈùôÊÄÅÊñáÊ°£ &#125; beego.Run()&#125; ÂÖ≥ÈîÆÁÇπÈÉΩÂú®‰ª£Á†Å‰∏≠‰ª•Ê≥®ÈáäÁöÑÂΩ¢ÂºèÂ±ïÁé∞„ÄÇ postmanÊµãËØïbee run ËøêË°å‰ª£Á†ÅÂêéÔºåÊàë‰ª¨‰ΩøÁî®postmanÊµãËØï‰∏Ä‰∏ãÊàë‰ª¨ÊâÄÊûÑÂª∫ÁöÑAPIÊïàÊûúÂ¶Ç‰Ωï„ÄÇ ËøôÈáåËäÇÁúÅÁØáÂπÖÔºåÂè™ÊµãËØï‰∏Ä‰∏™Êé•Âè£„ÄÇ Âà∞Ê≠§‰∏∫Ê≠¢ÔºåÊàë‰ª¨Âü∫‰∫ébeegoÂ∞±ÂÆûÁé∞‰∫ÜÁÆÄÂçïAPIÊé•Âè£ÁöÑÊûÑÂª∫ÔºåÊòØ‰∏çÊòØÊó¢Ê∏ÖÊô∞ÂèàÁÆÄÂçïÂë¢ÔºüËµ∂Âø´Ëá™Â∑±Âä®ÊâãËØïËØïÂêßÔºÅ Êú¨ÊúüÊäÄÊúØÂë®ÂàäÁªìÊùüÔºå‰ª£Á†ÅÂ∑≤‰∏ä‰º†Âà∞GitHubÔºåÂèØ‰ª•Êü•ÈòÖÔºåÊàë‰ª¨‰∏ãÊúüÂÜç‰ºöÔºÅ]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>golang beego</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊÄªÁªìÁâàÂõæËß£http]]></title>
    <url>%2F2018%2F10%2F12%2F%E6%80%BB%E7%BB%93%E7%89%88%E5%9B%BE%E8%A7%A3http%2F</url>
    <content type="text"><![CDATA[ËØ•ÂçöÂÆ¢ËΩ¨ËΩΩËá™ÂÖ¨‰ºóÂè∑freeCodeCamp ‰Ωú‰∏∫‰∏Ä‰∏™ÂâçÁ´ØÔºåÂ¶ÇÊûúÂØπ‰∏Ä‰∏™ÁΩëÈ°µ‰ªéÂèëËµ∑ËØ∑Ê±ÇÂà∞ËøîÂõûÊï∞ÊçÆËøôÊúüÈó¥ÂÖ∑‰ΩìÂèëÁîü‰∫Ü‰ªÄ‰πàÈÉΩ‰∏çÁü•ÈÅìÁöÑËØùÔºåÈÇ£‰∏çÊòØ‰∏Ä‰∏™Â•ΩÂâçÁ´Ø„ÄÇÊúÄËøëÔºåËØª‰∫ÜÂõæËß£httpÔºå‰ª•ÂèäÊúâÂÖ≥httpÁõ∏ÂÖ≥ÁöÑÊñáÁ´†ÔºåËøòÊúâËá™Â∑±‰πü‰∏ãËΩΩ‰∫ÜwiresharkÊäìÂåÖÂ∑•ÂÖ∑ÔºåÂÆûÈôÖËßÇÂØü‰∫Ü‰∏Ä‰∏ãËøô‰∏™ËøáÁ®ãÔºå‰∏ãÈù¢Â∞±Ê≠§ÂÅö‰∫õÊÄªÁªì„ÄÇ ‰∏Ä.‰ªéËæìÂÖ•‰∏Ä‰∏™urlÂà∞ËøîÂõûÊï∞ÊçÆÔºå‰∏≠Èó¥Âà∞Â∫ïÂèëÁîü‰∫Ü‰ªÄ‰πàÔºü ÂÅáËÆæÔºåÊàë‰ª¨Âú®ÊµèËßàÂô®ËæìÂÖ•http://www.baidu.com:80/index.htmlÔºåÂÅáËÆæËß£ÊûêÂá∫ÁöÑipÂú∞ÂùÄÊòØ202.43.78.3 1.ÊµèËßàÂô®Ëß£ÊûêÂá∫‰∏ªÊú∫Âêç Ëß£ÊûêÂá∫ÁöÑ‰∏ªÊú∫ÂêçÊòØwww.baidu.com 2.ÊµèËßàÂô®Êü•ËØ¢Ëøô‰∏™‰∏ªÊú∫ÂêçÁöÑipÂú∞ÂùÄÔºàdnsÔºâ dnsËß£ÊûêÁöÑ‰ΩúÁî®Â∞±ÊòØÊääÂüüÂêçËß£ÊûêÊàêipÂú∞ÂùÄÔºåËøôÊ†∑ÊâçËÉΩÂú®ÂπøÂüüÁΩëË∑ØÁî±Âô®ËΩ¨ÂèëÊä•ÊñáÁªôÁõÆÊ†áipÔºå‰∏çÁÑ∂Ë∑ØÁî±Âô®‰∏çÁü•ÈÅìË¶ÅÊääÊä•ÊñáÂèëÁªôË∞Å„ÄÇ‰∏ãÈù¢Â∞±ËÆ≤‰∏ãÂ§ßÊ¶ÇÁöÑËøáÁ®ãÔºå‰∏ç‰ºöÊ∂âÂèäÂ§™Â§öÁªÜËäÇ„ÄÇÔºà‰ª•chrome‰∏∫‰æãÂ≠êÔºâ Ôºà1ÔºâÊµèËßàÂô®ÂêØÂä®Êó∂ÔºåÈ¶ñÂÖàÊµèËßàÂô®‰ºöÂéªÊìç‰ΩúÁ≥ªÁªüËé∑ÂèñdnsÊúçÂä°Âô®Âú∞ÂùÄÔºåÁÑ∂ÂêéÊääËøô‰∏™Âú∞ÂùÄÁºìÂ≠ò‰∏ãÊù•„ÄÇÂêåÊó∂ÊµèËßàÂô®Ëøò‰ºöÂéªËØªÂèñÂíåËß£ÊûêhostsÊñá‰ª∂ÔºåÂêåÊ†∑ÊîæÂà∞ÁºìÂ≠ò‰∏≠„ÄÇÊµèËßàÂô®ÂØπËß£ÊûêËøáÁöÑÂüüÂêçÂíåipÂú∞ÂùÄÔºåÈÉΩ‰ºö‰øùÂ≠òÁùÄËøô‰∏§ËÄÖÁöÑÊò†Â∞ÑÂÖ≥Á≥ª„ÄÇÔºàÂ≠òÂà∞cache‰∏≠Ôºâ Ôºà2ÔºâÂΩìËß£ÊûêÂüüÂêçÁöÑÊó∂ÂÄôÔºåÈ¶ñÂÖàÊµèËßàÂô®‰ºöÂéªcache‰∏≠Êü•ÊâæÊúâÊ≤°ÊúâÁºìÂ≠òÂ•ΩÁöÑÊò†Â∞ÑÂÖ≥Á≥ªÔºåÂ¶ÇÊûúÊ≤°ÊúâÁöÑËØùÔºåÂ∞±ÂéªhostsÊñá‰ª∂‰∏≠Êü•ÊâæÔºåÂ¶ÇÊûú‰πüÊ≤°ÊúâÁöÑËØùÔºåÊµèËßàÂô®Â∞±‰ºöÂèëËµ∑ËØ∑Ê±ÇÂéªdnsÊúçÂä°Âô®ÁºìÂ≠òÊü•ËØ¢‰∫ÜÔºåÂ¶ÇÊûúÁºìÂ≠òÈáåÈù¢‰πüÊ≤°ÊúâÔºåÈÇ£ÊúÄÂêéÂ∞±ÊòØdnsÊúçÂä°Âô®ÂéªÊü•ËØ¢‰∫Ü„ÄÇ 3.ÊµèËßàÂô®Ëé∑ÂèñÁ´ØÂè£Âè∑ 4.ÊµèËßàÂô®ÂêëÁõÆÊ†áipÂú∞ÂùÄÂèëËµ∑‰∏ÄÊù°Âà∞202.43.78.3:80ÁöÑtcpËøûÊé• ‰∏∫‰∫Ü‰º†ËæìÁöÑÂèØÈù†ÊÄßÔºåtcpÂçèËÆÆË¶ÅÊúâ‰∏âÊ¨°Êè°ÊâãËøáÁ®ãÔºö Ôºà1ÔºâÈ¶ñÂÖàÊµèËßàÂô®‰ºöÂêëÊúçÂä°Âô®ÂèëËµ∑‰∏Ä‰∏™ËøûÊé•ËØ∑Ê±Ç Ôºà2ÔºâÊúçÂä°Âô®‰ºöÂØπËøûÊé•ËØ∑Ê±ÇÂÅöÂá∫ÂìçÂ∫îÔºåË°®Á§∫ÂêåÊÑèÂª∫Á´ãËøûÊé• Ôºà3ÔºâÊµèËßàÂô®Êî∂Âà∞ÂìçÂ∫îÂêéÔºåÂÜçÂëäÁü•ÂØπÊñπÔºåÂÆÉÁü•ÈÅìÊúçÂä°Âô®ÂêåÊÑèÂÆÉÂª∫Á´ãËøûÊé•‰∫Ü„ÄÇ 5.Êï∞ÊçÆÂåÖÂú®ipÂ±Ç‰º†Ëæì Êï∞ÊçÆÂåÖÂú®ipÂ±Ç‰º†ËæìÔºåÈÄöËøáÂ§öÂè∞ËÆ°ÁÆóÊú∫ÂíåÁΩëÁªúËÆæÂ§á‰∏≠ËΩ¨ÔºåÂú®‰∏≠ËΩ¨Êó∂ÔºåÂà©Áî®‰∏≠ËΩ¨ËÆæÂ§áÁöÑmacÂú∞ÂùÄÊêúÁ¥¢‰∏ã‰∏Ä‰∏™‰∏≠ËΩ¨ÁõÆÊ†áÔºàÈááÁî®ARPÂçèËÆÆÔºåÊ†πÊçÆÈÄö‰ø°ÊñπÁöÑipÂú∞ÂùÄÂ∞±ÂèØ‰ª•ÂèçÊü•Âá∫ÂØπÂ∫îÁöÑmacÂú∞ÂùÄÔºâÔºåÁõ¥Âà∞ÁõÆÊ†áipÂú∞ÂùÄ„ÄÇ 6.Êï∞ÊçÆÈìæË∑ØÂ±ÇÂ§ÑÁêÜÁΩëÁªúËøûÊé•ÁöÑÁ°¨‰ª∂ÈÉ®ÂàÜ Êï∞ÊçÆÈìæË∑ØÂ±ÇÂ§ÑÁêÜÁΩëÁªúËøûÊé•ÁöÑÁ°¨‰ª∂ÈÉ®ÂàÜÔºåÊØîÂ¶ÇÁΩëÂç°ÔºåÊâæÂà∞ÊúçÂä°Âô®ÁöÑÁΩëÂç° 7.ÊµèËßàÂô®ÂêëÊúçÂä°Âô®ÂèëÈÄÅ‰∏ÄÊù°httpÊä•Êñá ÊØè‰∏ÄÊù°httpÊä•ÊñáÁöÑÁªÑÊàêÔºö Ëµ∑ÂßãË°å+È¶ñÈÉ®+‰∏ª‰Ωì(ÂèØÈÄâ) Ëµ∑ÂßãË°åÔºöhttp/1.0 200 ok (‰∏ÄËà¨ÂåÖÊã¨httpÁâàÊú¨ÔºåËøîÂõûÁä∂ÊÄÅÁ†ÅÔºåËøîÂõûÁ†ÅÂéüÂõ†) È¶ñÈÉ®Ôºöcontent-type:text/plain content-length:19 ‰∏ª‰ΩìÔºöname=jane 8.ÊúçÂä°Âô®Êé•ÂèóÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÔºåËøõË°å‰∏Ä‰∫õÂ§ÑÁêÜÔºåËøîÂõûÂìçÂ∫îÊä•Êñá webÊúçÂä°Âô®Êé•Êî∂Âà∞ËØ∑Ê±Ç‰πãÂêéÔºåÂÆûÈôÖ‰∏ä‰ºöÂÅö‰∫õ‰ªÄ‰πàÂë¢Ôºü Ôºà1ÔºâÂª∫Á´ãËøûÊé•ÔºåÂ¶ÇÊûúÊé•Âèó‰∏Ä‰∏™ÂÆ¢Êà∑Á´ØËøûÊé•ÔºåÂ∞±Âª∫Á´ãËøûÊé•ÔºåÂ¶ÇÊûú‰∏çÂêåÊÑèÔºåÂ∞±Â∞ÜÂÖ∂ÂÖ≥Èó≠„ÄÇ Ôºà2ÔºâÊé•Êî∂ËØ∑Ê±ÇÔºåËØªÂèñhttpËØ∑Ê±ÇÊä•Êñá Ôºà3ÔºâËÆøÈóÆËµÑÊ∫êÔºåËÆøÈóÆÊä•Êñá‰∏≠ÊåáÂÆöÁöÑËµÑÊ∫ê Ôºà4ÔºâÊûÑÂª∫ÂìçÂ∫îÔºåÂàõÂª∫Â∏¶ÊúâÈ¶ñÈÉ®ÁöÑhttpÂìçÂ∫îÊä•Êñá Ôºà5ÔºâÂèëÈÄÅÂìçÂ∫îÔºåÂ∞ÜÂìçÂ∫îÂõûÈÄÅÁªôÂÆ¢Êà∑Á´Ø 9.ÊµèËßàÂô®ËØªÂèñhttpÂìçÂ∫îÊä•Êñá 10.ÊµèËßàÂô®ÂÖ≥Èó≠ËøûÊé• Áúã‰∫Ü‰∏äÈù¢ÁöÑ‰∏Ä‰∏™ÁÆÄÂçïËøáÁ®ãÔºåÂ§ßÂÆ∂‰ºö‰∏ç‰ºöÊúâËøôÊ†∑‰∏Ä‰∏™ÈóÆÈ¢òÔºåÈöæÈÅìÊØèÊ¨°ÂèëËµ∑‰∏Ä‰∏™httpËØ∑Ê±ÇÔºåÈÉΩË¶ÅÂª∫Á´ã‰∏ÄÊ¨°tcpËøûÊé•ÂêóÔºåÊàë‰ª¨ÁªèÂ∏∏ÂÜôÁöÑÂπ∂ÂèëajaxËØ∑Ê±ÇÔºåÊØèÊù°ËØ∑Ê±ÇÈÉΩÊòØÂêÑËá™Áã¨Á´ãÂª∫Á´ãÁöÑtcpËøûÊé•Ôºü‰∏ÄÊù°tcpËøûÊé•Âª∫Á´ã‰πãÂêéÔºåÊòØ‰ªÄ‰πàÊó∂ÂÄôÂÖ≥Èó≠ÁöÑÔºüÂ∏¶ÁùÄËøô‰∫õÈóÆÈ¢òÔºåÁúãÁúã‰∏ãÈù¢Ë¶ÅËÆ≤ÁöÑhttpÁöÑÁâπÊÄß ‰∫å.httpÁöÑÁâπÊÄß 1.httpÊòØ‰∏ç‰øùÂ≠òÁä∂ÊÄÅÁöÑÂçèËÆÆ httpÂçèËÆÆÊòØ‰∏ÄÁßçÊó†Áä∂ÊÄÅÁöÑÂçèËÆÆÔºåÊÑèÊÄùÂ∞±ÊòØËØ¥ÂÆÉ‰∏ç‰ºöÂØπÊØèÊ¨°ÁöÑËØ∑Ê±ÇÂíåÂìçÂ∫î‰πãÈó¥ÁöÑÈÄö‰ø°Áä∂ÊÄÅËøõË°å‰øùÂ≠ò„ÄÇ‰Ω†‰πãÂâçÂèëËøáÁöÑ‰ªª‰ΩïËØ∑Ê±ÇÁöÑ‰ø°ÊÅØÔºåÊ≤°Êúâ‰ªª‰ΩïËÆ∞ÂΩï„ÄÇ‰πãÊâÄ‰ª•ËøôÊ†∑ËÆæËÆ°Ôºå‰πüÊòØ‰∏∫‰∫ÜËÆ©httpÂèòÂæóÊØîËæÉÁÆÄÂçïÔºåÂèØ‰ª•Â§ÑÁêÜÂ§ßÈáè‰∫ãÁâ©„ÄÇ‰ΩÜÊòØÊó†Áä∂ÊÄÅÁöÑÁâπÊÄßÔºå‰πü‰ºöÂØºËá¥‰∏Ä‰∫õÈóÆÈ¢òÔºåÊØîÂ¶ÇËØ¥‰∏Ä‰∏™Áî®Êà∑ÁôªÂΩï‰∏ÄÂÆ∂ÁΩëÁ´ô‰πãÂêéÔºåË∑≥Âà∞Âè¶‰∏Ä‰∏™È°µÈù¢ÔºåÂ∫îËØ•Ëøò‰øùÊåÅÁùÄÁôªÂΩïÁä∂ÊÄÅÔºåÊâÄ‰ª•ÂêéÈù¢Â∞±Âá∫‰∫ÜcookieÁä∂ÊÄÅÁÆ°ÁêÜÊäÄÊúØ„ÄÇÁõ∏‰ø°Â§ßÂÆ∂Â∫îËØ•ÈÉΩÂæàÁÜüÊÇâ‰∫Ü„ÄÇ 2.ËØ∑Ê±ÇÂè™ËÉΩ‰ªéÂÆ¢Êà∑Á´ØÂºÄÂßãÔºåÂÆ¢Êà∑Á´Ø‰∏çÂèØ‰ª•Êé•Êî∂Èô§ÂìçÂ∫î‰ª•Â§ñÁöÑÊåá‰ª§ ÊúçÂä°Âô®ÂøÖÈ°ªÁ≠âÂæÖÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±ÇÔºåÊâçËÉΩÁªôÂÆ¢Êà∑Á´ØÂèëÈÄÅÂìçÂ∫îÊï∞ÊçÆÔºåÊâÄ‰ª•ËØ¥ÊúçÂä°Âô®ÊòØ‰∏çËÉΩ‰∏ªÂä®ÁªôÂÆ¢Êà∑Á´ØÊé®ÈÄÅÊï∞ÊçÆÁöÑ„ÄÇÂØπ‰∫é‰∏Ä‰∫õÂÆûÊó∂ÁõëÊéßÁöÑÂäüËÉΩÔºåÂ∏∏Â∏∏Áî®websocketÊù•‰ª£Êõø 3.Ê≤°ÊúâÁî®Êà∑ËÆ§ËØÅÔºå‰ªª‰Ωï‰∫∫ÈÉΩÂèØ‰ª•ÂèëËµ∑ËØ∑Ê±Ç Âú®httpÂçèËÆÆÈÄö‰ø°Êó∂ÔºåÊòØ‰∏çÂ≠òÂú®Á°ÆËÆ§ÈÄö‰ø°ÊñπÁöÑÂ§ÑÁêÜÊ≠•È™§ÁöÑÔºå‰ªª‰Ωï‰∫∫ÈÉΩÂèØ‰ª•ÂèëËµ∑ËØ∑Ê±Ç„ÄÇÂè¶Â§ñÔºåÊúçÂä°Âô®Âè™Ë¶ÅÊî∂Âà∞ËØ∑Ê±ÇÔºåÊó†ËÆ∫ÊòØË∞ÅÔºåÈÉΩ‰ºöËøîÂõû‰∏Ä‰∏™ÂìçÂ∫î„ÄÇÊâÄ‰ª•‰ºöÂ≠òÂú®‰º™Ë£ÖÁöÑÈöêÊÇ£„ÄÇÂêéÈù¢Âá∫Áé∞ÁöÑhttpsÂ∞±ÂèØ‰ª•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ 4.ÈÄö‰ø°‰ΩøÁî®ÁöÑÊòØÊòéÊñá 5.Êó†Ê≥ïËØÅÊòéÊä•ÊñáÂÆåÊï¥ÊÄß 6.ÂèØ‰ªªÊÑèÈÄâÊã©Êï∞ÊçÆÂéãÁº©Ê†ºÂºèÔºåÈùûÂº∫Âà∂ÂéãÁº©ÂèëÈÄÅ 7.httpÊåÅ‰πÖËøûÊé•ÂíåÂπ∂Ë°åËøûÊé• ‰∏ÄÂºÄÂßãÔºåhttpËØ∑Ê±ÇÊòØ‰∏≤Ë°åÁöÑÔºå‰∏Ä‰∏™httpËØ∑Ê±ÇÔºåÂ∞±‰ºöÂª∫Á´ã‰∏ÄÊù°tcpËøûÊé•ÔºåÊµèËßàÂô®Êî∂Âà∞ÂìçÂ∫î‰πãÂêéÔºåÂ∞±‰ºöÊñ≠ÂºÄËøûÊé•„ÄÇÁ≠â‰∏ä‰∏Ä‰∏™ËØ∑Ê±ÇÂõûÊù•‰∫ÜÔºå‰∏ã‰∏Ä‰∏™ËØ∑Ê±ÇÊâçËÉΩÁªßÁª≠ËØ∑Ê±Ç„ÄÇËøôÊ†∑ÂÅöÁöÑÁº∫ÁÇπÊòØÔºåÊØîËæÉËÄóÊó∂Èó¥ÂíåÂÜÖÂ≠òÔºåÂêéÈù¢Â∞±Âá∫Áé∞‰∫Ü‰∏ãÈù¢‰∏ÄÁ≥ªÂàóÁöÑ‰ºòÂåñËøûÊé•ÊÄßËÉΩÁöÑÊñπÊ≥ï„ÄÇ Ôºà1ÔºâÂπ∂Ë°åËøûÊé• ÂéüÁêÜÔºöÈÄöËøáÂ§öÊù°tcpËøûÊé•ÂèëËµ∑Âπ∂ÂèëÁöÑhttpËØ∑Ê±Ç Âπ∂Ë°åËøûÊé•ÂèØ‰ª•ÂêåÊó∂ÂèëËµ∑Â§ö‰∏™httpËØ∑Ê±ÇÔºåÊØèÊ¨°ÂèëËµ∑‰∏Ä‰∏™httpËØ∑Ê±ÇÔºåÂ∞±‰ºöÂª∫Á´ã‰∏Ä‰∏™tcpËøûÊé•„ÄÇÊØè‰∏™httpËØ∑Ê±ÇÊòØÁã¨Á´ãÁöÑÔºå‰∏ç‰ºöÁõ∏‰∫íÁ≠âÂæÖÔºåËøôÊ†∑ÂÅöÔºåÂæàÂèØËÉΩ‰ºöÊèêÈ´òÈ°µÈù¢ÁöÑÂä†ËΩΩÈÄüÂ∫¶ÔºåÂõ†‰∏∫‰∫∫‰ª¨‰ºöÁúãÂà∞È°µÈù¢‰∏äÈù¢ÔºåÂæàÂ§ö‰∏™‰∏úË•ø‰ºöÂêåÊó∂Âá∫Áé∞ÔºåÊâÄ‰ª•ÊÑüËßâÈ°µÈù¢Âä†ËΩΩÂèòÂø´‰∫Ü„ÄÇÂÆûÈôÖ‰∏äÊúâÊó∂ÂÄôÊòØÁúüÁöÑÂèòÂø´‰∫ÜÔºåÂõ†‰∏∫ÂÆÉÊòØÂπ∂Ë°åÂ∑•‰ΩúÁöÑ„ÄÇ‰ΩÜÊòØÊúâÊó∂ÂÄô‰∏çÊòØÁúüÁöÑÂø´‰∫Ü„ÄÇÊØîÂ¶ÇËØ¥ÔºåÂÆ¢Êà∑Á´ØÁöÑÁΩëÁªúÂ∏¶ÂÆΩ‰∏çË∂≥Êó∂ÔºåÔºàÊµèËßàÂô®ÊòØÈÄöËøá‰∏Ä‰∏™28kbpsÁöÑmodemËøûÊé•Âà∞Âõ†ÁâπÁΩë‰∏äÂéªÁöÑÔºâÔºåÂ¶ÇÊûúÂπ∂Ë°åÂä†ËΩΩÂ§ö‰∏™ËØ∑Ê±ÇÔºåÊØè‰∏™ËØ∑Ê±ÇÂ∞±‰ºöÂéªÁ´û‰∫âËøô‰∏™ÊúâÈôêÁöÑÂ∏¶ÂÆΩÔºåÊØè‰∏™ËØ∑Ê±ÇÂ∞±‰ºö‰ª•ÊØîËæÉÊÖ¢ÁöÑÈÄüÂ∫¶Âä†ËΩΩ„ÄÇËøôÊ†∑Â∏¶Êù•ÁöÑÊÄßËÉΩÊèêÂçáÂ∞±ÂæàÂ∞è„ÄÇ Ôºà2ÔºâÊåÅ‰πÖËøûÊé• ÂéüÁêÜÔºöÈáçÁî®tcpËøûÊé•Ôºå‰ª•Ê∂àÈô§ËøûÊé•ÂèäÂÖ≥Èó≠Êó∂Âª∂ ‰ªéhttp1.1ÂºÄÂßãÔºåÂ∞±ÂÖÅËÆ∏ÂΩìhttpÂìçÂ∫îÁªìÊùüÂêéÔºåtcpËøûÊé•ÂèØ‰ª•‰øùÊåÅÂú®ÊâìÂºÄÁä∂ÊÄÅÔºå‰ª•‰æøÁªôÊú™Êù•ÁöÑhttpËØ∑Ê±ÇÈáçÁî®Áé∞Âú®ÁöÑËøûÊé•„ÄÇÈÇ£‰πàÔºåËøô‰∏™tcpËøûÊé•‰ªÄ‰πàÊó∂ÂÄô‰ºöÂÖ≥Èó≠Âë¢Ôºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºå40sÂÜÖÔºåÂ¶ÇÊûúÊ≤°ÊúâÊñ∞ÁöÑËØ∑Ê±ÇÔºåÂ∞±‰ºöÂÖ≥Èó≠„ÄÇ Ôºà3ÔºâÁÆ°ÈÅìÂåñËøûÊé• ÂéüÁêÜÔºöÈÄöËøáÂÖ±‰∫´ÁöÑtcpËøûÊé•ÂèëËµ∑Âπ∂ÂèëÁöÑhttpËØ∑Ê±Ç Âπ∂Ë°åËøûÊé•ÂèØ‰ª•ÊèêÈ´òÂ§çÂêàÈ°µÈù¢ÁöÑ‰º†ËæìÈÄüÂ∫¶Ôºå‰ΩÜÊòØ‰πüÊúâËÆ∏Â§öÁº∫ÁÇπÔºåÊØîÂ¶ÇÊØèÊ¨°ÈÉΩ‰ºöÂª∫Á´ã‰∏ÄÊ¨°tcpËøûÊé•Ôºå‰ºöËÄóË¥πÊó∂Èó¥ÂíåÂ∏¶ÂÆΩ„ÄÇÊåÅ‰πÖËøûÊé•ÁöÑ‰ºòÂäøÂ∞±ÊòØÈôç‰Ωé‰∫ÜÊó∂Âª∂ÂíåtcpÁöÑËøûÊé•Êï∞Èáè„ÄÇ‰ΩÜÊòØÊåÅ‰πÖËøûÊé•ÂèØËÉΩ‰ºöÂØºËá¥ÁöÑ‰∏Ä‰∏™ÈóÆÈ¢òÊòØÔºåÂèØËÉΩ‰ºöÁ¥ØÁßØÂ§ßÈáèÁöÑÁ©∫Èó≤ËøûÊé•„ÄÇËÄóË¥πËµÑÊ∫ê„ÄÇ ÊåÅ‰πÖËøûÊé•ÂíåÂπ∂Ë°åËøûÊé•ÈÖçÂêà‰ΩøÁî®ÊâçÊòØÊúÄÈ´òÊïàÁöÑÊñπÂºè„ÄÇ ‰∏ÄËà¨ÊµèËßàÂô®‰ºöÈôêÂà∂ÔºåÂêå‰∏™ÂüüÂêç‰∏ãÁöÑÂπ∂Ë°åËøûÊé•ÁöÑ‰∏™Êï∞ÊòØ4‰∏™ÔºåÂç≥ÊâìÂºÄÂ∞ëÈáèÁöÑÂπ∂Ë°åËøûÊé•ÔºåÂÖ∂‰∏≠ÊØè‰∏™ÈÉΩÊòØÊåÅ‰πÖËøûÊé•„ÄÇËøô‰πüÊòØÁé∞Âú®Áî®ÁöÑÊúÄÂ§öÁöÑÊñπÂºè„ÄÇ]]></content>
      <categories>
        <category>ÁΩëÁªú</category>
      </categories>
      <tags>
        <tag>ÁΩëÁªú</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python apscheduler - skipped: maximum number of running instances reached]]></title>
    <url>%2F2018%2F09%2F28%2Fpython-apscheduler-skipped-maximum-number-of-running-instances-reached%2F</url>
    <content type="text"><![CDATA[Âá∫Áé∞ÈóÆÈ¢òÁöÑ‰ª£Á†Å123scheduler = BackgroundScheduler()scheduler.add_job(runsync, 'interval', seconds=1)scheduler.start() ÈóÆÈ¢òÂá∫Áé∞ÁöÑÊÉÖÂÜµ ËøêË°å‰∏ÄÊÆµ‰ª£Á†ÅÔºåÊó∂ËÄåÊä•ÈîôÊó∂ËÄå‰∏çÊä•Èîô Êä•ÈîôÊòØÔºö 1WARNING:apscheduler.scheduler:Execution of job &quot;runsync (trigger: interval[0:00:01], next run at: 2015-12-01 11:50:42 UTC)&quot; skipped: maximum number of running instances reached (1) ÂàÜÊûê apschedulerËøô‰∏™Ê®°ÂùóÔºåÂú®‰Ω†ÁöÑ‰ª£Á†ÅËøêË°åÊó∂Èó¥Â§ß‰∫éintervalÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÊä•Èîô ‰πüÂ∞±ÊòØËØ¥Ôºå‰Ω†ÁöÑ‰ª£Á†ÅËøêË°åÊó∂Èó¥Ë∂ÖÂá∫‰∫Ü‰Ω†ÁöÑÂÆöÊó∂‰ªªÂä°ÁöÑÊó∂Èó¥Èó¥Èöî„ÄÇ Ëß£ÂÜ≥ Â¢ûÂ§ßÊó∂Èó¥Èó¥ÈöîÂç≥ÂèØ ###]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python ÁöÑloggingÊ®°ÂùóÂÆûÁé∞jsonÊ†ºÂºèÁöÑÊó•ÂøóËæìÂá∫]]></title>
    <url>%2F2018%2F09%2F27%2Fpython-%E7%9A%84logging%E6%A8%A1%E5%9D%97%E5%AE%9E%E7%8E%B0json%E6%A0%BC%E5%BC%8F%E7%9A%84%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÔºö ÊÉ≥Ë¶ÅËÆ©ÂºÄÂèëËøáÁ®ãÊàñËÄÖÊòØ‰∏äÁ∫øÂêéÁöÑbugÊó†Â§ÑÂèØËóèÔºåÊúÄÂ•ΩÁöÑÊñπÂºè‰æøÊòØÂú®Á®ãÂ∫èËøêË°åËøáÁ®ã‰∏≠Ôºå‰∏çÊñ≠Êî∂ÈõÜÈáçË¶ÅÁöÑÊó•ÂøóÔºå‰ª•‰æõÂàÜÊûê‰ΩøÁî®„ÄÇPython‰∏≠ÂÜÖÁΩÆÁöÑlogÊî∂ÈõÜÊ®°ÂùóÊòØloggingÔºåËØ•Ê®°Âùó‰ΩøÁî®Ëµ∑Êù•ÊØîËæÉÊñπ‰æøÔºå‰ΩÜÊòØÁæé‰∏≠‰∏çË∂≥ÁöÑÂú∞ÊñπÂ∞±ÊòØÊó•ÂøóÁöÑÊ†ºÂºèËΩ¨ÊàêjsonÊØîËæÉÈ∫ªÁÉ¶„ÄÇ‰∫éÊòØÊàëÁªìÂêàloggingÂíåÂè¶‰∏Ä‰∏™Ê®°Âùópython-json-logger(pip install python-json-logger) ÔºåÂÆûÁé∞jsonÊ†ºÂºèÁöÑÊó•ÂøóËæìÂá∫„ÄÇ Ê∫êÁ†ÅÔºö‰ª•‰∏ã‰ª£Á†ÅÂèØ‰ª•ÂÅöÊàêÊ®°ÂùóÔºåÁõ¥Êé•ÂØºÂÖ•‰ΩøÁî®123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384import logging, logging.config, osimport structlogfrom structlog import configure, processors, stdlib, threadlocalfrom pythonjsonlogger import jsonloggerBASE_DIR = BASE_DIR = os.path.dirname(os.path.abspath(__file__))DEBUG = True # Ê†áËÆ∞ÊòØÂê¶Âú®ÂºÄÂèëÁéØÂ¢É# ÁªôËøáÊª§Âô®‰ΩøÁî®ÁöÑÂà§Êñ≠class RequireDebugTrue(logging.Filter): # ÂÆûÁé∞filterÊñπÊ≥ï def filter(self, record): return DEBUGdef get_logger(): LOGGING = &#123; # Âü∫Êú¨ËÆæÁΩÆ 'version': 1, # Êó•ÂøóÁ∫ßÂà´ 'disable_existing_loggers': False, # ÊòØÂê¶Á¶ÅÁî®Áé∞ÊúâÁöÑËÆ∞ÂΩïÂô® # Êó•ÂøóÊ†ºÂºèÈõÜÂêà 'formatters': &#123; # Ê†áÂáÜËæìÂá∫Ê†ºÂºè 'json': &#123; # [ÂÖ∑‰ΩìÊó∂Èó¥][Á∫øÁ®ãÂêç:Á∫øÁ®ãID][Êó•ÂøóÂêçÂ≠ó:Êó•ÂøóÁ∫ßÂà´ÂêçÁß∞(Êó•ÂøóÁ∫ßÂà´ID)] [ËæìÂá∫ÁöÑÊ®°Âùó:ËæìÂá∫ÁöÑÂáΩÊï∞]:Êó•ÂøóÂÜÖÂÆπ 'format': '[%(asctime)s][%(threadName)s:%(thread)d][%(name)s:%(levelname)s(%(lineno)d)]\n[%(module)s:%(funcName)s]:%(message)s', 'class': 'pythonjsonlogger.jsonlogger.JsonFormatter', &#125; &#125;, # ËøáÊª§Âô® 'filters': &#123; 'require_debug_true': &#123; '()': RequireDebugTrue, &#125; &#125;, # Â§ÑÁêÜÂô®ÈõÜÂêà 'handlers': &#123; # ËæìÂá∫Âà∞ÊéßÂà∂Âè∞ # ËæìÂá∫Âà∞Êñá‰ª∂ 'TimeChecklog': &#123; 'level': 'DEBUG', 'class': 'logging.handlers.RotatingFileHandler', 'formatter': 'json', 'filename': os.path.join("./log/", 'TimeoutCheck.log'), # ËæìÂá∫‰ΩçÁΩÆ 'maxBytes': 1024 * 1024 * 5, # Êñá‰ª∂Â§ßÂ∞è 5M 'backupCount': 5, # Â§á‰ªΩ‰ªΩÊï∞ 'encoding': 'utf8', # Êñá‰ª∂ÁºñÁ†Å &#125;, &#125;, # Êó•ÂøóÁÆ°ÁêÜÂô®ÈõÜÂêà 'loggers': &#123; # ÁÆ°ÁêÜÂô® 'proxyCheck': &#123; 'handlers': ['TimeChecklog'], 'level': 'DEBUG', 'propagate': True, # ÊòØÂê¶‰º†ÈÄíÁªôÁà∂ËÆ∞ÂΩïÂô® &#125;, &#125; &#125; configure( logger_factory=stdlib.LoggerFactory(), processors=[ stdlib.render_to_log_kwargs] ) logging.config.dictConfig(LOGGING) logger = logging.getLogger("proxyCheck") return logger# ÊµãËØïÁî®‰æãÔºå‰Ω†ÂèØ‰ª•Êääget_logger()Â∞ÅË£ÖÊàê‰∏Ä‰∏™Ê®°ÂùóÔºåfrom xxx import get_logger()logger1 = get_logger()def test(): try: a = 1 / 0 except Exception as e: logger1.error(e) # ÂÜôÂÖ•ÈîôËØØÊó•Âøó #Â¶ÇÊûúÈúÄË¶ÅÊ∑ªÂä†È¢ùÂ§ñÁöÑ‰ø°ÊÅØÔºå‰ΩøÁî®extraÂÖ≥ÈîÆÂ≠óÂç≥ÂèØ logger1.error(e, extra=&#123;key1: value1, key2:value2&#125;) # ÂÖ∂‰ªñÈîôËØØÂ§ÑÁêÜ‰ª£Á†Å passtest() ### ÊµãËØïÁªìÊûú ÊµãËØïÁöÑÁªìÊûúÔºåÂèØ‰ª•Âú®./log/xxx.logÊñá‰ª∂‰∏≠ÁúãÂà∞ËæìÂá∫ÁöÑÊó•Âøó 1&#123;&quot;asctime&quot;: &quot;2018-09-28 09:52:12,622&quot;, &quot;threadName&quot;: &quot;MainThread&quot;, &quot;thread&quot;: 4338656704, &quot;name&quot;: &quot;proxyCheck&quot;, &quot;levelname&quot;: &quot;ERROR&quot;, &quot;%(lineno&quot;: null, &quot;module&quot;: &quot;mylog&quot;, &quot;funcName&quot;: &quot;test&quot;, &quot;message&quot;: &quot;division by zero&quot;&#125; ÂèØ‰ª•ÁúãÂà∞Êó•ÂøóÊòØjsonÊ†ºÂºèÔºåËøôÊ†∑‰Ω†Â∞±ÂèØ‰ª•ÂæàÊñπ‰æøÁöÑ‰ΩøÁî®grafnaÂíåESÂ∞ÜÊó•ÂøóÂÅöÊàêÁúãÊùøÊù•Â±ïÁ§∫‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python ÂèëÈÄÅÂêÑÁßçÊ†ºÂºèÁöÑÈÇÆ‰ª∂]]></title>
    <url>%2F2018%2F09%2F17%2Fpython-%E5%8F%91%E9%80%81%E5%90%84%E7%A7%8D%E6%A0%BC%E5%BC%8F%E7%9A%84%E9%82%AE%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[12345678910111213141516171819202122232425262728293031323334353637383940414243import smtplibfrom email.mime.multipart import MIMEMultipartfrom email.mime.text import MIMETextfrom email.mime.application import MIMEApplication_user = "sigeken@qq.com"_pwd = "***"_to = "402363522@qq.com" #Â¶ÇÂêçÂ≠óÊâÄÁ§∫MultipartÂ∞±ÊòØÂàÜÂ§ö‰∏™ÈÉ®ÂàÜmsg = MIMEMultipart()msg["Subject"] = "don't panic"msg["From"] = _usermsg["To"] = _to #---ËøôÊòØÊñáÂ≠óÈÉ®ÂàÜ---part = MIMEText("‰πîË£ÖÊâìÊâÆÔºå‰∏çÊã©ÊâãÊÆµ")msg.attach(part) #---ËøôÊòØÈôÑ‰ª∂ÈÉ®ÂàÜ---#xlsxÁ±ªÂûãÈôÑ‰ª∂part = MIMEApplication(open('foo.xlsx','rb').read())part.add_header('Content-Disposition', 'attachment', filename="foo.xlsx")msg.attach(part) #jpgÁ±ªÂûãÈôÑ‰ª∂part = MIMEApplication(open('foo.jpg','rb').read())part.add_header('Content-Disposition', 'attachment', filename="foo.jpg")msg.attach(part) #pdfÁ±ªÂûãÈôÑ‰ª∂part = MIMEApplication(open('foo.pdf','rb').read())part.add_header('Content-Disposition', 'attachment', filename="foo.pdf")msg.attach(part) #mp3Á±ªÂûãÈôÑ‰ª∂part = MIMEApplication(open('foo.mp3','rb').read())part.add_header('Content-Disposition', 'attachment', filename="foo.mp3")msg.attach(part) s = smtplib.SMTP("smtp.qq.com", timeout=30)#ËøûÊé•smtpÈÇÆ‰ª∂ÊúçÂä°Âô®,Á´ØÂè£ÈªòËÆ§ÊòØ25s.login(_user, _pwd)#ÁôªÈôÜÊúçÂä°Âô®s.sendmail(_user, _to, msg.as_string())#ÂèëÈÄÅÈÇÆ‰ª∂s.close()]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊäÄÊúØÂë®Âàä‰πãÂΩì‰Ω†pingÁöÑÊó∂ÂÄôÔºåÂèëÁîü‰∫Ü‰ªÄ‰πàÔºü]]></title>
    <url>%2F2018%2F09%2F16%2F%E6%8A%80%E6%9C%AF%E5%91%A8%E5%88%8A%E4%B9%8B%E5%BD%93%E4%BD%A0ping%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[Êàë‰ª¨Âú®ÈÅáÂà∞ÁΩëÁªú‰∏çÈÄöÁöÑÊÉÖÂÜµÔºåÂ§ßÂÆ∂ÈÉΩÁü•ÈÅìÂéª ping ‰∏Ä‰∏ãÔºåÁúã‰∏Ä‰∏ãÁΩëÁªúÁä∂ÂÜµ„ÄÇÈÇ£‰Ω†Áü•ÈÅì„Äåping„ÄçÂëΩ‰ª§ÂêéËÉåÁöÑÈÄªËæëÊòØ‰ªÄ‰πàÂêóÔºüÁü•ÈÅìÂÆÉÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÂêóÔºüÊú¨Âë®Â∞±ËÆ©Êàë‰ª¨Ê∑±ÂÖ•ÊµÖÂá∫pingÁöÑÊú∫Âà∂„ÄÇ pingÁöÑ‰ΩúÁî®ÂíåÂéüÁêÜÁÆÄÂçïÊù•ËØ¥Ôºå„Äåping„ÄçÊòØÁî®Êù•Êé¢ÊµãÊú¨Êú∫‰∏éÁΩëÁªú‰∏≠Âè¶‰∏Ä‰∏ªÊú∫‰πãÈó¥ÊòØÂê¶ÂèØËææÁöÑÂëΩ‰ª§ÔºåÂ¶ÇÊûú‰∏§Âè∞‰∏ªÊú∫‰πãÈó¥ping‰∏çÈÄöÔºåÂàôË°®ÊòéËøô‰∏§Âè∞‰∏ªÊú∫‰∏çËÉΩÂª∫Á´ãËµ∑ËøûÊé•„ÄÇpingÊòØÂÆö‰ΩçÁΩëÁªúÈÄö‰∏çÈÄöÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÊâãÊÆµ„ÄÇ ping ÂëΩ‰ª§ÊòØÂü∫‰∫é ICMP ÂçèËÆÆÊù•Â∑•‰ΩúÁöÑÔºå„Äå ICMP „ÄçÂÖ®Áß∞‰∏∫ Internet ÊéßÂà∂Êä•ÊñáÂçèËÆÆÔºà Internet Control Message ProtocolÔºâ„ÄÇping ÂëΩ‰ª§‰ºöÂèëÈÄÅ‰∏Ä‰ªΩICMPÂõûÊòæËØ∑Ê±ÇÊä•ÊñáÁªôÁõÆÊ†á‰∏ªÊú∫ÔºåÂπ∂Á≠âÂæÖÁõÆÊ†á‰∏ªÊú∫ËøîÂõûICMPÂõûÊòæÂ∫îÁ≠î„ÄÇÂõ†‰∏∫ICMPÂçèËÆÆ‰ºöË¶ÅÊ±ÇÁõÆÊ†á‰∏ªÊú∫Âú®Êî∂Âà∞Ê∂àÊÅØ‰πãÂêéÔºåÂøÖÈ°ªËøîÂõûICMPÂ∫îÁ≠îÊ∂àÊÅØÁªôÊ∫ê‰∏ªÊú∫ÔºåÂ¶ÇÊûúÊ∫ê‰∏ªÊú∫Âú®‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÊî∂Âà∞‰∫ÜÁõÆÊ†á‰∏ªÊú∫ÁöÑÂ∫îÁ≠îÔºåÂàôË°®Êòé‰∏§Âè∞‰∏ªÊú∫‰πãÈó¥ÁΩëÁªúÊòØÂèØËææÁöÑ„ÄÇ ‰∏æ‰∏Ä‰∏™‰æãÂ≠êÊù•ÊèèËø∞„Äåping„ÄçÂëΩ‰ª§ÁöÑÂ∑•‰ΩúËøáÁ®ãÔºö ÂÅáËÆæÊúâ‰∏§‰∏™‰∏ªÊú∫Ôºå‰∏ªÊú∫AÔºà192.168.0.1ÔºâÂíå‰∏ªÊú∫BÔºà192.168.0.2ÔºâÔºåÁé∞Âú®Êàë‰ª¨Ë¶ÅÁõëÊµã‰∏ªÊú∫AÂíå‰∏ªÊú∫B‰πãÈó¥ÁΩëÁªúÊòØÂê¶ÂèØËææÔºåÈÇ£‰πàÊàë‰ª¨Âú®‰∏ªÊú∫A‰∏äËæìÂÖ•ÂëΩ‰ª§Ôºöping 192.168.0.2 Ê≠§Êó∂ÔºåpingÂëΩ‰ª§‰ºöÂú®‰∏ªÊú∫A‰∏äÊûÑÂª∫‰∏Ä‰∏™ ICMPÁöÑËØ∑Ê±ÇÊï∞ÊçÆÂåÖÔºàÊï∞ÊçÆÂåÖÈáåÁöÑÂÜÖÂÆπÂêéÈù¢ÂÜçËØ¶Ëø∞ÔºâÔºåÁÑ∂Âêé ICMPÂçèËÆÆ‰ºöÂ∞ÜËøô‰∏™Êï∞ÊçÆÂåÖ‰ª•ÂèäÁõÆÊ†áIPÔºà192.168.0.2ÔºâÁ≠â‰ø°ÊÅØ‰∏ÄÂêå‰∫§ÁªôIPÂ±ÇÂçèËÆÆ„ÄÇ IPÂ±ÇÂçèËÆÆÂæóÂà∞Ëøô‰∫õ‰ø°ÊÅØÂêéÔºåÂ∞ÜÊ∫êÂú∞ÂùÄÔºàÂç≥Êú¨Êú∫IPÔºâ„ÄÅÁõÆÊ†áÂú∞ÂùÄÔºàÂç≥ÁõÆÊ†áIPÔºö192.168.0.2Ôºâ„ÄÅÂÜçÂä†‰∏ä‰∏Ä‰∫õÂÖ∂ÂÆÉÁöÑÊéßÂà∂‰ø°ÊÅØÔºåÊûÑÂª∫Êàê‰∏Ä‰∏™IPÊï∞ÊçÆÂåÖ„ÄÇ IPÊï∞ÊçÆÂåÖÊûÑÂª∫ÂÆåÊàêÂêéÔºåËøò‰∏çÂ§üÔºåËøòÈúÄË¶ÅÂä†‰∏äMACÂú∞ÂùÄÔºåÂõ†Ê≠§ÔºåËøòÈúÄË¶ÅÈÄöËøáARPÊò†Â∞ÑË°®ÊâæÂá∫ÁõÆÊ†áIPÊâÄÂØπÂ∫îÁöÑMACÂú∞ÂùÄ„ÄÇÂΩìÊãøÂà∞‰∫ÜÁõÆÊ†á‰∏ªÊú∫ÁöÑMACÂú∞ÂùÄÂíåÊú¨Êú∫MACÂêéÔºå‰∏ÄÂπ∂‰∫§ÁªôÊï∞ÊçÆÈìæË∑ØÂ±ÇÔºåÁªÑË£ÖÊàê‰∏Ä‰∏™Êï∞ÊçÆÂ∏ßÔºå‰æùÊçÆ‰ª•Â§™ÁΩëÁöÑ‰ªãË¥®ËÆøÈóÆËßÑÂàôÔºåÂ∞ÜÂÆÉ‰ª¨‰º†ÈÄÅÂá∫Âá∫Âéª„ÄÇ ÂΩì‰∏ªÊú∫BÊî∂Âà∞Ëøô‰∏™Êï∞ÊçÆÂ∏ß‰πãÂêéÔºå‰ºöÈ¶ñÂÖàÊ£ÄÊü•ÂÆÉÁöÑÁõÆÊ†áMACÂú∞ÂùÄÊòØ‰∏çÊòØÊú¨Êú∫ÔºåÂ¶ÇÊûúÊòØÂ∞±Êé•Êî∂‰∏ãÊù•Â§ÑÁêÜÔºåÊé•Êî∂‰πãÂêé‰ºöÊ£ÄÊü•Ëøô‰∏™Êï∞ÊçÆÂ∏ßÔºåÂ∞ÜÊï∞ÊçÆÂ∏ß‰∏≠ÁöÑIPÊï∞ÊçÆÂåÖÂèñÂá∫Êù•Ôºå‰∫§ÁªôÊú¨Êú∫ÁöÑIPÂ±ÇÂçèËÆÆÔºåÁÑ∂ÂêéIPÂ±ÇÂçèËÆÆÊ£ÄÊü•ÂÆå‰πãÂêéÔºåÂÜçÂ∞ÜICMPÊï∞ÊçÆÂåÖÂèñÂá∫Êù•‰∫§ÁªôICMPÂçèËÆÆÂ§ÑÁêÜÔºåÂΩìËøô‰∏ÄÊ≠•‰πüÂ§ÑÁêÜÂÆåÊàê‰πãÂêéÔºåÂ∞±‰ºöÊûÑÂª∫‰∏Ä‰∏™ICMPÂ∫îÁ≠îÊï∞ÊçÆÂåÖÔºåÂõûÂèëÁªô‰∏ªÊú∫A Âú®‰∏ÄÂÆöÁöÑÊó∂Èó¥ÂÜÖÔºåÂ¶ÇÊûú‰∏ªÊú∫AÊî∂Âà∞‰∫ÜÂ∫îÁ≠îÂåÖÔºåÂàôËØ¥ÊòéÂÆÉ‰∏é‰∏ªÊú∫B‰πãÈó¥ÁΩëÁªúÂèØËææÔºåÂ¶ÇÊûúÊ≤°ÊúâÊî∂Âà∞ÔºåÂàôËØ¥ÊòéÁΩëÁªú‰∏çÂèØËææ„ÄÇÈô§‰∫ÜÁõëÊµãÊòØÂê¶ÂèØËææ‰ª•Â§ñÔºåËøòÂèØ‰ª•Âà©Áî®Â∫îÁ≠îÊó∂Èó¥ÂíåÂèëËµ∑Êó∂Èó¥‰πãÈó¥ÁöÑÂ∑ÆÂÄºÔºåËÆ°ÁÆóÂá∫Êï∞ÊçÆÂåÖÁöÑÂª∂ËøüËÄóÊó∂„ÄÇ ÈÄöËøápingÁöÑÊµÅÁ®ãÂèØ‰ª•ÂèëÁé∞ÔºåICMPÂçèËÆÆÊòØËøô‰∏™ËøáÁ®ãÁöÑÂü∫Á°ÄÔºåÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑÔºåÂõ†Ê≠§‰∏ãÈù¢Â∞±ÊääICMPÂçèËÆÆÂÜçËØ¶ÁªÜËß£Èáä‰∏Ä‰∏ã„ÄÇ ICMPÁÆÄ‰ªãÊàë‰ª¨Áü•ÈÅìÔºåpingÂëΩ‰ª§ÊòØÂü∫‰∫éICMPÂçèËÆÆÊù•ÂÆûÁé∞ÁöÑ„ÄÇÈÇ£‰πàÊàë‰ª¨ÂÜçÊù•Áúã‰∏ãÂõæÔºåÂ∞±ÊòéÁôΩ‰∫ÜICMPÂçèËÆÆÂèàÊòØÈÄöËøáIPÂçèËÆÆÊù•ÂèëÈÄÅÁöÑÔºåÂç≥ICMPÊä•ÊñáÊòØÂ∞ÅË£ÖÂú®IPÂåÖ‰∏≠„ÄÇ IPÂçèËÆÆÊòØ‰∏ÄÁßçÊó†ËøûÊé•ÁöÑÔºå‰∏çÂèØÈù†ÁöÑÊï∞ÊçÆÂåÖÂçèËÆÆÔºåÂÆÉÂπ∂‰∏çËÉΩ‰øùËØÅÊï∞ÊçÆ‰∏ÄÂÆöË¢´ÈÄÅËææÔºåÈÇ£‰πàÊàë‰ª¨Ë¶Å‰øùËØÅÊï∞ÊçÆÈÄÅÂà∞Â∞±ÈúÄË¶ÅÈÄöËøáÂÖ∂ÂÆÉÊ®°ÂùóÊù•ÂçèÂä©ÂÆûÁé∞ÔºåËøôÈáåÂ∞±ÂºïÂÖ•ÁöÑÊòØICMPÂçèËÆÆ„ÄÇ ÂΩì‰º†ÈÄÅÁöÑIPÊï∞ÊçÆÂåÖÂèëÈÄÅÂºÇÂ∏∏ÁöÑÊó∂ÂÄôÔºåICMPÂ∞±‰ºöÂ∞ÜÂºÇÂ∏∏‰ø°ÊÅØÂ∞ÅË£ÖÂú®ÂåÖÂÜÖÔºåÁÑ∂ÂêéÂõû‰º†ÁªôÊ∫ê‰∏ªÊú∫„ÄÇ Â∞Ü‰∏äÂõæÂÜçÁªÜÊãÜ‰∏Ä‰∏ãÂèØËßÅÔºö Â∞ÜICMPÈÉ®ÂàÜÊãÜÂºÄÁªßÁª≠ÂàÜÊûêÔºö Áî±ÂõæÂèØÁü•ÔºåICMPÊï∞ÊçÆÂåÖÁî±8bitÁöÑÁ±ªÂûãÂ≠óÊÆµÂíå8bitÁöÑ‰ª£Á†ÅÂ≠óÊÆµ‰ª•Âèä16bitÁöÑÊ†°È™åÂ≠óÊÆµÂÜçÂä†‰∏äÈÄâÈ°πÊï∞ÊçÆÁªÑÊàê„ÄÇ ICMPÂçèËÆÆÂ§ßËá¥ÂèØÂàÜ‰∏∫‰∏§Á±ªÔºö Êü•ËØ¢Êä•ÊñáÁ±ªÂûã Â∑ÆÈîôÊä•ÊñáÁ±ªÂûã Êü•ËØ¢Êä•ÊñáÁ±ªÂûãÔºö Êü•ËØ¢Êä•Êñá‰∏ªË¶ÅÂ∫îÁî®‰∫éÔºöpingÊü•ËØ¢„ÄÅÂ≠êÁΩëÊé©Á†ÅÊü•ËØ¢„ÄÅÊó∂Èó¥Êà≥Êü•ËØ¢Á≠âÁ≠â„ÄÇ ‰∏äÈù¢ËÆ≤Âà∞ÁöÑpingÂëΩ‰ª§ÁöÑÊµÅÁ®ãÂÖ∂ÂÆûÂ∞±ÂØπÂ∫îICMPÂçèËÆÆÊü•ËØ¢Êä•ÊñáÁ±ªÂûãÁöÑ‰∏ÄÁßç‰ΩøÁî®„ÄÇÂú®‰∏ªÊú∫AÊûÑÂª∫ICMPËØ∑Ê±ÇÊï∞ÊçÆÂåÖÁöÑÊó∂ÂÄôÔºåÂÖ∂ICMPÁöÑÁ±ªÂûãÂ≠óÊÆµ‰∏≠‰ΩøÁî®ÁöÑÊòØ 8 ÔºàÂõûÈÄÅËØ∑Ê±ÇÔºâÔºåÂΩì‰∏ªÊú∫BÊûÑÂª∫ICMPÂ∫îÁ≠îÂåÖÁöÑÊó∂ÂÄôÔºåÂÖ∂ICMPÁ±ªÂûãÂ≠óÊÆµÂ∞±‰ΩøÁî®ÁöÑÊòØ 0 ÔºàÂõûÈÄÅÂ∫îÁ≠îÔºâÔºåÊõ¥Â§öÁ±ªÂûãÂÄºÂèÇËÄÉ‰∏äË°®„ÄÇ ÂØπ Êü•ËØ¢Êä•ÊñáÁ±ªÂûã ÁöÑÁêÜËß£ÂèØÂèÇËÄÉ‰∏Ä‰∏ãÊñáÁ´†ÊúÄÂºÄÂßãËÆ≤ÁöÑpingÊµÅÁ®ãÔºåËøôÈáåÂ∞±‰∏çÂÅöËµòËø∞„ÄÇ Â∑ÆÈîôÊä•ÊñáÁ±ªÂûãÔºö Â∑ÆÈîôÊä•Êñá‰∏ªË¶Å‰∫ßÁîü‰∫éÂΩìÊï∞ÊçÆ‰º†ÈÄÅÂèëÈÄÅÈîôËØØÁöÑÊó∂ÂÄô„ÄÇ ÂÆÉÂåÖÊã¨ÔºöÁõÆÊ†á‰∏çÂèØËææÔºàÁΩëÁªú‰∏çÂèØËææ„ÄÅ‰∏ªÊú∫‰∏çÂèØËææ„ÄÅÂçèËÆÆ‰∏çÂèØËææ„ÄÅÁ´ØÂè£‰∏çÂèØËææ„ÄÅÁ¶ÅÊ≠¢ÂàÜÁâáÁ≠âÔºâ„ÄÅË∂ÖÊó∂„ÄÅÂèÇÊï∞ÈóÆÈ¢ò„ÄÅÈáçÂÆöÂêëÔºàÁΩëÁªúÈáçÂÆöÂêë„ÄÅ‰∏ªÊú∫ÈáçÂÆöÂêëÁ≠âÔºâÁ≠âÁ≠â„ÄÇ Â∑ÆÈîôÊä•ÊñáÈÄöÂ∏∏ÂåÖÂê´‰∫ÜÂºïËµ∑ÈîôËØØÁöÑIPÊï∞ÊçÆÂåÖÁöÑÁ¨¨‰∏Ä‰∏™ÂàÜÁâáÁöÑIPÈ¶ñÈÉ®ÔºåÂä†‰∏äËØ•ÂàÜÁâáÊï∞ÊçÆÈÉ®ÂàÜÁöÑÂâç8‰∏™Â≠óËäÇ„ÄÇ ÂΩì‰º†ÈÄÅIPÊï∞ÊçÆÂåÖÂèëÁîüÈîôËØØÁöÑÊó∂ÂÄôÔºà‰æãÂ¶Ç ‰∏ªÊú∫‰∏çÂèØËææÔºâÔºåICMPÂçèËÆÆÂ∞±‰ºöÊääÈîôËØØ‰ø°ÊÅØÂ∞ÅÂåÖÔºåÁÑ∂Âêé‰º†ÈÄÅÂõûÊ∫ê‰∏ªÊú∫ÔºåÈÇ£‰πàÊ∫ê‰∏ªÊú∫Â∞±Áü•ÈÅìËØ•ÊÄé‰πàÂ§ÑÁêÜ‰∫Ü„ÄÇ ÈÇ£ÊòØ‰∏çÊòØÂè™ÊúâÈÅáÂà∞ÈîôËØØÁöÑÊó∂ÂÄôÊâçËÉΩ‰ΩøÁî® Â∑ÆÈîôÊä•ÊñáÁ±ªÂûã Âë¢Ôºü‰πü‰∏ç‰∏ÄÂÆö„ÄÇ Traceroute Â∞±ÊòØ‰∏Ä‰∏™‰æãÂ§ñÔºåTracerouteÊòØÁî®Êù•‰æ¶ÊµãÊ∫ê‰∏ªÊú∫Âà∞ÁõÆÊ†á‰∏ªÊú∫‰πãÈó¥ÊâÄÁªèËøáË∑ØÁî±ÊÉÖÂÜµÁöÑÂ∏∏Áî®Â∑•ÂÖ∑„ÄÇTraceroute ÁöÑÂéüÁêÜÂ∞±ÊòØÂà©Áî®ICMPÁöÑËßÑÂàôÔºåÂà∂ÈÄ†‰∏Ä‰∫õÈîôËØØÁöÑ‰∫ã‰ª∂Âá∫Êù•ÔºåÁÑ∂ÂêéÊ†πÊçÆÈîôËØØÁöÑ‰∫ã‰ª∂Êù•ËØÑ‰º∞ÁΩëÁªúË∑ØÁî±ÊÉÖÂÜµ„ÄÇ ÂÖ∑‰ΩìÂÅöÊ≥ïÂ∞±ÊòØÔºö Traceroute‰ºöËÆæÁΩÆÁâπÊÆäÁöÑTTLÂÄºÔºåÊù•ËøΩË∏™Ê∫ê‰∏ªÊú∫ÂíåÁõÆÊ†á‰∏ªÊú∫‰πãÈó¥ÁöÑË∑ØÁî±Êï∞„ÄÇÈ¶ñÂÖàÂÆÉÁªôÁõÆÊ†á‰∏ªÊú∫ÂèëÈÄÅ‰∏Ä‰∏™ TTL=1 ÁöÑUDPÊï∞ÊçÆÂåÖÔºåÈÇ£‰πàËøô‰∏™Êï∞ÊçÆÂåÖ‰∏ÄÊó¶Âú®Ë∑Ø‰∏äÈÅáÂà∞‰∏Ä‰∏™Ë∑ØÁî±Âô®ÔºåTTLÂ∞±ÂèòÊàê‰∫Ü0ÔºàTTLËßÑÂàôÊòØÊØèÁªèËøá‰∏Ä‰∏™Ë∑ØÁî±Âô®ÈÉΩ‰ºöÂáè1ÔºâÔºåÂõ†‰∏∫TTL=0‰∫ÜÔºåÊâÄ‰ª•Ë∑ØÁî±Âô®Â∞±‰ºöÊääËøô‰∏™Êï∞ÊçÆÂåÖ‰∏¢ÊéâÔºåÁÑ∂Âêé‰∫ßÁîü‰∏Ä‰∏™ÈîôËØØÁ±ªÂûãÔºàË∂ÖÊó∂ÔºâÁöÑICMPÊï∞ÊçÆÂåÖÂõûÂèëÁªôÊ∫ê‰∏ªÊú∫Ôºå‰πüÂ∞±ÊòØÂ∑ÆÈîôÂåÖ„ÄÇËøô‰∏™Êó∂ÂÄôÊ∫ê‰∏ªÊú∫Â∞±ÊãøÂà∞‰∫ÜÁ¨¨‰∏Ä‰∏™Ë∑ØÁî±ËäÇÁÇπÁöÑIPÂíåÁõ∏ÂÖ≥‰ø°ÊÅØ‰∫Ü„ÄÇ Êé•ÁùÄÔºåÊ∫ê‰∏ªÊú∫ÂÜçÁªôÁõÆÊ†á‰∏ªÊú∫Âèë‰∏Ä‰∏™ TTL=2 ÁöÑUDPÊï∞ÊçÆÂåÖÔºå‰æùÊóß‰∏äËø∞ÊµÅÁ®ãËµ∞‰∏ÄÈÅçÔºåÂ∞±Áü•ÈÅìÁ¨¨‰∫å‰∏™Ë∑ØÁî±ËäÇÁÇπÁöÑIPÂíåËÄóÊó∂ÊÉÖÂÜµÁ≠â‰ø°ÊÅØ‰∫Ü„ÄÇ Â¶ÇÊ≠§ÂèçÂ§çËøõË°åÔºåTracerouteÂ∞±ÂèØ‰ª•ÊãøÂà∞‰ªé‰∏ªÊú∫AÂà∞‰∏ªÊú∫B‰πãÈó¥ÊâÄÊúâË∑ØÁî±Âô®ÁöÑ‰ø°ÊÅØ‰∫Ü„ÄÇ ‰ΩÜÊòØÊúâ‰∏™ÈóÆÈ¢òÊòØÔºåÂ¶ÇÊûúÊï∞ÊçÆÂåÖÂà∞Ëææ‰∫ÜÁõÆÊ†á‰∏ªÊú∫ÁöÑËØùÔºåÂç≥‰ΩøÁõÆÊ†á‰∏ªÊú∫Êé•Êî∂Âà∞TTLÂÄº‰∏∫1ÁöÑIPÊï∞ÊçÆÂåÖÔºåÂÆÉ‰πüÊòØ‰∏ç‰ºö‰∏¢ÂºÉËØ•Êï∞ÊçÆÂåÖÁöÑÔºå‰πü‰∏ç‰ºö‰∫ßÁîü‰∏Ä‰ªΩË∂ÖÊó∂ÁöÑICMPÂõûÂèëÊï∞ÊçÆÂåÖÁöÑÔºåÂõ†‰∏∫Êï∞ÊçÆÂåÖÂ∑≤ÁªèËææÂà∞‰∫ÜÁõÆÁöÑÂú∞Âòõ„ÄÇÈÇ£Êàë‰ª¨Â∫îËØ•ÊÄé‰πàËÆ§ÂÆöÊï∞ÊçÆÂåÖÊòØÂê¶ËææÂà∞‰∫ÜÁõÆÊ†á‰∏ªÊú∫Âë¢Ôºü TracerouteÁöÑÊñπÊ≥ïÊòØÂú®Ê∫ê‰∏ªÊú∫ÂèëÈÄÅUDPÊï∞ÊçÆÂåÖÁªôÁõÆÊ†á‰∏ªÊú∫ÁöÑÊó∂ÂÄôÔºå‰ºöËÆæÁΩÆ‰∏Ä‰∏™‰∏çÂèØËÉΩËææÂà∞ÁöÑÁõÆÊ†áÁ´ØÂè£Âè∑Ôºà‰æãÂ¶ÇÂ§ß‰∫é30000ÁöÑÁ´ØÂè£Âè∑ÔºâÔºåÈÇ£‰πàÂΩìËøô‰∏™Êï∞ÊçÆÂåÖÁúüÁöÑÂà∞ËææÁõÆÊ†á‰∏ªÊú∫ÁöÑÊó∂ÂÄôÔºåÁõÆÊ†á‰∏ªÊú∫ÂèëÁé∞Ê≤°ÊúâÂØπÂ∫îÁöÑÁ´ØÂè£Âè∑ÔºåÂõ†Ê≠§‰ºö‰∫ßÁîü‰∏Ä‰ªΩ‚ÄúÁ´ØÂè£‰∏çÂèØËææ‚ÄùÁöÑÈîôËØØICMPÊä•ÊñáËøîÂõûÁªôÊ∫ê‰∏ªÊú∫„ÄÇ tracerootÁöÑÂÖ∑‰Ωì‰ΩøÁî®ÊñπÊ≥ïÁΩë‰∏äÈÉΩÊúâÂæàÂ§öËÆ≤Ëß£ÔºåÂèØ‰ª•ÂÆûÈôÖÊìç‰Ωú‰∏Ä‰∏ã„ÄÇ]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>ÁΩëÁªú</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CentOS7-ÂÆâË£Ödocker-composeÊó∂Áî±‰∫épip10ÂåÖÁÆ°ÁêÜÂØºËá¥ÁöÑÈîôËØØ]]></title>
    <url>%2F2018%2F09%2F13%2FCentOS7-%E5%AE%89%E8%A3%85docker-compose%E6%97%B6%E7%94%B1%E4%BA%8Epip10%E5%8C%85%E7%AE%A1%E7%90%86%E5%AF%BC%E8%87%B4%E7%9A%84%E9%94%99%E8%AF%AF%2F</url>
    <content type="text"><![CDATA[‰ªäÂ§©Âú®CentOS‰∏ãÂÆâË£Ödocker-composeÔºåÈÅáÂà∞‰∫ÜCannot uninstall ‚Äòrequests‚Äô. It is a distutils installed project and thus we cannot accurately determine which files belong to it which would lead to only a partial uninstall.ÈîôËØØÁöÑÂéüÂõ†ÊòØrequestsÈªòËÆ§ÁâàÊú¨‰∏∫2.6.0Ôºå‰ΩÜÊòØdocker-composeË¶Å2.9‰ª•‰∏äÊâçÊîØÊåÅÔºå‰ΩÜÊòØÊó†Ê≥ïÊ≠£Â∏∏Âç∏ËΩΩ2.9ÁâàÊú¨ÔºåÊòØpip10ÂØπÂåÖÁöÑÁÆ°ÁêÜÂ≠òÂú®ÂèòÂåñ„ÄÇ Ëß£ÂÜ≥ÊñπÊ°àÔºö pip install -l requests==2.9]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊäÄÊúØÂë®Âàä‰πãËß£ÊûêPython‰∏≠ÁöÑËµãÂÄº„ÄÅÊµÖÊã∑Ë¥ù„ÄÅÊ∑±Êã∑Ë¥ù]]></title>
    <url>%2F2018%2F09%2F09%2F%E6%8A%80%E6%9C%AF%E5%91%A8%E5%88%8A%E4%B9%8B%E8%A7%A3%E6%9E%90Python%E4%B8%AD%E7%9A%84%E8%B5%8B%E5%80%BC%E3%80%81%E6%B5%85%E6%8B%B7%E8%B4%9D%E3%80%81%E6%B7%B1%E6%8B%B7%E8%B4%9D%2F</url>
    <content type="text"><![CDATA[‰∫ãÊÉÖÁöÑËµ∑Âõ† Êú¨Âë®Êàë‰ª¨ÂàÜ‰∫´ÁöÑ‰∏ªÈ¢òÊòØPython‰∏≠ÂÖ≥‰∫éÊµÖÊã∑Ë¥ùÂíåÊ∑±Êã∑Ë¥ùÁöÑÁâπÊÄßÔºåÊÉ≥Ë¶ÅÊ∑±ÂÖ•Á†îÁ©∂Python‰∏≠ÁöÑÊµÖÊã∑Ë¥ùÂíåÊ∑±Êã∑Ë¥ùÁöÑËµ∑Âõ†Âú®‰∫éÔºåÊàëÊÉ≥ÁîüÊàê‰∏Ä‰∏™jsonÂ≠óÁ¨¶‰∏≤ÔºåËØ•Â≠óÁ¨¶‰∏≤Êú™dumps‰πãÂâçÊòØ‰∏Ä‰∏™PythonÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÈáåÈù¢ÂåÖÂê´Â≠óÂÖ∏Ôºå‰ª•ÂèäListÔºåÂú®ÈÅçÂéÜÁîüÊàêdictionaryÊó∂ÂÄôÔºåÂá∫Áé∞‰∏Ä‰∏™bugÔºåÂ∞±ÊòØÊØèÊ¨°ÈÅçÂéÜÁîüÊàêÁöÑdictionaryÈÉΩÊòØ‰∏ä‰∏ÄÊ¨°ÁöÑÂÄºÔºåÁé∞Ë±°ÂèØ‰ª•Áúã‰ª•‰∏ã‰ª£Á†Å„ÄÇ 123456789101112131415161718# ËøôÈáåÊàë‰ª¨ÂÆö‰πâ‰∏Ä‰∏™ÂáΩÊï∞get_data()def get_data(): ...: appid_dict = &#123;&#125; ...: appid_all_dict = &#123;&#125; ...: import pdb;pdb.set_trace() ...: for i in range(10): ...: appid_dict['a'] = i ...: appid_all_dict[i] = appid_dict# Êàë‰ª¨ÁöÑÂàùË°∑ÊòØÊÉ≥Ë¶ÅÂæóÂà∞# &#123;0: &#123;'a': 0&#125;, 1: &#123;'a': 1&#125;, 2: &#123;'a': 2&#125;, 3: &#123;'a': 3&#125;&#125;....ËøôÊ†∑ÁöÑ‰∏Ä‰∏™dict# ‰ΩÜÊòØÂú®Ë∞ÉËØïËøáÁ®ã‰∏≠ÔºåÂèëÁé∞ÂæóÂà∞ÁöÑÁªìÊûúÊòØËøôÊ†∑ÁöÑÔºö# (Pdb) appid_all_dict# &#123;0: &#123;'a': 2&#125;, 1: &#123;'a': 2&#125;, 2: &#123;'a': 2&#125;&#125;# (Pdb) # Âç≥ÔºåÂêéÈù¢ÁöÑappid_dictÈÉΩ‰ºöÊääÂâçÈù¢ÁöÑË¶ÜÁõñÊéâÔºåËøôÊòØ‰ªÄ‰πàÂéüÂõ†Âë¢Ôºü# Êàë‰ª¨ËøôÈáåÂÖàÊääÂéüÂõ†ËØ¥‰∏Ä‰∏ãÔºöÂõ†‰∏∫Python‰∏≠ÂØπdictÁöÑÊìç‰ΩúÈªòËÆ§ÊòØÊµÖÊã∑Ë¥ùÔºåÂç≥ÂêåÊ†∑ÁöÑÂ≠óÂÖ∏Ôºå‰ΩøÁî®Â§öÊ¨°ÁöÑËØùÔºåÊØèÊ¨°‰ΩøÁî®ÈÉΩÊòØÊåáÂêëÂêå‰∏ÄÁâáÂÜÖÂ≠òÂú∞ÂùÄ(ÂºïÁî®)ÔºåÊâÄ‰ª•Âú®‰∏äÈù¢ÁöÑÁ®ãÂ∫è‰∏≠ÂêéÈù¢ÂØπappid_dictÁöÑËµãÂÄºÔºåÈÉΩÂ∞ÜÂâçÈù¢ÁöÑÁªôË¶ÜÁõñÊéâ‰∫ÜÔºåÂØºËá¥ÊØè‰∏Ä‰∏™appid_dictÊåáÂêëÂêå‰∏ÄÁâáÂÜÖÂ≠òÔºåËØªÂèñÁöÑÂΩìÁÑ∂Â∞±ÊòØÊúÄÂêé‰∏ÄÊ¨°ÁöÑappid_dictÁöÑÂÄºÔºåÂç≥‰∏äÈù¢Á®ãÂ∫èÁöÑÊâßË°åÁªìÊûúÔºö&#123;0: &#123;'a': 9&#125;, 1: &#123;'a': 9&#125;, 2: &#123;'a': 9&#125;, 3: &#123;'a': 9&#125;, 4: &#123;'a': 9&#125;, 5: &#123;'a': 9&#125;, 6: &#123;'a': 9&#125;, 7: &#123;'a': 9&#125;, 8: &#123;'a': 9&#125;, 9: &#123;'a': 9&#125;&#125; ÈÇ£‰πàÂ¶Ç‰Ωï‰øÆÊîπËøô‰∏™bugÔºåËÆ©Á®ãÂ∫èËæìÂá∫Êàë‰ª¨ÊÉ≥Ë¶ÅÂæóÂà∞ÁöÑÁªìÊûúÔºö 1&#123;0: &#123;'a': 0&#125;, 1: &#123;'a': 1&#125;, 2: &#123;'a': 2&#125;, 3: &#123;'a': 3&#125;, 4: &#123;'a': 4&#125;, 5: &#123;'a': 5&#125;, 6: &#123;'a': 6&#125;, 7: &#123;'a': 7&#125;, 8: &#123;'a': 8&#125;, 9: &#123;'a': 9&#125;&#125; ÁúãÂÆå‰∏ãÈù¢ÂØπ‰∫éPythonËµãÂÄº„ÄÅÊµÖÊã∑Ë¥ù„ÄÅÊ∑±Êã∑Ë¥ùÁöÑËß£ÊûêÔºåÁõ∏‰ø°‰Ω†Â∞±ÂèØ‰ª•Ëá™Â∑±Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò‰∫Ü Python‰∏≠ÁöÑËµãÂÄºÊìç‰Ωú ËµãÂÄºÔºöÂ∞±ÊòØÂØπË±°ÁöÑÂºïÁî® ‰∏æ‰æãÔºö a = b: ËµãÂÄºÂºïÁî®ÔºåaÂíåbÈÉΩÊåáÂêëÂêå‰∏Ä‰∏™ÂØπË±°ÔºåÂ¶ÇÂõæÊâÄÁ§∫ Python‰∏≠ÊµÖÊã∑Ë¥ù a = b.copy(): a ÊòØbÁöÑÊµÖÊã∑Ë¥ùÔºåaÂíåbÊòØ‰∏Ä‰∏™Áã¨Á´ãÁöÑÂØπË±°Ôºå‰ΩÜÊòØÂÆÉ‰ª¨ÁöÑÂ≠êÂØπË±°ËøòÊòØÊåáÂêëÂêå‰∏ÄÁâáÂºïÁî®„ÄÇ Python‰∏≠ÂØπÂ≠óÂÖ∏ÁöÑÈªòËÆ§ËµãÂÄºÊìç‰ΩúÂ∞±ÊòØÊµÖÊã∑Ë¥ùÔºåÊâÄ‰ª•ÂØºËá¥‰∫ÜÊñáÁ´†ÂºÄÂ§¥ÊâÄÂá∫Áé∞ÁöÑÊÉÖÂÜµ„ÄÇ Python‰∏≠ÁöÑÊ∑±Êã∑Ë¥ù È¶ñÂÖàimport copy,ÂØºÂÖ•copyÊ®°ÂùóÔºàPython‰∏≠Ëá™Â∏¶ÔºâÔºåb = copy.deepcopy(a), Êàë‰ª¨Â∞±ËØ¥bÊòØaÁöÑÊ∑±Êã∑Ë¥ùÔºåbÊã∑Ë¥ù‰∫ÜaÊâÄÊúâÁöÑËµÑÊ∫êÂØπË±°ÔºåÂπ∂Êñ∞ÂºÄËæü‰∫Ü‰∏ÄÂùóÂú∞ÂùÄÁ©∫Èó¥Ôºå‰∏§ËÄÖ‰∫í‰∏çÂπ≤Ê∂â„ÄÇ ÂÆûÈôÖÁöÑ‰æãÂ≠êÊù•Ëøõ‰∏ÄÊ≠•ËØ¥Êòé12345678910111213141516171819202122In [13]: import copyIn [14]: def temp(): ...: a = [1, 2, 3, 4, ['a', 'b']] ...: b = a # ËµãÂÄºÊìç‰ΩúÔºåÁõ¥Êé•‰º†ÊâÄÊúâÂØπË±°ÁöÑÂºïÁî® ...: c = copy.copy(a) # ÊµÖÊã∑Ë¥ùÔºåÂ≠êÂØπË±°ÊåáÂêëÂêå‰∏ÄÂºïÁî® ...: d = copy.deepcopy(a) # Ê∑±Êã∑Ë¥ùÔºå‰∫í‰∏çÂπ≤Ê∂â ...: a.append(5) # ‰øÆÊîπÂØπË±°a ...: a[4].append('c') # ‰øÆÊîπa‰∏≠ÁöÑÊï∞ÁªÑ ...: print( 'a = ', a ) ...: print( 'b = ', b ) ...: print( 'c = ', c ) ...: print( 'd = ', d ) ...: In [15]: In [15]: temp()a = [1, 2, 3, 4, ['a', 'b', 'c'], 5]b = [1, 2, 3, 4, ['a', 'b', 'c'], 5]c = [1, 2, 3, 4, ['a', 'b', 'c']]d = [1, 2, 3, 4, ['a', 'b']] Ëß£ÂÜ≥ÊúÄÂàùÁöÑÈóÆÈ¢ò ÁúãÂà∞ËøôÈáåÔºåÊàë‰ª¨ÂÜçÂõûÂ§¥ÁúãÊñáÁ´†ÊúÄÂàùÁöÑÈÇ£‰∏™ÈóÆÈ¢òÔºåÂ∞±ÂèØ‰ª•ÂæàeasyÂú∞Ëß£ÂÜ≥‰∫Ü„ÄÇ 12345678def get_data(): ...: appid_dict = &#123;&#125; ...: appid_all_dict = &#123;&#125; ...: import pdb;pdb.set_trace() ...: for i in range(10): appid_dict = copy.deepcopy(appid_dict)# Âè™ÈúÄË¶ÅÂä†‰∏äËøô‰∏ÄË°åÔºå‰ΩøÂÖ∂Êàê‰∏∫Ê∑±Êã∑Ë¥ùÔºåÈóÆÈ¢òËß£ÂÜ≥ÔºÅ ...: appid_dict['a'] = i ...: appid_all_dict[i] = appid_dict ÊÄªÁªìË¶ÅÂØπPythonÁöÑdictionaryËøõË°åËø≠‰ª£ÂàÜÊûêÔºå‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèÂÖ∂‰∏≠ÁöÑÊ∑±Êã∑Ë¥ùÈóÆÈ¢òÔºåÂá∫Áé∞ÈóÆÈ¢òÂêéÔºå‰πüË¶ÅÂ§öÂæÄËøôÊñπÈù¢ËÄÉËôë„ÄÇ Êú¨ÊúüÊäÄÊúØÂë®ÂàäÂà∞Ê≠§ÁªìÊùü„ÄÇ]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>ÊäÄÊúØÂë®Âàä</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golang ÁºñËØëÈíàÂØπ‰∏çÂêåÂπ≥Âè∞ÁöÑÂèØÊâßË°åÁ®ãÂ∫è]]></title>
    <url>%2F2018%2F09%2F07%2Fgolang-%E7%BC%96%E8%AF%91%E9%92%88%E5%AF%B9%E4%B8%8D%E5%90%8C%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F%2F</url>
    <content type="text"><![CDATA[1234567891011121314151617181920212223242526272829303132333435363738Golang ÊîØÊåÅÂú®‰∏Ä‰∏™Âπ≥Âè∞‰∏ãÁîüÊàêÂè¶‰∏Ä‰∏™Âπ≥Âè∞ÂèØÊâßË°åÁ®ãÂ∫èÁöÑ‰∫§ÂèâÁºñËØëÂäüËÉΩ„ÄÇMac‰∏ãÁºñËØëLinux, WindowsÂπ≥Âè∞ÁöÑ64‰ΩçÂèØÊâßË°åÁ®ãÂ∫èÔºöCGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build test.goCGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build test.goLinux‰∏ãÁºñËØëMac, WindowsÂπ≥Âè∞ÁöÑ64‰ΩçÂèØÊâßË°åÁ®ãÂ∫èÔºöCGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build test.goCGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build test.goWindows‰∏ãÁºñËØëMac, LinuxÂπ≥Âè∞ÁöÑ64‰ΩçÂèØÊâßË°åÁ®ãÂ∫èÔºöSET CGO_ENABLED=0SET GOOS=darwin3SET GOARCH=amd64go build test.goSET CGO_ENABLED=0SET GOOS=linuxSET GOARCH=amd64go build test.go GOOSÔºöÁõÆÊ†áÂèØÊâßË°åÁ®ãÂ∫èËøêË°åÊìç‰ΩúÁ≥ªÁªüÔºåÊîØÊåÅ darwinÔºåfreebsdÔºålinuxÔºåwindowsGOARCHÔºöÁõÆÊ†áÂèØÊâßË°åÁ®ãÂ∫èÊìç‰ΩúÁ≥ªÁªüÊûÑÊû∂ÔºåÂåÖÊã¨ 386Ôºåamd64ÔºåarmGolang version 1.5‰ª•ÂâçÁâàÊú¨Âú®È¶ñÊ¨°‰∫§ÂèâÁºñËØëÊó∂ËøòÈúÄË¶ÅÈÖçÁΩÆ‰∫§ÂèâÁºñËØëÁéØÂ¢ÉÔºöCGO_ENABLED=0 GOOS=linux GOARCH=amd64 ./make.bashCGO_ENABLED=0 GOOS=windows GOARCH=amd64 ./make.bash]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â∏∏Áî®ÁöÑPythonÂ∞èÊ®°Âùó]]></title>
    <url>%2F2018%2F09%2F06%2F%E5%B8%B8%E7%94%A8%E7%9A%84Python%E5%B0%8F%E6%A8%A1%E5%9D%97%2F</url>
    <content type="text"><![CDATA[Â∑•‰ΩúÊàñËÄÖÁîüÊ¥ª‰∏≠ÊÄª‰ºöÈÅáÂà∞‰∏Ä‰∫õÂ∏∏Áî®ÁöÑPythonÊ®°ÂùóÔºå‰∏∫‰∫ÜÈÅøÂÖçÈáçÂ§çÁöÑÂ∑•‰ΩúÔºåÂ∞ÜËøô‰∫õËá™Â∑±ÂÜôËøáÁöÑPythonÊ®°ÂùóËÆ∞ÂΩï‰∏ãÊù•ÔºåÊñπ‰æø‰ΩøÁî®ÁöÑÊó∂ÂÄôÊü•Êâæ„ÄÇ PythonÂÜôCSVÊñá‰ª∂ÔºåÂπ∂Èò≤Ê≠¢‰∏≠Êñá‰π±Á†Å12345678def write_csv(a_list,b_list): with open('vm_data.csv', 'w') as f: f.write(codecs.BOM_UTF8.decode()) writer1 = csv.writer(f, dialect='excel') #ÂÜôCVSÁöÑÊ†áÈ¢ò writer1.writerow(['a', 'b']) #Â∞ÜÊï∞ÊçÆÂÜôÂÖ•CSVÊñá‰ª∂ writer1.writerows(zip(a_list, b_list)) PythonÂ∞ÜÊï∞ÊçÆÁªìÊûÑËΩ¨‰∏∫json,Âπ∂‰ºòÂåñjsonÂ≠óÁ¨¶‰∏≤ÁöÑÁªìÊûÑÔºåÂ§ÑÁêÜ‰∏≠Êñá‰π±Á†Å12345with open("appid.json", 'w', encoding='utf8', ) as f: f.write(json.dumps(final, sort_keys=True, indent=2, ensure_ascii=False))# sort_keys = True: Â∞ÜÂ≠óÂÖ∏ÁöÑkeyÊåâÁÖßÂ≠óÊØçÊéíÂ∫è# ident = 2: ‰ºòÂåñjsonÂ≠óÁ¨¶‰∏≤ÁªìÊûÑÔºåÁúãËµ∑Êù•Êõ¥ÁæéËßÇ# ensure_ascii=False: Èò≤Ê≠¢jsonÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑ‰∏≠Êñá‰π±Á†Å ‰ΩøÁî®requestsÂåÖËøõË°åÁΩëÁªúËØ∑Ê±ÇÔºà‰ª•post‰∏∫‰æãÔºâ1234567891011def get_data(url): final = &#123;&#125; url = &quot;http://xxxx.com&quot; request_body = &#123; &apos;access_token&apos;: access_token, &apos;request_body&apos;: &#123;&quot;params1&quot;: param1, &apos;params2&apos;: param2&#125; &#125; headers = &#123; &apos;Content-type&apos;: &apos;application/json&apos; &#125; data = requests.post(url, headers=headers, data=json.dumps(request_body))]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MysqlÊó†Ê≥ïËøûÊé•[MySql Host is blocked because of many connection errors]]]></title>
    <url>%2F2018%2F09%2F01%2FMysql%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%2F</url>
    <content type="text"><![CDATA[ÊµãËØïÁéØÂ¢ÉÔºåÂèëÁé∞Êï∞ÊçÆÂ∫ìÔºàMySQLÊï∞ÊçÆÂ∫ìÔºâÊó†Ê≥ïÁôªÂΩïÔºåÊä•ÈîôÂ¶Ç‰∏ãÔºö Host is blocked because of many connection errors; unblock with ‚Äòmysqladmin flush-hosts‚Äô Ëß£ÂÜ≥ÊñπÊ°àÔºö‰ΩøÁî®mysqladmin flush-hosts ÂëΩ‰ª§Ê∏ÖÁêÜ‰∏Ä‰∏ãhostsÊñá‰ª∂Ôºà‰∏çÁü•ÈÅìmysqladminÂú®Âì™‰∏™ÁõÆÂΩï‰∏ãÂèØ‰ª•‰ΩøÁî®ÂëΩ‰ª§Êü•ÊâæÔºöwhereis mysqladminÔºâÔºõ ÁôªÂΩïÂà∞MySQLÊï∞ÊçÆÂ∫ì‰∏≠Ôºåmysql -uroot -h host -p ÊâßË°å 1mysqladmin flush-hosts ÈóÆÈ¢òËß£ÂÜ≥„ÄÇ]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysql ÂºÄÂêØËøúÁ®ãËøûÊé•]]></title>
    <url>%2F2018%2F08%2F29%2Fmysql-%E5%BC%80%E5%90%AF%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5%2F</url>
    <content type="text"><![CDATA[ËÉåÊôØÔºö Âª∫Á´ôÁöÑÊó∂ÂÄô‰ºöÂá∫Áé∞Êï∞ÊçÆÂ∫ìÂíåÁΩëÁ´ôÊòØ‰∏çÂêåÁöÑipÔºåÂ∞±ÈúÄË¶ÅÂºÄÂêØMySQLÁöÑËøúÁ®ãËøûÊé•ÊúçÂä°Ôºå‰ΩÜÊòØMySQLÁî±‰∫éÂÆâÂÖ®ÂéüÂõ†ÔºåÈªòËÆ§ËÆæÁΩÆÊòØ‰∏çÂÖÅËÆ∏ËøúÁ®ãÂè™ËÉΩÊú¨Âú∞ËøûÊé•ÔºåË¶ÅÂºÄÂêØËøúÁ®ãËøûÊé•Â∞±ÈúÄË¶Å‰øÆÊîπÊüê‰∫õÈÖçÁΩÆÊñá‰ª∂„ÄÇ ÊåâÁÖß‰∏ãÈù¢ÁöÑÊ≠•È™§ÔºåÂºÄÂêØMySQLÁöÑËøúÁ®ãËøûÊé• ËøõÂÖ•Êï∞ÊçÆÂ∫ìcmd 12mysql -uroot -h host -pEnter password:*** ËøûÊé•Âà∞ÈªòËÆ§mysqlÊï∞ÊçÆÂ∫ì 123show databases;use mysql; ÈÖçÁΩÆ 1Grant all privileges on *.* to 'root'@'host' identified by 'password' with grant option; hostË°®Á§∫‰Ω†ËøúÁ®ãËøûÊé•Êï∞ÊçÆÂ∫ìËÆæÂ§áÁöÑipÂú∞ÂùÄÔºàÂ¶ÇÊûú‰Ω†ÊÉ≥ËÆ©ÊâÄÊúâÊú∫Âô®ÈÉΩËÉΩËøúÁ®ãËøûÊé•ÔºåhostÊîπ‰∏∫‚Äò%‚ÄôÔºå‰∏çÊé®ËçêËøôÊ†∑‰ΩøÁî®ÔºâÔºåpasswordË°®Á§∫MySQLÁöÑrootÁî®Êà∑ÂØÜÁ†Å Âà∑Êñ∞orÈáçÂêØMySQL 1mysql&gt; flush privileges; ÊúÄÂêéÈùûÂ∏∏ÈáçË¶ÅÁöÑ‰∏ÄÁÇπ 123vim /etc/vim /etc/mysql/my.cnfÂ±èËîΩbing-server 127.0.0.0#bing-server 127.0.0.0 ÂÆåÊàêÔºåÂèØ‰ª•ËøúÁ®ãËøûÊé•‰Ω†ÁöÑÊï∞ÊçÆÂ∫ì‰∫Ü]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golang factory design ÂºïÂèëÁöÑ‰∏ÄÁ≥ªÂàóÊÄùËÄÉ]]></title>
    <url>%2F2018%2F08%2F29%2Fgolang-factory-design-%E5%BC%95%E5%8F%91%E7%9A%84%E4%B8%80%E7%B3%BB%E5%88%97%E6%80%9D%E8%80%83%2F</url>
    <content type="text"><![CDATA[ÂÜôÂú®ÂâçÈù¢ÔºåÁ™ÅÁÑ∂ËêåÁîü‰∏Ä‰∏™ÂøµÂ§¥ÔºåÂÅö‰∏Ä‰∏™ÊäÄÊúØÂë®ÂàäÁ≥ªÂàóÔºåÂ∞ÜÊØèÂë®Â∑•‰ΩúÊàñËÄÖÁîüÊ¥ªÂΩì‰∏≠ÈÅáÂà∞ÁöÑÊØîËæÉÊúâË∂£ÁöÑÈóÆÈ¢òËÆ∞ÂΩï‰∏ãÊù•Ôºå‰∏ÄÊù•Êó∂ÊÄªÁªì‰∏Ä‰∏ãÔºå‰∫åÊù•ÊòØ‰∏∫‰∫Ü‰ª•ÂêéÈÄÄÂΩπ‰∫ÜÔºåÂèØ‰ª•ÂõûÈ°æËá™Â∑±ÁöÑÊäÄÊúØÁîüÊ∂Ø„ÄÇ Ê≤°Êúâ‰ªÄ‰πàÊÑèÂ§ñÁöÑËØùÔºåÊàë‰ºöÊØèÂë®ÂÖ≠ÊôöÊõ¥Êñ∞„ÄÇ ÊúÄËøëÂú®Êï¥Âêà‰∏âÂÆ∂ÂÖ¨Êúâ‰∫ëÔºàAWSÔºåali, ucloudÔºâÁöÑÊé•Âè£ÔºåËÄÉËôëÂà∞‰ª£Á†ÅÂ§çÁî®ÁöÑÈóÆÈ¢òÔºå‰∫éÊòØÂºÄÂßãËÄÉËôë‰ΩøÁî®‰∏ÄÁßçËÆæËÆ°Ê®°ÂºèÔºåËøôÁßçÂú∫ÊôØ‰∏ãÔºåÊúÄÂêàÈÄÇÁöÑ‰æøÊòØÂ∑•ÂéÇÊ®°ÂºèÔºåÂ∞Ü‰∏âÂÆ∂ÂéÇÂïÜÁöÑÂÖ¨ÊúâÊé•Âè£ÊîæÂÖ•Â∑•ÂéÇÊñπÊ≥ï‰∏≠ÔºåÁÑ∂ÂêéÂØπÊØè‰∏ÄÂÆ∂new‰∏Ä‰∏™ÂÆû‰æãÂç≥ÂèØÔºå‰ª•ÂêéÂÜçÊúâÊñ∞ÁöÑÂéÇÂïÜÂä†ÂÖ•ÔºåÊîπÂä®ÁöÑ‰ª£Á†Å‰πü‰∏ç‰ºöÂ§™Â§ö„ÄÇ‰ΩÜÊòØËÆæËÆ°Ê®°ÂºèËøôÁßç‰∏úË•øÂ§©ÁÑ∂ÈÄÇÂêà‰∫éjavaÔºåÂØπ‰∫égolangËøôÁßçÊØîËæÉÊñ∞ÁöÑËØ≠Ë®ÄÊù•ËØ¥ÔºåÂÆûÁé∞Ëµ∑Êù•Áõ∏ÂØπÊ≤°ÊúâÈÇ£‰πàÂÆπÊòìÔºåÂØπ‰∫éÂàöÊé•Ëß¶golangÁöÑÊàëÊù•ËØ¥ÔºåÂØπ‰∏Ä‰∫õgolangÁöÑÁâπÊÄß‰∏äÂπ∂‰∏çÊòØÂæàÁÜüÊÇâÔºåÊâÄ‰ª•Âú®Ê≠§ÊúüÈó¥ÈÅáÂà∞‰∏Ä‰∫õ‰∏çËß£ÁöÑÈóÆÈ¢òÔºåÂÜôÂá∫Êù•ÂàÜ‰∫´‰∏Ä‰∏ã„ÄÇ È¶ñÂÖàÔºå‰ªÄ‰πàÊòØÂ∑•ÂéÇÊ®°Âºè ÁÆÄÂçïÂ∑•ÂéÇÊ®°ÂºèÂ∞±ÊòØÈÄöËøá‰º†ÈÄí‰∏çÂêåÁöÑÂèÇÊï∞ÔºåÁîüÊàê‰∏çÂêåÁöÑÂÆû‰æãÔºåÂ∑•ÂéÇÊñπÊ≥ï‰∏∫ÊØè‰∏Ä‰∏™productÊèê‰æõ‰∏Ä‰∏™Â∑•Á®ãÁ±ªÔºåÈÄöËøá‰∏çÂêåÁöÑÂ∑•ÂéÇÂàõÂª∫‰∏çÂêåÁöÑÂÆû‰æã„ÄÇ ÂÖ∏ÂûãÂ∑•ÂéÇÊ®°ÂºèÁöÑÂÆûÁé∞ÊñπÂºèÔºàÂç≥ÂÖ∏ÂûãoopÂÆûÁé∞ÊñπÂºèÔºâ 12345678910111213141516171819202122class ProviderModel&#123; provider string func factory(providerName string, test string)&#123; if providerName == "AWS" &#123; return new AWS(test) &#125; if providerName == "Ali"&#123; return new Ali(test) &#125; &#125;&#125;class AWS extends ProviderModel &#123; func construct(test string)&#123; this.test = test &#125; func doRequest()&#123;&#125;&#125;awsmodel := ProviderModel::factory("AWS")awsmodel.doRequest()alimodel := ProviderModel ::factory("Ali") alimodel.doRequest() golangÂÆûÁé∞Â∑•ÂéÇÊ®°ÂºèÂ≠òÂú®ÁöÑÈóÆÈ¢ò golangÁöÑÁâπÊÄß‰∏≠Âπ∂Ê≤°ÊúâÂÉèjava‰∏ÄÊ†∑ÁöÑÁªßÊâøÂíåÈáçËΩΩÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÂà©Áî®golangÂ≠òÂú®ÁöÑÁâπÊÄßÔºåÈÄèËøáÂ∑•ÂéÇÊ®°ÂºèÁöÑË°®Èù¢ÈÄèÊûêÂÖ∂Êú¨Ë¥®„ÄÇ Êàë‰ª¨Áúã‰∏Ä‰∏ãÂ∑•ÂéÇÊ®°ÂºèÂ∞±Áü•ÈÅìÔºåÊâÄË∞ìÂ∑•ÂéÇÂÖ∂ÂÆûÂ∞±ÊòØÂÆö‰πâ‰∫Ü‰∏Ä‰∫õÈúÄË¶ÅÂéªÂÆûÁé∞ÁöÑÊñπÊ≥ïÔºågolangÁöÑinterfaceÊ≠£ÊòØÂèØ‰ª•ÂÅöÂà∞„ÄÇ‰∫éÊòØÂÖàÂà∞Google‰∏äÊêú‰∫Ü‰∏ÄÊÆµgolangÂÆûÁé∞ÁöÑÂ∑•ÂéÇÊ®°ÂºèÁöÑ‰ª£Á†Å„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647package mainimport ( "fmt")type Operater interface &#123; Operate(int, int) int&#125;type AddOperate struct &#123;&#125;func (this *AddOperate) Operate(rhs int, lhs int) int &#123; return rhs + lhs&#125;type MultipleOperate struct &#123;&#125;func (this *MultipleOperate) Operate(rhs int, lhs int) int &#123; return rhs * lhs&#125;type OperateFactory struct &#123;&#125;func NewOperateFactory() *OperateFactory &#123; return &amp;OperateFactory&#123;&#125;&#125;func (this *OperateFactory) CreateOperate(operatename string) Operater &#123; switch operatename &#123; case "+": return &amp;AddOperate&#123;&#125; case "*": return &amp;MultipleOperate&#123;&#125; default: panic("Êó†ÊïàËøêÁÆóÁ¨¶Âè∑") return nil &#125;&#125;func main() &#123; Operator := NewOperateFactory().CreateOperate("+") fmt.Printf("add result is %d\n", Operator.Operate(1, 2))&#125; ‰ª£Á†ÅÁúãËµ∑Êù•Ê≤°‰ªÄ‰πàÈóÆÈ¢òÔºåÂêéÊù•ÂèàÁúãÂà∞‰∏ÄÁßçÂÆûÁé∞ÊñπÂºèÔºåÊù•Ëá™ËøôÁØáÂçöÂÆ¢Ôºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728type site interface &#123; fetch()&#125;type siteModel struct &#123; URL string&#125;type site1 struct &#123; siteModel&#125;func (s site1) fetch() &#123; fmt.Println("site1 fetch data")&#125;func factory(s string) site &#123; if s == "site" &#123; return site1&#123; siteModel&#123;URL: "http://www.xxxx.com"&#125;, &#125; &#125; return nil&#125;func main() &#123; s := factory("site") s.fetch()&#125; ‰ª£Á†ÅÂàùÁúã‰∏äÂéªË∑üÁ¨¨‰∏Ä‰∏™ÂÆûÁé∞Ê≤°‰ªÄ‰πà‰∏ç‰∏ÄÊ†∑Ôºå‰ΩÜÊòØÂΩìÊàëËØ¶ÁªÜÈòÖËØª‰ª£Á†ÅÊó∂Ôºå‰∏ãÈù¢ÁöÑËøôÂè•‰ª£Á†ÅÁùÄÂÆûÊääÊàëÂºÑÊôï‰∫Ü 12345678func factory(s string) site &#123; if s == "site" &#123; return site1&#123; siteModel&#123;URL: "http://www.xxxx.com"&#125;, &#125; &#125; return nil&#125; factoryÂáΩÊï∞ÁöÑËøîÂõûÂÄºÂÆö‰πâÊòéÊòéÊòØ‰∏Ä‰∏™interface, ‰ΩÜÊòØÂú®returnÁöÑÊó∂ÂÄôÔºåÂç¥ËøîÂõû‰∏Ä‰∏™structÔºåÊü•ÈòÖÂæàÂ§öËµÑÊñôÂêéÔºåËøôÁØáÂçöÂÆ¢Â∏Æ‰∫ÜÊàëÁöÑÂ§ßÂøôÔºåÂÖ∂‰∏≠ÂØπinterfaceÁöÑËß£ÈáäÊúâËøô‰πà‰∏ÄÂè•ËØùÔºöÂú® Golang ‰∏≠Ôºåinterface ÊòØ‰∏ÄÁªÑ method ÁöÑÈõÜÂêàÔºåÊòØ duck-type programming ÁöÑ‰∏ÄÁßç‰ΩìÁé∞„ÄÇ‰∏çÂÖ≥ÂøÉÂ±ûÊÄßÔºàÊï∞ÊçÆÔºâÔºåÂè™ÂÖ≥ÂøÉË°å‰∏∫ÔºàÊñπÊ≥ïÔºâ„ÄÇÂÖ∑‰Ωì‰ΩøÁî®‰∏≠‰Ω†ÂèØ‰ª•Ëá™ÂÆö‰πâËá™Â∑±ÁöÑ structÔºåÂπ∂Êèê‰æõÁâπÂÆöÁöÑ interface ÈáåÈù¢ÁöÑ method Â∞±ÂèØ‰ª•ÊääÂÆÉÂΩìÊàê interface Êù•‰ΩøÁî®„ÄÇ‰πãÂêéÂèàËØ¶ÁªÜÁúã‰∫ÜÂá†ÈÅçËøôÁØáÂçöÊñáÔºåÁäπÂ¶ÇÈÜçÈÜêÁÅåÈ°∂ÔºåÂØπgolanginterfaceÁöÑÁêÜËß£Êõ¥Ê∑±‰∫Ü‰∏ÄÂ±Ç„ÄÇËØªÂÆåËøôÁØáÂêéÂÜçÂéªÂÆûÁé∞Â∑•ÂéÇÊ®°ÂºèÔºåÊàñËÄÖÂÜçÂéªÂÜôgolangÁöÑ‰ª£Á†ÅÔºåÂØπinterfaceÁöÑ‰ΩøÁî®Â∞±‰ºöÊõ¥Ëá™Â¶Ç‰∏Ä‰∫õ„ÄÇ ÊÄªÁªì Êú¨ÊúüÊäÄÊúØÂë®Âàä‰∏ªË¶ÅÁî±golangÂ∑•ÂéÇÊ®°ÂºèÁöÑËÆ®ËÆ∫ÂºïËµ∑Ôºå‰πãÂêéÂèàÊ∂âÂèäÂà∞golang interfaceÁâπÊÄßÁöÑËÆ®ËÆ∫ÔºåÂØπ‰ª•Âêé‰ΩøÁî®golangÁºñÂÜôÊõ¥Âä†Â§çÊùÇÁöÑ‰ª£Á†ÅÂæàÊúâÂ∏ÆÂä©„ÄÇ Êú¨ÊúüÁªìÊùüÔºåÊ¨≤Áü•Âêé‰∫ãÂ¶Ç‰ΩïÔºå‰∏îÁúã‰∏ãÂë®ÂàÜËß£„ÄÇ]]></content>
      <categories>
        <category>ÊäÄÊúØÂë®Âàä</category>
      </categories>
      <tags>
        <tag>golang design pattern go-interface</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golang‰∏≠ÁöÑÂ∑•ÂéÇÊ®°Âºè]]></title>
    <url>%2F2018%2F08%2F27%2Fgolang%E4%B8%AD%E7%9A%84%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-md%2F</url>
    <content type="text"><![CDATA[Á†îÁ©∂goÁöÑËÆæËÆ°Ê®°ÂºèÔºåÂøÖÈ°ª‰∫ÜËß£goÁöÑstructÂíåinterfaceÔºåËã•‰∏çÁÜüÊÇâÔºåÂÖàÈòÖËØª‰ª•‰∏ãÂÜÖÂÆπ goËØ≠Ë®ÄÁöÑstruct goËØ≠Ë®ÄÁöÑinterface 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849* ÁÆÄÂçïÂ∑•ÂéÇÊ®°Âºèpackage mainimport ( "fmt")type Operater interface &#123; Operate(int, int) int&#125;type AddOperate struct &#123;&#125;func (this *AddOperate) Operate(rhs int, lhs int) int &#123; return rhs + lhs&#125;type MultipleOperate struct &#123;&#125;func (this *MultipleOperate) Operate(rhs int, lhs int) int &#123; return rhs * lhs&#125;type OperateFactory struct &#123;&#125;func NewOperateFactory() *OperateFactory &#123; return &amp;OperateFactory&#123;&#125;&#125;func (this *OperateFactory) CreateOperate(operatename string) Operater &#123; switch operatename &#123; case "+": return &amp;AddOperate&#123;&#125; case "*": return &amp;MultipleOperate&#123;&#125; default: panic("Êó†ÊïàËøêÁÆóÁ¨¶Âè∑") return nil &#125;&#125;func main() &#123; Operator := NewOperateFactory().CreateOperate("+") fmt.Printf("add result is %d\n", Operator.Operate(1, 2))&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697* Â∑•ÂéÇÊñπÊ≥ïpackage mainimport ( "fmt")type Operation struct &#123; a float64 b float64&#125;type OperationI interface &#123; GetResult() float64 SetA(float64) SetB(float64)&#125;func (op *Operation) SetA(a float64) &#123; op.a = a&#125;func (op *Operation) SetB(b float64) &#123; op.b = b&#125;type AddOperation struct &#123; Operation&#125;func (this *AddOperation) GetResult() float64 &#123; return this.a + this.b&#125;type SubOperation struct &#123; Operation&#125;func (this *SubOperation) GetResult() float64 &#123; return this.a - this.b&#125;type MulOperation struct &#123; Operation&#125;func (this *MulOperation) GetResult() float64 &#123; return this.a * this.b&#125;type DivOperation struct &#123; Operation&#125;func (this *DivOperation) GetResult() float64 &#123; return this.a / this.b&#125;type IFactory interface &#123; CreateOperation() Operation&#125;type AddFactory struct &#123;&#125;func (this *AddFactory) CreateOperation() OperationI &#123; return &amp;(AddOperation&#123;&#125;)&#125;type SubFactory struct &#123;&#125;func (this *SubFactory) CreateOperation() OperationI &#123; return &amp;(SubOperation&#123;&#125;)&#125;type MulFactory struct &#123;&#125;func (this *MulFactory) CreateOperation() OperationI &#123; return &amp;(MulOperation&#123;&#125;)&#125;type DivFactory struct &#123;&#125;func (this *DivFactory) CreateOperation() OperationI &#123; return &amp;(DivOperation&#123;&#125;)&#125;func main() &#123; fac := &amp;(AddFactory&#123;&#125;) oper := fac.CreateOperation() oper.SetA(1) oper.SetB(2) fmt.Println(oper.GetResult())&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849* ÊäΩË±°Â∑•ÂéÇÊñπÊ≥ïpackage mainimport "fmt"type GirlFriend struct &#123; nationality string eyesColor string language string&#125;type AbstractFactory interface &#123; CreateMyLove() GirlFriend&#125;type IndianGirlFriendFactory struct &#123;&#125;type KoreanGirlFriendFactory struct &#123;&#125;func (a IndianGirlFriendFactory) CreateMyLove() GirlFriend &#123; return GirlFriend&#123;"Indian", "Black", "Hindi"&#125;&#125;func (a KoreanGirlFriendFactory) CreateMyLove() GirlFriend &#123; return GirlFriend&#123;"Korean", "Brown", "Korean"&#125;&#125;func getGirlFriend(typeGf string) GirlFriend &#123; var gffact AbstractFactory switch typeGf &#123; case "Indian": gffact = IndianGirlFriendFactory&#123;&#125; return gffact.CreateMyLove() case "Korean": gffact = KoreanGirlFriendFactory&#123;&#125; return gffact.CreateMyLove() &#125; return GirlFriend&#123;&#125;&#125;func main() &#123; a := getGirlFriend("Indian") fmt.Println(a.eyesColor)&#125;]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>ËÆæËÆ°Ê®°Âºè</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mac os ÁéØÂ¢ÉÈÖçÁΩÆruby on rails ÂèäÂÖ∂Hello world]]></title>
    <url>%2F2018%2F08%2F26%2FMac-os-%E9%85%8D%E7%BD%AE-ruby-on-rails-md%2F</url>
    <content type="text"><![CDATA[‰ªäÂ§©Âú®Mac OSÁéØÂ¢É‰∏≠ÂÄíËÖæruby on railsÔºåÈÅáÂà∞‰∏Ä‰∫õÂùëÂπ∂ÊéíÂùëÂêéÊÄªÁªì‰∏Ä‰∏™Êê≠Âª∫ËøáÁ®ãÔºå‰æõÂ§ßÂÆ∂ÂèÇËÄÉ„ÄÇ Â§ßÁ∫≤ Êú¨ÁùÄITÂ±äËÉΩÁî®ÊúÄÊñ∞ÁöÑÂ∞±‰∏çÁî®ÂâçÈù¢ÁöÑÁâàÊú¨ÁöÑÂÆóÊó®ÔºåÂú®ËøõË°å‰πãÂâçÂøÖÈ°ªÂ∞Ü‰Ω†ÁöÑMacÂçáÁ∫ßÂà∞ÊúÄÊñ∞ÁöÑmacOS High Sierra ÂÆâË£Ö XCode Command Line Tools ÈÖçÁΩÆGit ÂÆâË£ÖHomebrew ÂÆâË£ÖGPG ÂÆâË£ÖRVM ÂÆâË£Öruby ÂçáÁ∫ßRubyGems ÂÆâË£Örails Âü∫Êú¨MVCÊé¢Á©∂‰πãHello world Ruby On rails for mac os High Sierra Mac OSÊòØËá™Â∏¶rubyÁöÑÔºå‰ΩÜÊòØËøô‰∫õrubyÁöÑÁâàÊú¨ÈÉΩ‰∏çÊòØÊúÄÊñ∞ÁöÑÔºåÊàë‰ª¨‰πü‰∏çË¶ÅÁî®Ëøô‰∫õËøáÊó∂ÁöÑÁâàÊú¨ È¶ñÂÖàÔºåÂçáÁ∫ß‰Ω†ÁöÑMac OSÂà∞10.13 Êü•ÁúãÊòØÂê¶ÂÆâË£Öxcode command line toolÔºö 1234$:xcode-select -pÂ¶ÇÊûú‰Ω†ÁúãÂà∞Ôºöxcode-select: error: unable to get active developer directory...ËØ¥Êòé‰Ω†Ê≤°ÊúâÂÆâË£Öxcode command line tool,ÈúÄË¶ÅÊåâÁÖß‰∏ãÈù¢ÁöÑÊ≠•È™§ÂÆâË£Ö„ÄÇ 123Â¶ÇÊûú‰Ω†ÁúãÂà∞Ôºö$:/Applications/Xcode.app/Contents/Developer ÊàñËÄÖ/Library/Developer/CommandLineToolsÊÅ≠Âñú‰Ω†Ôºåxcode command line tool‰Ω†Â∑≤ÁªèÂÆâË£ÖÂ•Ω‰∫Ü 123ButÔºåÂ¶ÇÊûú‰Ω†Âæà‰∏çÂπ∏ËøêÂú∞ÁúãÂà∞‰∫ÜËøôÂè•ËØùÔºö$: /Applications/Apple Dev Tools/Xcode.app/Contents/DeveloperÈÇ£‰πà‰Ω†Â∞±Ë¶ÅÂç∏ÊéâxcodeÈáçÊñ∞ÂÆâË£Ö‰∫ÜÔºåÂÖ∑‰ΩìÂéüÂõ†Áúã ËøôÈáå ÂÆâË£Öxcode 1xcode-select --install ‰∏ÄË∑ØÁ°ÆËÆ§‰πãÂêéÔºåÂ∞±ÂèØ‰ª•ÂÆâÂ•ΩxcodeÔºå‰ΩÜÊòØÂ¶ÇÊûú‰Ω†ÁöÑÁΩëÈÄü‰∏çÂ•ΩÔºåÁ≠âÂæÖÊó∂Èó¥ËøáÈïøÔºå‰Ω†ÂèØ‰ª•‰ªéËøôÈáåËæìÂÖ•‰Ω†ÁöÑAPPID‰∏ãËΩΩ„ÄÇ Á°ÆËÆ§‰∏Ä‰∏ãÊòØÂê¶ÂÆâÂ•Ω 12$ xcode-select -p/Library/Developer/CommandLineTools ÈÖçÁΩÆGit Âú®ÂÆâË£Öruby on rails ‰πãÂâçÔºå‰Ω†Â∫îËØ•ÈÖçÁΩÆ‰Ω†ÁöÑGit„ÄÇGitÂú®Mac OS‰∏ä‰ΩøËá™Âä®ÂÆâË£ÖÁöÑËΩØ‰ª∂ Ê£ÄÊü•GitÁâàÊú¨Âπ∂Á°ÆËÆ§Â∑≤ÁªèÂÆâË£ÖËÆ©‰Ω†ÊîæÂøÉ 12$ git versiongit version 2.4.9 (Apple Git-60) ÈÖçÁΩÆGit‰πãÂâçÔºå‰Ω†Â∫îËØ•Âà∞GitHub‰∏äÊ≥®ÂÜå‰Ω†ÁöÑË¥¶Âè∑Âπ∂ËÆ∞‰ΩèÂØÜÁ†ÅÂíåÈÇÆÁÆ±„ÄÇÂπ∂‰ΩøÁî®‰∏ãÈù¢ÁöÑÂëΩ‰ª§ÈÖçÁΩÆÔºö 1234567$ git config -l --globalfatal: unable to read config file '/Users/.../.gitconfig': No such file or directory$ git config --global user.name "Your Real Name"$ git config --global user.email me@example.com$ git config -l --globaluser.name=Your Real Nameuser.email=me@example.com GitÈÖçÁΩÆÂÆåÊàêÔºåÂú®‰Ω†ÊÉ≥Áî®GitÁöÑÊó∂ÂÄôÔºåÂÆÉÂ∞±‰ºöËπ¶Âá∫Êù•‰∫Ü„ÄÇ ÂÆâË£ÖHomebrow Ê£ÄÊü•homebrowÊòØÂê¶Â∑≤ÁªèÂÆâË£Ö 12$ brew-bash: brew: command not found RVMÈúÄË¶ÅHomebrow,ÂÖ∂ÂÆû‰∏Ä‰∏™Mac OSÈ¢ùÂÆâË£ÖÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÁî®Êù•‰∏ãËΩΩ‰∏Ä‰∫õËΩØ‰ª∂ÔºåÁ±ª‰ºº‰∫éUbuntuÁöÑapt-getÂíåcentosÁöÑyum install.‰∏∫ÈÅøÂÖçÂÆâË£ÖRMÂá∫Áé∞ÈóÆÈ¢òÔºåÊàë‰ª¨ÂøÖÈ°ªÂÆâË£ÖhomebrowÔºö 1$ ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)" ÂÆâË£ÖËøáÁ®ã‰∏≠ÂèØËÉΩ‰ºöÂá∫Áé∞‰∏Ä‰∫õwarningÂπ∂ËÆ©‰Ω†ËæìÂÖ•ÂØÜÁ†ÅÔºö 123WARNING: Improper use of the sudo command could lead to data loss...To proceed, enter your password...Password: Â∞ΩÁÆ°ËæìÂÖ•ÂØÜÁ†ÅÔºåÂøΩÁï•warning„ÄÇ Êàë‰ª¨ËøôÈáåÊòØ‰ΩøÁî®‰∫ÜMac OSÂÜÖÁΩÆÁöÑrubyÊù•ÂÆâË£Öhomebrow„ÄÇ ÂÆâË£ÖGPG gpgÊòØ‰∏Ä‰∏™Áî®Êù•Ê£ÄÊü•RVM‰∏ãËΩΩÂåÖÁöÑÂÆâÂÖ®ÊÄßÁöÑÁ®ãÂ∫èÔºåÊàë‰ª¨‰ΩøÁî®homebrewÊù•ÂÆâË£Ögpg: 1$ brew install gpg gpgÂÆâË£Ö‰πãÂêéÔºå‰∏∫RVMÂÆâË£Ökey: 1$ command curl -sSL https://rvm.io/mpapis.asc | gpg --import - ÂÆâË£ÖRVM RVMÔºåÊòØRuby version managerÁöÑÁÆÄÂÜôÔºåÁî®Êù•ÂÆâË£ÖrubyÊàñËÄÖÁÆ°ÁêÜrailsÁâàÊú¨„ÄÇËøô‰∏™ÁΩëÁ´ôËØ¶ÁªÜËØ¥Êòé‰∫ÜÂÆâË£ÖrubyÁöÑÊñπÂºèÔºå‰ΩÜÊòØÊàë‰ª¨Êúâ‰∏ÄÁßçÊúÄÁÆÄ‰æøÁöÑÊñπÂºèÔºö 1$ \curl -L https://get.rvm.io | bash -s stable ‚Äúcurl‚ÄùÂâçÈù¢ÁöÑ‚Äú\‚ÄùÁî®Êù•ÈÅøÂÖçrubyÁâàÊú¨ÁöÑÂÜ≤Á™ÅÔºå‰∏çË¶ÅÊºèÊéâ„ÄÇ ÂÆâË£ÖËøáÁ®ã‰∏≠‰Ω†ÂèØËÉΩ‰ºöÁúãÂà∞ 123mkdir: /etc/openssl: Permission deniedmkdir -p "/etc/openssl" failed, retrying with sudoyour password required for 'mkdir -p /etc/openssl': ËØ∑ËæìÂÖ•ÂØÜÁ†ÅÂπ∂ÁªßÁª≠„ÄÇ Â¶ÇÊûú‰Ω†Â∑≤ÁªèÂÆâË£ÖËøáRVMÔºå‰ΩøÁî®‰∏ãÈù¢ÁöÑÂëΩ‰ª§updateÔºö 1$ rvm get stable --autolibs=enable ÈáçÂêØterminalÁ™óÂè£ÊàñËÄÖ‰ΩøÁî®Ôºö‰ΩøRVMÁîüÊïà 1$ source ~/.rvm/scripts/rvm ÂÆâË£Öruby Âú®ÂÆâË£ÖRVM‰πãÂêéÔºåÊàë‰ª¨ÂÆâË£ÖÊúÄÊñ∞ÁâàÊú¨ÁöÑruby„ÄÇruby 2.5.1ÊòØÂÜôÊ≠§ÂçöÂÆ¢Êó∂ÂΩìÂâçÊúÄÊñ∞ÁöÑrubyÁâàÊú¨ÔºåËøòËØ∑Êü•ÁúãrubyÂÆòÁΩëÊü•ÁúãÊúÄÊñ∞ÁâàÊú¨ÁöÑruby„ÄÇÂøÖÈ°ªÊåáÂÆörubyÁöÑÁâàÊú¨Ôºö 1$ rvm install ruby-2.5.1 ÂÆâË£ÖÂêéÊ£ÄÊü•ÊòØÂê¶ÂÆâË£ÖÊàêÂäüÔºö 12$ ruby -vruby 2.5.1... ÂçáÁ∫ßrubyGemset RubyGemsÊòØ‰∏Ä‰∏™rubyÁöÑÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÁî®Êù•ÂÆâË£ÖrubyÁöÑÂ∑•ÂÖ∑ÊàñËÄÖÈ¢ùÂ§ñÂäüËÉΩÁöÑÂåÖ„ÄÇ Êü•ÁúãgemÁâàÊú¨Ôºö 1$ gem -v Â∞ÜgemÂçáÁ∫ßÂà∞ÊúÄÊñ∞ÁâàÊú¨ 1$ gem update --system ÊòæÁ§∫RVM gemsetsÁöÑÊúÄÂàù‰∏§‰∏™ËÆæÁΩÆ 1234$ rvm gemset listgemsets for ruby-2.5.0=&gt; (default) global ‰∏ÄËà¨‰ΩøÁî®globalÔºö 1$ rvm gemset use global ÂÆâË£Öbundle,BundleÊòØ‰∏Ä‰∏™ÁÆ°ÁêÜgemÁöÑÂøÖÈ°ªÁöÑÂ∑•ÂÖ∑ 1$ gem install Bundler ÂÆâË£ÖNokogiriÔºåNokogiriÈúÄË¶ÅÁºñËØëÊàêÊåáÂÆöÁöÑÁ≥ªÁªüÔºåÂú®‰∏äÈù¢ÁöÑÈÖçÁΩÆ‰∏ãÔºåÂè∑Áß∞ÊúÄÈöæÂÆâË£ÖÁöÑÂåÖÔºå‰πüÂ∞ÜÂÆâË£ÖÂ•Ω 1$ gem install nokogiri Â¶ÇÊûú‰Ω†ÁúüÁöÑ‰∏çÂπ∏ËøêÂú®ÂÆâË£ÖÊó∂ÈÅáÂà∞ÈóÆÈ¢òÔºåStack OverflowËÉΩÂ∏ÆÂà∞‰Ω†„ÄÇ ÂÆâË£Örails ËøôÈáåÊòØruby On railÊúÄÊñ∞ÁöÑÁâàÊú¨Ôºå5.1ÊòØÊúÄÊñ∞Á®≥ÂÆöÁâàÊú¨Ôºå5.2ÊòØreleaseÁâàÊú¨ÔºåÊàë‰ª¨ÂÆâË£Ö5.1. 1$ gem install rails --version=5.1 Â¶ÇÊûú‰Ω†ÂñúÊ¨¢Â∞ùÈ≤úÔºåÂèØ‰ª•‰ΩøÁî® 1$ gem install rails --pre ÂÆâË£ÖreleaseÁâàÊú¨„ÄÇ Ê£ÄÊü•‰∏Ä‰∏ãrailsÊòØÂê¶Ë£ÖÂ•ΩÔºö 12$ rails -vRails 5.2.0 Âà∞Ê≠§‰∏∫Ê≠¢Ôºåruby on rails ‰ª•ÂèäÂÖ∂ÁéØÂ¢ÉÈÖçÁΩÆÈÉΩÂ∑≤Â¶•ÂΩìÔºåÂèØ‰ª•ÂºÄÂßã‰Ω†ÁöÑruby‰πãÊóÖ‰∫Ü„ÄÇ ruby on rails ÁöÑHello world 123456$ cd /$ mkdir worlspace$ cd workspace$ rails _5.1.0_ new hello_app$ cd hello_app$ rails server Â∞Ühttp://localhost:3000ËæìÂÖ•ÊµèËßàÂô®ÔºåÂ∞±ËÉΩÁúãÂà∞ruby on railsÁöÑÊ¨¢ËøéÁïåÈù¢„ÄÇ]]></content>
      <categories>
        <category>ruby</category>
      </categories>
      <tags>
        <tag>ruby on rails</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[goÂÆûÁé∞UNIX command]]></title>
    <url>%2F2018%2F08%2F22%2Fgo-unix-cmd-md%2F</url>
    <content type="text"><![CDATA[12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970package mainimport ( "bufio" "errors" "fmt" "os" "os/exec" "strings")func main() &#123; reader := bufio.NewReader(os.Stdin) for &#123; fmt.Print("&gt; ") // ËØªÂèñÈîÆÁõòÁöÑËæìÂÖ•. input, err := reader.ReadString('\n') if err != nil &#123; fmt.Fprintln(os.Stderr, err) &#125; // ÊâßË°åÂπ∂Ëß£Êûêcommand. err = execInput(input) if err != nil &#123; fmt.Fprintln(os.Stderr, err) &#125; &#125;&#125;// Â¶ÇÊûúcdÂëΩ‰ª§Ê≤°ÊúâË∑ØÂæÑÁöÑËØùÔºåÂ∞±Êä•‰∏ãÈù¢ÁöÑÈîôËØØvar ErrNoPath = errors.New("path required")func execInput(input string) error &#123; // ÁßªÈô§Êç¢Ë°åÁ¨¶. input = strings.TrimSuffix(input, "\n") // Â∞ÜËæìÂÖ•ÂàÜÂâ≤ÊàêÂèÇÊï∞. args := strings.Split(input, " ") // ÂØπcdÂëΩ‰ª§ÁöÑÊÉÖÂÜµËøõË°åÂå∫ÂàÜ. switch args[0] &#123; case "cd": // ÊöÇÊó∂‰∏çÊîØÊåÅcdÂä†Á©∫Ê†ºËøõÂÖ•homeÁõÆÂΩï. if len(args) &lt; 2 &#123; return ErrNoPath &#125; err := os.Chdir(args[1]) if err != nil &#123; return err &#125; // Stop further processing. return nil case "exit": os.Exit(0) &#125; // Prepare the command to execute. cmd := exec.Command(args[0], args[1:]...) // Set the correct output device. cmd.Stderr = os.Stderr cmd.Stdout = os.Stdout // Execute the command and save it's output. err := cmd.Run() if err != nil &#123; return err &#125; return nil&#125; 12//ÊâßË°åÂπ∂ÊµãËØïgo run main.go ÊöÇÊó∂‰∏çÊîØÊåÅtabÈîÆËá™Âä®Ë°•ÂÖ®ÂëΩ‰ª§ÔºåÂè™ÊòØÊèê‰æõ‰∏ÄÁßçÁÆÄÂçïÁöÑÊÄùË∑Ø„ÄÇ]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>go</tag>
        <tag>unix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iterm2 Á™ÅÁÑ∂Êä•ÂæàÂ•áÊÄ™ÁöÑÈîôËØØ-Error No user exists for uid 501]]></title>
    <url>%2F2018%2F08%2F21%2Fiterm2-strange-err-md-md%2F</url>
    <content type="text"><![CDATA[123No user exists for uid 501fatal: Could not read from remote repository.Please make sure you have the correct access rightsand the repository exists. ‰∏äÂçàËøòÂ•ΩÂ•ΩÁöÑÔºåÂàöÂàöËøûÊé•GitHubÊä•Ëøô‰∏™ÈîôËØØÔºåÊéíÊü•Âêé‰∫ÜËß£Âà∞ÊòØiterm2ÁöÑÁ•ûÂùë„ÄÇ ÈáçÂêØitermÁªàÁ´ØÂ∞±Â•Ω Á≥ªÁªüÊúâÊõ¥Êñ∞ÁöÑËØù ÈúÄË¶ÅÈáçÂêØÁªàÁ´Ø Êõ¥Êñ∞„ÄÇ]]></content>
      <categories>
        <category>ÁîüÊ¥ª‰∏≠Â•áÊÄ™ÁöÑÂùë</category>
      </categories>
      <tags>
        <tag>Êó•Â∏∏ÁöÑÂùëÁ≥ªÂàó</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[golang‰∏≠interfaceÁöÑÈÄöÁî®ËÆæËÆ°ÊñπÊ≥ï]]></title>
    <url>%2F2018%2F08%2F21%2Fgolang%E9%80%9A%E7%94%A8%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[golang‰∏≠Êé•Âè£ËÆæËÆ°ÁöÑÈÄöÁî®ÊñπÊ≥ï 123456789101112131415161718192021222324251. Êé•Âè£ÂÆö‰πâtype XxxManager interface &#123; Create(args argsType) (*XxxStruct, error) Get(args argsType) (**XxxStruct, error) Update(args argsType) (*XxxStruct, error) Delete(name string, options *DeleleOptions) error&#125;2. ÁªìÊûÑ‰ΩìÂÆö‰πâ type XxxManagerImpl struct &#123; Name string Namespace string kubeCli *kubernetes.Clientset&#125;3ÔºåÊûÑÈÄ†ÂáΩÊï∞func NewXxxManagerImpl (namespace, name string, kubeCli *kubernetes.Clientset) XxxManager &#123; return &amp;XxxManagerImpl&#123; Name name, Namespace namespace, kubeCli: kubeCli, &#125;&#125;4. ÊñπÊ≥ïÂÖ∑‰ΩìÂÆûÁé∞func (xm *XxxManagerImpl) Create(args argsType) (*XxxStruct, error) &#123; //ÂÖ∑‰ΩìÁöÑÊñπÊ≥ïÂÆûÁé∞&#125; golangÈÄöÁî®Êé•Âè£ËÆæËÆ° Ê†πÊçÆ‰ª•‰∏äËÆæËÆ°cdosapiÂ∞ÅË£ÖÊé•Âè£Ôºö]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python3‰∏≠ÈÅáÂà∞'TypeError Unicode-objects must be encoded before hashing']]></title>
    <url>%2F2018%2F08%2F20%2Fpython-md5-err-md%2F</url>
    <content type="text"><![CDATA[Python3‰∏≠ËøõË°åMD5Âä†ÂØÜÔºåÈÅáÂà∞ÁºñÁ†ÅÈóÆÈ¢ò 12345678910111213141516171819202122232425262728293031323334353637383940import hashlibfrom urllib.parse import urlencode, quote_plusimport urllibdef verfy_ac(private_key): item = &#123; "Action" : "CreateUHostInstance", "CPU" : 2, "ChargeType" : "Month", "DiskSpace" : 10, "ImageId" : "f43736e1-65a5-4bea-ad2e-8a46e18883c2", "LoginMode" : "Password", "Memory" : 2048, "Name" : "Host01", "Password" : "VUNsb3VkLmNu", "PublicKey" : "ucloudsomeone%40example.com1296235120854146120", "Quantity" : 1, "Region" : "cn-bj2", "Zone" : "cn-bj2-04" &#125; # Â∞ÜÂèÇÊï∞‰∏≤ÊéíÂ∫è params_data = "" import pdb;pdb.set_trace() for key, value in item.items(): params_data = params_data + str(key) + str(value) params_data = params_data + private_key params_data_en = quote_plus(params_data) sign = hashlib.sha1() sign.update(params_data_en.encode('utf8')) signature = sign.hexdigest() return signatureprint(verfy_ac("46f09bb9fab4f12dfc160dae12273d5332b5debe")) ËøôÊòØucloudÂÆòÊñπÁöÑAPIÊïôÁ®ãÔºåÊÉ≥Ê†πÊçÆÊ≠§ÊïôÁ®ãÁîüÊàêÁ≠æÂêçÔºåÊïôÁ®ã‰∏≠ÁöÑ‰ª£Á†ÅÊòØÂü∫‰∫éPython2.7ÁºñÂÜôÔºåÊàëÂ∞ÜÂÖ∂ÊîπÊàê‰∫ÜPython3.‰ΩÜÊòØÂú®ÊâßË°åÊó∂Êä•ÈîôÔºö 1TypeError: Unicode-objects must be encoded before hashing ÊéíÈîôÂêéÂèëÁé∞python3‰∏≠Â≠óÁ¨¶ÂØπË±°ÊòØunicodeÂØπË±°Ôºå‰∏çËÉΩÁõ¥Êé•Âä†ÂØÜÔºåÈúÄË¶ÅÁºñÁ†ÅÂêéÊâçËÉΩËøõË°åupdate„ÄÇ Â∞±ÊòØÊîπÊàêÂ¶Ç‰∏ãÂç≥ÂèØÔºö 1sign.update(params_data_en.encode('utf8'))]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>md5ÁºñÁ†Å</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2018%2F08%2F18%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
